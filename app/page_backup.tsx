'use client';

import { useState, useMemo, useEffect, ChangeEvent } from 'react';
import * as XLSX from 'xlsx';
import { Upload, AlertCircle, TrendingUp, DollarSign, FileSpreadsheet } from 'lucide-react';
import { INDUSTRY_SECTORS, SECTOR_CATEGORIES } from '../data/industrySectors';
import { assessmentData } from '../data/assessmentData';
import { authApi, companiesApi, usersApi, consultantsApi, financialsApi, assessmentsApi, profilesApi, benchmarksApi, ApiError } from '@/lib/api-client';

// Types
type Mappings = {
  date: string;
  // Income Statement
  revenue?: string;
  cogsPayroll?: string;
  cogsOwnerPay?: string;
  cogsContractors?: string;
  cogsMaterials?: string;
  cogsCommissions?: string;
  cogsOther?: string;
  cogsTotal?: string;
  opexSalesMarketing?: string;
  rentLease?: string;
  utilities?: string;
  equipment?: string;
  travel?: string;
  professionalServices?: string;
  insurance?: string;
  opexOther?: string;
  opexPayroll?: string;
  ownersBasePay?: string;
  ownersRetirement?: string;
  contractorsDistribution?: string;
  interestExpense?: string;
  depreciationExpense?: string;
  operatingExpenseTotal?: string;
  nonOperatingIncome?: string;
  extraordinaryItems?: string;
  expense?: string;
  netProfit?: string;
  // Balance Sheet - Assets
  cash?: string;
  ar?: string;
  inventory?: string;
  otherCA?: string;
  tca?: string;
  fixedAssets?: string;
  otherAssets?: string;
  totalAssets?: string;
  // Balance Sheet - Liabilities & Equity
  ap?: string;
  otherCL?: string;
  tcl?: string;
  ltd?: string;
  totalLiab?: string;
  totalEquity?: string;
  totalLAndE?: string;
};

type NormalRow = {
  date: Date;
  month: string;
  revenue: number;
  expense: number;
  cash: number;
  ar: number;
  inventory: number;
  otherCA: number;
  tca: number;
  fixedAssets: number;
  otherAssets: number;
  totalAssets: number;
  ap: number;
  otherCL: number;
  tcl: number;
  ltd: number;
  totalLiab: number;
  totalEquity: number;
  totalLAndE: number;
};

type MonthlyDataRow = {
  month: string;
  revenue: number;
  expense: number;
  cogsPayroll: number;
  cogsOwnerPay: number;
  cogsContractors: number;
  cogsMaterials: number;
  cogsCommissions: number;
  cogsOther: number;
  cogsTotal: number;
  opexSalesMarketing: number;
  rentLease: number;
  utilities: number;
  equipment: number;
  travel: number;
  professionalServices: number;
  insurance: number;
  opexOther: number;
  opexPayroll: number;
  ownersBasePay: number;
  ownersRetirement: number;
  contractorsDistribution: number;
  interestExpense: number;
  depreciationExpense: number;
  operatingExpenseTotal: number;
  nonOperatingIncome: number;
  extraordinaryItems: number;
  netProfit: number;
  totalAssets: number;
  totalLiab: number;
  cash: number;
  ar: number;
  inventory: number;
  otherCA: number;
  tca: number;
  fixedAssets: number;
  otherAssets: number;
  ap: number;
  otherCL: number;
  tcl: number;
  ltd: number;
  totalEquity: number;
  totalLAndE: number;
};

interface Company {
  id: string;
  name: string;
  consultantEmail: string;
  consultantId?: string;
  createdDate: string;
  location?: string;
  addressStreet?: string;
  addressCity?: string;
  addressState?: string;
  addressZip?: string;
  addressCountry?: string;
  industrySector?: number;
  subscriptionMonthlyPrice?: number;
  subscriptionQuarterlyPrice?: number;
  subscriptionAnnualPrice?: number;
}

interface CompanyProfile {
  companyId: string;
  legalStructure: string;
  businessStatus: string;
  ownership: string;
  workforce: string;
  keyAdvisors: string;
  specialNotes: string;
  qoeNotes: string;
  disclosures: {
    bankruptcies: string;
    liens: string;
    contracts: string;
    lawsuits: string;
    mostFavoredNation: string;
    equityControl: string;
    rightOfFirstRefusal: string;
    shareholderProtections: string;
    changeInControl: string;
    regulatoryApprovals: string;
    auditedFinancials: string;
  };
}

interface AssessmentResponses {
  [questionId: string]: number;
}

interface AssessmentNotes {
  [categoryId: number]: string;
}

interface AssessmentRecord {
  id: string;
  userId: string;
  user?: {
    id: string;
    name: string;
    email: string;
  };
  companyId: string;
  company?: {
    id: string;
    name: string;
  };
  responses: AssessmentResponses;
  notes: AssessmentNotes;
  completedAt: string;
  overallScore: number;
  // Legacy fields for backward compatibility
  userEmail?: string;
  userName?: string;
  companyName?: string;
  completedDate?: string;
}

interface Consultant {
  id: string;
  type: string;
  fullName: string;
  address: string;
  email: string;
  phone: string;
  password: string;
}

interface User {
  id: string;
  name: string;
  email: string;
  password: string;
  companyId: string;
  consultantId?: string;
  role: 'consultant' | 'user' | 'siteadmin';
  userType?: 'company' | 'assessment'; // company = management team, assessment = fills questionnaire
}

interface FinancialDataRecord {
  id: string;
  companyId: string;
  uploadedBy: string;
  uploadDate: string;
  rawRows: any[];
  mapping: Mappings;
  fileName: string;
}

// Helper functions
function parseDateLike(v: any): Date | null {
  if (v instanceof Date && !isNaN(v.getTime())) return v;
  if (typeof v === 'number') {
    const d = XLSX.SSF.parse_date_code(v);
    if (d) return new Date(Date.UTC(d.y, d.m - 1, d.d || 1));
  }
  if (typeof v === 'string') {
    const s = v.trim();
    const iso = new Date(s);
    if (!isNaN(iso.getTime())) return iso;
    const m = s.match(/^(\d{1,2})\/(\d{4})$/);
    if (m) {
      const mm = Number(m[1]);
      const yyyy = Number(m[2]);
      return new Date(Date.UTC(yyyy, mm - 1, 1));
    }
  }
  return null;
}

function monthKey(d: Date) {
  return `${d.getUTCFullYear()}-${String(d.getUTCMonth() + 1).padStart(2, '0')}`;
}

function sum(arr: number[]) {
  return arr.reduce((a, b) => a + (Number.isFinite(b) ? b : 0), 0);
}

function pctChange(curr: number, prior: number) {
  if (!Number.isFinite(curr) || !Number.isFinite(prior) || prior === 0) return null;
  return (curr / prior - 1) * 100;
}

function getAssetSizeCategory(totalAssets: number): string {
  if (totalAssets < 500000) return '<500k';
  if (totalAssets < 1000000) return '500k-1m';
  if (totalAssets < 5000000) return '1m-5m';
  if (totalAssets < 10000000) return '5m-10m';
  if (totalAssets < 25000000) return '10m-25m';
  if (totalAssets < 50000000) return '25m-50m';
  if (totalAssets < 100000000) return '50m-100m';
  if (totalAssets < 250000000) return '100m-250m';
  if (totalAssets < 500000000) return '250m-500m';
  return '>500m';
}

// Map KPI ratio names to benchmark metric names
const KPI_TO_BENCHMARK_MAP: Record<string, string[]> = {
  // Liquidity
  'Current Ratio': ['Current Ratio'],
  'Quick Ratio': ['Quick Ratio', 'Acid Test Ratio'],
  // Activity
  'Inventory Turnover': ['Inventory Turnover'],
  'Receivables Turnover': ['Sales/Receivables', 'Receivables Turnover', 'Receivable Turnover', 'Accounts Receivable Turnover'],
  'Payables Turnover': ['Payables Turnover', 'Payable Turnover', 'Accounts Payable Turnover'],
  'Days Inventory': ['Days Inventory', 'Days\' Inventory', 'Days Inventory on Hand'],
  'Days Receivables': ['Days Receivables', 'Days\' Receivables', 'Days Receivable', 'Days Sales Outstanding'],
  'Days Payables': ['Days Payables', 'Days\' Payables', 'Days Payable', 'Days Payables Outstanding'],
  'Sales/Working Capital': ['Sales to Working Capital', 'Sales/Working Capital'],
  // Coverage
  'Interest Coverage': ['Times Interest Earned', 'Interest Coverage', 'Interest Coverage Ratio'],
  'Debt Service Coverage': ['Debt Service Coverage Ratio', 'Debt Service Coverage'],
  'Cash Flow to Debt': ['Cash Flow to Total Debt', 'Cash Flow/Total Debt'],
  // Leverage
  'Debt/Net Worth': ['Debt to Net Worth', 'Debt/Net Worth'],
  'Fixed Assets/Net Worth': ['Fixed Assets to Net Worth', 'Fixed Assets/Net Worth'],
  'Leverage Ratio': ['Total Debt to Assets', 'Debt to Assets', 'Leverage Ratio'],
  // Operating
  'Total Asset Turnover': ['Sales/Total Assets', 'Total Asset Turnover', 'Asset Turnover'],
  'ROE': ['Return on Equity', 'Return on Net Worth, %', 'Return on Equity (%)', 'ROE'],
  'ROA': ['Return on Assets', 'Return on Assets, %', 'Return on Assets (%)', 'ROA'],
  'EBITDA/Revenue': ['EBITDA Margin', 'EBITDA Margin (%)', 'EBITDA/Revenue'],
  'EBIT/Revenue': ['EBIT Margin', 'EBIT Margin (%)', 'EBIT/Revenue']
};

function getBenchmarkValue(benchmarks: any[], metricName: string): number | null {
  if (!benchmarks || benchmarks.length === 0) return null;
  
  // Try exact match first
  const exactMatch = benchmarks.find(b => b.metricName === metricName);
  if (exactMatch && exactMatch.fiveYearValue != null) {
    return exactMatch.fiveYearValue;
  }
  
  // Try all possible mapped names
  const possibleNames = KPI_TO_BENCHMARK_MAP[metricName];
  if (possibleNames) {
    for (const name of possibleNames) {
      const match = benchmarks.find(b => b.metricName === name);
      if (match && match.fiveYearValue != null) {
        return match.fiveYearValue;
      }
    }
  }
  
  // Log missing benchmark for debugging
  if (benchmarks.length > 0) {
    console.log(`No benchmark found for "${metricName}". Available: ${benchmarks.map(b => b.metricName).slice(0, 5).join(', ')}...`);
  }
  
  return null;
}

function revenueGrowthScore_24mo(growthPct: number | null) {
  if (growthPct === null) return null;
  const g = growthPct;
  if (g >= 25) return 100;
  if (g >= 15) return 80;
  if (g >= 5) return 60;
  if (g >= 0) return 50;
  if (g >= -5) return 40;
  if (g >= -15) return 20;
  return 10;
}

function rgsAdjustmentFrom6mo(rgs: number | null, growth6moPct: number | null) {
  if (rgs === null || growth6moPct === null) return null;
  const g = growth6moPct;
  if (g >= 25) return rgs + 50;
  if (g >= 15) return ((100 - rgs) * 0.8) + rgs;
  if (g >= 5) return ((100 - rgs) * 0.6) + rgs;
  if (g >= 0) return ((100 - rgs) * 0.4) + rgs;
  if (g >= -5) return rgs * 0.9;
  if (g >= -15) return rgs * 0.7;
  if (g >= -25) return rgs * 0.5;
  return rgs * 0.3;
}

function clamp(x: number, min = 10, max = 100) {
  return Math.min(max, Math.max(min, x));
}

function sixMonthGrowthFromMonthly(series: Array<{ month: string; value: number }>) {
  if (series.length < 12) return null;
  const keys = [...series.map(r => r.month)].sort();
  const uniq = Array.from(new Set(keys));
  if (uniq.length < 12) return null;
  const map = new Map(series.map(r => [r.month, r.value]));
  const last6 = uniq.slice(-6);
  const prev6 = uniq.slice(-12, -6);
  const qsum = (months: string[]) => sum(months.map(m => map.get(m) || 0));
  const curr = qsum(last6);
  const prior = qsum(prev6);
  return pctChange(curr, prior);
}

function normalizeRows(raw: any[], mapping: Mappings): NormalRow[] {
  const rows: NormalRow[] = [];
  for (const r of raw) {
    const d = parseDateLike(r[mapping.date]);
    if (!d) continue;
    function N(col?: string) {
      const v = col ? r[col] : null;
      const n = Number(v);
      return Number.isFinite(n) ? n : 0;
    }
    const row: NormalRow = {
      date: d,
      month: monthKey(new Date(Date.UTC(d.getUTCFullYear(), d.getUTCMonth(), 1))),
      revenue: N(mapping.revenue),
      expense: N(mapping.expense),
      cash: N(mapping.cash),
      ar: N(mapping.ar),
      inventory: N(mapping.inventory),
      otherCA: N(mapping.otherCA),
      tca: N(mapping.tca),
      fixedAssets: N(mapping.fixedAssets),
      otherAssets: N(mapping.otherAssets),
      totalAssets: N(mapping.totalAssets),
      ap: N(mapping.ap),
      otherCL: N(mapping.otherCL),
      tcl: N(mapping.tcl),
      ltd: N(mapping.ltd),
      totalLiab: N(mapping.totalLiab),
      totalEquity: N(mapping.totalEquity),
      totalLAndE: N(mapping.totalLAndE),
    };
    rows.push(row);
  }
  
  const acc = new Map<string, NormalRow>();
  for (const r of rows) {
    const k = r.month;
    const v = acc.get(k) || { ...r };
    if (acc.has(k)) {
      for (const key of Object.keys(r) as (keyof NormalRow)[]) {
        if (key === 'date' || key === 'month') continue;
        (v as any)[key] = ((v as any)[key] || 0) + ((r as any)[key] || 0);
      }
    }
    acc.set(k, v);
  }
  const months = Array.from(acc.keys()).sort();
  return months.map(m => acc.get(m)!);
}

function ltmVsPrior(series: Array<{ month: string; value: number }>) {
  if (series.length < 24) return { curr: null, prior: null, pct: null };
  const values = [...series].sort((a, b) => a.month.localeCompare(b.month));
  const last12 = values.slice(-12);
  const prev12 = values.slice(-24, -12);
  const curr = sum(last12.map(r => r.value));
  const prior = sum(prev12.map(r => r.value));
  return { curr, prior, pct: pctChange(curr, prior) };
}

// KPI Formula Definitions
const KPI_FORMULAS: Record<string, { formula: string; period: string; description: string }> = {
  'Current Ratio': {
    formula: 'Current Assets ÷ Current Liabilities',
    period: 'Point in Time (End of Month)',
    description: 'Measures the company\'s ability to pay short-term obligations. Current Assets include Cash, AR, Inventory, and Other Current Assets. Current Liabilities include AP and Other Current Liabilities.'
  },
  'Quick Ratio': {
    formula: '(Current Assets - Inventory) ÷ Current Liabilities',
    period: 'Point in Time (End of Month)',
    description: 'Measures the company\'s ability to meet short-term obligations without relying on inventory sales. Also known as the Acid Test Ratio.'
  },
  'Inventory Turnover': {
    formula: 'Cost of Goods Sold (LTM) ÷ Average Inventory',
    period: 'Last Twelve Months (LTM)',
    description: 'Measures how many times inventory is sold and replaced over the period. Higher values indicate efficient inventory management.'
  },
  'Receivables Turnover': {
    formula: 'Revenue (LTM) ÷ Average Accounts Receivable',
    period: 'Last Twelve Months (LTM)',
    description: 'Measures how efficiently a company collects revenue from its credit customers. Higher values indicate faster collection.'
  },
  'Payables Turnover': {
    formula: 'Cost of Goods Sold (LTM) ÷ Average Accounts Payable',
    period: 'Last Twelve Months (LTM)',
    description: 'Measures how quickly a company pays off its suppliers. Lower values may indicate better use of supplier financing.'
  },
  'Days\' Inventory': {
    formula: '365 ÷ Inventory Turnover',
    period: 'Last Twelve Months (LTM)',
    description: 'Average number of days it takes to sell inventory. Lower values indicate faster inventory movement.'
  },
  'Days\' Receivables': {
    formula: '365 ÷ Receivables Turnover',
    period: 'Last Twelve Months (LTM)',
    description: 'Average number of days to collect payment after a sale. Also known as Days Sales Outstanding (DSO).'
  },
  'Days\' Payables': {
    formula: '365 ÷ Payables Turnover',
    period: 'Last Twelve Months (LTM)',
    description: 'Average number of days a company takes to pay its suppliers. Also known as Days Payable Outstanding (DPO).'
  },
  'Sales/Working Capital': {
    formula: 'Revenue (LTM) ÷ (Current Assets - Current Liabilities)',
    period: 'Last Twelve Months (LTM)',
    description: 'Measures how efficiently a company uses working capital to generate sales. Higher values indicate more efficient use of working capital.'
  },
  'Interest Coverage': {
    formula: 'EBIT (LTM) ÷ Interest Expense (LTM)',
    period: 'Last Twelve Months (LTM)',
    description: 'Measures the company\'s ability to pay interest on outstanding debt. Values above 2.5 are generally considered healthy.'
  },
  'Debt Service Coverage': {
    formula: 'Net Income (LTM) ÷ (Principal Payments + Interest Expense)',
    period: 'Last Twelve Months (LTM)',
    description: 'Measures ability to service total debt obligations. Values above 1.25 indicate sufficient cash flow to cover debt payments.'
  },
  'Cash Flow to Debt': {
    formula: 'Operating Cash Flow (LTM) ÷ Total Debt',
    period: 'Last Twelve Months (LTM)',
    description: 'Measures the company\'s ability to cover total debt with its operating cash flow. Higher values indicate better debt coverage.'
  },
  'Debt/Net Worth': {
    formula: 'Total Liabilities ÷ Total Equity',
    period: 'Point in Time (End of Month)',
    description: 'Measures financial leverage. Also known as Debt-to-Equity ratio. Lower values indicate less leverage and lower financial risk.'
  },
  'Fixed Assets/Net Worth': {
    formula: 'Fixed Assets ÷ Total Equity',
    period: 'Point in Time (End of Month)',
    description: 'Indicates the proportion of equity invested in fixed assets. Shows how much of the company\'s equity is tied up in long-term assets.'
  },
  'Leverage Ratio': {
    formula: 'Total Assets ÷ Total Equity',
    period: 'Point in Time (End of Month)',
    description: 'Measures the degree to which a company is utilizing borrowed money. Higher values indicate higher financial leverage.'
  },
  'Total Asset Turnover': {
    formula: 'Revenue (LTM) ÷ Average Total Assets',
    period: 'Last Twelve Months (LTM)',
    description: 'Measures how efficiently a company uses its assets to generate sales. Higher values indicate better asset utilization.'
  },
  'Return on Equity (ROE)': {
    formula: 'Net Income (LTM) ÷ Average Total Equity',
    period: 'Last Twelve Months (LTM)',
    description: 'Measures profitability relative to shareholders\' equity. Indicates how effectively management is using equity to generate profits.'
  },
  'Return on Assets (ROA)': {
    formula: 'Net Income (LTM) ÷ Average Total Assets',
    period: 'Last Twelve Months (LTM)',
    description: 'Measures how profitable a company is relative to its total assets. Indicates how efficiently management uses assets to generate earnings.'
  },
  'EBITDA Margin': {
    formula: 'EBITDA (LTM) ÷ Revenue (LTM)',
    period: 'Last Twelve Months (LTM)',
    description: 'Measures operating profitability before interest, taxes, depreciation, and amortization. Shows pure operational efficiency.'
  },
  'EBIT Margin': {
    formula: 'EBIT (LTM) ÷ Revenue (LTM)',
    period: 'Last Twelve Months (LTM)',
    description: 'Measures operating profitability before interest and taxes. Also known as Operating Profit Margin.'
  }
};

// LineChart Component
function LineChart({ title, data, valueKey, color, yMax, showTable, compact, formatter, benchmarkValue, showFormulaButton, onFormulaClick, labelFormat }: { 
  title: string; 
  data: Array<any>;
  valueKey?: string;
  color: string;
  yMax?: number | null;
  showTable?: boolean;
  compact?: boolean;
  formatter?: (val: number) => string;
  benchmarkValue?: number | null;
  showFormulaButton?: boolean;
  onFormulaClick?: () => void;
  labelFormat?: 'monthly' | 'quarterly' | 'semi-annual';
}) {
  const chartData = valueKey ? data.map(d => ({ month: d.month, value: d[valueKey] })) : data;
  const validData = chartData.filter(d => d.value !== null && Number.isFinite(d.value));
  if (validData.length === 0) return null;

  const values = validData.map(d => d.value as number);
  const sorted = [...values].sort((a, b) => a - b);
  const q1 = sorted[Math.floor(sorted.length * 0.25)];
  const q3 = sorted[Math.floor(sorted.length * 0.75)];
  const iqr = q3 - q1;
  const lowerBound = q1 - 3 * iqr;
  const upperBound = q3 + 3 * iqr;
  
  const filteredValues = values.filter(v => v >= lowerBound && v <= upperBound);
  const minValue = filteredValues.length > 0 ? Math.min(...filteredValues) : Math.min(...values);
  const maxValue = filteredValues.length > 0 ? Math.max(...filteredValues) : Math.max(...values);
  
  const yMaxCalc = yMax || Math.ceil(maxValue * 1.1);
  const yMinCalc = yMax ? 0 : Math.floor(minValue * 0.9);
  const range = yMaxCalc - yMinCalc;
  
  if (range === 0 || !Number.isFinite(range)) {
    return (
      <div style={{ background: '#f8fafc', borderRadius: '12px', padding: '20px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
        <h3 style={{ fontSize: '16px', fontWeight: '700', color: '#1e293b', marginBottom: '15px' }}>{title}</h3>
        <p style={{ fontSize: '14px', color: '#64748b', textAlign: 'center', padding: '40px 0' }}>
          Unable to display chart - insufficient data variation
        </p>
      </div>
    );
  }

  const width = compact ? 500 : 1100;
  const height = compact ? 250 : 320;
  const padding = { top: 15, right: 30, bottom: 40, left: 50 };
  const chartWidth = width - padding.left - padding.right;
  const chartHeight = height - padding.top - padding.bottom;

  const points = validData.map((d, i) => {
    const x = padding.left + (i / (validData.length - 1)) * chartWidth;
    const clampedValue = Math.max(yMinCalc, Math.min(yMaxCalc, d.value!));
    const y = padding.top + chartHeight - ((clampedValue - yMinCalc) / range) * chartHeight;
    return { x, y, month: d.month, value: d.value!, isOutOfRange: d.value! < yMinCalc || d.value! > yMaxCalc };
  });

  const pathD = points.map((p, i) => `${i === 0 ? 'M' : 'L'} ${p.x} ${p.y}`).join(' ');

  return (
    <div style={{ background: '#f8fafc', borderRadius: '12px', padding: '20px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '15px' }}>
        <h3 style={{ fontSize: '16px', fontWeight: '700', color: '#1e293b', margin: 0 }}>{title}</h3>
        {showFormulaButton && (
          <button
            onClick={onFormulaClick}
            style={{
              background: 'none',
              border: 'none',
              cursor: 'pointer',
              padding: '4px 8px',
              color: '#667eea',
              fontSize: '14px',
              fontWeight: '600',
              display: 'flex',
              alignItems: 'center',
              gap: '4px',
              transition: 'all 0.2s'
            }}
            onMouseOver={(e) => e.currentTarget.style.color = '#4f46e5'}
            onMouseOut={(e) => e.currentTarget.style.color = '#667eea'}
            title="View formula"
          >
            <span style={{ fontSize: '16px' }}>ℹ️</span> Formula
          </button>
        )}
      </div>
      <svg width={width} height={height} style={{ maxWidth: '100%', marginBottom: '10px' }} viewBox={`0 0 ${width} ${height}`} preserveAspectRatio="xMidYMid meet">
        {(() => {
          const gridValues = [];
          const step = range / 4;
          for (let i = 0; i <= 4; i++) {
            gridValues.push(yMinCalc + step * i);
          }
          return gridValues.map((val, idx) => {
            const y = padding.top + chartHeight - ((val - yMinCalc) / range) * chartHeight;
            return (
              <g key={idx}>
                <line x1={padding.left} y1={y} x2={width - padding.right} y2={y} stroke="#e2e8f0" strokeWidth="1" />
                <text x={padding.left - 10} y={y + 4} textAnchor="end" fontSize="11" fill="#94a3b8">
                  {Math.abs(val) >= 100 ? val.toFixed(0) : val.toFixed(1)}
                </text>
              </g>
            );
          });
        })()}
        <line x1={padding.left} y1={height - padding.bottom} x2={width - padding.right} y2={height - padding.bottom} stroke="#cbd5e1" strokeWidth="2" />
        <line x1={padding.left} y1={padding.top} x2={padding.left} y2={height - padding.bottom} stroke="#cbd5e1" strokeWidth="2" />
        <path d={pathD} fill="none" stroke={color} strokeWidth="3" strokeLinecap="round" strokeLinejoin="round" />
        {benchmarkValue != null && benchmarkValue >= yMinCalc && benchmarkValue <= yMaxCalc && (
          <>
            <line 
              x1={padding.left} 
              y1={padding.top + chartHeight - ((benchmarkValue - yMinCalc) / range) * chartHeight} 
              x2={width - padding.right} 
              y2={padding.top + chartHeight - ((benchmarkValue - yMinCalc) / range) * chartHeight} 
              stroke="#f59e0b" 
              strokeWidth="2" 
              strokeDasharray="5,5"
            />
            <text 
              x={width - padding.right + 5} 
              y={padding.top + chartHeight - ((benchmarkValue - yMinCalc) / range) * chartHeight + 4} 
              fontSize="10" 
              fill="#f59e0b" 
              fontWeight="600"
            >
              Industry
            </text>
          </>
        )}
        {points.map((p, i) => (
          <circle key={i} cx={p.x} cy={p.y} r="5" fill={p.isOutOfRange ? '#ef4444' : color} stroke="white" strokeWidth="2">
            <title>{`${p.month}: ${p.value.toFixed(1)}${p.isOutOfRange ? ' (out of range)' : ''}`}</title>
          </circle>
        ))}
        {points.map((p, i) => {
          // Determine label format based on prop (default to semi-annual)
          const format = labelFormat || 'semi-annual';
          
          if (format === 'quarterly') {
            // Convert month to quarterly label (e.g., "2023-03" -> "Q1 '23", "2023-06" -> "Q2 '23")
            const getQuarterLabel = (monthStr: string) => {
              const parts = monthStr.split('-');
              if (parts.length >= 2) {
                const year = parts[0];
                const month = parseInt(parts[1]);
                const quarter = Math.ceil(month / 3);
                return `Q${quarter} '${year.slice(-2)}`;
              }
              return monthStr;
            };
            
            // Show labels at regular intervals - every 3rd point, first point, and last point
            const showEveryNth = 3;
            const shouldShow = i === 0 || i === points.length - 1 || i % showEveryNth === 0;
            
            if (!shouldShow) return null;
            return <text key={i} x={p.x} y={height - padding.bottom + 20} textAnchor="middle" fontSize="11" fill="#64748b">{getQuarterLabel(p.month)}</text>;
          } else {
            // Semi-annual format (default)
            const getSemiAnnualLabel = (monthStr: string) => {
              const parts = monthStr.split('-');
              if (parts.length >= 2) {
                const year = parts[0];
                const month = parseInt(parts[1]);
                const half = month <= 6 ? 1 : 2;
                return `H${half} '${year.slice(-2)}`;
              }
              return monthStr;
            };
            
            const parts = p.month.split('-');
            const month = parts.length >= 2 ? parseInt(parts[1]) : 0;
            const isSemiAnnualEnd = month === 6 || month === 12;
            
            // Fallback: show label every 6 data points if no semi-annual matches
            const showEveryNth = points.length > 12 ? Math.floor(points.length / 4) : 3;
            const showAsBackup = i % showEveryNth === 0 || i === points.length - 1;
            
            if (!isSemiAnnualEnd && !showAsBackup) return null;
            return <text key={i} x={p.x} y={height - padding.bottom + 20} textAnchor="middle" fontSize="11" fill="#64748b">{getSemiAnnualLabel(p.month)}</text>;
          }
        })}
      </svg>
      <div style={{ display: 'grid', gridTemplateColumns: benchmarkValue != null ? 'repeat(5, 1fr)' : 'repeat(4, 1fr)', gap: '10px', marginTop: '15px', padding: '3px 12px', background: 'white', borderRadius: '8px' }}>
        <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
          <div style={{ fontSize: '10px', color: '#64748b', fontWeight: '600' }}>CURRENT:</div>
          <div style={{ fontSize: '16px', fontWeight: '700', color: color }}>{formatter ? formatter(validData[validData.length - 1].value!) : validData[validData.length - 1].value!.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</div>
        </div>
        <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
          <div style={{ fontSize: '10px', color: '#64748b', fontWeight: '600' }}>AVG:</div>
          <div style={{ fontSize: '16px', fontWeight: '700', color: '#1e293b' }}>{formatter ? formatter(sum(values) / values.length) : (sum(values) / values.length).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</div>
        </div>
        <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
          <div style={{ fontSize: '10px', color: '#64748b', fontWeight: '600' }}>MIN:</div>
          <div style={{ fontSize: '16px', fontWeight: '700', color: '#64748b' }}>{formatter ? formatter(Math.min(...values)) : Math.min(...values).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</div>
        </div>
        <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
          <div style={{ fontSize: '10px', color: '#64748b', fontWeight: '600' }}>MAX:</div>
          <div style={{ fontSize: '16px', fontWeight: '700', color: '#64748b' }}>{formatter ? formatter(Math.max(...values)) : Math.max(...values).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</div>
        </div>
        {benchmarkValue != null && (
          <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
            <div style={{ fontSize: '10px', color: '#f59e0b', fontWeight: '600' }}>INDUSTRY:</div>
            <div style={{ fontSize: '16px', fontWeight: '700', color: '#f59e0b' }}>{formatter ? formatter(benchmarkValue) : benchmarkValue.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</div>
          </div>
        )}
      </div>
      
      {showTable && (
        <div style={{ marginTop: '16px', overflowX: 'auto' }}>
          <table style={{ width: '100%', fontSize: '10px', borderCollapse: 'collapse' }}>
            <tbody>
              <tr style={{ background: '#f1f5f9', borderBottom: '2px solid #cbd5e1' }}>
                <td style={{ padding: '6px 8px', fontWeight: '700', color: '#1e293b', position: 'sticky', left: 0, background: '#f1f5f9', zIndex: 1, minWidth: '60px' }}>
                  Month
                </td>
                {validData.map((d, i) => (
                  <td key={`month-${i}`} style={{ padding: '6px', textAlign: 'center', fontWeight: '600', color: '#64748b', minWidth: '70px' }}>
                    {d.month}
                  </td>
                ))}
              </tr>
              <tr style={{ borderBottom: '1px solid #e2e8f0' }}>
                <td style={{ padding: '6px 8px', fontWeight: '700', color: '#1e293b', position: 'sticky', left: 0, background: '#f8fafc', zIndex: 1 }}>
                  Value
                </td>
                {validData.map((d, i) => (
                  <td key={`val-${i}`} style={{ padding: '6px', textAlign: 'center', fontWeight: '700', color: color }}>
                    {formatter ? formatter(d.value!) : d.value!.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                  </td>
                ))}
              </tr>
            </tbody>
          </table>
        </div>
      )}
    </div>
  );
}

// ProjectionChart Component
function ProjectionChart({ title, historicalData, projectedData, valueKey, formatValue }: {
  title: string;
  historicalData: any[];
  projectedData: { mostLikely: any[]; bestCase: any[]; worstCase: any[] };
  valueKey: string;
  formatValue?: (val: number) => string;
}) {
  if (!historicalData || historicalData.length === 0) return null;
  
  const formatter = formatValue || ((v: number) => v.toFixed(1));
  const hist = historicalData.slice(-12).map(d => ({ month: d.month, value: d[valueKey], type: 'historical' }));
  const mostLikely = projectedData.mostLikely.map(d => ({ month: d.month, value: d[valueKey], type: 'mostLikely' }));
  const bestCase = projectedData.bestCase.map(d => ({ month: d.month, value: d[valueKey], type: 'bestCase' }));
  const worstCase = projectedData.worstCase.map(d => ({ month: d.month, value: d[valueKey], type: 'worstCase' }));
  
  const allData = [...hist, ...mostLikely];
  const allValues = [...hist.map(d => d.value), ...mostLikely.map(d => d.value), ...bestCase.map(d => d.value), ...worstCase.map(d => d.value)];
  const minValue = Math.min(...allValues);
  const maxValue = Math.max(...allValues);
  const yMin = Math.floor(minValue * 0.9);
  const yMax = Math.ceil(maxValue * 1.1);
  const range = yMax - yMin;
  
  const width = 580;
  const height = 300;
  const padding = { top: 20, right: 15, bottom: 50, left: 55 };
  const chartWidth = width - padding.left - padding.right;
  const chartHeight = height - padding.top - padding.bottom;
  
  const toPoint = (d: any, i: number) => {
    const x = padding.left + (i / (allData.length - 1)) * chartWidth;
    const y = padding.top + chartHeight - ((d.value - yMin) / range) * chartHeight;
    return { x, y, ...d };
  };
  
  const histPoints = hist.map((d, i) => toPoint(d, i));
  const mlPoints = mostLikely.map((d, i) => toPoint(d, hist.length + i));
  const bcPoints = bestCase.map((d, i) => toPoint(d, hist.length + i));
  const wcPoints = worstCase.map((d, i) => toPoint(d, hist.length + i));
  const lastHistPoint = histPoints[histPoints.length - 1];
  
  const histPath = histPoints.map((p, i) => `${i === 0 ? 'M' : 'L'} ${p.x} ${p.y}`).join(' ');
  const mlPath = `M ${lastHistPoint.x} ${lastHistPoint.y} ` + mlPoints.map(p => `L ${p.x} ${p.y}`).join(' ');
  const bcPath = `M ${lastHistPoint.x} ${lastHistPoint.y} ` + bcPoints.map(p => `L ${p.x} ${p.y}`).join(' ');
  const wcPath = `M ${lastHistPoint.x} ${lastHistPoint.y} ` + wcPoints.map(p => `L ${p.x} ${p.y}`).join(' ');
  
  const firstHistMonth = hist[0].month;
  const lastHistMonth = hist[hist.length - 1].month;
  const lastProjMonth = mostLikely[mostLikely.length - 1].month;
  
  return (
    <div style={{ background: '#f8fafc', borderRadius: '12px', padding: '20px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
      <div style={{ marginBottom: '12px' }}>
        <h3 style={{ fontSize: '16px', fontWeight: '700', color: '#1e293b', marginBottom: '4px' }}>{title}</h3>
        <div style={{ fontSize: '12px', color: '#64748b' }}>
          <span style={{ fontWeight: '600' }}>Historical:</span> {firstHistMonth} to {lastHistMonth} (12 months) 
          <span style={{ margin: '0 8px', color: '#cbd5e1' }}>|</span>
          <span style={{ fontWeight: '600' }}>Projected:</span> {hist[hist.length - 1].month} to {lastProjMonth} (12 months)
        </div>
      </div>
      
      <div style={{ display: 'flex', gap: '16px', alignItems: 'flex-start', flexWrap: 'wrap' }}>
        <div style={{ flex: '1', minWidth: '400px', maxWidth: '580px' }}>
          <svg width={width} height={height} style={{ width: '100%', height: 'auto' }}>
            {[0, 0.25, 0.5, 0.75, 1].map((pct, idx) => {
              const val = yMin + range * pct;
              const y = padding.top + chartHeight - (chartHeight * pct);
              return (
                <g key={idx}>
                  <line x1={padding.left} y1={y} x2={width - padding.right} y2={y} stroke="#e2e8f0" strokeWidth="1" />
                  <text x={padding.left - 10} y={y + 4} textAnchor="end" fontSize="11" fill="#94a3b8">
                    {formatter(val)}
                  </text>
                </g>
              );
            })}
            <line x1={lastHistPoint.x} y1={padding.top} x2={lastHistPoint.x} y2={height - padding.bottom} stroke="#94a3b8" strokeWidth="2" strokeDasharray="5,5" />
            <text x={lastHistPoint.x} y={padding.top - 5} textAnchor="middle" fontSize="11" fill="#64748b" fontWeight="600">Now</text>
            <line x1={padding.left} y1={height - padding.bottom} x2={width - padding.right} y2={height - padding.bottom} stroke="#cbd5e1" strokeWidth="2" />
            <line x1={padding.left} y1={padding.top} x2={padding.left} y2={height - padding.bottom} stroke="#cbd5e1" strokeWidth="2" />
            <path d={histPath} fill="none" stroke="#1e293b" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round" />
            <path d={mlPath} fill="none" stroke="#667eea" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round" />
            <path d={bcPath} fill="none" stroke="#10b981" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" strokeDasharray="5,5" />
            <path d={wcPath} fill="none" stroke="#ef4444" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" strokeDasharray="5,5" />
            {histPoints.map((p, i) => (
              <circle key={`hist-${i}`} cx={p.x} cy={p.y} r="4" fill="#1e293b" stroke="white" strokeWidth="2">
                <title>Historical {p.month}: {formatter(p.value)}</title>
              </circle>
            ))}
            {mlPoints.map((p, i) => (
              <circle key={`ml-${i}`} cx={p.x} cy={p.y} r="5" fill="#667eea" stroke="white" strokeWidth="2">
                <title>Most Likely {p.month}: {formatter(p.value)}</title>
              </circle>
            ))}
            {allData.map((d, i) => {
              const showLabel = i === 0 || i === hist.length - 1 || i === allData.length - 1 || i % 4 === 0;
              if (!showLabel) return null;
              const p = toPoint(d, i);
              return <text key={i} x={p.x} y={height - padding.bottom + 20} textAnchor="middle" fontSize="10" fill="#64748b">{d.month}</text>;
            })}
          </svg>
        </div>
        
        <div style={{ width: '280px', flexShrink: 0, display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '8px' }}>
          <div style={{ background: 'white', borderRadius: '8px', padding: '12px', border: '2px solid #1e293b', boxShadow: '0 2px 4px rgba(0,0,0,0.1)' }}>
            <div style={{ fontSize: '9px', fontWeight: '700', color: '#64748b', letterSpacing: '0.5px', marginBottom: '2px' }}>CURRENT</div>
            <div style={{ fontSize: '9px', color: '#64748b', marginBottom: '6px' }}>Now</div>
            <div style={{ fontSize: '18px', fontWeight: '700', color: '#1e293b' }}>
              {formatter(hist[hist.length - 1].value)}
            </div>
          </div>
          <div style={{ background: '#ede9fe', borderRadius: '8px', padding: '12px', border: '2px solid #667eea', boxShadow: '0 2px 4px rgba(102,126,234,0.2)' }}>
            <div style={{ fontSize: '9px', fontWeight: '700', color: '#5b21b6', letterSpacing: '0.5px', marginBottom: '2px' }}>MOST LIKELY</div>
            <div style={{ fontSize: '9px', color: '#7c3aed', marginBottom: '6px' }}>{lastProjMonth}</div>
            <div style={{ fontSize: '18px', fontWeight: '700', color: '#667eea' }}>
              {formatter(mostLikely[11].value)}
            </div>
            <div style={{ fontSize: '10px', color: '#5b21b6', marginTop: '2px', fontWeight: '600' }}>
              {((mostLikely[11].value / hist[hist.length - 1].value - 1) * 100) >= 0 ? '+' : ''}
              {((mostLikely[11].value / hist[hist.length - 1].value - 1) * 100).toFixed(2)}%
            </div>
          </div>
          <div style={{ background: '#f0fdf4', borderRadius: '8px', padding: '12px', border: '2px solid #10b981', boxShadow: '0 2px 4px rgba(16,185,129,0.2)' }}>
            <div style={{ fontSize: '9px', fontWeight: '700', color: '#166534', letterSpacing: '0.5px', marginBottom: '2px' }}>BEST CASE</div>
            <div style={{ fontSize: '9px', color: '#059669', marginBottom: '6px' }}>{lastProjMonth}</div>
            <div style={{ fontSize: '18px', fontWeight: '700', color: '#10b981' }}>
              {formatter(bestCase[11].value)}
            </div>
            <div style={{ fontSize: '10px', color: '#166534', marginTop: '2px', fontWeight: '600' }}>
              {((bestCase[11].value / hist[hist.length - 1].value - 1) * 100) >= 0 ? '+' : ''}
              {((bestCase[11].value / hist[hist.length - 1].value - 1) * 100).toFixed(2)}%
            </div>
          </div>
          <div style={{ background: '#fef2f2', borderRadius: '8px', padding: '12px', border: '2px solid #ef4444', boxShadow: '0 2px 4px rgba(239,68,68,0.2)' }}>
            <div style={{ fontSize: '9px', fontWeight: '700', color: '#991b1b', letterSpacing: '0.5px', marginBottom: '2px' }}>WORST CASE</div>
            <div style={{ fontSize: '9px', color: '#dc2626', marginBottom: '6px' }}>{lastProjMonth}</div>
            <div style={{ fontSize: '18px', fontWeight: '700', color: '#ef4444' }}>
              {formatter(worstCase[11].value)}
            </div>
            <div style={{ fontSize: '10px', color: '#991b1b', marginTop: '2px', fontWeight: '600' }}>
              {((worstCase[11].value / hist[hist.length - 1].value - 1) * 100) >= 0 ? '+' : ''}
              {((worstCase[11].value / hist[hist.length - 1].value - 1) * 100).toFixed(2)}%
            </div>
          </div>
        </div>
      </div>
      
      <div style={{ marginTop: '20px', overflowX: 'auto', maxWidth: '100%' }}>
        <table style={{ fontSize: '10px', borderCollapse: 'collapse', width: '100%' }}>
          <tbody>
            <tr style={{ background: '#f1f5f9', borderBottom: '2px solid #cbd5e1' }}>
              <td style={{ padding: '6px 8px', fontWeight: '700', color: '#1e293b', position: 'sticky', left: 0, background: '#f1f5f9', zIndex: 1, minWidth: '50px' }}>Month</td>
              {hist.map((d, i) => (
                <td key={`month-hist-${i}`} style={{ padding: '6px 4px', textAlign: 'center', fontWeight: '600', color: '#64748b', background: 'white', minWidth: '60px' }}>
                  {d.month}
                </td>
              ))}
              {mostLikely.slice(0, 6).map((d, i) => (
                <td key={`month-proj-${i}`} style={{ padding: '6px 4px', textAlign: 'center', fontWeight: '600', color: '#667eea', background: '#ede9fe', minWidth: '60px' }}>
                  {d.month}
                </td>
              ))}
            </tr>
            <tr style={{ borderBottom: '1px solid #e2e8f0' }}>
              <td style={{ padding: '6px 8px', fontWeight: '700', color: '#1e293b', position: 'sticky', left: 0, background: '#f8fafc', zIndex: 1, minWidth: '50px' }}>Value</td>
              {hist.map((d, i) => (
                <td key={`val-hist-${i}`} style={{ padding: '6px 4px', textAlign: 'center', fontWeight: '700', color: '#1e293b', background: 'white', fontSize: '10px' }}>
                  {formatter(d.value)}
                </td>
              ))}
              {mostLikely.slice(0, 6).map((d, i) => (
                <td key={`val-proj-${i}`} style={{ padding: '6px 4px', textAlign: 'center', fontWeight: '700', color: '#667eea', background: '#ede9fe', fontSize: '10px' }}>
                  {formatter(d.value)}
                </td>
              ))}
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  );
}

export default function FinancialScorePage() {
  // State - Authentication
  const [isLoggedIn, setIsLoggedIn] = useState<boolean>(false);
  const [currentUser, setCurrentUser] = useState<User | null>(null);
  const [loginEmail, setLoginEmail] = useState('');
  const [loginPassword, setLoginPassword] = useState('');
  const [loginName, setLoginName] = useState('');
  const [isRegistering, setIsRegistering] = useState(false);
  const [loginError, setLoginError] = useState('');
  const [showPassword, setShowPassword] = useState(false);
  const [showForgotPassword, setShowForgotPassword] = useState(false);
  const [resetEmail, setResetEmail] = useState('');
  const [resetSuccess, setResetSuccess] = useState('');
  
  // State - Consultants
  const [consultants, setConsultants] = useState<Consultant[]>([]);
  const [newConsultantType, setNewConsultantType] = useState('');
  const [newConsultantFullName, setNewConsultantFullName] = useState('');
  const [newConsultantAddress, setNewConsultantAddress] = useState('');
  const [newConsultantEmail, setNewConsultantEmail] = useState('');
  const [newConsultantPhone, setNewConsultantPhone] = useState('');
  const [newConsultantPassword, setNewConsultantPassword] = useState('');
  const [selectedConsultantId, setSelectedConsultantId] = useState('');
  const [expandedCompanyIds, setExpandedCompanyIds] = useState<string[]>([]);
  
  // State - Companies & Users
  const [companies, setCompanies] = useState<Company[]>([]);
  const [users, setUsers] = useState<User[]>([]);
  const [selectedCompanyId, setSelectedCompanyId] = useState('');
  const [newCompanyName, setNewCompanyName] = useState('');
  const [newUserName, setNewUserName] = useState('');
  const [newUserEmail, setNewUserEmail] = useState('');
  const [newUserPassword, setNewUserPassword] = useState('');
  // Separate state for Company Users
  const [newCompanyUserName, setNewCompanyUserName] = useState('');
  const [newCompanyUserTitle, setNewCompanyUserTitle] = useState('');
  const [newCompanyUserEmail, setNewCompanyUserEmail] = useState('');
  const [newCompanyUserPhone, setNewCompanyUserPhone] = useState('');
  const [newCompanyUserPassword, setNewCompanyUserPassword] = useState('');
  // Separate state for Assessment Users (no phone field)
  const [newAssessmentUserName, setNewAssessmentUserName] = useState('');
  const [newAssessmentUserTitle, setNewAssessmentUserTitle] = useState('');
  const [newAssessmentUserEmail, setNewAssessmentUserEmail] = useState('');
  const [newAssessmentUserPassword, setNewAssessmentUserPassword] = useState('');
  
  // State - Company Details
  const [showCompanyDetailsModal, setShowCompanyDetailsModal] = useState(false);
  const [editingCompanyId, setEditingCompanyId] = useState('');
  const [companyAddressStreet, setCompanyAddressStreet] = useState('');
  const [companyAddressCity, setCompanyAddressCity] = useState('');
  const [companyAddressState, setCompanyAddressState] = useState('');
  const [companyAddressZip, setCompanyAddressZip] = useState('');
  const [companyAddressCountry, setCompanyAddressCountry] = useState('USA');
  const [companyIndustrySector, setCompanyIndustrySector] = useState<number | ''>('');
  const [expandedCompanyInfoId, setExpandedCompanyInfoId] = useState('');
  const [isManagementAssessmentExpanded, setIsManagementAssessmentExpanded] = useState(false);
  const [isFinancialScoreExpanded, setIsFinancialScoreExpanded] = useState(false);
  
  // State - Projections
  const [defaultBestCaseRevMult, setDefaultBestCaseRevMult] = useState(1.5);
  const [defaultBestCaseExpMult, setDefaultBestCaseExpMult] = useState(0.7);
  const [defaultWorstCaseRevMult, setDefaultWorstCaseRevMult] = useState(0.5);
  const [defaultWorstCaseExpMult, setDefaultWorstCaseExpMult] = useState(1.3);
  const [bestCaseRevMultiplier, setBestCaseRevMultiplier] = useState(1.5);
  const [bestCaseExpMultiplier, setBestCaseExpMultiplier] = useState(0.7);
  const [worstCaseRevMultiplier, setWorstCaseRevMultiplier] = useState(0.5);
  const [worstCaseExpMultiplier, setWorstCaseExpMultiplier] = useState(1.3);
  const [showDefaultSettings, setShowDefaultSettings] = useState(false);
  
  // State - Financial Data
  const [financialDataRecords, setFinancialDataRecords] = useState<FinancialDataRecord[]>([]);
  const [file, setFile] = useState<File | null>(null);
  const [rawRows, setRawRows] = useState<any[]>([]);
  const [columns, setColumns] = useState<string[]>([]);
  const [mapping, setMapping] = useState<Mappings>({ date: '' });
  const [error, setError] = useState<string | null>(null);
  const [isFreshUpload, setIsFreshUpload] = useState<boolean>(false);
  const [loadedMonthlyData, setLoadedMonthlyData] = useState<MonthlyDataRow[]>([]);
  const [currentView, setCurrentView] = useState<'login' | 'admin' | 'siteadmin' | 'upload' | 'results' | 'kpis' | 'mda' | 'projections' | 'working-capital' | 'valuation' | 'cash-flow' | 'financial-statements' | 'trend-analysis' | 'profile' | 'fs-intro' | 'fs-score' | 'ma-welcome' | 'ma-questionnaire' | 'ma-your-results' | 'ma-scores-summary' | 'ma-scoring-guide' | 'ma-charts' | 'custom-print'>('login');

  // Check if current view is allowed for assessment users
  const isAssessmentUserViewAllowed = (view: string) => {
    if (currentUser?.userType !== 'assessment') return true;
    const allowedViews = ['ma-welcome', 'ma-questionnaire', 'ma-your-results', 'ma-scores-summary', 'ma-scoring-guide', 'ma-charts'];
    return allowedViews.includes(view);
  };

  // Redirect assessment users if they try to access unauthorized views - but not during login
  // Handle pending login after business registration redirect
  useEffect(() => {
    const pendingLoginStr = sessionStorage.getItem('pendingLogin');
    if (pendingLoginStr && !isLoggedIn) {
      try {
        const { user, timestamp } = JSON.parse(pendingLoginStr);
        // Only process if less than 10 seconds old
        if (Date.now() - timestamp < 10000) {
          // Normalize role and userType to lowercase
          const normalizedUser = {
            ...user,
            role: user.role.toLowerCase(),
            userType: user.userType?.toLowerCase(),
            consultantType: user.consultantType // Preserve consultantType
          };
          
          setCurrentUser(normalizedUser);
          setIsLoggedIn(true);
          
          // Set appropriate view for business users (consultants)
          if (normalizedUser.role === 'consultant') {
            setCurrentView('admin');
            // Load companies for the consultant
            if (user.consultantId) {
              companiesApi.getAll(user.consultantId).then(({ companies: loadedCompanies }) => {
                setCompanies(loadedCompanies || []);
                // If user just registered and has a company, select it automatically
                if (user.companyId && loadedCompanies && loadedCompanies.length > 0) {
                  const newCompany = loadedCompanies.find((c: any) => c.id === user.companyId);
                  if (newCompany) {
                    setSelectedCompanyId(newCompany.id);
                    setExpandedCompanyInfoId(newCompany.id);
                  }
                }
              });
            }
          } else if (normalizedUser.role === 'siteadmin') {
            setCurrentView('siteadmin');
          } else if (normalizedUser.userType === 'assessment') {
            setCurrentView('ma-welcome');
          } else {
            setCurrentView('upload');
            setSelectedCompanyId(user.companyId || '');
          }
        }
        // Clear the pending login data
        sessionStorage.removeItem('pendingLogin');
      } catch (error) {
        console.error('Error processing pending login:', error);
        sessionStorage.removeItem('pendingLogin');
      }
    }
  }, []);

  useEffect(() => {
    if (currentUser?.userType === 'assessment' && isLoggedIn && currentView !== 'login' && !isAssessmentUserViewAllowed(currentView)) {
      console.log('🚫 useEffect redirecting from', currentView, 'to ma-welcome');
      setCurrentView('ma-welcome');
    }
  }, [currentView, currentUser, isLoggedIn]);

  // Helper function to handle view changes for assessment users
  const handleViewChange = (newView: string) => {
    console.log('🔄 handleViewChange called - newView:', newView, 'userType:', currentUser?.userType, 'isAllowed:', isAssessmentUserViewAllowed(newView));
    if (currentUser?.userType === 'assessment' && !isAssessmentUserViewAllowed(newView)) {
      console.log('❌ View not allowed, redirecting to ma-welcome');
      setCurrentView('ma-welcome');
    } else {
      console.log('✅ Setting view to:', newView);
      setCurrentView(newView as any);
    }
  };
  const [adminDashboardTab, setAdminDashboardTab] = useState<'company-management' | 'import-financials' | 'api-connections' | 'data-review' | 'data-mapping'>('company-management');
  const [companyManagementSubTab, setCompanyManagementSubTab] = useState<'company-management' | 'billing' | 'profile'>('company-management');
  const [siteAdminTab, setSiteAdminTab] = useState<'consultants' | 'businesses'>('consultants');
  const [expandedBusinessIds, setExpandedBusinessIds] = useState<Set<string>>(new Set());
  const [editingPricing, setEditingPricing] = useState<{[key: string]: any}>({});
  const [editingConsultantInfo, setEditingConsultantInfo] = useState<{[key: string]: any}>({});
  const [expandedConsultantInfo, setExpandedConsultantInfo] = useState<Set<string>>(new Set());
  const [siteAdminViewingAs, setSiteAdminViewingAs] = useState<any>(null);
  const [showAddConsultantForm, setShowAddConsultantForm] = useState(false);
  const [kpiDashboardTab, setKpiDashboardTab] = useState<'all-ratios' | 'priority-ratios'>('all-ratios');
  const [priorityRatios, setPriorityRatios] = useState<string[]>([
    'Current Ratio', 'Quick Ratio', 'ROE', 'ROA', 'Interest Coverage', 'Debt/Net Worth'
  ]);

  // Available ratios by category for Priority Ratios tab
  const ratioCategories = {
    'Liquidity': ['Current Ratio', 'Quick Ratio'],
    'Activity': ['Inventory Turnover', 'Receivables Turnover', 'Payables Turnover', 'Days Inventory', 'Days Receivables', 'Days Payables', 'Sales/Working Capital'],
    'Coverage': ['Interest Coverage', 'Debt Service Coverage', 'Cash Flow to Debt'],
    'Leverage': ['Debt/Net Worth', 'Fixed Assets/Net Worth', 'Leverage Ratio'],
    'Operating': ['Total Asset Turnover', 'ROE', 'ROA', 'EBITDA Margin', 'EBIT Margin']
  };

  const allAvailableRatios = Object.values(ratioCategories).flat();

  // Helper function to get ratio value key for LineChart
  const getRatioValueKey = (ratioName: string): string => {
    const ratioMap: Record<string, string> = {
      'Current Ratio': 'currentRatio',
      'Quick Ratio': 'quickRatio',
      'Inventory Turnover': 'invTurnover',
      'Receivables Turnover': 'arTurnover',
      'Payables Turnover': 'apTurnover',
      'Days Inventory': 'daysInv',
      'Days Receivables': 'daysAR',
      'Days Payables': 'daysAP',
      'Sales/Working Capital': 'salesWC',
      'Interest Coverage': 'interestCov',
      'Debt Service Coverage': 'debtSvcCov',
      'Cash Flow to Debt': 'cfToDebt',
      'Debt/Net Worth': 'debtToNW',
      'Fixed Assets/Net Worth': 'fixedToNW',
      'Leverage Ratio': 'leverage',
      'Total Asset Turnover': 'totalAssetTO',
      'ROE': 'roe',
      'ROA': 'roa',
      'EBITDA Margin': 'ebitdaMargin',
      'EBIT Margin': 'ebitMargin'
    };
    return ratioMap[ratioName] || '';
  };

  // Helper function to get ratio color
  const getRatioColor = (ratioName: string): string => {
    const colorMap: Record<string, string> = {
      'Current Ratio': '#10b981',
      'Quick Ratio': '#14b8a6',
      'Inventory Turnover': '#f59e0b',
      'Receivables Turnover': '#f97316',
      'Payables Turnover': '#ef4444',
      'Days Inventory': '#fbbf24',
      'Days Receivables': '#fb923c',
      'Days Payables': '#f87171',
      'Sales/Working Capital': '#06b6d4',
      'Interest Coverage': '#8b5cf6',
      'Debt Service Coverage': '#a78bfa',
      'Cash Flow to Debt': '#c4b5fd',
      'Debt/Net Worth': '#ec4899',
      'Fixed Assets/Net Worth': '#f472b6',
      'Leverage Ratio': '#f9a8d4',
      'Total Asset Turnover': '#3b82f6',
      'ROE': '#60a5fa',
      'ROA': '#93c5fd',
      'EBITDA Margin': '#2563eb',
      'EBIT Margin': '#1e40af'
    };
    return colorMap[ratioName] || '#64748b';
  };

  // Helper function to get ratio formatter
  const getRatioFormatter = (ratioName: string): ((v: number) => string) => {
    if (ratioName.includes('Days')) {
      return (v: number) => v.toFixed(0);
    }
    return (v: number) => v.toFixed(1);
  };

  // Function to save priority ratios
  const savePriorityRatios = () => {
    localStorage.setItem('fs_priorityRatios', JSON.stringify(priorityRatios));
    alert('Priority ratios saved successfully!');
  };
  
  // State - Subscription Pricing
  const [subscriptionMonthlyPrice, setSubscriptionMonthlyPrice] = useState<number | undefined>();
  const [subscriptionQuarterlyPrice, setSubscriptionQuarterlyPrice] = useState<number | undefined>();
  const [subscriptionAnnualPrice, setSubscriptionAnnualPrice] = useState<number | undefined>();
  
  // State - Management Assessment
  const [assessmentResponses, setAssessmentResponses] = useState<AssessmentResponses>({});
  const [assessmentNotes, setAssessmentNotes] = useState<AssessmentNotes>({});
  const [assessmentRecords, setAssessmentRecords] = useState<AssessmentRecord[]>([]);
  const [unansweredQuestions, setUnansweredQuestions] = useState<string[]>([]);
  
  // State - Trend Analysis
  const [selectedTrendItem, setSelectedTrendItem] = useState<string>('revenue');
  const [trendAnalysisTab, setTrendAnalysisTab] = useState<'item-trends' | 'expense-analysis'>('item-trends');
  
  // State - Valuation
  const [sdeMultiplier, setSdeMultiplier] = useState(2.5);
  const [ebitdaMultiplier, setEbitdaMultiplier] = useState(5.0);
  const [dcfDiscountRate, setDcfDiscountRate] = useState(10.0);
  const [dcfTerminalGrowth, setDcfTerminalGrowth] = useState(2.0);

  // State - Industry Benchmarks
  const [benchmarks, setBenchmarks] = useState<any[]>([]);

  // State - Company Profiles
  const [companyProfiles, setCompanyProfiles] = useState<CompanyProfile[]>([]);
  
  // State - QuickBooks Raw Data
  const [qbRawData, setQbRawData] = useState<any>(null);
  const [dataRefreshKey, setDataRefreshKey] = useState(0);

  // State - QuickBooks Connection
  const [qbConnected, setQbConnected] = useState(false);

  // State - Financial Statements
  const [statementType, setStatementType] = useState<'income-statement' | 'balance-sheet' | 'income-statement-percent'>('income-statement');
  const [statementPeriod, setStatementPeriod] = useState<'current-month' | 'current-quarter' | 'last-12-months' | 'ytd' | 'last-year' | 'last-3-years'>('current-month');
  const [financialStatementsTab, setFinancialStatementsTab] = useState<'aggregated' | 'line-of-business'>('aggregated');
  const [selectedLineOfBusiness, setSelectedLineOfBusiness] = useState<string>('all');
  const [statementDisplay, setStatementDisplay] = useState<'monthly' | 'quarterly' | 'annual'>('monthly');
  const [cashFlowDisplay, setCashFlowDisplay] = useState<'monthly' | 'quarterly' | 'annual'>('monthly');
  
  // State - MD&A Tabs
  const [mdaTab, setMdaTab] = useState<'executive-summary' | 'strengths-insights' | 'key-metrics'>('executive-summary');
  
  // State - Formula Popup
  const [showFormulaPopup, setShowFormulaPopup] = useState<string | null>(null);

  // State - AI Mapping
  const [aiMappings, setAiMappings] = useState<any[]>([]);
  const [isGeneratingMappings, setIsGeneratingMappings] = useState(false);
  const [isSavingMappings, setIsSavingMappings] = useState(false);
  
  // State - Lines of Business
  const [linesOfBusiness, setLinesOfBusiness] = useState<string[]>(['', '', '', '', '']);
  const [showMappingSection, setShowMappingSection] = useState(false);
  const [isProcessingMonthlyData, setIsProcessingMonthlyData] = useState(false);
  const [qbStatus, setQbStatus] = useState<'ACTIVE' | 'INACTIVE' | 'ERROR' | 'EXPIRED' | 'NOT_CONNECTED'>('NOT_CONNECTED');
  const [qbLastSync, setQbLastSync] = useState<Date | null>(null);
  const [qbSyncing, setQbSyncing] = useState(false);
  const [qbError, setQbError] = useState<string | null>(null);
  

  // State - API Loading & Errors
  const [isLoading, setIsLoading] = useState(false);
  const [apiError, setApiError] = useState<string | null>(null);
  const [dataLoaded, setDataLoaded] = useState(false);

  // State - Custom Print Package
  const [printPackageSelections, setPrintPackageSelections] = useState({
    mda: false,
    financialScore: false,
    priorityRatios: false,
    workingCapital: false,
    cashFlow4Quarters: false,
    cashFlow3Years: false,
    incomeStatement12MonthsQuarterly: false,
    incomeStatement3YearsAnnual: false,
    balanceSheet12MonthsQuarterly: false,
    balanceSheet3YearsAnnual: false,
    profile: false
  });

  // Load from localStorage (DEPRECATED - will be removed)
  useEffect(() => {
    const saved = {
      consultants: localStorage.getItem('fs_consultants'),
      companies: localStorage.getItem('fs_companies'),
      users: localStorage.getItem('fs_users'),
      currentUser: localStorage.getItem('fs_currentUser'),
      records: localStorage.getItem('fs_financialDataRecords'),
      selectedCompany: localStorage.getItem('fs_selectedCompanyId'),
      defaults: localStorage.getItem('fs_projectionDefaults'),
      assessmentResponses: localStorage.getItem('fs_assessmentResponses'),
      assessmentNotes: localStorage.getItem('fs_assessmentNotes'),
      assessmentRecords: localStorage.getItem('fs_assessmentRecords'),
      companyProfiles: localStorage.getItem('fs_companyProfiles'),
      priorityRatios: localStorage.getItem('fs_priorityRatios')
    };
    
    // Check user type first to determine if we should load assessment data
    const savedUser = saved.currentUser ? JSON.parse(saved.currentUser) : null;
    const isAssessmentUser = savedUser?.userType === 'assessment';
    
    if (saved.consultants) setConsultants(JSON.parse(saved.consultants));
    if (saved.companies) setCompanies(JSON.parse(saved.companies));
    if (saved.users) setUsers(JSON.parse(saved.users));
    if (saved.records) setFinancialDataRecords(JSON.parse(saved.records));
    if (saved.selectedCompany) setSelectedCompanyId(saved.selectedCompany);
    // Don't load assessment responses from localStorage for assessment users - they'll load from DB
    if (saved.assessmentResponses && !isAssessmentUser) setAssessmentResponses(JSON.parse(saved.assessmentResponses));
    if (saved.assessmentNotes && !isAssessmentUser) setAssessmentNotes(JSON.parse(saved.assessmentNotes));
    if (saved.assessmentRecords) setAssessmentRecords(JSON.parse(saved.assessmentRecords));
    if (saved.companyProfiles) setCompanyProfiles(JSON.parse(saved.companyProfiles));
    if (saved.priorityRatios) setPriorityRatios(JSON.parse(saved.priorityRatios));
    
    if (saved.defaults) {
      const d = JSON.parse(saved.defaults);
      setDefaultBestCaseRevMult(d.bestCaseRev || 1.5);
      setDefaultBestCaseExpMult(d.bestCaseExp || 0.7);
      setDefaultWorstCaseRevMult(d.worstCaseRev || 0.5);
      setDefaultWorstCaseExpMult(d.worstCaseExp || 1.3);
      setBestCaseRevMultiplier(d.bestCaseRev || 1.5);
      setBestCaseExpMultiplier(d.bestCaseExp || 0.7);
      setWorstCaseRevMultiplier(d.worstCaseRev || 0.5);
      setWorstCaseExpMultiplier(d.worstCaseExp || 1.3);
    }
    
    if (saved.currentUser) {
      const user = JSON.parse(saved.currentUser);
      
      // Don't auto-login assessment users from localStorage - they should login fresh each time
      if (user.userType === 'assessment') {
        localStorage.removeItem('fs_currentUser');
        return;
      }
      
      setCurrentUser(user);
      setIsLoggedIn(true);
      
      // Set appropriate default view based on user type
      if (user.role === 'siteadmin') {
        setCurrentView('siteadmin');
      } else if (user.role === 'consultant') {
        setCurrentView('admin');
      } else {
        setCurrentView('upload');
      }
    }
  }, []);

  useEffect(() => { if (consultants.length > 0) localStorage.setItem('fs_consultants', JSON.stringify(consultants)); }, [consultants]);
  useEffect(() => { if (companies.length > 0) localStorage.setItem('fs_companies', JSON.stringify(companies)); }, [companies]);
  useEffect(() => { if (users.length > 0) localStorage.setItem('fs_users', JSON.stringify(users)); }, [users]);
  useEffect(() => { if (currentUser) localStorage.setItem('fs_currentUser', JSON.stringify(currentUser)); }, [currentUser]);
  useEffect(() => { if (financialDataRecords.length > 0) localStorage.setItem('fs_financialDataRecords', JSON.stringify(financialDataRecords)); }, [financialDataRecords]);
  
  useEffect(() => { if (Object.keys(assessmentResponses).length > 0 && currentUser?.userType !== 'assessment') localStorage.setItem('fs_assessmentResponses', JSON.stringify(assessmentResponses)); }, [assessmentResponses, currentUser]);
  useEffect(() => { if (Object.keys(assessmentNotes).length > 0 && currentUser?.userType !== 'assessment') localStorage.setItem('fs_assessmentNotes', JSON.stringify(assessmentNotes)); }, [assessmentNotes, currentUser]);
  useEffect(() => { if (assessmentRecords.length > 0) localStorage.setItem('fs_assessmentRecords', JSON.stringify(assessmentRecords)); }, [assessmentRecords]);
  useEffect(() => { if (companyProfiles.length > 0) localStorage.setItem('fs_companyProfiles', JSON.stringify(companyProfiles)); }, [companyProfiles]);
  useEffect(() => { if (priorityRatios.length > 0) localStorage.setItem('fs_priorityRatios', JSON.stringify(priorityRatios)); }, [priorityRatios]);

  useEffect(() => {
    if (selectedCompanyId) {
      localStorage.setItem('fs_selectedCompanyId', selectedCompanyId);
      const record = financialDataRecords.find(r => r.companyId === selectedCompanyId);
      if (record) {
        setIsFreshUpload(false);
        setRawRows(record.rawRows);
        setMapping(record.mapping);
        setFile({ name: record.fileName } as File);
        setColumns(record.rawRows.length > 0 ? Object.keys(record.rawRows[0]) : []);
      } else {
        setRawRows([]);
        setMapping({ date: '' });
        setFile(null);
        setColumns([]);
        setIsFreshUpload(false);
      }
    }
  }, [selectedCompanyId, financialDataRecords]);

  // Handle URL parameters for navigation and messages
  useEffect(() => {
    const urlParams = new URLSearchParams(window.location.search);
    const view = urlParams.get('view');
    const tab = urlParams.get('tab');
    const success = urlParams.get('success');
    const error = urlParams.get('error');

    // Set view if specified
    if (view === 'admin') {
      setCurrentView('admin');
    }

    // Set admin dashboard tab if specified
    if (tab === 'api-connections' || tab === 'import-financials' || tab === 'company-management' || tab === 'data-review') {
      setAdminDashboardTab(tab);
    }

    // Show success message
    if (success === 'quickbooks_connected') {
      alert('QuickBooks connected successfully! You can now sync your financial data.');
      // Clean URL
      window.history.replaceState({}, '', window.location.pathname + '?view=admin');
    }

    // Show error message
    if (error === 'quickbooks_connection_failed') {
      alert('Failed to connect to QuickBooks. Please try again.');
      // Clean URL
      window.history.replaceState({}, '', window.location.pathname + '?view=admin');
    }
  }, []);

  // Load company-specific data from API when company is selected
  useEffect(() => {
    const loadCompanyData = async () => {
      if (!selectedCompanyId || !currentUser) return;
      
      try {
        // ALWAYS clear state at the start to prevent stale data
        console.log('🧹 Clearing all state before loading new company data');
        setQbRawData(null);
        setRawRows([]);
        setMapping({ date: '' });
        setFile(null);
        setColumns([]);
        
        // Load users for this company
        console.log('Loading users for company:', selectedCompanyId);
        const { users: companyUsers } = await usersApi.getByCompany(selectedCompanyId);
        console.log('Users loaded from API:', companyUsers);
        
        // Normalize role and userType to lowercase
        const normalizedUsers = companyUsers.map((u: any) => ({
          ...u,
          role: u.role.toLowerCase(),
          userType: u.userType?.toLowerCase()
        }));
        console.log('Normalized users:', normalizedUsers);
        
        setUsers((prevUsers) => {
          const otherUsers = prevUsers.filter(u => u.companyId !== selectedCompanyId);
          const newUsers = [...otherUsers, ...normalizedUsers];
          console.log('Setting users state:', newUsers);
          return newUsers;
        });
        
        // Load financial records
        const selectedCompany = companies.find(c => c.id === selectedCompanyId);
        const companyName = selectedCompany?.name || 'Unknown';
        console.log(`📂 LOADING DATA FOR: "${companyName}" (ID: ${selectedCompanyId})`);
        
        const { records } = await financialsApi.getByCompany(selectedCompanyId);
        console.log(`📂 Found ${records.length} financial records for company "${companyName}"`);
        
        // If no records found, clear aiMappings as well
        if (!records || records.length === 0) {
          console.log(`🧹 No records found - clearing aiMappings too`);
          setAiMappings([]);
        } else if (records && records.length > 0) {
          const latestRecord = records[0];
          console.log(`📂 Latest record ID: ${latestRecord.id}, created: ${latestRecord.createdAt}`);
          
          // Check if this is QuickBooks data and extract raw QB financial statements
          if (latestRecord.rawData && typeof latestRecord.rawData === 'object' && 
              !Array.isArray(latestRecord.rawData) &&
              (latestRecord.rawData.profitAndLoss || latestRecord.rawData.balanceSheet)) {
            // QuickBooks data - use monthlyData directly
            console.log(`🔄 Loading QB data for company: "${companyName}" (${selectedCompanyId})`);
            console.log(`📄 Record belongs to company ID: ${latestRecord.companyId}`);
            console.log(`📅 QB Data sync date:`, latestRecord.rawData.syncDate);
            console.log(`🔑 QB rawData object keys:`, Object.keys(latestRecord.rawData));
            console.log(`✅ SETTING qbRawData with sync date:`, latestRecord.rawData.syncDate);
            // Add companyId to the raw data so we can verify it matches
            setQbRawData({
              ...latestRecord.rawData,
              _companyId: selectedCompanyId,
              _recordId: latestRecord.id
            });
            console.log(`⚠️ Set qbRawData for company: ${selectedCompanyId}, record: ${latestRecord.id}`);
            // Force re-render of Financial Statements view
            setDataRefreshKey(prev => prev + 1);
            setRawRows([]); // Set empty array since rawRows is not used for QB data
            setMapping(latestRecord.columnMapping || { date: '' });
            setFile({ name: latestRecord.fileName } as File);
            setColumns([]);
            
            // Convert monthlyData to the format expected by the app
            const convertedMonthly = latestRecord.monthlyData.map((m: any) => ({
              date: new Date(m.monthDate),
              month: new Date(m.monthDate).toLocaleDateString('en-US', { month: '2-digit', year: 'numeric' }),
              revenue: m.revenue || 0,
              expense: m.expense || 0,
              cogsPayroll: m.cogsPayroll || 0,
              cogsOwnerPay: m.cogsOwnerPay || 0,
              cogsContractors: m.cogsContractors || 0,
              cogsMaterials: m.cogsMaterials || 0,
              cogsCommissions: m.cogsCommissions || 0,
              cogsOther: m.cogsOther || 0,
              cogsTotal: m.cogsTotal || 0,
              cash: m.cash || 0,
              ar: m.ar || 0,
              inventory: m.inventory || 0,
              otherCA: m.otherCA || 0,
              tca: m.tca || 0,
              fixedAssets: m.fixedAssets || 0,
              otherAssets: m.otherAssets || 0,
              totalAssets: m.totalAssets || 0,
              ap: m.ap || 0,
              otherCL: m.otherCL || 0,
              tcl: m.tcl || 0,
              ltd: m.ltd || 0,
              totalLiab: m.totalLiab || 0,
              totalEquity: m.totalEquity || 0,
              totalLAndE: m.totalLAndE || 0
            }));
            setLoadedMonthlyData(convertedMonthly);
          } else {
            // CSV data - set rawRows for processing
            setQbRawData(null);
            setRawRows(latestRecord.rawData);
            setMapping(latestRecord.columnMapping);
            setFile({ name: latestRecord.fileName } as File);
            setColumns(Object.keys(latestRecord.rawData[0] || {}));
            setLoadedMonthlyData([]); // Clear loaded data for CSV
          }
        }
        
        // Load assessment records
        console.log(`📊 Loading assessment records for company: ${selectedCompanyId}`);
        const { records: assessments } = await assessmentsApi.getByCompany(selectedCompanyId);
        console.log(`📊 Loaded ${assessments?.length || 0} assessment records:`, assessments);
        setAssessmentRecords(assessments || []);
        console.log(`✅ Assessment records set in state`);
        
        // Load company profile
        const { profile } = await profilesApi.get(selectedCompanyId);
        if (profile) {
          setCompanyProfiles((prev) => {
            const filtered = prev.filter(p => p.companyId !== selectedCompanyId);
            return [...filtered, profile];
          });
        }
        
        // Load saved account mappings
        try {
          const mappingsResponse = await fetch(`/api/account-mappings?companyId=${selectedCompanyId}`);
          if (mappingsResponse.ok) {
            const { mappings } = await mappingsResponse.json();
            if (mappings && mappings.length > 0) {
              console.log('Loaded saved account mappings:', mappings);
              setAiMappings(mappings);
              setShowMappingSection(true);
            }
          }
        } catch (error) {
          console.error('Error loading account mappings:', error);
        }
        
        // Load industry benchmarks
        const company = companies.find(c => c.id === selectedCompanyId);
        if (company && company.industrySector) {
          console.log('Company has industry sector:', company.industrySector);
          // Get the latest Total Assets to determine asset size category
          let assetCategory = '1m-5m'; // Default to middle range
          if (records && records.length > 0) {
            const latestRecord = records[0];
            const monthlyData = latestRecord.monthlyData || [];
            if (monthlyData.length > 0) {
              const mostRecentMonth = monthlyData[monthlyData.length - 1];
              const totalAssets = mostRecentMonth.totalAssets || 0;
              assetCategory = getAssetSizeCategory(totalAssets);
              console.log('Total Assets:', totalAssets, '-> Asset Category:', assetCategory);
            }
          }
          
          // Fetch benchmarks for this industry and asset size
          console.log('Fetching benchmarks for industry:', company.industrySector, 'assetSize:', assetCategory);
          const benchmarkData = await benchmarksApi.get(String(company.industrySector), assetCategory);
          setBenchmarks(benchmarkData || []);
          console.log('✅ Loaded', benchmarkData?.length || 0, 'benchmarks');
          if (benchmarkData && benchmarkData.length > 0) {
            console.log('Sample benchmarks:', benchmarkData.slice(0, 3).map(b => b.metricName).join(', '));
          }
        } else {
          console.log('⚠️ Cannot load benchmarks:', !company ? 'Company not found' : 'Industry sector not set');
        }

        // Load subscription pricing for this company
        if (company) {
          setSubscriptionMonthlyPrice(company.subscriptionMonthlyPrice);
          setSubscriptionQuarterlyPrice(company.subscriptionQuarterlyPrice);
          setSubscriptionAnnualPrice(company.subscriptionAnnualPrice);
        }

        // Check QuickBooks connection status
        await checkQBStatus(selectedCompanyId);
      } catch (error) {
        console.error('Error loading company data:', error);
      }
    };
    
    loadCompanyData();
  }, [selectedCompanyId, currentUser, qbLastSync]);


  // Load companies for consultants
  useEffect(() => {
    const loadConsultantCompanies = async () => {
      if (!currentUser || currentUser.role !== 'consultant' || !currentUser.consultantId) return;
      
      try {
        const { companies: consultantCompanies } = await companiesApi.getAll(currentUser.consultantId);
        setCompanies(consultantCompanies || []);
        
        // Load all users and assessment records for all companies
        const allUsers: User[] = [];
        const allAssessments: AssessmentRecord[] = [];
        for (const company of consultantCompanies || []) {
          try {
            // Load users for this company
            const { users: companyUsers } = await usersApi.getByCompany(company.id);
            if (companyUsers) {
              const normalizedUsers = companyUsers.map((u: any) => ({
                ...u,
                role: u.role?.toLowerCase() || 'user',
                userType: u.userType?.toLowerCase() || 'company'
              }));
              allUsers.push(...normalizedUsers);
            }
            
            // Load assessment records for this company
            const { records } = await assessmentsApi.getByCompany(company.id);
            if (records) {
              console.log(`📊 Loaded ${records.length} assessment records for company ${company.id} (${company.name}):`, 
                records.map(r => ({ userEmail: r.user?.email, companyId: r.companyId, answersCount: Object.keys(r.responses || {}).length }))
              );
              allAssessments.push(...records);
            }
          } catch (error) {
            console.error(`Error loading data for company ${company.id}:`, error);
          }
        }
        console.log(`✅ Total loaded: ${allUsers.length} users, ${allAssessments.length} assessment records`);
        console.log(`Assessment users:`, allUsers.filter(u => u.userType === 'assessment').map(u => ({ email: u.email, companyId: u.companyId })));
        setUsers(allUsers);
        setAssessmentRecords(allAssessments);
      } catch (error) {
        console.error('Error loading consultant companies:', error);
      }
    };
    
    loadConsultantCompanies();
  }, [currentUser]);

  // Load consultants for site admin
  useEffect(() => {
    const loadConsultants = async () => {
      if (!currentUser || currentUser.role !== 'siteadmin') return;
      
      try {
        const { consultants: loadedConsultants } = await consultantsApi.getAll();
        setConsultants(loadedConsultants || []);
        
        // Also load all companies and users for display
        const allCompanies: any[] = [];
        const allUsers: any[] = [];
        for (const consultant of loadedConsultants || []) {
          if (consultant.companies) {
            allCompanies.push(...consultant.companies);
          }
        }
        setCompanies(allCompanies);
      } catch (error) {
        console.error('Error loading consultants:', error);
      }
    };
    
    loadConsultants();
  }, [currentUser]);

  // Load financial data when company is selected
  useEffect(() => {
    const loadFinancialData = async () => {
      if (!selectedCompanyId) {
        setLoadedMonthlyData([]);
        return;
      }
      
      try {
        console.log('Loading financial data for company:', selectedCompanyId);
        const response = await fetch(`/api/financials?companyId=${selectedCompanyId}`);
        
        if (!response.ok) {
          console.log('No financial data found for company');
          setLoadedMonthlyData([]);
          return;
        }
        
        const data = await response.json();
        if (data.records && data.records.length > 0 && data.records[0].monthlyData) {
          const monthlyData = data.records[0].monthlyData;
          
          // Convert API data to the format expected by the app
          const formattedData = monthlyData.map((m: any) => ({
            date: new Date(m.monthDate),
            month: m.month || new Date(m.monthDate).toLocaleDateString('en-US', { month: '2-digit', year: 'numeric' }),
            revenue: m.revenue || 0,
            expense: m.expense || 0,
            cogsPayroll: m.cogsPayroll || 0,
            cogsOwnerPay: m.cogsOwnerPay || 0,
            cogsContractors: m.cogsContractors || 0,
            cogsMaterials: m.cogsMaterials || 0,
            cogsCommissions: m.cogsCommissions || 0,
            cogsOther: m.cogsOther || 0,
            cogsTotal: m.cogsTotal || 0,
            opexSalesMarketing: m.salesExpense || m.opexSalesMarketing || 0,
            rentLease: m.rent || m.rentLease || 0,
            utilities: m.utilities || 0,
            equipment: m.infrastructure || m.equipment || 0,
            travel: m.autoTravel || m.travel || 0,
            professionalServices: m.professionalFees || m.professionalServices || 0,
            insurance: m.insurance || 0,
            opexOther: m.marketing || m.opexOther || 0,
            opexPayroll: m.payroll || m.opexPayroll || 0,
            ownersBasePay: m.ownerBasePay || m.ownersBasePay || 0,
            ownersRetirement: m.ownersRetirement || 0,
            contractorsDistribution: m.subcontractors || m.contractorsDistribution || 0,
            interestExpense: m.interestExpense || 0,
            depreciationExpense: m.depreciationAmortization || m.depreciationExpense || 0,
            operatingExpenseTotal: m.operatingExpenseTotal || 0,
            nonOperatingIncome: m.nonOperatingIncome || 0,
            extraordinaryItems: m.extraordinaryItems || 0,
            netProfit: m.netProfit || 0,
            totalAssets: m.totalAssets || 0,
            totalLiab: m.totalLiab || 0,
            cash: m.cash || 0,
            ar: m.ar || 0,
            inventory: m.inventory || 0,
            otherCA: m.otherCA || 0,
            tca: m.tca || 0,
            fixedAssets: m.fixedAssets || 0,
            otherAssets: m.otherAssets || 0,
            ap: m.ap || 0,
            otherCL: m.otherCL || 0,
            tcl: m.tcl || 0,
            ltd: m.ltd || 0,
            totalEquity: m.totalEquity || 0,
            totalLAndE: m.totalLAndE || 0
          }));
          
          console.log('✅ Loaded', formattedData.length, 'months of financial data from database');
          console.log('📊 RAW from database (sample):', {
            revenue: monthlyData[0]?.revenue,
            payroll: monthlyData[0]?.payroll,
            professionalFees: monthlyData[0]?.professionalFees,
            rent: monthlyData[0]?.rent
          });
          console.log('📊 FORMATTED for display (sample):', {
            revenue: formattedData[0]?.revenue,
            opexPayroll: formattedData[0]?.opexPayroll,
            professionalServices: formattedData[0]?.professionalServices,
            rentLease: formattedData[0]?.rentLease
          });
          setLoadedMonthlyData(formattedData);
        } else {
          console.log('No monthly data in response');
          setLoadedMonthlyData([]);
        }
      } catch (error) {
        console.error('Error loading financial data:', error);
        setLoadedMonthlyData([]);
      }
    };
    
    loadFinancialData();
  }, [selectedCompanyId, qbLastSync]);

  useEffect(() => {
    const saveFinancialData = async () => {
      if (!file || rawRows.length === 0 || !mapping.date || !selectedCompanyId || !currentUser || !isFreshUpload) return;
      
      try {
        console.log('Saving financial data to database...');
        // Use normalizeRows to process the data
        const normalized = normalizeRows(rawRows, mapping);
        
        // Process raw rows to get full data with all fields (same as monthly useMemo)
        const fullMonthlyData = rawRows.map((row, i) => {
          const monthValue = row[mapping.date] || `Month ${i + 1}`;
          // Parse date string to create monthDate
          let monthDate = new Date();
          if (monthValue && monthValue.includes('/')) {
            const [month, day, year] = monthValue.split('/');
            monthDate = new Date(parseInt(year), parseInt(month) - 1, 1);
          } else if (monthValue && monthValue.includes('-')) {
            monthDate = new Date(monthValue);
          }
          
          return {
          month: monthValue,
          monthDate: monthDate.toISOString(),
          revenue: parseFloat(row[mapping.revenue!]) || 0,
          expense: parseFloat(row[mapping.expense!]) || 0,
          cogsPayroll: parseFloat(row[mapping.cogsPayroll!]) || 0,
          cogsOwnerPay: parseFloat(row[mapping.cogsOwnerPay!]) || 0,
          cogsContractors: parseFloat(row[mapping.cogsContractors!]) || 0,
          cogsMaterials: parseFloat(row[mapping.cogsMaterials!]) || 0,
          cogsCommissions: parseFloat(row[mapping.cogsCommissions!]) || 0,
          cogsOther: parseFloat(row[mapping.cogsOther!]) || 0,
          cogsTotal: parseFloat(row[mapping.cogsTotal!]) || 0,
          opexSalesMarketing: parseFloat(row[mapping.opexSalesMarketing!]) || 0,
          rentLease: parseFloat(row[mapping.rentLease!]) || 0,
          utilities: parseFloat(row[mapping.utilities!]) || 0,
          equipment: parseFloat(row[mapping.equipment!]) || 0,
          travel: parseFloat(row[mapping.travel!]) || 0,
          professionalServices: parseFloat(row[mapping.professionalServices!]) || 0,
          insurance: parseFloat(row[mapping.insurance!]) || 0,
          opexOther: parseFloat(row[mapping.opexOther!]) || 0,
          opexPayroll: parseFloat(row[mapping.opexPayroll!]) || 0,
          ownersBasePay: parseFloat(row[mapping.ownersBasePay!]) || 0,
          ownersRetirement: parseFloat(row[mapping.ownersRetirement!]) || 0,
          contractorsDistribution: parseFloat(row[mapping.contractorsDistribution!]) || 0,
          interestExpense: parseFloat(row[mapping.interestExpense!]) || 0,
          depreciationExpense: parseFloat(row[mapping.depreciationExpense!]) || 0,
          operatingExpenseTotal: parseFloat(row[mapping.operatingExpenseTotal!]) || 0,
          nonOperatingIncome: parseFloat(row[mapping.nonOperatingIncome!]) || 0,
          extraordinaryItems: parseFloat(row[mapping.extraordinaryItems!]) || 0,
          netProfit: parseFloat(row[mapping.netProfit!]) || 0,
          totalAssets: parseFloat(row[mapping.totalAssets!]) || 0,
          totalLiab: parseFloat(row[mapping.totalLiab!]) || 0,
          cash: parseFloat(row[mapping.cash!]) || 0,
          ar: parseFloat(row[mapping.ar!]) || 0,
          inventory: parseFloat(row[mapping.inventory!]) || 0,
          otherCA: parseFloat(row[mapping.otherCA!]) || 0,
          tca: parseFloat(row[mapping.tca!]) || 0,
          fixedAssets: parseFloat(row[mapping.fixedAssets!]) || 0,
          otherAssets: parseFloat(row[mapping.otherAssets!]) || 0,
          ap: parseFloat(row[mapping.ap!]) || 0,
          otherCL: parseFloat(row[mapping.otherCL!]) || 0,
          tcl: parseFloat(row[mapping.tcl!]) || 0,
          ltd: parseFloat(row[mapping.ltd!]) || 0,
          totalEquity: parseFloat(row[mapping.totalEquity!]) || 0,
          totalLAndE: parseFloat(row[mapping.totalLAndE!]) || 0
          };
        });
        
        console.log('📤 Uploading', fullMonthlyData.length, 'months of data for company', selectedCompanyId);
        console.log('📊 Sample Excel values from row 0:', { 
          revenue: rawRows[0]?.[mapping.revenue!], 
          expense: rawRows[0]?.[mapping.expense!],
          professionalServices: rawRows[0]?.[mapping.professionalServices!]
        });
        console.log('📊 First 3 months PARSED:', fullMonthlyData.slice(0, 3).map(m => ({ 
          month: m.month, 
          revenue: m.revenue, 
          expense: m.expense,
          professionalServices: m.professionalServices
        })));
        
        const result = await financialsApi.upload({
          companyId: selectedCompanyId,
          uploadedByUserId: currentUser.id,
          fileName: file.name,
          rawData: rawRows,
          columnMapping: mapping,
          monthlyData: fullMonthlyData
        });
        
        console.log('Financial data saved successfully:', result);
        setIsFreshUpload(false);
        
        // Immediately set loadedMonthlyData so reports show it
        setLoadedMonthlyData(fullMonthlyData);
        
        alert('Financial data saved successfully! You can now view it in the reports.');
      } catch (error) {
        console.error('Error saving financial data:', error);
        const errorMsg = error instanceof ApiError ? error.message : 'Failed to save financial data';
        setError(errorMsg);
        alert('Error saving financial data: ' + errorMsg);
      }
    };
    
    if (isFreshUpload) {
      saveFinancialData();
    }
  }, [mapping, rawRows, file, selectedCompanyId, currentUser, isFreshUpload]);

  // Auto-map columns
  const autoMapColumns = (columnNames: string[]): Mappings => {
    const mapping: Mappings = { date: '' };
    const normalize = (str: string) => str.toLowerCase().trim().replace(/[^a-z0-9]/g, '');
    
    columnNames.forEach(col => {
      const n = normalize(col);
      // Core fields
      if (!mapping.date && (n.includes('date') || n.includes('month') || n.includes('period'))) mapping.date = col;
      if (!mapping.revenue && (n.includes('grossrevenue') || n.includes('totalgrossrevenue') || n.includes('revenue') || n.includes('sales'))) mapping.revenue = col;
      if (!mapping.expense && (n.includes('totalexpense') || (n.includes('expense') && n.includes('total')))) mapping.expense = col;
      
      // COGS
      if (!mapping.cogsPayroll && n.includes('cogs') && n.includes('payroll')) mapping.cogsPayroll = col;
      if (!mapping.cogsOwnerPay && n.includes('cogs') && n.includes('owner')) mapping.cogsOwnerPay = col;
      if (!mapping.cogsContractors && n.includes('cogs') && n.includes('contractor')) mapping.cogsContractors = col;
      if (!mapping.cogsMaterials && n.includes('cogs') && n.includes('material')) mapping.cogsMaterials = col;
      if (!mapping.cogsCommissions && n.includes('cogs') && (n.includes('comsn') || n.includes('commission'))) mapping.cogsCommissions = col;
      if (!mapping.cogsOther && n.includes('cogs') && n.includes('other')) mapping.cogsOther = col;
      if (!mapping.cogsTotal && n.includes('cogs') && n.includes('total')) mapping.cogsTotal = col;
      
      // OPEX
      if (!mapping.opexSalesMarketing && ((n.includes('opex') && (n.includes('sales') || n.includes('marketing'))) || (n === 'salesandmarketing' || n === 'salesmarketing'))) mapping.opexSalesMarketing = col;
      if (!mapping.rentLease && (n.includes('rent') || n.includes('lease'))) mapping.rentLease = col;
      if (!mapping.utilities && n.includes('utilit')) mapping.utilities = col;
      if (!mapping.equipment && n.includes('equipment')) mapping.equipment = col;
      if (!mapping.travel && n.includes('travel')) mapping.travel = col;
      if (!mapping.professionalServices && n.includes('professional')) mapping.professionalServices = col;
      if (!mapping.insurance && n.includes('insurance')) mapping.insurance = col;
      if (!mapping.opexOther && ((n.includes('opex') && n.includes('other')) || n === 'otheropex')) mapping.opexOther = col;
      if (!mapping.opexPayroll && ((n.includes('opex') && n.includes('payroll')) || (n === 'payroll' && !n.includes('cogs')))) mapping.opexPayroll = col;
      
      // Owners & Other Expenses
      if (!mapping.ownersBasePay && n.includes('owners') && n.includes('base')) mapping.ownersBasePay = col;
      if (!mapping.ownersRetirement && n.includes('owners') && n.includes('retirement')) mapping.ownersRetirement = col;
      if (!mapping.contractorsDistribution && n.includes('contractors') && n.includes('distribution')) mapping.contractorsDistribution = col;
      if (!mapping.interestExpense && n.includes('interest')) mapping.interestExpense = col;
      if (!mapping.depreciationExpense && n.includes('depreciation')) mapping.depreciationExpense = col;
      if (!mapping.operatingExpenseTotal && n.includes('operating') && n.includes('expense') && n.includes('total')) mapping.operatingExpenseTotal = col;
      if (!mapping.nonOperatingIncome && (n.includes('nonoperating') || n.includes('nonoperatng')) && n.includes('income')) mapping.nonOperatingIncome = col;
      if (!mapping.extraordinaryItems && (n.includes('extraordinary') || n.includes('extraordinaryitems'))) mapping.extraordinaryItems = col;
      if (!mapping.netProfit && (n.includes('netprofit') || n.includes('netincome'))) mapping.netProfit = col;
      
      // Assets
      if (!mapping.totalAssets && (n.includes('totalasset') || n === 'totalassets' || n === 'assets')) mapping.totalAssets = col;
      if (!mapping.cash && n === 'cash') mapping.cash = col;
      if (!mapping.ar && (n.includes('accountsreceivable') || n.includes('receivable') || n === 'ar')) mapping.ar = col;
      if (!mapping.inventory && n.includes('inventory')) mapping.inventory = col;
      if (!mapping.otherCA && (n.includes('othercurrentasset') || n === 'othercurrentassets')) mapping.otherCA = col;
      if (!mapping.tca && (n.includes('totalcurrentasset') || n === 'totalcurrentassets' || n === 'currentassets')) mapping.tca = col;
      if (!mapping.fixedAssets && (n.includes('fixedasset') || n === 'fixedassets')) mapping.fixedAssets = col;
      if (!mapping.otherAssets && (n.includes('otherasset') && !n.includes('current'))) mapping.otherAssets = col;
      
      // Liabilities & Equity
      if (!mapping.totalLiab && (n.includes('totalliab') || n === 'totalliabilities' || n === 'liabilities')) mapping.totalLiab = col;
      if (!mapping.ap && (n.includes('accountspayable') || n.includes('payable') || n === 'ap')) mapping.ap = col;
      if (!mapping.otherCL && (n.includes('othercurrentliab') || n === 'othercurrentliabilities')) mapping.otherCL = col;
      if (!mapping.tcl && (n.includes('totalcurrentliab') || n === 'totalcurrentliabilities' || n === 'currentliabilities')) mapping.tcl = col;
      if (!mapping.ltd && (n.includes('longtermdebt') || n.includes('ltd') || n === 'longtermdebt')) mapping.ltd = col;
      if (!mapping.totalEquity && (n.includes('totalequity') || n.includes('equity') || n.includes('networth'))) mapping.totalEquity = col;
      if (!mapping.totalLAndE && (n.includes('liabequity') || n.includes('liabilitiesequity'))) mapping.totalLAndE = col;
    });
    return mapping;
  };

  // Handlers
  const handleLogin = async () => {
    setLoginError('');
    setIsLoading(true);
    
    if (!loginEmail || !loginPassword) {
      setLoginError('Please enter both email and password');
      setIsLoading(false);
      return;
    }
    
    try {
      const { user } = await authApi.login(loginEmail, loginPassword);
      
      // Normalize role and userType to lowercase for frontend compatibility
      const normalizedUser = {
        ...user,
        role: user.role.toLowerCase(),
        userType: user.userType?.toLowerCase()
      };
      
      setCurrentUser(normalizedUser);
      setIsLoggedIn(true);
      
      // Clear assessment data from localStorage for assessment users
      if (normalizedUser.userType === 'assessment') {
        localStorage.removeItem('fs_assessmentResponses');
        localStorage.removeItem('fs_assessmentNotes');
        setAssessmentResponses({});
        setAssessmentNotes({});
      }
      
      // Set appropriate default view based on user type
      if (normalizedUser.role === 'siteadmin') {
        setCurrentView('siteadmin');
      } else if (normalizedUser.role === 'consultant') {
        setCurrentView('admin');
      } else if (normalizedUser.userType === 'assessment') {
        setCurrentView('ma-welcome');
      } else {
        setCurrentView('upload');
      }
      
      if (normalizedUser.role !== 'consultant' && normalizedUser.role !== 'siteadmin') {
        setSelectedCompanyId(user.companyId || '');
      }
      
      // Load user's data after login
      if (normalizedUser.role === 'consultant' && user.consultantId) {
        const { companies: loadedCompanies } = await companiesApi.getAll(user.consultantId);
        setCompanies(loadedCompanies || []);
      }
      
      setLoginEmail('');
      setLoginPassword('');
      setLoginError('');
    } catch (error) {
      if (error instanceof ApiError) {
        setLoginError(error.message);
      } else {
        setLoginError('Login failed. Please try again.');
      }
    } finally {
      setIsLoading(false);
    }
  };

  const handleRegisterConsultant = async () => {
    setLoginError('');
    setIsLoading(true);
    
    if (!loginName || !loginEmail || !loginPassword) { 
      setLoginError('Please fill in all fields');
      setIsLoading(false);
      return; 
    }
    
    try {
      const { user } = await authApi.register({
        name: loginName,
        email: loginEmail,
        password: loginPassword,
        fullName: loginName
      });
      
      // Normalize role and userType to lowercase for frontend compatibility
      const normalizedUser = {
        ...user,
        role: user.role.toLowerCase(),
        userType: user.userType?.toLowerCase()
      };
      
      setCurrentUser(normalizedUser);
      setIsLoggedIn(true);
      setCurrentView('admin');
      setLoginName('');
      setLoginEmail('');
      setLoginPassword('');
      setIsRegistering(false);
      setLoginError('');
    } catch (error) {
      if (error instanceof ApiError) {
        if (error.status === 409) {
          setLoginError('This email is already registered. Please login instead.');
        } else {
          setLoginError(error.message);
        }
      } else {
        setLoginError('Registration failed. Please try again.');
      }
    } finally {
      setIsLoading(false);
    }
  };

  const handleLogout = () => {
    setCurrentUser(null);
    setIsLoggedIn(false);
    setCurrentView('login');
    setSelectedCompanyId('');
    setRawRows([]);
    setMapping({ date: '' });
    setFile(null);
    setColumns([]);
    localStorage.removeItem('fs_currentUser');
    localStorage.removeItem('fs_selectedCompanyId');
  };

  const addCompany = async () => {
    if (!newCompanyName || !currentUser) {
      alert('Please enter a company name');
      return;
    }
    
    if (!currentUser.consultantId) {
      alert('Error: No consultant ID found. Please log out and log back in.');
      console.error('Current user:', currentUser);
      return;
    }
    
    setIsLoading(true);
    try {
      console.log('Creating company:', { name: newCompanyName, consultantId: currentUser.consultantId });
      const { company } = await companiesApi.create({
        name: newCompanyName,
        consultantId: currentUser.consultantId
      });
      console.log('Company created:', company);
      setCompanies([...companies, company]);
      setNewCompanyName('');
      
      // Automatically select the newly created company
      setSelectedCompanyId(company.id);
      
      alert('Company created successfully!');
    } catch (error) {
      console.error('Error creating company:', error);
      alert(error instanceof ApiError ? error.message : 'Failed to create company');
    } finally {
      setIsLoading(false);
    }
  };

  const deleteCompany = async (companyId: string) => {
    if (!confirm('Delete this company and all its users?')) return;
    setIsLoading(true);
    try {
      await companiesApi.delete(companyId);
      setCompanies(companies.filter(c => c.id !== companyId));
      setUsers(users.filter(u => u.companyId !== companyId));
      setFinancialDataRecords(financialDataRecords.filter(r => r.companyId !== companyId));
      if (selectedCompanyId === companyId) setSelectedCompanyId('');
    } catch (error) {
      alert(error instanceof ApiError ? error.message : 'Failed to delete company');
    } finally {
      setIsLoading(false);
    }
  };

  // QuickBooks Functions
  const checkQBStatus = async (companyId: string) => {
    try {
      const response = await fetch(`/api/quickbooks/status?companyId=${companyId}`);
      const data = await response.json();
      
      if (data.connected) {
        setQbConnected(true);
        setQbStatus(data.status);
        // Only update qbLastSync if the timestamp actually changed (prevent infinite loop)
        const newSyncTime = data.lastSyncAt ? new Date(data.lastSyncAt).getTime() : null;
        const currentSyncTime = qbLastSync ? qbLastSync.getTime() : null;
        if (newSyncTime !== currentSyncTime) {
          setQbLastSync(data.lastSyncAt ? new Date(data.lastSyncAt) : null);
        }
        setQbError(data.errorMessage);
      } else {
        setQbConnected(false);
        setQbStatus('NOT_CONNECTED');
        if (qbLastSync !== null) {
          setQbLastSync(null);
        }
        setQbError(null);
      }
    } catch (error) {
      console.error('Failed to check QuickBooks status:', error);
      setQbError('Failed to check connection status');
    }
  };

  const connectQuickBooks = async () => {
    if (!selectedCompanyId) {
      alert('Please select a company first');
      return;
    }

    try {
      const response = await fetch(`/api/quickbooks/auth?companyId=${selectedCompanyId}`);
      const data = await response.json();
      
      if (data.authUri) {
        // Redirect to QuickBooks OAuth page
        window.location.href = data.authUri;
      } else {
        throw new Error('Failed to generate authorization URL');
      }
    } catch (error) {
      console.error('Failed to initiate QuickBooks connection:', error);
      alert('Failed to connect to QuickBooks. Please try again.');
    }
  };

  const syncQuickBooks = async () => {
    if (!selectedCompanyId || !currentUser) {
      alert('Please select a company first');
      return;
    }

    setQbSyncing(true);
    setQbError(null);

    try {
      const response = await fetch('/api/quickbooks/sync', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ 
          companyId: selectedCompanyId,
          userId: currentUser.id
        }),
      });

      const data = await response.json();

      if (response.ok) {
        // Update sync timestamp - this will trigger the useEffect to reload data
        setQbLastSync(new Date());
        
        // Refresh QuickBooks status
        if (selectedCompanyId) {
          await checkQBStatus(selectedCompanyId);
        }
        
        alert(`QuickBooks data synced successfully! ${data.recordsImported || 0} months of financial data imported.`);
      } else {
        // Include detailed error message from API
        const errorMsg = data.details ? `${data.error}: ${data.details}` : (data.error || 'Sync failed');
        throw new Error(errorMsg);
      }
    } catch (error: any) {
      console.error('QuickBooks sync error:', error);
      const errorMessage = error.message || 'Failed to sync data';
      setQbError(errorMessage);
      alert('Failed to sync QuickBooks data:\n\n' + errorMessage);
    } finally {
      setQbSyncing(false);
    }
  };

  const disconnectQuickBooks = async () => {
    if (!selectedCompanyId) return;

    if (!confirm('Are you sure you want to disconnect QuickBooks? You can reconnect anytime.')) {
      return;
    }

    try {
      const response = await fetch('/api/quickbooks/disconnect', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ companyId: selectedCompanyId }),
      });

      const data = await response.json();

      if (response.ok) {
        setQbConnected(false);
        setQbStatus('NOT_CONNECTED');
        setQbLastSync(null);
        setQbError(null);
        alert('QuickBooks disconnected successfully');
      } else {
        throw new Error(data.error || 'Disconnect failed');
      }
    } catch (error: any) {
      console.error('QuickBooks disconnect error:', error);
      alert('Failed to disconnect QuickBooks: ' + (error.message || 'Unknown error'));
    }
  };

  const getCompanyUsers = (companyId: string, userType?: 'company' | 'assessment') => {
    if (userType) {
      return users.filter(u => u.companyId === companyId && u.role === 'user' && u.userType === userType);
    }
    return users.filter(u => u.companyId === companyId && u.role === 'user');
  };
  const getCurrentCompany = () => companies.find(c => c.id === selectedCompanyId);

  const handleSelectCompany = (companyId: string) => {
    const company = companies.find(c => c.id === companyId);
    if (!company) return;
    
    // Select the company
    setSelectedCompanyId(companyId);
    
    // Navigate to Consultant Dashboard to show company details
    setCurrentView('admin');
    
    // Automatically expand this company's section
    setExpandedCompanyInfoId(companyId);
  };

  const saveCompanyDetails = async () => {
    if (!companyIndustrySector) { 
      alert('Please select an industry sector'); 
      return; 
    }
    setIsLoading(true);
    try {
      const { company } = await companiesApi.update(editingCompanyId, {
        addressStreet: companyAddressStreet,
        addressCity: companyAddressCity,
        addressState: companyAddressState,
        addressZip: companyAddressZip,
        addressCountry: companyAddressCountry,
        industrySector: companyIndustrySector as number
      });
      setCompanies(companies.map(c => c.id === editingCompanyId ? { ...c, ...company } : c));
      setSelectedCompanyId(editingCompanyId);
      setShowCompanyDetailsModal(false);
      
      // Expand the company that was just saved
      setExpandedCompanyInfoId(editingCompanyId);
      
      setEditingCompanyId('');
      setCompanyAddressStreet('');
      setCompanyAddressCity('');
      setCompanyAddressState('');
      setCompanyAddressZip('');
      setCompanyAddressCountry('USA');
      setCompanyIndustrySector('');
      
      // Stay on Consultant Dashboard
      setCurrentView('admin');
    } catch (error) {
      alert(error instanceof ApiError ? error.message : 'Failed to update company');
    } finally {
      setIsLoading(false);
    }
  };

  const saveSubscriptionPricing = async () => {
    if (!selectedCompanyId) {
      alert('Please select a company first');
      return;
    }
    setIsLoading(true);
    try {
      const { company } = await companiesApi.update(selectedCompanyId, {
        subscriptionMonthlyPrice: subscriptionMonthlyPrice,
        subscriptionQuarterlyPrice: subscriptionQuarterlyPrice,
        subscriptionAnnualPrice: subscriptionAnnualPrice
      });
      // Update the companies list with the new pricing
      setCompanies(companies.map(c => c.id === selectedCompanyId ? { ...c, ...company } : c));
      alert('✅ Subscription pricing saved successfully!');
    } catch (error) {
      alert(error instanceof ApiError ? error.message : 'Failed to save subscription pricing');
    } finally {
      setIsLoading(false);
    }
  };

  const addUser = async (companyId: string, userType: 'company' | 'assessment' = 'company') => {
    // Get the appropriate state variables based on userType
    const name = userType === 'company' ? newCompanyUserName : newAssessmentUserName;
    const title = userType === 'company' ? newCompanyUserTitle : newAssessmentUserTitle;
    const email = userType === 'company' ? newCompanyUserEmail : newAssessmentUserEmail;
    const phone = userType === 'company' ? newCompanyUserPhone : undefined; // Phone only for company users
    const password = userType === 'company' ? newCompanyUserPassword : newAssessmentUserPassword;
    
    if (!name || !email || !password) { 
      alert('Please fill all required fields (Name, Email, Password)'); 
      return; 
    }
    
    setIsLoading(true);
    try {
      console.log('Creating user:', { name, title, email, phone, companyId, userType: userType.toUpperCase() });
      console.log('Current users in state:', users);
      console.log('Filtered company users:', users.filter(u => u.companyId === companyId && u.userType === 'company'));
      console.log('Filtered assessment users:', users.filter(u => u.companyId === companyId && u.userType === 'assessment'));
      
      const { user } = await usersApi.create({
        name,
        title,
        email,
        phone,
        password,
        companyId: companyId,
        userType: userType.toUpperCase() as 'COMPANY' | 'ASSESSMENT'
      });
      console.log('User created from API:', user);
      
      // Normalize role and userType to lowercase
      const normalizedUser = {
        ...user,
        role: user.role.toLowerCase(),
        userType: user.userType?.toLowerCase()
      };
      console.log('Normalized user:', normalizedUser);
      
      setUsers([...users, normalizedUser]);
      console.log('Users after adding:', [...users, normalizedUser]);
      
      // Clear the appropriate fields based on userType
      if (userType === 'company') {
        setNewCompanyUserName('');
        setNewCompanyUserTitle('');
        setNewCompanyUserEmail('');
        setNewCompanyUserPhone('');
        setNewCompanyUserPassword('');
      } else {
        setNewAssessmentUserName('');
        setNewAssessmentUserTitle('');
        setNewAssessmentUserEmail('');
        setNewAssessmentUserPassword('');
      }
      
      alert(`${userType === 'company' ? 'Company' : 'Assessment'} user created successfully!`);
    } catch (error) {
      console.error('Error creating user:', error);
      if (error instanceof ApiError) {
        if (error.message.includes('already registered')) {
          alert(`⚠️ Email already in use\n\n"${email}" is already registered in the system.\n\nPlease use a different email address.`);
        } else {
          alert(error.message);
        }
      } else {
        alert('Failed to add user');
      }
    } finally {
      setIsLoading(false);
    }
  };

  const deleteUser = async (userId: string) => {
    if (!confirm('Delete this user?')) return;
    setIsLoading(true);
    try {
      await usersApi.delete(userId);
      setUsers(users.filter(u => u.id !== userId));
    } catch (error) {
      alert(error instanceof ApiError ? error.message : 'Failed to delete user');
    } finally {
      setIsLoading(false);
    }
  };

  // Consultant CRUD functions
  const addConsultant = async () => {
    if (!newConsultantType || !newConsultantFullName || !newConsultantAddress || !newConsultantEmail || !newConsultantPhone || !newConsultantPassword) {
      alert('Please fill all consultant fields');
      return;
    }
    setIsLoading(true);
    try {
      const { consultant } = await consultantsApi.create({
        fullName: newConsultantFullName,
        email: newConsultantEmail,
        password: newConsultantPassword,
        address: newConsultantAddress,
        phone: newConsultantPhone,
        type: newConsultantType
      });
      
      // Add to local state (will be refreshed on next load)
      const newConsultant: Consultant = {
        id: consultant.id,
        type: consultant.type || newConsultantType,
        fullName: consultant.fullName,
        address: consultant.address || newConsultantAddress,
        email: consultant.email,
        phone: consultant.phone || newConsultantPhone,
        password: '' // Don't store password in state
      };
      setConsultants([...consultants, newConsultant]);
      
      // Clear form
      setNewConsultantType('');
      setNewConsultantFullName('');
      setNewConsultantAddress('');
      setNewConsultantEmail('');
      setNewConsultantPhone('');
      setNewConsultantPassword('');
    } catch (error) {
      alert(error instanceof ApiError ? error.message : 'Failed to add consultant');
    } finally {
      setIsLoading(false);
    }
  };

  const updateCompanyPricing = async (companyId: string, pricing: { monthly: number; quarterly: number; annual: number }) => {
    try {
      await companiesApi.updatePricing(companyId, pricing.monthly, pricing.quarterly, pricing.annual);
      
      // Update local state
      setCompanies(companies.map(c => 
        c.id === companyId 
          ? { 
              ...c, 
              subscriptionMonthlyPrice: pricing.monthly,
              subscriptionQuarterlyPrice: pricing.quarterly,
              subscriptionAnnualPrice: pricing.annual
            } 
          : c
      ));
      
      // Clear editing state
      setEditingPricing((prev) => {
        const newState = { ...prev };
        delete newState[companyId];
        return newState;
      });
      
      alert('Pricing updated successfully');
    } catch (error) {
      alert(error instanceof ApiError ? error.message : 'Failed to update pricing');
    }
  };

  const updateConsultantInfo = async (consultantId: string, info: { fullName: string; email: string; address: string; phone: string; type: string }) => {
    try {
      const response = await consultantsApi.update(consultantId, info);
      
      // Update local state
      setConsultants(consultants.map(c => 
        c.id === consultantId 
          ? { 
              ...c, 
              fullName: info.fullName,
              email: info.email,
              address: info.address,
              phone: info.phone,
              type: info.type
            } 
          : c
      ));
      
      // Clear editing state
      setEditingConsultantInfo((prev) => {
        const newState = { ...prev };
        delete newState[consultantId];
        return newState;
      });
      
      alert('Consultant information updated successfully');
    } catch (error) {
      alert(error instanceof ApiError ? error.message : 'Failed to update consultant information');
    }
  };

  const deleteConsultant = async (consultantId: string) => {
    if (!confirm('Delete this consultant? This will also delete all their companies and users.')) return;
    setIsLoading(true);
    try {
      await consultantsApi.delete(consultantId);
      
      // Update local state
      setConsultants(consultants.filter(c => c.id !== consultantId));
      const consultantCompanies = companies.filter(c => c.consultantId === consultantId);
      const companyIds = consultantCompanies.map(c => c.id);
      setCompanies(companies.filter(c => c.consultantId !== consultantId));
      setUsers(users.filter(u => !companyIds.includes(u.companyId) && u.id !== consultantId));
      setFinancialDataRecords(financialDataRecords.filter(r => !companyIds.includes(r.companyId)));
      setAssessmentRecords(assessmentRecords.filter(r => !companyIds.includes(r.companyId)));
    } catch (error) {
      alert(error instanceof ApiError ? error.message : 'Failed to delete consultant');
    } finally {
      setIsLoading(false);
    }
  };

  const getConsultantCompanies = (consultantId: string) => {
    return companies.filter(c => c.consultantId === consultantId).sort((a, b) => a.name.localeCompare(b.name));
  };

  const handleFile = async (e: ChangeEvent<HTMLInputElement>) => {
    const f = e.target.files?.[0];
    if (!f) return;
    if (!selectedCompanyId) { alert('Please select a company first'); return; }

    setFile(f);
    setError(null);
    setIsFreshUpload(true);
    const ab = await f.arrayBuffer();
    const wb = XLSX.read(ab, { cellDates: false });
    
    // Use Sheet1 if available (transposed format), otherwise use first sheet
    const sheetName = wb.SheetNames.includes('Sheet1') ? 'Sheet1' : wb.SheetNames[0];
    
    const ws = wb.Sheets[sheetName];
    const json = XLSX.utils.sheet_to_json(ws, { header: 1, raw: true, defval: null });
    if (json.length < 2) { setError('File appears empty or invalid'); return; }
    
    // Check if this is a transposed format (field names in column A, dates in row 0)
    const firstCell = json[0] && json[0][0];
    const isTransposed = firstCell === null || firstCell === '' || (typeof firstCell === 'number' && firstCell > 40000); // Excel date serial numbers
    
    if (isTransposed) {
      // Transposed format: Row 0 has dates, Column A has field names
      console.log('Detected transposed format, converting...');
      const dateRow = json[0] as any[];
      const dates = dateRow.slice(1).filter(d => d !== null && d !== ''); // Skip first column
      
      // Convert Excel serial numbers to dates
      const parsedDates = dates.map(d => {
        if (typeof d === 'number') {
          const excelEpoch = new Date(1899, 11, 30);
          const date = new Date(excelEpoch.getTime() + d * 24 * 60 * 60 * 1000);
          return `${date.getMonth() + 1}/${date.getDate()}/${date.getFullYear()}`;
        }
        return d;
      });
      
      // Build normal format: each row is a month
      const rows: any[] = [];
      for (let monthIdx = 0; monthIdx < parsedDates.length; monthIdx++) {
        const monthRow: any = { 'Date': parsedDates[monthIdx] };
        
        // For each field (row in original)
        for (let fieldIdx = 1; fieldIdx < json.length; fieldIdx++) {
          const fieldRow = json[fieldIdx] as any[];
          const fieldName = fieldRow[0];
          const fieldValue = fieldRow[monthIdx + 1]; // +1 because column 0 is field name
          if (fieldName) {
            monthRow[fieldName] = fieldValue;
          }
        }
        rows.push(monthRow);
      }
      
      const header = ['Date', ...json.slice(1).map(r => r[0]).filter(n => n)];
      setRawRows(rows);
      setColumns(header);
      setMapping(autoMapColumns(header));
    } else {
      // Normal format: Row 0 has headers, each row is a month
      const header = json[0] as any[];
      const dataRows = json.slice(1);
      const rows = dataRows.map(row => {
        const obj: any = {};
        header.forEach((h, i) => { obj[h] = (row as any[])[i] == null || (row as any[])[i] === '' ? null : (row as any[])[i]; });
        return obj;
      });
      setRawRows(rows);
      setColumns(header);
      setMapping(autoMapColumns(header));
    }
  };

  // Calculate monthly data
  const monthly = useMemo(() => {
    // If we have loaded monthly data from QuickBooks, use it directly
    if (loadedMonthlyData && loadedMonthlyData.length > 0) {
      return loadedMonthlyData;
    }
    
    // Otherwise, process from CSV rawRows
    if (!rawRows || rawRows.length === 0 || !mapping.date) return [];
    return rawRows.map((row, i) => ({
      month: row[mapping.date] || `Month ${i + 1}`,
      // Income Statement
      revenue: parseFloat(row[mapping.revenue!]) || 0,
      expense: parseFloat(row[mapping.expense!]) || 0,
      cogsPayroll: parseFloat(row[mapping.cogsPayroll!]) || 0,
      cogsOwnerPay: parseFloat(row[mapping.cogsOwnerPay!]) || 0,
      cogsContractors: parseFloat(row[mapping.cogsContractors!]) || 0,
      cogsMaterials: parseFloat(row[mapping.cogsMaterials!]) || 0,
      cogsCommissions: parseFloat(row[mapping.cogsCommissions!]) || 0,
      cogsOther: parseFloat(row[mapping.cogsOther!]) || 0,
      cogsTotal: parseFloat(row[mapping.cogsTotal!]) || 0,
      opexSalesMarketing: parseFloat(row[mapping.opexSalesMarketing!]) || 0,
      rentLease: parseFloat(row[mapping.rentLease!]) || 0,
      utilities: parseFloat(row[mapping.utilities!]) || 0,
      equipment: parseFloat(row[mapping.equipment!]) || 0,
      travel: parseFloat(row[mapping.travel!]) || 0,
      professionalServices: parseFloat(row[mapping.professionalServices!]) || 0,
      insurance: parseFloat(row[mapping.insurance!]) || 0,
      opexOther: parseFloat(row[mapping.opexOther!]) || 0,
      opexPayroll: parseFloat(row[mapping.opexPayroll!]) || 0,
      ownersBasePay: parseFloat(row[mapping.ownersBasePay!]) || 0,
      ownersRetirement: parseFloat(row[mapping.ownersRetirement!]) || 0,
      contractorsDistribution: parseFloat(row[mapping.contractorsDistribution!]) || 0,
      interestExpense: parseFloat(row[mapping.interestExpense!]) || 0,
      depreciationExpense: parseFloat(row[mapping.depreciationExpense!]) || 0,
      operatingExpenseTotal: parseFloat(row[mapping.operatingExpenseTotal!]) || 0,
      nonOperatingIncome: parseFloat(row[mapping.nonOperatingIncome!]) || 0,
      extraordinaryItems: parseFloat(row[mapping.extraordinaryItems!]) || 0,
      netProfit: parseFloat(row[mapping.netProfit!]) || 0,
      // Balance Sheet - Assets (reusing from above if already defined)
      totalAssets: parseFloat(row[mapping.totalAssets!]) || 0,
      totalLiab: parseFloat(row[mapping.totalLiab!]) || 0,
      cash: parseFloat(row[mapping.cash!]) || 0,
      ar: parseFloat(row[mapping.ar!]) || 0,
      inventory: parseFloat(row[mapping.inventory!]) || 0,
      otherCA: parseFloat(row[mapping.otherCA!]) || 0,
      tca: parseFloat(row[mapping.tca!]) || 0,
      fixedAssets: parseFloat(row[mapping.fixedAssets!]) || 0,
      otherAssets: parseFloat(row[mapping.otherAssets!]) || 0,
      ap: parseFloat(row[mapping.ap!]) || 0,
      otherCL: parseFloat(row[mapping.otherCL!]) || 0,
      tcl: parseFloat(row[mapping.tcl!]) || 0,
      ltd: parseFloat(row[mapping.ltd!]) || 0,
      totalEquity: parseFloat(row[mapping.totalEquity!]) || 0,
      totalLAndE: parseFloat(row[mapping.totalLAndE!]) || 0
    }));
  }, [rawRows, mapping, loadedMonthlyData]);

  const ltmRev = monthly.length >= 12 ? monthly.slice(-12).reduce((sum, m) => sum + m.revenue, 0) : 0;
  const ltmExp = monthly.length >= 12 ? monthly.slice(-12).reduce((sum, m) => sum + m.expense, 0) : 0;
  
  const growth_24mo = monthly.length >= 24 ? ((ltmRev - monthly.slice(-24, -12).reduce((sum, m) => sum + m.revenue, 0)) / monthly.slice(-24, -12).reduce((sum, m) => sum + m.revenue, 0)) * 100 : 0;
  const growth_6mo = monthly.length >= 12 ? ((monthly.slice(-6).reduce((sum, m) => sum + m.revenue, 0) - monthly.slice(-12, -6).reduce((sum, m) => sum + m.revenue, 0)) / monthly.slice(-12, -6).reduce((sum, m) => sum + m.revenue, 0)) * 100 : 0;
  const expGrowth_24mo = monthly.length >= 24 ? ((ltmExp - monthly.slice(-24, -12).reduce((sum, m) => sum + m.expense, 0)) / monthly.slice(-24, -12).reduce((sum, m) => sum + m.expense, 0)) * 100 : 0;
  
  let baseRGS = 10;
  if (growth_24mo >= 25) baseRGS = 100;
  else if (growth_24mo >= 15) baseRGS = 80;
  else if (growth_24mo >= 5) baseRGS = 60;
  else if (growth_24mo >= 0) baseRGS = 50;
  else if (growth_24mo >= -5) baseRGS = 40;
  else if (growth_24mo >= -15) baseRGS = 20;
  else baseRGS = 10;
  
  let adjustedRGS = baseRGS;
  if (growth_6mo >= 25) adjustedRGS = clamp(adjustedRGS + 50, 10, 100);
  else if (growth_6mo >= 15) adjustedRGS = clamp(((100 - adjustedRGS) * 0.8) + adjustedRGS, 10, 100);
  else if (growth_6mo >= 5) adjustedRGS = clamp(((100 - adjustedRGS) * 0.6) + adjustedRGS, 10, 100);
  else if (growth_6mo >= 0) adjustedRGS = clamp(((100 - adjustedRGS) * 0.4) + adjustedRGS, 10, 100);
  else if (growth_6mo >= -5) adjustedRGS = clamp(adjustedRGS * 0.9, 10, 100);
  else if (growth_6mo >= -15) adjustedRGS = clamp(adjustedRGS * 0.7, 10, 100);
  else if (growth_6mo >= -25) adjustedRGS = clamp(adjustedRGS * 0.5, 10, 100);
  else adjustedRGS = clamp(adjustedRGS * 0.3, 10, 100);
  
  const revExpSpread = growth_24mo - expGrowth_24mo;
  let expenseAdjustment = 0;
  if (revExpSpread > 10) expenseAdjustment = 30;
  else if (revExpSpread >= 0 && revExpSpread <= 10) expenseAdjustment = 10;
  else if (revExpSpread >= -5 && revExpSpread < 0) expenseAdjustment = -10;
  else if (revExpSpread < -5) expenseAdjustment = -30;
  
  const profitabilityScore = clamp(adjustedRGS + expenseAdjustment, 10, 100);
  
  const alr1 = monthly.length > 0 ? monthly[monthly.length - 1].totalAssets / monthly[monthly.length - 1].totalLiab : 0;
  const alr13 = monthly.length >= 13 ? monthly[monthly.length - 13].totalAssets / monthly[monthly.length - 13].totalLiab : 0;
  const alrGrowth = alr13 !== 0 ? ((alr1 - alr13) / alr13) * 100 : 0;
  
  let adsBase = 10;
  if (alr1 >= 1.5) adsBase = 100;
  else if (alr1 >= 1.2) adsBase = 90;
  else if (alr1 >= 0.8) adsBase = 70;
  else if (alr1 >= 0.6) adsBase = 50;
  else if (alr1 >= 0.4) adsBase = 30;
  else adsBase = 10;
  
  let adsAdj = 0;
  if (alrGrowth >= 50) adsAdj = 20;
  else if (alrGrowth >= 30) adsAdj = 15;
  else if (alrGrowth >= 15) adsAdj = 10;
  else if (alrGrowth >= 5) adsAdj = 5;
  else if (alrGrowth >= -5) adsAdj = 0;
  else if (alrGrowth >= -15) adsAdj = -5;
  else if (alrGrowth >= -30) adsAdj = -10;
  else if (alrGrowth >= -50) adsAdj = -15;
  else adsAdj = -20;
  
  const assetDevScore = clamp(adsBase + adsAdj, 10, 100);
  const finalScore = (profitabilityScore + assetDevScore) / 2;

  // Trend data
  const trendData = useMemo(() => {
    if (monthly.length < 13) return [];
    const trends: any[] = [];
    
    for (let i = 12; i < monthly.length; i++) {
      const window = monthly.slice(i - 11, i + 1);
      const ltmR = window.reduce((s, m) => s + m.revenue, 0);
      const ltmE = window.reduce((s, m) => s + m.expense, 0);
      const prev12R = i >= 23 ? monthly.slice(i - 23, i - 11).reduce((s, m) => s + m.revenue, 0) : 0;
      const prev12E = i >= 23 ? monthly.slice(i - 23, i - 11).reduce((s, m) => s + m.revenue, 0) : 0;
      const g24 = prev12R > 0 ? ((ltmR - prev12R) / prev12R) * 100 : 0;
      const gE24 = prev12E > 0 ? ((ltmE - prev12E) / prev12E) * 100 : 0;
      const recent6R = window.slice(-6).reduce((s, m) => s + m.revenue, 0);
      const prior6R = window.slice(0, 6).reduce((s, m) => s + m.revenue, 0);
      const g6 = prior6R > 0 ? ((recent6R - prior6R) / prior6R) * 100 : 0;
      
      let bRGS = 10;
      if (g24 >= 25) bRGS = 100;
      else if (g24 >= 15) bRGS = 80;
      else if (g24 >= 5) bRGS = 60;
      else if (g24 >= 0) bRGS = 50;
      else if (g24 >= -5) bRGS = 40;
      else if (g24 >= -15) bRGS = 20;
      else bRGS = 10;
      
      let aRGS = bRGS;
      if (g6 >= 25) aRGS = clamp(aRGS + 50, 10, 100);
      else if (g6 >= 15) aRGS = clamp(((100 - aRGS) * 0.8) + aRGS, 10, 100);
      else if (g6 >= 5) aRGS = clamp(((100 - aRGS) * 0.6) + aRGS, 10, 100);
      else if (g6 >= 0) aRGS = clamp(((100 - aRGS) * 0.4) + aRGS, 10, 100);
      else if (g6 >= -5) aRGS = clamp(aRGS * 0.9, 10, 100);
      else if (g6 >= -15) aRGS = clamp(aRGS * 0.7, 10, 100);
      else if (g6 >= -25) aRGS = clamp(aRGS * 0.5, 10, 100);
      else aRGS = clamp(aRGS * 0.3, 10, 100);
      
      const spread = g24 - gE24;
      let eAdj = 0;
      if (spread > 10) eAdj = 30;
      else if (spread >= 0 && spread <= 10) eAdj = 10;
      else if (spread >= -5 && spread < 0) eAdj = -10;
      else if (spread < -5) eAdj = -30;
      
      const pScore = clamp(aRGS + eAdj, 10, 100);
      
      const alr1Val = monthly[i].totalAssets / monthly[i].totalLiab;
      const alr13Val = i >= 12 ? monthly[i - 12].totalAssets / monthly[i - 12].totalLiab : 0;
      const alrGrowthVal = alr13Val !== 0 ? ((alr1Val - alr13Val) / alr13Val) * 100 : 0;
      
      let adsB = 10;
      if (alr1Val >= 1.5) adsB = 100;
      else if (alr1Val >= 1.2) adsB = 90;
      else if (alr1Val >= 0.8) adsB = 70;
      else if (alr1Val >= 0.6) adsB = 50;
      else if (alr1Val >= 0.4) adsB = 30;
      else adsB = 10;
      
      let adsA = 0;
      if (alrGrowthVal >= 50) adsA = 20;
      else if (alrGrowthVal >= 30) adsA = 15;
      else if (alrGrowthVal >= 15) adsA = 10;
      else if (alrGrowthVal >= 5) adsA = 5;
      else if (alrGrowthVal >= -5) adsA = 0;
      else if (alrGrowthVal >= -15) adsA = -5;
      else if (alrGrowthVal >= -30) adsA = -10;
      else if (alrGrowthVal >= -50) adsA = -15;
      else adsA = -20;
      
      const aScore = clamp(adsB + adsA, 10, 100);
      const fScore = (pScore + aScore) / 2;
      
      const cur = monthly[i];
      const currentAssets = cur.cash + cur.ar + cur.inventory + cur.otherCA || cur.tca;
      const currentLiab = cur.ap + cur.otherCL || cur.tcl;
      const quickAssets = cur.cash + cur.ar;
      
      const currentRatio = currentLiab > 0 ? currentAssets / currentLiab : 0;
      const quickRatio = currentLiab > 0 ? quickAssets / currentLiab : 0;
      
      const ltmCOGS = window.reduce((s, m) => s + m.cogsTotal, 0);
      const ltmSales = ltmR;
      const avgInv = (cur.inventory + (i >= 12 ? monthly[i-12].inventory : cur.inventory)) / 2;
      const invTurnover = avgInv > 0 ? ltmCOGS / avgInv : 0;
      
      const avgAR = (cur.ar + (i >= 12 ? monthly[i-12].ar : cur.ar)) / 2;
      const arTurnover = avgAR > 0 ? ltmSales / avgAR : 0;
      
      const avgAP = (cur.ap + (i >= 12 ? monthly[i-12].ap : cur.ap)) / 2;
      const apTurnover = avgAP > 0 ? ltmCOGS / avgAP : 0;
      
      const daysInv = invTurnover > 0 ? 365 / invTurnover : 0;
      const daysAR = arTurnover > 0 ? 365 / arTurnover : 0;
      const daysAP = apTurnover > 0 ? 365 / apTurnover : 0;
      
      const workingCap = currentAssets - currentLiab;
      const salesWC = workingCap !== 0 ? ltmSales / workingCap : 0;
      
      const ltmInterest = ltmE * 0.05;
      const ltmEBIT = ltmR - ltmE;
      const interestCov = ltmInterest > 0 ? ltmEBIT / ltmInterest : 0;
      
      const ltmDebtSvc = cur.ltd * 0.1 + ltmInterest;
      const debtSvcCov = ltmDebtSvc > 0 ? ltmEBIT / ltmDebtSvc : 0;
      
      // Calculate Operating Cash Flow for Cash Flow to Debt ratio
      const ltmNetIncome = ltmR - ltmE;
      const ltmDepreciation = ltmE * 0.05; // Estimated depreciation
      const priorMonth = i >= 12 ? monthly[i - 12] : cur;
      const priorWorkingCap = (priorMonth.cash + priorMonth.ar + priorMonth.inventory + priorMonth.otherCA) - (priorMonth.ap + priorMonth.otherCL);
      const changeInWorkingCap = workingCap - priorWorkingCap;
      const ltmOperatingCF = ltmNetIncome + ltmDepreciation - changeInWorkingCap;
      
      // Total Debt = Total Liabilities (more conservative) or Long Term Debt + Current Liabilities
      const totalDebt = cur.totalLiab;
      const cfToDebt = totalDebt > 0 ? ltmOperatingCF / totalDebt : 0;
      
      const debtToNW = cur.totalEquity > 0 ? cur.totalLiab / cur.totalEquity : 0;
      const fixedToNW = cur.totalEquity > 0 ? cur.fixedAssets / cur.totalEquity : 0;
      const leverage = cur.totalEquity > 0 ? cur.totalAssets / cur.totalEquity : 0;
      
      const totalAssetTO = cur.totalAssets > 0 ? ltmSales / cur.totalAssets : 0;
      const roe = cur.totalEquity > 0 ? (ltmR - ltmE) / cur.totalEquity : 0;
      const roa = cur.totalAssets > 0 ? (ltmR - ltmE) / cur.totalAssets : 0;
      const ebitdaMargin = ltmR > 0 ? (ltmEBIT + ltmE * 0.05) / ltmR : 0;
      const ebitMargin = ltmR > 0 ? ltmEBIT / ltmR : 0;
      
      trends.push({
        month: cur.month,
        rgs: bRGS,
        rgsAdj: aRGS,
        expenseAdj: eAdj,
        profitabilityScore: pScore,
        alr1: alr1Val,
        alr13: alr13Val,
        alrGrowth: alrGrowthVal,
        adsScore: aScore,
        financialScore: fScore,
        currentRatio,
        quickRatio,
        invTurnover,
        arTurnover,
        apTurnover,
        daysInv,
        daysAR,
        daysAP,
        salesWC,
        interestCov,
        debtSvcCov,
        cfToDebt,
        debtToNW,
        fixedToNW,
        leverage,
        totalAssetTO,
        roe,
        roa,
        ebitdaMargin,
        ebitMargin
      });
    }
    
    return trends;
  }, [monthly]);

  // MD&A Analysis
  const mdaAnalysis = useMemo(() => {
    if (!trendData || trendData.length === 0) return { strengths: [], weaknesses: [], insights: [] };
    
    const last = trendData[trendData.length - 1];
    const strengths: string[] = [];
    const weaknesses: string[] = [];
    const insights: string[] = [];
    
    if (finalScore >= 70) strengths.push(`Strong overall financial score of ${finalScore.toFixed(1)}, indicating robust financial health.`);
    else if (finalScore < 50) weaknesses.push(`Financial score of ${finalScore.toFixed(1)} suggests significant areas for improvement.`);
    
    if (profitabilityScore >= 70) strengths.push(`Profitability score of ${profitabilityScore.toFixed(1)} demonstrates solid revenue growth and expense management.`);
    else if (profitabilityScore < 50) weaknesses.push(`Profitability score of ${profitabilityScore.toFixed(1)} indicates challenges in revenue growth or expense control.`);
    
    if (growth_24mo > 10) strengths.push(`24-month revenue growth of ${growth_24mo.toFixed(1)}% shows strong market expansion.`);
    else if (growth_24mo < 0) weaknesses.push(`Negative 24-month revenue growth of ${growth_24mo.toFixed(1)}% requires immediate strategic attention.`);
    
    if (expenseAdjustment > 0) strengths.push(`Expense management is outperforming revenue growth by ${revExpSpread.toFixed(1)}%, adding ${expenseAdjustment} points to profitability.`);
    else if (expenseAdjustment < 0) weaknesses.push(`Expenses are growing faster than revenue by ${Math.abs(revExpSpread).toFixed(1)}%, reducing profitability by ${Math.abs(expenseAdjustment)} points.`);
    
    if (assetDevScore >= 70) strengths.push(`Asset Development Score of ${assetDevScore.toFixed(1)} reflects a healthy asset-to-liability ratio and positive asset growth.`);
    else if (assetDevScore < 50) weaknesses.push(`Asset Development Score of ${assetDevScore.toFixed(1)} suggests concerning leverage and asset composition.`);
    
    if (last.currentRatio >= 1.5) strengths.push(`Current ratio of ${last.currentRatio.toFixed(1)} indicates strong short-term liquidity.`);
    else if (last.currentRatio < 1.0) weaknesses.push(`Current ratio of ${last.currentRatio.toFixed(1)} may indicate potential liquidity challenges.`);
    
    if (last.roe > 0.15) strengths.push(`Return on Equity of ${(last.roe * 100).toFixed(1)}% demonstrates efficient use of shareholder capital.`);
    else if (last.roe < 0) weaknesses.push(`Negative Return on Equity of ${(last.roe * 100).toFixed(1)}% indicates losses relative to equity.`);
    
    // KPI Analysis
    if (last.quickRatio >= 1.0) strengths.push(`Quick ratio of ${last.quickRatio.toFixed(1)} shows strong ability to meet short-term obligations without relying on inventory.`);
    else if (last.quickRatio < 0.5) weaknesses.push(`Quick ratio of ${last.quickRatio.toFixed(1)} suggests potential cash flow challenges.`);
    
    if (last.debtToNW < 1.0) strengths.push(`Debt-to-Net Worth ratio of ${last.debtToNW.toFixed(1)} indicates conservative leverage and strong equity position.`);
    else if (last.debtToNW > 2.0) weaknesses.push(`Debt-to-Net Worth ratio of ${last.debtToNW.toFixed(1)} suggests high leverage that may limit financial flexibility.`);
    
    if (last.interestCov > 3.0) strengths.push(`Interest coverage ratio of ${last.interestCov.toFixed(1)} demonstrates strong ability to service debt obligations.`);
    else if (last.interestCov < 1.5) weaknesses.push(`Interest coverage of ${last.interestCov.toFixed(1)} indicates potential difficulty meeting interest payments.`);
    
    // Projection Analysis - Calculate inline to avoid circular dependency
    if (monthly.length >= 24) {
      // Calculate simple revenue projection
      const last12Months = monthly.slice(-12);
      const prior12Months = monthly.slice(-24, -12);
      const recentRevGrowth = ((last12Months.reduce((s, m) => s + m.revenue, 0) - prior12Months.reduce((s, m) => s + m.revenue, 0)) / prior12Months.reduce((s, m) => s + m.revenue, 0)) * 100;
      
      if (recentRevGrowth > 10) insights.push(`Based on 12-month trends, revenue shows ${recentRevGrowth.toFixed(1)}% growth trajectory with strong expansion potential.`);
      else if (recentRevGrowth < -5) insights.push(`Revenue trends indicate ${Math.abs(recentRevGrowth).toFixed(1)}% decline trajectory - proactive measures recommended.`);
      
      // Projected annual revenue
      const avgMonthlyRev = last12Months.reduce((s, m) => s + m.revenue, 0) / 12;
      const projectedAnnualRev = avgMonthlyRev * 12;
      
      if (recentRevGrowth > 15) insights.push(`Strong growth trajectory projects annual revenue of approximately $${(projectedAnnualRev / 1000).toFixed(0)}K with continued momentum.`);
      else if (recentRevGrowth < 0) insights.push(`Declining revenue trend requires strategic intervention to stabilize and restore growth.`);
      
      // Equity trend analysis
      const currentEquity = monthly[monthly.length - 1].totalEquity;
      const priorEquity = monthly[monthly.length - 13] ? monthly[monthly.length - 13].totalEquity : currentEquity;
      const equityChange = ((currentEquity - priorEquity) / Math.abs(priorEquity)) * 100;
      
      if (equityChange > 10) insights.push(`Equity has strengthened by ${equityChange.toFixed(1)}% over the past year, improving financial stability.`);
      else if (equityChange < -10) weaknesses.push(`Equity has declined by ${Math.abs(equityChange).toFixed(1)}% - monitor profitability and cash management closely.`);
    }
    
    // Trend Analysis Insights
    if (monthly.length >= 24) {
      const recentRevTrend = trendData.slice(-6).map(t => t.rgs).reduce((a, b) => a + b, 0) / 6;
      const priorRevTrend = trendData.slice(-12, -6).map(t => t.rgs).reduce((a, b) => a + b, 0) / 6;
      
      if (recentRevTrend > priorRevTrend + 10) strengths.push(`Revenue growth momentum is accelerating in recent months, indicating improving market position.`);
      else if (recentRevTrend < priorRevTrend - 10) weaknesses.push(`Revenue growth momentum is decelerating - review sales strategies and market positioning.`);
    }
    
    // Working Capital Analysis
    const currentAssets = monthly[monthly.length - 1].cash + monthly[monthly.length - 1].ar + monthly[monthly.length - 1].inventory + monthly[monthly.length - 1].otherCA;
    const currentLiab = monthly[monthly.length - 1].ap + monthly[monthly.length - 1].otherCL;
    const workingCapital = currentAssets - currentLiab;
    const wcRatioMDA = currentLiab > 0 ? currentAssets / currentLiab : 0;
    
    if (workingCapital > 0 && wcRatioMDA >= 1.5) {
      strengths.push(`Positive working capital of $${(workingCapital / 1000).toFixed(1)}K with strong WC ratio of ${wcRatioMDA.toFixed(1)} supports operational flexibility.`);
    } else if (workingCapital < 0) {
      weaknesses.push(`Negative working capital of $${(Math.abs(workingCapital) / 1000).toFixed(1)}K indicates potential short-term funding challenges.`);
    } else if (wcRatioMDA < 1.0) {
      weaknesses.push(`Working capital ratio of ${wcRatioMDA.toFixed(1)} is below optimal levels - consider improving liquidity.`);
    }
    
    // Activity Ratios (Days metrics)
    if (last.daysAR > 0) {
      if (last.daysAR < 45) strengths.push(`Days' receivables of ${last.daysAR.toFixed(0)} days reflects efficient collection practices.`);
      else if (last.daysAR > 90) weaknesses.push(`Days' receivables of ${last.daysAR.toFixed(0)} days suggests slow collection - review credit policies and collection procedures.`);
    }
    
    if (last.daysInv > 0) {
      if (last.daysInv < 60) insights.push(`Inventory turnover of ${last.daysInv.toFixed(0)} days indicates efficient inventory management.`);
      else if (last.daysInv > 120) weaknesses.push(`Days' inventory of ${last.daysInv.toFixed(0)} days may indicate slow-moving stock - consider inventory optimization.`);
    }
    
    if (last.daysAP > 0) {
      if (last.daysAP > 45) insights.push(`Days' payables of ${last.daysAP.toFixed(0)} days provides beneficial supplier financing.`);
      else if (last.daysAP < 20) insights.push(`Days' payables of ${last.daysAP.toFixed(0)} days - consider extending payment terms to improve cash flow.`);
    }
    
    // Cash Conversion Cycle
    const cashConversionCycle = last.daysInv + last.daysAR - last.daysAP;
    if (cashConversionCycle < 30) strengths.push(`Cash conversion cycle of ${cashConversionCycle.toFixed(0)} days demonstrates excellent working capital efficiency.`);
    else if (cashConversionCycle > 90) weaknesses.push(`Cash conversion cycle of ${cashConversionCycle.toFixed(0)} days suggests opportunities to accelerate cash generation.`);
    
    // Asset Efficiency
    if (last.totalAssetTO > 1.5) strengths.push(`Total asset turnover of ${last.totalAssetTO.toFixed(1)} shows effective asset utilization in generating sales.`);
    else if (last.totalAssetTO < 0.5) weaknesses.push(`Total asset turnover of ${last.totalAssetTO.toFixed(1)} indicates underutilized assets - review asset productivity.`);
    
    // Profitability Margins
    if (last.ebitdaMargin > 0.15) strengths.push(`EBITDA margin of ${(last.ebitdaMargin * 100).toFixed(1)}% demonstrates strong operational profitability.`);
    else if (last.ebitdaMargin < 0.05) weaknesses.push(`EBITDA margin of ${(last.ebitdaMargin * 100).toFixed(1)}% requires operational cost optimization.`);
    
    // Cash Flow Analysis (estimated from financial data)
    if (monthly.length >= 13) {
      const currentCash = monthly[monthly.length - 1].cash;
      const priorYearCash = monthly[monthly.length - 13].cash;
      const cashChange = currentCash - priorYearCash;
      
      if (cashChange > ltmRev * 0.1) strengths.push(`Cash position improved by $${(cashChange / 1000).toFixed(1)}K over the past year, strengthening financial resilience.`);
      else if (cashChange < -ltmRev * 0.05) weaknesses.push(`Cash declined by $${(Math.abs(cashChange) / 1000).toFixed(1)}K - monitor cash flow and consider working capital improvements.`);
    }
    
    // Benchmark Comparison (if available)
    if (benchmarks && benchmarks.length > 0) {
      // Helper function to get benchmark value
      const getBenchmark = (metricName: string) => {
        const bm = benchmarks.find(b => b.metricName === metricName);
        return bm ? bm.fiveYearValue : null;
      };
      
      // Current Ratio Benchmark
      const currentRatioBM = getBenchmark('Current Ratio');
      if (currentRatioBM !== null && last.currentRatio) {
        if (last.currentRatio > currentRatioBM * 1.2) {
          strengths.push(`Current ratio of ${last.currentRatio.toFixed(1)} is ${((last.currentRatio / currentRatioBM - 1) * 100).toFixed(0)}% above industry average (${currentRatioBM.toFixed(1)}), demonstrating superior liquidity management.`);
        } else if (last.currentRatio < currentRatioBM * 0.8) {
          weaknesses.push(`Current ratio of ${last.currentRatio.toFixed(1)} is ${((1 - last.currentRatio / currentRatioBM) * 100).toFixed(0)}% below industry average (${currentRatioBM.toFixed(1)}), indicating potential liquidity concerns relative to peers.`);
        }
      }
      
      // Quick Ratio Benchmark
      const quickRatioBM = getBenchmark('Quick Ratio');
      if (quickRatioBM !== null && last.quickRatio) {
        if (last.quickRatio > quickRatioBM * 1.2) {
          strengths.push(`Quick ratio of ${last.quickRatio.toFixed(1)} significantly exceeds industry benchmark (${quickRatioBM.toFixed(1)}), highlighting exceptional short-term financial strength.`);
        } else if (last.quickRatio < quickRatioBM * 0.8) {
          weaknesses.push(`Quick ratio of ${last.quickRatio.toFixed(1)} lags industry average (${quickRatioBM.toFixed(1)}) by ${((1 - last.quickRatio / quickRatioBM) * 100).toFixed(0)}%, suggesting need for improved cash management.`);
        }
      }
      
      // Debt-to-Net Worth Benchmark
      const debtToNWBM = getBenchmark('Total Debt to Net Worth Ratio');
      if (debtToNWBM !== null && last.debtToNW) {
        if (last.debtToNW < debtToNWBM * 0.7) {
          strengths.push(`Debt-to-Net Worth of ${last.debtToNW.toFixed(1)} is well below industry average (${debtToNWBM.toFixed(1)}), indicating conservative leverage and strong balance sheet.`);
        } else if (last.debtToNW > debtToNWBM * 1.3) {
          weaknesses.push(`Debt-to-Net Worth of ${last.debtToNW.toFixed(1)} exceeds industry norm (${debtToNWBM.toFixed(1)}) by ${((last.debtToNW / debtToNWBM - 1) * 100).toFixed(0)}%, suggesting higher financial risk profile.`);
        }
      }
      
      // Gross Profit Margin Benchmark
      const grossProfitBM = getBenchmark('Gross Profit Margin %');
      if (grossProfitBM !== null && last.grossMargin) {
        if (last.grossMargin > grossProfitBM / 100 * 1.1) {
          strengths.push(`Gross profit margin of ${(last.grossMargin * 100).toFixed(1)}% outperforms industry average (${grossProfitBM.toFixed(1)}%), demonstrating strong pricing power and cost management.`);
        } else if (last.grossMargin < grossProfitBM / 100 * 0.9) {
          weaknesses.push(`Gross margin of ${(last.grossMargin * 100).toFixed(1)}% trails industry benchmark (${grossProfitBM.toFixed(1)}%), indicating potential pricing or cost structure challenges.`);
        }
      }
      
      // Return on Assets Benchmark
      const roaBM = getBenchmark('Return on Total Assets %');
      if (roaBM !== null && last.roa) {
        if (last.roa > roaBM / 100 * 1.2) {
          strengths.push(`Return on Assets of ${(last.roa * 100).toFixed(1)}% is ${(((last.roa * 100) / roaBM - 1) * 100).toFixed(0)}% above industry average (${roaBM.toFixed(1)}%), reflecting superior asset productivity.`);
        } else if (last.roa < roaBM / 100 * 0.8) {
          weaknesses.push(`ROA of ${(last.roa * 100).toFixed(1)}% is below industry standard (${roaBM.toFixed(1)}%), suggesting opportunities for improved asset utilization.`);
        }
      }
      
      // Return on Equity Benchmark
      const roeBM = getBenchmark('Return on Net Worth %');
      if (roeBM !== null && last.roe) {
        if (last.roe > roeBM / 100 * 1.2) {
          strengths.push(`Return on Equity of ${(last.roe * 100).toFixed(1)}% substantially exceeds industry benchmark (${roeBM.toFixed(1)}%), indicating exceptional returns for shareholders.`);
        } else if (last.roe < roeBM / 100 * 0.8) {
          weaknesses.push(`ROE of ${(last.roe * 100).toFixed(1)}% underperforms industry average (${roeBM.toFixed(1)}%), suggesting need for profitability improvement.`);
        }
      }
      
      // Days AR Benchmark
      const daysARBM = getBenchmark('Days\' Receivables');
      if (daysARBM !== null && last.daysAR > 0) {
        if (last.daysAR < daysARBM * 0.8) {
          strengths.push(`Days' receivables of ${last.daysAR.toFixed(0)} days is ${((1 - last.daysAR / daysARBM) * 100).toFixed(0)}% faster than industry average (${daysARBM.toFixed(0)} days), demonstrating superior collection efficiency.`);
        } else if (last.daysAR > daysARBM * 1.2) {
          weaknesses.push(`Collection period of ${last.daysAR.toFixed(0)} days exceeds industry norm (${daysARBM.toFixed(0)} days) by ${((last.daysAR / daysARBM - 1) * 100).toFixed(0)}%, indicating room for accounts receivable optimization.`);
        }
      }
      
      // Days Inventory Benchmark
      const daysInvBM = getBenchmark('Days\' Inventory');
      if (daysInvBM !== null && last.daysInv > 0) {
        if (last.daysInv < daysInvBM * 0.8) {
          insights.push(`Inventory turnover (${last.daysInv.toFixed(0)} days) is ${((1 - last.daysInv / daysInvBM) * 100).toFixed(0)}% faster than industry average (${daysInvBM.toFixed(0)} days), indicating lean inventory management.`);
        } else if (last.daysInv > daysInvBM * 1.2) {
          weaknesses.push(`Inventory holding period of ${last.daysInv.toFixed(0)} days is ${((last.daysInv / daysInvBM - 1) * 100).toFixed(0)}% longer than industry benchmark (${daysInvBM.toFixed(0)} days), suggesting potential obsolescence risk.`);
        }
      }
      
      // Days AP Benchmark
      const daysAPBM = getBenchmark('Days\' Payables');
      if (daysAPBM !== null && last.daysAP > 0) {
        if (last.daysAP > daysAPBM * 1.1) {
          insights.push(`Payment terms of ${last.daysAP.toFixed(0)} days exceed industry average (${daysAPBM.toFixed(0)} days), providing favorable cash flow timing and supplier financing.`);
        } else if (last.daysAP < daysAPBM * 0.8) {
          insights.push(`Payment period of ${last.daysAP.toFixed(0)} days is shorter than industry norm (${daysAPBM.toFixed(0)} days) - consider negotiating extended terms to improve cash flow.`);
        }
      }
      
      // Asset Turnover Benchmark
      const assetTOBM = getBenchmark('Total Asset Turnover');
      if (assetTOBM !== null && last.totalAssetTO) {
        if (last.totalAssetTO > assetTOBM * 1.2) {
          strengths.push(`Asset turnover of ${last.totalAssetTO.toFixed(1)} exceeds industry average (${assetTOBM.toFixed(1)}) by ${((last.totalAssetTO / assetTOBM - 1) * 100).toFixed(0)}%, demonstrating efficient capital deployment.`);
        } else if (last.totalAssetTO < assetTOBM * 0.8) {
          weaknesses.push(`Asset turnover of ${last.totalAssetTO.toFixed(1)} trails industry benchmark (${assetTOBM.toFixed(1)}), indicating potential for enhanced revenue generation from existing assets.`);
        }
      }
      
      insights.push(`Industry benchmark analysis shows ${strengths.filter(s => s.includes('industry')).length} areas where performance exceeds peer standards.`);
    }
    
    // Add strategic insights based on comprehensive data
    insights.push(`Monitor the trend in Financial Score over time to identify patterns and early warning signs of performance changes.`);
    insights.push(`Focus improvement initiatives on components with the lowest scores for maximum impact on overall financial health.`);
    
    if (growth_6mo < growth_24mo) {
      insights.push(`Recent 6-month growth (${growth_6mo.toFixed(1)}%) is slower than 24-month trend (${growth_24mo.toFixed(1)}%), suggesting momentum is decelerating - consider market expansion strategies.`);
    } else if (growth_6mo > growth_24mo) {
      insights.push(`Recent 6-month growth (${growth_6mo.toFixed(1)}%) exceeds 24-month trend (${growth_24mo.toFixed(1)}%), indicating accelerating momentum - capitalize on this growth trajectory.`);
    }
    
    // Valuation insights
    if (last.totalAssets > 0) {
      const assetMultiple = last.totalAssets > 0 ? ltmRev / last.totalAssets : 0;
      if (assetMultiple > 1.5) {
        insights.push(`Revenue-to-Assets ratio of ${assetMultiple.toFixed(1)}x indicates efficient capital utilization and strong operational leverage.`);
      } else if (assetMultiple < 0.8) {
        insights.push(`Revenue-to-Assets ratio of ${assetMultiple.toFixed(1)}x suggests opportunities to improve asset productivity through operational optimization.`);
      }
    }
    
    // Cash flow insights
    if (monthly.length >= 12) {
      const recentCashFlow = monthly.slice(-12).reduce((sum, m) => sum + (m.revenue - m.expense), 0);
      const cashFlowMargin = recentCashFlow / ltmRev;
      if (cashFlowMargin > 0.15) {
        strengths.push(`Operating cash flow margin of ${(cashFlowMargin * 100).toFixed(1)}% demonstrates strong cash generation capability and financial sustainability.`);
      } else if (cashFlowMargin < 0.05) {
        weaknesses.push(`Operating cash flow margin of ${(cashFlowMargin * 100).toFixed(1)}% indicates tight cash generation - focus on working capital optimization.`);
      }
    }
    
    return { strengths, weaknesses, insights };
  }, [trendData, finalScore, profitabilityScore, assetDevScore, growth_24mo, growth_6mo, expenseAdjustment, revExpSpread, ltmRev, ltmExp, monthly, benchmarks]);

  // Projections
  const projections = useMemo(() => {
    if (monthly.length < 24) return { mostLikely: [], bestCase: [], worstCase: [] };
    
    const last12 = monthly.slice(-12);
    const prev12 = monthly.slice(-24, -12);
    const avgRevGrowth = ((last12.reduce((s, m) => s + m.revenue, 0) - prev12.reduce((s, m) => s + m.revenue, 0)) / prev12.reduce((s, m) => s + m.revenue, 0)) / 12;
    const avgExpGrowth = ((last12.reduce((s, m) => s + m.expense, 0) - prev12.reduce((s, m) => s + m.expense, 0)) / prev12.reduce((s, m) => s + m.expense, 0)) / 12;
    const avgAssetGrowth = ((last12[last12.length - 1].totalAssets - prev12[prev12.length - 1].totalAssets) / prev12[prev12.length - 1].totalAssets) / 12;
    const avgLiabGrowth = ((last12[last12.length - 1].totalLiab - prev12[prev12.length - 1].totalLiab) / prev12[prev12.length - 1].totalLiab) / 12;
    
    const lastMonth = monthly[monthly.length - 1];
    const mostLikely: any[] = [];
    const bestCase: any[] = [];
    const worstCase: any[] = [];
    
    for (let i = 1; i <= 12; i++) {
      const monthName = `+${i}mo`;
      
      const mlRev = lastMonth.revenue * Math.pow(1 + avgRevGrowth, i);
      const mlExp = lastMonth.expense * Math.pow(1 + avgExpGrowth, i);
      const mlAssets = lastMonth.totalAssets * Math.pow(1 + avgAssetGrowth, i);
      const mlLiab = lastMonth.totalLiab * Math.pow(1 + avgLiabGrowth, i);
      const mlEquity = mlAssets - mlLiab;
      
      mostLikely.push({
        month: monthName,
        revenue: mlRev,
        expense: mlExp,
        netIncome: mlRev - mlExp,
        totalAssets: mlAssets,
        totalLiab: mlLiab,
        equity: mlEquity
      });
      
      const bcRev = lastMonth.revenue * Math.pow(1 + avgRevGrowth * bestCaseRevMultiplier, i);
      const bcExp = lastMonth.expense * Math.pow(1 + avgExpGrowth * bestCaseExpMultiplier, i);
      const bcAssets = lastMonth.totalAssets * Math.pow(1 + avgAssetGrowth * 1.2, i);
      const bcLiab = lastMonth.totalLiab * Math.pow(1 + avgLiabGrowth * 0.8, i);
      const bcEquity = bcAssets - bcLiab;
      
      bestCase.push({
        month: monthName,
        revenue: bcRev,
        expense: bcExp,
        netIncome: bcRev - bcExp,
        totalAssets: bcAssets,
        totalLiab: bcLiab,
        equity: bcEquity
      });
      
      const wcRev = lastMonth.revenue * Math.pow(1 + avgRevGrowth * worstCaseRevMultiplier, i);
      const wcExp = lastMonth.expense * Math.pow(1 + avgExpGrowth * worstCaseExpMultiplier, i);
      const wcAssets = lastMonth.totalAssets * Math.pow(1 + avgAssetGrowth * 0.8, i);
      const wcLiab = lastMonth.totalLiab * Math.pow(1 + avgLiabGrowth * 1.2, i);
      const wcEquity = wcAssets - wcLiab;
      
      worstCase.push({
        month: monthName,
        revenue: wcRev,
        expense: wcExp,
        netIncome: wcRev - wcExp,
        totalAssets: wcAssets,
        totalLiab: wcLiab,
        equity: wcEquity
      });
    }
    
    return { mostLikely, bestCase, worstCase };
  }, [monthly, bestCaseRevMultiplier, bestCaseExpMultiplier, worstCaseRevMultiplier, worstCaseExpMultiplier]);

  const renderColumnSelector = (label: string, mappingKey: keyof Mappings) => (
    <div style={{ marginBottom: '15px' }}>
      <label style={{ display: 'block', fontWeight: '500', marginBottom: '5px', color: '#475569' }}>{label}:</label>
      <select value={mapping[mappingKey] || ''} onChange={(e) => setMapping({ ...mapping, [mappingKey]: e.target.value })} style={{ width: '100%', padding: '10px', borderRadius: '8px', border: '1px solid #cbd5e1', fontSize: '14px', outline: 'none' }}>
        <option value="">-- Select --</option>
        {columns.map(col => <option key={col} value={col}>{col}</option>)}
      </select>
    </div>
  );

  const saveProjectionDefaults = () => {
    const defaults = {
      bestCaseRev: bestCaseRevMultiplier,
      bestCaseExp: bestCaseExpMultiplier,
      worstCaseRev: worstCaseRevMultiplier,
      worstCaseExp: worstCaseExpMultiplier
    };
    localStorage.setItem('fs_projectionDefaults', JSON.stringify(defaults));
    setDefaultBestCaseRevMult(bestCaseRevMultiplier);
    setDefaultBestCaseExpMult(bestCaseExpMultiplier);
    setDefaultWorstCaseRevMult(worstCaseRevMultiplier);
    setDefaultWorstCaseExpMult(worstCaseExpMultiplier);
    alert('Defaults saved successfully!');
    setShowDefaultSettings(false);
  };

  // LOGIN VIEW
  if (!isLoggedIn) {
    return (
      <div style={{ minHeight: '100vh', background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', padding: '40px 20px' }}>
        <div style={{ maxWidth: '480px', margin: '0 auto', background: 'white', borderRadius: '16px', boxShadow: '0 20px 60px rgba(0,0,0,0.3)', padding: '40px' }}>
          <div style={{ textAlign: 'center', marginBottom: '32px' }}>
            <div style={{ fontSize: '48px', fontWeight: '700', color: '#667eea', marginBottom: '16px', letterSpacing: '-1px' }}>
              Venturis<sup style={{ fontSize: '18px', fontWeight: '400' }}>TM</sup>
            </div>
            <h1 style={{ fontSize: '28px', fontWeight: '700', color: '#1e293b', marginBottom: '8px' }}>Business Evaluation Tool</h1>
            <p style={{ color: '#64748b', fontSize: '14px' }}>Professional financial analysis for consultants and businesses</p>
          </div>

          {loginError && (
            <div style={{ padding: '12px 16px', background: '#fee2e2', color: '#991b1b', borderRadius: '8px', marginBottom: '16px', fontSize: '14px', border: '1px solid #fecaca' }}>
              {loginError}
            </div>
          )}

          {showForgotPassword ? (
            <form autoComplete="off" onSubmit={(e) => e.preventDefault()}>
              <h2 style={{ fontSize: '20px', fontWeight: '600', color: '#1e293b', marginBottom: '16px' }}>Reset Password</h2>
              <p style={{ fontSize: '14px', color: '#64748b', marginBottom: '12px' }}>Enter your email address and we'll send you instructions to reset your password.</p>
              
              {resetSuccess && (
                <div style={{ padding: '12px 16px', background: '#d1fae5', color: '#065f46', borderRadius: '8px', marginBottom: '16px', fontSize: '14px', border: '1px solid #6ee7b7' }}>
                  {resetSuccess}
                </div>
              )}
              
              <input 
                type="text" 
                name={`reset_email_${Date.now()}`}
                placeholder="Email Address" 
                value={resetEmail} 
                onChange={(e) => { setResetEmail(e.target.value); setLoginError(''); }} 
                autoComplete="off"
                style={{ width: '100%', padding: '12px 16px', marginBottom: '12px', borderRadius: '8px', border: '1px solid #cbd5e1', fontSize: '14px' }} 
              />
              <button 
                onClick={async () => {
                  if (!resetEmail.trim()) {
                    setLoginError('Please enter your email address');
                    return;
                  }
                  setIsLoading(true);
                  setLoginError('');
                  setResetSuccess('');
                  try {
                    const response = await fetch('/api/auth/reset-password', {
                      method: 'POST',
                      headers: { 'Content-Type': 'application/json' },
                      body: JSON.stringify({ email: resetEmail.toLowerCase().trim() })
                    });
                    const data = await response.json();
                    if (!response.ok) {
                      throw new Error(data.error || 'Failed to send reset email');
                    }
                    setResetSuccess('Password reset instructions sent! Check your email.');
                    setResetEmail('');
                  } catch (error) {
                    setLoginError(error instanceof Error ? error.message : 'Failed to send reset email');
                  } finally {
                    setIsLoading(false);
                  }
                }}
                disabled={isLoading}
                style={{ width: '100%', padding: '14px', background: isLoading ? '#94a3b8' : '#667eea', color: 'white', border: 'none', borderRadius: '8px', fontSize: '16px', fontWeight: '600', cursor: isLoading ? 'not-allowed' : 'pointer', marginBottom: '12px', opacity: isLoading ? 0.7 : 1 }}
              >
                {isLoading ? 'Sending...' : 'Send Reset Instructions'}
              </button>
              <button 
                type="button"
                onClick={() => { setShowForgotPassword(false); setLoginError(''); setResetSuccess(''); setResetEmail(''); }} 
                disabled={isLoading}
                style={{ width: '100%', padding: '14px', background: '#f1f5f9', color: '#475569', border: 'none', borderRadius: '8px', fontSize: '14px', fontWeight: '600', cursor: isLoading ? 'not-allowed' : 'pointer' }}
              >
                Back to Login
              </button>
            </form>
          ) : isRegistering ? (
            <form autoComplete="off" onSubmit={(e) => { e.preventDefault(); handleRegisterConsultant(); }}>
              <h2 style={{ fontSize: '20px', fontWeight: '600', color: '#1e293b', marginBottom: '12px' }}>Register as Consultant</h2>
              <input 
                type="text" 
                name={`fullname_${Date.now()}`}
                placeholder="Full Name" 
                value={loginName} 
                onChange={(e) => setLoginName(e.target.value)} 
                autoComplete="off" 
                style={{ width: '100%', padding: '12px 16px', marginBottom: '16px', borderRadius: '8px', border: '1px solid #cbd5e1', fontSize: '14px' }} 
              />
              <input 
                type="text" 
                name={`email_${Date.now()}`}
                placeholder="Email" 
                value={loginEmail} 
                onChange={(e) => setLoginEmail(e.target.value)} 
                autoComplete="off" 
                style={{ width: '100%', padding: '12px 16px', marginBottom: '16px', borderRadius: '8px', border: '1px solid #cbd5e1', fontSize: '14px' }} 
              />
              
              {/* Password field with toggle */}
              <div style={{ position: 'relative', marginBottom: '12px' }}>
                <input 
                  type={showPassword ? "text" : "password"} 
                  name={`password_${Date.now()}`}
                  placeholder="Password" 
                  value={loginPassword} 
                  onChange={(e) => setLoginPassword(e.target.value)} 
                  autoComplete="new-password"
                  style={{ width: '100%', padding: '12px 40px 12px 16px', borderRadius: '8px', border: '1px solid #cbd5e1', fontSize: '14px' }} 
                />
                <button
                  type="button"
                  onClick={() => setShowPassword(!showPassword)}
                  style={{ position: 'absolute', right: '12px', top: '50%', transform: 'translateY(-50%)', background: 'none', border: 'none', cursor: 'pointer', fontSize: '18px', color: '#64748b', padding: '4px' }}
                  title={showPassword ? "Hide password" : "Show password"}
                >
                  {showPassword ? '👁️' : '👁️‍🗨️'}
                </button>
              </div>
              
              <button type="submit" style={{ width: '100%', padding: '14px', background: '#667eea', color: 'white', border: 'none', borderRadius: '8px', fontSize: '16px', fontWeight: '600', cursor: 'pointer', marginBottom: '12px' }}>Register</button>
              <button type="button" onClick={() => { setIsRegistering(false); setLoginError(''); setShowPassword(false); }} style={{ width: '100%', padding: '14px', background: '#f1f5f9', color: '#475569', border: 'none', borderRadius: '8px', fontSize: '14px', fontWeight: '600', cursor: 'pointer' }}>Back to Login</button>
            </form>
          ) : (
            <form autoComplete="off" onSubmit={(e) => { e.preventDefault(); if (!isLoading) handleLogin(); }}>
              <h2 style={{ fontSize: '20px', fontWeight: '600', color: '#1e293b', marginBottom: '12px' }}>Sign In</h2>
              <input 
                type="text" 
                name={`email_${Date.now()}`}
                placeholder="Email" 
                value={loginEmail} 
                onChange={(e) => { setLoginEmail(e.target.value); setLoginError(''); }} 
                autoComplete="off" 
                style={{ width: '100%', padding: '12px 16px', marginBottom: '16px', borderRadius: '8px', border: '1px solid #cbd5e1', fontSize: '14px' }} 
              />
              
              {/* Password field with toggle */}
              <div style={{ position: 'relative', marginBottom: '12px' }}>
                <input 
                  type={showPassword ? "text" : "password"} 
                  name={`password_${Date.now()}`}
                  placeholder="Password" 
                  value={loginPassword} 
                  onChange={(e) => { setLoginPassword(e.target.value); setLoginError(''); }} 
                  autoComplete="new-password"
                  style={{ width: '100%', padding: '12px 40px 12px 16px', borderRadius: '8px', border: '1px solid #cbd5e1', fontSize: '14px' }} 
                />
                <button
                  type="button"
                  onClick={() => setShowPassword(!showPassword)}
                  style={{ position: 'absolute', right: '12px', top: '50%', transform: 'translateY(-50%)', background: 'none', border: 'none', cursor: 'pointer', fontSize: '18px', color: '#64748b', padding: '4px' }}
                  title={showPassword ? "Hide password" : "Show password"}
                >
                  {showPassword ? '👁️' : '👁️‍🗨️'}
                </button>
              </div>
              
              {/* Forgot Password Link */}
              <div style={{ textAlign: 'right', marginBottom: '12px' }}>
                <button 
                  type="button"
                  onClick={() => { setShowForgotPassword(true); setLoginError(''); setShowPassword(false); }} 
                  style={{ background: 'none', border: 'none', color: '#667eea', fontSize: '13px', cursor: 'pointer', textDecoration: 'underline', padding: 0 }}
                >
                  Forgot Password?
                </button>
              </div>
              
              <button type="submit" disabled={isLoading} style={{ width: '100%', padding: '14px', background: isLoading ? '#94a3b8' : '#667eea', color: 'white', border: 'none', borderRadius: '8px', fontSize: '16px', fontWeight: '600', cursor: isLoading ? 'not-allowed' : 'pointer', marginBottom: '16px', opacity: isLoading ? 0.7 : 1 }}>
                {isLoading ? 'Signing In...' : 'Sign In'}
              </button>
              <button type="button" onClick={() => { setIsRegistering(true); setLoginError(''); setShowPassword(false); }} disabled={isLoading} style={{ width: '100%', padding: '14px', background: '#f1f5f9', color: '#475569', border: 'none', borderRadius: '8px', fontSize: '14px', fontWeight: '600', cursor: isLoading ? 'not-allowed' : 'pointer', marginBottom: '12px' }}>Register as Consultant</button>
              <button type="button" onClick={() => window.location.href = '/register-business'} disabled={isLoading} style={{ width: '100%', padding: '14px', background: 'linear-gradient(135deg, #10b981 0%, #059669 100%)', color: 'white', border: 'none', borderRadius: '8px', fontSize: '14px', fontWeight: '600', cursor: isLoading ? 'not-allowed' : 'pointer', boxShadow: '0 2px 8px rgba(16, 185, 129, 0.3)' }}>
                🏢 Register Your Business
              </button>
            </form>
          )}
        </div>
      </div>
    );
  }

  // Main Logged-In View with Header
  const company = getCurrentCompany();
  const companyName = company ? company.name : '';

  // Custom Print Package Handler
  const handleGeneratePrintPackage = () => {
    // Check if any items are selected
    const hasSelection = Object.values(printPackageSelections).some(val => val);
    if (!hasSelection) {
      alert('Please select at least one report to include in the print package.');
      return;
    }

    // Build array of print instructions
    const printQueue = [];
    
    if (printPackageSelections.mda) {
      printQueue.push({ view: 'mda', title: 'MD&A (Management Discussion & Analysis)' });
    }
    if (printPackageSelections.financialScore) {
      printQueue.push({ view: 'fs-score', title: 'Financial Score' });
    }
    if (printPackageSelections.priorityRatios) {
      printQueue.push({ view: 'kpis', tab: 'priority-ratios', title: 'Priority Ratios' });
    }
    if (printPackageSelections.workingCapital) {
      printQueue.push({ view: 'working-capital', title: 'Working Capital' });
    }
    if (printPackageSelections.cashFlow4Quarters) {
      printQueue.push({ view: 'cash-flow', display: 'quarterly', title: 'Cash Flow - Last 4 Quarters' });
    }
    if (printPackageSelections.cashFlow3Years) {
      printQueue.push({ view: 'cash-flow', display: 'annual', title: 'Cash Flow - Last 3 Years' });
    }
    if (printPackageSelections.incomeStatement12MonthsQuarterly) {
      printQueue.push({ 
        view: 'financial-statements', 
        type: 'income-statement', 
        display: 'quarterly',
        title: 'Income Statement - Last 12 Months (Quarterly)' 
      });
    }
    if (printPackageSelections.incomeStatement3YearsAnnual) {
      printQueue.push({ 
        view: 'financial-statements', 
        type: 'income-statement', 
        display: 'annual',
        title: 'Income Statement - Last 3 Years (Annual)' 
      });
    }
    if (printPackageSelections.balanceSheet12MonthsQuarterly) {
      printQueue.push({ 
        view: 'financial-statements', 
        type: 'balance-sheet', 
        display: 'quarterly',
        title: 'Balance Sheet - Last 12 Months (Quarterly)' 
      });
    }
    if (printPackageSelections.balanceSheet3YearsAnnual) {
      printQueue.push({ 
        view: 'financial-statements', 
        type: 'balance-sheet', 
        display: 'annual',
        title: 'Balance Sheet - Last 3 Years (Annual)' 
      });
    }
    if (printPackageSelections.profile) {
      printQueue.push({ view: 'profile', title: 'Company Profile' });
    }

    if (printQueue.length === 0) {
      alert('Please select at least one report to print.');
      return;
    }

    // Show confirmation
    const reportNames = printQueue.map(p => p.title).join('\n• ');
    if (!confirm(`You are about to print the following reports in sequence:\n\n• ${reportNames}\n\nThis will open ${printQueue.length} print dialog(s). Continue?`)) {
      return;
    }

    // Print each report in sequence with a delay
    let currentIndex = 0;
    const printNext = () => {
      if (currentIndex >= printQueue.length) {
        alert('All reports have been sent to print!');
        return;
      }

      const report = printQueue[currentIndex];
      
      // Set the appropriate view and parameters
      if (report.view === 'financial-statements') {
        setStatementType(report.type as any);
        setStatementDisplay(report.display as any);
        setCurrentView('financial-statements');
      } else if (report.view === 'cash-flow') {
        setCashFlowDisplay(report.display as any);
        setCurrentView('cash-flow');
      } else if (report.view === 'kpis' && report.tab) {
        setKpiDashboardTab(report.tab as any);
        setCurrentView('kpis');
      } else {
        setCurrentView(report.view as any);
      }

      // Wait for render then print
      setTimeout(() => {
        window.print();
        currentIndex++;
        // Wait for print dialog to close before next one
        setTimeout(printNext, 1000);
      }, 500);
    };

    printNext();
  };
  console.log(' RENDER:', { currentView, isLoggedIn, userType: currentUser?.userType, role: currentUser?.role });
  return (

  return (
    <div style={{ minHeight: '100vh', background: '#f8fafc', display: 'flex', flexDirection: 'column' }}>
      {/* Header - Different for Site Admin */}
      {currentUser?.role === 'siteadmin' ? (
        <header style={{ background: 'white', borderBottom: '2px solid #e2e8f0', padding: '16px 32px', display: 'flex', justifyContent: 'space-between', alignItems: 'center', boxShadow: '0 2px 8px rgba(0,0,0,0.05)', position: 'fixed', top: 0, left: 0, right: 0, zIndex: 1000 }}>
          <div style={{ display: 'flex', alignItems: 'center', gap: '80px' }}>
            <div 
              style={{ fontSize: '28px', fontWeight: '700', color: '#4338ca', cursor: 'pointer', letterSpacing: '-0.5px' }} 
              onClick={() => setCurrentView('siteadmin')}
            >
              Venturis<sup style={{ fontSize: '12px', fontWeight: '400' }}>TM</sup>
            </div>
            <h2 style={{ fontSize: '20px', fontWeight: '600', color: '#1e293b' }}>Site Administration</h2>
          </div>
          <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
            <span style={{ fontSize: '14px', color: '#64748b' }}>{currentUser?.name}</span>
            <button onClick={handleLogout} style={{ padding: '8px 16px', background: '#ef4444', color: 'white', border: 'none', borderRadius: '8px', fontSize: '14px', fontWeight: '600', cursor: 'pointer' }}>Logout</button>
          </div>
        </header>
      ) : (
        <>
        {/* Hide top navigation for assessment users */}
        {!(currentUser?.userType === 'assessment') && (
        <header style={{ background: 'white', borderBottom: '2px solid #e2e8f0', padding: '16px 32px', display: 'flex', justifyContent: 'space-between', alignItems: 'center', boxShadow: '0 2px 8px rgba(0,0,0,0.05)', position: 'fixed', top: 0, left: 0, right: 0, zIndex: 1000 }}>
          <div style={{ display: 'flex', alignItems: 'center', gap: '80px' }}>
            <div 
              style={{ fontSize: '28px', fontWeight: '700', color: '#4338ca', cursor: 'pointer', letterSpacing: '-0.5px' }} 
              onClick={() => currentUser?.role === 'consultant' ? setCurrentView('admin') : setCurrentView('fs-score')}
            >
              Venturis<sup style={{ fontSize: '12px', fontWeight: '400' }}>TM</sup>
            </div>
            <nav style={{ display: 'flex', gap: '24px' }}>
              <button onClick={() => setCurrentView('mda')} style={{ background: 'none', border: 'none', fontSize: '16px', fontWeight: '600', color: currentView === 'mda' ? '#667eea' : '#64748b', cursor: 'pointer', padding: '8px 12px', borderBottom: currentView === 'mda' ? '3px solid #667eea' : '3px solid transparent' }}>MD&A</button>
              <button onClick={() => setCurrentView('kpis')} style={{ background: 'none', border: 'none', fontSize: '16px', fontWeight: '600', color: currentView === 'kpis' ? '#667eea' : '#64748b', cursor: 'pointer', padding: '8px 12px', borderBottom: currentView === 'kpis' ? '3px solid #667eea' : '3px solid transparent' }}>KPI Dashboard</button>
              <button onClick={() => setCurrentView('trend-analysis')} style={{ background: 'none', border: 'none', fontSize: '16px', fontWeight: '600', color: currentView === 'trend-analysis' ? '#667eea' : '#64748b', cursor: 'pointer', padding: '8px 12px', borderBottom: currentView === 'trend-analysis' ? '3px solid #667eea' : '3px solid transparent' }}>Trend Analysis</button>
              <button onClick={() => setCurrentView('projections')} style={{ background: 'none', border: 'none', fontSize: '16px', fontWeight: '600', color: currentView === 'projections' ? '#667eea' : '#64748b', cursor: 'pointer', padding: '8px 12px', borderBottom: currentView === 'projections' ? '3px solid #667eea' : '3px solid transparent' }}>Projections</button>
              <button onClick={() => setCurrentView('working-capital')} style={{ background: 'none', border: 'none', fontSize: '16px', fontWeight: '600', color: currentView === 'working-capital' ? '#667eea' : '#64748b', cursor: 'pointer', padding: '8px 12px', borderBottom: currentView === 'working-capital' ? '3px solid #667eea' : '3px solid transparent' }}>Working Capital</button>
              <button onClick={() => setCurrentView('valuation')} style={{ background: 'none', border: 'none', fontSize: '16px', fontWeight: '600', color: currentView === 'valuation' ? '#667eea' : '#64748b', cursor: 'pointer', padding: '8px 12px', borderBottom: currentView === 'valuation' ? '3px solid #667eea' : '3px solid transparent' }}>Valuation</button>
              <button onClick={() => setCurrentView('cash-flow')} style={{ background: 'none', border: 'none', fontSize: '16px', fontWeight: '600', color: currentView === 'cash-flow' ? '#667eea' : '#64748b', cursor: 'pointer', padding: '8px 12px', borderBottom: currentView === 'cash-flow' ? '3px solid #667eea' : '3px solid transparent' }}>Cash Flow</button>
              <button onClick={() => setCurrentView('financial-statements')} style={{ background: 'none', border: 'none', fontSize: '16px', fontWeight: '600', color: currentView === 'financial-statements' ? '#667eea' : '#64748b', cursor: 'pointer', padding: '8px 12px', borderBottom: currentView === 'financial-statements' ? '3px solid #667eea' : '3px solid transparent' }}>Financial Statements</button>
            </nav>
          </div>
        </header>
        )}
        
        {/* Simple header for assessment users */}
        {currentUser?.userType === 'assessment' && (
        <header style={{ background: 'white', borderBottom: '2px solid #e2e8f0', padding: '16px 32px', display: 'flex', justifyContent: 'space-between', alignItems: 'center', boxShadow: '0 2px 8px rgba(0,0,0,0.05)', position: 'fixed', top: 0, left: 0, right: 0, zIndex: 1000 }}>
          <div style={{ fontSize: '28px', fontWeight: '700', color: '#4338ca', letterSpacing: '-0.5px' }}>
            Venturis<sup style={{ fontSize: '12px', fontWeight: '400' }}>TM</sup> - Management Assessment
          </div>
          <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
            <span style={{ fontSize: '14px', color: '#64748b' }}>{currentUser?.name}</span>
            <button onClick={handleLogout} style={{ padding: '8px 16px', background: '#ef4444', color: 'white', border: 'none', borderRadius: '8px', fontSize: '14px', fontWeight: '600', cursor: 'pointer' }}>Logout</button>
          </div>
        </header>
        )}
        </>
      )}

      {/* Main Content Area with Sidebar */}
      <div style={{ display: 'flex', flex: 1, overflow: 'hidden', paddingTop: '70px' }}>
        {/* Left Navigation Sidebar - Not for Site Admin */}
        {currentUser?.role !== 'siteadmin' && !(currentUser?.userType === 'assessment') && (
        <aside style={{ 
          width: '280px', 
          background: 'white', 
          borderRight: '2px solid #e2e8f0', 
          padding: '24px 0',
          overflowY: 'auto',
          flexShrink: 0,
          boxShadow: '2px 0 8px rgba(0,0,0,0.03)',
          display: 'flex',
          flexDirection: 'column'
        }}>
          {/* User Info and Logout at Top */}
          <div style={{ padding: '0 24px 24px', borderBottom: '2px solid #e2e8f0' }}>
            {companyName && (
              <div style={{ marginBottom: '12px', padding: '12px', background: '#f0f9ff', borderRadius: '8px', border: '1px solid #bae6fd' }}>
                <div style={{ fontSize: '11px', fontWeight: '600', color: '#0c4a6e', marginBottom: '4px', textTransform: 'uppercase', letterSpacing: '0.5px' }}>Active Company</div>
                <div style={{ fontSize: '14px', fontWeight: '600', color: '#1e40af' }}>{companyName}</div>
              </div>
            )}
            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', gap: '12px' }}>
              <div style={{ flex: 1 }}>
                <div style={{ fontSize: '11px', fontWeight: '600', color: '#64748b', marginBottom: '4px', textTransform: 'uppercase', letterSpacing: '0.5px' }}>Logged In As</div>
                <div style={{ fontSize: '14px', fontWeight: '600', color: '#475569' }}>{currentUser?.name}</div>
                <div style={{ fontSize: '12px', color: '#94a3b8' }}>{currentUser?.email}</div>
              </div>
              <button 
                onClick={handleLogout} 
                style={{ 
                  padding: '8px 16px', 
                  background: '#ef4444', 
                  color: 'white', 
                  border: 'none', 
                  borderRadius: '6px', 
                  fontSize: '13px', 
                  fontWeight: '600', 
                  cursor: 'pointer',
                  transition: 'background 0.2s',
                  whiteSpace: 'nowrap'
                }}
                onMouseEnter={(e) => e.currentTarget.style.background = '#dc2626'}
                onMouseLeave={(e) => e.currentTarget.style.background = '#ef4444'}
              >
                Logout
              </button>
            </div>
          </div>
          
          <nav style={{ flex: 1, display: 'flex', flexDirection: 'column', paddingTop: '24px' }}>
            {/* Financial Score Section */}
            <div style={{ marginBottom: '12px' }}>
              <h3 
                onClick={() => setIsFinancialScoreExpanded(!isFinancialScoreExpanded)}
                style={{ 
                  fontSize: '14px', 
                  fontWeight: '700', 
                  color: '#1e293b',
                  textTransform: 'uppercase', 
                  letterSpacing: '0.5px',
                  padding: '8px 24px',
                  marginBottom: '8px',
                  cursor: 'pointer',
                  display: 'flex',
                  justifyContent: 'space-between',
                  alignItems: 'center',
                  transition: 'color 0.2s'
                }}
                onMouseEnter={(e) => e.currentTarget.style.color = '#667eea'}
                onMouseLeave={(e) => e.currentTarget.style.color = '#1e293b'}
              >
                <span>Financial Score</span>
                <span style={{ fontSize: '12px', color: '#667eea' }}>{isFinancialScoreExpanded ? '-' : '+'}</span>
              </h3>
              {isFinancialScoreExpanded && (
                <div style={{ paddingLeft: '28px' }}>
                  <div
                    onClick={() => setCurrentView('fs-intro')}
                    style={{
                      fontSize: '14px',
                      color: currentView === 'fs-intro' ? '#667eea' : '#475569',
                      padding: '8px 12px',
                      cursor: 'pointer',
                      borderRadius: '6px',
                      marginBottom: '4px',
                      background: currentView === 'fs-intro' ? '#ede9fe' : 'transparent',
                      fontWeight: currentView === 'fs-intro' ? '600' : '400',
                      transition: 'all 0.2s'
                    }}
                    onMouseEnter={(e) => {
                      if (currentView !== 'fs-intro') {
                        e.currentTarget.style.background = '#f8fafc';
                        e.currentTarget.style.color = '#667eea';
                      }
                    }}
                    onMouseLeave={(e) => {
                      if (currentView !== 'fs-intro') {
                        e.currentTarget.style.background = 'transparent';
                        e.currentTarget.style.color = '#475569';
                      }
                    }}
                  >
                    {currentView === 'fs-intro' && '• '}Introduction
                  </div>
                  <div
                    onClick={() => setCurrentView('fs-score')}
                    style={{
                      fontSize: '14px',
                      color: currentView === 'fs-score' ? '#667eea' : '#475569',
                      padding: '8px 12px',
                      cursor: 'pointer',
                      borderRadius: '6px',
                      marginBottom: '4px',
                      background: currentView === 'fs-score' ? '#ede9fe' : 'transparent',
                      fontWeight: currentView === 'fs-score' ? '600' : '400',
                      transition: 'all 0.2s'
                    }}
                    onMouseEnter={(e) => {
                      if (currentView !== 'fs-score') {
                        e.currentTarget.style.background = '#f8fafc';
                        e.currentTarget.style.color = '#667eea';
                      }
                    }}
                    onMouseLeave={(e) => {
                      if (currentView !== 'fs-score') {
                        e.currentTarget.style.background = 'transparent';
                        e.currentTarget.style.color = '#475569';
                      }
                    }}
                  >
                    {currentView === 'fs-score' && '• '}Financial Score
                  </div>
                </div>
              )}
            </div>

            {/* Management Assessment Section - For Assessment Users and Consultants */}
            {((currentUser?.role === 'user' && currentUser?.userType === 'assessment') || currentUser?.role === 'consultant') && (
            <div style={{ marginBottom: '12px' }}>
              <h3 
                onClick={() => setIsManagementAssessmentExpanded(!isManagementAssessmentExpanded)}
                style={{ 
                  fontSize: '14px', 
                  fontWeight: '700', 
                  color: '#1e293b',
                  textTransform: 'uppercase', 
                  letterSpacing: '0.5px',
                  padding: '8px 24px',
                  marginBottom: '8px',
                  cursor: 'pointer',
                  display: 'flex',
                  justifyContent: 'space-between',
                  alignItems: 'center',
                  transition: 'color 0.2s'
                }}
                onMouseEnter={(e) => e.currentTarget.style.color = '#667eea'}
                onMouseLeave={(e) => e.currentTarget.style.color = '#1e293b'}
              >
                <span>Management Assessment</span>
                <span style={{ fontSize: '12px', color: '#667eea' }}>{isManagementAssessmentExpanded ? '-' : '+'}</span>
              </h3>
              {isManagementAssessmentExpanded && (
                <div style={{ paddingLeft: '28px' }}>
                <div
                  onClick={() => setCurrentView('ma-welcome')}
                  style={{
                    fontSize: '14px',
                    color: currentView === 'ma-welcome' ? '#667eea' : '#475569',
                    padding: '8px 12px',
                    cursor: 'pointer',
                    borderRadius: '6px',
                    marginBottom: '4px',
                    background: currentView === 'ma-welcome' ? '#ede9fe' : 'transparent',
                    fontWeight: currentView === 'ma-welcome' ? '600' : '400',
                    transition: 'all 0.2s'
                  }}
                  onMouseEnter={(e) => {
                    if (currentView !== 'ma-welcome') {
                      e.currentTarget.style.background = '#f8fafc';
                      e.currentTarget.style.color = '#667eea';
                    }
                  }}
                  onMouseLeave={(e) => {
                    if (currentView !== 'ma-welcome') {
                      e.currentTarget.style.background = 'transparent';
                      e.currentTarget.style.color = '#475569';
                    }
                  }}
                >
                  {currentView === 'ma-welcome' && '• '}Welcome
                </div>
                <div
                  onClick={() => setCurrentView('ma-questionnaire')}
                  style={{
                    fontSize: '14px',
                    color: currentView === 'ma-questionnaire' ? '#667eea' : '#475569',
                    padding: '8px 12px',
                    cursor: 'pointer',
                    borderRadius: '6px',
                    marginBottom: '4px',
                    background: currentView === 'ma-questionnaire' ? '#ede9fe' : 'transparent',
                    fontWeight: currentView === 'ma-questionnaire' ? '600' : '400',
                    transition: 'all 0.2s'
                  }}
                  onMouseEnter={(e) => {
                    if (currentView !== 'ma-questionnaire') {
                      e.currentTarget.style.background = '#f8fafc';
                      e.currentTarget.style.color = '#667eea';
                    }
                  }}
                  onMouseLeave={(e) => {
                    if (currentView !== 'ma-questionnaire') {
                      e.currentTarget.style.background = 'transparent';
                      e.currentTarget.style.color = '#475569';
                    }
                  }}
                >
                  {currentView === 'ma-questionnaire' && '• '}Questionnaire
                </div>
                <div
                  onClick={() => setCurrentView('ma-your-results')}
                  style={{
                    fontSize: '14px',
                    color: currentView === 'ma-your-results' ? '#667eea' : '#475569',
                    padding: '8px 12px',
                    cursor: 'pointer',
                    borderRadius: '6px',
                    marginBottom: '4px',
                    background: currentView === 'ma-your-results' ? '#ede9fe' : 'transparent',
                    fontWeight: currentView === 'ma-your-results' ? '600' : '400',
                    transition: 'all 0.2s'
                  }}
                  onMouseEnter={(e) => {
                    if (currentView !== 'ma-your-results') {
                      e.currentTarget.style.background = '#f8fafc';
                      e.currentTarget.style.color = '#667eea';
                    }
                  }}
                  onMouseLeave={(e) => {
                    if (currentView !== 'ma-your-results') {
                      e.currentTarget.style.background = 'transparent';
                      e.currentTarget.style.color = '#475569';
                    }
                  }}
                >
                  {currentView === 'ma-your-results' && '• '}{currentUser?.role === 'consultant' ? 'Results' : 'Your Results'}
                </div>
                <div
                  onClick={() => setCurrentView('ma-scores-summary')}
                  style={{
                    fontSize: '14px',
                    color: currentView === 'ma-scores-summary' ? '#667eea' : '#475569',
                    padding: '8px 12px',
                    cursor: 'pointer',
                    borderRadius: '6px',
                    marginBottom: '4px',
                    background: currentView === 'ma-scores-summary' ? '#ede9fe' : 'transparent',
                    fontWeight: currentView === 'ma-scores-summary' ? '600' : '400',
                    transition: 'all 0.2s'
                  }}
                  onMouseEnter={(e) => {
                    if (currentView !== 'ma-scores-summary') {
                      e.currentTarget.style.background = '#f8fafc';
                      e.currentTarget.style.color = '#667eea';
                    }
                  }}
                  onMouseLeave={(e) => {
                    if (currentView !== 'ma-scores-summary') {
                      e.currentTarget.style.background = 'transparent';
                      e.currentTarget.style.color = '#475569';
                    }
                  }}
                >
                  {currentView === 'ma-scores-summary' && '• '}Scores Summary
                </div>
                <div
                  onClick={() => setCurrentView('ma-scoring-guide')}
                  style={{
                    fontSize: '14px',
                    color: currentView === 'ma-scoring-guide' ? '#667eea' : '#475569',
                    padding: '8px 12px',
                    cursor: 'pointer',
                    borderRadius: '6px',
                    marginBottom: '4px',
                    background: currentView === 'ma-scoring-guide' ? '#ede9fe' : 'transparent',
                    fontWeight: currentView === 'ma-scoring-guide' ? '600' : '400',
                    transition: 'all 0.2s'
                  }}
                  onMouseEnter={(e) => {
                    if (currentView !== 'ma-scoring-guide') {
                      e.currentTarget.style.background = '#f8fafc';
                      e.currentTarget.style.color = '#667eea';
                    }
                  }}
                  onMouseLeave={(e) => {
                    if (currentView !== 'ma-scoring-guide') {
                      e.currentTarget.style.background = 'transparent';
                      e.currentTarget.style.color = '#475569';
                    }
                  }}
                >
                  {currentView === 'ma-scoring-guide' && '• '}Scoring Guide
                </div>
                <div
                  onClick={() => setCurrentView('ma-charts')}
                  style={{
                    fontSize: '14px',
                    color: currentView === 'ma-charts' ? '#667eea' : '#475569',
                    padding: '8px 12px',
                    cursor: 'pointer',
                    borderRadius: '6px',
                    marginBottom: '4px',
                    background: currentView === 'ma-charts' ? '#ede9fe' : 'transparent',
                    fontWeight: currentView === 'ma-charts' ? '600' : '400',
                    transition: 'all 0.2s'
                  }}
                  onMouseEnter={(e) => {
                    if (currentView !== 'ma-charts') {
                      e.currentTarget.style.background = '#f8fafc';
                      e.currentTarget.style.color = '#667eea';
                    }
                  }}
                  onMouseLeave={(e) => {
                    if (currentView !== 'ma-charts') {
                      e.currentTarget.style.background = 'transparent';
                      e.currentTarget.style.color = '#475569';
                    }
                  }}
                >
                  {currentView === 'ma-charts' && '• '}Charts
                </div>
              </div>
              )}
            </div>
            )}

            {/* Custom Print Section - For Consultants and Company Users only */}
            {(currentUser?.role === 'consultant' || (currentUser?.role === 'user' && currentUser?.userType === 'company')) && (
              <div style={{ marginBottom: '12px' }}>
                <h3 
                  onClick={() => setCurrentView('custom-print')}
                  style={{ 
                    fontSize: '14px', 
                    fontWeight: '700', 
                    color: currentView === 'custom-print' ? '#667eea' : '#1e293b',
                    textTransform: 'uppercase', 
                    letterSpacing: '0.5px',
                    padding: '8px 24px',
                    marginBottom: '8px',
                    cursor: 'pointer',
                    transition: 'color 0.2s',
                    borderLeft: currentView === 'custom-print' ? '4px solid #667eea' : '4px solid transparent'
                  }}
                  onMouseEnter={(e) => e.currentTarget.style.color = '#667eea'}
                  onMouseLeave={(e) => e.currentTarget.style.color = currentView === 'custom-print' ? '#667eea' : '#1e293b'}
                >
                  Custom Print
                </h3>
              </div>
            )}

            {/* Consultant Dashboard Section */}
            {currentUser?.role === 'consultant' && (
              <div style={{ marginBottom: '12px' }}>
                <h3 
                  onClick={() => setCurrentView('admin')}
                  style={{ 
                    fontSize: '14px', 
                    fontWeight: '700', 
                    color: currentView === 'admin' ? '#667eea' : '#1e293b',
                    textTransform: 'uppercase', 
                    letterSpacing: '0.5px',
                    padding: '8px 24px',
                    marginBottom: '8px',
                    cursor: 'pointer',
                    transition: 'color 0.2s',
                    borderLeft: currentView === 'admin' ? '4px solid #667eea' : '4px solid transparent'
                  }}
                  onMouseEnter={(e) => e.currentTarget.style.color = '#667eea'}
                  onMouseLeave={(e) => e.currentTarget.style.color = currentView === 'admin' ? '#667eea' : '#1e293b'}
                >
                  {currentUser.consultantType === 'business' ? 'Business Dashboard' : 'Consultant Dashboard'}
                </h3>
                
                {/* Selected Company Name Display for Business Users */}
                {currentUser.consultantType === 'business' && selectedCompanyId && companies.find(c => c.id === selectedCompanyId) && (
                  <div style={{ 
                    paddingLeft: '28px', 
                    marginBottom: '12px',
                    paddingBottom: '12px',
                    borderBottom: '2px solid #e2e8f0'
                  }}>
                    <div style={{ 
                      fontSize: '16px', 
                      fontWeight: '600', 
                      color: '#667eea',
                      padding: '8px 12px',
                      background: '#f0f9ff',
                      borderRadius: '8px',
                      border: '2px solid #bfdbfe'
                    }}>
                      {companies.find(c => c.id === selectedCompanyId)?.name}
                    </div>
                  </div>
                )}
                
                {/* My Companies List - Only for Regular Consultants */}
                {currentUser.consultantType !== 'business' && (
                  <div style={{ paddingLeft: '28px' }}>
                    {/* List of Companies */}
                    {companies.filter(c => c.consultantId === currentUser.consultantId).length > 0 ? (
                      <div>
                        <div style={{ fontSize: '11px', fontWeight: '600', color: '#64748b', textTransform: 'uppercase', letterSpacing: '0.5px', marginBottom: '8px', padding: '4px 0' }}>
                          My Companies
                        </div>
                        {companies.filter(c => c.consultantId === currentUser.consultantId).map(comp => (
                          <div
                            key={comp.id}
                            onClick={() => handleSelectCompany(comp.id)}
                            style={{
                              fontSize: '14px',
                              color: selectedCompanyId === comp.id ? '#667eea' : '#475569',
                              padding: '8px 12px',
                              cursor: 'pointer',
                              borderRadius: '6px',
                              marginBottom: '4px',
                              background: selectedCompanyId === comp.id ? '#ede9fe' : 'transparent',
                              fontWeight: selectedCompanyId === comp.id ? '600' : '400',
                              transition: 'all 0.2s'
                            }}
                            onMouseEnter={(e) => {
                              if (selectedCompanyId !== comp.id) {
                                e.currentTarget.style.background = '#f8fafc';
                                e.currentTarget.style.color = '#667eea';
                              }
                            }}
                            onMouseLeave={(e) => {
                              if (selectedCompanyId !== comp.id) {
                                e.currentTarget.style.background = 'transparent';
                                e.currentTarget.style.color = '#475569';
                              }
                            }}
                          >
                            {selectedCompanyId === comp.id && '• '}{comp.name}
                          </div>
                        ))}
                      </div>
                    ) : (
                      <div style={{ fontSize: '13px', color: '#94a3b8', padding: '8px 0', fontStyle: 'italic' }}>
                        No companies yet
                      </div>
                    )}
                    
                    {/* Add Company Button */}
                    <button
                      onClick={() => {
                        setCurrentView('admin');
                        setSelectedCompanyId('');
                        setAdminDashboardTab('company-management');
                      }}
                      style={{
                        marginTop: '12px',
                        width: '100%',
                        padding: '8px 12px',
                        background: '#10b981',
                        color: 'white',
                        border: 'none',
                        borderRadius: '6px',
                        fontSize: '13px',
                        fontWeight: '600',
                        cursor: 'pointer',
                        transition: 'all 0.2s',
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'center',
                        gap: '6px'
                      }}
                      onMouseEnter={(e) => e.currentTarget.style.background = '#059669'}
                      onMouseLeave={(e) => e.currentTarget.style.background = '#10b981'}
                    >
                      <span style={{ fontSize: '16px', fontWeight: '700' }}>+</span> Add Company
                    </button>
                  </div>
                )}
              </div>
            )}
          </nav>
        </aside>
        )}

        {/* Assessment User Sidebar - Only Management Assessment */}
        {currentUser?.userType === 'assessment' && (
        <aside style={{ 
          width: '280px', 
          background: 'white', 
          borderRight: '2px solid #e2e8f0', 
          padding: '24px 0',
          display: 'flex',
          flexDirection: 'column'
        }}>
          <div style={{ padding: '0 24px', marginBottom: '12px' }}>
            <h2 style={{ fontSize: '16px', fontWeight: '700', color: '#1e293b', marginBottom: '8px' }}>Navigation</h2>
            <p style={{ fontSize: '12px', color: '#64748b' }}>Management Assessment</p>
          </div>
          
          <nav style={{ flex: 1, display: 'flex', flexDirection: 'column', paddingTop: '24px' }}>
            {/* Management Assessment Section */}
            <div style={{ marginBottom: '12px' }}>
              <h3 
                onClick={() => setIsManagementAssessmentExpanded(!isManagementAssessmentExpanded)}
                style={{ 
                  fontSize: '14px', 
                  fontWeight: '700', 
                  color: '#1e293b',
                  textTransform: 'uppercase', 
                  letterSpacing: '0.5px',
                  padding: '8px 24px',
                  marginBottom: '8px',
                  cursor: 'pointer',
                  display: 'flex',
                  justifyContent: 'space-between',
                  alignItems: 'center',
                  transition: 'color 0.2s'
                }}
                onMouseEnter={(e) => e.currentTarget.style.color = '#667eea'}
                onMouseLeave={(e) => e.currentTarget.style.color = '#1e293b'}
              >
                <span>Management Assessment</span>
                <span style={{ fontSize: '12px', color: '#667eea' }}>{isManagementAssessmentExpanded ? '-' : '+'}</span>
              </h3>
              {isManagementAssessmentExpanded && (
                <div style={{ paddingLeft: '28px' }}>
                  <div
                    onClick={() => handleViewChange('ma-welcome')}
                    style={{
                      fontSize: '14px',
                      color: currentView === 'ma-welcome' ? '#667eea' : '#475569',
                      padding: '8px 12px',
                      cursor: 'pointer',
                      borderRadius: '6px',
                      marginBottom: '4px',
                      background: currentView === 'ma-welcome' ? '#ede9fe' : 'transparent',
                      fontWeight: currentView === 'ma-welcome' ? '600' : '400',
                      transition: 'all 0.2s'
                    }}
                    onMouseEnter={(e) => {
                      if (currentView !== 'ma-welcome') {
                        e.currentTarget.style.background = '#f8fafc';
                        e.currentTarget.style.color = '#667eea';
                      }
                    }}
                    onMouseLeave={(e) => {
                      if (currentView !== 'ma-welcome') {
                        e.currentTarget.style.background = 'transparent';
                        e.currentTarget.style.color = '#475569';
                      }
                    }}
                  >
                    Welcome
                  </div>
                  <div
                    onClick={() => handleViewChange('ma-questionnaire')}
                    style={{
                      fontSize: '14px',
                      color: currentView === 'ma-questionnaire' ? '#667eea' : '#475569',
                      padding: '8px 12px',
                      cursor: 'pointer',
                      borderRadius: '6px',
                      marginBottom: '4px',
                      background: currentView === 'ma-questionnaire' ? '#ede9fe' : 'transparent',
                      fontWeight: currentView === 'ma-questionnaire' ? '600' : '400',
                      transition: 'all 0.2s'
                    }}
                    onMouseEnter={(e) => {
                      if (currentView !== 'ma-questionnaire') {
                        e.currentTarget.style.background = '#f8fafc';
                        e.currentTarget.style.color = '#667eea';
                      }
                    }}
                    onMouseLeave={(e) => {
                      if (currentView !== 'ma-questionnaire') {
                        e.currentTarget.style.background = 'transparent';
                        e.currentTarget.style.color = '#475569';
                      }
                    }}
                  >
                    Questionnaire
                  </div>
                  <div
                    onClick={() => handleViewChange('ma-your-results')}
                    style={{
                      fontSize: '14px',
                      color: currentView === 'ma-your-results' ? '#667eea' : '#475569',
                      padding: '8px 12px',
                      cursor: 'pointer',
                      borderRadius: '6px',
                      marginBottom: '4px',
                      background: currentView === 'ma-your-results' ? '#ede9fe' : 'transparent',
                      fontWeight: currentView === 'ma-your-results' ? '600' : '400',
                      transition: 'all 0.2s'
                    }}
                    onMouseEnter={(e) => {
                      if (currentView !== 'ma-your-results') {
                        e.currentTarget.style.background = '#f8fafc';
                        e.currentTarget.style.color = '#667eea';
                      }
                    }}
                    onMouseLeave={(e) => {
                      if (currentView !== 'ma-your-results') {
                        e.currentTarget.style.background = 'transparent';
                        e.currentTarget.style.color = '#475569';
                      }
                    }}
                  >
                    Results
                  </div>
                </div>
              )}
            </div>
          </nav>
        </aside>
        )}

        {/* Main Content Area */}
        <main style={{ flex: 1, overflowY: 'auto', overflowX: 'hidden' }}>
          {/* Restrict access for assessment users - only show Management Assessment views */}
          {(!(currentUser?.userType === 'assessment') || currentView === 'ma-questionnaire' || currentView === 'ma-your-results' || currentView === 'ma-scores-summary' || currentView === 'ma-charts' || currentView === 'ma-scoring-guide') && (
          <>
          {/* Site Administration */}
          {currentView === 'siteadmin' && currentUser?.role === 'siteadmin' && (
            <div style={{ maxWidth: '1600px', margin: '0 auto', padding: '20px' }}>
              <h1 style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b', marginBottom: '16px' }}>Site Administration</h1>
              
              {/* Tab Navigation */}
              <div style={{ display: 'flex', gap: '4px', marginBottom: '16px', borderBottom: '2px solid #e2e8f0' }}>
                <button
                  onClick={() => setSiteAdminTab('consultants')}
                  style={{
                    padding: '8px 16px',
                    background: siteAdminTab === 'consultants' ? '#667eea' : 'transparent',
                    color: siteAdminTab === 'consultants' ? 'white' : '#64748b',
                    border: 'none',
                    borderBottom: siteAdminTab === 'consultants' ? '3px solid #667eea' : '3px solid transparent',
                    fontSize: '14px',
                    fontWeight: '600',
                    cursor: 'pointer',
                    borderRadius: '6px 6px 0 0',
                    transition: 'all 0.2s'
                  }}
                >
                  Consultants
                </button>
                <button
                  onClick={() => setSiteAdminTab('businesses')}
                  style={{
                    padding: '8px 16px',
                    background: siteAdminTab === 'businesses' ? '#667eea' : 'transparent',
                    color: siteAdminTab === 'businesses' ? 'white' : '#64748b',
                    border: 'none',
                    borderBottom: siteAdminTab === 'businesses' ? '3px solid #667eea' : '3px solid transparent',
                    fontSize: '14px',
                    fontWeight: '600',
                    cursor: 'pointer',
                    borderRadius: '6px 6px 0 0',
                    transition: 'all 0.2s'
                  }}
                >
                  Businesses
                </button>
              </div>

              {/* Consultants Tab */}
              {siteAdminTab === 'consultants' && (
              <>
              {/* Add Consultant Form */}
              <div style={{ background: 'white', borderRadius: '8px', padding: '12px 16px', marginBottom: '16px', boxShadow: '0 1px 3px rgba(0,0,0,0.08)' }}>
                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: showAddConsultantForm ? '12px' : '0' }}>
                  <h2 style={{ fontSize: '16px', fontWeight: '600', color: '#1e293b', margin: 0 }}>Add New Consultant</h2>
                  <button
                    onClick={() => setShowAddConsultantForm(!showAddConsultantForm)}
                    style={{ 
                      padding: '4px 12px', 
                      background: showAddConsultantForm ? '#f1f5f9' : '#667eea', 
                      color: showAddConsultantForm ? '#475569' : 'white', 
                      border: 'none', 
                      borderRadius: '6px', 
                      fontSize: '12px', 
                      fontWeight: '600', 
                      cursor: 'pointer' 
                    }}
                  >
                    {showAddConsultantForm ? '▲' : '▼'}
                  </button>
                </div>
                {showAddConsultantForm && (
                  <>
                    <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '8px', marginBottom: '10px' }}>
                      <input
                        type="text"
                        placeholder="Type"
                        value={newConsultantType}
                        onChange={(e) => setNewConsultantType(e.target.value)}
                        style={{ padding: '8px 12px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '13px' }}
                      />
                      <input
                        type="text"
                        placeholder="Full Name"
                        value={newConsultantFullName}
                        onChange={(e) => setNewConsultantFullName(e.target.value)}
                        style={{ padding: '8px 12px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '13px' }}
                      />
                      <input
                        type="text"
                        placeholder="Address"
                        value={newConsultantAddress}
                        onChange={(e) => setNewConsultantAddress(e.target.value)}
                        style={{ padding: '8px 12px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '13px' }}
                      />
                      <input
                        type="email"
                        placeholder="Email"
                        value={newConsultantEmail}
                        onChange={(e) => setNewConsultantEmail(e.target.value)}
                        style={{ padding: '8px 12px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '13px' }}
                      />
                      <input
                        type="tel"
                        placeholder="Phone"
                        value={newConsultantPhone}
                        onChange={(e) => setNewConsultantPhone(e.target.value)}
                        style={{ padding: '8px 12px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '13px' }}
                      />
                      <input
                        type="password"
                        placeholder="Password"
                        value={newConsultantPassword}
                        onChange={(e) => setNewConsultantPassword(e.target.value)}
                        style={{ padding: '8px 12px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '13px' }}
                      />
                    </div>
                    <button
                      onClick={addConsultant}
                      style={{ padding: '8px 20px', background: '#10b981', color: 'white', border: 'none', borderRadius: '6px', fontSize: '13px', fontWeight: '600', cursor: 'pointer' }}
                    >
                      Add Consultant
                    </button>
                  </>
                )}
              </div>

              {/* Consultants List */}
              <div style={{ fontSize: '14px', fontWeight: '600', color: '#64748b', marginBottom: '10px' }}>
                Total Consultants: {consultants.filter(c => c.type !== 'business').length}
              </div>

              {consultants.filter(c => c.type !== 'business').length === 0 ? (
                <div style={{ background: 'white', borderRadius: '8px', padding: '40px', textAlign: 'center', boxShadow: '0 1px 3px rgba(0,0,0,0.08)' }}>
                  <div style={{ fontSize: '36px', marginBottom: '12px' }}>👥</div>
                  <h3 style={{ fontSize: '16px', fontWeight: '600', color: '#64748b', marginBottom: '6px' }}>No Consultants</h3>
                  <p style={{ fontSize: '13px', color: '#94a3b8' }}>Add your first consultant to get started</p>
                </div>
              ) : (
                <div style={{ display: 'grid', gap: '12px' }}>
                  {consultants.filter(c => c.type !== 'business').map((consultant) => {
                    const consultantCompanies = getConsultantCompanies(consultant.id);
                    const expanded = selectedConsultantId === consultant.id;

                    return (
                      <div key={consultant.id} style={{ background: 'white', borderRadius: '8px', padding: '12px 16px', boxShadow: '0 1px 3px rgba(0,0,0,0.08)', border: '1px solid #e2e8f0' }}>
                        {/* Consultant Header */}
                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                          <div style={{ flex: 1 }}>
                            <h3 
                              onClick={() => {
                                // Save current admin user
                                setSiteAdminViewingAs(currentUser);
                                // Switch to viewing this consultant's dashboard
                                setCurrentUser({
                                  ...consultant.user,
                                  role: 'consultant',
                                  consultantId: consultant.id,
                                  consultantType: consultant.type
                                });
                                setCurrentView('admin');
                              }}
                              style={{ 
                                fontSize: '15px', 
                                fontWeight: '600', 
                                color: '#667eea', 
                                marginBottom: '0',
                                cursor: 'pointer',
                                textDecoration: 'underline'
                              }}
                              onMouseEnter={(e) => e.currentTarget.style.color = '#5568d3'}
                              onMouseLeave={(e) => e.currentTarget.style.color = '#667eea'}
                            >
                              {consultant.fullName}
                            </h3>
                          </div>
                          <div style={{ display: 'flex', gap: '8px' }}>
                            <button
                              onClick={() => setSelectedConsultantId(expanded ? '' : consultant.id)}
                              style={{ padding: '6px 12px', background: '#667eea', color: 'white', border: 'none', borderRadius: '6px', fontSize: '12px', fontWeight: '600', cursor: 'pointer' }}
                            >
                              {expanded ? 'Collapse' : 'Expand'}
                            </button>
                            <button
                              onClick={() => deleteConsultant(consultant.id)}
                              style={{ padding: '6px 12px', background: '#ef4444', color: 'white', border: 'none', borderRadius: '6px', fontSize: '12px', fontWeight: '600', cursor: 'pointer' }}
                            >
                              Delete
                            </button>
                          </div>
                        </div>

                        {/* Expanded Details */}
                        {expanded && (
                          <div style={{ borderTop: '1px solid #e2e8f0', paddingTop: '10px', marginTop: '10px' }}>
                            {/* Consultant Information */}
                            <div style={{ marginBottom: '10px', padding: '8px', background: '#f8fafc', borderRadius: '6px' }}>
                              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '6px' }}>
                                <h4 style={{ fontSize: '12px', fontWeight: '600', color: '#475569', margin: 0 }}>Consultant Information</h4>
                                {!editingConsultantInfo[consultant.id] && (
                                  <button
                                    onClick={() => {
                                      setEditingConsultantInfo({
                                        ...editingConsultantInfo,
                                        [consultant.id]: {
                                          fullName: consultant.fullName,
                                          email: consultant.email,
                                          address: consultant.address || '',
                                          phone: consultant.phone || '',
                                          type: consultant.type || ''
                                        }
                                      });
                                    }}
                                    style={{ padding: '3px 8px', background: '#667eea', color: 'white', border: 'none', borderRadius: '4px', fontSize: '10px', fontWeight: '600', cursor: 'pointer' }}
                                  >
                                    Edit
                                  </button>
                                )}
                              </div>
                              
                              {editingConsultantInfo[consultant.id] ? (
                                <div style={{ display: 'flex', flexDirection: 'column', gap: '6px' }}>
                                  <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '6px' }}>
                                    <div>
                                      <label style={{ fontSize: '10px', fontWeight: '600', color: '#475569', display: 'block', marginBottom: '2px' }}>Full Name</label>
                                      <input
                                        type="text"
                                        value={editingConsultantInfo[consultant.id].fullName}
                                        onChange={(e) => setEditingConsultantInfo({
                                          ...editingConsultantInfo,
                                          [consultant.id]: { ...editingConsultantInfo[consultant.id], fullName: e.target.value }
                                        })}
                                        style={{ width: '100%', padding: '4px 6px', border: '1px solid #cbd5e1', borderRadius: '4px', fontSize: '11px' }}
                                      />
                                    </div>
                                    <div>
                                      <label style={{ fontSize: '10px', fontWeight: '600', color: '#475569', display: 'block', marginBottom: '2px' }}>Type</label>
                                      <input
                                        type="text"
                                        value={editingConsultantInfo[consultant.id].type}
                                        onChange={(e) => setEditingConsultantInfo({
                                          ...editingConsultantInfo,
                                          [consultant.id]: { ...editingConsultantInfo[consultant.id], type: e.target.value }
                                        })}
                                        style={{ width: '100%', padding: '4px 6px', border: '1px solid #cbd5e1', borderRadius: '4px', fontSize: '11px' }}
                                      />
                                    </div>
                                    <div>
                                      <label style={{ fontSize: '10px', fontWeight: '600', color: '#475569', display: 'block', marginBottom: '2px' }}>Email</label>
                                      <input
                                        type="email"
                                        value={editingConsultantInfo[consultant.id].email}
                                        onChange={(e) => setEditingConsultantInfo({
                                          ...editingConsultantInfo,
                                          [consultant.id]: { ...editingConsultantInfo[consultant.id], email: e.target.value }
                                        })}
                                        style={{ width: '100%', padding: '4px 6px', border: '1px solid #cbd5e1', borderRadius: '4px', fontSize: '11px' }}
                                      />
                                    </div>
                                    <div>
                                      <label style={{ fontSize: '10px', fontWeight: '600', color: '#475569', display: 'block', marginBottom: '2px' }}>Phone</label>
                                      <input
                                        type="text"
                                        value={editingConsultantInfo[consultant.id].phone}
                                        onChange={(e) => setEditingConsultantInfo({
                                          ...editingConsultantInfo,
                                          [consultant.id]: { ...editingConsultantInfo[consultant.id], phone: e.target.value }
                                        })}
                                        style={{ width: '100%', padding: '4px 6px', border: '1px solid #cbd5e1', borderRadius: '4px', fontSize: '11px' }}
                                      />
                                    </div>
                                  </div>
                                  <div>
                                    <label style={{ fontSize: '10px', fontWeight: '600', color: '#475569', display: 'block', marginBottom: '2px' }}>Address</label>
                                    <input
                                      type="text"
                                      value={editingConsultantInfo[consultant.id].address}
                                      onChange={(e) => setEditingConsultantInfo({
                                        ...editingConsultantInfo,
                                        [consultant.id]: { ...editingConsultantInfo[consultant.id], address: e.target.value }
                                      })}
                                      style={{ width: '100%', padding: '4px 6px', border: '1px solid #cbd5e1', borderRadius: '4px', fontSize: '11px' }}
                                    />
                                  </div>
                                  <div style={{ display: 'flex', gap: '6px', marginTop: '4px' }}>
                                    <button
                                      onClick={() => {
                                        updateConsultantInfo(consultant.id, editingConsultantInfo[consultant.id]);
                                      }}
                                      style={{ padding: '4px 12px', background: '#10b981', color: 'white', border: 'none', borderRadius: '4px', fontSize: '10px', fontWeight: '600', cursor: 'pointer' }}
                                    >
                                      Save
                                    </button>
                                    <button
                                      onClick={() => {
                                        setEditingConsultantInfo((prev) => {
                                          const newState = { ...prev };
                                          delete newState[consultant.id];
                                          return newState;
                                        });
                                      }}
                                      style={{ padding: '4px 12px', background: '#64748b', color: 'white', border: 'none', borderRadius: '4px', fontSize: '10px', fontWeight: '600', cursor: 'pointer' }}
                                    >
                                      Cancel
                                    </button>
                                  </div>
                                </div>
                              ) : (
                                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '4px', fontSize: '11px', color: '#64748b' }}>
                                  <div><span style={{ fontWeight: '600' }}>Type:</span> {consultant.type}</div>
                                  <div><span style={{ fontWeight: '600' }}>Email:</span> {consultant.email}</div>
                                  <div><span style={{ fontWeight: '600' }}>Address:</span> {consultant.address}</div>
                                  <div><span style={{ fontWeight: '600' }}>Phone:</span> {consultant.phone}</div>
                                </div>
                              )}
                            </div>

                            <h4 style={{ fontSize: '13px', fontWeight: '600', color: '#475569', marginBottom: '8px' }}>
                              Companies ({consultantCompanies.length})
                            </h4>
                            
                            {consultantCompanies.length === 0 ? (
                              <div style={{ background: '#f8fafc', borderRadius: '6px', padding: '16px', textAlign: 'center', border: '1px dashed #cbd5e1' }}>
                                <p style={{ fontSize: '12px', color: '#64748b', margin: 0 }}>No companies yet</p>
                              </div>
                            ) : (
                              <div style={{ display: 'grid', gap: '8px' }}>
                                {consultantCompanies.map((company) => {
                                  const companyUsers = getCompanyUsers(company.id);
                                  const isCompanyExpanded = expandedCompanyIds.includes(company.id);
                                  const editing = editingPricing[company.id];
                                  
                                  return (
                                    <div key={company.id} style={{ background: '#f8fafc', borderRadius: '6px', padding: '10px', border: '1px solid #e2e8f0' }}>
                                      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: isCompanyExpanded ? '8px' : '0' }}>
                                        <div style={{ flex: 1 }}>
                                          <h5 style={{ fontSize: '13px', fontWeight: '600', color: '#1e293b', marginBottom: '2px' }}>{company.name}</h5>
                                          <div style={{ fontSize: '11px', color: '#64748b' }}>
                                            <span style={{ fontWeight: '600' }}>Industry:</span> {
                                              company.industrySector 
                                                ? `${company.industrySector} - ${INDUSTRY_SECTORS.find(s => s.id === company.industrySector)?.name || 'Unknown'}` 
                                                : 'Not set'
                                            }
                                          </div>
                                        </div>
                                        <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
                                          <div style={{ fontSize: '11px', fontWeight: '600', color: '#667eea' }}>
                                            {companyUsers.length} user{companyUsers.length !== 1 ? 's' : ''}
                                          </div>
                                          <button
                                            onClick={() => {
                                              setExpandedCompanyIds(prev => 
                                                prev.includes(company.id) 
                                                  ? prev.filter(id => id !== company.id)
                                                  : [...prev, company.id]
                                              );
                                            }}
                                            style={{ 
                                              padding: '4px 10px', 
                                              background: isCompanyExpanded ? '#f1f5f9' : '#667eea', 
                                              color: isCompanyExpanded ? '#475569' : 'white', 
                                              border: 'none', 
                                              borderRadius: '4px', 
                                              fontSize: '11px', 
                                              fontWeight: '600', 
                                              cursor: 'pointer' 
                                            }}
                                          >
                                            {isCompanyExpanded ? '▲' : '▼'}
                                          </button>
                                        </div>
                                      </div>

                                      {/* Expanded Details */}
                                      {isCompanyExpanded && (
                                        <div style={{ borderTop: '1px solid #cbd5e1', paddingTop: '8px', marginTop: '8px' }}>
                                          {/* Company Address */}
                                          {(company.addressStreet || company.addressCity) && (
                                            <div style={{ marginBottom: '8px', padding: '8px', background: 'white', borderRadius: '6px', border: '1px solid #cbd5e1' }}>
                                              <h6 style={{ fontSize: '11px', fontWeight: '600', color: '#475569', marginBottom: '4px' }}>Address</h6>
                                              <div style={{ fontSize: '10px', color: '#64748b', lineHeight: '1.5' }}>
                                                {company.addressStreet && <div>{company.addressStreet}</div>}
                                                <div>
                                                  {company.addressCity && company.addressCity}
                                                  {company.addressState && `, ${company.addressState}`}
                                                  {company.addressZip && ` ${company.addressZip}`}
                                                </div>
                                                {company.addressCountry && <div>{company.addressCountry}</div>}
                                              </div>
                                            </div>
                                          )}
                                          
                                          {/* Subscription Pricing */}
                                          <div style={{ marginBottom: companyUsers.length > 0 ? '8px' : '0', padding: '8px', background: 'white', borderRadius: '6px', border: '1px solid #cbd5e1' }}>
                                            <h6 style={{ fontSize: '11px', fontWeight: '600', color: '#475569', marginBottom: '6px' }}>Subscription Pricing</h6>
                                            {editing ? (
                                              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '6px' }}>
                                                <div>
                                                  <label style={{ fontSize: '10px', color: '#64748b', display: 'block', marginBottom: '2px' }}>Monthly ($)</label>
                                                  <input
                                                    type="number"
                                                    value={editing.monthly}
                                                    onChange={(e) => setEditingPricing({
                                                      ...editingPricing,
                                                      [company.id]: { ...editing, monthly: parseFloat(e.target.value) || 0 }
                                                    })}
                                                    style={{ width: '100%', padding: '4px 6px', border: '1px solid #cbd5e1', borderRadius: '4px', fontSize: '11px' }}
                                                  />
                                                </div>
                                                <div>
                                                  <label style={{ fontSize: '10px', color: '#64748b', display: 'block', marginBottom: '2px' }}>Quarterly ($)</label>
                                                  <input
                                                    type="number"
                                                    value={editing.quarterly}
                                                    onChange={(e) => setEditingPricing({
                                                      ...editingPricing,
                                                      [company.id]: { ...editing, quarterly: parseFloat(e.target.value) || 0 }
                                                    })}
                                                    style={{ width: '100%', padding: '4px 6px', border: '1px solid #cbd5e1', borderRadius: '4px', fontSize: '11px' }}
                                                  />
                                                </div>
                                                <div>
                                                  <label style={{ fontSize: '10px', color: '#64748b', display: 'block', marginBottom: '2px' }}>Annual ($)</label>
                                                  <input
                                                    type="number"
                                                    value={editing.annual}
                                                    onChange={(e) => setEditingPricing({
                                                      ...editingPricing,
                                                      [company.id]: { ...editing, annual: parseFloat(e.target.value) || 0 }
                                                    })}
                                                    style={{ width: '100%', padding: '4px 6px', border: '1px solid #cbd5e1', borderRadius: '4px', fontSize: '11px' }}
                                                  />
                                                </div>
                                                <div style={{ display: 'flex', gap: '6px', gridColumn: 'span 3' }}>
                                                  <button
                                                    onClick={() => {
                                                      updateCompanyPricing(company.id, editing);
                                                    }}
                                                    style={{ padding: '4px 10px', background: '#10b981', color: 'white', border: 'none', borderRadius: '4px', fontSize: '10px', fontWeight: '600', cursor: 'pointer' }}
                                                  >
                                                    Save
                                                  </button>
                                                  <button
                                                    onClick={() => {
                                                      setEditingPricing((prev) => {
                                                        const newState = { ...prev };
                                                        delete newState[company.id];
                                                        return newState;
                                                      });
                                                    }}
                                                    style={{ padding: '4px 10px', background: '#94a3b8', color: 'white', border: 'none', borderRadius: '4px', fontSize: '10px', fontWeight: '600', cursor: 'pointer' }}
                                                  >
                                                    Cancel
                                                  </button>
                                                </div>
                                              </div>
                                            ) : (
                                              <div>
                                                <div style={{ fontSize: '10px', color: '#64748b', lineHeight: '1.5', marginBottom: '6px' }}>
                                                  <div><strong>Monthly:</strong> ${company.subscriptionMonthlyPrice?.toFixed(2) || '195.00'}</div>
                                                  <div><strong>Quarterly:</strong> ${company.subscriptionQuarterlyPrice?.toFixed(2) || '500.00'}</div>
                                                  <div><strong>Annual:</strong> ${company.subscriptionAnnualPrice?.toFixed(2) || '1750.00'}</div>
                                                </div>
                                                <button
                                                  onClick={() => {
                                                    setEditingPricing({
                                                      ...editingPricing,
                                                      [company.id]: {
                                                        monthly: company.subscriptionMonthlyPrice || 195,
                                                        quarterly: company.subscriptionQuarterlyPrice || 500,
                                                        annual: company.subscriptionAnnualPrice || 1750
                                                      }
                                                    });
                                                  }}
                                                  style={{ padding: '4px 10px', background: '#667eea', color: 'white', border: 'none', borderRadius: '4px', fontSize: '10px', fontWeight: '600', cursor: 'pointer' }}
                                                >
                                                  Edit Pricing
                                                </button>
                                              </div>
                                            )}
                                          </div>

                                          {/* Users */}
                                          {companyUsers.length > 0 && (
                                            <div>
                                              <h6 style={{ fontSize: '11px', fontWeight: '600', color: '#64748b', marginBottom: '4px' }}>Users:</h6>
                                              <div style={{ display: 'grid', gap: '4px' }}>
                                                {companyUsers.map((user) => (
                                                  <div key={user.id} style={{ background: 'white', borderRadius: '4px', padding: '6px 8px', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                                    <div>
                                                      <div style={{ fontSize: '11px', fontWeight: '600', color: '#1e293b' }}>{user.name}</div>
                                                      <div style={{ fontSize: '10px', color: '#64748b' }}>{user.email}</div>
                                                    </div>
                                                  </div>
                                                ))}
                                              </div>
                                            </div>
                                          )}
                                        </div>
                                      )}
                                    </div>
                                  );
                                })}
                              </div>
                            )}
                          </div>
                        )}
                      </div>
                    );
                  })}
                </div>
              )}
              </>
              )}

              {/* Businesses Tab */}
              {siteAdminTab === 'businesses' && (
                <div>
                  {/* Businesses List */}
                  <div style={{ fontSize: '14px', fontWeight: '600', color: '#64748b', marginBottom: '10px' }}>
                    Total Businesses: {consultants.filter(c => c.type === 'business').length}
                  </div>

                  {consultants.filter(c => c.type === 'business').length === 0 ? (
                    <div style={{ background: 'white', borderRadius: '8px', padding: '40px', textAlign: 'center', boxShadow: '0 1px 3px rgba(0,0,0,0.08)' }}>
                      <div style={{ fontSize: '36px', marginBottom: '12px' }}>🏢</div>
                      <h3 style={{ fontSize: '16px', fontWeight: '600', color: '#64748b', marginBottom: '6px' }}>No businesses registered yet</h3>
                      <p style={{ fontSize: '13px', color: '#94a3b8' }}>Businesses will appear here once they register</p>
                    </div>
                  ) : (
                    <div style={{ display: 'grid', gap: '12px' }}>
                      {consultants.filter(c => c.type === 'business').map((business) => {
                        const businessCompany = companies.find(comp => comp.consultantId === business.id);
                        const isExpanded = expandedBusinessIds.has(business.id);
                        const editing = editingPricing[business.id];
                        
                        return (
                          <div key={business.id} style={{ background: 'white', borderRadius: '8px', padding: '12px 16px', boxShadow: '0 1px 3px rgba(0,0,0,0.08)', border: '1px solid #e2e8f0' }}>
                            {/* Business Header */}
                            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                              <div style={{ flex: 1 }}>
                                <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
                                  <h3 
                                    onClick={() => {
                                      // Save current admin user
                                      setSiteAdminViewingAs(currentUser);
                                      // Switch to viewing this business's dashboard
                                      setCurrentUser({
                                        ...business.user,
                                        role: 'consultant',
                                        consultantId: business.id,
                                        consultantType: business.type
                                      });
                                      setCurrentView('admin');
                                    }}
                                    style={{ 
                                      fontSize: '15px', 
                                      fontWeight: '600', 
                                      color: '#667eea', 
                                      margin: 0,
                                      cursor: 'pointer',
                                      textDecoration: 'underline'
                                    }}
                                    onMouseEnter={(e) => e.currentTarget.style.color = '#5568d3'}
                                    onMouseLeave={(e) => e.currentTarget.style.color = '#667eea'}
                                  >
                                    {business.fullName}
                                  </h3>
                                </div>
                              </div>
                              <button
                                onClick={() => {
                                  setExpandedBusinessIds(prev => {
                                    const newSet = new Set(prev);
                                    if (newSet.has(business.id)) {
                                      newSet.delete(business.id);
                                    } else {
                                      newSet.add(business.id);
                                    }
                                    return newSet;
                                  });
                                }}
                                style={{ padding: '6px 12px', background: '#667eea', color: 'white', border: 'none', borderRadius: '6px', fontSize: '12px', fontWeight: '600', cursor: 'pointer' }}
                              >
                                {isExpanded ? 'Collapse' : 'Expand'}
                              </button>
                            </div>

                            {/* Expanded Details */}
                            {isExpanded && (
                              <div style={{ borderTop: '1px solid #e2e8f0', marginTop: '10px', paddingTop: '10px' }}>

                                {/* Business Information */}
                                <div style={{ marginBottom: '8px', padding: '8px', background: '#f8fafc', borderRadius: '6px' }}>
                                  <h4 style={{ fontSize: '11px', fontWeight: '600', color: '#475569', marginBottom: '4px' }}>Business Information</h4>
                                  <div style={{ fontSize: '10px', color: '#64748b', lineHeight: '1.5' }}>
                                    <div><strong>Type:</strong> {business.type}</div>
                                    <div><strong>Email:</strong> {business.user?.email}</div>
                                    <div><strong>Phone:</strong> {business.phone || 'Not provided'}</div>
                                    <div><strong>Address:</strong> {
                                      businessCompany && (businessCompany.addressStreet || businessCompany.addressCity) ? (
                                        <>
                                          {businessCompany.addressStreet && <>{businessCompany.addressStreet}<br /></>}
                                          {businessCompany.addressCity && businessCompany.addressCity}
                                          {businessCompany.addressState && `, ${businessCompany.addressState}`}
                                          {businessCompany.addressZip && ` ${businessCompany.addressZip}`}
                                          {businessCompany.addressCountry && <><br />{businessCompany.addressCountry}</>}
                                        </>
                                      ) : 'Not provided'
                                    }</div>
                                  </div>
                                </div>

                                {/* Company Details */}
                                {businessCompany && (
                                  <div style={{ marginBottom: '8px', padding: '8px', background: '#f0f9ff', borderRadius: '6px' }}>
                                    <h4 style={{ fontSize: '11px', fontWeight: '600', color: '#475569', marginBottom: '4px' }}>Company Details</h4>
                                    <div style={{ fontSize: '10px', color: '#64748b', lineHeight: '1.5' }}>
                                      <div><strong>Company Name:</strong> {businessCompany.name}</div>
                                      <div><strong>Industry:</strong> {businessCompany.industrySector || 'Not set'}</div>
                                    </div>
                                  </div>
                                )}

                                {/* Subscription Pricing */}
                                <div style={{ padding: '8px', background: '#fef3c7', borderRadius: '6px' }}>
                                  <h4 style={{ fontSize: '11px', fontWeight: '600', color: '#475569', marginBottom: '6px' }}>Subscription Pricing</h4>
                                  {editing ? (
                                    <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '6px' }}>
                                      <div>
                                        <label style={{ fontSize: '10px', color: '#64748b', display: 'block', marginBottom: '2px' }}>Monthly ($)</label>
                                        <input
                                          type="number"
                                          value={editing.monthly}
                                          onChange={(e) => setEditingPricing({
                                            ...editingPricing,
                                            [business.id]: { ...editing, monthly: parseFloat(e.target.value) || 0 }
                                          })}
                                          style={{ width: '100%', padding: '4px 6px', border: '1px solid #cbd5e1', borderRadius: '4px', fontSize: '11px' }}
                                        />
                                      </div>
                                      <div>
                                        <label style={{ fontSize: '10px', color: '#64748b', display: 'block', marginBottom: '2px' }}>Quarterly ($)</label>
                                        <input
                                          type="number"
                                          value={editing.quarterly}
                                          onChange={(e) => setEditingPricing({
                                            ...editingPricing,
                                            [business.id]: { ...editing, quarterly: parseFloat(e.target.value) || 0 }
                                          })}
                                          style={{ width: '100%', padding: '4px 6px', border: '1px solid #cbd5e1', borderRadius: '4px', fontSize: '11px' }}
                                        />
                                      </div>
                                      <div>
                                        <label style={{ fontSize: '10px', color: '#64748b', display: 'block', marginBottom: '2px' }}>Annual ($)</label>
                                        <input
                                          type="number"
                                          value={editing.annual}
                                          onChange={(e) => setEditingPricing({
                                            ...editingPricing,
                                            [business.id]: { ...editing, annual: parseFloat(e.target.value) || 0 }
                                          })}
                                          style={{ width: '100%', padding: '4px 6px', border: '1px solid #cbd5e1', borderRadius: '4px', fontSize: '11px' }}
                                        />
                                      </div>
                                      <button
                                        onClick={() => {
                                          if (businessCompany) {
                                            updateCompanyPricing(businessCompany.id, editing);
                                          }
                                        }}
                                        style={{ padding: '4px 10px', background: '#10b981', color: 'white', border: 'none', borderRadius: '4px', fontSize: '10px', fontWeight: '600', cursor: 'pointer' }}
                                      >
                                        Save
                                      </button>
                                      <button
                                        onClick={() => {
                                          setEditingPricing((prev) => {
                                            const newState = { ...prev };
                                            delete newState[business.id];
                                            return newState;
                                          });
                                        }}
                                        style={{ padding: '4px 10px', background: '#94a3b8', color: 'white', border: 'none', borderRadius: '4px', fontSize: '10px', fontWeight: '600', cursor: 'pointer' }}
                                      >
                                        Cancel
                                      </button>
                                    </div>
                                  ) : (
                                    <div>
                                      <div style={{ fontSize: '10px', color: '#64748b', lineHeight: '1.5', marginBottom: '6px' }}>
                                        <div><strong>Monthly:</strong> ${businessCompany?.subscriptionMonthlyPrice?.toFixed(2) || '195.00'}</div>
                                        <div><strong>Quarterly:</strong> ${businessCompany?.subscriptionQuarterlyPrice?.toFixed(2) || '500.00'}</div>
                                        <div><strong>Annual:</strong> ${businessCompany?.subscriptionAnnualPrice?.toFixed(2) || '1750.00'}</div>
                                      </div>
                                      <button
                                        onClick={() => {
                                          setEditingPricing({
                                            ...editingPricing,
                                            [business.id]: {
                                              monthly: businessCompany?.subscriptionMonthlyPrice || 195,
                                              quarterly: businessCompany?.subscriptionQuarterlyPrice || 500,
                                              annual: businessCompany?.subscriptionAnnualPrice || 1750
                                            }
                                          });
                                        }}
                                        style={{ padding: '4px 10px', background: '#667eea', color: 'white', border: 'none', borderRadius: '4px', fontSize: '10px', fontWeight: '600', cursor: 'pointer' }}
                                      >
                                        Edit Pricing
                                      </button>
                                    </div>
                                  )}
                                </div>
                              </div>
                            )}
                          </div>
                        );
                      })}
                    </div>
                  )}
                </div>
              )}
            </div>
          )}

          {/* Admin Dashboard */}
          {currentView === 'admin' && currentUser?.role === 'consultant' && (
        <div style={{ maxWidth: '1400px', margin: '0 auto', padding: '32px' }}>
          <div className="dashboard-header-print-hide" style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '32px' }}>
            <h1 style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b', margin: 0 }}>
              {currentUser.consultantType === 'business' ? 'Business Dashboard' : 'Consultant Dashboard'}
            </h1>
            {siteAdminViewingAs && (
              <button
                onClick={() => {
                  // Restore admin user
                  setCurrentUser(siteAdminViewingAs);
                  setSiteAdminViewingAs(null);
                  setCurrentView('siteadmin');
                }}
                style={{ 
                  padding: '10px 20px', 
                  background: '#f59e0b', 
                  color: 'white', 
                  border: 'none', 
                  borderRadius: '8px', 
                  fontSize: '14px', 
                  fontWeight: '600', 
                  cursor: 'pointer',
                  display: 'flex',
                  alignItems: 'center',
                  gap: '8px'
                }}
              >
                ← Back to Site Admin
              </button>
            )}
          </div>
          
          {/* Tab Navigation */}
          <div className="dashboard-tabs-print-hide" style={{ display: 'flex', gap: '8px', marginBottom: '12px', borderBottom: '2px solid #e2e8f0' }}>
            <button
              onClick={() => setAdminDashboardTab('company-management')}
              style={{
                padding: '12px 24px',
                background: adminDashboardTab === 'company-management' ? '#667eea' : 'transparent',
                color: adminDashboardTab === 'company-management' ? 'white' : '#64748b',
                border: 'none',
                borderBottom: adminDashboardTab === 'company-management' ? '3px solid #667eea' : '3px solid transparent',
                fontSize: '16px',
                fontWeight: '600',
                cursor: 'pointer',
                borderRadius: '8px 8px 0 0',
                transition: 'all 0.2s'
              }}
            >
              Company Management
            </button>
            <button
              onClick={() => setAdminDashboardTab('payments')}
              style={{
                padding: '12px 24px',
                background: adminDashboardTab === 'payments' ? '#667eea' : 'transparent',
                color: adminDashboardTab === 'payments' ? 'white' : '#64748b',
                border: 'none',
                borderBottom: adminDashboardTab === 'payments' ? '3px solid #667eea' : '3px solid transparent',
                fontSize: '16px',
                fontWeight: '600',
                cursor: 'pointer',
                borderRadius: '8px 8px 0 0',
                transition: 'all 0.2s'
              }}
            >
              Billing
            </button>
            <button
              onClick={() => setAdminDashboardTab('import-financials')}
              style={{
                padding: '12px 24px',
                background: adminDashboardTab === 'import-financials' ? '#667eea' : 'transparent',
                color: adminDashboardTab === 'import-financials' ? 'white' : '#64748b',
                border: 'none',
                borderBottom: adminDashboardTab === 'import-financials' ? '3px solid #667eea' : '3px solid transparent',
                fontSize: '16px',
                fontWeight: '600',
                cursor: 'pointer',
                borderRadius: '8px 8px 0 0',
                transition: 'all 0.2s'
              }}
            >
              Import Financials
            </button>
            <button
              onClick={() => setAdminDashboardTab('api-connections')}
              style={{
                padding: '12px 24px',
                background: adminDashboardTab === 'api-connections' ? '#667eea' : 'transparent',
                color: adminDashboardTab === 'api-connections' ? 'white' : '#64748b',
                border: 'none',
                borderBottom: adminDashboardTab === 'api-connections' ? '3px solid #667eea' : '3px solid transparent',
                fontSize: '16px',
                fontWeight: '600',
                cursor: 'pointer',
                borderRadius: '8px 8px 0 0',
                transition: 'all 0.2s'
              }}
            >
              Accounting API Connections
            </button>
            <button
              onClick={() => setAdminDashboardTab('data-review')}
              style={{
                padding: '12px 24px',
                background: adminDashboardTab === 'data-review' ? '#667eea' : 'transparent',
                color: adminDashboardTab === 'data-review' ? 'white' : '#64748b',
                border: 'none',
                borderBottom: adminDashboardTab === 'data-review' ? '3px solid #667eea' : '3px solid transparent',
                fontSize: '16px',
                fontWeight: '600',
                cursor: 'pointer',
                borderRadius: '8px 8px 0 0',
                transition: 'all 0.2s'
              }}
            >
              Data Review
            </button>
            <button
              onClick={() => setAdminDashboardTab('data-mapping')}
              style={{
                padding: '12px 24px',
                background: adminDashboardTab === 'data-mapping' ? '#667eea' : 'transparent',
                color: adminDashboardTab === 'data-mapping' ? 'white' : '#64748b',
                border: 'none',
                borderBottom: adminDashboardTab === 'data-mapping' ? '3px solid #667eea' : '3px solid transparent',
                fontSize: '16px',
                fontWeight: '600',
                cursor: 'pointer',
                borderRadius: '8px 8px 0 0',
                transition: 'all 0.2s'
              }}
            >
              Data Mapping
            </button>
          </div>
          
          {/* Company Management Tab */}
          {adminDashboardTab === 'company-management' && (
          <div style={{ background: 'white', borderRadius: '12px', padding: '24px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
            {/* Sub-Tab Navigation */}
            <div style={{ display: 'flex', gap: '8px', marginBottom: '24px', borderBottom: '2px solid #e2e8f0' }}>
              <button
                onClick={() => setCompanyManagementSubTab('company-management')}
                style={{
                  padding: '12px 24px',
                  background: companyManagementSubTab === 'company-management' ? '#667eea' : 'transparent',
                  color: companyManagementSubTab === 'company-management' ? 'white' : '#64748b',
                  border: 'none',
                  borderBottom: companyManagementSubTab === 'company-management' ? '3px solid #667eea' : '3px solid transparent',
                  fontSize: '14px',
                  fontWeight: '600',
                  cursor: 'pointer',
                  borderRadius: '8px 8px 0 0',
                  transition: 'all 0.2s'
                }}
              >
                Company Management
              </button>
              <button
                onClick={() => setCompanyManagementSubTab('billing')}
                style={{
                  padding: '12px 24px',
                  background: companyManagementSubTab === 'billing' ? '#667eea' : 'transparent',
                  color: companyManagementSubTab === 'billing' ? 'white' : '#64748b',
                  border: 'none',
                  borderBottom: companyManagementSubTab === 'billing' ? '3px solid #667eea' : '3px solid transparent',
                  fontSize: '14px',
                  fontWeight: '600',
                  cursor: 'pointer',
                  borderRadius: '8px 8px 0 0',
                  transition: 'all 0.2s'
                }}
              >
                Billing
              </button>
              <button
                onClick={() => setCompanyManagementSubTab('profile')}
                style={{
                  padding: '12px 24px',
                  background: companyManagementSubTab === 'profile' ? '#667eea' : 'transparent',
                  color: companyManagementSubTab === 'profile' ? 'white' : '#64748b',
                  border: 'none',
                  borderBottom: companyManagementSubTab === 'profile' ? '3px solid #667eea' : '3px solid transparent',
                  fontSize: '14px',
                  fontWeight: '600',
                  cursor: 'pointer',
                  borderRadius: '8px 8px 0 0',
                  transition: 'all 0.2s'
                }}
              >
                Profile
              </button>
            </div>

            {/* Company Management Sub-Tab Content */}
            {companyManagementSubTab === 'company-management' && (
              <>
                {/* Show selected company or add new company option */}
                {(() => {
              // For business users, auto-select their company if not already selected
              if (currentUser.consultantType === 'business' && !selectedCompanyId && companies.length > 0) {
                const businessCompany = companies.find(c => c.consultantId === currentUser.consultantId);
                if (businessCompany) {
                  setTimeout(() => setSelectedCompanyId(businessCompany.id), 0);
                }
              }
              
              return !selectedCompanyId ? (
                <>
                  {/* Only show Add Company for regular consultants */}
                  {currentUser.consultantType !== 'business' && (
                    <>
                      <p style={{ fontSize: '14px', color: '#64748b', marginBottom: '16px' }}>
                        Select a company from the sidebar or create a new one:
                      </p>
                      <div style={{ display: 'flex', gap: '12px', marginBottom: '12px' }}>
                        <input 
                          type="text" 
                          placeholder="Company Name" 
                          value={newCompanyName} 
                          onChange={(e) => setNewCompanyName(e.target.value)} 
                          onKeyDown={(e) => e.key === 'Enter' && !isLoading && addCompany()}
                          disabled={isLoading}
                          style={{ flex: 1, padding: '12px 16px', borderRadius: '8px', border: '1px solid #cbd5e1', fontSize: '14px' }} 
                        />
                        <button 
                          onClick={addCompany} 
                          disabled={isLoading}
                          style={{ 
                            padding: '12px 24px', 
                            background: isLoading ? '#94a3b8' : '#667eea', 
                            color: 'white', 
                            border: 'none', 
                            borderRadius: '8px', 
                            fontSize: '14px', 
                            fontWeight: '600', 
                            cursor: isLoading ? 'not-allowed' : 'pointer',
                            opacity: isLoading ? 0.7 : 1 
                          }}
                        >
                          {isLoading ? 'Adding...' : 'Add Company'}
                        </button>
                      </div>
                    </>
                  )}
                  {/* For business users with no company selected, show loading message */}
                  {currentUser.consultantType === 'business' && (
                    <div style={{ textAlign: 'center', padding: '40px', color: '#64748b' }}>
                      <p>Loading your company information...</p>
                    </div>
                  )}
                </>
              ) : (
              <>
                {/* Only show the selected company - always expanded */}
                {companies.filter(c => c.id === selectedCompanyId).map(comp => (
                <div key={comp.id} style={{ background: '#f8fafc', borderRadius: '8px', padding: '24px', border: '2px solid #667eea' }}>
                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '16px' }}>
                    <div>
                      <h3 style={{ fontSize: '20px', fontWeight: '600', color: '#1e293b', marginBottom: '4px' }}>{comp.name}</h3>
                      <div style={{ fontSize: '13px', color: '#10b981', fontWeight: '600' }}>✓ Active Company</div>
                    </div>
                    {/* Only show Delete button for regular consultants, not business users */}
                    {currentUser.consultantType !== 'business' && (
                      <button onClick={() => deleteCompany(comp.id)} style={{ padding: '8px 16px', background: '#ef4444', color: 'white', border: 'none', borderRadius: '6px', fontSize: '13px', cursor: 'pointer', fontWeight: '600' }}>Delete Company</button>
                    )}
                  </div>
                  
                  {/* Company Information */}
                  <div style={{ marginBottom: '16px' }}>
                    <div style={{ background: 'white', borderRadius: '6px', padding: '12px', border: '1px solid #cbd5e1', display: 'flex', justifyContent: 'space-between', alignItems: 'start' }}>
                      <div style={{ flex: 1 }}>
                        <div style={{ fontSize: '13px', color: '#64748b', marginBottom: '6px' }}>
                          <span style={{ fontWeight: '600', display: 'block', marginBottom: '4px' }}>Address:</span>
                          {comp.addressStreet || comp.addressCity ? (
                            <>
                              {comp.addressStreet && <div style={{ color: '#1e293b', marginBottom: '2px' }}>{comp.addressStreet}</div>}
                              <div style={{ color: '#1e293b' }}>
                                {comp.addressCity && comp.addressCity}
                                {comp.addressState && `, ${comp.addressState}`}
                                {comp.addressZip && ` ${comp.addressZip}`}
                              </div>
                              {comp.addressCountry && <div style={{ color: '#1e293b' }}>{comp.addressCountry}</div>}
                            </>
                          ) : (
                            <span style={{ color: '#94a3b8', fontStyle: 'italic' }}>Not set</span>
                          )}
                        </div>
                        <div style={{ fontSize: '13px', color: '#64748b' }}>
                          <span style={{ fontWeight: '600' }}>Industry:</span> <span style={{ color: '#1e293b' }}>
                            {comp.industrySector 
                              ? `${comp.industrySector} - ${INDUSTRY_SECTORS.find(s => s.id === comp.industrySector)?.name || 'Unknown'}` 
                              : 'Not set'}
                          </span>
                        </div>
                      </div>
                      <button 
                        onClick={() => {
                          setEditingCompanyId(comp.id);
                          setCompanyAddressStreet(comp.addressStreet || '');
                          setCompanyAddressCity(comp.addressCity || '');
                          setCompanyAddressState(comp.addressState || '');
                          setCompanyAddressZip(comp.addressZip || '');
                          setCompanyAddressCountry(comp.addressCountry || 'USA');
                          setCompanyIndustrySector(comp.industrySector || '');
                          setShowCompanyDetailsModal(true);
                        }}
                        style={{ padding: '6px 12px', background: '#667eea', color: 'white', border: 'none', borderRadius: '6px', fontSize: '12px', cursor: 'pointer', fontWeight: '600', whiteSpace: 'nowrap' }}
                      >
                        Edit Details
                      </button>
                    </div>
                  </div>
                  
                  {/* Users Section - Side by Side */}
                  <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px', borderTop: '2px solid #cbd5e1', paddingTop: '16px' }}>
                    
                    {/* Company Users (Management Team) */}
                    <div style={{ background: 'white', borderRadius: '8px', padding: '16px', border: '2px solid #10b981' }}>
                      <h4 style={{ fontSize: '16px', fontWeight: '600', color: '#475569', marginBottom: '4px' }}>Company Users</h4>
                      <p style={{ fontSize: '11px', color: '#64748b', marginBottom: '12px' }}>Management team - can view all company pages</p>
                      <div style={{ fontSize: '20px', fontWeight: '700', color: '#10b981', marginBottom: '12px' }}>
                        {users.filter(u => u.companyId === comp.id && u.userType === 'company').length}
                      </div>
                      
                      {users.filter(u => u.companyId === comp.id && u.userType === 'company').map(u => (
                        <div key={u.id} style={{ background: '#f0fdf4', borderRadius: '8px', padding: '12px', marginBottom: '8px', border: '1px solid #86efac' }}>
                          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'start' }}>
                            <div style={{ flex: 1 }}>
                              <div style={{ fontSize: '14px', fontWeight: '600', color: '#1e293b', marginBottom: '6px', display: 'flex', alignItems: 'center', gap: '8px', flexWrap: 'wrap' }}>
                                <span>{u.name}</span>
                                {u.title && <span style={{ fontSize: '12px', fontWeight: '500', color: '#059669', background: '#d1fae5', padding: '2px 8px', borderRadius: '4px' }}>{u.title}</span>}
                              </div>
                              <div style={{ fontSize: '12px', color: '#64748b', display: 'flex', alignItems: 'center', gap: '12px', flexWrap: 'wrap' }}>
                                <div><span style={{ fontWeight: '600' }}>Email:</span> {u.email}</div>
                                {u.phone && <div><span style={{ fontWeight: '600' }}>Phone:</span> {u.phone}</div>}
                              </div>
                            </div>
                            <button onClick={() => deleteUser(u.id)} style={{ padding: '4px 8px', background: '#ef4444', color: 'white', border: 'none', borderRadius: '4px', fontSize: '10px', cursor: 'pointer', fontWeight: '600' }}>Delete</button>
                          </div>
                        </div>
                      ))}
                      
                      <div style={{ borderTop: '1px solid #d1fae5', paddingTop: '12px', marginTop: '12px' }}>
                        <h5 style={{ fontSize: '13px', fontWeight: '600', color: '#475569', marginBottom: '8px' }}>Add Company User</h5>
                        <div style={{ display: 'flex', flexDirection: 'column', gap: '6px' }}>
                          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '6px' }}>
                            <input 
                              type="text" 
                              name={`company_user_name_${Date.now()}`}
                              placeholder="Name" 
                              value={newCompanyUserName} 
                              onChange={(e) => setNewCompanyUserName(e.target.value)} 
                              autoComplete="off"
                              style={{ padding: '8px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '12px' }} 
                            />
                            <input 
                              type="text" 
                              name={`company_user_title_${Date.now()}`}
                              placeholder="Title" 
                              value={newCompanyUserTitle} 
                              onChange={(e) => setNewCompanyUserTitle(e.target.value)} 
                              autoComplete="off"
                              style={{ padding: '8px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '12px' }} 
                            />
                          </div>
                          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '6px' }}>
                            <input 
                              type="text" 
                              name={`company_user_email_${Date.now()}`}
                              placeholder="Email" 
                              value={newCompanyUserEmail} 
                              onChange={(e) => setNewCompanyUserEmail(e.target.value)} 
                              autoComplete="off"
                              style={{ padding: '8px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '12px' }} 
                            />
                            <input 
                              type="text" 
                              name={`company_user_phone_${Date.now()}`}
                              placeholder="Phone Number" 
                              value={newCompanyUserPhone} 
                              onChange={(e) => setNewCompanyUserPhone(e.target.value)} 
                              autoComplete="off"
                              style={{ padding: '8px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '12px' }} 
                            />
                          </div>
                          <input 
                            type="password" 
                            name={`company_user_password_${Date.now()}`}
                            placeholder="Password" 
                            value={newCompanyUserPassword} 
                            onChange={(e) => setNewCompanyUserPassword(e.target.value)} 
                            autoComplete="new-password"
                            style={{ padding: '8px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '12px' }} 
                          />
                          <button onClick={() => addUser(comp.id, 'company')} style={{ padding: '8px', background: '#10b981', color: 'white', border: 'none', borderRadius: '6px', fontSize: '12px', fontWeight: '600', cursor: 'pointer' }}>Add Company User</button>
                        </div>
                      </div>
                    </div>
                    
                    {/* Assessment Users */}
                    <div style={{ background: 'white', borderRadius: '8px', padding: '16px', border: '2px solid #8b5cf6' }}>
                      <h4 style={{ fontSize: '16px', fontWeight: '600', color: '#475569', marginBottom: '4px' }}>Assessment Users</h4>
                      <p style={{ fontSize: '11px', color: '#64748b', marginBottom: '12px' }}>Fill out Management Assessment (max 5)</p>
                      <div style={{ fontSize: '20px', fontWeight: '700', color: '#8b5cf6', marginBottom: '12px' }}>
                        {users.filter(u => u.companyId === comp.id && u.userType === 'assessment').length} / 5
                      </div>
                      
                      {users.filter(u => u.companyId === comp.id && u.userType === 'assessment').map(u => {
                        const hasCompleted = assessmentRecords.some(r => r.user?.email === u.email && r.companyId === comp.id);
                        console.log(`🔍 Checking user: ${u.email}, Company: ${comp.id}, Assessment Records for this user:`, 
                          assessmentRecords.filter(r => r.user?.email === u.email).map(r => ({ userEmail: r.user?.email, companyId: r.companyId })),
                          'hasCompleted:', hasCompleted
                        );
                        return (
                          <div key={u.id} style={{ background: '#faf5ff', borderRadius: '6px', padding: '8px 12px', marginBottom: '6px', display: 'flex', justifyContent: 'space-between', alignItems: 'center', border: '1px solid #ddd6fe' }}>
                            <div style={{ flex: 1 }}>
                              <div style={{ fontSize: '13px', fontWeight: '600', color: '#1e293b' }}>
                                {u.name}
                                {u.title && <span style={{ fontSize: '11px', fontWeight: '500', color: '#64748b', marginLeft: '6px' }}>({u.title})</span>}
                              </div>
                              <div style={{ fontSize: '11px', color: '#64748b' }}>{u.email}</div>
                            </div>
                            <div style={{ display: 'flex', gap: '6px', alignItems: 'center' }}>
                              <div style={{ 
                                fontSize: '10px', 
                                fontWeight: '600', 
                                color: hasCompleted ? '#065f46' : '#991b1b',
                                background: hasCompleted ? '#d1fae5' : '#fee2e2',
                                padding: '3px 8px', 
                                borderRadius: '4px' 
                              }}>
                                {hasCompleted ? '✓ Done' : '⚠ Not Started'}
                              </div>
                              <button onClick={() => deleteUser(u.id)} style={{ padding: '4px 8px', background: '#ef4444', color: 'white', border: 'none', borderRadius: '4px', fontSize: '10px', cursor: 'pointer' }}>✕</button>
                            </div>
                          </div>
                        );
                      })}
                      
                      {users.filter(u => u.companyId === comp.id && u.userType === 'assessment').length < 5 ? (
                        <div style={{ borderTop: '1px solid #ede9fe', paddingTop: '12px', marginTop: '12px' }}>
                          <h5 style={{ fontSize: '13px', fontWeight: '600', color: '#475569', marginBottom: '8px' }}>Add Assessment User</h5>
                          <div style={{ display: 'flex', flexDirection: 'column', gap: '6px' }}>
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '6px' }}>
                              <input 
                                type="text" 
                                name={`assessment_user_name_${Date.now()}`}
                                placeholder="Name" 
                                value={newAssessmentUserName} 
                                onChange={(e) => setNewAssessmentUserName(e.target.value)} 
                                autoComplete="off"
                                style={{ padding: '8px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '12px' }} 
                              />
                              <input 
                                type="text" 
                                name={`assessment_user_title_${Date.now()}`}
                                placeholder="Title" 
                                value={newAssessmentUserTitle} 
                                onChange={(e) => setNewAssessmentUserTitle(e.target.value)} 
                                autoComplete="off"
                                style={{ padding: '8px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '12px' }} 
                              />
                            </div>
                            <input 
                              type="text" 
                              name={`assessment_user_email_${Date.now()}`}
                              placeholder="Email" 
                              value={newAssessmentUserEmail} 
                              onChange={(e) => setNewAssessmentUserEmail(e.target.value)} 
                              autoComplete="off"
                              style={{ padding: '8px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '12px' }} 
                            />
                            <input 
                              type="password" 
                              name={`assessment_user_password_${Date.now()}`}
                              placeholder="Password" 
                              value={newAssessmentUserPassword} 
                              onChange={(e) => setNewAssessmentUserPassword(e.target.value)} 
                              autoComplete="new-password"
                              style={{ padding: '8px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '12px' }} 
                            />
                            <button onClick={() => addUser(comp.id, 'assessment')} style={{ padding: '8px', background: '#8b5cf6', color: 'white', border: 'none', borderRadius: '6px', fontSize: '12px', fontWeight: '600', cursor: 'pointer' }}>Add Assessment User</button>
                          </div>
                        </div>
                      ) : (
                        <div style={{ padding: '8px', background: '#fef3c7', border: '1px solid #fbbf24', borderRadius: '6px', fontSize: '11px', color: '#92400e', marginTop: '8px' }}>
                          ⚠ Maximum 5 assessment users reached
                        </div>
                      )}
                    </div>
                  </div>
                </div>
              ))}
              </>
              );
            })()}
          </div>
          )}
          
          {/* Import Financials Tab */}
          {adminDashboardTab === 'import-financials' && selectedCompanyId && (
            <>
              {/* QuickBooks Data Verification Section */}
              {loadedMonthlyData && loadedMonthlyData.length > 0 && qbRawData && (
                <div style={{ background: 'white', borderRadius: '12px', padding: '24px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', border: '2px solid #10b981' }}>
                  <h2 style={{ fontSize: '20px', fontWeight: '600', color: '#1e293b', marginBottom: '8px' }}>✓ QuickBooks Data Verification</h2>
                  <p style={{ fontSize: '14px', color: '#64748b', marginBottom: '12px' }}>
                    Imported from QuickBooks • {loadedMonthlyData.length} months of data verified
                  </p>

                  {/* Summary Stats */}
                  <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '16px', marginBottom: '12px' }}>
                    <div style={{ background: '#f0fdf4', borderRadius: '8px', padding: '16px', border: '1px solid #86efac' }}>
                      <div style={{ fontSize: '12px', fontWeight: '600', color: '#065f46', marginBottom: '4px' }}>MONTHS IMPORTED</div>
                      <div style={{ fontSize: '28px', fontWeight: '700', color: '#10b981' }}>{loadedMonthlyData.length}</div>
                    </div>
                    <div style={{ background: '#ede9fe', borderRadius: '8px', padding: '16px', border: '1px solid #c4b5fd' }}>
                      <div style={{ fontSize: '12px', fontWeight: '600', color: '#5b21b6', marginBottom: '4px' }}>DATE RANGE</div>
                      <div style={{ fontSize: '14px', fontWeight: '600', color: '#7c3aed' }}>
                        {new Date(loadedMonthlyData[0].date).toLocaleDateString('en-US', { month: 'short', year: 'numeric' })} - {new Date(loadedMonthlyData[loadedMonthlyData.length - 1].date).toLocaleDateString('en-US', { month: 'short', year: 'numeric' })}
                      </div>
                    </div>
                    <div style={{ background: '#dbeafe', borderRadius: '8px', padding: '16px', border: '1px solid #93c5fd' }}>
                      <div style={{ fontSize: '12px', fontWeight: '600', color: '#1e40af', marginBottom: '4px' }}>TOTAL REVENUE</div>
                      <div style={{ fontSize: '18px', fontWeight: '700', color: '#2563eb' }}>
                        ${(loadedMonthlyData.reduce((sum, m) => sum + (m.revenue || 0), 0) / 1000).toFixed(0)}K
                      </div>
                    </div>
                    <div style={{ background: '#fef3c7', borderRadius: '8px', padding: '16px', border: '1px solid #fcd34d' }}>
                      <div style={{ fontSize: '12px', fontWeight: '600', color: '#92400e', marginBottom: '4px' }}>TOTAL ASSETS</div>
                      <div style={{ fontSize: '18px', fontWeight: '700', color: '#d97706' }}>
                        ${(loadedMonthlyData[loadedMonthlyData.length - 1].totalAssets / 1000).toFixed(0)}K
                      </div>
                    </div>
                  </div>

                  {/* Sample Data Tables */}
                  <div style={{ marginBottom: '20px' }}>
                    <h3 style={{ fontSize: '16px', fontWeight: '600', color: '#1e293b', marginBottom: '12px' }}>Sample Income Statement Data (Last 6 Months)</h3>
                    <div style={{ overflowX: 'auto' }}>
                      <table style={{ width: '100%', fontSize: '13px', borderCollapse: 'collapse' }}>
                        <thead>
                          <tr style={{ background: '#f8fafc', borderBottom: '2px solid #e2e8f0' }}>
                            <th style={{ padding: '8px', textAlign: 'left', fontWeight: '600', color: '#475569' }}>Month</th>
                            <th style={{ padding: '8px', textAlign: 'right', fontWeight: '600', color: '#475569' }}>Revenue</th>
                            <th style={{ padding: '8px', textAlign: 'right', fontWeight: '600', color: '#475569' }}>Expense</th>
                            <th style={{ padding: '8px', textAlign: 'right', fontWeight: '600', color: '#475569' }}>COGS Total</th>
                            <th style={{ padding: '8px', textAlign: 'right', fontWeight: '600', color: '#475569' }}>Net Income</th>
                          </tr>
                        </thead>
                        <tbody>
                          {loadedMonthlyData.slice(-6).map((m, idx) => (
                            <tr key={idx} style={{ borderBottom: '1px solid #f1f5f9' }}>
                              <td style={{ padding: '8px', color: '#1e293b' }}>{new Date(m.date).toLocaleDateString('en-US', { month: 'short', year: 'numeric' })}</td>
                              <td style={{ padding: '8px', textAlign: 'right', color: '#10b981', fontWeight: '600' }}>${m.revenue.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</td>
                              <td style={{ padding: '8px', textAlign: 'right', color: '#ef4444', fontWeight: '600' }}>${m.expense.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</td>
                              <td style={{ padding: '8px', textAlign: 'right', color: '#f59e0b' }}>${m.cogsTotal.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</td>
                              <td style={{ padding: '8px', textAlign: 'right', color: (m.revenue - m.expense - m.cogsTotal) >= 0 ? '#10b981' : '#ef4444', fontWeight: '600' }}>
                                ${(m.revenue - m.expense - m.cogsTotal).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                              </td>
                            </tr>
                          ))}
                        </tbody>
                      </table>
                    </div>
                  </div>

                  <div style={{ marginBottom: '20px' }}>
                    <h3 style={{ fontSize: '16px', fontWeight: '600', color: '#1e293b', marginBottom: '12px' }}>Sample Balance Sheet Data (Last 6 Months)</h3>
                    <div style={{ overflowX: 'auto' }}>
                      <table style={{ width: '100%', fontSize: '13px', borderCollapse: 'collapse' }}>
                        <thead>
                          <tr style={{ background: '#f8fafc', borderBottom: '2px solid #e2e8f0' }}>
                            <th style={{ padding: '8px', textAlign: 'left', fontWeight: '600', color: '#475569' }}>Month</th>
                            <th style={{ padding: '8px', textAlign: 'right', fontWeight: '600', color: '#475569' }}>Cash</th>
                            <th style={{ padding: '8px', textAlign: 'right', fontWeight: '600', color: '#475569' }}>A/R</th>
                            <th style={{ padding: '8px', textAlign: 'right', fontWeight: '600', color: '#475569' }}>A/P</th>
                            <th style={{ padding: '8px', textAlign: 'right', fontWeight: '600', color: '#475569' }}>Total Assets</th>
                            <th style={{ padding: '8px', textAlign: 'right', fontWeight: '600', color: '#475569' }}>Total Equity</th>
                          </tr>
                        </thead>
                        <tbody>
                          {loadedMonthlyData.slice(-6).map((m, idx) => (
                            <tr key={idx} style={{ borderBottom: '1px solid #f1f5f9' }}>
                              <td style={{ padding: '8px', color: '#1e293b' }}>{new Date(m.date).toLocaleDateString('en-US', { month: 'short', year: 'numeric' })}</td>
                              <td style={{ padding: '8px', textAlign: 'right', color: '#10b981', fontWeight: '600' }}>${m.cash.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</td>
                              <td style={{ padding: '8px', textAlign: 'right', color: '#3b82f6' }}>${m.ar.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</td>
                              <td style={{ padding: '8px', textAlign: 'right', color: '#f59e0b' }}>${m.ap.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</td>
                              <td style={{ padding: '8px', textAlign: 'right', color: '#8b5cf6', fontWeight: '600' }}>${m.totalAssets.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</td>
                              <td style={{ padding: '8px', textAlign: 'right', color: '#ec4899', fontWeight: '600' }}>${m.totalEquity.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</td>
                            </tr>
                          ))}
                        </tbody>
                      </table>
                    </div>
                  </div>

                  <div style={{ background: '#f0fdf4', borderRadius: '8px', padding: '16px', border: '1px solid #86efac' }}>
                    <div style={{ fontSize: '14px', fontWeight: '600', color: '#065f46', marginBottom: '8px' }}>✓ Data Quality Check</div>
                    <div style={{ fontSize: '13px', color: '#059669' }}>
                      • All {loadedMonthlyData.length} months have complete data<br/>
                      • Income Statement fields populated: Revenue, Expenses, COGS<br/>
                      • Balance Sheet fields populated: Assets, Liabilities, Equity<br/>
                      • Ready for AI-assisted mapping
                    </div>
                  </div>
                </div>
              )}

              <div style={{ background: 'white', borderRadius: '12px', padding: '24px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                <h2 style={{ fontSize: '20px', fontWeight: '600', color: '#1e293b', marginBottom: '16px' }}>Import Financials</h2>
                
                <div style={{ marginBottom: '20px' }}>
                  <h3 style={{ fontSize: '16px', fontWeight: '600', color: '#475569', marginBottom: '12px' }}>Upload Financial Data</h3>
                  <input type="file" accept=".xlsx,.xls,.csv" onChange={handleFile} style={{ marginBottom: '16px', padding: '12px', border: '2px dashed #cbd5e1', borderRadius: '8px', width: '100%', cursor: 'pointer' }} />
                  {error && <div style={{ padding: '12px', background: '#fee2e2', color: '#991b1b', borderRadius: '8px', marginBottom: '16px' }}>{error}</div>}
                  {file && <div style={{ fontSize: '14px', color: '#10b981', fontWeight: '600' }}>✓ Loaded: {file.name}</div>}
                </div>

              {file && columns.length > 0 && (
                <div>
                  <h3 style={{ fontSize: '16px', fontWeight: '600', color: '#475569', marginBottom: '12px' }}>Column Mapping</h3>
                  <p style={{ fontSize: '14px', color: '#64748b', marginBottom: '20px' }}>Verify or adjust the column mappings below. Columns have been auto-detected.</p>
                  
                  <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))', gap: '20px' }}>
                    <div>
                      <h4 style={{ fontSize: '15px', fontWeight: '600', color: '#475569', marginBottom: '12px', borderBottom: '2px solid #e2e8f0', paddingBottom: '8px' }}>Required Fields</h4>
                      {renderColumnSelector('Date/Period', 'date')}
                      {renderColumnSelector('Total Revenue', 'revenue')}
                      {renderColumnSelector('Total Expenses', 'expense')}
                      {renderColumnSelector('Total Assets', 'totalAssets')}
                      {renderColumnSelector('Total Liabilities', 'totalLiab')}
                      {renderColumnSelector('Total Equity', 'totalEquity')}
                    </div>
                    
                    <div>
                      <h4 style={{ fontSize: '15px', fontWeight: '600', color: '#475569', marginBottom: '12px', borderBottom: '2px solid #e2e8f0', paddingBottom: '8px' }}>Cost of Goods Sold</h4>
                      {renderColumnSelector('COGS Payroll', 'cogsPayroll')}
                      {renderColumnSelector('COGS Owner Pay', 'cogsOwnerPay')}
                      {renderColumnSelector('COGS Contractors', 'cogsContractors')}
                      {renderColumnSelector('COGS Materials', 'cogsMaterials')}
                      {renderColumnSelector('COGS Commissions', 'cogsCommissions')}
                      {renderColumnSelector('COGS Other', 'cogsOther')}
                      {renderColumnSelector('COGS Total', 'cogsTotal')}
                    </div>
                    
                    <div>
                      <h4 style={{ fontSize: '15px', fontWeight: '600', color: '#475569', marginBottom: '12px', borderBottom: '2px solid #e2e8f0', paddingBottom: '8px' }}>Operating Expenses</h4>
                      {renderColumnSelector('Sales & Marketing', 'opexSalesMarketing')}
                      {renderColumnSelector('Rent/Lease', 'rentLease')}
                      {renderColumnSelector('Utilities', 'utilities')}
                      {renderColumnSelector('Equipment', 'equipment')}
                      {renderColumnSelector('Travel', 'travel')}
                      {renderColumnSelector('Professional Services', 'professionalServices')}
                      {renderColumnSelector('Insurance', 'insurance')}
                      {renderColumnSelector('OPEX Other', 'opexOther')}
                    </div>
                    
                    <div>
                      <h4 style={{ fontSize: '15px', fontWeight: '600', color: '#475569', marginBottom: '12px', borderBottom: '2px solid #e2e8f0', paddingBottom: '8px' }}>Payroll & Owners</h4>
                      {renderColumnSelector('OPEX Payroll', 'opexPayroll')}
                      {renderColumnSelector('Owners Base Pay', 'ownersBasePay')}
                      {renderColumnSelector('Owners Retirement', 'ownersRetirement')}
                      {renderColumnSelector('Contractors/Distribution', 'contractorsDistribution')}
                      {renderColumnSelector('Interest Expense', 'interestExpense')}
                      {renderColumnSelector('Depreciation Expense', 'depreciationExpense')}
                      {renderColumnSelector('Operating Expense Total', 'operatingExpenseTotal')}
                      {renderColumnSelector('Non-Operating Income', 'nonOperatingIncome')}
                      {renderColumnSelector('Extraordinary Items', 'extraordinaryItems')}
                      {renderColumnSelector('Net Profit', 'netProfit')}
                    </div>
                    
                    <div>
                      <h4 style={{ fontSize: '15px', fontWeight: '600', color: '#475569', marginBottom: '12px', borderBottom: '2px solid #e2e8f0', paddingBottom: '8px' }}>Assets</h4>
                      {renderColumnSelector('Cash', 'cash')}
                      {renderColumnSelector('Accounts Receivable', 'ar')}
                      {renderColumnSelector('Inventory', 'inventory')}
                      {renderColumnSelector('Other Current Assets', 'otherCA')}
                      {renderColumnSelector('Total Current Assets', 'tca')}
                      {renderColumnSelector('Fixed Assets', 'fixedAssets')}
                      {renderColumnSelector('Other Assets', 'otherAssets')}
                    </div>
                    
                    <div>
                      <h4 style={{ fontSize: '15px', fontWeight: '600', color: '#475569', marginBottom: '12px', borderBottom: '2px solid #e2e8f0', paddingBottom: '8px' }}>Liabilities & Other</h4>
                      {renderColumnSelector('Accounts Payable', 'ap')}
                      {renderColumnSelector('Other Current Liabilities', 'otherCL')}
                      {renderColumnSelector('Total Current Liabilities', 'tcl')}
                      {renderColumnSelector('Long Term Debt', 'ltd')}
                      {renderColumnSelector('Total Liabilities & Equity', 'totalLAndE')}
                    </div>
                  </div>
                  
                  <div style={{ marginTop: '20px', padding: '12px', background: '#f0f9ff', border: '1px solid #bae6fd', borderRadius: '8px' }}>
                    <p style={{ fontSize: '13px', color: '#0c4a6e', margin: 0 }}>
                      <strong>Tip:</strong> At minimum, map Date, Total Revenue, Total Expenses, Total Assets, and Total Liabilities for basic analysis. 
                      Map detailed P&L and balance sheet items for comprehensive analysis and reporting.
                    </p>
                  </div>
                </div>
              )}
            </div>
            </>
          )}
          
          {!selectedCompanyId && adminDashboardTab === 'import-financials' && (
            <div style={{ background: 'white', borderRadius: '12px', padding: '48px 24px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', textAlign: 'center' }}>
              <div style={{ fontSize: '18px', fontWeight: '600', color: '#64748b', marginBottom: '12px' }}>No Company Selected</div>
              <p style={{ fontSize: '14px', color: '#94a3b8' }}>Please select a company from the sidebar to import financials.</p>
            </div>
          )}

          {/* Accounting API Connections Tab */}
          {adminDashboardTab === 'api-connections' && selectedCompanyId && (
            <div style={{ background: 'white', borderRadius: '12px', padding: '24px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
              <h2 style={{ fontSize: '20px', fontWeight: '600', color: '#1e293b', marginBottom: '16px' }}>Accounting API Connections</h2>
              <p style={{ fontSize: '14px', color: '#64748b', marginBottom: '12px' }}>
                Connect to accounting platforms to automatically import financial data for {companyName || 'your company'}.
              </p>

              {/* QuickBooks Connection */}
              <div style={{ background: '#f8fafc', borderRadius: '12px', padding: '24px', marginBottom: '20px', border: '2px solid #e2e8f0' }}>
                <div style={{ display: 'flex', alignItems: 'center', gap: '16px', marginBottom: '16px' }}>
                  <div style={{ width: '60px', height: '60px', background: 'white', borderRadius: '12px', display: 'flex', alignItems: 'center', justifyContent: 'center', border: '2px solid #e2e8f0' }}>
                    <div style={{ fontSize: '24px', fontWeight: '700', color: '#2ca01c' }}>QB</div>
                  </div>
                  <div>
                    <h3 style={{ fontSize: '18px', fontWeight: '600', color: '#1e293b', marginBottom: '4px' }}>QuickBooks Online</h3>
                    <p style={{ fontSize: '13px', color: '#64748b', margin: 0 }}>Intuit QuickBooks Online</p>
                  </div>
                </div>
                
                <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '12px' }}>
                  <div style={{ 
                    flex: 1, 
                    padding: '12px', 
                    background: qbConnected && qbStatus === 'ACTIVE' ? '#d1fae5' : qbStatus === 'ERROR' ? '#fee2e2' : qbStatus === 'EXPIRED' ? '#fed7aa' : '#fef3c7', 
                    borderRadius: '8px', 
                    border: `1px solid ${qbConnected && qbStatus === 'ACTIVE' ? '#10b981' : qbStatus === 'ERROR' ? '#ef4444' : qbStatus === 'EXPIRED' ? '#f97316' : '#fbbf24'}` 
                  }}>
                    <div style={{ fontSize: '12px', fontWeight: '600', color: qbConnected && qbStatus === 'ACTIVE' ? '#065f46' : qbStatus === 'ERROR' ? '#991b1b' : qbStatus === 'EXPIRED' ? '#9a3412' : '#92400e', marginBottom: '4px' }}>
                      {qbConnected && qbStatus === 'ACTIVE' ? '✓ Connected' : qbStatus === 'ERROR' ? '✗ Error' : qbStatus === 'EXPIRED' ? '⚠ Token Expired' : '⚠ Status: Not Connected'}
                    </div>
                    <div style={{ fontSize: '12px', color: qbConnected && qbStatus === 'ACTIVE' ? '#065f46' : qbStatus === 'ERROR' ? '#991b1b' : qbStatus === 'EXPIRED' ? '#9a3412' : '#92400e' }}>
                      {qbError || (qbConnected && qbStatus === 'ACTIVE' ? (qbLastSync ? `Last synced: ${qbLastSync.toLocaleString()}` : 'Ready to sync') : qbStatus === 'EXPIRED' ? 'Please reconnect' : 'Sandbox environment ready for testing')}
                    </div>
                  </div>
                </div>

                <div style={{ display: 'flex', gap: '12px' }}>
                  {!qbConnected || qbStatus === 'EXPIRED' || qbStatus === 'ERROR' ? (
                    <button
                      onClick={connectQuickBooks}
                      style={{
                        padding: '12px 24px',
                        background: '#2ca01c',
                        color: 'white',
                        border: 'none',
                        borderRadius: '8px',
                        fontSize: '14px',
                        fontWeight: '600',
                        cursor: 'pointer',
                        transition: 'background 0.2s'
                      }}
                      onMouseEnter={(e) => e.currentTarget.style.background = '#239017'}
                      onMouseLeave={(e) => e.currentTarget.style.background = '#2ca01c'}
                    >
                      {qbConnected ? 'Reconnect' : 'Connect'} to QuickBooks (Sandbox)
                    </button>
                  ) : (
                    <>
                      <button
                        onClick={syncQuickBooks}
                        disabled={qbSyncing}
                        style={{
                          padding: '12px 24px',
                          background: qbSyncing ? '#94a3b8' : '#667eea',
                          color: 'white',
                          border: 'none',
                          borderRadius: '8px',
                          fontSize: '14px',
                          fontWeight: '600',
                          cursor: qbSyncing ? 'not-allowed' : 'pointer',
                          transition: 'background 0.2s',
                          opacity: qbSyncing ? 0.7 : 1
                        }}
                        onMouseEnter={(e) => !qbSyncing && (e.currentTarget.style.background = '#5568d3')}
                        onMouseLeave={(e) => !qbSyncing && (e.currentTarget.style.background = '#667eea')}
                      >
                        {qbSyncing ? 'Syncing...' : 'Sync Data'}
                      </button>
                      <button
                        onClick={disconnectQuickBooks}
                        disabled={qbSyncing}
                        style={{
                          padding: '12px 24px',
                          background: 'white',
                          color: '#ef4444',
                          border: '2px solid #ef4444',
                          borderRadius: '8px',
                          fontSize: '14px',
                          fontWeight: '600',
                          cursor: qbSyncing ? 'not-allowed' : 'pointer',
                          transition: 'all 0.2s',
                          opacity: qbSyncing ? 0.7 : 1
                        }}
                        onMouseEnter={(e) => !qbSyncing && (e.currentTarget.style.background = '#fef2f2')}
                        onMouseLeave={(e) => !qbSyncing && (e.currentTarget.style.background = 'white')}
                      >
                        Disconnect
                      </button>
                    </>
                  )}
                </div>
              </div>

              {/* QuickBooks Data Verification */}
              {loadedMonthlyData && loadedMonthlyData.length > 0 && qbRawData && (
                <div style={{ background: 'white', borderRadius: '12px', padding: '24px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', border: '2px solid #10b981' }}>
                  <h3 style={{ fontSize: '20px', fontWeight: '600', color: '#1e293b', marginBottom: '8px' }}>✓ QuickBooks Data Verification</h3>
                  <p style={{ fontSize: '14px', color: '#64748b', marginBottom: '12px' }}>
                    Synced successfully • {loadedMonthlyData.length} months of data imported
                  </p>

                  {/* Summary Stats */}
                  <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '16px', marginBottom: '12px' }}>
                    <div style={{ background: '#f0fdf4', borderRadius: '8px', padding: '16px', border: '1px solid #86efac' }}>
                      <div style={{ fontSize: '12px', fontWeight: '600', color: '#065f46', marginBottom: '4px' }}>MONTHS IMPORTED</div>
                      <div style={{ fontSize: '28px', fontWeight: '700', color: '#10b981' }}>{loadedMonthlyData.length}</div>
                    </div>
                    <div style={{ background: '#ede9fe', borderRadius: '8px', padding: '16px', border: '1px solid #c4b5fd' }}>
                      <div style={{ fontSize: '12px', fontWeight: '600', color: '#5b21b6', marginBottom: '4px' }}>DATE RANGE</div>
                      <div style={{ fontSize: '14px', fontWeight: '600', color: '#7c3aed' }}>
                        {new Date(loadedMonthlyData[0].date).toLocaleDateString('en-US', { month: 'short', year: 'numeric' })} - {new Date(loadedMonthlyData[loadedMonthlyData.length - 1].date).toLocaleDateString('en-US', { month: 'short', year: 'numeric' })}
                      </div>
                    </div>
                    <div style={{ background: '#dbeafe', borderRadius: '8px', padding: '16px', border: '1px solid #93c5fd' }}>
                      <div style={{ fontSize: '12px', fontWeight: '600', color: '#1e40af', marginBottom: '4px' }}>TOTAL REVENUE</div>
                      <div style={{ fontSize: '18px', fontWeight: '700', color: '#2563eb' }}>
                        ${(loadedMonthlyData.reduce((sum, m) => sum + (m.revenue || 0), 0) / 1000).toFixed(0)}K
                      </div>
                    </div>
                    <div style={{ background: '#fef3c7', borderRadius: '8px', padding: '16px', border: '1px solid #fcd34d' }}>
                      <div style={{ fontSize: '12px', fontWeight: '600', color: '#92400e', marginBottom: '4px' }}>TOTAL ASSETS</div>
                      <div style={{ fontSize: '18px', fontWeight: '700', color: '#d97706' }}>
                        ${(loadedMonthlyData[loadedMonthlyData.length - 1].totalAssets / 1000).toFixed(0)}K
                      </div>
                    </div>
                  </div>

                  {/* Sample Data Tables - Show Individual Accounts */}
                  <div style={{ marginBottom: '20px' }}>
                    <h4 style={{ fontSize: '16px', fontWeight: '600', color: '#1e293b', marginBottom: '12px' }}>Sample Income & Expense Accounts (Last 3 Months)</h4>
                    <div style={{ overflowX: 'auto' }}>
                      <table style={{ width: '100%', fontSize: '12px', borderCollapse: 'collapse' }}>
                        <thead>
                          <tr style={{ background: '#f8fafc', borderBottom: '2px solid #e2e8f0' }}>
                            <th style={{ padding: '8px', textAlign: 'left', fontWeight: '600', color: '#475569' }}>Account</th>
                            {loadedMonthlyData.slice(-3).map((m, idx) => (
                              <th key={idx} style={{ padding: '8px', textAlign: 'right', fontWeight: '600', color: '#475569' }}>
                                {new Date(m.date).toLocaleDateString('en-US', { month: 'short', year: 'numeric' })}
                              </th>
                            ))}
                          </tr>
                        </thead>
                        <tbody>
                          {(() => {
                            // Extract individual accounts from qbRawData
                            const extractRows = (data: any, type: 'data' | 'total' = 'data'): any[] => {
                              const result: any[] = [];
                              if (!data || !data.Rows || !data.Rows.Row) return result;
                              const rows = Array.isArray(data.Rows.Row) ? data.Rows.Row : [data.Rows.Row];
                              
                              const processRows = (rows: any[], parentSection: string = ''): void => {
                                for (const row of rows) {
                                  if (row.type === 'Section') {
                                    const sectionName = row.Header?.ColData?.[0]?.value || '';
                                    if (row.Rows && row.Rows.Row) {
                                      const nested = Array.isArray(row.Rows.Row) ? row.Rows.Row : [row.Rows.Row];
                                      processRows(nested, sectionName);
                                    }
                                    if (type === 'total' && row.Summary?.ColData) {
                                      const name = row.Summary.ColData[0]?.value || '';
                                      if (name) {
                                        result.push({ name, section: parentSection, colData: row.Summary.ColData });
                                      }
                                    }
                                  } else if (row.type === 'Data' && row.ColData && type === 'data') {
                                    const name = row.ColData[0]?.value || '';
                                    if (name && !name.toLowerCase().includes('total')) {
                                      result.push({ name, section: parentSection, colData: row.ColData });
                                    }
                                  }
                                }
                              };
                              
                              processRows(rows);
                              return result;
                            };

                            // Get income and expense accounts
                            const allAccounts = extractRows(qbRawData?.profitAndLoss);
                            const incomeAccounts = allAccounts.filter(a => 
                              (a.section || '').toLowerCase().includes('income') || 
                              (a.section || '').toLowerCase().includes('revenue') ||
                              (a.section || '').toLowerCase().includes('service')
                            ).slice(0, 5);
                            const expenseAccounts = allAccounts.filter(a => 
                              (a.section || '').toLowerCase().includes('expense') || 
                              (a.section || '').toLowerCase().includes('cost')
                            ).slice(0, 5);

                            const displayAccounts = [...incomeAccounts, ...expenseAccounts].slice(0, 10);
                            
                            return displayAccounts.map((account, idx) => {
                              // Get values for last 3 months
                              const columnCount = qbRawData.profitAndLoss?.Columns?.Column?.length || 0;
                              const lastThreeMonths = Array.from({length: 3}, (_, i) => {
                                const colIndex = columnCount - 4 - (2 - i); // Skip the "Total" column
                                const value = account.colData[colIndex]?.value;
                                return parseFloat(value || '0');
                              });

                              const isIncome = incomeAccounts.includes(account);
                              
                              return (
                                <tr key={idx} style={{ borderBottom: '1px solid #f1f5f9' }}>
                                  <td style={{ padding: '8px', color: '#1e293b' }}>
                                    <span style={{ fontSize: '10px', color: '#94a3b8', marginRight: '8px' }}>
                                      {isIncome ? '📈' : '📉'}
                                    </span>
                                    {account.name}
                                  </td>
                                  {lastThreeMonths.map((val, midx) => (
                                    <td key={midx} style={{ 
                                      padding: '8px', 
                                      textAlign: 'right', 
                                      color: isIncome ? '#10b981' : '#ef4444', 
                                      fontWeight: val !== 0 ? '600' : '400' 
                                    }}>
                                      ${val.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                                    </td>
                                  ))}
                                </tr>
                              );
                            });
                          })()}
                        </tbody>
                      </table>
                    </div>
                  </div>

                  <div style={{ marginBottom: '20px' }}>
                    <h4 style={{ fontSize: '16px', fontWeight: '600', color: '#1e293b', marginBottom: '12px' }}>Sample Balance Sheet Data (Last 6 Months)</h4>
                    <div style={{ overflowX: 'auto' }}>
                      <table style={{ width: '100%', fontSize: '13px', borderCollapse: 'collapse' }}>
                        <thead>
                          <tr style={{ background: '#f8fafc', borderBottom: '2px solid #e2e8f0' }}>
                            <th style={{ padding: '8px', textAlign: 'left', fontWeight: '600', color: '#475569' }}>Month</th>
                            <th style={{ padding: '8px', textAlign: 'right', fontWeight: '600', color: '#475569' }}>Cash</th>
                            <th style={{ padding: '8px', textAlign: 'right', fontWeight: '600', color: '#475569' }}>A/R</th>
                            <th style={{ padding: '8px', textAlign: 'right', fontWeight: '600', color: '#475569' }}>A/P</th>
                            <th style={{ padding: '8px', textAlign: 'right', fontWeight: '600', color: '#475569' }}>Total Assets</th>
                            <th style={{ padding: '8px', textAlign: 'right', fontWeight: '600', color: '#475569' }}>Total Equity</th>
                          </tr>
                        </thead>
                        <tbody>
                          {loadedMonthlyData.slice(-6).map((m, idx) => (
                            <tr key={idx} style={{ borderBottom: '1px solid #f1f5f9' }}>
                              <td style={{ padding: '8px', color: '#1e293b' }}>{new Date(m.date).toLocaleDateString('en-US', { month: 'short', year: 'numeric' })}</td>
                              <td style={{ padding: '8px', textAlign: 'right', color: '#10b981', fontWeight: '600' }}>${m.cash.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</td>
                              <td style={{ padding: '8px', textAlign: 'right', color: '#3b82f6' }}>${m.ar.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</td>
                              <td style={{ padding: '8px', textAlign: 'right', color: '#f59e0b' }}>${m.ap.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</td>
                              <td style={{ padding: '8px', textAlign: 'right', color: '#8b5cf6', fontWeight: '600' }}>${m.totalAssets.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</td>
                              <td style={{ padding: '8px', textAlign: 'right', color: '#ec4899', fontWeight: '600' }}>${m.totalEquity.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</td>
                            </tr>
                          ))}
                        </tbody>
                      </table>
                    </div>
                  </div>

                  <div style={{ background: '#f0fdf4', borderRadius: '8px', padding: '16px', border: '1px solid #86efac', marginBottom: '16px' }}>
                    <div style={{ fontSize: '14px', fontWeight: '600', color: '#065f46', marginBottom: '8px' }}>✓ Data Quality Check</div>
                    <div style={{ fontSize: '13px', color: '#059669' }}>
                      • All {loadedMonthlyData.length} months have complete data<br/>
                      • Income Statement: Revenue, Expenses, COGS populated<br/>
                      • Balance Sheet: Assets, Liabilities, Equity populated<br/>
                      • Ready for AI-assisted account mapping
                    </div>
                  </div>

                  <div style={{ display: 'flex', gap: '12px' }}>
                    <button
                      onClick={() => {
                        // Navigate to Data Mapping tab
                        setAdminDashboardTab('data-mapping');
                      }}
                      style={{
                        padding: '12px 24px',
                        background: '#667eea',
                        color: 'white',
                        border: 'none',
                        borderRadius: '8px',
                        fontSize: '14px',
                        fontWeight: '600',
                        cursor: 'pointer',
                        transition: 'background 0.2s',
                        display: 'flex',
                        alignItems: 'center',
                        gap: '8px'
                      }}
                      onMouseEnter={(e) => e.currentTarget.style.background = '#5568d3'}
                      onMouseLeave={(e) => e.currentTarget.style.background = '#667eea'}
                    >
                      <span>🤖</span>
                      <span>Proceed to AI Account Mapping →</span>
                    </button>
                  </div>
                </div>
              )}


              {/* Sage Connection */}
              <div style={{ background: '#f8fafc', borderRadius: '12px', padding: '24px', marginBottom: '20px', border: '2px solid #e2e8f0', opacity: 0.6 }}>
                <div style={{ display: 'flex', alignItems: 'center', gap: '16px', marginBottom: '16px' }}>
                  <div style={{ width: '60px', height: '60px', background: 'white', borderRadius: '12px', display: 'flex', alignItems: 'center', justifyContent: 'center', border: '2px solid #e2e8f0' }}>
                    <div style={{ fontSize: '20px', fontWeight: '700', color: '#00a851' }}>S</div>
                  </div>
                  <div>
                    <h3 style={{ fontSize: '18px', fontWeight: '600', color: '#1e293b', marginBottom: '4px' }}>Sage</h3>
                    <p style={{ fontSize: '13px', color: '#64748b', margin: 0 }}>Sage Business Cloud Accounting</p>
                  </div>
                </div>
                <div style={{ padding: '12px', background: '#e2e8f0', borderRadius: '8px', fontSize: '13px', color: '#64748b', fontWeight: '600' }}>
                  Coming Soon
                </div>
              </div>

              {/* NetSuite Connection */}
              <div style={{ background: '#f8fafc', borderRadius: '12px', padding: '24px', marginBottom: '20px', border: '2px solid #e2e8f0', opacity: 0.6 }}>
                <div style={{ display: 'flex', alignItems: 'center', gap: '16px', marginBottom: '16px' }}>
                  <div style={{ width: '60px', height: '60px', background: 'white', borderRadius: '12px', display: 'flex', alignItems: 'center', justifyContent: 'center', border: '2px solid #e2e8f0' }}>
                    <div style={{ fontSize: '20px', fontWeight: '700', color: '#E91C24' }}>NS</div>
                  </div>
                  <div>
                    <h3 style={{ fontSize: '18px', fontWeight: '600', color: '#1e293b', marginBottom: '4px' }}>NetSuite</h3>
                    <p style={{ fontSize: '13px', color: '#64748b', margin: 0 }}>Oracle NetSuite ERP</p>
                  </div>
                </div>
                <div style={{ padding: '12px', background: '#e2e8f0', borderRadius: '8px', fontSize: '13px', color: '#64748b', fontWeight: '600' }}>
                  Coming Soon
                </div>
              </div>

              {/* Dynamics Connection */}
              <div style={{ background: '#f8fafc', borderRadius: '12px', padding: '24px', border: '2px solid #e2e8f0', opacity: 0.6 }}>
                <div style={{ display: 'flex', alignItems: 'center', gap: '16px', marginBottom: '16px' }}>
                  <div style={{ width: '60px', height: '60px', background: 'white', borderRadius: '12px', display: 'flex', alignItems: 'center', justifyContent: 'center', border: '2px solid #e2e8f0' }}>
                    <div style={{ fontSize: '20px', fontWeight: '700', color: '#0078D4' }}>D</div>
                  </div>
                  <div>
                    <h3 style={{ fontSize: '18px', fontWeight: '600', color: '#1e293b', marginBottom: '4px' }}>Microsoft Dynamics 365</h3>
                    <p style={{ fontSize: '13px', color: '#64748b', margin: 0 }}>Microsoft Dynamics 365 Finance</p>
                  </div>
                </div>
                <div style={{ padding: '12px', background: '#e2e8f0', borderRadius: '8px', fontSize: '13px', color: '#64748b', fontWeight: '600' }}>
                  Coming Soon
                </div>
              </div>

              <div style={{ marginTop: '24px', padding: '16px', background: '#f0f9ff', border: '1px solid #bae6fd', borderRadius: '8px' }}>
                <p style={{ fontSize: '13px', color: '#0c4a6e', margin: 0, lineHeight: '1.6' }}>
                  <strong>Note:</strong> API connections allow automatic synchronization of financial data. Once connected, 
                  you can schedule automatic imports or manually trigger data pulls. All connections use OAuth 2.0 for 
                  secure authentication and are encrypted in transit and at rest.
                </p>
              </div>
            </div>
          )}

          {/* Billing Sub-Tab Content */}
          {companyManagementSubTab === 'billing' && (
            <div style={{ background: 'white', borderRadius: '12px', padding: '24px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
              <h2 style={{ fontSize: '20px', fontWeight: '600', color: '#1e293b', marginBottom: '16px' }}>Billing & Subscription</h2>

              {/* Current Subscription Status */}
              <div style={{ marginBottom: '24px', padding: '16px', background: '#f0f9ff', border: '1px solid #bae6fd', borderRadius: '8px' }}>
                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '12px' }}>
                  <h3 style={{ fontSize: '16px', fontWeight: '600', color: '#0c4a6e', margin: 0 }}>Current Subscription</h3>
                  <span style={{ padding: '4px 12px', background: '#10b981', color: 'white', borderRadius: '20px', fontSize: '12px', fontWeight: '600' }}>
                    ACTIVE
                  </span>
                </div>
                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '16px' }}>
                  <div>
                    <div style={{ fontSize: '12px', color: '#64748b', marginBottom: '4px' }}>Plan</div>
                    <div style={{ fontSize: '16px', fontWeight: '600', color: '#1e293b' }}>Professional</div>
                  </div>
                  <div>
                    <div style={{ fontSize: '12px', color: '#64748b', marginBottom: '4px' }}>Billing Cycle</div>
                    <div style={{ fontSize: '16px', fontWeight: '600', color: '#1e293b' }}>Monthly</div>
                  </div>
                  <div>
                    <div style={{ fontSize: '12px', color: '#64748b', marginBottom: '4px' }}>Next Billing</div>
                    <div style={{ fontSize: '16px', fontWeight: '600', color: '#1e293b' }}>Dec 15, 2024</div>
                  </div>
                  <div>
                    <div style={{ fontSize: '12px', color: '#64748b', marginBottom: '4px' }}>Amount</div>
                    <div style={{ fontSize: '16px', fontWeight: '600', color: '#1e293b' }}>$99.00/month</div>
                  </div>
                </div>
              </div>

              {/* Payment Method */}
              <div style={{ marginBottom: '24px' }}>
                <h3 style={{ fontSize: '16px', fontWeight: '600', color: '#475569', marginBottom: '12px' }}>Payment Method</h3>
                <div style={{ padding: '16px', background: 'white', border: '1px solid #e2e8f0', borderRadius: '8px' }}>
                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                    <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                      <div style={{ width: '40px', height: '32px', background: '#f8fafc', borderRadius: '6px', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
                        <span style={{ fontSize: '16px' }}>💳</span>
                      </div>
                      <div>
                        <div style={{ fontSize: '14px', fontWeight: '600', color: '#1e293b' }}>•••• •••• •••• 4242</div>
                        <div style={{ fontSize: '12px', color: '#64748b' }}>Expires 12/25</div>
                      </div>
                    </div>
                    <button style={{ padding: '8px 16px', background: '#667eea', color: 'white', border: 'none', borderRadius: '6px', fontSize: '12px', fontWeight: '600', cursor: 'pointer' }}>
                      Update
                    </button>
                  </div>
                </div>
              </div>

              {/* Billing History */}
              <div>
                <h3 style={{ fontSize: '16px', fontWeight: '600', color: '#475569', marginBottom: '12px' }}>Billing History</h3>
                <div style={{ border: '1px solid #e2e8f0', borderRadius: '8px', overflow: 'hidden' }}>
                  <div style={{ display: 'grid', gridTemplateColumns: '1fr 100px 100px 120px', gap: '16px', padding: '16px', background: '#f8fafc', fontSize: '12px', fontWeight: '600', color: '#64748b' }}>
                    <div>Date</div>
                    <div>Amount</div>
                    <div>Status</div>
                    <div>Invoice</div>
                  </div>
                  <div style={{ display: 'grid', gridTemplateColumns: '1fr 100px 100px 120px', gap: '16px', padding: '16px', borderTop: '1px solid #e2e8f0', fontSize: '14px' }}>
                    <div>Nov 15, 2024</div>
                    <div style={{ fontWeight: '600', color: '#1e293b' }}>$99.00</div>
                    <div>
                      <span style={{ padding: '2px 8px', background: '#10b981', color: 'white', borderRadius: '12px', fontSize: '10px', fontWeight: '600' }}>
                        PAID
                      </span>
                    </div>
                    <div>
                      <button style={{ padding: '4px 8px', background: 'transparent', color: '#667eea', border: '1px solid #667eea', borderRadius: '4px', fontSize: '10px', cursor: 'pointer' }}>
                        PDF
                      </button>
                    </div>
                  </div>
                  <div style={{ display: 'grid', gridTemplateColumns: '1fr 100px 100px 120px', gap: '16px', padding: '16px', borderTop: '1px solid #e2e8f0', fontSize: '14px', background: '#f9fafb' }}>
                    <div>Oct 15, 2024</div>
                    <div style={{ fontWeight: '600', color: '#1e293b' }}>$99.00</div>
                    <div>
                      <span style={{ padding: '2px 8px', background: '#10b981', color: 'white', borderRadius: '12px', fontSize: '10px', fontWeight: '600' }}>
                        PAID
                      </span>
                    </div>
                    <div>
                      <button style={{ padding: '4px 8px', background: 'transparent', color: '#667eea', border: '1px solid #667eea', borderRadius: '4px', fontSize: '10px', cursor: 'pointer' }}>
                        PDF
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          )}

          {/* Profile Sub-Tab Content */}
          {companyManagementSubTab === 'profile' && (
            <div style={{ background: 'white', borderRadius: '12px', padding: '24px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
              <h2 style={{ fontSize: '20px', fontWeight: '600', color: '#1e293b', marginBottom: '16px' }}>Company Profile</h2>

              {/* Company Information */}
              <div style={{ marginBottom: '24px' }}>
                <h3 style={{ fontSize: '16px', fontWeight: '600', color: '#475569', marginBottom: '12px' }}>Company Information</h3>
                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))', gap: '16px' }}>
                  <div>
                    <label style={{ display: 'block', fontSize: '12px', fontWeight: '600', color: '#64748b', marginBottom: '4px' }}>
                      Company Name
                    </label>
                    <div style={{ padding: '8px 12px', background: '#f8fafc', border: '1px solid #e2e8f0', borderRadius: '6px', fontSize: '14px' }}>
                      {companies.find(c => c.id === selectedCompanyId)?.name || 'Not Available'}
                    </div>
                  </div>
                  <div>
                    <label style={{ display: 'block', fontSize: '12px', fontWeight: '600', color: '#64748b', marginBottom: '4px' }}>
                      Industry
                    </label>
                    <div style={{ padding: '8px 12px', background: '#f8fafc', border: '1px solid #e2e8f0', borderRadius: '6px', fontSize: '14px' }}>
                      {companyIndustrySector && INDUSTRY_SECTORS.find(i => i.id === companyIndustrySector)?.name || 'Not Set'}
                    </div>
                  </div>
                  <div>
                    <label style={{ display: 'block', fontSize: '12px', fontWeight: '600', color: '#64748b', marginBottom: '4px' }}>
                      Employees
                    </label>
                    <div style={{ padding: '8px 12px', background: '#f8fafc', border: '1px solid #e2e8f0', borderRadius: '6px', fontSize: '14px' }}>
                      {companies.find(c => c.id === selectedCompanyId)?.employeeCount || 'Not Set'}
                    </div>
                  </div>
                  <div>
                    <label style={{ display: 'block', fontSize: '12px', fontWeight: '600', color: '#64748b', marginBottom: '4px' }}>
                      Founded
                    </label>
                    <div style={{ padding: '8px 12px', background: '#f8fafc', border: '1px solid #e2e8f0', borderRadius: '6px', fontSize: '14px' }}>
                      {companies.find(c => c.id === selectedCompanyId)?.foundedYear || 'Not Set'}
                    </div>
                  </div>
                </div>
              </div>

              {/* Contact Information */}
              <div style={{ marginBottom: '24px' }}>
                <h3 style={{ fontSize: '16px', fontWeight: '600', color: '#475569', marginBottom: '12px' }}>Contact Information</h3>
                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))', gap: '16px' }}>
                  <div>
                    <label style={{ display: 'block', fontSize: '12px', fontWeight: '600', color: '#64748b', marginBottom: '4px' }}>
                      Email
                    </label>
                    <div style={{ padding: '8px 12px', background: '#f8fafc', border: '1px solid #e2e8f0', borderRadius: '6px', fontSize: '14px' }}>
                      {companies.find(c => c.id === selectedCompanyId)?.email || 'Not Set'}
                    </div>
                  </div>
                  <div>
                    <label style={{ display: 'block', fontSize: '12px', fontWeight: '600', color: '#64748b', marginBottom: '4px' }}>
                      Phone
                    </label>
                    <div style={{ padding: '8px 12px', background: '#f8fafc', border: '1px solid #e2e8f0', borderRadius: '6px', fontSize: '14px' }}>
                      {companies.find(c => c.id === selectedCompanyId)?.phone || 'Not Set'}
                    </div>
                  </div>
                  <div>
                    <label style={{ display: 'block', fontSize: '12px', fontWeight: '600', color: '#64748b', marginBottom: '4px' }}>
                      Website
                    </label>
                    <div style={{ padding: '8px 12px', background: '#f8fafc', border: '1px solid #e2e8f0', borderRadius: '6px', fontSize: '14px' }}>
                      {companies.find(c => c.id === selectedCompanyId)?.website || 'Not Set'}
                    </div>
                  </div>
                </div>
              </div>

              {/* Actions */}
              <div style={{ display: 'flex', gap: '12px', justifyContent: 'flex-end' }}>
                <button style={{ padding: '12px 24px', background: '#667eea', color: 'white', border: 'none', borderRadius: '8px', fontSize: '14px', fontWeight: '600', cursor: 'pointer' }}>
                  Edit Profile
                </button>
                <button style={{ padding: '12px 24px', background: '#f1f5f9', color: '#475569', border: '1px solid #cbd5e1', borderRadius: '8px', fontSize: '14px', fontWeight: '600', cursor: 'pointer' }}>
                  Export Data
                </button>
              </div>
            </div>
          )}

          {!selectedCompanyId && adminDashboardTab === 'api-connections' && (
            <div style={{ background: 'white', borderRadius: '12px', padding: '48px 24px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', textAlign: 'center' }}>
              <div style={{ fontSize: '18px', fontWeight: '600', color: '#64748b', marginBottom: '12px' }}>No Company Selected</div>
              <p style={{ fontSize: '14px', color: '#94a3b8' }}>Please select a company from the sidebar to manage API connections.</p>
            </div>
          )}

          {!selectedCompanyId && adminDashboardTab === 'data-review' && (
            <div style={{ background: 'white', borderRadius: '12px', padding: '48px 24px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', textAlign: 'center' }}>
              <div style={{ fontSize: '18px', fontWeight: '600', color: '#64748b', marginBottom: '12px' }}>No Company Selected</div>
              <p style={{ fontSize: '14px', color: '#94a3b8' }}>Please select a company from the sidebar to review financial data.</p>
            </div>
          )}

          {/* Payments/Billing Tab */}
          {adminDashboardTab === 'payments' && selectedCompanyId && (() => {
            const selectedCompany = companies.find(c => c.id === selectedCompanyId);
            const monthlyPrice = selectedCompany?.subscriptionMonthlyPrice || 195;
            const quarterlyPrice = selectedCompany?.subscriptionQuarterlyPrice || 500;
            const annualPrice = selectedCompany?.subscriptionAnnualPrice || 1750;
            
            return (
            <div style={{ background: 'white', borderRadius: '12px', padding: '20px', marginBottom: '20px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
              <h2 style={{ fontSize: '18px', fontWeight: '600', color: '#1e293b', marginBottom: '16px' }}>Billing & Subscription</h2>

              {/* Subscription Plans - Read Only */}
              <div style={{ marginBottom: '20px' }}>
                <h3 style={{ fontSize: '14px', fontWeight: '600', color: '#475569', marginBottom: '10px' }}>Subscription Plans</h3>
                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '12px' }}>
                  {/* Monthly Plan */}
                  <div style={{ 
                    border: '2px solid #e2e8f0', 
                    borderRadius: '8px', 
                    padding: '14px', 
                    background: '#fafafa'
                  }}>
                    <div style={{ fontSize: '13px', fontWeight: '600', color: '#64748b', marginBottom: '4px' }}>Monthly</div>
                    <div style={{ fontSize: '24px', fontWeight: '700', color: '#667eea' }}>
                      ${monthlyPrice.toFixed(2)}
                      <span style={{ fontSize: '13px', color: '#64748b', fontWeight: '500' }}>/mo</span>
                    </div>
                    <div style={{ fontSize: '11px', color: '#94a3b8', marginTop: '4px' }}>Billed monthly</div>
                  </div>

                  {/* Quarterly Plan */}
                  <div style={{ 
                    border: '2px solid #e2e8f0', 
                    borderRadius: '8px', 
                    padding: '14px', 
                    background: '#fafafa'
                  }}>
                    <div style={{ fontSize: '13px', fontWeight: '600', color: '#64748b', marginBottom: '4px' }}>Quarterly</div>
                    <div style={{ fontSize: '24px', fontWeight: '700', color: '#667eea' }}>
                      ${quarterlyPrice.toFixed(2)}
                      <span style={{ fontSize: '13px', color: '#64748b', fontWeight: '500' }}>/qtr</span>
                    </div>
                    <div style={{ fontSize: '11px', color: '#94a3b8', marginTop: '4px' }}>Billed every 3 months</div>
                  </div>

                  {/* Annual Plan */}
                  <div style={{ 
                    border: '2px solid #10b981', 
                    borderRadius: '8px', 
                    padding: '14px', 
                    background: '#f0fdf4',
                    position: 'relative'
                  }}>
                    <div style={{ position: 'absolute', top: '6px', right: '6px', background: '#10b981', color: 'white', padding: '2px 6px', borderRadius: '4px', fontSize: '9px', fontWeight: '600' }}>
                      BEST VALUE
                    </div>
                    <div style={{ fontSize: '13px', fontWeight: '600', color: '#64748b', marginBottom: '4px' }}>Annual</div>
                    <div style={{ fontSize: '24px', fontWeight: '700', color: '#059669' }}>
                      ${annualPrice.toFixed(2)}
                      <span style={{ fontSize: '13px', color: '#64748b', fontWeight: '500' }}>/yr</span>
                    </div>
                    <div style={{ fontSize: '11px', color: '#059669', marginTop: '4px', fontWeight: '500' }}>Save 15% annually</div>
                  </div>
                </div>
              </div>

              {/* Payment Information */}
              <div style={{ marginBottom: '16px' }}>
                <h3 style={{ fontSize: '14px', fontWeight: '600', color: '#475569', marginBottom: '10px' }}>Payment Information</h3>
                <div style={{ display: 'grid', gap: '10px' }}>
                  {/* Cardholder & Card Number - 2 columns */}
                  <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '10px' }}>
                    <div>
                      <label style={{ display: 'block', fontSize: '11px', fontWeight: '600', color: '#475569', marginBottom: '4px' }}>
                        Cardholder Name *
                      </label>
                      <input 
                        type="text"
                        placeholder="John Doe"
                        style={{ width: '100%', padding: '8px 10px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '13px' }}
                      />
                    </div>
                    <div>
                      <label style={{ display: 'block', fontSize: '11px', fontWeight: '600', color: '#475569', marginBottom: '4px' }}>
                        Card Number *
                      </label>
                      <input 
                        type="text"
                        placeholder="1234 5678 9012 3456"
                        maxLength={19}
                        style={{ width: '100%', padding: '8px 10px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '13px' }}
                      />
                    </div>
                  </div>

                  {/* Exp Month, Exp Year, CVV - 4 columns with fixed widths */}
                  <div style={{ display: 'grid', gridTemplateColumns: '100px 100px 80px 1fr', gap: '10px' }}>
                    <div>
                      <label style={{ display: 'block', fontSize: '11px', fontWeight: '600', color: '#475569', marginBottom: '4px' }}>
                        Exp Month *
                      </label>
                      <select style={{ width: '100%', padding: '8px 6px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '13px' }}>
                        <option value="">MM</option>
                        {Array.from({length: 12}, (_, i) => i + 1).map(month => (
                          <option key={month} value={month.toString().padStart(2, '0')}>
                            {month.toString().padStart(2, '0')}
                          </option>
                        ))}
                      </select>
                    </div>
                    <div>
                      <label style={{ display: 'block', fontSize: '11px', fontWeight: '600', color: '#475569', marginBottom: '4px' }}>
                        Exp Year *
                      </label>
                      <select style={{ width: '100%', padding: '8px 6px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '13px' }}>
                        <option value="">YYYY</option>
                        {Array.from({length: 10}, (_, i) => new Date().getFullYear() + i).map(year => (
                          <option key={year} value={year}>
                            {year}
                          </option>
                        ))}
                      </select>
                    </div>
                    <div>
                      <label style={{ display: 'block', fontSize: '11px', fontWeight: '600', color: '#475569', marginBottom: '4px' }}>
                        CVV *
                      </label>
                      <input 
                        type="text"
                        placeholder="123"
                        maxLength={4}
                        style={{ width: '100%', padding: '8px 10px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '13px' }}
                      />
                    </div>
                    <div></div>
                  </div>

                  {/* Address, City, State, ZIP - Single row */}
                  <div style={{ display: 'grid', gridTemplateColumns: '420px 200px 100px 120px', gap: '10px' }}>
                    <div>
                      <label style={{ display: 'block', fontSize: '11px', fontWeight: '600', color: '#475569', marginBottom: '4px' }}>
                        Billing Address *
                      </label>
                      <input 
                        type="text"
                        placeholder="123 Main St"
                        style={{ width: '100%', padding: '8px 10px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '13px' }}
                      />
                    </div>
                    <div>
                      <label style={{ display: 'block', fontSize: '11px', fontWeight: '600', color: '#475569', marginBottom: '4px' }}>
                        City *
                      </label>
                      <input 
                        type="text"
                        placeholder="San Francisco"
                        style={{ width: '100%', padding: '8px 10px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '13px' }}
                      />
                    </div>
                    <div>
                      <label style={{ display: 'block', fontSize: '11px', fontWeight: '600', color: '#475569', marginBottom: '4px' }}>
                        State *
                      </label>
                      <select style={{ width: '100%', padding: '8px 6px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '13px' }}>
                        <option value="">State</option>
                        <option value="AL">AL</option>
                        <option value="AK">AK</option>
                        <option value="AZ">AZ</option>
                        <option value="AR">AR</option>
                        <option value="CA">CA</option>
                        <option value="CO">CO</option>
                        <option value="CT">CT</option>
                        <option value="DE">DE</option>
                        <option value="FL">FL</option>
                        <option value="GA">GA</option>
                        <option value="HI">HI</option>
                        <option value="ID">ID</option>
                        <option value="IL">IL</option>
                        <option value="IN">IN</option>
                        <option value="IA">IA</option>
                        <option value="KS">KS</option>
                        <option value="KY">KY</option>
                        <option value="LA">LA</option>
                        <option value="ME">ME</option>
                        <option value="MD">MD</option>
                        <option value="MA">MA</option>
                        <option value="MI">MI</option>
                        <option value="MN">MN</option>
                        <option value="MS">MS</option>
                        <option value="MO">MO</option>
                        <option value="MT">MT</option>
                        <option value="NE">NE</option>
                        <option value="NV">NV</option>
                        <option value="NH">NH</option>
                        <option value="NJ">NJ</option>
                        <option value="NM">NM</option>
                        <option value="NY">NY</option>
                        <option value="NC">NC</option>
                        <option value="ND">ND</option>
                        <option value="OH">OH</option>
                        <option value="OK">OK</option>
                        <option value="OR">OR</option>
                        <option value="PA">PA</option>
                        <option value="RI">RI</option>
                        <option value="SC">SC</option>
                        <option value="SD">SD</option>
                        <option value="TN">TN</option>
                        <option value="TX">TX</option>
                        <option value="UT">UT</option>
                        <option value="VT">VT</option>
                        <option value="VA">VA</option>
                        <option value="WA">WA</option>
                        <option value="WV">WV</option>
                        <option value="WI">WI</option>
                        <option value="WY">WY</option>
                        <option value="DC">DC</option>
                      </select>
                    </div>
                    <div>
                      <label style={{ display: 'block', fontSize: '11px', fontWeight: '600', color: '#475569', marginBottom: '4px' }}>
                        ZIP *
                      </label>
                      <input 
                        type="text"
                        placeholder="94102"
                        maxLength={10}
                        style={{ width: '100%', padding: '8px 10px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '13px' }}
                      />
                    </div>
                  </div>
                </div>
              </div>

              {/* Action Buttons */}
              <div style={{ display: 'flex', gap: '10px', justifyContent: 'flex-end', borderTop: '1px solid #e2e8f0', paddingTop: '16px' }}>
                <button
                  onClick={() => {
                    if (confirm('Are you sure you want to cancel your subscription?')) {
                      alert('Subscription cancelled.');
                    }
                  }}
                  style={{
                    padding: '8px 16px',
                    background: 'white',
                    color: '#ef4444',
                    border: '1px solid #ef4444',
                    borderRadius: '6px',
                    fontSize: '13px',
                    fontWeight: '600',
                    cursor: 'pointer'
                  }}
                >
                  Cancel Subscription
                </button>
                <button
                  onClick={() => {
                    alert('Processing payment... This will integrate with USAePay API');
                  }}
                  style={{
                    padding: '8px 20px',
                    background: '#667eea',
                    color: 'white',
                    border: 'none',
                    borderRadius: '6px',
                    fontSize: '13px',
                    fontWeight: '600',
                    cursor: 'pointer'
                  }}
                >
                  Start Subscription
                </button>
              </div>

              {/* Security Notice */}
              <div style={{ marginTop: '16px', padding: '10px 12px', background: '#f0fdf4', borderRadius: '6px', border: '1px solid #86efac' }}>
                <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
                  <span style={{ fontSize: '14px' }}>🔒</span>
                  <span style={{ fontSize: '12px', fontWeight: '500', color: '#059669' }}>
                    Secure payment processing via USAePay. Card data is encrypted and never stored on our servers.
                  </span>
                </div>
              </div>
            </div>
            );
          })()}

          {!selectedCompanyId && adminDashboardTab === 'payments' && (
            <div style={{ background: 'white', borderRadius: '12px', padding: '48px 24px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', textAlign: 'center' }}>
              <div style={{ fontSize: '18px', fontWeight: '600', color: '#64748b', marginBottom: '12px' }}>No Company Selected</div>
              <p style={{ fontSize: '14px', color: '#94a3b8' }}>Please select a company from the sidebar to manage subscription and billing.</p>
            </div>
          )}

          {/* Profile Tab - No Company Selected */}
          {!selectedCompanyId && adminDashboardTab === 'profile' && (
            <div style={{ background: 'white', borderRadius: '12px', padding: '48px 24px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', textAlign: 'center' }}>
              <div style={{ fontSize: '18px', fontWeight: '600', color: '#64748b', marginBottom: '12px' }}>No Company Selected</div>
              <p style={{ fontSize: '14px', color: '#94a3b8' }}>Please select a company from the sidebar to view and edit company profile.</p>
            </div>
          )}

          {/* Data Mapping Tab - Content rendered through Financial Statements conditional below */}

          {!selectedCompanyId && adminDashboardTab === 'data-mapping' && (
            <div style={{ background: 'white', borderRadius: '12px', padding: '48px 24px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', textAlign: 'center' }}>
              <div style={{ fontSize: '18px', fontWeight: '600', color: '#64748b', marginBottom: '12px' }}>No Company Selected</div>
              <p style={{ fontSize: '14px', color: '#94a3b8' }}>Please select a company from the sidebar to map QuickBooks accounts.</p>
            </div>
          )}

          {adminDashboardTab === 'data-mapping' && selectedCompanyId && !qbRawData && (
            <div style={{ background: 'white', borderRadius: '12px', padding: '48px 24px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', textAlign: 'center' }}>
              <div style={{ fontSize: '18px', fontWeight: '600', color: '#64748b', marginBottom: '12px' }}>No QuickBooks Data</div>
              <p style={{ fontSize: '14px', color: '#94a3b8', marginBottom: '16px' }}>Please sync QuickBooks data first from the Accounting API Connections tab.</p>
              <button
                onClick={() => setAdminDashboardTab('api-connections')}
                style={{
                  padding: '12px 24px',
                  background: '#667eea',
                  color: 'white',
                  border: 'none',
                  borderRadius: '8px',
                  fontSize: '14px',
                  fontWeight: '600',
                  cursor: 'pointer'
                }}
              >
                Go to API Connections
              </button>
            </div>
          )}
        </div>
      )}

      {/* Company Details Modal */}
      {showCompanyDetailsModal && (
        <div style={{ position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, background: 'rgba(0,0,0,0.5)', display: 'flex', justifyContent: 'center', alignItems: 'center', zIndex: 1000 }}>
          <div style={{ background: 'white', borderRadius: '12px', padding: '32px', maxWidth: '700px', width: '100%', maxHeight: '80vh', overflowY: 'auto' }}>
            <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '12px' }}>Company Details</h2>
            
            <div style={{ marginBottom: '20px' }}>
              <h3 style={{ fontSize: '16px', fontWeight: '600', color: '#475569', marginBottom: '12px', borderBottom: '2px solid #e2e8f0', paddingBottom: '8px' }}>Address</h3>
              <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
                <input 
                  type="text" 
                  value={companyAddressStreet} 
                  onChange={(e) => setCompanyAddressStreet(e.target.value)} 
                  style={{ width: '100%', padding: '12px 16px', borderRadius: '8px', border: '1px solid #cbd5e1', fontSize: '14px' }} 
                  placeholder="Street Address" 
                />
                <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '12px' }}>
                  <input 
                    type="text" 
                    value={companyAddressCity} 
                    onChange={(e) => setCompanyAddressCity(e.target.value)} 
                    style={{ width: '100%', padding: '12px 16px', borderRadius: '8px', border: '1px solid #cbd5e1', fontSize: '14px' }} 
                    placeholder="City" 
                  />
                  <select 
                    value={companyAddressState} 
                    onChange={(e) => setCompanyAddressState(e.target.value)} 
                    style={{ width: '100%', padding: '12px 16px', borderRadius: '8px', border: '1px solid #cbd5e1', fontSize: '14px', cursor: 'pointer' }}
                  >
                    <option value="">State</option>
                    <option value="AL">AL</option>
                    <option value="AK">AK</option>
                    <option value="AZ">AZ</option>
                    <option value="AR">AR</option>
                    <option value="CA">CA</option>
                    <option value="CO">CO</option>
                    <option value="CT">CT</option>
                    <option value="DE">DE</option>
                    <option value="FL">FL</option>
                    <option value="GA">GA</option>
                    <option value="HI">HI</option>
                    <option value="ID">ID</option>
                    <option value="IL">IL</option>
                    <option value="IN">IN</option>
                    <option value="IA">IA</option>
                    <option value="KS">KS</option>
                    <option value="KY">KY</option>
                    <option value="LA">LA</option>
                    <option value="ME">ME</option>
                    <option value="MD">MD</option>
                    <option value="MA">MA</option>
                    <option value="MI">MI</option>
                    <option value="MN">MN</option>
                    <option value="MS">MS</option>
                    <option value="MO">MO</option>
                    <option value="MT">MT</option>
                    <option value="NE">NE</option>
                    <option value="NV">NV</option>
                    <option value="NH">NH</option>
                    <option value="NJ">NJ</option>
                    <option value="NM">NM</option>
                    <option value="NY">NY</option>
                    <option value="NC">NC</option>
                    <option value="ND">ND</option>
                    <option value="OH">OH</option>
                    <option value="OK">OK</option>
                    <option value="OR">OR</option>
                    <option value="PA">PA</option>
                    <option value="RI">RI</option>
                    <option value="SC">SC</option>
                    <option value="SD">SD</option>
                    <option value="TN">TN</option>
                    <option value="TX">TX</option>
                    <option value="UT">UT</option>
                    <option value="VT">VT</option>
                    <option value="VA">VA</option>
                    <option value="WA">WA</option>
                    <option value="WV">WV</option>
                    <option value="WI">WI</option>
                    <option value="WY">WY</option>
                    <option value="DC">DC</option>
                  </select>
                  <input 
                    type="text" 
                    value={companyAddressZip} 
                    onChange={(e) => setCompanyAddressZip(e.target.value)} 
                    style={{ width: '100%', padding: '12px 16px', borderRadius: '8px', border: '1px solid #cbd5e1', fontSize: '14px' }} 
                    placeholder="ZIP" 
                  />
                </div>
                <input 
                  type="text" 
                  value={companyAddressCountry} 
                  onChange={(e) => setCompanyAddressCountry(e.target.value)} 
                  style={{ width: '100%', padding: '12px 16px', borderRadius: '8px', border: '1px solid #cbd5e1', fontSize: '14px' }} 
                  placeholder="Country" 
                />
              </div>
            </div>
            
            <div style={{ marginBottom: '12px' }}>
              <h3 style={{ fontSize: '16px', fontWeight: '600', color: '#475569', marginBottom: '12px', borderBottom: '2px solid #e2e8f0', paddingBottom: '8px' }}>Industry Sector</h3>
              <select 
                value={companyIndustrySector} 
                onChange={(e) => setCompanyIndustrySector(parseInt(e.target.value))} 
                style={{ width: '100%', padding: '12px 16px', borderRadius: '8px', border: '1px solid #cbd5e1', fontSize: '14px', cursor: 'pointer' }}
              >
                <option value="">-- Select Industry --</option>
                {SECTOR_CATEGORIES.map(sector => (
                  <optgroup key={sector.code} label={`${sector.code} - ${sector.name}`}>
                    {INDUSTRY_SECTORS
                      .filter(ind => ind.sectorCode === sector.code)
                      .map(industry => (
                        <option key={industry.id} value={industry.id}>
                          {industry.id} - {industry.name}
                        </option>
                      ))}
                  </optgroup>
                ))}
              </select>
              {companyIndustrySector && INDUSTRY_SECTORS.find(i => i.id === companyIndustrySector) && (
                <div style={{ marginTop: '8px', padding: '12px', background: '#f0f9ff', border: '1px solid #bae6fd', borderRadius: '8px' }}>
                  <p style={{ fontSize: '12px', color: '#0c4a6e', margin: 0 }}>
                    <strong>{INDUSTRY_SECTORS.find(i => i.id === companyIndustrySector)?.name}</strong>
                    <br />
                    <span style={{ fontSize: '11px' }}>{INDUSTRY_SECTORS.find(i => i.id === companyIndustrySector)?.description}</span>
                  </p>
                </div>
              )}
            </div>
            <div style={{ display: 'flex', gap: '12px' }}>
              <button onClick={saveCompanyDetails} style={{ flex: 1, padding: '12px', background: '#667eea', color: 'white', border: 'none', borderRadius: '8px', fontSize: '14px', fontWeight: '600', cursor: 'pointer' }}>Save</button>
              <button onClick={() => setShowCompanyDetailsModal(false)} style={{ flex: 1, padding: '12px', background: '#f1f5f9', color: '#475569', border: 'none', borderRadius: '8px', fontSize: '14px', fontWeight: '600', cursor: 'pointer' }}>Cancel</button>
            </div>
          </div>
        </div>
      )}

      {/* Content Area - Requires Company Selection */}
      {!selectedCompanyId && currentView !== 'admin' && (
        <div style={{ maxWidth: '1400px', margin: '0 auto', padding: '64px 32px', textAlign: 'center' }}>
          <h2 style={{ fontSize: '28px', fontWeight: '600', color: '#1e293b', marginBottom: '16px' }}>No Company Selected</h2>
          <p style={{ fontSize: '16px', color: '#64748b', marginBottom: '12px' }}>Please select a company from the Consultant Dashboard to continue.</p>
          {currentUser?.role === 'consultant' && (
            <button onClick={() => setCurrentView('admin')} style={{ padding: '12px 24px', background: '#667eea', color: 'white', border: 'none', borderRadius: '8px', fontSize: '14px', fontWeight: '600', cursor: 'pointer' }}>Go to Consultant Dashboard</button>
          )}
        </div>
      )}

      {/* Data Review Tab */}
      {currentView === 'admin' && adminDashboardTab === 'data-review' && selectedCompanyId && (
        <div style={{ maxWidth: '100%', padding: '32px', overflowX: 'auto' }}>
          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '8px' }}>
            <h1 style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b', margin: 0 }}>📊 Data Review - Financial Data</h1>
            {companyName && <div style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b' }}>{companyName}</div>}
          </div>
          <p style={{ fontSize: '14px', color: '#64748b', marginBottom: '32px' }}>
            Review all imported financial data for {companyName || 'this company'}
          </p>
          
          {(!monthly || monthly.length === 0) && (
            <div style={{ background: '#fef2f2', border: '1px solid #fecaca', borderRadius: '8px', padding: '20px', color: '#991b1b' }}>
              <strong>No financial data found.</strong>
              <p style={{ marginTop: '8px', marginBottom: 0 }}>
                Please upload financial data in the Import Financials tab or sync from QuickBooks in the Accounting API Connections tab.
              </p>
            </div>
          )}
          
          {monthly && monthly.length > 0 && (
            <>
              <div style={{ background: '#f0fdf4', border: '1px solid #86efac', borderRadius: '8px', padding: '16px', marginBottom: '12px', color: '#166534' }}>
                <strong>✅ Financial data loaded</strong>
                <p style={{ marginTop: '8px', marginBottom: 0 }}>
                  Total months: {monthly.length} | Displaying: Last {Math.min(36, monthly.length)} months
                </p>
              </div>

              {/* Income Statement - Last 36 months */}
              <div style={{ background: 'white', borderRadius: '12px', padding: '24px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '16px', borderBottom: '3px solid #10b981', paddingBottom: '8px' }}>
                  Income Statement (Last 36 Months)
                </h2>
                <div style={{ overflowX: 'auto' }}>
                  <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '12px' }}>
                    <thead>
                      <tr style={{ background: '#f8fafc', borderBottom: '2px solid #e2e8f0' }}>
                        <th style={{ padding: '10px', textAlign: 'left', fontWeight: '600', position: 'sticky', left: 0, background: '#f8fafc', zIndex: 1, minWidth: '150px' }}>Item</th>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <th key={idx} style={{ padding: '10px', textAlign: 'right', fontWeight: '600', minWidth: '90px' }}>{m.month}</th>
                        ))}
                      </tr>
                    </thead>
                    <tbody>
                      {/* Total Revenue */}
                      <tr style={{ borderBottom: '2px solid #e2e8f0', background: '#f0fdf4' }}>
                        <td style={{ padding: '8px 10px', fontWeight: '700', position: 'sticky', left: 0, background: '#f0fdf4', zIndex: 1 }}>Total Revenue</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace', fontWeight: '700' }}>
                            ${(m.revenue || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      
                      {/* COGS Detail */}
                      <tr style={{ borderBottom: '1px solid #f1f5f9', background: '#fef3c7' }}>
                        <td style={{ padding: '8px 10px', fontWeight: '700', position: 'sticky', left: 0, background: '#fef3c7', zIndex: 1 }}>COST OF GOODS SOLD</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px' }}></td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>COGS Payroll</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.cogsPayroll || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>COGS Owner Pay</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.cogsOwnerPay || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>COGS Contractors</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.cogsContractors || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>COGS Materials</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.cogsMaterials || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>COGS Commissions</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.cogsCommissions || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>COGS Other</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.cogsOther || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '2px solid #e2e8f0', background: '#fef9c3' }}>
                        <td style={{ padding: '8px 10px', fontWeight: '700', position: 'sticky', left: 0, background: '#fef9c3', zIndex: 1 }}>Total COGS</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace', fontWeight: '700' }}>
                            ${(m.cogsTotal || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      
                      {/* Gross Profit */}
                      <tr style={{ borderBottom: '2px solid #10b981', background: '#d1fae5' }}>
                        <td style={{ padding: '10px', fontWeight: '700', fontSize: '14px', position: 'sticky', left: 0, background: '#d1fae5', zIndex: 1 }}>GROSS PROFIT</td>
                        {monthly.slice(-36).map((m: any, idx: number) => {
                          const grossProfit = (m.revenue || 0) - (m.cogsTotal || 0);
                          return (
                            <td key={idx} style={{ padding: '10px', textAlign: 'right', fontFamily: 'monospace', fontWeight: '700', fontSize: '14px' }}>
                              ${grossProfit.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                            </td>
                          );
                        })}
                      </tr>
                      
                      {/* Operating Expenses */}
                      <tr style={{ borderBottom: '1px solid #f1f5f9', background: '#dbeafe' }}>
                        <td style={{ padding: '8px 10px', fontWeight: '700', position: 'sticky', left: 0, background: '#dbeafe', zIndex: 1 }}>OPERATING EXPENSES</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px' }}></td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>Payroll</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.opexPayroll || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>Owner Base Pay</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.ownersBasePay || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>Benefits</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.benefits || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>Insurance</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.insurance || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>Professional Fees</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.professionalServices || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>Subcontractors</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.contractorsDistribution || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>Rent</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.rentLease || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>Tax & License</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.taxLicense || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>Phone & Comm</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.phoneComm || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>Infrastructure</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.equipment || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>Auto & Travel</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.travel || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>Sales Expense</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.opexSalesMarketing || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>Marketing</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.opexOther || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>Training & Cert</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.trainingCert || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>Meals & Entertainment</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.mealsEntertainment || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>Interest Expense</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.interestExpense || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>Depreciation & Amortization</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.depreciationExpense || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>Other Expense</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.otherExpense || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '2px solid #e2e8f0', background: '#e0f2fe' }}>
                        <td style={{ padding: '8px 10px', fontWeight: '700', position: 'sticky', left: 0, background: '#e0f2fe', zIndex: 1 }}>Total Operating Expenses</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace', fontWeight: '700' }}>
                            ${(m.expense || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      
                      {/* Net Income */}
                      <tr style={{ borderBottom: '3px solid #10b981', background: '#10b981', color: 'white' }}>
                        <td style={{ padding: '12px 10px', fontWeight: '700', fontSize: '15px', position: 'sticky', left: 0, background: '#10b981', zIndex: 1 }}>NET INCOME</td>
                        {monthly.slice(-36).map((m: any, idx: number) => {
                          const netIncome = (m.revenue || 0) - (m.cogsTotal || 0) - (m.expense || 0);
                          return (
                            <td key={idx} style={{ padding: '12px 10px', textAlign: 'right', fontFamily: 'monospace', fontWeight: '700', fontSize: '15px' }}>
                              ${netIncome.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                            </td>
                          );
                        })}
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              {/* Balance Sheet - Last 36 months */}
              <div style={{ background: 'white', borderRadius: '12px', padding: '24px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '16px', borderBottom: '3px solid #3b82f6', paddingBottom: '8px' }}>
                  Balance Sheet (Last 36 Months)
                </h2>
                <div style={{ overflowX: 'auto' }}>
                  <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '12px' }}>
                    <thead>
                      <tr style={{ background: '#f8fafc', borderBottom: '2px solid #e2e8f0' }}>
                        <th style={{ padding: '10px', textAlign: 'left', fontWeight: '600', position: 'sticky', left: 0, background: '#f8fafc', zIndex: 1, minWidth: '150px' }}>Item</th>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <th key={idx} style={{ padding: '10px', textAlign: 'right', fontWeight: '600', minWidth: '90px' }}>{m.month}</th>
                        ))}
                      </tr>
                    </thead>
                    <tbody>
                      {/* Current Assets */}
                      <tr style={{ borderBottom: '1px solid #f1f5f9', background: '#dbeafe' }}>
                        <td style={{ padding: '8px 10px', fontWeight: '700', position: 'sticky', left: 0, background: '#dbeafe', zIndex: 1 }}>CURRENT ASSETS</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px' }}></td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>Cash</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.cash || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>Accounts Receivable</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.ar || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>Inventory</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.inventory || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>Other Current Assets</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.otherCA || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '2px solid #e2e8f0', background: '#dbeafe' }}>
                        <td style={{ padding: '8px 10px', fontWeight: '700', position: 'sticky', left: 0, background: '#dbeafe', zIndex: 1 }}>Total Current Assets</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace', fontWeight: '700' }}>
                            ${(m.tca || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      
                      {/* Fixed Assets */}
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>Fixed Assets</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.fixedAssets || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>Other Assets</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.otherAssets || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '3px solid #3b82f6', background: '#e0f2fe' }}>
                        <td style={{ padding: '10px', fontWeight: '700', fontSize: '14px', position: 'sticky', left: 0, background: '#e0f2fe', zIndex: 1 }}>TOTAL ASSETS</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '10px', textAlign: 'right', fontFamily: 'monospace', fontWeight: '700', fontSize: '14px' }}>
                            ${(m.totalAssets || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      
                      {/* Current Liabilities */}
                      <tr style={{ borderBottom: '1px solid #f1f5f9', background: '#fef3c7' }}>
                        <td style={{ padding: '8px 10px', fontWeight: '700', position: 'sticky', left: 0, background: '#fef3c7', zIndex: 1 }}>CURRENT LIABILITIES</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px' }}></td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>Accounts Payable</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.ap || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>Other Current Liabilities</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.otherCL || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '2px solid #e2e8f0', background: '#fef3c7' }}>
                        <td style={{ padding: '8px 10px', fontWeight: '700', position: 'sticky', left: 0, background: '#fef3c7', zIndex: 1 }}>Total Current Liabilities</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace', fontWeight: '700' }}>
                            ${(m.tcl || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      
                      {/* Long-term Liabilities */}
                      <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                        <td style={{ padding: '8px 10px', paddingLeft: '20px', position: 'sticky', left: 0, background: 'white', zIndex: 1 }}>Long-term Debt</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px', textAlign: 'right', fontFamily: 'monospace' }}>
                            ${(m.ltd || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '3px solid #f59e0b', background: '#fef9c3' }}>
                        <td style={{ padding: '10px', fontWeight: '700', fontSize: '14px', position: 'sticky', left: 0, background: '#fef9c3', zIndex: 1 }}>TOTAL LIABILITIES</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '10px', textAlign: 'right', fontFamily: 'monospace', fontWeight: '700', fontSize: '14px' }}>
                            ${(m.totalLiab || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      
                      {/* Equity */}
                      <tr style={{ borderBottom: '1px solid #f1f5f9', background: '#f0fdf4' }}>
                        <td style={{ padding: '8px 10px', fontWeight: '700', position: 'sticky', left: 0, background: '#f0fdf4', zIndex: 1 }}>EQUITY</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '8px 10px' }}></td>
                        ))}
                      </tr>
                      <tr style={{ borderBottom: '3px solid #10b981', background: '#f0fdf4' }}>
                        <td style={{ padding: '10px', fontWeight: '700', fontSize: '14px', position: 'sticky', left: 0, background: '#f0fdf4', zIndex: 1 }}>TOTAL EQUITY</td>
                        {monthly.slice(-36).map((m: any, idx: number) => (
                          <td key={idx} style={{ padding: '10px', textAlign: 'right', fontFamily: 'monospace', fontWeight: '700', fontSize: '14px' }}>
                            ${(m.totalEquity || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                          </td>
                        ))}
                      </tr>
                      
                      {/* Total Liabilities & Equity Check */}
                      <tr style={{ borderBottom: '4px double #475569', background: '#e2e8f0' }}>
                        <td style={{ padding: '12px 10px', fontWeight: '700', fontSize: '15px', position: 'sticky', left: 0, background: '#e2e8f0', zIndex: 1 }}>TOTAL LIABILITIES & EQUITY</td>
                        {monthly.slice(-36).map((m: any, idx: number) => {
                          const totalLE = (m.totalLiab || 0) + (m.totalEquity || 0);
                          return (
                            <td key={idx} style={{ padding: '12px 10px', textAlign: 'right', fontFamily: 'monospace', fontWeight: '700', fontSize: '15px' }}>
                              ${totalLE.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                            </td>
                          );
                        })}
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </>
          )}
        </div>
      )}

      {/* Trend Analysis View */}
      {currentView === 'trend-analysis' && selectedCompanyId && monthly.length > 0 && (
        <div style={{ maxWidth: '100%', padding: '32px 32px 32px 16px' }}>
          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '32px' }}>
            <h1 style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b', margin: 0 }}>Trend Analysis</h1>
            {companyName && <div style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b' }}>{companyName}</div>}
          </div>

          {/* Tabs */}
          <div style={{ display: 'flex', gap: '12px', marginBottom: '12px', borderBottom: '2px solid #e2e8f0' }}>
            <button 
              onClick={() => setTrendAnalysisTab('item-trends')}
              style={{ 
                padding: '12px 24px', 
                background: 'none', 
                border: 'none', 
                fontSize: '16px', 
                fontWeight: '600', 
                color: trendAnalysisTab === 'item-trends' ? '#667eea' : '#64748b', 
                cursor: 'pointer',
                borderBottom: trendAnalysisTab === 'item-trends' ? '3px solid #667eea' : '3px solid transparent',
                marginBottom: '-2px'
              }}
            >
              Item Trends
            </button>
            <button 
              onClick={() => setTrendAnalysisTab('expense-analysis')}
              style={{ 
                padding: '12px 24px', 
                background: 'none', 
                border: 'none', 
                fontSize: '16px', 
                fontWeight: '600', 
                color: trendAnalysisTab === 'expense-analysis' ? '#667eea' : '#64748b', 
                cursor: 'pointer',
                borderBottom: trendAnalysisTab === 'expense-analysis' ? '3px solid #667eea' : '3px solid transparent',
                marginBottom: '-2px'
              }}
            >
              Expense Analysis
            </button>
          </div>

          {/* Item Trends Tab */}
          {trendAnalysisTab === 'item-trends' && (
            <div style={{ background: 'white', borderRadius: '12px', padding: '24px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
              <div style={{ marginBottom: '20px' }}>
                <label style={{ display: 'block', fontSize: '16px', fontWeight: '600', color: '#475569', marginBottom: '12px' }}>
                  Select Item to Analyze:
                </label>
                <select 
                  value={selectedTrendItem} 
                  onChange={(e) => setSelectedTrendItem(e.target.value)}
                  style={{ width: '100%', maxWidth: '400px', padding: '12px 16px', borderRadius: '8px', border: '1px solid #cbd5e1', fontSize: '14px', cursor: 'pointer', fontWeight: '500' }}
                >
                  <optgroup label="Income Statement">
                    <option value="revenue">Total Revenue</option>
                    <option value="expense">Total Expenses</option>
                    {mapping.cogsTotal && <option value="cogsTotal">COGS Total</option>}
                    {mapping.cogsPayroll && <option value="cogsPayroll">COGS Payroll</option>}
                    {mapping.cogsOwnerPay && <option value="cogsOwnerPay">COGS Owner Pay</option>}
                    {mapping.cogsContractors && <option value="cogsContractors">COGS Contractors</option>}
                    {mapping.cogsMaterials && <option value="cogsMaterials">COGS Materials</option>}
                    {mapping.cogsCommissions && <option value="cogsCommissions">COGS Commissions</option>}
                    {mapping.cogsOther && <option value="cogsOther">COGS Other</option>}
                    {mapping.opexSalesMarketing && <option value="opexSalesMarketing">Sales & Marketing</option>}
                    {mapping.rentLease && <option value="rentLease">Rent/Lease</option>}
                    {mapping.utilities && <option value="utilities">Utilities</option>}
                    {mapping.equipment && <option value="equipment">Equipment</option>}
                    {mapping.travel && <option value="travel">Travel</option>}
                    {mapping.professionalServices && <option value="professionalServices">Professional Services</option>}
                    {mapping.insurance && <option value="insurance">Insurance</option>}
                    {mapping.opexOther && <option value="opexOther">OPEX Other</option>}
                    {mapping.opexPayroll && <option value="opexPayroll">OPEX Payroll</option>}
                    {mapping.ownersBasePay && <option value="ownersBasePay">Owners Base Pay</option>}
                    {mapping.ownersRetirement && <option value="ownersRetirement">Owners Retirement</option>}
                    {mapping.contractorsDistribution && <option value="contractorsDistribution">Contractors/Distribution</option>}
                    {mapping.interestExpense && <option value="interestExpense">Interest Expense</option>}
                    {mapping.depreciationExpense && <option value="depreciationExpense">Depreciation Expense</option>}
                    {mapping.operatingExpenseTotal && <option value="operatingExpenseTotal">Operating Expense Total</option>}
                    {mapping.nonOperatingIncome && <option value="nonOperatingIncome">Non-Operating Income</option>}
                    {mapping.extraordinaryItems && <option value="extraordinaryItems">Extraordinary Items</option>}
                    {mapping.netProfit && <option value="netProfit">Net Profit</option>}
                  </optgroup>
                  <optgroup label="Balance Sheet - Assets">
                    <option value="totalAssets">Total Assets</option>
                    <option value="cash">Cash</option>
                    <option value="ar">Accounts Receivable</option>
                    <option value="inventory">Inventory</option>
                    {mapping.otherCA && <option value="otherCA">Other Current Assets</option>}
                    {mapping.tca && <option value="tca">Total Current Assets</option>}
                    {mapping.fixedAssets && <option value="fixedAssets">Fixed Assets</option>}
                    {mapping.otherAssets && <option value="otherAssets">Other Assets</option>}
                  </optgroup>
                  <optgroup label="Balance Sheet - Liabilities">
                    <option value="totalLiab">Total Liabilities</option>
                    <option value="ap">Accounts Payable</option>
                    {mapping.otherCL && <option value="otherCL">Other Current Liabilities</option>}
                    {mapping.tcl && <option value="tcl">Total Current Liabilities</option>}
                    {mapping.ltd && <option value="ltd">Long Term Debt</option>}
                  </optgroup>
                  <optgroup label="Balance Sheet - Equity">
                    <option value="totalEquity">Total Equity</option>
                  </optgroup>
                </select>
              </div>

              <div style={{ display: 'flex', gap: '20px', alignItems: 'flex-start' }}>
                <div style={{ flex: 1, minWidth: 0 }}>
                  <LineChart 
                    title={`${selectedTrendItem.charAt(0).toUpperCase() + selectedTrendItem.slice(1).replace(/([A-Z])/g, ' $1')} Trend`}
                    data={monthly.map(m => ({ month: m.month, value: m[selectedTrendItem as keyof typeof m] as number }))}
                    color="#667eea"
                    showTable={true}
                    labelFormat="quarterly"
                  />
                </div>
                
                <div style={{ width: '280px', flexShrink: 0 }}>
                  <div style={{ background: '#f8fafc', borderRadius: '12px', padding: '20px', border: '1px solid #e2e8f0', position: 'sticky', top: '100px' }}>
                    <h3 style={{ fontSize: '14px', fontWeight: '700', color: '#1e293b', marginBottom: '16px', textAlign: 'center' }}>Growth Analysis</h3>
                    
                    <div style={{ marginBottom: '16px', padding: '16px', background: 'white', borderRadius: '8px', border: '1px solid #cbd5e1' }}>
                      <div style={{ fontSize: '11px', fontWeight: '600', color: '#64748b', marginBottom: '8px', textAlign: 'center' }}>GROWTH RATE</div>
                      <div style={{ fontSize: '10px', color: '#64748b', marginBottom: '4px', textAlign: 'center' }}>Last Year</div>
                      <div style={{ fontSize: '24px', fontWeight: '700', textAlign: 'center', color: monthly.length >= 24 ? 
                        (() => {
                          const last12 = monthly.slice(-12).reduce((sum, m) => sum + (m[selectedTrendItem as keyof typeof m] as number || 0), 0);
                          const prev12 = monthly.slice(-24, -12).reduce((sum, m) => sum + (m[selectedTrendItem as keyof typeof m] as number || 0), 0);
                          const growthRate = prev12 !== 0 ? ((last12 - prev12) / prev12) * 100 : 0;
                          return growthRate >= 0 ? '#10b981' : '#ef4444';
                        })()
                        : '#64748b'
                      }}>
                        {monthly.length >= 24 ? (() => {
                          const last12 = monthly.slice(-12).reduce((sum, m) => sum + (m[selectedTrendItem as keyof typeof m] as number || 0), 0);
                          const prev12 = monthly.slice(-24, -12).reduce((sum, m) => sum + (m[selectedTrendItem as keyof typeof m] as number || 0), 0);
                          const growthRate = prev12 !== 0 ? ((last12 - prev12) / prev12) * 100 : 0;
                          return `${growthRate >= 0 ? '+' : ''}${growthRate.toFixed(2)}%`;
                        })() : 'N/A'}
                      </div>
                    </div>

                    <div style={{ padding: '16px', background: 'white', borderRadius: '8px', border: '1px solid #cbd5e1' }}>
                      <div style={{ fontSize: '11px', fontWeight: '600', color: '#64748b', marginBottom: '8px', textAlign: 'center' }}>GROWTH RATE</div>
                      <div style={{ fontSize: '10px', color: '#64748b', marginBottom: '4px', textAlign: 'center' }}>Previous Year</div>
                      <div style={{ fontSize: '24px', fontWeight: '700', textAlign: 'center', color: monthly.length >= 36 ? 
                        (() => {
                          const prev12 = monthly.slice(-24, -12).reduce((sum, m) => sum + (m[selectedTrendItem as keyof typeof m] as number || 0), 0);
                          const prev24 = monthly.slice(-36, -24).reduce((sum, m) => sum + (m[selectedTrendItem as keyof typeof m] as number || 0), 0);
                          const growthRate = prev24 !== 0 ? ((prev12 - prev24) / prev24) * 100 : 0;
                          return growthRate >= 0 ? '#10b981' : '#ef4444';
                        })()
                        : '#64748b'
                      }}>
                        {monthly.length >= 36 ? (() => {
                          const prev12 = monthly.slice(-24, -12).reduce((sum, m) => sum + (m[selectedTrendItem as keyof typeof m] as number || 0), 0);
                          const prev24 = monthly.slice(-36, -24).reduce((sum, m) => sum + (m[selectedTrendItem as keyof typeof m] as number || 0), 0);
                          const growthRate = prev24 !== 0 ? ((prev12 - prev24) / prev24) * 100 : 0;
                          return `${growthRate >= 0 ? '+' : ''}${growthRate.toFixed(2)}%`;
                        })() : 'N/A'}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          )}

          {/* Expense Analysis Tab */}
          {trendAnalysisTab === 'expense-analysis' && (
            <div>
              <h2 style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b', marginBottom: '12px' }}>Expense Items as % of Total Revenue</h2>
              
              <div style={{ marginBottom: '12px', padding: '16px', background: '#f0fdf4', borderRadius: '8px', border: '1px solid #86efac' }}>
                <h3 style={{ fontSize: '14px', fontWeight: '700', color: '#166534', marginBottom: '8px' }}>💡 How to Use This Analysis</h3>
                <ul style={{ margin: 0, paddingLeft: '20px', fontSize: '13px', color: '#15803d', lineHeight: '1.6' }}>
                  <li>Each chart shows an expense category as a <strong>percentage of total revenue</strong> over time</li>
                  <li>Look for categories with <strong>increasing trends</strong> that may need cost control</li>
                  <li>Compare percentages to industry benchmarks to identify inefficiencies</li>
                  <li>Watch for sudden spikes that may indicate one-time events or problems</li>
                </ul>
              </div>

              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '24px' }}>
                {/* Total Expenses */}
                <LineChart 
                  title="Total Expenses (% of Revenue)"
                  data={monthly.map(m => ({ 
                    month: m.month, 
                    value: m.revenue > 0 ? (m.expense / m.revenue) * 100 : 0 
                  }))}
                  color="#ef4444"
                  compact
                />

                {/* COGS Total */}
                {mapping.cogsTotal && (
                  <LineChart 
                    title="COGS Total (% of Revenue)"
                    data={monthly.map(m => ({ 
                      month: m.month, 
                      value: m.revenue > 0 ? ((m.cogsTotal || 0) / m.revenue) * 100 : 0 
                    }))}
                    color="#f59e0b"
                    compact
                  />
                )}

                {/* COGS Breakdown */}
                {mapping.cogsPayroll && (
                  <LineChart 
                    title="COGS Payroll (% of Revenue)"
                    data={monthly.map(m => ({ 
                      month: m.month, 
                      value: m.revenue > 0 ? ((m.cogsPayroll || 0) / m.revenue) * 100 : 0 
                    }))}
                    color="#fb923c"
                    compact
                  />
                )}

                {mapping.cogsOwnerPay && (
                  <LineChart 
                    title="COGS Owner Pay (% of Revenue)"
                    data={monthly.map(m => ({ 
                      month: m.month, 
                      value: m.revenue > 0 ? ((m.cogsOwnerPay || 0) / m.revenue) * 100 : 0 
                    }))}
                    color="#fdba74"
                    compact
                  />
                )}

                {mapping.cogsContractors && (
                  <LineChart 
                    title="COGS Contractors (% of Revenue)"
                    data={monthly.map(m => ({ 
                      month: m.month, 
                      value: m.revenue > 0 ? ((m.cogsContractors || 0) / m.revenue) * 100 : 0 
                    }))}
                    color="#fed7aa"
                    compact
                  />
                )}
                
                {mapping.cogsMaterials && (
                  <LineChart 
                    title="COGS Materials (% of Revenue)"
                    data={monthly.map(m => ({ 
                      month: m.month, 
                      value: m.revenue > 0 ? ((m.cogsMaterials || 0) / m.revenue) * 100 : 0 
                    }))}
                    color="#fde047"
                    compact
                  />
                )}
                
                {mapping.cogsCommissions && (
                  <LineChart 
                    title="COGS Commissions (% of Revenue)"
                    data={monthly.map(m => ({ 
                      month: m.month, 
                      value: m.revenue > 0 ? ((m.cogsCommissions || 0) / m.revenue) * 100 : 0 
                    }))}
                    color="#bef264"
                    compact
                  />
                )}
                
                {mapping.cogsOther && (
                  <LineChart 
                    title="COGS Other (% of Revenue)"
                    data={monthly.map(m => ({ 
                      month: m.month, 
                      value: m.revenue > 0 ? ((m.cogsOther || 0) / m.revenue) * 100 : 0 
                    }))}
                    color="#86efac"
                    compact
                  />
                )}
                
                {mapping.operatingExpenseTotal && (
                  <LineChart 
                    title="Operating Expense Total (% of Revenue)"
                    data={monthly.map(m => ({ 
                      month: m.month, 
                      value: m.revenue > 0 ? ((m.operatingExpenseTotal || 0) / m.revenue) * 100 : 0 
                    }))}
                    color="#3b82f6"
                    compact
                  />
                )}
                
                {mapping.opexPayroll && (
                  <LineChart 
                    title="OPEX Payroll (% of Revenue)"
                    data={monthly.map(m => ({ 
                      month: m.month, 
                      value: m.revenue > 0 ? ((m.opexPayroll || 0) / m.revenue) * 100 : 0 
                    }))}
                    color="#60a5fa"
                    compact
                  />
                )}
                
                {mapping.opexSalesMarketing && (
                  <LineChart 
                    title="Sales & Marketing (% of Revenue)"
                    data={monthly.map(m => ({ 
                      month: m.month, 
                      value: m.revenue > 0 ? ((m.opexSalesMarketing || 0) / m.revenue) * 100 : 0 
                    }))}
                    color="#93c5fd"
                    compact
                  />
                )}
                
                {mapping.rentLease && (
                  <LineChart 
                    title="Rent/Lease (% of Revenue)"
                    data={monthly.map(m => ({ 
                      month: m.month, 
                      value: m.revenue > 0 ? ((m.rentLease || 0) / m.revenue) * 100 : 0 
                    }))}
                    color="#8b5cf6"
                    compact
                  />
                )}
                
                {mapping.utilities && (
                  <LineChart 
                    title="Utilities (% of Revenue)"
                    data={monthly.map(m => ({ 
                      month: m.month, 
                      value: m.revenue > 0 ? ((m.utilities || 0) / m.revenue) * 100 : 0 
                    }))}
                    color="#a78bfa"
                    compact
                  />
                )}
                
                {mapping.equipment && (
                  <LineChart 
                    title="Equipment (% of Revenue)"
                    data={monthly.map(m => ({ 
                      month: m.month, 
                      value: m.revenue > 0 ? ((m.equipment || 0) / m.revenue) * 100 : 0 
                    }))}
                    color="#c4b5fd"
                    compact
                  />
                )}
                
                {mapping.travel && (
                  <LineChart 
                    title="Travel (% of Revenue)"
                    data={monthly.map(m => ({ 
                      month: m.month, 
                      value: m.revenue > 0 ? ((m.travel || 0) / m.revenue) * 100 : 0 
                    }))}
                    color="#ec4899"
                    compact
                  />
                )}
                
                {mapping.professionalServices && (
                  <LineChart 
                    title="Professional Services (% of Revenue)"
                    data={monthly.map(m => ({ 
                      month: m.month, 
                      value: m.revenue > 0 ? ((m.professionalServices || 0) / m.revenue) * 100 : 0 
                    }))}
                    color="#f472b6"
                    compact
                  />
                )}
                
                {mapping.insurance && (
                  <LineChart 
                    title="Insurance (% of Revenue)"
                    data={monthly.map(m => ({ 
                      month: m.month, 
                      value: m.revenue > 0 ? ((m.insurance || 0) / m.revenue) * 100 : 0 
                    }))}
                    color="#f9a8d4"
                    compact
                  />
                )}
                
                {mapping.ownersBasePay && (
                  <LineChart 
                    title="Owners Base Pay (% of Revenue)"
                    data={monthly.map(m => ({ 
                      month: m.month, 
                      value: m.revenue > 0 ? ((m.ownersBasePay || 0) / m.revenue) * 100 : 0 
                    }))}
                    color="#14b8a6"
                    compact
                  />
                )}
                
                {mapping.ownersRetirement && (
                  <LineChart 
                    title="Owners Retirement (% of Revenue)"
                    data={monthly.map(m => ({ 
                      month: m.month, 
                      value: m.revenue > 0 ? ((m.ownersRetirement || 0) / m.revenue) * 100 : 0 
                    }))}
                    color="#2dd4bf"
                    compact
                  />
                )}
                
                {mapping.contractorsDistribution && (
                  <LineChart 
                    title="Contractors/Distribution (% of Revenue)"
                    data={monthly.map(m => ({ 
                      month: m.month, 
                      value: m.revenue > 0 ? ((m.contractorsDistribution || 0) / m.revenue) * 100 : 0 
                    }))}
                    color="#5eead4"
                    compact
                  />
                )}
                
                {mapping.interestExpense && (
                  <LineChart 
                    title="Interest Expense (% of Revenue)"
                    data={monthly.map(m => ({ 
                      month: m.month, 
                      value: m.revenue > 0 ? ((m.interestExpense || 0) / m.revenue) * 100 : 0 
                    }))}
                    color="#fb7185"
                    compact
                  />
                )}
                
                {mapping.depreciationExpense && (
                  <LineChart 
                    title="Depreciation Expense (% of Revenue)"
                    data={monthly.map(m => ({ 
                      month: m.month, 
                      value: m.revenue > 0 ? ((m.depreciationExpense || 0) / m.revenue) * 100 : 0 
                    }))}
                    color="#fca5a5"
                    compact
                  />
                )}
                
                {mapping.opexOther && (
                  <LineChart 
                    title="OPEX Other (% of Revenue)"
                    data={monthly.map(m => ({ 
                      month: m.month, 
                      value: m.revenue > 0 ? ((m.opexOther || 0) / m.revenue) * 100 : 0 
                    }))}
                    color="#fecaca"
                    compact
                  />
                )}
              </div>
            </div>
          )}
        </div>
      )}

      {/* Financial Score - Introduction View */}
      {currentView === 'fs-intro' && (
        <div style={{ maxWidth: '1200px', margin: '0 auto', padding: '32px' }}>
          <div style={{ background: 'white', borderRadius: '12px', padding: '40px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
            <h1 style={{ fontSize: '36px', fontWeight: '700', color: '#1e293b', marginBottom: '32px', textAlign: 'center' }}>Introduction to the Venturis Financial Score</h1>
            
            <div style={{ fontSize: '16px', color: '#475569', lineHeight: '1.8', maxWidth: '900px', margin: '0 auto' }}>
              <p style={{ marginBottom: '20px' }}>
                We would like to introduce to you the emerging standard score for small and medium businesses. It is called the <strong>Venturis Financial Score (VFS)</strong>. On a scale of 1 to 100, 100 indicates a company that is firing on all cylinders and building value at a steady clip; a score of zero indicates no operations. The scores in between have a lot to say about the general health of any company being measured.
              </p>
              
              <p style={{ marginBottom: '32px' }}>
                The score tells a lot about a company's financial stability and their potential value in the market regardless of specific industry.
              </p>
              
              <div style={{ background: '#f8fafc', borderRadius: '12px', padding: '32px', marginBottom: '32px' }}>
                <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '12px' }}>Approximate Interpretation of Venturis Financial Scores:</h2>
                
                <div style={{ display: 'grid', gap: '20px' }}>
                  <div style={{ background: '#d1fae5', borderRadius: '8px', padding: '20px', border: '2px solid #10b981' }}>
                    <div style={{ fontSize: '20px', fontWeight: '700', color: '#065f46', marginBottom: '12px' }}>70 – 100: Strong Financial Performance</div>
                    <ul style={{ margin: 0, paddingLeft: '20px', color: '#064e3b', fontSize: '15px', lineHeight: '1.6' }}>
                      <li>Good growth and good balance</li>
                      <li>In a good position for considering an M&A transaction</li>
                      <li>Excellent time to expand offerings and invest in R&D</li>
                    </ul>
                  </div>
                  
                  <div style={{ background: '#dbeafe', borderRadius: '8px', padding: '20px', border: '2px solid #3b82f6' }}>
                    <div style={{ fontSize: '20px', fontWeight: '700', color: '#1e40af', marginBottom: '12px' }}>50 – 70: Good Fundamentals</div>
                    <ul style={{ margin: 0, paddingLeft: '20px', color: '#1e3a8a', fontSize: '15px', lineHeight: '1.6' }}>
                      <li>In a good position for revenue growth</li>
                      <li>Needs to focus on bringing costs down as volume grows</li>
                    </ul>
                  </div>
                  
                  <div style={{ background: '#fef3c7', borderRadius: '8px', padding: '20px', border: '2px solid #f59e0b' }}>
                    <div style={{ fontSize: '20px', fontWeight: '700', color: '#92400e', marginBottom: '12px' }}>30 – 50: Basic Problems</div>
                    <ul style={{ margin: 0, paddingLeft: '20px', color: '#78350f', fontSize: '15px', lineHeight: '1.6' }}>
                      <li>Cost structure issues; not in a position to grow</li>
                      <li>Improvements needed in operations and process controls</li>
                      <li>Growth without operating improvements could do significant harm</li>
                    </ul>
                  </div>
                  
                  <div style={{ background: '#fee2e2', borderRadius: '8px', padding: '20px', border: '2px solid #ef4444' }}>
                    <div style={{ fontSize: '20px', fontWeight: '700', color: '#991b1b', marginBottom: '12px' }}>0 – 30: Serious Performance Problems</div>
                    <ul style={{ margin: 0, paddingLeft: '20px', color: '#7f1d1d', fontSize: '15px', lineHeight: '1.6' }}>
                      <li>Problems exist which may not be correctable</li>
                      <li>Some form of major restructuring or liquidation may be best</li>
                    </ul>
                  </div>
                </div>
              </div>
              
              <p style={{ marginBottom: '20px' }}>
                These scores are both <strong>diagnostic</strong> and <strong>prescriptive</strong>. They are diagnostic in that they identify a fundamental level of performance and related potential problems; prescriptive in that they point to specific actions that should be taken to remedy identified problems or take advantage of opportunities.
              </p>
              
              <div style={{ background: '#ede9fe', borderRadius: '12px', padding: '24px', marginTop: '32px' }}>
                <h3 style={{ fontSize: '20px', fontWeight: '600', color: '#5b21b6', marginBottom: '16px' }}>The Overall Score is Based On:</h3>
                <ul style={{ margin: 0, paddingLeft: '20px', color: '#6b21a8', fontSize: '15px', lineHeight: '1.8' }}>
                  <li>Long-term and short-term trends in revenue growth and expense growth</li>
                  <li>Trends in asset and liability growth</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      )}

      {/* Financial Score Trends View */}
      {currentView === 'fs-score' && selectedCompanyId && trendData.length > 0 && (
        <div style={{ maxWidth: '1400px', margin: '0 auto', padding: '32px' }}>
          <style>{`
            @media print {
              @page {
                size: portrait;
                margin: 0.3in;
              }
              
              /* Hide navigation and UI elements */
              .no-print,
              header,
              nav,
              aside,
              [role="navigation"],
              button {
                display: none !important;
              }
              
              /* Remove backgrounds and shadows for print */
              * {
                box-shadow: none !important;
              }
              
              /* Compress title and header */
              .fs-header h1 {
                font-size: 18px !important;
                margin-bottom: 8px !important;
              }
              
              .fs-header > div {
                font-size: 16px !important;
              }
              
              /* Compress main score cards */
              .fs-score-cards {
                margin-bottom: 12px !important;
                gap: 10px !important;
              }
              
              .fs-score-cards > div {
                padding: 10px !important;
                border-radius: 6px !important;
              }
              
              .fs-score-cards > div > div:first-child {
                font-size: 9px !important;
                margin-bottom: 4px !important;
              }
              
              .fs-score-cards > div > div:nth-child(2) {
                font-size: 22px !important;
              }
              
              /* Compress detail cards */
              .fs-detail-cards {
                gap: 8px !important;
                margin-bottom: 12px !important;
              }
              
              .fs-detail-cards > div {
                padding: 8px !important;
              }
              
              .fs-detail-cards > div > div:first-child {
                font-size: 8px !important;
              }
              
              .fs-detail-cards > div > div:nth-child(2) {
                font-size: 14px !important;
              }
              
              .fs-detail-cards > div > div:last-child {
                font-size: 7px !important;
              }
              
              /* Compress chart grid */
              .fs-charts-grid {
                gap: 8px !important;
              }
              
              .fs-charts-grid > div {
                transform: scale(0.65);
                transform-origin: top left;
                width: 153.85%;
                height: 250px;
                margin-bottom: -69px;
              }
              
              /* Force page break after row 2 (after 4th chart) */
              .fs-charts-grid > div:nth-child(4) {
                page-break-after: always;
                break-after: page;
              }
              
              /* Show page 2 header only on print */
              .page-2-header {
                display: block !important;
                margin-top: 72px !important;
                padding-bottom: 72px !important;
              }
              
              h2 {
                font-size: 12px !important;
                margin-bottom: 8px !important;
              }
            }
          `}</style>
          
          <div className="fs-header" style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '32px' }}>
            <h1 style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b', margin: 0 }}>Financial Score Trends</h1>
            <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
              {companyName && <div style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b' }}>{companyName}</div>}
              <button 
                className="no-print"
                onClick={() => window.print()} 
                style={{ 
                  padding: '12px 24px', 
                  background: '#667eea', 
                  color: 'white', 
                  border: 'none', 
                  borderRadius: '8px', 
                  fontSize: '14px', 
                  fontWeight: '600', 
                  cursor: 'pointer',
                  boxShadow: '0 2px 8px rgba(102, 126, 234, 0.3)'
                }}>
                🖨️ Print
              </button>
            </div>
          </div>
          
          {monthly.length >= 24 && (
            <div style={{ background: 'white', borderRadius: '12px', padding: '24px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
              <h2 style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b', marginBottom: '12px' }}>Financial Score Analysis</h2>
              
              <div className="fs-score-cards" style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '20px', marginBottom: '32px', maxWidth: '900px' }}>
                <div style={{ background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)', borderRadius: '12px', padding: '20px', color: 'white', boxShadow: '0 4px 12px rgba(102,126,234,0.3)' }}>
                  <div style={{ fontSize: '14px', fontWeight: '600', marginBottom: '8px', opacity: 0.9 }}>Venturis Financial Score</div>
                  <div style={{ fontSize: '42px', fontWeight: '700' }}>{finalScore.toFixed(2)}</div>
                </div>
                <div style={{ background: '#f0fdf4', borderRadius: '12px', padding: '20px', border: '2px solid #86efac' }}>
                  <div style={{ fontSize: '14px', fontWeight: '600', color: '#166534', marginBottom: '8px' }}>Profitability Score</div>
                  <div style={{ fontSize: '42px', fontWeight: '700', color: '#10b981' }}>{profitabilityScore.toFixed(2)}</div>
                </div>
                <div style={{ background: '#ede9fe', borderRadius: '12px', padding: '20px', border: '2px solid #c4b5fd' }}>
                  <div style={{ fontSize: '14px', fontWeight: '600', color: '#5b21b6', marginBottom: '8px' }}>Asset Development Score</div>
                  <div style={{ fontSize: '42px', fontWeight: '700', color: '#8b5cf6' }}>{assetDevScore.toFixed(2)}</div>
                </div>
              </div>

              <div className="fs-detail-cards" style={{ display: 'grid', gridTemplateColumns: 'repeat(5, 1fr)', gap: '16px' }}>
                <div style={{ background: '#f8fafc', borderRadius: '8px', padding: '16px', border: '1px solid #e2e8f0' }}>
                  <div style={{ fontSize: '12px', fontWeight: '600', color: '#64748b', marginBottom: '4px' }}>Base RGS (24mo)</div>
                  <div style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b' }}>{baseRGS.toFixed(0)}</div>
                  <div style={{ fontSize: '11px', color: '#64748b', marginTop: '4px' }}>Growth: {growth_24mo.toFixed(1)}%</div>
                </div>
                <div style={{ background: '#f8fafc', borderRadius: '8px', padding: '16px', border: '1px solid #e2e8f0' }}>
                  <div style={{ fontSize: '12px', fontWeight: '600', color: '#64748b', marginBottom: '4px' }}>Adjusted RGS (6mo)</div>
                  <div style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b' }}>{adjustedRGS.toFixed(1)}</div>
                  <div style={{ fontSize: '11px', color: '#64748b', marginTop: '4px' }}>Growth: {growth_6mo.toFixed(1)}%</div>
                </div>
                <div style={{ background: '#f8fafc', borderRadius: '8px', padding: '16px', border: '1px solid #e2e8f0' }}>
                  <div style={{ fontSize: '12px', fontWeight: '600', color: '#64748b', marginBottom: '4px' }}>Expense Adjustment</div>
                  <div style={{ fontSize: '24px', fontWeight: '700', color: expenseAdjustment >= 0 ? '#10b981' : '#ef4444' }}>
                    {expenseAdjustment >= 0 ? '+' : ''}{expenseAdjustment}
                  </div>
                  <div style={{ fontSize: '11px', color: '#64748b', marginTop: '4px' }}>
                    {expenseAdjustment > 0 ? '✓ BONUS' : expenseAdjustment < 0 ? '✗ PENALTY' : 'NEUTRAL'}
                  </div>
                </div>
                <div style={{ background: '#f8fafc', borderRadius: '8px', padding: '16px', border: '1px solid #e2e8f0' }}>
                  <div style={{ fontSize: '12px', fontWeight: '600', color: '#64748b', marginBottom: '4px' }}>ALR-1 (Current)</div>
                  <div style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b' }}>{typeof alr1 === 'number' ? alr1.toFixed(2) : alr1}</div>
                </div>
                <div style={{ background: '#f8fafc', borderRadius: '8px', padding: '16px', border: '1px solid #e2e8f0' }}>
                  <div style={{ fontSize: '12px', fontWeight: '600', color: '#64748b', marginBottom: '4px' }}>ALR Growth %</div>
                  <div style={{ fontSize: '24px', fontWeight: '700', color: alrGrowth >= 0 ? '#10b981' : '#ef4444' }}>
                    {alrGrowth >= 0 ? '+' : ''}{alrGrowth.toFixed(1)}%
                  </div>
                </div>
              </div>
            </div>
          )}
          
          <div className="fs-charts-grid" style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '24px' }}>
            <LineChart title="Financial Score Trend" data={trendData} valueKey="financialScore" color="#667eea" compact />
            <LineChart title="Profitability Score Trend" data={trendData} valueKey="profitabilityScore" color="#10b981" compact />
            <LineChart title="Revenue Growth Score (RGS)" data={trendData} valueKey="rgs" color="#f59e0b" compact />
            <LineChart title="RGS with 6-Month Adjustment" data={trendData} valueKey="rgsAdj" color="#3b82f6" compact />
            
            {/* Page 2 Header - only visible in print */}
            <div className="page-2-header" style={{ display: 'none', gridColumn: '1 / -1', paddingBottom: '72px' }}>
              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                <h1 style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b', margin: 0 }}>Financial Score Trends (cont)</h1>
                {companyName && <div style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b' }}>{companyName}</div>}
              </div>
            </div>
            
            <LineChart title="Expense Adjustment" data={trendData} valueKey="expenseAdj" color="#8b5cf6" compact />
            <LineChart title="Asset Development Score (ADS)" data={trendData} valueKey="adsScore" color="#ec4899" compact />
            <LineChart title="ALR-1 (Asset-Liability Ratio)" data={trendData} valueKey="alr1" color="#14b8a6" compact />
            <LineChart title="ALR Growth %" data={trendData} valueKey="alrGrowth" color="#f97316" compact />
          </div>
        </div>
      )}

      {/* Formula Popup Modal */}
      {showFormulaPopup && KPI_FORMULAS[showFormulaPopup] && (
        <div 
          style={{ 
            position: 'fixed', 
            top: 0, 
            left: 0, 
            right: 0, 
            bottom: 0, 
            background: 'rgba(0, 0, 0, 0.5)', 
            zIndex: 9999, 
            display: 'flex', 
            alignItems: 'center', 
            justifyContent: 'center',
            padding: '20px'
          }}
          onClick={() => setShowFormulaPopup(null)}
        >
          <div 
            style={{ 
              background: 'white', 
              borderRadius: '16px', 
              padding: '32px', 
              maxWidth: '600px', 
              width: '100%',
              boxShadow: '0 20px 60px rgba(0,0,0,0.3)',
              maxHeight: '90vh',
              overflowY: 'auto'
            }}
            onClick={(e) => e.stopPropagation()}
          >
            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '12px' }}>
              <h2 style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b', margin: 0 }}>{showFormulaPopup}</h2>
              <button
                onClick={() => setShowFormulaPopup(null)}
                style={{
                  background: 'none',
                  border: 'none',
                  fontSize: '24px',
                  cursor: 'pointer',
                  color: '#94a3b8',
                  padding: '0',
                  lineHeight: 1
                }}
              >
                ×
              </button>
            </div>
            
            <div style={{ marginBottom: '20px' }}>
              <h3 style={{ fontSize: '14px', fontWeight: '600', color: '#64748b', marginBottom: '8px', textTransform: 'uppercase', letterSpacing: '0.05em' }}>Formula</h3>
              <div style={{ 
                background: '#f8fafc', 
                padding: '16px', 
                borderRadius: '8px', 
                fontSize: '18px', 
                fontWeight: '600', 
                color: '#1e293b',
                fontFamily: 'monospace',
                border: '2px solid #e2e8f0'
              }}>
                {KPI_FORMULAS[showFormulaPopup].formula}
              </div>
            </div>
            
            <div style={{ marginBottom: '20px' }}>
              <h3 style={{ fontSize: '14px', fontWeight: '600', color: '#64748b', marginBottom: '8px', textTransform: 'uppercase', letterSpacing: '0.05em' }}>Period Used</h3>
              <div style={{ 
                background: '#ede9fe', 
                padding: '12px 16px', 
                borderRadius: '8px', 
                fontSize: '15px', 
                color: '#5b21b6',
                fontWeight: '600',
                border: '1px solid #d8b4fe'
              }}>
                {KPI_FORMULAS[showFormulaPopup].period}
              </div>
            </div>
            
            <div>
              <h3 style={{ fontSize: '14px', fontWeight: '600', color: '#64748b', marginBottom: '8px', textTransform: 'uppercase', letterSpacing: '0.05em' }}>Description</h3>
              <p style={{ fontSize: '15px', lineHeight: '1.7', color: '#475569', margin: 0 }}>
                {KPI_FORMULAS[showFormulaPopup].description}
              </p>
            </div>
            
            <div style={{ marginTop: '24px', paddingTop: '20px', borderTop: '1px solid #e2e8f0' }}>
              <button
                onClick={() => setShowFormulaPopup(null)}
                style={{
                  width: '100%',
                  padding: '12px',
                  background: '#667eea',
                  color: 'white',
                  border: 'none',
                  borderRadius: '8px',
                  fontSize: '16px',
                  fontWeight: '600',
                  cursor: 'pointer',
                  transition: 'all 0.2s'
                }}
                onMouseOver={(e) => e.currentTarget.style.background = '#4f46e5'}
                onMouseOut={(e) => e.currentTarget.style.background = '#667eea'}
              >
                Close
              </button>
            </div>
          </div>
        </div>
      )}

      {/* KPI Dashboard View */}
      {currentView === 'kpis' && selectedCompanyId && trendData.length > 0 && (
        <div style={{ maxWidth: '1400px', margin: '0 auto', padding: '32px' }}>
          <style>{`
            @media print {
              @page {
                size: letter;
                margin: 0.375in 0.375in 0.75in 0.375in;
              }
              
              /* Hide navigation and UI elements */
              .no-print,
              header,
              nav,
              aside,
              [role="navigation"],
              button {
                display: none !important;
              }
              
              /* Show print header */
              .print-header {
                display: block !important;
              }
              
              /* Scale down charts proportionally and adjust spacing */
              .priority-ratios-print-content > div:last-child {
                display: grid !important;
                grid-template-columns: repeat(2, 1fr) !important;
                gap: 0px !important;
                row-gap: 0px !important;
              }
              
              .priority-ratios-print-content > div:last-child > div {
                transform: scale(0.75);
                transform-origin: top left;
                width: 133%;
                height: 265px;
                overflow: visible;
              }
              
              /* First row */
              .priority-ratios-print-content > div:last-child > div:nth-child(1),
              .priority-ratios-print-content > div:last-child > div:nth-child(2) {
                margin-bottom: 0px;
              }
              
              /* Second row */
              .priority-ratios-print-content > div:last-child > div:nth-child(3),
              .priority-ratios-print-content > div:last-child > div:nth-child(4) {
                margin-bottom: 0px;
              }
              
              /* Third row */
              .priority-ratios-print-content > div:last-child > div:nth-child(5),
              .priority-ratios-print-content > div:last-child > div:nth-child(6) {
                margin-bottom: 0;
              }
            }
            
            .print-header {
              display: none;
            }
          `}</style>
          <div className="no-print" style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '32px' }}>
            <h1 style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b', margin: 0 }}>KPI Dashboard</h1>
            {companyName && <div style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b' }}>{companyName}</div>}
          </div>
          
          {/* Benchmark Status Indicator */}
          {benchmarks.length > 0 ? (
            <div className="no-print" style={{ background: '#d1fae5', border: '1px solid #10b981', borderRadius: '8px', padding: '12px', marginBottom: '12px', fontSize: '13px', color: '#065f46' }}>
              ✓ Industry benchmarks loaded: {benchmarks.length} metrics for {benchmarks[0]?.industryName || 'Unknown Industry'} ({benchmarks[0]?.assetSizeCategory || 'N/A'})
            </div>
          ) : (
            <div className="no-print" style={{ background: '#fef2f2', border: '1px solid #ef4444', borderRadius: '8px', padding: '12px', marginBottom: '12px', fontSize: '13px', color: '#991b1b' }}>
              ⚠ No industry benchmarks loaded. {!getCurrentCompany()?.industrySector ? 'Please set the industry sector in Company Details.' : 'Benchmarks may not be available for this industry.'}
            </div>
          )}

          {/* Tab Navigation */}
          <div className="no-print" style={{ display: 'flex', gap: '8px', marginBottom: '32px', borderBottom: '2px solid #e2e8f0' }}>
            <button
              onClick={() => setKpiDashboardTab('all-ratios')}
              style={{
                padding: '12px 24px',
                background: kpiDashboardTab === 'all-ratios' ? '#667eea' : 'transparent',
                color: kpiDashboardTab === 'all-ratios' ? 'white' : '#64748b',
                border: 'none',
                borderBottom: kpiDashboardTab === 'all-ratios' ? '3px solid #667eea' : '3px solid transparent',
                fontSize: '16px',
                fontWeight: '600',
                cursor: 'pointer',
                borderRadius: '8px 8px 0 0',
                transition: 'all 0.2s'
              }}
            >
              All Ratios
            </button>
            <button
              onClick={() => setKpiDashboardTab('priority-ratios')}
              style={{
                padding: '12px 24px',
                background: kpiDashboardTab === 'priority-ratios' ? '#667eea' : 'transparent',
                color: kpiDashboardTab === 'priority-ratios' ? 'white' : '#64748b',
                border: 'none',
                borderBottom: kpiDashboardTab === 'priority-ratios' ? '3px solid #667eea' : '3px solid transparent',
                fontSize: '16px',
                fontWeight: '600',
                cursor: 'pointer',
                borderRadius: '8px 8px 0 0',
                transition: 'all 0.2s'
              }}
            >
              Priority Ratios
            </button>
          </div>

          {/* All Ratios Tab */}
          {kpiDashboardTab === 'all-ratios' && (
            <>
              <div style={{ marginBottom: '32px' }}>
                <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '16px' }}>Liquidity Ratios</h2>
                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '20px' }}>
                  <LineChart title="Current Ratio" data={trendData} valueKey="currentRatio" color="#10b981" compact benchmarkValue={getBenchmarkValue(benchmarks, 'Current Ratio')} formatter={(v) => v.toFixed(1)} showFormulaButton onFormulaClick={() => setShowFormulaPopup('Current Ratio')} />
                  <LineChart title="Quick Ratio" data={trendData} valueKey="quickRatio" color="#14b8a6" compact benchmarkValue={getBenchmarkValue(benchmarks, 'Quick Ratio')} formatter={(v) => v.toFixed(1)} showFormulaButton onFormulaClick={() => setShowFormulaPopup('Quick Ratio')} />
                </div>
              </div>

              <div style={{ marginBottom: '32px' }}>
                <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '16px' }}>Activity Ratios</h2>
                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '20px' }}>
                  <LineChart title="Inventory Turnover" data={trendData} valueKey="invTurnover" color="#f59e0b" compact benchmarkValue={getBenchmarkValue(benchmarks, 'Inventory Turnover')} formatter={(v) => v.toFixed(1)} showFormulaButton onFormulaClick={() => setShowFormulaPopup('Inventory Turnover')} />
                  <LineChart title="Receivables Turnover" data={trendData} valueKey="arTurnover" color="#f97316" compact benchmarkValue={getBenchmarkValue(benchmarks, 'Receivables Turnover')} formatter={(v) => v.toFixed(1)} showFormulaButton onFormulaClick={() => setShowFormulaPopup('Receivables Turnover')} />
                  <LineChart title="Payables Turnover" data={trendData} valueKey="apTurnover" color="#ef4444" compact benchmarkValue={getBenchmarkValue(benchmarks, 'Payables Turnover')} formatter={(v) => v.toFixed(1)} showFormulaButton onFormulaClick={() => setShowFormulaPopup('Payables Turnover')} />
                  <LineChart title="Days' Inventory" data={trendData} valueKey="daysInv" color="#fbbf24" compact benchmarkValue={getBenchmarkValue(benchmarks, 'Days Inventory')} formatter={(v) => v.toFixed(0)} showFormulaButton onFormulaClick={() => setShowFormulaPopup('Days\' Inventory')} />
                  <LineChart title="Days' Receivables" data={trendData} valueKey="daysAR" color="#fb923c" compact benchmarkValue={getBenchmarkValue(benchmarks, 'Days Receivables')} formatter={(v) => v.toFixed(0)} showFormulaButton onFormulaClick={() => setShowFormulaPopup('Days\' Receivables')} />
                  <LineChart title="Days' Payables" data={trendData} valueKey="daysAP" color="#f87171" compact benchmarkValue={getBenchmarkValue(benchmarks, 'Days Payables')} formatter={(v) => v.toFixed(0)} showFormulaButton onFormulaClick={() => setShowFormulaPopup('Days\' Payables')} />
                  <LineChart title="Sales/Working Capital" data={trendData} valueKey="salesWC" color="#06b6d4" compact benchmarkValue={getBenchmarkValue(benchmarks, 'Sales/Working Capital')} formatter={(v) => v.toFixed(1)} showFormulaButton onFormulaClick={() => setShowFormulaPopup('Sales/Working Capital')} />
                </div>
              </div>

              <div style={{ marginBottom: '32px' }}>
                <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '16px' }}>Coverage Ratios</h2>
                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '20px' }}>
                  <LineChart title="Interest Coverage" data={trendData} valueKey="interestCov" color="#8b5cf6" compact benchmarkValue={getBenchmarkValue(benchmarks, 'Interest Coverage')} formatter={(v) => v.toFixed(1)} showFormulaButton onFormulaClick={() => setShowFormulaPopup('Interest Coverage')} />
                  <LineChart title="Debt Service Coverage" data={trendData} valueKey="debtSvcCov" color="#a78bfa" compact benchmarkValue={getBenchmarkValue(benchmarks, 'Debt Service Coverage')} formatter={(v) => v.toFixed(1)} showFormulaButton onFormulaClick={() => setShowFormulaPopup('Debt Service Coverage')} />
                  <LineChart title="Cash Flow to Debt" data={trendData} valueKey="cfToDebt" color="#c4b5fd" compact benchmarkValue={getBenchmarkValue(benchmarks, 'Cash Flow to Debt')} formatter={(v) => v.toFixed(1)} showFormulaButton onFormulaClick={() => setShowFormulaPopup('Cash Flow to Debt')} />
                </div>
              </div>

              <div style={{ marginBottom: '32px' }}>
                <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '16px' }}>Leverage Ratios</h2>
                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '20px' }}>
                  <LineChart title="Debt/Net Worth" data={trendData} valueKey="debtToNW" color="#ec4899" compact benchmarkValue={getBenchmarkValue(benchmarks, 'Debt/Net Worth')} formatter={(v) => v.toFixed(1)} showFormulaButton onFormulaClick={() => setShowFormulaPopup('Debt/Net Worth')} />
                  <LineChart title="Fixed Assets/Net Worth" data={trendData} valueKey="fixedToNW" color="#f472b6" compact benchmarkValue={getBenchmarkValue(benchmarks, 'Fixed Assets/Net Worth')} formatter={(v) => v.toFixed(1)} showFormulaButton onFormulaClick={() => setShowFormulaPopup('Fixed Assets/Net Worth')} />
                  <LineChart title="Leverage Ratio" data={trendData} valueKey="leverage" color="#f9a8d4" compact benchmarkValue={getBenchmarkValue(benchmarks, 'Leverage Ratio')} formatter={(v) => v.toFixed(1)} showFormulaButton onFormulaClick={() => setShowFormulaPopup('Leverage Ratio')} />
                </div>
              </div>

              <div style={{ marginBottom: '32px' }}>
                <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '16px' }}>Operating Ratios</h2>
                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '20px' }}>
                  <LineChart title="Total Asset Turnover" data={trendData} valueKey="totalAssetTO" color="#3b82f6" compact benchmarkValue={getBenchmarkValue(benchmarks, 'Total Asset Turnover')} formatter={(v) => v.toFixed(1)} showFormulaButton onFormulaClick={() => setShowFormulaPopup('Total Asset Turnover')} />
                  <LineChart title="Return on Equity (ROE)" data={trendData} valueKey="roe" color="#60a5fa" compact benchmarkValue={getBenchmarkValue(benchmarks, 'ROE')} formatter={(v) => v.toFixed(1)} showFormulaButton onFormulaClick={() => setShowFormulaPopup('Return on Equity (ROE)')} />
                  <LineChart title="Return on Assets (ROA)" data={trendData} valueKey="roa" color="#93c5fd" compact benchmarkValue={getBenchmarkValue(benchmarks, 'ROA')} formatter={(v) => v.toFixed(1)} showFormulaButton onFormulaClick={() => setShowFormulaPopup('Return on Assets (ROA)')} />
                  <LineChart title="EBITDA Margin" data={trendData} valueKey="ebitdaMargin" color="#2563eb" compact benchmarkValue={getBenchmarkValue(benchmarks, 'EBITDA/Revenue')} formatter={(v) => v.toFixed(1)} showFormulaButton onFormulaClick={() => setShowFormulaPopup('EBITDA Margin')} />
                  <LineChart title="EBIT Margin" data={trendData} valueKey="ebitMargin" color="#1e40af" compact benchmarkValue={getBenchmarkValue(benchmarks, 'EBIT/Revenue')} formatter={(v) => v.toFixed(1)} showFormulaButton onFormulaClick={() => setShowFormulaPopup('EBIT Margin')} />
                </div>
              </div>
            </>
          )}

          {/* Priority Ratios Tab */}
          {kpiDashboardTab === 'priority-ratios' && (
            <div>
              <div className="no-print" style={{ marginBottom: '12px', padding: '20px', background: '#f8fafc', borderRadius: '12px', border: '1px solid #e2e8f0' }}>
                <h3 style={{ fontSize: '18px', fontWeight: '600', color: '#1e293b', marginBottom: '8px' }}>Customize Your Priority Ratios</h3>
                <p style={{ fontSize: '14px', color: '#64748b', marginBottom: '16px' }}>
                  Select up to 6 ratios to track as your priority KPIs. These selections will be saved and persist across sessions.
                </p>
                {/* Updated layout - more compact and horizontal */}
                
                <div style={{ display: 'flex', flexWrap: 'wrap', gap: '12px', marginBottom: '16px' }}>
                  {Object.entries(ratioCategories).map(([category, ratios]) => (
                    <div key={category} style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
                      <label style={{ fontSize: '12px', fontWeight: '600', color: '#374151', whiteSpace: 'nowrap' }}>
                        {category}:
                      </label>
                      <select
                        value={priorityRatios.find(ratio => ratios.includes(ratio)) || ''}
                        onChange={(e) => {
                          const newRatio = e.target.value;
                          if (newRatio) {
                            const currentRatioFromCategory = priorityRatios.find(ratio => ratios.includes(ratio));
                            if (currentRatioFromCategory) {
                              // Replace existing ratio from this category
                              setPriorityRatios(prev => prev.map(ratio => 
                                ratio === currentRatioFromCategory ? newRatio : ratio
                              ));
                            } else if (priorityRatios.length < 6) {
                              // Add new ratio if under limit
                              setPriorityRatios(prev => [...prev, newRatio]);
                            } else {
                              alert('Maximum of 6 priority ratios allowed. Please remove one first.');
                            }
                          }
                        }}
                        style={{
                          padding: '6px 8px',
                          border: '1px solid #d1d5db',
                          borderRadius: '4px',
                          fontSize: '12px',
                          background: 'white',
                          minWidth: '140px'
                        }}
                      >
                        <option value="">Select...</option>
                        {ratios.map(ratio => (
                          <option key={ratio} value={ratio}>
                            {ratio}
                          </option>
                        ))}
                      </select>
                    </div>
                  ))}
                </div>

                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                  <div style={{ fontSize: '12px', color: '#64748b' }}>
                    Selected: {priorityRatios.length}/6 ratios
                  </div>
                  <button
                    onClick={savePriorityRatios}
                    style={{
                      padding: '6px 12px',
                      background: '#667eea',
                      color: 'white',
                      border: 'none',
                      borderRadius: '4px',
                      fontSize: '12px',
                      fontWeight: '600',
                      cursor: 'pointer'
                    }}
                  >
                    Save
                  </button>
                </div>
              </div>

              {/* Display Selected Priority Ratios */}
              {priorityRatios.length > 0 && (
                <div>
                  <div className="no-print" style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>
                    <h3 style={{ fontSize: '20px', fontWeight: '600', color: '#1e293b', margin: 0 }}>
                      Your Priority Ratios ({priorityRatios.length}/6)
                    </h3>
                    <button
                      onClick={() => window.print()}
                      style={{
                        padding: '10px 20px',
                        background: '#10b981',
                        color: 'white',
                        border: 'none',
                        borderRadius: '8px',
                        fontSize: '14px',
                        fontWeight: '600',
                        cursor: 'pointer',
                        display: 'flex',
                        alignItems: 'center',
                        gap: '8px'
                      }}
                    >
                      🖨️ Print Priority Ratios
                    </button>
                  </div>
                  <div className="priority-ratios-print-content">
                    <div className="print-header" style={{ display: 'none' }}>
                      <h1 style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b', marginBottom: '12px', marginTop: '0', textAlign: 'center' }}>
                        Priority Ratios {companyName && `- ${companyName}`}
                      </h1>
                    </div>
                    <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '20px' }}>
                    {priorityRatios.map((ratio, index) => (
                      <div key={ratio} style={{ position: 'relative' }}>
                        <LineChart
                          title={ratio}
                          data={trendData}
                          valueKey={getRatioValueKey(ratio)}
                          color={getRatioColor(ratio)}
                          compact
                          benchmarkValue={getBenchmarkValue(benchmarks, ratio)}
                          formatter={getRatioFormatter(ratio)}
                          showFormulaButton
                          onFormulaClick={() => setShowFormulaPopup(ratio)}
                        />
                        <button
                          onClick={() => setPriorityRatios(prev => prev.filter((_, i) => i !== index))}
                          className="no-print"
                          style={{
                            position: 'absolute',
                            top: '8px',
                            right: '8px',
                            background: '#ef4444',
                            color: 'white',
                            border: 'none',
                            borderRadius: '50%',
                            width: '24px',
                            height: '24px',
                            fontSize: '12px',
                            cursor: 'pointer',
                            display: 'flex',
                            alignItems: 'center',
                            justifyContent: 'center'
                          }}
                        >
                          ×
                        </button>
                      </div>
                    ))}
                    </div>
                  </div>
                </div>
              )}

              {priorityRatios.length === 0 && (
                <div style={{ textAlign: 'center', padding: '60px', color: '#64748b' }}>
                  <div style={{ fontSize: '48px', marginBottom: '16px' }}>📊</div>
                  <h3 style={{ fontSize: '20px', fontWeight: '600', marginBottom: '8px' }}>No Priority Ratios Selected</h3>
                  <p>Select ratios from the dropdowns above to create your custom KPI dashboard.</p>
                </div>
              )}
            </div>
          )}
        </div>
      )}

      {/* MD&A View */}
      {currentView === 'mda' && selectedCompanyId && trendData.length > 0 && (
        <div style={{ maxWidth: '1400px', margin: '0 auto', padding: '32px' }}>
          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '32px' }}>
            <h1 style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b', margin: 0 }}>Management Discussion & Analysis</h1>
            <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
              {companyName && <div style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b' }}>{companyName}</div>}
              <button 
                className="no-print"
                onClick={() => window.print()} 
                style={{ 
                  padding: '12px 24px', 
                  background: '#667eea', 
                  color: 'white', 
                  border: 'none', 
                  borderRadius: '8px', 
                  fontSize: '14px', 
                  fontWeight: '600', 
                  cursor: 'pointer',
                  boxShadow: '0 2px 8px rgba(102, 126, 234, 0.3)'
                }}>
                🖨️ Print
              </button>
            </div>
          </div>
          
          <style>{`
            @media print {
              @page {
                size: portrait;
                margin: 0.5in;
              }
              
              /* Hide navigation and UI elements */
              .no-print,
              header,
              nav,
              aside,
              [role="navigation"] {
                display: none !important;
              }
              
              /* Hide tab navigation buttons */
              button[onclick*="setMdaTab"] {
                display: none !important;
              }
              
              /* Remove box shadows and backgrounds */
              * {
                box-shadow: none !important;
              }
              
              /* Ensure text is readable */
              body, p, li, div {
                color: #000 !important;
              }
              
              h1, h2, h3 {
                page-break-after: avoid;
              }
              
              /* Avoid breaking inside sections */
              div[style*="background: white"] {
                page-break-inside: avoid;
              }
            }
          `}</style>
          
          {/* Tab Navigation */}
          <div className="no-print" style={{ display: 'flex', gap: '8px', marginBottom: '12px', borderBottom: '2px solid #e2e8f0' }}>
            <button
              onClick={() => setMdaTab('executive-summary')}
              style={{
                padding: '12px 24px',
                background: mdaTab === 'executive-summary' ? '#667eea' : 'transparent',
                color: mdaTab === 'executive-summary' ? 'white' : '#64748b',
                border: 'none',
                borderBottom: mdaTab === 'executive-summary' ? '3px solid #667eea' : '3px solid transparent',
                fontSize: '16px',
                fontWeight: '600',
                cursor: 'pointer',
                borderRadius: '8px 8px 0 0',
                transition: 'all 0.2s'
              }}
            >
              Executive Summary
            </button>
            <button
              onClick={() => setMdaTab('strengths-insights')}
              style={{
                padding: '12px 24px',
                background: mdaTab === 'strengths-insights' ? '#667eea' : 'transparent',
                color: mdaTab === 'strengths-insights' ? 'white' : '#64748b',
                border: 'none',
                borderBottom: mdaTab === 'strengths-insights' ? '3px solid #667eea' : '3px solid transparent',
                fontSize: '16px',
                fontWeight: '600',
                cursor: 'pointer',
                borderRadius: '8px 8px 0 0',
                transition: 'all 0.2s'
              }}
            >
              Strengths and Insights
            </button>
            <button
              onClick={() => setMdaTab('key-metrics')}
              style={{
                padding: '12px 24px',
                background: mdaTab === 'key-metrics' ? '#667eea' : 'transparent',
                color: mdaTab === 'key-metrics' ? 'white' : '#64748b',
                border: 'none',
                borderBottom: mdaTab === 'key-metrics' ? '3px solid #667eea' : '3px solid transparent',
                fontSize: '16px',
                fontWeight: '600',
                cursor: 'pointer',
                borderRadius: '8px 8px 0 0',
                transition: 'all 0.2s'
              }}
            >
              Critical Review Items
            </button>
          </div>

          {/* Executive Summary Tab */}
          {mdaTab === 'executive-summary' && (
          <div style={{ background: 'white', borderRadius: '12px', padding: '32px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
            <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '12px', borderBottom: '2px solid #e2e8f0', paddingBottom: '12px' }}>Executive Summary</h2>
            
            {/* Overview Metrics */}
            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: '16px', marginBottom: '32px', padding: '20px', background: '#f8fafc', borderRadius: '8px' }}>
              <div style={{ textAlign: 'center' }}>
                <div style={{ fontSize: '12px', color: '#64748b', marginBottom: '4px', fontWeight: '600' }}>Financial Score</div>
                <div style={{ fontSize: '28px', fontWeight: '700', color: finalScore >= 70 ? '#10b981' : finalScore >= 50 ? '#f59e0b' : '#ef4444' }}>{finalScore.toFixed(1)}</div>
                <div style={{ fontSize: '11px', color: '#94a3b8' }}>Overall Health</div>
              </div>
              <div style={{ textAlign: 'center' }}>
                <div style={{ fontSize: '12px', color: '#64748b', marginBottom: '4px', fontWeight: '600' }}>24-Mo Growth</div>
                <div style={{ fontSize: '28px', fontWeight: '700', color: growth_24mo > 10 ? '#10b981' : growth_24mo > 0 ? '#f59e0b' : '#ef4444' }}>{growth_24mo.toFixed(1)}%</div>
                <div style={{ fontSize: '11px', color: '#94a3b8' }}>Revenue Trend</div>
              </div>
              <div style={{ textAlign: 'center' }}>
                <div style={{ fontSize: '12px', color: '#64748b', marginBottom: '4px', fontWeight: '600' }}>Current Ratio</div>
                <div style={{ fontSize: '28px', fontWeight: '700', color: trendData[trendData.length - 1]?.currentRatio >= 1.5 ? '#10b981' : trendData[trendData.length - 1]?.currentRatio >= 1.0 ? '#f59e0b' : '#ef4444' }}>
                  {trendData[trendData.length - 1]?.currentRatio?.toFixed(1)}
                </div>
                <div style={{ fontSize: '11px', color: '#94a3b8' }}>Liquidity</div>
              </div>
              <div style={{ textAlign: 'center' }}>
                <div style={{ fontSize: '12px', color: '#64748b', marginBottom: '4px', fontWeight: '600' }}>Benchmarks</div>
                <div style={{ fontSize: '28px', fontWeight: '700', color: benchmarks.length > 0 ? '#667eea' : '#94a3b8' }}>{benchmarks.length}</div>
                <div style={{ fontSize: '11px', color: '#94a3b8' }}>Available</div>
              </div>
            </div>

            {/* Comprehensive Analysis Narrative */}
            <div style={{ marginBottom: '28px' }}>
              <h3 style={{ fontSize: '18px', fontWeight: '600', color: '#1e293b', marginBottom: '16px', display: 'flex', alignItems: 'center', gap: '8px' }}>
                <span style={{ fontSize: '20px' }}>📊</span> Financial Performance Overview
              </h3>
              <div style={{ fontSize: '15px', lineHeight: '1.8', color: '#475569', background: '#f8fafc', padding: '20px', borderRadius: '8px', borderLeft: '4px solid #667eea' }}>
                <p style={{ margin: '0 0 12px 0' }}>
                  {companyName || 'The company'} has achieved a Financial Score of <strong style={{ color: '#1e293b' }}>{finalScore.toFixed(1)}</strong>, indicating <strong>{finalScore >= 70 ? 'strong' : finalScore >= 50 ? 'moderate' : 'developing'}</strong> overall financial health. 
                  The analysis encompasses {monthly.length} months of financial data, providing comprehensive insights into operational performance, liquidity position, and strategic positioning.
                </p>
                <p style={{ margin: '12px 0 0 0' }}>
                  Over the past 24 months, revenue has {growth_24mo > 0 ? 'grown' : 'declined'} by <strong style={{ color: growth_24mo > 0 ? '#10b981' : '#ef4444' }}>{Math.abs(growth_24mo).toFixed(1)}%</strong>, 
                  with profitability score of <strong style={{ color: '#1e293b' }}>{profitabilityScore.toFixed(1)}</strong> and asset development score of <strong style={{ color: '#1e293b' }}>{assetDevScore.toFixed(1)}</strong>. 
                  {benchmarks.length > 0 ? ` Industry benchmark comparisons against ${benchmarks.length} metrics reveal ${mdaAnalysis.strengths.filter((s: string) => s.includes('industry')).length} areas of superior performance and ${mdaAnalysis.weaknesses.filter((w: string) => w.includes('industry')).length} opportunities for improvement relative to industry peers.` : ''}
                </p>
              </div>
            </div>
            
            <div style={{ marginBottom: '12px' }}>
              <h3 style={{ fontSize: '18px', fontWeight: '600', color: '#10b981', marginBottom: '12px', display: 'flex', alignItems: 'center', gap: '8px' }}>
                <span style={{ fontSize: '20px' }}>✓</span> Key Strengths & Competitive Advantages
              </h3>
              <div style={{ fontSize: '15px', lineHeight: '1.8', color: '#1e293b' }}>
                {mdaAnalysis.strengths.length > 0 ? (
                  <ul style={{ margin: 0, paddingLeft: '24px' }}>
                    {mdaAnalysis.strengths.map((str: string, idx: number) => (
                      <li key={idx} style={{ marginBottom: '8px' }}>{str}</li>
                    ))}
                  </ul>
                ) : (
                  <p style={{ margin: 0, color: '#64748b' }}>The company is showing stable financial performance across key metrics. Continued monitoring will help identify emerging strengths.</p>
                )}
              </div>
            </div>

            <div style={{ marginBottom: '12px' }}>
              <h3 style={{ fontSize: '18px', fontWeight: '600', color: '#ef4444', marginBottom: '12px', display: 'flex', alignItems: 'center', gap: '8px' }}>
                <span style={{ fontSize: '20px' }}>⚠</span> Areas Requiring Management Attention
              </h3>
              <div style={{ fontSize: '15px', lineHeight: '1.8', color: '#1e293b' }}>
                {mdaAnalysis.weaknesses.length > 0 ? (
                  <ul style={{ margin: 0, paddingLeft: '24px' }}>
                    {mdaAnalysis.weaknesses.map((weak: string, idx: number) => (
                      <li key={idx} style={{ marginBottom: '8px' }}>{weak}</li>
                    ))}
                  </ul>
                ) : (
                  <p style={{ margin: 0, color: '#64748b' }}>Continue monitoring key financial indicators to maintain current performance levels and identify potential challenges early.</p>
                )}
              </div>
            </div>

            <div>
              <h3 style={{ fontSize: '18px', fontWeight: '600', color: '#667eea', marginBottom: '12px', display: 'flex', alignItems: 'center', gap: '8px' }}>
                <span style={{ fontSize: '20px' }}>💡</span> Strategic Recommendations & Action Items
              </h3>
              <div style={{ fontSize: '15px', lineHeight: '1.8', color: '#1e293b' }}>
                {mdaAnalysis.insights.length > 0 ? (
                  <ul style={{ margin: 0, paddingLeft: '24px' }}>
                    {mdaAnalysis.insights.map((ins: string, idx: number) => (
                      <li key={idx} style={{ marginBottom: '8px' }}>{ins}</li>
                    ))}
                  </ul>
                ) : (
                  <p style={{ margin: 0, color: '#64748b' }}>Regular review of financial metrics and strategic planning will support continued growth and financial stability.</p>
                )}
              </div>
            </div>
          </div>
          )}

          {/* Strengths and Insights Tab */}
          {mdaTab === 'strengths-insights' && (
          <div style={{ display: 'grid', gap: '24px' }}>
            {mdaAnalysis.strengths.length > 0 && (
              <div style={{ background: 'white', borderRadius: '12px', padding: '24px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                <h3 style={{ fontSize: '20px', fontWeight: '600', color: '#10b981', marginBottom: '16px', display: 'flex', alignItems: 'center', gap: '8px' }}>
                  <span style={{ fontSize: '24px' }}>✓</span> Strengths
                </h3>
                <ul style={{ listStyle: 'none', padding: 0, margin: 0 }}>
                  {mdaAnalysis.strengths.map((str, idx) => (
                    <li key={idx} style={{ padding: '12px 16px', background: '#f0fdf4', borderRadius: '8px', marginBottom: '8px', borderLeft: '4px solid #10b981', fontSize: '14px', color: '#166534' }}>{str}</li>
                  ))}
                </ul>
              </div>
            )}

            {mdaAnalysis.weaknesses.length > 0 && (
              <div style={{ background: 'white', borderRadius: '12px', padding: '24px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                <h3 style={{ fontSize: '20px', fontWeight: '600', color: '#ef4444', marginBottom: '16px', display: 'flex', alignItems: 'center', gap: '8px' }}>
                  <span style={{ fontSize: '24px' }}>⚠</span> Areas for Improvement
                </h3>
                <ul style={{ listStyle: 'none', padding: 0, margin: 0 }}>
                  {mdaAnalysis.weaknesses.map((weak, idx) => (
                    <li key={idx} style={{ padding: '12px 16px', background: '#fef2f2', borderRadius: '8px', marginBottom: '8px', borderLeft: '4px solid #ef4444', fontSize: '14px', color: '#991b1b' }}>{weak}</li>
                  ))}
                </ul>
              </div>
            )}

            {mdaAnalysis.insights.length > 0 && (
              <div style={{ background: 'white', borderRadius: '12px', padding: '24px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                <h3 style={{ fontSize: '20px', fontWeight: '600', color: '#667eea', marginBottom: '16px', display: 'flex', alignItems: 'center', gap: '8px' }}>
                  <span style={{ fontSize: '24px' }}>💡</span> Strategic Insights
                </h3>
                <ul style={{ listStyle: 'none', padding: 0, margin: 0 }}>
                  {mdaAnalysis.insights.map((ins, idx) => (
                    <li key={idx} style={{ padding: '12px 16px', background: '#ede9fe', borderRadius: '8px', marginBottom: '8px', borderLeft: '4px solid #667eea', fontSize: '14px', color: '#5b21b6' }}>{ins}</li>
                  ))}
                </ul>
              </div>
            )}
          </div>
          )}

          {/* Critical Review Items Tab */}
          {mdaTab === 'key-metrics' && monthly.length >= 12 && (
          <div style={{ background: 'white', borderRadius: '12px', padding: '32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
            <h2 style={{ fontSize: '28px', fontWeight: '700', color: '#1e293b', marginBottom: '12px', borderBottom: '3px solid #ef4444', paddingBottom: '12px' }}>
              ⚠️ Critical Review Items
            </h2>
            
            <p style={{ fontSize: '15px', color: '#64748b', marginBottom: '32px', lineHeight: '1.6' }}>
              This analysis reviews all financial data across Trend Analysis, KPI Dashboard, Working Capital, and Cash Flow to identify issues requiring immediate attention.
            </p>

            {(() => {
              const issues: { category: string; severity: 'high' | 'medium' | 'low'; title: string; description: string; metric?: string }[] = [];
              const last = monthly[monthly.length - 1];
              const prev = monthly.length >= 2 ? monthly[monthly.length - 2] : last;
              const last12 = monthly.slice(-12);
              const prev12 = monthly.length >= 24 ? monthly.slice(-24, -12) : last12;

              // === REVENUE TREND ANALYSIS ===
              const revenueGrowth12mo = prev12.length > 0 ? 
                ((last12.reduce((s, m) => s + m.revenue, 0) - prev12.reduce((s, m) => s + m.revenue, 0)) / prev12.reduce((s, m) => s + m.revenue, 0)) * 100 : 0;
              
              if (revenueGrowth12mo < -5) {
                issues.push({
                  category: 'Revenue Trends',
                  severity: 'high',
                  title: 'Declining Revenue',
                  description: `Revenue has declined by ${Math.abs(revenueGrowth12mo).toFixed(1)}% over the past 12 months. This indicates potential market share loss, pricing pressure, or customer attrition.`,
                  metric: `${revenueGrowth12mo.toFixed(1)}%`
                });
              }

              // Check revenue volatility
              const revenueStdDev = (() => {
                const mean = last12.reduce((s, m) => s + m.revenue, 0) / last12.length;
                const variance = last12.reduce((s, m) => s + Math.pow(m.revenue - mean, 2), 0) / last12.length;
                return Math.sqrt(variance);
              })();
              const revenueCV = (revenueStdDev / (last12.reduce((s, m) => s + m.revenue, 0) / last12.length)) * 100;
              
              if (revenueCV > 25) {
                issues.push({
                  category: 'Revenue Trends',
                  severity: 'medium',
                  title: 'High Revenue Volatility',
                  description: `Revenue shows high volatility (${revenueCV.toFixed(1)}% coefficient of variation). This indicates inconsistent sales performance and unpredictable cash flow.`,
                  metric: `${revenueCV.toFixed(1)}% CV`
                });
              }

              // === EXPENSE ANALYSIS ===
              const expenseGrowth12mo = prev12.length > 0 ?
                ((last12.reduce((s, m) => s + m.expense, 0) - prev12.reduce((s, m) => s + m.expense, 0)) / prev12.reduce((s, m) => s + m.expense, 0)) * 100 : 0;
              
              if (expenseGrowth12mo > revenueGrowth12mo + 5) {
                issues.push({
                  category: 'Expense Control',
                  severity: 'high',
                  title: 'Expenses Growing Faster Than Revenue',
                  description: `Expenses have grown ${expenseGrowth12mo.toFixed(1)}% while revenue grew ${revenueGrowth12mo.toFixed(1)}%. This margin compression threatens profitability and requires immediate cost control measures.`,
                  metric: `${(expenseGrowth12mo - revenueGrowth12mo).toFixed(1)}% gap`
                });
              }

              // Expense as % of revenue trending
              const expenseRatio = (last.expense / last.revenue) * 100;
              const prevExpenseRatio = prev12.length > 0 ? (prev12.reduce((s, m) => s + m.expense, 0) / prev12.reduce((s, m) => s + m.revenue, 0)) * 100 : expenseRatio;
              
              if (expenseRatio > 90) {
                issues.push({
                  category: 'Expense Control',
                  severity: 'high',
                  title: 'Extremely High Expense Ratio',
                  description: `Total expenses represent ${expenseRatio.toFixed(1)}% of revenue, leaving minimal profit margin. The business is operating near break-even or at a loss.`,
                  metric: `${expenseRatio.toFixed(1)}%`
                });
              } else if (expenseRatio - prevExpenseRatio > 5) {
                issues.push({
                  category: 'Expense Control',
                  severity: 'medium',
                  title: 'Rising Expense Ratio',
                  description: `Expenses as a percentage of revenue have increased from ${prevExpenseRatio.toFixed(1)}% to ${expenseRatio.toFixed(1)}%, indicating deteriorating operational efficiency.`,
                  metric: `+${(expenseRatio - prevExpenseRatio).toFixed(1)}%`
                });
              }

              // === LIQUIDITY & RATIOS ===
              if (last.currentRatio < 1.0) {
                issues.push({
                  category: 'Liquidity',
                  severity: 'high',
                  title: 'Critical Liquidity Position',
                  description: `Current ratio of ${last.currentRatio.toFixed(2)} indicates current liabilities exceed current assets. The company may struggle to meet short-term obligations.`,
                  metric: `${last.currentRatio.toFixed(2)}`
                });
              } else if (last.currentRatio < 1.2) {
                issues.push({
                  category: 'Liquidity',
                  severity: 'medium',
                  title: 'Weak Liquidity Position',
                  description: `Current ratio of ${last.currentRatio.toFixed(2)} is below the healthy threshold of 1.5, indicating potential difficulty covering short-term obligations.`,
                  metric: `${last.currentRatio.toFixed(2)}`
                });
              }

              // Quick ratio
              if (last.quickRatio < 0.8) {
                issues.push({
                  category: 'Liquidity',
                  severity: last.quickRatio < 0.5 ? 'high' : 'medium',
                  title: 'Poor Quick Ratio',
                  description: `Quick ratio of ${last.quickRatio.toFixed(2)} shows the company cannot cover current liabilities with liquid assets. Heavy reliance on inventory or other less liquid assets.`,
                  metric: `${last.quickRatio.toFixed(2)}`
                });
              }

              // Debt ratios
              const debtToEquity = last.totalEquity > 0 ? last.totalLiab / last.totalEquity : 999;
              if (debtToEquity > 2.0) {
                issues.push({
                  category: 'Leverage',
                  severity: 'high',
                  title: 'High Debt Leverage',
                  description: `Debt-to-equity ratio of ${debtToEquity.toFixed(2)} indicates the company is heavily leveraged. High debt levels increase financial risk and interest expenses.`,
                  metric: `${debtToEquity.toFixed(2)}x`
                });
              }

              const debtRatio = last.totalAssets > 0 ? (last.totalLiab / last.totalAssets) * 100 : 0;
              if (debtRatio > 70) {
                issues.push({
                  category: 'Leverage',
                  severity: 'medium',
                  title: 'High Debt Ratio',
                  description: `${debtRatio.toFixed(1)}% of assets are financed by debt, indicating high financial leverage and potential vulnerability to economic downturns.`,
                  metric: `${debtRatio.toFixed(1)}%`
                });
              }

              // === PROFITABILITY ===
              const netMargin = last.revenue > 0 ? ((last.revenue - last.expense) / last.revenue) * 100 : 0;
              if (netMargin < 0) {
                issues.push({
                  category: 'Profitability',
                  severity: 'high',
                  title: 'Operating at a Loss',
                  description: `Net margin of ${netMargin.toFixed(1)}% indicates the company is losing money on operations. Immediate action required to restore profitability.`,
                  metric: `${netMargin.toFixed(1)}%`
                });
              } else if (netMargin < 5) {
                issues.push({
                  category: 'Profitability',
                  severity: 'medium',
                  title: 'Thin Profit Margins',
                  description: `Net margin of ${netMargin.toFixed(1)}% provides little buffer for unexpected costs or revenue shortfalls. Margin improvement strategies should be prioritized.`,
                  metric: `${netMargin.toFixed(1)}%`
                });
              }

              // ROE
              if (last.roe < 0) {
                issues.push({
                  category: 'Profitability',
                  severity: 'high',
                  title: 'Negative Return on Equity',
                  description: `ROE of ${(last.roe * 100).toFixed(1)}% indicates the company is destroying shareholder value. Equity holders are receiving negative returns.`,
                  metric: `${(last.roe * 100).toFixed(1)}%`
                });
              } else if (last.roe < 0.05) {
                issues.push({
                  category: 'Profitability',
                  severity: 'medium',
                  title: 'Low Return on Equity',
                  description: `ROE of ${(last.roe * 100).toFixed(1)}% is below typical market returns. Shareholders could achieve better returns elsewhere.`,
                  metric: `${(last.roe * 100).toFixed(1)}%`
                });
              }

              // === WORKING CAPITAL ===
              const workingCapital = last.tca - last.tcl;
              const wcRatio = last.revenue > 0 ? (workingCapital / (last.revenue / 12)) * 100 : 0;
              
              if (workingCapital < 0) {
                issues.push({
                  category: 'Working Capital',
                  severity: 'high',
                  title: 'Negative Working Capital',
                  description: `Working capital of $${workingCapital.toLocaleString()} indicates current liabilities exceed current assets. This creates immediate cash flow pressure and operational constraints.`,
                  metric: `$${workingCapital.toLocaleString()}`
                });
              }

              // Days Sales Outstanding
              const dso = last.revenue > 0 ? (last.ar / (last.revenue / 365)) : 0;
              if (dso > 60) {
                issues.push({
                  category: 'Working Capital',
                  severity: 'medium',
                  title: 'Slow Accounts Receivable Collection',
                  description: `Days Sales Outstanding of ${dso.toFixed(0)} days indicates slow customer payments. This ties up cash and may signal credit quality issues.`,
                  metric: `${dso.toFixed(0)} days`
                });
              }

              // Days Payable Outstanding
              const dpo = last.expense > 0 ? (last.ap / (last.expense / 365)) : 0;
              if (dpo > 90) {
                issues.push({
                  category: 'Working Capital',
                  severity: 'medium',
                  title: 'Extended Payment Terms to Suppliers',
                  description: `Days Payable Outstanding of ${dpo.toFixed(0)} days may indicate cash flow stress, causing the company to delay supplier payments.`,
                  metric: `${dpo.toFixed(0)} days`
                });
              }

              // === CASH FLOW (if we have the data) ===
              const netIncome = last.revenue - last.expense;
              const workingCapitalChange = monthly.length >= 2 ? (last.tca - last.tcl) - (prev.tca - prev.tcl) : 0;
              const estimatedOCF = netIncome - workingCapitalChange;
              
              if (estimatedOCF < 0 && netIncome > 0) {
                issues.push({
                  category: 'Cash Flow',
                  severity: 'high',
                  title: 'Negative Operating Cash Flow Despite Profits',
                  description: `While showing accounting profits, the company is consuming cash in operations (estimated -$${Math.abs(estimatedOCF).toLocaleString()}). This often results from working capital build-up or non-cash revenue.`,
                  metric: `-$${Math.abs(estimatedOCF).toLocaleString()}`
                });
              }

              // Cash position declining
              if (monthly.length >= 6) {
                const cashTrend = last.cash - monthly[monthly.length - 6].cash;
                const cashTrendPct = monthly[monthly.length - 6].cash > 0 ? (cashTrend / monthly[monthly.length - 6].cash) * 100 : 0;
                if (cashTrendPct < -20) {
                  issues.push({
                    category: 'Cash Flow',
                    severity: 'high',
                    title: 'Rapid Cash Depletion',
                    description: `Cash has declined ${Math.abs(cashTrendPct).toFixed(1)}% over the past 6 months. At this burn rate, cash reserves may be exhausted quickly without corrective action.`,
                    metric: `${cashTrendPct.toFixed(1)}%`
                  });
                }
              }

              // === ASSET EFFICIENCY ===
              const assetTurnover = last.totalAssets > 0 ? (last.revenue * 12) / last.totalAssets : 0;
              if (assetTurnover < 0.5) {
                issues.push({
                  category: 'Asset Efficiency',
                  severity: 'low',
                  title: 'Low Asset Turnover',
                  description: `Asset turnover of ${assetTurnover.toFixed(2)}x indicates assets are not being utilized efficiently to generate revenue. Consider asset optimization or divestiture.`,
                  metric: `${assetTurnover.toFixed(2)}x`
                });
              }

              // === EXPENSE CATEGORY ANALYSIS (% of Revenue) ===
              const expenseCategories = [
                { key: 'cogsTotal', name: 'COGS Total', threshold: 70 },
                { key: 'cogsPayroll', name: 'COGS Payroll', threshold: 35 },
                { key: 'operatingExpenseTotal', name: 'Operating Expenses', threshold: 40 },
                { key: 'opexPayroll', name: 'OPEX Payroll', threshold: 25 },
                { key: 'opexSalesMarketing', name: 'Sales & Marketing', threshold: 15 },
                { key: 'rentLease', name: 'Rent/Lease', threshold: 10 },
                { key: 'professionalServices', name: 'Professional Services', threshold: 8 }
              ];

              expenseCategories.forEach(cat => {
                if (mapping[cat.key as keyof typeof mapping] && last[cat.key as keyof typeof last]) {
                  const currentPct = last.revenue > 0 ? ((last[cat.key as keyof typeof last] as number) / last.revenue) * 100 : 0;
                  
                  // Check if expense category is too high
                  if (currentPct > cat.threshold) {
                    issues.push({
                      category: 'Expense Control',
                      severity: currentPct > cat.threshold * 1.3 ? 'high' : 'medium',
                      title: `High ${cat.name} Expense`,
                      description: `${cat.name} represents ${currentPct.toFixed(1)}% of revenue, which is above the recommended threshold of ${cat.threshold}%. This indicates potential inefficiencies or cost control issues in this area.`,
                      metric: `${currentPct.toFixed(1)}%`
                    });
                  }

                  // Check if trending upward
                  if (monthly.length >= 6) {
                    const sixMonthsAgo = monthly[monthly.length - 6];
                    const prevPct = sixMonthsAgo.revenue > 0 ? ((sixMonthsAgo[cat.key as keyof typeof sixMonthsAgo] as number || 0) / sixMonthsAgo.revenue) * 100 : 0;
                    const pctChange = currentPct - prevPct;
                    
                    if (pctChange > 3) {
                      issues.push({
                        category: 'Expense Trends',
                        severity: pctChange > 5 ? 'medium' : 'low',
                        title: `Rising ${cat.name} as % of Revenue`,
                        description: `${cat.name} has increased from ${prevPct.toFixed(1)}% to ${currentPct.toFixed(1)}% of revenue over the past 6 months. This trend indicates deteriorating cost control or operational inefficiency.`,
                        metric: `+${pctChange.toFixed(1)}%`
                      });
                    }
                  }
                }
              });

              // === BENCHMARK COMPARISON ===
              if (benchmarks && benchmarks.length > 0) {
                // Current Ratio vs Benchmark
                const currentRatioBM = benchmarks.find(b => b.metric === 'Current Ratio');
                if (currentRatioBM && last.currentRatio < currentRatioBM.p25) {
                  issues.push({
                    category: 'Benchmarks',
                    severity: 'medium',
                    title: 'Current Ratio Below Industry Benchmark',
                    description: `Current ratio of ${last.currentRatio.toFixed(2)} is below the industry 25th percentile of ${currentRatioBM.p25.toFixed(2)}. This indicates weaker liquidity compared to industry peers.`,
                    metric: `${last.currentRatio.toFixed(2)} vs ${currentRatioBM.p25.toFixed(2)}`
                  });
                }

                // Quick Ratio vs Benchmark
                const quickRatioBM = benchmarks.find(b => b.metric === 'Quick Ratio');
                if (quickRatioBM && last.quickRatio < quickRatioBM.p25) {
                  issues.push({
                    category: 'Benchmarks',
                    severity: 'medium',
                    title: 'Quick Ratio Below Industry Benchmark',
                    description: `Quick ratio of ${last.quickRatio.toFixed(2)} is below the industry 25th percentile of ${quickRatioBM.p25.toFixed(2)}. This suggests inadequate liquid assets compared to peers.`,
                    metric: `${last.quickRatio.toFixed(2)} vs ${quickRatioBM.p25.toFixed(2)}`
                  });
                }

                // Debt to Equity vs Benchmark
                const debtToEquityBM = benchmarks.find(b => b.metric === 'Debt to Equity');
                if (debtToEquityBM && debtToEquity < 900 && debtToEquity > debtToEquityBM.p75) {
                  issues.push({
                    category: 'Benchmarks',
                    severity: 'medium',
                    title: 'Debt-to-Equity Above Industry Benchmark',
                    description: `Debt-to-equity ratio of ${debtToEquity.toFixed(2)} exceeds the industry 75th percentile of ${debtToEquityBM.p75.toFixed(2)}. The company is more leveraged than most peers.`,
                    metric: `${debtToEquity.toFixed(2)} vs ${debtToEquityBM.p75.toFixed(2)}`
                  });
                }

                // ROE vs Benchmark
                const roeBM = benchmarks.find(b => b.metric === 'Return on Equity (ROE)');
                if (roeBM && last.roe < roeBM.p25) {
                  issues.push({
                    category: 'Benchmarks',
                    severity: 'medium',
                    title: 'ROE Below Industry Benchmark',
                    description: `Return on Equity of ${(last.roe * 100).toFixed(1)}% is below the industry 25th percentile of ${(roeBM.p25 * 100).toFixed(1)}%. The company is generating lower returns than most competitors.`,
                    metric: `${(last.roe * 100).toFixed(1)}% vs ${(roeBM.p25 * 100).toFixed(1)}%`
                  });
                }

                // ROA vs Benchmark
                const roaBM = benchmarks.find(b => b.metric === 'Return on Assets (ROA)');
                if (roaBM && last.roa < roaBM.p25) {
                  issues.push({
                    category: 'Benchmarks',
                    severity: 'low',
                    title: 'ROA Below Industry Benchmark',
                    description: `Return on Assets of ${(last.roa * 100).toFixed(1)}% is below the industry 25th percentile of ${(roaBM.p25 * 100).toFixed(1)}%. Asset utilization is weaker than industry peers.`,
                    metric: `${(last.roa * 100).toFixed(1)}% vs ${(roaBM.p25 * 100).toFixed(1)}%`
                  });
                }

                // Profit Margin vs Benchmark
                const profitMarginBM = benchmarks.find(b => b.metric === 'Profit Margin');
                if (profitMarginBM && netMargin < profitMarginBM.p25) {
                  issues.push({
                    category: 'Benchmarks',
                    severity: netMargin < 0 ? 'high' : 'medium',
                    title: 'Profit Margin Below Industry Benchmark',
                    description: `Net profit margin of ${netMargin.toFixed(1)}% is below the industry 25th percentile of ${profitMarginBM.p25.toFixed(1)}%. Profitability is weaker than most competitors.`,
                    metric: `${netMargin.toFixed(1)}% vs ${profitMarginBM.p25.toFixed(1)}%`
                  });
                }

                // Asset Turnover vs Benchmark
                const assetTurnoverBM = benchmarks.find(b => b.metric === 'Asset Turnover');
                if (assetTurnoverBM && assetTurnover < assetTurnoverBM.p25) {
                  issues.push({
                    category: 'Benchmarks',
                    severity: 'low',
                    title: 'Asset Turnover Below Industry Benchmark',
                    description: `Asset turnover of ${assetTurnover.toFixed(2)}x is below the industry 25th percentile of ${assetTurnoverBM.p25.toFixed(2)}x. Assets are being used less efficiently than peers.`,
                    metric: `${assetTurnover.toFixed(2)}x vs ${assetTurnoverBM.p25.toFixed(2)}x`
                  });
                }

                // DSO vs Benchmark  
                const dsoBM = benchmarks.find(b => b.metric === 'Days Sales Outstanding (DSO)');
                if (dsoBM && dso > dsoBM.p75) {
                  issues.push({
                    category: 'Benchmarks',
                    severity: 'medium',
                    title: 'DSO Above Industry Benchmark',
                    description: `Days Sales Outstanding of ${dso.toFixed(0)} days exceeds the industry 75th percentile of ${dsoBM.p75.toFixed(0)} days. Collections are slower than most competitors.`,
                    metric: `${dso.toFixed(0)} vs ${dsoBM.p75.toFixed(0)} days`
                  });
                }

                // Expense Ratio vs Benchmark
                const expenseRatioBM = benchmarks.find(b => b.metric === 'Expense Ratio');
                if (expenseRatioBM && expenseRatio > expenseRatioBM.p75) {
                  issues.push({
                    category: 'Benchmarks',
                    severity: 'medium',
                    title: 'Expense Ratio Above Industry Benchmark',
                    description: `Total expense ratio of ${expenseRatio.toFixed(1)}% exceeds the industry 75th percentile of ${expenseRatioBM.p75.toFixed(1)}%. Operating costs are higher than most competitors.`,
                    metric: `${expenseRatio.toFixed(1)}% vs ${expenseRatioBM.p75.toFixed(1)}%`
                  });
                }
              }

              // === FINANCIAL SCORE ANALYSIS ===
              // Check overall Financial Score
              if (finalScore < 40) {
                issues.push({
                  category: 'Financial Score',
                  severity: 'high',
                  title: 'Critical Financial Score',
                  description: `Overall Financial Score of ${finalScore.toFixed(1)} is critically low, indicating severe financial distress. Both profitability and asset development require immediate attention.`,
                  metric: `${finalScore.toFixed(1)}/100`
                });
              } else if (finalScore < 60) {
                issues.push({
                  category: 'Financial Score',
                  severity: 'medium',
                  title: 'Below Average Financial Score',
                  description: `Financial Score of ${finalScore.toFixed(1)} is below industry standards. The company needs to improve both revenue growth/profitability and asset management.`,
                  metric: `${finalScore.toFixed(1)}/100`
                });
              } else if (finalScore < 70) {
                issues.push({
                  category: 'Financial Score',
                  severity: 'low',
                  title: 'Moderate Financial Score',
                  description: `Financial Score of ${finalScore.toFixed(1)} shows room for improvement. Consider strategies to enhance profitability and strengthen the balance sheet.`,
                  metric: `${finalScore.toFixed(1)}/100`
                });
              }

              // Check Profitability Score component
              if (profitabilityScore < 40) {
                issues.push({
                  category: 'Financial Score',
                  severity: 'high',
                  title: 'Critical Profitability Score',
                  description: `Profitability Score of ${profitabilityScore.toFixed(1)} indicates severe issues with revenue growth and expense management. Revenue may be declining or expenses growing faster than revenue.`,
                  metric: `${profitabilityScore.toFixed(1)}/100`
                });
              } else if (profitabilityScore < 60) {
                issues.push({
                  category: 'Financial Score',
                  severity: 'medium',
                  title: 'Weak Profitability Score',
                  description: `Profitability Score of ${profitabilityScore.toFixed(1)} suggests underperformance in revenue growth or expense control. Review pricing strategies, cost structure, and market positioning.`,
                  metric: `${profitabilityScore.toFixed(1)}/100`
                });
              }

              // Check Asset Development Score component
              if (assetDevScore < 40) {
                issues.push({
                  category: 'Financial Score',
                  severity: 'high',
                  title: 'Critical Asset Development Score',
                  description: `Asset Development Score of ${assetDevScore.toFixed(1)} indicates a weak balance sheet with assets barely exceeding liabilities. Asset-to-Liability ratio of ${alr1.toFixed(2)}:1 suggests potential solvency issues.`,
                  metric: `${assetDevScore.toFixed(1)}/100 (ALR: ${alr1.toFixed(2)})`
                });
              } else if (assetDevScore < 60) {
                issues.push({
                  category: 'Financial Score',
                  severity: 'medium',
                  title: 'Weak Asset Development Score',
                  description: `Asset Development Score of ${assetDevScore.toFixed(1)} indicates limited asset growth relative to liabilities. Asset-to-Liability ratio of ${alr1.toFixed(2)}:1 could be stronger to support future growth.`,
                  metric: `${assetDevScore.toFixed(1)}/100 (ALR: ${alr1.toFixed(2)})`
                });
              }

              // Check Asset-to-Liability Ratio trend
              if (alr1 < 1.0) {
                issues.push({
                  category: 'Financial Score',
                  severity: 'high',
                  title: 'Liabilities Exceed Assets',
                  description: `Asset-to-Liability ratio of ${alr1.toFixed(2)}:1 means liabilities exceed assets, indicating the company is technically insolvent on paper. This requires immediate financial restructuring or capital injection.`,
                  metric: `${alr1.toFixed(2)}:1`
                });
              } else if (alr1 < 1.2 && alrGrowth < -10) {
                issues.push({
                  category: 'Financial Score',
                  severity: 'high',
                  title: 'Deteriorating Asset-to-Liability Ratio',
                  description: `Asset-to-Liability ratio has declined by ${Math.abs(alrGrowth).toFixed(1)}% to ${alr1.toFixed(2)}:1. The balance sheet is weakening, with liabilities growing faster than assets.`,
                  metric: `${alr1.toFixed(2)}:1 (${alrGrowth.toFixed(1)}%)`
                });
              } else if (alrGrowth < -5) {
                issues.push({
                  category: 'Financial Score',
                  severity: 'medium',
                  title: 'Declining Asset Quality',
                  description: `Asset-to-Liability ratio decreased by ${Math.abs(alrGrowth).toFixed(1)}%, suggesting assets are not growing as fast as liabilities. Monitor debt levels and asset utilization.`,
                  metric: `${alrGrowth.toFixed(1)}% decline`
                });
              }

              // Check Financial Score trend if we have historical data
              if (trendData && trendData.length >= 6) {
                const currentFinScore = trendData[trendData.length - 1].financialScore;
                const sixMonthsAgoFinScore = trendData[trendData.length - 6].financialScore;
                const finScoreChange = currentFinScore - sixMonthsAgoFinScore;
                
                if (finScoreChange < -15) {
                  issues.push({
                    category: 'Financial Score',
                    severity: 'high',
                    title: 'Rapidly Declining Financial Score',
                    description: `Financial Score has dropped ${Math.abs(finScoreChange).toFixed(1)} points over the past 6 months, from ${sixMonthsAgoFinScore.toFixed(1)} to ${currentFinScore.toFixed(1)}. This rapid deterioration requires immediate management attention.`,
                    metric: `${finScoreChange.toFixed(1)} pts`
                  });
                } else if (finScoreChange < -10) {
                  issues.push({
                    category: 'Financial Score',
                    severity: 'medium',
                    title: 'Declining Financial Score Trend',
                    description: `Financial Score has decreased by ${Math.abs(finScoreChange).toFixed(1)} points over the past 6 months. The company's financial health is trending in the wrong direction.`,
                    metric: `${finScoreChange.toFixed(1)} pts`
                  });
                }

                // Check Profitability Score trend
                const currentProfScore = trendData[trendData.length - 1].profitabilityScore;
                const sixMonthsAgoProfScore = trendData[trendData.length - 6].profitabilityScore;
                const profScoreChange = currentProfScore - sixMonthsAgoProfScore;
                
                if (profScoreChange < -15) {
                  issues.push({
                    category: 'Financial Score',
                    severity: 'medium',
                    title: 'Deteriorating Profitability Trend',
                    description: `Profitability Score has fallen ${Math.abs(profScoreChange).toFixed(1)} points over 6 months, indicating worsening revenue growth and/or expense control.`,
                    metric: `${profScoreChange.toFixed(1)} pts`
                  });
                }

                // Check Asset Development Score trend
                const currentAdsScore = trendData[trendData.length - 1].adsScore;
                const sixMonthsAgoAdsScore = trendData[trendData.length - 6].adsScore;
                const adsScoreChange = currentAdsScore - sixMonthsAgoAdsScore;
                
                if (adsScoreChange < -15) {
                  issues.push({
                    category: 'Financial Score',
                    severity: 'medium',
                    title: 'Weakening Balance Sheet Trend',
                    description: `Asset Development Score has dropped ${Math.abs(adsScoreChange).toFixed(1)} points over 6 months, indicating the balance sheet is deteriorating relative to historical levels.`,
                    metric: `${adsScoreChange.toFixed(1)} pts`
                  });
                }
              }

              // Sort by severity
              const severityOrder = { high: 0, medium: 1, low: 2 };
              issues.sort((a, b) => severityOrder[a.severity] - severityOrder[b.severity]);

              return (
                <div>
                  {/* Summary Stats */}
                  <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '20px', marginBottom: '32px' }}>
                    <div style={{ background: '#fee2e2', borderRadius: '12px', padding: '20px', border: '2px solid #ef4444' }}>
                      <div style={{ fontSize: '32px', fontWeight: '700', color: '#991b1b', marginBottom: '8px' }}>
                        {issues.filter(i => i.severity === 'high').length}
                      </div>
                      <div style={{ fontSize: '14px', fontWeight: '600', color: '#7f1d1d' }}>High Priority Issues</div>
                    </div>
                    <div style={{ background: '#fef3c7', borderRadius: '12px', padding: '20px', border: '2px solid #f59e0b' }}>
                      <div style={{ fontSize: '32px', fontWeight: '700', color: '#92400e', marginBottom: '8px' }}>
                        {issues.filter(i => i.severity === 'medium').length}
                      </div>
                      <div style={{ fontSize: '14px', fontWeight: '600', color: '#78350f' }}>Medium Priority Issues</div>
                    </div>
                    <div style={{ background: '#dbeafe', borderRadius: '12px', padding: '20px', border: '2px solid #3b82f6' }}>
                      <div style={{ fontSize: '32px', fontWeight: '700', color: '#1e40af', marginBottom: '8px' }}>
                        {issues.filter(i => i.severity === 'low').length}
                      </div>
                      <div style={{ fontSize: '14px', fontWeight: '600', color: '#1e3a8a' }}>Low Priority Issues</div>
                    </div>
                  </div>

                  {/* Issues List */}
                  {issues.length === 0 ? (
                    <div style={{ background: '#d1fae5', borderRadius: '12px', padding: '32px', textAlign: 'center', border: '2px solid #10b981' }}>
                      <div style={{ fontSize: '48px', marginBottom: '16px' }}>✅</div>
                      <h3 style={{ fontSize: '20px', fontWeight: '700', color: '#065f46', marginBottom: '12px' }}>No Critical Issues Detected</h3>
                      <p style={{ fontSize: '15px', color: '#047857', margin: 0 }}>
                        All analyzed metrics are within acceptable ranges. Continue monitoring for any changes.
                      </p>
                    </div>
                  ) : (
                    <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>
                      {issues.map((issue, idx) => {
                        const bgColor = issue.severity === 'high' ? '#fee2e2' : issue.severity === 'medium' ? '#fef3c7' : '#dbeafe';
                        const borderColor = issue.severity === 'high' ? '#ef4444' : issue.severity === 'medium' ? '#f59e0b' : '#3b82f6';
                        const textColor = issue.severity === 'high' ? '#991b1b' : issue.severity === 'medium' ? '#92400e' : '#1e40af';
                        const icon = issue.severity === 'high' ? '🔴' : issue.severity === 'medium' ? '🟡' : '🔵';
                        
                        return (
                          <div key={idx} style={{ background: bgColor, borderRadius: '12px', padding: '20px', border: `2px solid ${borderColor}` }}>
                            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '12px' }}>
                              <div style={{ flex: 1 }}>
                                <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '8px' }}>
                                  <span style={{ fontSize: '18px' }}>{icon}</span>
                                  <span style={{ fontSize: '11px', fontWeight: '700', color: textColor, textTransform: 'uppercase', letterSpacing: '0.5px' }}>
                                    {issue.category}
                                  </span>
                                </div>
                                <h3 style={{ fontSize: '18px', fontWeight: '700', color: textColor, marginBottom: '8px', margin: 0 }}>
                                  {issue.title}
                                </h3>
                              </div>
                              {issue.metric && (
                                <div style={{ background: 'white', borderRadius: '8px', padding: '8px 16px', border: `1px solid ${borderColor}` }}>
                                  <div style={{ fontSize: '18px', fontWeight: '700', color: textColor }}>{issue.metric}</div>
                                </div>
                              )}
                            </div>
                            <p style={{ fontSize: '14px', color: textColor, margin: 0, lineHeight: '1.6' }}>
                              {issue.description}
                            </p>
                          </div>
                        );
                      })}
                    </div>
                  )}

                  {/* Action Items */}
                  {issues.filter(i => i.severity === 'high').length > 0 && (
                    <div style={{ marginTop: '32px', background: '#f8fafc', borderRadius: '12px', padding: '24px', border: '2px solid #667eea' }}>
                      <h3 style={{ fontSize: '18px', fontWeight: '700', color: '#1e293b', marginBottom: '16px' }}>📋 Recommended Actions</h3>
                      <ul style={{ margin: 0, paddingLeft: '20px', fontSize: '14px', color: '#475569', lineHeight: '1.8' }}>
                        {issues.filter(i => i.severity === 'high').length > 0 && (
                          <li><strong>Immediate attention required:</strong> Address all high-priority issues within the next 30 days</li>
                        )}
                        {issues.some(i => i.category === 'Liquidity') && (
                          <li><strong>Improve liquidity:</strong> Focus on accelerating collections, managing payables, and securing additional working capital if needed</li>
                        )}
                        {issues.some(i => i.category === 'Expense Control') && (
                          <li><strong>Cost reduction:</strong> Conduct detailed expense review to identify cost-saving opportunities without impacting revenue</li>
                        )}
                        {issues.some(i => i.category === 'Revenue Trends') && (
                          <li><strong>Revenue growth:</strong> Develop strategies to stabilize and grow revenue through new markets, products, or customer acquisition</li>
                        )}
                        {issues.some(i => i.category === 'Cash Flow') && (
                          <li><strong>Cash management:</strong> Implement cash flow forecasting and monitoring to prevent liquidity crises</li>
                        )}
                        <li><strong>Regular monitoring:</strong> Review these metrics weekly until trends improve</li>
                      </ul>
                    </div>
                  )}
                </div>
              );
            })()}
          </div>
          )}
        </div>
      )}

      {/* Projections View */}
      {currentView === 'projections' && selectedCompanyId && projections.mostLikely.length > 0 && (
        <div style={{ maxWidth: '100%', padding: '32px 32px 32px 16px' }}>
          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '32px' }}>
            <h1 style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b', margin: 0 }}>Financial Projections</h1>
            {companyName && <div style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b' }}>{companyName}</div>}
          </div>
          
          <div style={{ background: 'white', borderRadius: '12px', padding: '24px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '16px' }}>
              <h2 style={{ fontSize: '20px', fontWeight: '600', color: '#1e293b' }}>Scenario Assumptions</h2>
              <button onClick={() => setShowDefaultSettings(!showDefaultSettings)} style={{ padding: '8px 16px', background: '#667eea', color: 'white', border: 'none', borderRadius: '8px', fontSize: '14px', fontWeight: '600', cursor: 'pointer' }}>
                {showDefaultSettings ? 'Hide Settings' : 'Adjust Scenarios'}
              </button>
            </div>
            
            {showDefaultSettings && (
              <div style={{ background: '#f8fafc', borderRadius: '8px', padding: '20px', marginTop: '16px' }}>
                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '24px', marginBottom: '20px' }}>
                  <div>
                    <h3 style={{ fontSize: '16px', fontWeight: '600', color: '#10b981', marginBottom: '12px' }}>Best Case Scenario</h3>
                    <div style={{ marginBottom: '12px' }}>
                      <label style={{ display: 'block', fontSize: '14px', fontWeight: '500', color: '#475569', marginBottom: '4px' }}>Revenue Multiplier: {bestCaseRevMultiplier}x</label>
                      <input type="range" min="1" max="3" step="0.1" value={bestCaseRevMultiplier} onChange={(e) => setBestCaseRevMultiplier(parseFloat(e.target.value))} style={{ width: '100%' }} />
                    </div>
                    <div>
                      <label style={{ display: 'block', fontSize: '14px', fontWeight: '500', color: '#475569', marginBottom: '4px' }}>Expense Multiplier: {bestCaseExpMultiplier}x</label>
                      <input type="range" min="0.3" max="1" step="0.05" value={bestCaseExpMultiplier} onChange={(e) => setBestCaseExpMultiplier(parseFloat(e.target.value))} style={{ width: '100%' }} />
                    </div>
                  </div>
                  <div>
                    <h3 style={{ fontSize: '16px', fontWeight: '600', color: '#ef4444', marginBottom: '12px' }}>Worst Case Scenario</h3>
                    <div style={{ marginBottom: '12px' }}>
                      <label style={{ display: 'block', fontSize: '14px', fontWeight: '500', color: '#475569', marginBottom: '4px' }}>Revenue Multiplier: {worstCaseRevMultiplier}x</label>
                      <input type="range" min="0" max="1" step="0.05" value={worstCaseRevMultiplier} onChange={(e) => setWorstCaseRevMultiplier(parseFloat(e.target.value))} style={{ width: '100%' }} />
                    </div>
                    <div>
                      <label style={{ display: 'block', fontSize: '14px', fontWeight: '500', color: '#475569', marginBottom: '4px' }}>Expense Multiplier: {worstCaseExpMultiplier}x</label>
                      <input type="range" min="1" max="2" step="0.05" value={worstCaseExpMultiplier} onChange={(e) => setWorstCaseExpMultiplier(parseFloat(e.target.value))} style={{ width: '100%' }} />
                    </div>
                  </div>
                </div>
                <button onClick={saveProjectionDefaults} style={{ padding: '10px 20px', background: '#10b981', color: 'white', border: 'none', borderRadius: '8px', fontSize: '14px', fontWeight: '600', cursor: 'pointer' }}>Save as Defaults</button>
              </div>
            )}
          </div>

          <div style={{ display: 'grid', gap: '32px' }}>
            <ProjectionChart title="Revenue Projection" historicalData={monthly} projectedData={projections} valueKey="revenue" formatValue={(v) => `$${(v / 1000).toFixed(0)}K`} />
            <ProjectionChart title="Expense Projection" historicalData={monthly} projectedData={projections} valueKey="expense" formatValue={(v) => `$${(v / 1000).toFixed(0)}K`} />
            <ProjectionChart title="Net Income Projection" historicalData={monthly} projectedData={projections} valueKey="netIncome" formatValue={(v) => `$${(v / 1000).toFixed(0)}K`} />
            <ProjectionChart title="Total Assets Projection" historicalData={monthly} projectedData={projections} valueKey="totalAssets" formatValue={(v) => `$${(v / 1000).toFixed(0)}K`} />
            <ProjectionChart title="Total Liabilities Projection" historicalData={monthly} projectedData={projections} valueKey="totalLiab" formatValue={(v) => `$${(v / 1000).toFixed(0)}K`} />
            <ProjectionChart title="Equity Projection" historicalData={monthly} projectedData={projections} valueKey="equity" formatValue={(v) => `$${(v / 1000).toFixed(0)}K`} />
          </div>
        </div>
      )}

      {/* Working Capital View */}
      {currentView === 'working-capital' && selectedCompanyId && monthly.length > 0 && (
        <div style={{ maxWidth: '1400px', margin: '0 auto', padding: '32px' }}>
          <style>{`
            @media print {
              @page {
                size: landscape;
                margin: 0.15in;
              }
              
              /* Hide navigation and UI elements */
              .no-print,
              header,
              nav,
              aside,
              [role="navigation"],
              button {
                display: none !important;
              }
              
              /* Remove background colors and shadows */
              * {
                box-shadow: none !important;
              }
              
              /* Page breaks */
              .page-break-after {
                page-break-after: always;
              }
              
              /* Show second page header only when printing */
              .wc-page-2-header {
                display: block !important;
                margin-top: 0 !important;
                padding-top: 24px !important;
              }
              
              /* Ensure content fits on landscape pages */
              .wc-print-content {
                width: 100%;
              }
              
              /* Scale down first page content to fit */
              .wc-first-page-content,
              .page-break-after {
                transform: scale(0.85);
                transform-origin: top left;
                width: 117.65%; /* Compensate for scale */
              }
              
              /* Additionally scale the chart horizontally to fit within page */
              .page-break-after svg {
                transform: scaleX(0.95) !important;
                transform-origin: left center !important;
                overflow: visible !important;
              }
              
              /* Ensure chart container doesn't clip overflow labels */
              .page-break-after > div {
                overflow: visible !important;
              }
              
              /* Reduce spacing for print */
              @media print {
                h1 {
                  font-size: 24px !important;
                  margin-bottom: 16px !important;
                }
                
                h2 {
                  font-size: 16px !important;
                  margin-bottom: 12px !important;
                }
                
                .wc-first-page-content {
                  margin-bottom: 16px !important;
                  gap: 8px !important;
                }
                
                .page-break-after {
                  margin-bottom: 16px !important;
                  padding: 16px !important;
                }
                
                /* Reduce padding and font sizes in metric cards */
                .wc-first-page-content > div {
                  padding: 10px !important;
                }
                
                .wc-first-page-content > div h3 {
                  font-size: 11px !important;
                  margin-bottom: 6px !important;
                }
                
                .wc-first-page-content > div > div:first-of-type {
                  font-size: 22px !important;
                  margin-bottom: 2px !important;
                }
                
                .wc-first-page-content > div > div:last-of-type {
                  font-size: 10px !important;
                }
                
                /* Compress second page - Components Breakdown */
                .wc-components-breakdown {
                  margin-bottom: 12px !important;
                  gap: 16px !important;
                }
                
                .wc-components-breakdown > div {
                  padding: 16px !important;
                }
                
                .wc-components-breakdown h2 {
                  font-size: 16px !important;
                  margin-bottom: 12px !important;
                }
                
                .wc-components-breakdown > div > div {
                  gap: 8px !important;
                }
                
                .wc-components-breakdown > div > div > div {
                  padding: 8px !important;
                  font-size: 12px !important;
                }
                
                /* Compress second page - Insights Section */
                .wc-insights {
                  padding: 16px !important;
                  margin-bottom: 0 !important;
                }
                
                .wc-insights h2 {
                  font-size: 16px !important;
                  margin-bottom: 12px !important;
                }
                
                .wc-insights > div {
                  gap: 10px !important;
                }
                
                .wc-insights > div > div {
                  padding: 10px !important;
                  font-size: 11px !important;
                  line-height: 1.4 !important;
                }
                
                .wc-insights > div > div > div:first-child {
                  font-size: 12px !important;
                  margin-bottom: 4px !important;
                }
                
                .wc-insights > div > div > div:last-child {
                  font-size: 11px !important;
                }
              }
            }
          `}</style>
          
          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '32px' }}>
            <h1 style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b', margin: 0 }}>Working Capital Analysis</h1>
            <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
              {companyName && <div style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b' }}>{companyName}</div>}
              <button 
                className="no-print"
                onClick={() => window.print()} 
                style={{ 
                  padding: '12px 24px', 
                  background: '#667eea', 
                  color: 'white', 
                  border: 'none', 
                  borderRadius: '8px', 
                  fontSize: '14px', 
                  fontWeight: '600', 
                  cursor: 'pointer',
                  boxShadow: '0 2px 8px rgba(102, 126, 234, 0.3)'
                }}>
                🖨️ Print
              </button>
            </div>
          </div>
          
          {(() => {
            // Calculate working capital for each month
            const wcData = monthly.map(m => ({
              month: m.month,
              currentAssets: m.cash + m.ar + m.inventory + m.otherCA,
              currentLiabilities: m.ap + m.otherCL,
              workingCapital: (m.cash + m.ar + m.inventory + m.otherCA) - (m.ap + m.otherCL),
              revenue: m.revenue
            }));
            
            // Current period metrics
            const current = wcData[wcData.length - 1];
            const prior = wcData.length >= 13 ? wcData[wcData.length - 13] : wcData[0];
            
            const currentWC = current.workingCapital;
            const wcRatio = current.currentLiabilities !== 0 ? current.currentAssets / current.currentLiabilities : 0;
            const wcChange = currentWC - prior.workingCapital;
            const wcChangePercent = prior.workingCapital !== 0 ? (wcChange / Math.abs(prior.workingCapital)) * 100 : 0;
            
            // Calculate days working capital (WC / daily revenue)
            const last12Months = monthly.slice(-12);
            const annualRevenue = last12Months.reduce((sum, m) => sum + m.revenue, 0);
            const dailyRevenue = annualRevenue / 365;
            const daysWC = dailyRevenue !== 0 ? currentWC / dailyRevenue : 0;
            
            // Working Capital Cycle components
            const daysAR = current.revenue !== 0 ? (current.currentAssets * 0.4 / (current.revenue * 12)) * 365 : 0; // Estimate AR as 40% of current assets
            const daysAP = current.revenue !== 0 ? (current.currentLiabilities * 0.6 / (current.revenue * 12 * 0.7)) * 365 : 0; // Estimate AP
            const daysInventory = current.revenue !== 0 ? (current.currentAssets * 0.2 / (current.revenue * 12 * 0.7)) * 365 : 0; // Estimate inventory
            const cashConversionCycle = daysAR + daysInventory - daysAP;
            
            // Historical averages
            const avgWC = wcData.reduce((sum, d) => sum + d.workingCapital, 0) / wcData.length;
            const minWC = Math.min(...wcData.map(d => d.workingCapital));
            const maxWC = Math.max(...wcData.map(d => d.workingCapital));
            
            return (
              <>
                {/* Key Metrics Cards */}
                <div className="wc-first-page-content" style={{ display: 'grid', gridTemplateColumns: 'repeat(4, minmax(0, 200px))', gap: '20px', marginBottom: '32px', justifyContent: 'center' }}>
                  <div style={{ background: 'white', borderRadius: '12px', padding: '20px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', border: '2px solid #667eea' }}>
                    <h3 style={{ fontSize: '13px', fontWeight: '600', color: '#64748b', marginBottom: '8px' }}>Current Working Capital</h3>
                    <div style={{ fontSize: '28px', fontWeight: '700', color: '#667eea', marginBottom: '4px' }}>
                      ${(currentWC / 1000).toFixed(0)}K
                    </div>
                    <div style={{ fontSize: '12px', color: wcChange >= 0 ? '#10b981' : '#ef4444', fontWeight: '600' }}>
                      {wcChange >= 0 ? '↑' : '↓'} ${Math.abs(wcChange / 1000).toFixed(0)}K ({wcChangePercent >= 0 ? '+' : ''}{wcChangePercent.toFixed(1)}%) vs. 1Y ago
                    </div>
                  </div>
                  
                  <div style={{ background: 'white', borderRadius: '12px', padding: '20px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', border: '2px solid #667eea' }}>
                    <h3 style={{ fontSize: '13px', fontWeight: '600', color: '#64748b', marginBottom: '8px' }}>Working Capital Ratio</h3>
                    <div style={{ fontSize: '28px', fontWeight: '700', color: wcRatio >= 1.5 ? '#10b981' : wcRatio >= 1.0 ? '#f59e0b' : '#ef4444', marginBottom: '4px' }}>
                      {wcRatio.toFixed(2)}
                    </div>
                    <div style={{ fontSize: '12px', color: '#64748b' }}>
                      {wcRatio >= 1.5 ? 'Strong' : wcRatio >= 1.0 ? 'Adequate' : 'Needs Attention'}
                    </div>
                  </div>
                  
                  <div style={{ background: 'white', borderRadius: '12px', padding: '20px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', border: '2px solid #667eea' }}>
                    <h3 style={{ fontSize: '13px', fontWeight: '600', color: '#64748b', marginBottom: '8px' }}>Days Working Capital</h3>
                    <div style={{ fontSize: '28px', fontWeight: '700', color: '#1e293b', marginBottom: '4px' }}>
                      {daysWC.toFixed(0)}
                    </div>
                    <div style={{ fontSize: '12px', color: '#64748b' }}>
                      Days of revenue covered
                    </div>
                  </div>
                  
                  <div style={{ background: 'white', borderRadius: '12px', padding: '20px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', border: '2px solid #667eea' }}>
                    <h3 style={{ fontSize: '13px', fontWeight: '600', color: '#64748b', marginBottom: '8px' }}>Cash Conversion Cycle</h3>
                    <div style={{ fontSize: '28px', fontWeight: '700', color: '#1e293b', marginBottom: '4px' }}>
                      {cashConversionCycle.toFixed(0)}
                    </div>
                    <div style={{ fontSize: '12px', color: '#64748b' }}>
                      Days (estimated)
                    </div>
                  </div>
                </div>
                
                {/* Working Capital Trend Chart */}
                <div className="page-break-after" style={{ background: 'white', borderRadius: '12px', padding: '24px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                  <h2 style={{ fontSize: '20px', fontWeight: '600', color: '#1e293b', marginBottom: '20px' }}>Working Capital Trend</h2>
                  <LineChart 
                    title="" 
                    data={wcData.map(d => ({ month: d.month, value: d.workingCapital }))} 
                    color="#667eea"
                    showTable={false}
                    formatter={(val) => `$${Math.round(val).toLocaleString()}`}
                  />
                  
                  {/* Custom Quarterly Table */}
                  <div style={{ marginTop: '16px', overflowX: 'auto' }}>
                    <table style={{ width: '100%', fontSize: '12px', borderCollapse: 'collapse' }}>
                      <tbody>
                        <tr style={{ background: '#f1f5f9', borderBottom: '2px solid #cbd5e1' }}>
                          <td style={{ padding: '8px 12px', fontWeight: '700', color: '#1e293b', minWidth: '80px' }}>
                            Quarter
                          </td>
                          {wcData.filter((_, i) => i % 3 === 2).map((d, i) => (
                            <td key={`quarter-${i}`} style={{ padding: '8px 12px', textAlign: 'center', fontWeight: '600', color: '#64748b' }}>
                              {d.month}
                            </td>
                          ))}
                        </tr>
                        <tr style={{ borderBottom: '1px solid #e2e8f0' }}>
                          <td style={{ padding: '8px 12px', fontWeight: '700', color: '#1e293b' }}>
                            Value
                          </td>
                          {wcData.filter((_, i) => i % 3 === 2).map((d, i) => (
                            <td key={`val-${i}`} style={{ padding: '8px 12px', textAlign: 'center', fontWeight: '700', color: '#667eea' }}>
                              ${Math.round(d.workingCapital).toLocaleString()}
                            </td>
                          ))}
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
                
                {/* Second Page Header */}
                <div className="wc-page-2-header" style={{ display: 'none', marginTop: '32px', marginBottom: '12px', textAlign: 'center' }}>
                  <h2 style={{ fontSize: '20px', fontWeight: '700', color: '#1e293b', margin: 0 }}>
                    Working Capital Analysis - {companyName}
                  </h2>
                </div>
                
                {/* Components Breakdown */}
                <div className="wc-components-breakdown" style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '24px', marginBottom: '12px' }}>
                  <div style={{ background: 'white', borderRadius: '12px', padding: '24px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                    <h2 style={{ fontSize: '20px', fontWeight: '600', color: '#1e293b', marginBottom: '20px' }}>Current Assets</h2>
                    <div style={{ display: 'grid', gap: '12px' }}>
                      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '12px', background: '#f8fafc', borderRadius: '8px' }}>
                        <span style={{ fontSize: '14px', color: '#64748b' }}>Cash</span>
                        <span style={{ fontSize: '16px', fontWeight: '600', color: '#1e293b' }}>${(current.currentAssets * 0.3 / 1000).toFixed(0)}K</span>
                      </div>
                      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '12px', background: '#f8fafc', borderRadius: '8px' }}>
                        <span style={{ fontSize: '14px', color: '#64748b' }}>Accounts Receivable</span>
                        <span style={{ fontSize: '16px', fontWeight: '600', color: '#1e293b' }}>${(current.currentAssets * 0.4 / 1000).toFixed(0)}K</span>
                      </div>
                      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '12px', background: '#f8fafc', borderRadius: '8px' }}>
                        <span style={{ fontSize: '14px', color: '#64748b' }}>Inventory</span>
                        <span style={{ fontSize: '16px', fontWeight: '600', color: '#1e293b' }}>${(current.currentAssets * 0.2 / 1000).toFixed(0)}K</span>
                      </div>
                      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '12px', background: '#f8fafc', borderRadius: '8px' }}>
                        <span style={{ fontSize: '14px', color: '#64748b' }}>Other Current Assets</span>
                        <span style={{ fontSize: '16px', fontWeight: '600', color: '#1e293b' }}>${(current.currentAssets * 0.1 / 1000).toFixed(0)}K</span>
                      </div>
                      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '16px', background: '#667eea', borderRadius: '8px', marginTop: '8px' }}>
                        <span style={{ fontSize: '16px', fontWeight: '600', color: 'white' }}>Total Current Assets</span>
                        <span style={{ fontSize: '20px', fontWeight: '700', color: 'white' }}>${(current.currentAssets / 1000).toFixed(0)}K</span>
                      </div>
                    </div>
                  </div>
                  
                  <div style={{ background: 'white', borderRadius: '12px', padding: '24px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                    <h2 style={{ fontSize: '20px', fontWeight: '600', color: '#1e293b', marginBottom: '20px' }}>Current Liabilities</h2>
                    <div style={{ display: 'grid', gap: '12px' }}>
                      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '12px', background: '#f8fafc', borderRadius: '8px' }}>
                        <span style={{ fontSize: '14px', color: '#64748b' }}>Accounts Payable</span>
                        <span style={{ fontSize: '16px', fontWeight: '600', color: '#1e293b' }}>${(current.currentLiabilities * 0.6 / 1000).toFixed(0)}K</span>
                      </div>
                      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '12px', background: '#f8fafc', borderRadius: '8px' }}>
                        <span style={{ fontSize: '14px', color: '#64748b' }}>Accrued Expenses</span>
                        <span style={{ fontSize: '16px', fontWeight: '600', color: '#1e293b' }}>${(current.currentLiabilities * 0.25 / 1000).toFixed(0)}K</span>
                      </div>
                      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '12px', background: '#f8fafc', borderRadius: '8px' }}>
                        <span style={{ fontSize: '14px', color: '#64748b' }}>Other Current Liabilities</span>
                        <span style={{ fontSize: '16px', fontWeight: '600', color: '#1e293b' }}>${(current.currentLiabilities * 0.15 / 1000).toFixed(0)}K</span>
                      </div>
                      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '16px', background: '#ef4444', borderRadius: '8px', marginTop: '60px' }}>
                        <span style={{ fontSize: '16px', fontWeight: '600', color: 'white' }}>Total Current Liabilities</span>
                        <span style={{ fontSize: '20px', fontWeight: '700', color: 'white' }}>${(current.currentLiabilities / 1000).toFixed(0)}K</span>
                      </div>
                    </div>
                  </div>
                </div>
                
                {/* Working Capital Analysis */}
                <div className="wc-insights" style={{ background: 'white', borderRadius: '12px', padding: '24px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                  <h2 style={{ fontSize: '20px', fontWeight: '600', color: '#1e293b', marginBottom: '20px' }}>Working Capital Insights</h2>
                  
                  <div style={{ display: 'grid', gap: '16px' }}>
                    {currentWC > 0 && wcRatio >= 1.5 && (
                      <div style={{ padding: '16px', background: '#f0fdf4', borderRadius: '8px', borderLeft: '4px solid #10b981' }}>
                        <div style={{ fontSize: '14px', fontWeight: '600', color: '#166534', marginBottom: '4px' }}>✓ Strong Liquidity Position</div>
                        <div style={{ fontSize: '13px', color: '#166534', lineHeight: '1.6' }}>
                          Your working capital ratio of {wcRatio} indicates strong short-term financial health with ${(currentWC / 1000).toFixed(0)}K in working capital available to cover operational needs.
                        </div>
                      </div>
                    )}
                    
                    {currentWC > 0 && wcRatio < 1.5 && wcRatio >= 1.0 && (
                      <div style={{ padding: '16px', background: '#fffbeb', borderRadius: '8px', borderLeft: '4px solid #f59e0b' }}>
                        <div style={{ fontSize: '14px', fontWeight: '600', color: '#92400e', marginBottom: '4px' }}>⚠ Adequate but Monitor Closely</div>
                        <div style={{ fontSize: '13px', color: '#92400e', lineHeight: '1.6' }}>
                          Your working capital ratio of {wcRatio} is adequate but below ideal levels. Consider improving cash flow or reducing short-term liabilities to strengthen your position.
                        </div>
                      </div>
                    )}
                    
                    {wcRatio < 1.0 && (
                      <div style={{ padding: '16px', background: '#fef2f2', borderRadius: '8px', borderLeft: '4px solid #ef4444' }}>
                        <div style={{ fontSize: '14px', fontWeight: '600', color: '#991b1b', marginBottom: '4px' }}>⚠ Liquidity Concern</div>
                        <div style={{ fontSize: '13px', color: '#991b1b', lineHeight: '1.6' }}>
                          Your working capital ratio of {wcRatio} indicates current liabilities exceed current assets. Immediate attention to cash flow management and working capital optimization is recommended.
                        </div>
                      </div>
                    )}
                    
                    {wcChange > 0 && (
                      <div style={{ padding: '16px', background: '#f0f9ff', borderRadius: '8px', borderLeft: '4px solid #0284c7' }}>
                        <div style={{ fontSize: '14px', fontWeight: '600', color: '#0c4a6e', marginBottom: '4px' }}>↑ Positive Trend</div>
                        <div style={{ fontSize: '13px', color: '#0c4a6e', lineHeight: '1.6' }}>
                          Working capital has increased by ${(wcChange / 1000).toFixed(0)}K ({wcChangePercent.toFixed(1)}%) over the past year, indicating improved operational efficiency and financial stability.
                        </div>
                      </div>
                    )}
                  </div>
                </div>
              </>
            );
          })()}
        </div>
      )}

      {/* Valuation View */}
      {currentView === 'valuation' && selectedCompanyId && monthly.length > 0 && (
        <div style={{ maxWidth: '1400px', margin: '0 auto', padding: '32px' }}>
          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '32px' }}>
            <h1 style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b', margin: 0 }}>Business Valuation</h1>
            {companyName && <div style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b' }}>{companyName}</div>}
          </div>
          
          {(() => {
            // Calculate trailing 12 months values
            const last12 = monthly.slice(-12);
            const ttmRevenue = last12.reduce((sum, m) => sum + (m.revenue || 0), 0);
            const ttmCOGS = last12.reduce((sum, m) => sum + (m.cogsTotal || 0), 0);
            const ttmExpense = last12.reduce((sum, m) => sum + (m.expense || 0), 0);
            const ttmDepreciation = last12.reduce((sum, m) => sum + (m.depreciationExpense || 0), 0);
            const ttmInterest = last12.reduce((sum, m) => sum + (m.interestExpense || 0), 0);
            
            // Calculate Net Income correctly: Revenue - COGS - Operating Expenses
            const ttmGrossProfit = ttmRevenue - ttmCOGS;
            const ttmNetIncome = ttmRevenue - ttmCOGS - ttmExpense;
            
            // Calculate EBITDA: Net Income + Interest + Taxes + Depreciation + Amortization
            const ttmEBITDA = ttmNetIncome + ttmDepreciation + ttmInterest;
            // Note: We don't have a separate tax field, so this is technically EBIT if taxes are in 'expense'
            
            // Calculate SDE using ACTUAL Owner Base Pay from income statement
            const ttmOwnerBasePay = last12.reduce((sum, m) => sum + (m.ownersBasePay || 0), 0);
            const ttmSDE = ttmEBITDA + ttmOwnerBasePay;
            
            // Calculate valuations
            const sdeValuation = ttmSDE * sdeMultiplier;
            const ebitdaValuation = ttmEBITDA * ebitdaMultiplier;
            
            // Calculate Free Cash Flow (FCF) for DCF
            // FCF = Net Income + Depreciation - Changes in Working Capital - CapEx
            const currentMonth = monthly[monthly.length - 1];
            const month12Ago = monthly.length >= 13 ? monthly[monthly.length - 13] : monthly[0];
            
            // Working capital change over last 12 months
            const currentWC = ((currentMonth.cash || 0) + (currentMonth.ar || 0) + (currentMonth.inventory || 0)) - ((currentMonth.ap || 0) + (currentMonth.otherCL || 0));
            const priorWC = ((month12Ago.cash || 0) + (month12Ago.ar || 0) + (month12Ago.inventory || 0)) - ((month12Ago.ap || 0) + (month12Ago.otherCL || 0));
            const changeInWC = currentWC - priorWC;
            
            // Capital expenditures (change in fixed assets + depreciation)
            const changeInFixedAssets = (currentMonth.fixedAssets || 0) - (month12Ago.fixedAssets || 0);
            const ttmCapEx = Math.max(0, changeInFixedAssets + ttmDepreciation);
            
            // Free Cash Flow using ACTUAL depreciation
            const ttmFreeCashFlow = ttmNetIncome + ttmDepreciation - changeInWC - ttmCapEx;
            
            // DCF calculation with adjustable parameters using FCF
            const growthRate = growth_24mo / 100;
            const discountRate = dcfDiscountRate / 100;
            const terminalGrowthRate = dcfTerminalGrowth / 100;
            let dcfValue = 0;
            for (let year = 1; year <= 5; year++) {
              const projectedFCF = ttmFreeCashFlow * Math.pow(1 + growthRate, year);
              dcfValue += projectedFCF / Math.pow(1 + discountRate, year);
            }
            const terminalValue = (ttmFreeCashFlow * Math.pow(1 + growthRate, 5) * (1 + terminalGrowthRate)) / (discountRate - terminalGrowthRate);
            dcfValue += terminalValue / Math.pow(1 + discountRate, 5);
            
            return (
              <>
                {/* Overview Cards */}
                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '20px', marginBottom: '32px' }}>
                  <div style={{ background: 'white', borderRadius: '12px', padding: '24px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', border: '2px solid #10b981' }}>
                    <h3 style={{ fontSize: '14px', fontWeight: '600', color: '#64748b', marginBottom: '8px' }}>SDE Valuation</h3>
                    <div style={{ fontSize: '28px', fontWeight: '700', color: '#10b981', marginBottom: '8px' }}>
                      ${Math.round(sdeValuation).toLocaleString()}
                    </div>
                    <div style={{ fontSize: '13px', color: '#64748b' }}>
                      TTM SDE: ${(ttmSDE / 1000).toFixed(0)}K × {sdeMultiplier}x
                    </div>
                  </div>
                  
                  <div style={{ background: 'white', borderRadius: '12px', padding: '24px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', border: '2px solid #667eea' }}>
                    <h3 style={{ fontSize: '14px', fontWeight: '600', color: '#64748b', marginBottom: '8px' }}>EBITDA Valuation</h3>
                    <div style={{ fontSize: '28px', fontWeight: '700', color: '#667eea', marginBottom: '8px' }}>
                      ${Math.round(ebitdaValuation).toLocaleString()}
                    </div>
                    <div style={{ fontSize: '13px', color: '#64748b' }}>
                      TTM EBITDA: ${(ttmEBITDA / 1000).toFixed(0)}K × {ebitdaMultiplier}x
                    </div>
                  </div>
                  
                  <div style={{ background: 'white', borderRadius: '12px', padding: '24px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', border: '2px solid #f59e0b' }}>
                    <h3 style={{ fontSize: '14px', fontWeight: '600', color: '#64748b', marginBottom: '8px' }}>DCF Valuation</h3>
                    <div style={{ fontSize: '28px', fontWeight: '700', color: '#f59e0b', marginBottom: '8px' }}>
                      ${Math.round(dcfValue).toLocaleString()}
                    </div>
                    <div style={{ fontSize: '13px', color: '#64748b' }}>
                      5-year @ {dcfDiscountRate.toFixed(1)}% discount, {dcfTerminalGrowth.toFixed(1)}% terminal
                    </div>
                  </div>
                </div>
                
                {/* SDE Method */}
                <div style={{ background: 'white', borderRadius: '12px', padding: '24px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                  <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '20px' }}>
                    Seller's Discretionary Earnings (SDE) Method
                  </h2>
                  
                  <div style={{ background: '#f0fdf4', borderRadius: '8px', padding: '20px', marginBottom: '20px' }}>
                    <div style={{ marginBottom: '16px' }}>
                      <div style={{ fontSize: '14px', color: '#64748b', marginBottom: '4px' }}>Trailing 12 Months SDE</div>
                      <div style={{ fontSize: '28px', fontWeight: '700', color: '#10b981' }}>${(ttmSDE / 1000).toFixed(0)}K</div>
                    </div>
                    
                    <div style={{ fontSize: '13px', color: '#475569', lineHeight: '1.6' }}>
                      <strong>Calculation:</strong> EBITDA + Owner Base Pay + Discretionary Expenses
                      <br/>
                      = ${(ttmEBITDA / 1000).toFixed(0)}K + ${(ttmOwnerBasePay / 1000).toFixed(0)}K
                    </div>
                  </div>
                  
                  <div style={{ marginBottom: '20px' }}>
                    <label style={{ display: 'block', fontSize: '14px', fontWeight: '600', color: '#475569', marginBottom: '8px' }}>
                      SDE Multiple: {sdeMultiplier.toFixed(1)}x
                    </label>
                    <input 
                      type="range" 
                      min="1" 
                      max="5" 
                      step="0.1" 
                      value={sdeMultiplier} 
                      onChange={(e) => setSdeMultiplier(parseFloat(e.target.value))} 
                      style={{ width: '100%', marginBottom: '8px' }} 
                    />
                    <div style={{ fontSize: '12px', color: '#64748b', display: 'flex', justifyContent: 'space-between' }}>
                      <span>Typical Range: 1.5x - 4.0x</span>
                      <span>Industry Average: 2.5x</span>
                    </div>
                  </div>
                  
                  <div style={{ background: '#f8fafc', borderRadius: '8px', padding: '16px', border: '1px solid #e2e8f0' }}>
                    <div style={{ fontSize: '16px', fontWeight: '600', color: '#1e293b', marginBottom: '8px' }}>
                      Estimated Business Value (SDE)
                    </div>
                    <div style={{ fontSize: '36px', fontWeight: '700', color: '#10b981' }}>
                      ${Math.round(sdeValuation).toLocaleString()}
                    </div>
                    <div style={{ fontSize: '13px', color: '#64748b', marginTop: '4px' }}>
                      Range: ${Math.round(ttmSDE * 1.5).toLocaleString()} - ${Math.round(ttmSDE * 4.0).toLocaleString()}
                    </div>
                  </div>
                </div>
                
                {/* EBITDA Method */}
                <div style={{ background: 'white', borderRadius: '12px', padding: '24px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                  <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '20px' }}>
                    EBITDA Multiple Method
                  </h2>
                  
                  <div style={{ background: '#ede9fe', borderRadius: '8px', padding: '20px', marginBottom: '20px' }}>
                    <div style={{ marginBottom: '16px' }}>
                      <div style={{ fontSize: '14px', color: '#64748b', marginBottom: '4px' }}>Trailing 12 Months EBITDA</div>
                      <div style={{ fontSize: '28px', fontWeight: '700', color: '#667eea' }}>${(ttmEBITDA / 1000).toFixed(0)}K</div>
                    </div>
                    
                    <div style={{ fontSize: '13px', color: '#475569', lineHeight: '1.6' }}>
                      <strong>Calculation:</strong> Net Income + Interest + Depreciation & Amortization
                      <br/>
                      = ${(ttmNetIncome / 1000).toFixed(0)}K + ${(ttmInterest / 1000).toFixed(0)}K + ${(ttmDepreciation / 1000).toFixed(0)}K
                      <br/>
                      <em style={{ fontSize: '12px', color: '#64748b' }}>Note: D&A and Interest are added back to Net Income</em>
                    </div>
                  </div>
                  
                  <div style={{ marginBottom: '20px' }}>
                    <label style={{ display: 'block', fontSize: '14px', fontWeight: '600', color: '#475569', marginBottom: '8px' }}>
                      EBITDA Multiple: {ebitdaMultiplier.toFixed(1)}x
                    </label>
                    <input 
                      type="range" 
                      min="2" 
                      max="10" 
                      step="0.1" 
                      value={ebitdaMultiplier} 
                      onChange={(e) => setEbitdaMultiplier(parseFloat(e.target.value))} 
                      style={{ width: '100%', marginBottom: '8px' }} 
                    />
                    <div style={{ fontSize: '12px', color: '#64748b', display: 'flex', justifyContent: 'space-between' }}>
                      <span>Typical Range: 3.0x - 8.0x</span>
                      <span>Industry Average: 5.0x</span>
                    </div>
                  </div>
                  
                  <div style={{ background: '#f8fafc', borderRadius: '8px', padding: '16px', border: '1px solid #e2e8f0' }}>
                    <div style={{ fontSize: '16px', fontWeight: '600', color: '#1e293b', marginBottom: '8px' }}>
                      Estimated Business Value (EBITDA)
                    </div>
                    <div style={{ fontSize: '36px', fontWeight: '700', color: '#667eea' }}>
                      ${Math.round(ebitdaValuation).toLocaleString()}
                    </div>
                    <div style={{ fontSize: '13px', color: '#64748b', marginTop: '4px' }}>
                      Range: ${Math.round(ttmEBITDA * 3.0).toLocaleString()} - ${Math.round(ttmEBITDA * 8.0).toLocaleString()}
                    </div>
                  </div>
                </div>
                
                {/* DCF Method */}
                <div style={{ background: 'white', borderRadius: '12px', padding: '24px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                  <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '20px' }}>
                    Discounted Cash Flow (DCF) Method
                  </h2>
                  
                  <div style={{ background: '#fef3c7', borderRadius: '8px', padding: '20px', marginBottom: '20px' }}>
                    <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '20px', marginBottom: '16px' }}>
                      <div>
                        <div style={{ fontSize: '12px', color: '#92400e', marginBottom: '4px' }}>Historical Growth Rate</div>
                        <div style={{ fontSize: '20px', fontWeight: '700', color: '#f59e0b' }}>{growth_24mo.toFixed(1)}%</div>
                        <div style={{ fontSize: '11px', color: '#92400e', marginTop: '2px' }}>Used for 5-year projection</div>
                      </div>
                      <div>
                        <div style={{ fontSize: '12px', color: '#92400e', marginBottom: '4px' }}>Discount Rate</div>
                        <div style={{ fontSize: '20px', fontWeight: '700', color: '#f59e0b' }}>{dcfDiscountRate.toFixed(1)}%</div>
                        <div style={{ fontSize: '11px', color: '#92400e', marginTop: '2px' }}>Risk-adjusted rate</div>
                      </div>
                      <div>
                        <div style={{ fontSize: '12px', color: '#92400e', marginBottom: '4px' }}>Terminal Growth</div>
                        <div style={{ fontSize: '20px', fontWeight: '700', color: '#f59e0b' }}>{dcfTerminalGrowth.toFixed(1)}%</div>
                        <div style={{ fontSize: '11px', color: '#92400e', marginTop: '2px' }}>Perpetuity growth</div>
                      </div>
                    </div>
                    
                    <div style={{ fontSize: '13px', color: '#78350f', lineHeight: '1.6', marginBottom: '16px' }}>
                      5-year free cash flow projection based on historical growth rate, discounted to present value. Includes terminal value calculation for perpetuity beyond forecast period.
                    </div>
                  </div>
                  
                  {/* Free Cash Flow Calculation */}
                  <div style={{ background: '#fef3c7', borderRadius: '8px', padding: '20px', marginBottom: '20px', border: '1px solid #fcd34d' }}>
                    <div style={{ marginBottom: '16px' }}>
                      <div style={{ fontSize: '14px', color: '#92400e', marginBottom: '8px', fontWeight: '600' }}>Trailing 12 Months Free Cash Flow</div>
                      <div style={{ fontSize: '28px', fontWeight: '700', color: '#f59e0b' }}>${(ttmFreeCashFlow / 1000).toFixed(0)}K</div>
                    </div>
                    
                    <div style={{ fontSize: '13px', color: '#78350f', lineHeight: '1.8' }}>
                      <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '6px' }}>
                        <span>TTM Revenue</span>
                        <span style={{ fontWeight: '600' }}>${(ttmRevenue / 1000).toFixed(0)}K</span>
                      </div>
                      <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '6px' }}>
                        <span>- COGS</span>
                        <span style={{ fontWeight: '600' }}>${(ttmCOGS / 1000).toFixed(0)}K</span>
                      </div>
                      <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '6px' }}>
                        <span>- Operating Expenses</span>
                        <span style={{ fontWeight: '600' }}>${(ttmExpense / 1000).toFixed(0)}K</span>
                      </div>
                      <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '12px', paddingBottom: '6px', borderBottom: '1px solid #fcd34d' }}>
                        <span style={{ fontWeight: '600' }}>= Net Income</span>
                        <span style={{ fontWeight: '600' }}>${(ttmNetIncome / 1000).toFixed(0)}K</span>
                      </div>
                      <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '6px' }}>
                        <span>+ Depreciation/Amortization</span>
                        <span style={{ fontWeight: '600' }}>${(ttmDepreciation / 1000).toFixed(0)}K</span>
                      </div>
                      <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '6px' }}>
                        <span>- Change in Working Capital</span>
                        <span style={{ fontWeight: '600' }}>${(changeInWC / 1000).toFixed(0)}K</span>
                      </div>
                      <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '6px', paddingBottom: '6px', borderBottom: '1px solid #fcd34d' }}>
                        <span>- Capital Expenditures</span>
                        <span style={{ fontWeight: '600' }}>${(ttmCapEx / 1000).toFixed(0)}K</span>
                      </div>
                      <div style={{ display: 'flex', justifyContent: 'space-between', marginTop: '8px' }}>
                        <span style={{ fontWeight: '700' }}>= Free Cash Flow</span>
                        <span style={{ fontWeight: '700', color: '#f59e0b' }}>${(ttmFreeCashFlow / 1000).toFixed(0)}K</span>
                      </div>
                    </div>
                  </div>
                  
                  {/* Adjustable Parameters */}
                  <div style={{ marginBottom: '20px' }}>
                    <label style={{ display: 'block', fontSize: '14px', fontWeight: '600', color: '#475569', marginBottom: '8px' }}>
                      Discount Rate (WACC): {dcfDiscountRate.toFixed(1)}%
                    </label>
                    <input 
                      type="range" 
                      min="5" 
                      max="20" 
                      step="0.5" 
                      value={dcfDiscountRate} 
                      onChange={(e) => setDcfDiscountRate(parseFloat(e.target.value))} 
                      style={{ width: '100%', marginBottom: '8px' }} 
                    />
                    <div style={{ fontSize: '12px', color: '#64748b', display: 'flex', justifyContent: 'space-between' }}>
                      <span>Lower Risk: 5-8%</span>
                      <span>Typical: 10-12%</span>
                      <span>Higher Risk: 15-20%</span>
                    </div>
                  </div>
                  
                  <div style={{ marginBottom: '20px' }}>
                    <label style={{ display: 'block', fontSize: '14px', fontWeight: '600', color: '#475569', marginBottom: '8px' }}>
                      Terminal Growth Rate: {dcfTerminalGrowth.toFixed(1)}%
                    </label>
                    <input 
                      type="range" 
                      min="0" 
                      max="5" 
                      step="0.5" 
                      value={dcfTerminalGrowth} 
                      onChange={(e) => setDcfTerminalGrowth(parseFloat(e.target.value))} 
                      style={{ width: '100%', marginBottom: '8px' }} 
                    />
                    <div style={{ fontSize: '12px', color: '#64748b', display: 'flex', justifyContent: 'space-between' }}>
                      <span>Conservative: 0-2%</span>
                      <span>Typical: 2-3%</span>
                      <span>Optimistic: 3-5%</span>
                    </div>
                  </div>
                  
                  <div style={{ background: '#f8fafc', borderRadius: '8px', padding: '16px', border: '1px solid #e2e8f0' }}>
                    <div style={{ fontSize: '16px', fontWeight: '600', color: '#1e293b', marginBottom: '8px' }}>
                      Estimated Business Value (DCF)
                    </div>
                    <div style={{ fontSize: '36px', fontWeight: '700', color: '#f59e0b' }}>
                      ${Math.round(dcfValue).toLocaleString()}
                    </div>
                    <div style={{ fontSize: '13px', color: '#64748b', marginTop: '8px' }}>
                      <strong>Note:</strong> DCF based on Free Cash Flow (FCF) projections. Valuations are highly sensitive to assumptions about growth rates, discount rates, working capital, and capital expenditures.
                    </div>
                  </div>
                </div>
              </>
            );
          })()}
        </div>
      )}

      {/* Cash Flow View */}
      {currentView === 'cash-flow' && selectedCompanyId && monthly.length > 0 && (
        <div style={{ maxWidth: '1400px', margin: '0 auto', padding: '32px' }}>
          <style>{`
            @media print {
              @page {
                size: portrait;
                margin: 0.3in;
              }
              
              /* Hide navigation and UI elements */
              .no-print,
              header,
              nav,
              aside,
              [role="navigation"],
              button {
                display: none !important;
              }
              
              /* Remove background colors and shadows */
              * {
                box-shadow: none !important;
              }
              
              /* First page: Summary cards and start of table */
              .cf-summary-cards {
                page-break-after: avoid;
              }
              
              /* Force page break before metrics section */
              .cf-metrics-section {
                page-break-before: always;
                margin-top: 0 !important;
              }
              
              /* Scale down content to fit portrait */
              .cf-table-container {
                transform: scale(0.75);
                transform-origin: top left;
                width: 133.33%;
              }
              
              /* Reduce font sizes for compact display */
              h1 {
                font-size: 20px !important;
                margin-bottom: 12px !important;
              }
              
              h2 {
                font-size: 16px !important;
                margin-bottom: 12px !important;
              }
              
              /* Compress summary cards */
              .cf-summary-cards > div {
                padding: 12px !important;
              }
              
              .cf-summary-cards > div > div:first-child {
                font-size: 10px !important;
              }
              
              .cf-summary-cards > div > div:nth-child(2) {
                font-size: 20px !important;
              }
              
              .cf-summary-cards > div > div:last-child {
                font-size: 9px !important;
              }
              
              /* Table styling */
              table {
                font-size: 9px !important;
              }
              
              th, td {
                padding: 4px 6px !important;
              }
            }
          `}</style>
          
          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '16px' }}>
            <h1 style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b', margin: 0 }}>Cash Flow Analysis</h1>
            <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
              {companyName && <div style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b' }}>{companyName}</div>}
              {cashFlowDisplay !== 'monthly' && (
                <button 
                  className="no-print"
                  onClick={() => window.print()} 
                  style={{ 
                    padding: '12px 24px', 
                    background: '#667eea', 
                    color: 'white', 
                    border: 'none', 
                    borderRadius: '8px', 
                    fontSize: '14px', 
                    fontWeight: '600', 
                    cursor: 'pointer',
                    boxShadow: '0 2px 8px rgba(102, 126, 234, 0.3)'
                  }}>
                  🖨️ Print
                </button>
              )}
            </div>
          </div>
          
          {/* Display Period Tabs */}
          <div style={{ display: 'flex', gap: '8px', marginBottom: '32px', borderBottom: '2px solid #e2e8f0' }}>
            <button
              onClick={() => setCashFlowDisplay('monthly')}
              style={{
                padding: '12px 24px',
                background: cashFlowDisplay === 'monthly' ? '#667eea' : 'transparent',
                color: cashFlowDisplay === 'monthly' ? 'white' : '#64748b',
                border: 'none',
                borderBottom: cashFlowDisplay === 'monthly' ? '3px solid #667eea' : '3px solid transparent',
                fontSize: '16px',
                fontWeight: '600',
                cursor: 'pointer',
                borderRadius: '8px 8px 0 0',
                transition: 'all 0.2s'
              }}
            >
              Last 36 Months
            </button>
            <button
              onClick={() => setCashFlowDisplay('quarterly')}
              style={{
                padding: '12px 24px',
                background: cashFlowDisplay === 'quarterly' ? '#667eea' : 'transparent',
                color: cashFlowDisplay === 'quarterly' ? 'white' : '#64748b',
                border: 'none',
                borderBottom: cashFlowDisplay === 'quarterly' ? '3px solid #667eea' : '3px solid transparent',
                fontSize: '16px',
                fontWeight: '600',
                cursor: 'pointer',
                borderRadius: '8px 8px 0 0',
                transition: 'all 0.2s'
              }}
            >
              Last 4 Quarters
            </button>
            <button
              onClick={() => setCashFlowDisplay('annual')}
              style={{
                padding: '12px 24px',
                background: cashFlowDisplay === 'annual' ? '#667eea' : 'transparent',
                color: cashFlowDisplay === 'annual' ? 'white' : '#64748b',
                border: 'none',
                borderBottom: cashFlowDisplay === 'annual' ? '3px solid #667eea' : '3px solid transparent',
                fontSize: '16px',
                fontWeight: '600',
                cursor: 'pointer',
                borderRadius: '8px 8px 0 0',
                transition: 'all 0.2s'
              }}
            >
              Last 3 Years
            </button>
          </div>

          {(() => {
            // Calculate cash flow data based on view
            const dataMonths = cashFlowDisplay === 'quarterly' ? 12 : Math.min(36, monthly.length);
            const dataSet = monthly.slice(-dataMonths);
            
            const cashFlowData = dataSet.map((curr, idx) => {
              const prev = idx === 0 && monthly.length > dataMonths ? monthly[monthly.length - dataMonths - 1] : (idx > 0 ? dataSet[idx - 1] : curr);
              
              // Operating Activities
              const netIncome = curr.revenue - curr.expense;
              const depreciation = curr.depreciationExpense || 0; // Depreciation and amortization expense
              const changeInAR = curr.ar - prev.ar;
              const changeInInventory = curr.inventory - prev.inventory;
              const changeInAP = curr.ap - prev.ap;
              const changeInWorkingCapital = -(changeInAR + changeInInventory - changeInAP);
              const operatingCashFlow = netIncome + depreciation + changeInWorkingCapital;
              
              // Investing Activities
              const changeInFixedAssets = curr.fixedAssets - prev.fixedAssets;
              const capitalExpenditures = changeInFixedAssets + depreciation; // Add back depreciation to estimate CapEx
              const investingCashFlow = -capitalExpenditures;
              
              // Financing Activities
              const changeInDebt = curr.ltd - prev.ltd;
              const changeInEquity = curr.totalEquity - prev.totalEquity - netIncome; // Equity change excluding net income
              const financingCashFlow = changeInDebt + changeInEquity;
              
              // Net Change and Free Cash Flow
              const netCashChange = operatingCashFlow + investingCashFlow + financingCashFlow;
              const freeCashFlow = operatingCashFlow - Math.max(0, capitalExpenditures);
              
              // Metrics
              const cashFlowMargin = curr.revenue > 0 ? (operatingCashFlow / curr.revenue) * 100 : 0;
              const daysCashOnHand = operatingCashFlow > 0 ? (curr.cash / (operatingCashFlow / 30)) : 0;
              
              return {
                month: curr.month,
                netIncome,
                depreciation,
                changeInWorkingCapital,
                operatingCashFlow,
                capitalExpenditures,
                investingCashFlow,
                changeInDebt,
                changeInEquity,
                financingCashFlow,
                netCashChange,
                freeCashFlow,
                cashFlowMargin,
                daysCashOnHand,
                endingCash: curr.cash
              };
            });

            // Aggregate data based on display selection
            let displayData = cashFlowData;
            if (cashFlowDisplay === 'quarterly') {
              // Aggregate into quarters (3 months each)
              displayData = [];
              for (let i = 0; i < cashFlowData.length; i += 3) {
                const quarter = cashFlowData.slice(i, i + 3);
                const quarterEnd = quarter[quarter.length - 1].month;
                const aggregated = {
                  month: quarterEnd,
                  netIncome: quarter.reduce((sum, d) => sum + d.netIncome, 0),
                  depreciation: quarter.reduce((sum, d) => sum + d.depreciation, 0),
                  changeInWorkingCapital: quarter.reduce((sum, d) => sum + d.changeInWorkingCapital, 0),
                  operatingCashFlow: quarter.reduce((sum, d) => sum + d.operatingCashFlow, 0),
                  capitalExpenditures: quarter.reduce((sum, d) => sum + d.capitalExpenditures, 0),
                  investingCashFlow: quarter.reduce((sum, d) => sum + d.investingCashFlow, 0),
                  changeInDebt: quarter.reduce((sum, d) => sum + d.changeInDebt, 0),
                  changeInEquity: quarter.reduce((sum, d) => sum + d.changeInEquity, 0),
                  financingCashFlow: quarter.reduce((sum, d) => sum + d.financingCashFlow, 0),
                  netCashChange: quarter.reduce((sum, d) => sum + d.netCashChange, 0),
                  freeCashFlow: quarter.reduce((sum, d) => sum + d.freeCashFlow, 0),
                  cashFlowMargin: quarter.reduce((sum, d) => sum + d.cashFlowMargin, 0) / quarter.length,
                  daysCashOnHand: quarter[quarter.length - 1].daysCashOnHand,
                  endingCash: quarter[quarter.length - 1].endingCash
                };
                displayData.push(aggregated);
              }
            } else if (cashFlowDisplay === 'annual') {
              // Aggregate into 3 annual periods (12 months each)
              displayData = [];
              const totalMonths = cashFlowData.length;
              const yearsToShow = Math.min(3, Math.floor(totalMonths / 12));
              
              for (let i = 0; i < yearsToShow; i++) {
                const yearStart = totalMonths - (yearsToShow - i) * 12;
                const yearEnd = yearStart + 12;
                const yearData = cashFlowData.slice(yearStart, yearEnd);
                
                if (yearData.length > 0) {
                  const yearEndDate = yearData[yearData.length - 1].month;
                  displayData.push({
                    month: yearEndDate,
                    netIncome: yearData.reduce((sum, d) => sum + d.netIncome, 0),
                    depreciation: yearData.reduce((sum, d) => sum + d.depreciation, 0),
                    changeInWorkingCapital: yearData.reduce((sum, d) => sum + d.changeInWorkingCapital, 0),
                    operatingCashFlow: yearData.reduce((sum, d) => sum + d.operatingCashFlow, 0),
                    capitalExpenditures: yearData.reduce((sum, d) => sum + d.capitalExpenditures, 0),
                    investingCashFlow: yearData.reduce((sum, d) => sum + d.investingCashFlow, 0),
                    changeInDebt: yearData.reduce((sum, d) => sum + d.changeInDebt, 0),
                    changeInEquity: yearData.reduce((sum, d) => sum + d.changeInEquity, 0),
                    financingCashFlow: yearData.reduce((sum, d) => sum + d.financingCashFlow, 0),
                    netCashChange: yearData.reduce((sum, d) => sum + d.netCashChange, 0),
                    freeCashFlow: yearData.reduce((sum, d) => sum + d.freeCashFlow, 0),
                    cashFlowMargin: yearData.reduce((sum, d) => sum + d.cashFlowMargin, 0) / yearData.length,
                    daysCashOnHand: yearData[yearData.length - 1].daysCashOnHand,
                    endingCash: yearData[yearData.length - 1].endingCash
                  });
                }
              }
            }

            // Summary metrics - always use last 12 months for consistency
            const last12MonthsData = monthly.slice(-12).map((curr, idx) => {
              const prev = idx === 0 && monthly.length > 12 ? monthly[monthly.length - 13] : (idx > 0 ? monthly.slice(-12)[idx - 1] : curr);
              const netIncome = curr.revenue - curr.expense;
              const depreciation = curr.depreciationExpense || 0;
              const changeInAR = curr.ar - prev.ar;
              const changeInInventory = curr.inventory - prev.inventory;
              const changeInAP = curr.ap - prev.ap;
              const changeInWorkingCapital = -(changeInAR + changeInInventory - changeInAP);
              const operatingCashFlow = netIncome + depreciation + changeInWorkingCapital;
              const changeInFixedAssets = curr.fixedAssets - prev.fixedAssets;
              const capitalExpenditures = changeInFixedAssets + depreciation;
              const investingCashFlow = -capitalExpenditures;
              const changeInDebt = curr.ltd - prev.ltd;
              const changeInEquity = curr.totalEquity - prev.totalEquity - netIncome;
              const financingCashFlow = changeInDebt + changeInEquity;
              const freeCashFlow = operatingCashFlow - Math.max(0, capitalExpenditures);
              const cashFlowMargin = curr.revenue > 0 ? (operatingCashFlow / curr.revenue) * 100 : 0;
              return { operatingCashFlow, investingCashFlow, financingCashFlow, freeCashFlow, cashFlowMargin };
            });
            const totalOperatingCF = last12MonthsData.reduce((sum, d) => sum + d.operatingCashFlow, 0);
            const totalInvestingCF = last12MonthsData.reduce((sum, d) => sum + d.investingCashFlow, 0);
            const totalFinancingCF = last12MonthsData.reduce((sum, d) => sum + d.financingCashFlow, 0);
            const totalFreeCF = last12MonthsData.reduce((sum, d) => sum + d.freeCashFlow, 0);
            const avgCashFlowMargin = last12MonthsData.reduce((sum, d) => sum + d.cashFlowMargin, 0) / last12MonthsData.length;

            return (
              <>
                {/* Summary Cards */}
                <div className="cf-summary-cards" style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '16px', marginBottom: '32px' }}>
                  <div style={{ background: 'white', borderRadius: '12px', padding: '20px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', border: '2px solid #10b981' }}>
                    <div style={{ fontSize: '12px', fontWeight: '600', color: '#64748b', marginBottom: '4px' }}>Operating Cash Flow (12mo)</div>
                    <div style={{ fontSize: '28px', fontWeight: '700', color: '#10b981' }}>
                      ${(totalOperatingCF / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K
                    </div>
                    <div style={{ fontSize: '11px', color: '#64748b', marginTop: '4px' }}>Cash from operations</div>
                  </div>
                  
                  <div style={{ background: 'white', borderRadius: '12px', padding: '20px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', border: '2px solid #ef4444' }}>
                    <div style={{ fontSize: '12px', fontWeight: '600', color: '#64748b', marginBottom: '4px' }}>Investing Cash Flow (12mo)</div>
                    <div style={{ fontSize: '28px', fontWeight: '700', color: '#ef4444' }}>
                      ${(totalInvestingCF / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K
                    </div>
                    <div style={{ fontSize: '11px', color: '#64748b', marginTop: '4px' }}>CapEx & investments</div>
                  </div>
                  
                  <div style={{ background: 'white', borderRadius: '12px', padding: '20px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', border: '2px solid #3b82f6' }}>
                    <div style={{ fontSize: '12px', fontWeight: '600', color: '#64748b', marginBottom: '4px' }}>Financing Cash Flow (12mo)</div>
                    <div style={{ fontSize: '28px', fontWeight: '700', color: '#3b82f6' }}>
                      ${(totalFinancingCF / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K
                    </div>
                    <div style={{ fontSize: '11px', color: '#64748b', marginTop: '4px' }}>Debt & equity changes</div>
                  </div>
                  
                  <div style={{ background: 'white', borderRadius: '12px', padding: '20px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', border: '2px solid #667eea' }}>
                    <div style={{ fontSize: '12px', fontWeight: '600', color: '#64748b', marginBottom: '4px' }}>Free Cash Flow (12mo)</div>
                    <div style={{ fontSize: '28px', fontWeight: '700', color: totalFreeCF >= 0 ? '#10b981' : '#ef4444' }}>
                      ${(totalFreeCF / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K
                    </div>
                    <div style={{ fontSize: '11px', color: '#64748b', marginTop: '4px' }}>OCF - CapEx</div>
                  </div>
                  
                  <div style={{ background: 'white', borderRadius: '12px', padding: '20px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', border: '2px solid #f59e0b' }}>
                    <div style={{ fontSize: '12px', fontWeight: '600', color: '#64748b', marginBottom: '4px' }}>Avg Cash Flow Margin</div>
                    <div style={{ fontSize: '28px', fontWeight: '700', color: '#f59e0b' }}>
                      {avgCashFlowMargin.toFixed(1)}%
                    </div>
                    <div style={{ fontSize: '11px', color: '#64748b', marginTop: '4px' }}>OCF / Revenue</div>
                  </div>
                </div>

                {/* Cash Flow Statement Table */}
                <div className="cf-table-container" style={{ background: 'white', borderRadius: '12px', padding: '32px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                  <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '12px' }}>Statement of Cash Flows</h2>
                  
                  <div style={{ overflowX: 'auto' }}>
                    <table style={{ width: '100%', fontSize: '12px', borderCollapse: 'collapse' }}>
                      <thead>
                        <tr style={{ borderBottom: '2px solid #e2e8f0' }}>
                          <th style={{ textAlign: 'left', padding: '10px', fontSize: '13px', fontWeight: '600', color: '#64748b', position: 'sticky', left: 0, background: 'white', minWidth: '200px' }}>Cash Flow Item</th>
                          {displayData.map((cf, i) => (
                            <th key={i} style={{ textAlign: 'right', padding: '10px', fontSize: '11px', fontWeight: '600', color: '#64748b', minWidth: '90px' }}>
                              {cf.month}
                            </th>
                          ))}
                        </tr>
                      </thead>
                      <tbody>
                        {/* Operating Activities */}
                        <tr style={{ background: '#f0fdf4' }}>
                          <td colSpan={13} style={{ padding: '12px 10px', fontSize: '14px', fontWeight: '700', color: '#065f46' }}>
                            OPERATING ACTIVITIES
                          </td>
                        </tr>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '8px 10px', fontSize: '12px', color: '#475569', paddingLeft: '24px' }}>Net Income</td>
                          {displayData.map((cf, i) => (
                            <td key={i} style={{ padding: '8px 10px', fontSize: '12px', color: '#1e293b', textAlign: 'right' }}>
                              ${cf.netIncome.toLocaleString()}
                            </td>
                          ))}
                        </tr>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '8px 10px', fontSize: '12px', color: '#475569', paddingLeft: '24px' }}>+ Depreciation</td>
                          {displayData.map((cf, i) => (
                            <td key={i} style={{ padding: '8px 10px', fontSize: '12px', color: '#1e293b', textAlign: 'right' }}>
                              ${cf.depreciation.toLocaleString()}
                            </td>
                          ))}
                        </tr>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '8px 10px', fontSize: '12px', color: '#475569', paddingLeft: '24px' }}>+ Change in Working Capital</td>
                          {displayData.map((cf, i) => (
                            <td key={i} style={{ padding: '8px 10px', fontSize: '12px', color: cf.changeInWorkingCapital >= 0 ? '#10b981' : '#ef4444', textAlign: 'right' }}>
                              ${cf.changeInWorkingCapital.toLocaleString()}
                            </td>
                          ))}
                        </tr>
                        <tr style={{ borderBottom: '2px solid #10b981', background: '#f0fdf4' }}>
                          <td style={{ padding: '10px', fontSize: '13px', fontWeight: '700', color: '#065f46' }}>Operating Cash Flow</td>
                          {displayData.map((cf, i) => (
                            <td key={i} style={{ padding: '10px', fontSize: '13px', fontWeight: '700', color: '#065f46', textAlign: 'right' }}>
                              ${cf.operatingCashFlow.toLocaleString()}
                            </td>
                          ))}
                        </tr>
                        
                        {/* Investing Activities */}
                        <tr style={{ background: '#fef2f2' }}>
                          <td colSpan={13} style={{ padding: '12px 10px', fontSize: '14px', fontWeight: '700', color: '#991b1b' }}>
                            INVESTING ACTIVITIES
                          </td>
                        </tr>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '8px 10px', fontSize: '12px', color: '#475569', paddingLeft: '24px' }}>Capital Expenditures</td>
                          {displayData.map((cf, i) => (
                            <td key={i} style={{ padding: '8px 10px', fontSize: '12px', color: '#ef4444', textAlign: 'right' }}>
                              (${cf.capitalExpenditures.toLocaleString()})
                            </td>
                          ))}
                        </tr>
                        <tr style={{ borderBottom: '2px solid #ef4444', background: '#fef2f2' }}>
                          <td style={{ padding: '10px', fontSize: '13px', fontWeight: '700', color: '#991b1b' }}>Investing Cash Flow</td>
                          {displayData.map((cf, i) => (
                            <td key={i} style={{ padding: '10px', fontSize: '13px', fontWeight: '700', color: '#991b1b', textAlign: 'right' }}>
                              ${cf.investingCashFlow.toLocaleString()}
                            </td>
                          ))}
                        </tr>
                        
                        {/* Financing Activities */}
                        <tr style={{ background: '#eff6ff' }}>
                          <td colSpan={13} style={{ padding: '12px 10px', fontSize: '14px', fontWeight: '700', color: '#1e40af' }}>
                            FINANCING ACTIVITIES
                          </td>
                        </tr>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '8px 10px', fontSize: '12px', color: '#475569', paddingLeft: '24px' }}>Change in Long-Term Debt</td>
                          {displayData.map((cf, i) => (
                            <td key={i} style={{ padding: '8px 10px', fontSize: '12px', color: cf.changeInDebt >= 0 ? '#10b981' : '#ef4444', textAlign: 'right' }}>
                              ${cf.changeInDebt.toLocaleString()}
                            </td>
                          ))}
                        </tr>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '8px 10px', fontSize: '12px', color: '#475569', paddingLeft: '24px' }}>Change in Equity</td>
                          {displayData.map((cf, i) => (
                            <td key={i} style={{ padding: '8px 10px', fontSize: '12px', color: cf.changeInEquity >= 0 ? '#10b981' : '#ef4444', textAlign: 'right' }}>
                              ${cf.changeInEquity.toLocaleString()}
                            </td>
                          ))}
                        </tr>
                        <tr style={{ borderBottom: '2px solid #3b82f6', background: '#eff6ff' }}>
                          <td style={{ padding: '10px', fontSize: '13px', fontWeight: '700', color: '#1e40af' }}>Financing Cash Flow</td>
                          {displayData.map((cf, i) => (
                            <td key={i} style={{ padding: '10px', fontSize: '13px', fontWeight: '700', color: '#1e40af', textAlign: 'right' }}>
                              ${cf.financingCashFlow.toLocaleString()}
                            </td>
                          ))}
                        </tr>
                        
                        {/* Net Change */}
                        <tr style={{ borderBottom: '3px double #1e293b', background: '#f8fafc' }}>
                          <td style={{ padding: '12px 10px', fontSize: '14px', fontWeight: '700', color: '#1e293b' }}>Net Change in Cash</td>
                          {displayData.map((cf, i) => (
                            <td key={i} style={{ padding: '12px 10px', fontSize: '14px', fontWeight: '700', color: cf.netCashChange >= 0 ? '#10b981' : '#ef4444', textAlign: 'right' }}>
                              ${cf.netCashChange.toLocaleString()}
                            </td>
                          ))}
                        </tr>
                        <tr style={{ background: '#fef3c7' }}>
                          <td style={{ padding: '10px', fontSize: '13px', fontWeight: '700', color: '#92400e' }}>Free Cash Flow</td>
                          {displayData.map((cf, i) => (
                            <td key={i} style={{ padding: '10px', fontSize: '13px', fontWeight: '700', color: cf.freeCashFlow >= 0 ? '#065f46' : '#991b1b', textAlign: 'right' }}>
                              ${cf.freeCashFlow.toLocaleString()}
                            </td>
                          ))}
                        </tr>
                        <tr style={{ borderBottom: '2px solid #e2e8f0' }}>
                          <td style={{ padding: '10px', fontSize: '13px', fontWeight: '600', color: '#475569' }}>Ending Cash Balance</td>
                          {displayData.map((cf, i) => (
                            <td key={i} style={{ padding: '10px', fontSize: '13px', fontWeight: '600', color: '#1e293b', textAlign: 'right' }}>
                              ${cf.endingCash.toLocaleString()}
                            </td>
                          ))}
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>

                {/* Cash Flow Metrics */}
                <div className="cf-metrics-section" style={{ background: 'white', borderRadius: '12px', padding: '32px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                  <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '12px' }}>Cash Flow Metrics</h2>
                  
                  <div style={{ overflowX: 'auto' }}>
                    <table style={{ width: '100%', fontSize: '12px', borderCollapse: 'collapse' }}>
                      <thead>
                        <tr style={{ borderBottom: '2px solid #e2e8f0' }}>
                          <th style={{ textAlign: 'left', padding: '10px', fontSize: '13px', fontWeight: '600', color: '#64748b', position: 'sticky', left: 0, background: 'white', minWidth: '180px' }}>Metric</th>
                          {displayData.map((cf, i) => (
                            <th key={i} style={{ textAlign: 'right', padding: '10px', fontSize: '11px', fontWeight: '600', color: '#64748b', minWidth: '90px' }}>
                              {cf.month}
                            </th>
                          ))}
                        </tr>
                      </thead>
                      <tbody>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '8px 10px', fontSize: '12px', color: '#475569' }}>Cash Flow Margin (%)</td>
                          {displayData.map((cf, i) => (
                            <td key={i} style={{ padding: '8px 10px', fontSize: '12px', color: '#1e293b', textAlign: 'right' }}>
                              {cf.cashFlowMargin.toFixed(1)}%
                            </td>
                          ))}
                        </tr>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '8px 10px', fontSize: '12px', color: '#475569' }}>Days Cash on Hand</td>
                          {displayData.map((cf, i) => (
                            <td key={i} style={{ padding: '8px 10px', fontSize: '12px', color: '#1e293b', textAlign: 'right' }}>
                              {cf.daysCashOnHand.toFixed(0)} days
                            </td>
                          ))}
                        </tr>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '8px 10px', fontSize: '12px', color: '#475569' }}>Cash Conversion Rate</td>
                          {displayData.map((cf, i) => (
                            <td key={i} style={{ padding: '8px 10px', fontSize: '12px', color: '#1e293b', textAlign: 'right' }}>
                              {cf.netIncome > 0 ? ((cf.operatingCashFlow / cf.netIncome) * 100).toFixed(0) : 'N/A'}%
                            </td>
                          ))}
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>

                {/* Key Insights */}
                <div style={{ background: 'white', borderRadius: '12px', padding: '32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                  <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '12px' }}>Cash Flow Insights</h2>
                  
                  <div style={{ display: 'grid', gap: '16px' }}>
                    {totalOperatingCF > 0 ? (
                      <div style={{ padding: '16px', background: '#f0fdf4', border: '1px solid #86efac', borderRadius: '8px' }}>
                        <div style={{ fontSize: '14px', fontWeight: '600', color: '#065f46', marginBottom: '4px' }}>✓ Positive Operating Cash Flow</div>
                        <div style={{ fontSize: '13px', color: '#047857' }}>
                          The company generated ${(totalOperatingCF / 1000).toFixed(0)}K in cash from operations over the last 12 months, indicating healthy operational performance.
                        </div>
                      </div>
                    ) : (
                      <div style={{ padding: '16px', background: '#fef2f2', border: '1px solid #fca5a5', borderRadius: '8px' }}>
                        <div style={{ fontSize: '14px', fontWeight: '600', color: '#991b1b', marginBottom: '4px' }}>⚠ Negative Operating Cash Flow</div>
                        <div style={{ fontSize: '13px', color: '#dc2626' }}>
                          The company consumed ${Math.abs(totalOperatingCF / 1000).toFixed(0)}K in cash from operations, which may indicate operational challenges.
                        </div>
                      </div>
                    )}
                    
                    {totalFreeCF > 0 ? (
                      <div style={{ padding: '16px', background: '#f0fdf4', border: '1px solid #86efac', borderRadius: '8px' }}>
                        <div style={{ fontSize: '14px', fontWeight: '600', color: '#065f46', marginBottom: '4px' }}>✓ Positive Free Cash Flow</div>
                        <div style={{ fontSize: '13px', color: '#047857' }}>
                          After capital expenditures, the company has ${(totalFreeCF / 1000).toFixed(0)}K in free cash flow available for growth, debt reduction, or distributions.
                        </div>
                      </div>
                    ) : (
                      <div style={{ padding: '16px', background: '#fffbeb', border: '1px solid #fcd34d', borderRadius: '8px' }}>
                        <div style={{ fontSize: '14px', fontWeight: '600', color: '#92400e', marginBottom: '4px' }}>⚠ Negative Free Cash Flow</div>
                        <div style={{ fontSize: '13px', color: '#b45309' }}>
                          Capital expenditures exceed operating cash flow by ${Math.abs(totalFreeCF / 1000).toFixed(0)}K, requiring external financing.
                        </div>
                      </div>
                    )}
                    
                    {avgCashFlowMargin > 15 ? (
                      <div style={{ padding: '16px', background: '#f0fdf4', border: '1px solid #86efac', borderRadius: '8px' }}>
                        <div style={{ fontSize: '14px', fontWeight: '600', color: '#065f46', marginBottom: '4px' }}>✓ Strong Cash Flow Margin</div>
                        <div style={{ fontSize: '13px', color: '#047857' }}>
                          Average cash flow margin of {avgCashFlowMargin.toFixed(1)}% indicates the company efficiently converts revenue into cash.
                        </div>
                      </div>
                    ) : avgCashFlowMargin < 5 ? (
                      <div style={{ padding: '16px', background: '#fef2f2', border: '1px solid #fca5a5', borderRadius: '8px' }}>
                        <div style={{ fontSize: '14px', fontWeight: '600', color: '#991b1b', marginBottom: '4px' }}>⚠ Low Cash Flow Margin</div>
                        <div style={{ fontSize: '13px', color: '#dc2626' }}>
                          Cash flow margin of {avgCashFlowMargin.toFixed(1)}% suggests challenges in converting revenue to cash. Review receivables collection and expense timing.
                        </div>
                      </div>
                    ) : null}
                  </div>
                </div>
              </>
            );
          })()}
        </div>
      )}

      {/* Data Mapping View - AI-Assisted Mapping Interface */}
      {(currentView === 'admin' && adminDashboardTab === 'data-mapping' && selectedCompanyId && qbRawData) && (() => {
        // CRITICAL SECURITY CHECK: Ensure qbRawData matches the selected company
        if (!qbRawData._companyId || qbRawData._companyId !== selectedCompanyId) {
          console.error(`🚨 SECURITY BLOCK: Data mismatch! Selected: ${selectedCompanyId}, Data companyId: ${qbRawData._companyId || 'MISSING'}`);
          return <div style={{ padding: '48px', textAlign: 'center' }}>
            <div style={{ fontSize: '18px', color: '#ef4444', marginBottom: '12px' }}>⚠️ Loading company data...</div>
            <div style={{ fontSize: '14px', color: '#64748b' }}>Please wait while we fetch the correct financial data.</div>
          </div>;
        }
        
        const currentCompany = companies.find(c => c.id === selectedCompanyId);
        const currentCompanyName = currentCompany?.name || 'Unknown';
        console.log(`🔄 ========================================`);
        console.log(`🔄 DATA MAPPING RENDERING (Refresh Key: ${dataRefreshKey})`);
        console.log(`🔄 Selected Company: "${currentCompanyName}" (ID: ${selectedCompanyId})`);
        console.log(`🔄 QB Data sync date:`, qbRawData.syncDate);
        console.log(`🔄 Data belongs to company:`, qbRawData._companyId);
        console.log(`🔄 Record ID:`, qbRawData._recordId);
        console.log(`🔄 ========================================`);
        
        // Helper function to recursively extract all rows from QB report
        // Extract from the last month column, not the total column
        // Calculate totals by summing detail rows instead of using QB's Summary rows
        const extractRows = (data: any, level: number = 0, parentSection: string = ''): any[] => {
          const result: any[] = [];
          
          if (!data) return result;
          
          // Check if this is a multi-column report (monthly breakdown)
          const columns = data.Columns?.Column || [];
          const hasMultipleMonths = columns.length > 2; // More than just account name + one value column
          
          const rows = Array.isArray(data?.Rows) ? data.Rows : (data?.Rows?.Row ? (Array.isArray(data.Rows.Row) ? data.Rows.Row : [data.Rows.Row]) : []);
          
          for (const row of rows) {
            if (row.type === 'Section') {
              // Add section header
              const sectionName = row.Header?.ColData?.[0]?.value || parentSection;
              if (sectionName) {
                result.push({
                  type: 'section',
                  name: sectionName,
                  level,
                  isHeader: true,
                  section: sectionName
                });
              }
              
              // Track index before nested rows for calculating section total
              const beforeNestedIndex = result.length;
              
              // Recursively process nested rows WITH section tracking
              if (row.Rows?.Row) {
                const nested = extractRows({ Rows: { Row: row.Rows.Row } }, level + 1, sectionName);
                result.push(...nested);
              }
              
              // Calculate section total by summing ONLY data rows (not subtotals) in this section
              const nestedRows = result.slice(beforeNestedIndex);
              let calculatedTotal = 0;
              nestedRows.forEach(r => {
                if (r.type === 'data') {  // Only sum detail rows, not subtotal rows
                  const numValue = parseFloat(r.value) || 0;
                  calculatedTotal += numValue;
                }
              });
              
              // Add section summary/total with calculated value
              if (row.Summary?.ColData) {
                const name = row.Summary.ColData[0]?.value || '';
                if (name) {
                  result.push({
                    type: 'total',
                    name,
                    value: calculatedTotal,
                    level,
                    isTotal: true
                  });
                }
              }
            } else if (row.type === 'Data' && row.ColData) {
              // Add data row (individual account)
              const name = row.ColData[0]?.value || '';
              // Extract from appropriate column: last month if multi-month, otherwise last column
              let value = '0';
              for (let i = row.ColData.length - 1; i >= 1; i--) {
                const colValue = row.ColData[i]?.value;
                if (colValue !== undefined && colValue !== '' && !isNaN(parseFloat(colValue))) {
                  value = colValue;
                  break;
                }
              }
              if (name) {
                result.push({
                  type: 'data',
                  name,
                  value,
                  level,
                  section: parentSection  // Track which section this account belongs to
                });
              }
            }
          }
          
          return result;
        };
        
        const plRows = extractRows(qbRawData.profitAndLoss);
        const bsRows = extractRows(qbRawData.balanceSheet);
        
        // Debug: Log all total rows to identify the Total Income discrepancy
        console.log('=== P&L Total Rows ===');
        plRows.filter(r => r.isTotal).forEach(r => {
          console.log(`${r.name}: ${r.value}`);
        });
        
        return (
          <div key={`data-mapping-${selectedCompanyId}-${dataRefreshKey}`} style={{ maxWidth: '1800px', margin: '0 auto', padding: '32px' }}>
            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '8px' }}>
              <h1 style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b', margin: 0 }}>Account Mapping</h1>
              {companyName && <div style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b' }}>{companyName}</div>}
            </div>
            <p style={{ fontSize: '14px', color: '#64748b', marginBottom: '16px' }}>
              Map QuickBooks accounts to your standardized financial fields • Synced: {qbRawData.syncDate ? new Date(qbRawData.syncDate).toLocaleString() : 'Unknown'}
            </p>

            {/* Lines of Business Section */}
            <div style={{ marginBottom: '12px' }}>
              <div style={{ background: 'white', borderRadius: '12px', padding: '24px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                <h2 style={{ fontSize: '20px', fontWeight: '600', color: '#1e293b', marginBottom: '8px' }}>
                  Lines of Business
                </h2>
                <p style={{ fontSize: '13px', color: '#64748b', marginBottom: '16px' }}>
                  Define up to 5 lines of business to allocate revenue and expenses for detailed reporting
                </p>
                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '12px' }}>
                  {linesOfBusiness.map((lob, index) => (
                    <div key={index}>
                      <label style={{ display: 'block', fontSize: '12px', fontWeight: '600', color: '#475569', marginBottom: '4px' }}>
                        Line of Business {index + 1}
                      </label>
                      <input
                        type="text"
                        value={lob}
                        onChange={(e) => {
                          const updated = [...linesOfBusiness];
                          updated[index] = e.target.value;
                          setLinesOfBusiness(updated);
                        }}
                        placeholder={`e.g., ${index === 0 ? 'Consulting' : index === 1 ? 'Products' : index === 2 ? 'Services' : index === 3 ? 'Training' : 'Other'}`}
                        style={{
                          width: '100%',
                          padding: '8px 12px',
                          border: '1px solid #cbd5e1',
                          borderRadius: '6px',
                          fontSize: '13px',
                          color: '#1e293b'
                        }}
                      />
                    </div>
                  ))}
                </div>
              </div>
            </div>

            {/* AI-Assisted Mapping Section */}
            <div style={{ marginBottom: '32px' }}>
              <div style={{ background: 'white', borderRadius: '12px', padding: '32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '12px' }}>
                  <div>
                    <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '8px' }}>
                      AI-Assisted Account Mapping
                    </h2>
                    <p style={{ fontSize: '14px', color: '#64748b', margin: 0 }}>
                      Use AI to automatically suggest mappings from QuickBooks accounts to your standardized financial fields
                    </p>
                  </div>
                  <button
                    onClick={async () => {
                      setIsGeneratingMappings(true);
                      try {
                        // Build account classification lookup from Chart of Accounts
                        const accountClassifications: Record<string, string> = {};
                        const chartOfAccounts = qbRawData?.chartOfAccounts?.QueryResponse?.Account || [];
                        
                        chartOfAccounts.forEach((account: any) => {
                          const accountName = account.Name;
                          const accountType = account.AccountType || '';
                          
                          // Map QB AccountType to our simplified classifications
                          let classification = '';
                          if (accountType === 'Income' || accountType === 'Other Income') {
                            classification = 'Revenue';
                          } else if (accountType === 'Cost of Goods Sold') {
                            classification = 'Cost of Goods Sold';
                          } else if (accountType === 'Expense' || accountType === 'Other Expense') {
                            classification = 'Expense';
                          } else if (accountType.includes('Asset')) {
                            classification = 'Asset';
                          } else if (accountType.includes('Liability')) {
                            classification = 'Liability';
                          } else if (accountType === 'Equity') {
                            classification = 'Equity';
                          }
                          
                          if (accountName && classification) {
                            accountClassifications[accountName] = classification;
                          }
                        });
                        
                        if (Object.keys(accountClassifications).length === 0) {
                          console.error('⚠️ No Chart of Accounts data found! Classifications will be incorrect.');
                        }
                        
                        // Extract all account names WITH classifications from QB data
                        const qbAccountsWithClass: Array<{name: string, classification: string}> = [];
                        
                        // Use the SAME extractRows function that works for display
                        const plRows = extractRows(qbRawData.profitAndLoss);
                        const bsRows = extractRows(qbRawData.balanceSheet);
                        
                        // For P&L: Get individual REVENUE items AND individual EXPENSE items (not totals)
                        const revenueDataRows = plRows.filter(r => {
                          if (r.type !== 'data' || r.isHeader || r.isTotal) return false;
                          const section = (r.section || '').toLowerCase();
                          return section.includes('income') || section.includes('revenue');
                        });
                        const expenseDataRows = plRows.filter(r => {
                          if (r.type !== 'data' || r.isHeader || r.isTotal) return false;
                          const section = (r.section || '').toLowerCase();
                          return section.includes('expense') || section.includes('cost');
                        });
                        
                        // For Balance Sheet: Get individual items (all detail accounts)
                        const bsDataRows = bsRows.filter(r => r.type === 'data' && !r.isHeader && !r.isTotal);
                        
                        console.log('🔍 Revenue individual items:', revenueDataRows.length);
                        console.log('🔍 Expense individual items:', expenseDataRows.length);
                        console.log('🔍 BS individual items:', bsDataRows.length);
                        
                        // DEBUG: Pick first revenue account to track through entire process
                        const testAccount = revenueDataRows[0]?.name || expenseDataRows[0]?.name || bsDataRows[0]?.name;
                        console.log(`\n🔬 TRACKING TEST ACCOUNT: "${testAccount}"`);
                        if (testAccount) {
                          const testRow = plRows.find(r => r.name === testAccount) || bsRows.find(r => r.name === testAccount);
                          console.log('Test account raw data:', testRow);
                        }
                        
                        // Add revenue individual items
                        revenueDataRows.forEach(row => {
                          const classification = accountClassifications[row.name] || 'Revenue';
                          qbAccountsWithClass.push({ name: row.name, classification });
                        });
                        
                        // Add expense individual items
                        expenseDataRows.forEach(row => {
                          const classification = accountClassifications[row.name] || 'Expense';
                          qbAccountsWithClass.push({ name: row.name, classification });
                        });
                        
                        // Add BS individual items
                        bsDataRows.forEach(row => {
                          const classification = accountClassifications[row.name] || 'Asset';
                          qbAccountsWithClass.push({ name: row.name, classification });
                        });
                        
                        console.log('🔍 TOTAL accounts to map:', qbAccountsWithClass.length);
                        console.log('🔍 First 10 accounts:', qbAccountsWithClass.slice(0, 10).map(a => a.name));

                        const response = await fetch('/api/ai-mapping', {
                          method: 'POST',
                          headers: { 'Content-Type': 'application/json' },
                          body: JSON.stringify({ 
                            qbAccountsWithClass,
                            targetFields: []
                          })
                        });

                        if (!response.ok) {
                          throw new Error('Failed to generate mappings');
                        }

                        const data = await response.json();
                        setAiMappings(data.mappings || []);
                        
                        // DEBUG: Track test account through mapping
                        if (testAccount) {
                          const testMapping = data.mappings.find((m: any) => m.qbAccount === testAccount);
                          console.log(`\n🔬 TEST ACCOUNT MAPPING:`, testMapping);
                        }
                        
                        setShowMappingSection(true);
                      } catch (error: any) {
                        console.error('Error generating mappings:', error);
                        alert('Failed to generate AI mappings: ' + error.message);
                      } finally {
                        setIsGeneratingMappings(false);
                      }
                    }}
                    disabled={isGeneratingMappings || plRows.length === 0}
                    style={{
                      padding: '12px 24px',
                      background: isGeneratingMappings ? '#94a3b8' : '#667eea',
                      color: 'white',
                      border: 'none',
                      borderRadius: '8px',
                      fontSize: '14px',
                      fontWeight: '600',
                      cursor: isGeneratingMappings ? 'not-allowed' : 'pointer',
                      boxShadow: '0 2px 6px rgba(102, 126, 234, 0.3)',
                      display: 'flex',
                      alignItems: 'center',
                      gap: '8px'
                    }}
                  >
                    {isGeneratingMappings ? (
                      <>
                        <span>⏳</span>
                        <span>Generating Mappings...</span>
                      </>
                    ) : (
                      <>
                        <span>🤖</span>
                        <span>Generate AI Mappings</span>
                      </>
                    )}
                  </button>
                </div>

                {showMappingSection && aiMappings.length > 0 && (
                  <div>
                    <div style={{ marginBottom: '16px', padding: '16px', background: '#f0f9ff', border: '1px solid #bae6fd', borderRadius: '8px' }}>
                      <div style={{ fontSize: '14px', fontWeight: '600', color: '#0369a1', marginBottom: '4px' }}>
                        ✨ AI Suggestions Generated
                      </div>
                      <div style={{ fontSize: '13px', color: '#0c4a6e' }}>
                        Review the suggested mappings below. You can edit any mapping before saving. Mappings will be used to automatically populate your standardized financial statements from QuickBooks data.
                      </div>
                    </div>

                    <div style={{ maxHeight: '500px', overflowY: 'auto', marginBottom: '16px' }}>
                      <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '13px' }}>
                        <thead style={{ position: 'sticky', top: 0, background: 'white', zIndex: 1 }}>
                          <tr style={{ borderBottom: '2px solid #e2e8f0' }}>
                            <th style={{ padding: '12px', textAlign: 'left', fontWeight: '600', color: '#1e293b', width: '10%' }}>Classification</th>
                            <th style={{ padding: '12px', textAlign: 'left', fontWeight: '600', color: '#1e293b', width: '20%' }}>QuickBooks Account</th>
                            <th style={{ padding: '12px', textAlign: 'right', fontWeight: '600', color: '#1e293b', width: '10%' }}>Amount</th>
                            <th style={{ padding: '12px', textAlign: 'left', fontWeight: '600', color: '#1e293b', width: '15%' }}>Target Field</th>
                            <th colSpan={linesOfBusiness.filter(lob => lob.trim() !== '').length || 1} style={{ padding: '12px', textAlign: 'center', fontWeight: '600', color: '#1e293b', borderLeft: '2px solid #e2e8f0', borderRight: '2px solid #e2e8f0' }}>
                              Line of Business Allocation (%)
                            </th>
                            <th style={{ padding: '12px', textAlign: 'center', fontWeight: '600', color: '#1e293b', width: '7%' }}>Total %</th>
                            <th style={{ padding: '12px', textAlign: 'left', fontWeight: '600', color: '#1e293b', width: '10%' }}>Confidence</th>
                          </tr>
                          <tr style={{ borderBottom: '2px solid #e2e8f0' }}>
                            <th colSpan={4}></th>
                            {linesOfBusiness.filter(lob => lob.trim() !== '').length > 0 ? (
                              linesOfBusiness.filter(lob => lob.trim() !== '').map((lob, idx) => (
                                <th key={idx} style={{ padding: '8px 4px', textAlign: 'center', fontSize: '11px', fontWeight: '600', color: '#475569', borderLeft: idx === 0 ? '2px solid #e2e8f0' : '1px solid #f1f5f9', borderRight: idx === linesOfBusiness.filter(l => l.trim() !== '').length - 1 ? '2px solid #e2e8f0' : 'none', background: '#f8fafc' }}>
                                  {lob}
                                </th>
                              ))
                            ) : (
                              <th style={{ padding: '8px 4px', textAlign: 'center', fontSize: '11px', fontWeight: '600', color: '#94a3b8', borderLeft: '2px solid #e2e8f0', borderRight: '2px solid #e2e8f0', background: '#f8fafc' }}>
                                Define LOBs above
                              </th>
                            )}
                            <th></th>
                            <th></th>
                          </tr>
                        </thead>
                        <tbody>
                          {(() => {
                            // Sort mappings by classification
                            const classificationOrder = ['Revenue', 'Cost of Goods Sold', 'COGS', 'Expense', 'Asset', 'Current Asset', 'Fixed Asset', 'Other Asset', 'Liability', 'Current Liability', 'Long Term Liability', 'Equity'];
                            const sortedMappings = [...aiMappings].sort((a, b) => {
                              const aClass = a.qbAccountClassification || '';
                              const bClass = b.qbAccountClassification || '';
                              const aIdx = classificationOrder.findIndex(c => aClass.includes(c) || c.includes(aClass));
                              const bIdx = classificationOrder.findIndex(c => bClass.includes(c) || c.includes(bClass));
                              if (aIdx === -1 && bIdx === -1) return 0;
                              if (aIdx === -1) return 1;
                              if (bIdx === -1) return -1;
                              return aIdx - bIdx;
                            });
                            
                            return sortedMappings.map((mapping, idx) => {
                              // Get amount from already-extracted plRows and bsRows
                              let amount = null;
                              if (plRows && bsRows) {
                                const allRows = [...plRows, ...bsRows];
                                const accountRow = allRows.find((row: any) => row.name === mapping.qbAccount);
                                if (accountRow) {
                                  amount = parseFloat(accountRow.value) || 0;
                                }
                              }
                              
                              return (
                                <tr key={`${mapping.qbAccount}-${idx}`} style={{ borderBottom: '1px solid #f1f5f9' }}>
                                  <td style={{ padding: '12px', color: '#475569', fontSize: '12px', fontWeight: '600' }}>
                                    {mapping.qbAccountClassification || '-'}
                                  </td>
                                  <td style={{ padding: '12px', color: '#475569' }}>{mapping.qbAccount}</td>
                                  <td style={{ padding: '12px', color: '#475569', textAlign: 'right', fontFamily: 'monospace' }}>
                                    {amount !== null && amount !== undefined ? `$${Number(amount).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}` : '-'}
                                  </td>
                                  <td style={{ padding: '12px' }}>
                                    <select
                                      value={mapping.targetField || ''}
                                      onChange={(e) => {
                                        const newValue = e.target.value;
                                        const updated = aiMappings.map(m => 
                                          m.qbAccount === mapping.qbAccount 
                                            ? { ...m, targetField: newValue }
                                            : m
                                        );
                                        setAiMappings(updated);
                                      }}
                                      style={{
                                        width: '100%',
                                        padding: '6px 10px',
                                        border: '1px solid #cbd5e1',
                                        borderRadius: '6px',
                                        fontSize: '13px',
                                        color: '#1e293b',
                                        cursor: 'pointer'
                                      }}
                                    >
                                      <option value="">-- Select Field --</option>
                                      <optgroup label="Income Statement">
                                        <option value="revenue">Revenue</option>
                                        <option value="expense">Total Expense</option>
                                        <option value="cogsPayroll">COGS - Payroll</option>
                                        <option value="cogsOwnerPay">COGS - Owner Pay</option>
                                        <option value="cogsContractors">COGS - Contractors</option>
                                        <option value="cogsMaterials">COGS - Materials</option>
                                        <option value="cogsCommissions">COGS - Commissions</option>
                                        <option value="cogsOther">COGS - Other</option>
                                        <option value="cogsTotal">COGS - Total</option>
                                        <option value="payroll">Payroll</option>
                                        <option value="ownerBasePay">Owner Base Pay</option>
                                        <option value="benefits">Benefits</option>
                                        <option value="insurance">Insurance</option>
                                        <option value="professionalFees">Professional Fees</option>
                                        <option value="subcontractors">Subcontractors</option>
                                        <option value="rent">Rent</option>
                                        <option value="taxLicense">Tax & License</option>
                                        <option value="phoneComm">Phone & Communication</option>
                                        <option value="infrastructure">Infrastructure/Utilities</option>
                                        <option value="autoTravel">Auto & Travel</option>
                                        <option value="salesExpense">Sales & Marketing</option>
                                        <option value="marketing">Marketing</option>
                                        <option value="trainingCert">Training & Certification</option>
                                        <option value="mealsEntertainment">Meals & Entertainment</option>
                                        <option value="interestExpense">Interest Expense</option>
                                        <option value="depreciationAmortization">Depreciation & Amortization</option>
                                        <option value="otherExpense">Other Expense</option>
                                        <option value="nonOperatingIncome">Non-Operating Income</option>
                                        <option value="extraordinaryItems">Extraordinary Items</option>
                                      </optgroup>
                                      <optgroup label="Balance Sheet - Assets">
                                        <option value="cash">Cash</option>
                                        <option value="ar">Accounts Receivable</option>
                                        <option value="inventory">Inventory</option>
                                        <option value="otherCA">Other Current Assets</option>
                                        <option value="tca">Total Current Assets</option>
                                        <option value="fixedAssets">Fixed Assets</option>
                                        <option value="otherAssets">Other Assets</option>
                                        <option value="totalAssets">Total Assets</option>
                                      </optgroup>
                                      <optgroup label="Balance Sheet - Liabilities">
                                        <option value="ap">Accounts Payable</option>
                                        <option value="otherCL">Other Current Liabilities</option>
                                        <option value="tcl">Total Current Liabilities</option>
                                        <option value="ltd">Long Term Debt</option>
                                        <option value="totalLiab">Total Liabilities</option>
                                      </optgroup>
                                      <optgroup label="Balance Sheet - Equity">
                                        <option value="totalEquity">Total Equity</option>
                                        <option value="totalLAndE">Total Liabilities & Equity</option>
                                      </optgroup>
                                    </select>
                                  </td>
                                  {linesOfBusiness.filter(lob => lob.trim() !== '').length > 0 ? (
                                    linesOfBusiness.filter(lob => lob.trim() !== '').map((lob, lobIdx) => {
                                      const lobAllocations = mapping.lobAllocations || {};
                                      const currentPercent = lobAllocations[lob] !== undefined ? lobAllocations[lob] : 0;
                                      const allAllocations = lobAllocations;
                                      const total = Object.values(allAllocations).reduce((sum: number, val: any) => sum + (val || 0), 0);
                                      const isOverAllocated = total > 100;
                                      const isUnderAllocated = total < 100 && total > 0;
                                      
                                      return (
                                        <td key={lobIdx} style={{ padding: '8px 4px', borderLeft: lobIdx === 0 ? '2px solid #e2e8f0' : '1px solid #f1f5f9', borderRight: lobIdx === linesOfBusiness.filter(l => l.trim() !== '').length - 1 ? '2px solid #e2e8f0' : 'none', background: '#fafafa' }}>
                                          <input
                                            type="number"
                                            min="0"
                                            max="100"
                                            value={currentPercent}
                                            onChange={(e) => {
                                              const newValue = parseInt(e.target.value) || 0;
                                              const clamped = Math.min(Math.max(newValue, 0), 100);
                                              const updated = aiMappings.map(m => 
                                                m.qbAccount === mapping.qbAccount 
                                                  ? { 
                                                      ...m, 
                                                      lobAllocations: {
                                                        ...(m.lobAllocations || {}),
                                                        [lob]: clamped
                                                      }
                                                    }
                                                  : m
                                              );
                                              setAiMappings(updated);
                                            }}
                                            style={{
                                              width: '50px',
                                              padding: '4px 6px',
                                              border: isOverAllocated ? '2px solid #ef4444' : isUnderAllocated ? '2px solid #f59e0b' : '1px solid #cbd5e1',
                                              borderRadius: '4px',
                                              fontSize: '12px',
                                              color: '#1e293b',
                                              textAlign: 'center',
                                              background: 'white'
                                            }}
                                            title={isOverAllocated ? `Total allocation is ${total}% (exceeds 100%)` : isUnderAllocated ? `Total allocation is ${total}% (less than 100%)` : `Total allocation: ${total}%`}
                                          />
                                        </td>
                                      );
                                    })
                                  ) : (
                                    <td style={{ padding: '12px', textAlign: 'center', color: '#94a3b8', fontSize: '12px', borderLeft: '2px solid #e2e8f0', borderRight: '2px solid #e2e8f0', background: '#fafafa' }}>
                                      -
                                    </td>
                                  )}
                                  <td style={{ padding: '12px', textAlign: 'center' }}>
                                    {(() => {
                                      const lobAllocations = mapping.lobAllocations || {};
                                      const total = Object.values(lobAllocations).reduce((sum: number, val: any) => sum + (val || 0), 0);
                                      const isOverAllocated = total > 100;
                                      const isUnderAllocated = total < 100 && total > 0;
                                      const isPerfect = total === 100;
                                      
                                      return (
                                        <span style={{
                                          padding: '4px 8px',
                                          borderRadius: '4px',
                                          fontSize: '12px',
                                          fontWeight: '600',
                                          background: isOverAllocated ? '#fee2e2' : isUnderAllocated ? '#fef3c7' : isPerfect ? '#dcfce7' : '#f1f5f9',
                                          color: isOverAllocated ? '#dc2626' : isUnderAllocated ? '#d97706' : isPerfect ? '#16a34a' : '#64748b'
                                        }}>
                                          {total}%
                                        </span>
                                      );
                                    })()}
                                  </td>
                                  <td style={{ padding: '12px' }}>
                                    <select
                                      value={mapping.confidence}
                                      onChange={(e) => {
                                        const newValue = e.target.value;
                                        const updated = aiMappings.map(m => 
                                          m.qbAccount === mapping.qbAccount 
                                            ? { ...m, confidence: newValue }
                                            : m
                                        );
                                        setAiMappings(updated);
                                      }}
                                      style={{
                                        padding: '6px 10px',
                                        border: '1px solid #cbd5e1',
                                        borderRadius: '6px',
                                        fontSize: '13px',
                                        color: '#1e293b',
                                        background: mapping.confidence === 'high' ? '#dcfce7' : (mapping.confidence === 'medium' ? '#fef3c7' : '#fee2e2')
                                      }}
                                    >
                                      <option value="high">High</option>
                                      <option value="medium">Medium</option>
                                      <option value="low">Low</option>
                                    </select>
                                  </td>
                                </tr>
                              );
                            });
                          })()}
                        </tbody>
                      </table>
                    </div>

                    {/* Action Buttons Section */}
                    <div style={{ marginTop: '24px', padding: '20px', background: '#f8fafc', borderRadius: '8px', border: '1px solid #e2e8f0' }}>
                      {/* Row 1: Mapping Controls */}
                      <div style={{ display: 'flex', gap: '12px', justifyContent: 'space-between', alignItems: 'center', marginBottom: '16px', paddingBottom: '16px', borderBottom: '1px solid #e2e8f0' }}>
                        <div>
                          <h3 style={{ fontSize: '14px', fontWeight: '600', color: '#1e293b', marginBottom: '4px' }}>Account Mapping Controls</h3>
                          <p style={{ fontSize: '12px', color: '#64748b', margin: 0 }}>Save your mappings before processing data</p>
                        </div>
                        <div style={{ display: 'flex', gap: '12px', alignItems: 'center' }}>
                          <button
                            onClick={async () => {
                              if (confirm('Are you sure you want to clear all mappings? This will delete saved mappings from the database.')) {
                                try {
                                  // Delete from database
                                  const response = await fetch(`/api/account-mappings?companyId=${selectedCompanyId}`, {
                                    method: 'DELETE'
                                  });
                                  if (!response.ok) throw new Error('Failed to delete mappings');
                                  
                                  // Clear from state
                                  setAiMappings([]);
                                  alert('All mappings cleared! ✅');
                                } catch (error: any) {
                                  alert('Failed to clear mappings: ' + error.message);
                                }
                              }
                            }}
                            disabled={aiMappings.length === 0}
                            style={{
                              padding: '10px 20px',
                              background: aiMappings.length === 0 ? '#f1f5f9' : '#fee2e2',
                              color: aiMappings.length === 0 ? '#94a3b8' : '#dc2626',
                              border: '1px solid #fecaca',
                              borderRadius: '6px',
                              fontSize: '13px',
                              fontWeight: '600',
                              cursor: aiMappings.length === 0 ? 'not-allowed' : 'pointer'
                            }}
                          >
                            🗑️ Clear All
                          </button>
                          <button
                            onClick={() => {
                              setShowMappingSection(false);
                              setAiMappings([]);
                            }}
                            style={{
                              padding: '10px 20px',
                              background: 'white',
                              color: '#64748b',
                              border: '1px solid #cbd5e1',
                              borderRadius: '6px',
                              fontSize: '13px',
                              fontWeight: '600',
                              cursor: 'pointer'
                            }}
                          >
                            Cancel
                          </button>
                          <button
                            onClick={async () => {
                              setIsSavingMappings(true);
                              try {
                                // Deduplicate mappings by qbAccount (keep first occurrence)
                                const uniqueMappings = aiMappings.filter((m, index, self) =>
                                  index === self.findIndex((t) => t.qbAccount === m.qbAccount)
                                );
                                
                                console.log(`Deduplicating mappings: ${aiMappings.length} -> ${uniqueMappings.length}`);
                                
                                const response = await fetch('/api/account-mappings', {
                                  method: 'POST',
                                  headers: { 'Content-Type': 'application/json' },
                                  body: JSON.stringify({
                                    companyId: selectedCompanyId,
                                    mappings: uniqueMappings
                                  })
                                });

                                if (!response.ok) {
                                  const errorData = await response.json();
                                  throw new Error(errorData.details || 'Failed to save mappings');
                                }

                                // Update local state to reflect deduplicated mappings
                                setAiMappings(uniqueMappings);
                                
                                alert('Mappings saved successfully! ✅');
                                // Keep the section visible after saving so users can see their saved mappings
                              } catch (error: any) {
                                console.error('Error saving mappings:', error);
                                alert('Failed to save mappings: ' + error.message);
                              } finally {
                                setIsSavingMappings(false);
                              }
                            }}
                            disabled={isSavingMappings}
                            style={{
                              padding: '10px 24px',
                              background: isSavingMappings ? '#94a3b8' : '#10b981',
                              color: 'white',
                              border: 'none',
                              borderRadius: '6px',
                              fontSize: '13px',
                              fontWeight: '600',
                              cursor: isSavingMappings ? 'not-allowed' : 'pointer',
                              boxShadow: '0 2px 6px rgba(16, 185, 129, 0.3)'
                            }}
                          >
                            {isSavingMappings ? 'Saving...' : '💾 Save Mappings'}
                          </button>
                        </div>
                      </div>

                      {/* Row 2: Data Processing */}
                      <div style={{ display: 'flex', gap: '12px', justifyContent: 'space-between', alignItems: 'center' }}>
                        <div>
                          <h3 style={{ fontSize: '14px', fontWeight: '600', color: '#1e293b', marginBottom: '4px' }}>Data Processing</h3>
                          <p style={{ fontSize: '12px', color: '#64748b', margin: 0 }}>Process QuickBooks data using your saved mappings</p>
                        </div>
                        <div style={{ display: 'flex', gap: '12px', alignItems: 'center' }}>
                      <button
                        onClick={async () => {
                          if (!aiMappings || aiMappings.length === 0) {
                            alert('Please save account mappings first!');
                            return;
                          }
                          
                          if (!qbRawData || !qbRawData.profitAndLoss) {
                            alert('No QuickBooks data available!');
                            return;
                          }
                          
                          setIsProcessingMonthlyData(true);
                          try {
                            console.log('🔄 Processing 36 months of data using mappings...');
                            console.log('📋 Total mappings:', aiMappings.length);
                            
                            // DEBUG: Track Professional Services expense account
                            const testMapping = aiMappings.find(m => 
                              m.qbAccount?.toLowerCase().includes('professional') || 
                              m.qbAccount?.toLowerCase().includes('accounting') ||
                              m.qbAccount?.toLowerCase().includes('legal')
                            );
                            const testAccountName = testMapping?.qbAccount;
                            console.log(`🔬 TRACKING PROFESSIONAL SERVICES: "${testAccountName}"`, testMapping);
                            
                            // Get column information from QB report
                            const plColumns = qbRawData.profitAndLoss.Columns?.Column || [];
                            const bsColumns = qbRawData.balanceSheet?.Columns?.Column || [];
                            
                            console.log('QB P&L Columns:', plColumns.map((c: any) => c.ColTitle || c.ColType));
                            
                            // The first column is account names, rest are data columns
                            // Filter out "Total" column if present (usually the last one)
                            const monthColumns = plColumns.slice(1).filter((col: any) => {
                              const title = col.ColTitle || '';
                              return title && title.toLowerCase() !== 'total';
                            });
                            console.log(`Found ${monthColumns.length} month columns in P&L`);
                            console.log('Month column headers:', monthColumns.map((c: any) => c.ColTitle));
                            
                            // Helper function to extract all account values for a specific column index
                            // Uses the SAME recursive logic as the working P&L display extraction
                            const extractColumnData = (reportData: any, columnIndex: number, isFirstCall = false) => {
                              const accountValues: { [accountName: string]: number } = {};
                              
                              const processRows = (rows: any[], depth = 0) => {
                                for (const row of rows) {
                                  if (row.type === 'Section') {
                                    // Process nested rows first
                                    if (row.Rows?.Row) {
                                      const subRows = Array.isArray(row.Rows.Row) ? row.Rows.Row : [row.Rows.Row];
                                      processRows(subRows, depth + 1);
                                    }
                                    
                                    // Get section total from Summary row
                                    if (row.Summary?.ColData) {
                                      const accountName = row.Summary.ColData[0]?.value || '';
                                      const value = row.Summary.ColData[columnIndex]?.value;
                                      
                                      if (accountName) {
                                        const numValue = value === '' || value === undefined ? 0 : parseFloat(value);
                                        accountValues[accountName] = isNaN(numValue) ? 0 : numValue;
                                        
                                        if (isFirstCall && accountName.toLowerCase().includes('legal')) {
                                          console.log(`\n💰 Found Section Summary "${accountName}":`, {
                                      columnIndex,
                                      value,
                                            numValue
                                          });
                                        }
                                      }
                                    }
                                  } else if (row.type === 'Data' && row.ColData) {
                                    // Get detail account value
                                    const accountName = row.ColData[0]?.value || '';
                                    const value = row.ColData[columnIndex]?.value;
                                    
                                  if (accountName) {
                                    const numValue = value === '' || value === undefined ? 0 : parseFloat(value);
                                    accountValues[accountName] = isNaN(numValue) ? 0 : numValue;
                                  }
                                }
                                }
                              };
                              
                              const rows = Array.isArray(reportData?.Rows) ? reportData.Rows : 
                                          (reportData?.Rows?.Row ? (Array.isArray(reportData.Rows.Row) ? reportData.Rows.Row : [reportData.Rows.Row]) : []);
                              
                              processRows(rows, 0);
                              
                              if (isFirstCall) {
                                console.log(`\n📊 Extraction results: Found ${Object.keys(accountValues).length} accounts`);
                              }
                              
                              return accountValues;
                            };
                            
                            // Process each month's data
                            const monthlyData: any[] = [];
                            
                            for (let i = 1; i <= monthColumns.length; i++) {
                              // Extract data for this column (enable debug logging for first month)
                              const plData = extractColumnData(qbRawData.profitAndLoss, i, i === 1);
                              const bsData = qbRawData.balanceSheet ? extractColumnData(qbRawData.balanceSheet, i, false) : {};
                              
                              // Debug logging for first few months
                              if (i <= 3) {
                                console.log(`\n🔍 Month ${i} extraction debug:`);
                                console.log(`P&L data keys:`, Object.keys(plData).slice(0, 10));
                                console.log(`P&L sample values:`, Object.entries(plData).slice(0, 5));
                                console.log(`BS data keys:`, Object.keys(bsData).slice(0, 10));
                              }
                              
                              // Debug mappings for first month
                              if (i === 1) {
                                console.log(`\n🗺️ Total mappings: ${aiMappings.length}`);
                                const targetFieldCounts: Record<string, number> = {};
                                aiMappings.forEach(m => {
                                  targetFieldCounts[m.targetField] = (targetFieldCounts[m.targetField] || 0) + 1;
                                });
                                console.log(`Target field distribution:`, targetFieldCounts);
                                const revenueMappings = aiMappings.filter(m => m.targetField === 'revenue');
                                console.log(`Revenue mappings (${revenueMappings.length}):`, revenueMappings.map(m => m.qbAccount));
                              }
                              
                              // Initialize month record
                              const monthRecord: any = {
                                revenue: 0,
                                expense: 0,
                                cogsPayroll: 0,
                                cogsOwnerPay: 0,
                                cogsContractors: 0,
                                cogsMaterials: 0,
                                cogsCommissions: 0,
                                cogsOther: 0,
                                cogsTotal: 0,
                                payroll: 0,
                                ownerBasePay: 0,
                                benefits: 0,
                                insurance: 0,
                                professionalFees: 0,
                                subcontractors: 0,
                                rent: 0,
                                taxLicense: 0,
                                phoneComm: 0,
                                infrastructure: 0,
                                autoTravel: 0,
                                salesExpense: 0,
                                marketing: 0,
                                trainingCert: 0,
                                mealsEntertainment: 0,
                                interestExpense: 0,
                                depreciationAmortization: 0,
                                otherExpense: 0,
                                nonOperatingIncome: 0,
                                extraordinaryItems: 0,
                                cash: 0,
                                ar: 0,
                                inventory: 0,
                                otherCA: 0,
                                tca: 0,
                                fixedAssets: 0,
                                otherAssets: 0,
                                totalAssets: 0,
                                ap: 0,
                                otherCL: 0,
                                tcl: 0,
                                ltd: 0,
                                totalLiab: 0,
                                totalEquity: 0,
                                totalLAndE: 0
                              };
                              
                              // Apply mappings to populate the month record
                              aiMappings.forEach((mapping, idx) => {
                                const qbAccount = mapping.qbAccount;
                                const targetField = mapping.targetField;
                                const classification = mapping.qbAccountClassification || '';
                                
                                // Get value from appropriate data source
                                const isBalanceSheet = classification.includes('Asset') || 
                                                      classification.includes('Liability') || 
                                                      classification.includes('Equity');
                                const value = isBalanceSheet ? (bsData[qbAccount] || 0) : (plData[qbAccount] || 0);
                                
                                // DEBUG: Track test account through every month
                                if (qbAccount === testAccountName) {
                                  console.log(`\n🔬 MONTH ${i} - TEST ACCOUNT "${testAccountName}":`, {
                                    targetField,
                                    classification,
                                    isBalanceSheet,
                                    foundInPLData: qbAccount in plData,
                                    foundInBSData: qbAccount in bsData,
                                    extractedValue: value,
                                    plDataKeys: Object.keys(plData).slice(0, 5),
                                    bsDataKeys: Object.keys(bsData).slice(0, 5)
                                  });
                                }
                                
                                // Map to target field
                                if (targetField === 'revenue') monthRecord.revenue += value;
                                else if (targetField === 'expense') monthRecord.expense += value;
                                else if (targetField === 'cogsPayroll') monthRecord.cogsPayroll += value;
                                else if (targetField === 'cogsOwnerPay') monthRecord.cogsOwnerPay += value;
                                else if (targetField === 'cogsContractors') monthRecord.cogsContractors += value;
                                else if (targetField === 'cogsMaterials') monthRecord.cogsMaterials += value;
                                else if (targetField === 'cogsCommissions') monthRecord.cogsCommissions += value;
                                else if (targetField === 'cogsOther') monthRecord.cogsOther += value;
                                else if (targetField === 'payroll') monthRecord.payroll += value;
                                else if (targetField === 'ownerBasePay') monthRecord.ownerBasePay += value;
                                else if (targetField === 'benefits') monthRecord.benefits += value;
                                else if (targetField === 'insurance') monthRecord.insurance += value;
                                else if (targetField === 'professionalFees') monthRecord.professionalFees += value;
                                else if (targetField === 'subcontractors') monthRecord.subcontractors += value;
                                else if (targetField === 'rent') monthRecord.rent += value;
                                else if (targetField === 'taxLicense') monthRecord.taxLicense += value;
                                else if (targetField === 'phoneComm') monthRecord.phoneComm += value;
                                else if (targetField === 'infrastructure') monthRecord.infrastructure += value;
                                else if (targetField === 'autoTravel') monthRecord.autoTravel += value;
                                else if (targetField === 'salesExpense') monthRecord.salesExpense += value;
                                else if (targetField === 'marketing') monthRecord.marketing += value;
                                else if (targetField === 'trainingCert') monthRecord.trainingCert += value;
                                else if (targetField === 'mealsEntertainment') monthRecord.mealsEntertainment += value;
                                else if (targetField === 'interestExpense') monthRecord.interestExpense += value;
                                else if (targetField === 'depreciationAmortization') monthRecord.depreciationAmortization += value;
                                else if (targetField === 'otherExpense') monthRecord.otherExpense += value;
                                else if (targetField === 'nonOperatingIncome') monthRecord.nonOperatingIncome += value;
                                else if (targetField === 'extraordinaryItems') monthRecord.extraordinaryItems += value;
                                else if (targetField === 'cash') monthRecord.cash += value;
                                else if (targetField === 'ar') monthRecord.ar += value;
                                else if (targetField === 'inventory') monthRecord.inventory += value;
                                else if (targetField === 'otherCA') monthRecord.otherCA += value;
                                else if (targetField === 'tca') monthRecord.tca += value;
                                else if (targetField === 'fixedAssets') monthRecord.fixedAssets += value;
                                else if (targetField === 'otherAssets') monthRecord.otherAssets += value;
                                else if (targetField === 'totalAssets') monthRecord.totalAssets += value;
                                else if (targetField === 'ap') monthRecord.ap += value;
                                else if (targetField === 'otherCL') monthRecord.otherCL += value;
                                else if (targetField === 'tcl') monthRecord.tcl += value;
                                else if (targetField === 'ltd') monthRecord.ltd += value;
                                else if (targetField === 'totalLiab') monthRecord.totalLiab += value;
                                else if (targetField === 'totalEquity') monthRecord.totalEquity += value;
                                else if (targetField === 'totalLAndE') monthRecord.totalLAndE += value;
                              });
                              
                              // Calculate totals
                              monthRecord.cogsTotal = monthRecord.cogsPayroll + monthRecord.cogsOwnerPay + 
                                                     monthRecord.cogsContractors + monthRecord.cogsMaterials + 
                                                     monthRecord.cogsCommissions + monthRecord.cogsOther;
                              monthRecord.tca = monthRecord.cash + monthRecord.ar + monthRecord.inventory + monthRecord.otherCA;
                              monthRecord.totalAssets = monthRecord.tca + monthRecord.fixedAssets + monthRecord.otherAssets;
                              monthRecord.tcl = monthRecord.ap + monthRecord.otherCL;
                              monthRecord.totalLiab = monthRecord.tcl + monthRecord.ltd;
                              monthRecord.totalLAndE = monthRecord.totalLiab + monthRecord.totalEquity;
                              
                              // Get month date from column header
                              const columnHeader = monthColumns[i - 1]?.ColTitle || '';
                              let monthDate = new Date();
                              let parsedSuccessfully = false;
                              
                              // Try to parse month from column header (e.g., "Sep 30, 2022", "Oct 2022", "Sep-2025")
                              if (columnHeader) {
                                const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                                const fullMonthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
                                
                                // Remove commas and split on spaces/dashes
                                const cleanHeader = columnHeader.replace(/,/g, '');
                                const parts = cleanHeader.split(/[-\s]+/);
                                
                                // Find month name (could be at any position)
                                let monthIndex = -1;
                                let monthPart = '';
                                for (const part of parts) {
                                  monthIndex = monthNames.indexOf(part);
                                  if (monthIndex === -1) {
                                    monthIndex = fullMonthNames.indexOf(part);
                                  }
                                  if (monthIndex >= 0) {
                                    monthPart = part;
                                    break;
                                  }
                                }
                                
                                // Find year (4-digit number)
                                let year = 0;
                                for (const part of parts) {
                                  const num = parseInt(part);
                                  if (!isNaN(num) && num >= 2000 && num <= 2100) {
                                    year = num;
                                    break;
                                  }
                                }
                                
                                if (monthIndex >= 0 && year > 0) {
                                  monthDate = new Date(year, monthIndex, 1);
                                  parsedSuccessfully = true;
                                }
                              }
                              
                              if (!parsedSuccessfully) {
                                console.warn(`Failed to parse date from column header: "${columnHeader}"`);
                              }
                              
                              monthRecord.monthDate = monthDate.toISOString();
                              monthlyData.push(monthRecord);
                              
                              // Log first few months for debugging
                              if (i <= 3) {
                                console.log(`Month ${i}: Column="${columnHeader}", Date=${monthDate.toISOString().substring(0, 7)}, Revenue=${monthRecord.revenue}`);
                              }
                            }
                            
                            console.log(`✅ Processed ${monthlyData.length} months of data`);
                            console.log('First month:', monthlyData[0]);
                            console.log('Last month:', monthlyData[monthlyData.length - 1]);
                            console.log('Date range:', monthlyData[0]?.monthDate?.substring(0, 7), 'to', monthlyData[monthlyData.length - 1]?.monthDate?.substring(0, 7));
                            
                            // DEBUG: Final summary of test account
                            if (testAccountName) {
                              const testMapping = aiMappings.find(m => m.qbAccount === testAccountName);
                              const targetField = testMapping?.targetField;
                              console.log(`\n🔬 FINAL SUMMARY - TEST ACCOUNT "${testAccountName}":`);
                              console.log(`Mapped to field: ${targetField}`);
                              console.log('Values across all months:');
                              monthlyData.forEach((month, idx) => {
                                if (targetField && month[targetField]) {
                                  console.log(`  Month ${idx + 1}: ${month[targetField]}`);
                                }
                              });
                            }
                            
                            // Check if we have less than expected months
                            if (monthlyData.length < 12) {
                              console.warn(`⚠️ WARNING: Only ${monthlyData.length} months of data found. Expected at least 12 months for proper reporting.`);
                              if (monthlyData.length === 1) {
                                alert(`⚠️ Only 1 month of data was processed!\n\nQuickBooks may have returned a single-column report instead of monthly breakdown.\n\nThe reports need at least 12 months of data to function properly.\n\nTip: Check the QuickBooks sync settings or try re-syncing.`);
                              } else {
                                alert(`⚠️ Only ${monthlyData.length} months of data processed.\n\nReports work best with at least 12 months of data.`);
                              }
                            }
                            
                            // Save to database
                            if (!currentUser) {
                              throw new Error('User not logged in');
                            }
                            
                            const saveResponse = await fetch('/api/financials', {
                              method: 'POST',
                              headers: { 'Content-Type': 'application/json' },
                              body: JSON.stringify({
                                companyId: selectedCompanyId,
                                uploadedByUserId: currentUser.id,
                                fileName: 'QuickBooks Sync Data',
                                rawData: qbRawData,
                                columnMapping: { source: 'quickbooks', mappings: aiMappings },
                                monthlyData
                              })
                            });
                            
                            if (!saveResponse.ok) {
                              throw new Error('Failed to save monthly data');
                            }
                            
                            alert(`✅ Successfully processed and saved ${monthlyData.length} months of financial data!`);
                          } catch (error: any) {
                            console.error('Error processing monthly data:', error);
                            alert('Failed to process monthly data: ' + error.message);
                          } finally {
                            setIsProcessingMonthlyData(false);
                          }
                        }}
                        disabled={isProcessingMonthlyData || aiMappings.length === 0}
                        style={{
                          padding: '10px 24px',
                          background: isProcessingMonthlyData || aiMappings.length === 0 ? '#94a3b8' : '#3b82f6',
                          color: 'white',
                          border: 'none',
                          borderRadius: '6px',
                          fontSize: '13px',
                          fontWeight: '600',
                          cursor: isProcessingMonthlyData || aiMappings.length === 0 ? 'not-allowed' : 'pointer',
                          boxShadow: '0 2px 6px rgba(59, 130, 246, 0.3)'
                        }}
                      >
                        {isProcessingMonthlyData ? 'Processing...' : '⚙️ Process & Save Monthly Data'}
                      </button>
                          <button
                            onClick={async () => {
                              try {
                                // Fetch the saved monthly data from the API
                                const response = await fetch(`/api/financials?companyId=${selectedCompanyId}`);
                                if (!response.ok) {
                                  throw new Error('Failed to load financial data');
                                }
                                
                                const data = await response.json();
                                const monthlyData = data.records?.[0]?.monthlyData || [];
                                
                                if (!monthlyData || monthlyData.length === 0) {
                                  alert('No financial data found. Please process the monthly data first.');
                                  return;
                                }
                                
                                // Convert to CSV
                                const headers = Object.keys(monthlyData[0]).filter(key => key !== 'id' && key !== 'companyId' && key !== 'createdAt' && key !== 'updatedAt');
                                const csvContent = [
                                  headers.join(','),
                                  ...monthlyData.map((row: any) => 
                                    headers.map(header => {
                                      const value = row[header];
                                      // Format dates nicely
                                      if (header === 'monthDate' && value) {
                                        return new Date(value).toISOString().substring(0, 7); // YYYY-MM format
                                      }
                                      // Handle numbers
                                      if (typeof value === 'number') {
                                        return value;
                                      }
                                      // Escape commas in strings
                                      if (typeof value === 'string' && value.includes(',')) {
                                        return `"${value}"`;
                                      }
                                      return value || 0;
                                    }).join(',')
                                  )
                                ].join('\n');
                                
                                // Create download link
                                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                                const link = document.createElement('a');
                                const url = URL.createObjectURL(blob);
                                const companyName = companies.find(c => c.id === selectedCompanyId)?.name || 'Company';
                                const fileName = `${companyName.replace(/[^a-zA-Z0-9]/g, '_')}_Financial_Data_${new Date().toISOString().substring(0, 10)}.csv`;
                                
                                link.setAttribute('href', url);
                                link.setAttribute('download', fileName);
                                link.style.visibility = 'hidden';
                                document.body.appendChild(link);
                                link.click();
                                document.body.removeChild(link);
                                
                              } catch (error: any) {
                                console.error('Error downloading data:', error);
                                alert('Failed to download data: ' + error.message);
                              }
                            }}
                            style={{
                              padding: '10px 24px',
                              background: '#10b981',
                              color: 'white',
                              border: 'none',
                              borderRadius: '6px',
                              fontSize: '13px',
                              fontWeight: '600',
                              cursor: 'pointer',
                              boxShadow: '0 2px 6px rgba(16, 185, 129, 0.3)'
                            }}
                          >
                            📥 Download Mapped Data (CSV)
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                )}
              </div>
            </div>
          </div>
        );
      })()}

      {/* Financial Statements View - P&L and Balance Sheet ONLY */}
      {currentView === 'financial-statements' && selectedCompanyId && qbRawData && (() => {
        // CRITICAL SECURITY CHECK: Ensure qbRawData matches the selected company
        if (!qbRawData._companyId || qbRawData._companyId !== selectedCompanyId) {
          console.error(`🚨 SECURITY BLOCK: Data mismatch! Selected: ${selectedCompanyId}, Data companyId: ${qbRawData._companyId || 'MISSING'}`);
          return <div style={{ padding: '48px', textAlign: 'center' }}>
            <div style={{ fontSize: '18px', color: '#ef4444', marginBottom: '12px' }}>⚠️ Loading company data...</div>
            <div style={{ fontSize: '14px', color: '#64748b' }}>Please wait while we fetch the correct financial data.</div>
          </div>;
        }
        
        const currentCompany = companies.find(c => c.id === selectedCompanyId);
        const currentCompanyName = currentCompany?.name || 'Unknown';
        console.log(`📊 ========================================`);
        console.log(`📊 FINANCIAL STATEMENTS RENDERING (Refresh Key: ${dataRefreshKey})`);
        console.log(`📊 Selected Company: "${currentCompanyName}" (ID: ${selectedCompanyId})`);
        console.log(`📊 QB Data sync date:`, qbRawData.syncDate);
        console.log(`📊 Data belongs to company:`, qbRawData._companyId);
        console.log(`📊 Record ID:`, qbRawData._recordId);
        console.log(`📊 ========================================`);

        // Helper function to recursively extract all rows from QB report
        const extractRows = (data: any, level: number = 0, parentSection: string = ''): any[] => {
          const result: any[] = [];
          if (!data?.Rows?.Row) return result;
          const rows = Array.isArray(data.Rows.Row) ? data.Rows.Row : [data.Rows.Row];
          
          for (const row of rows) {
            if (row.type === 'Section') {
              const headerName = row.Header?.ColData?.[0]?.value || '';
              result.push({
                type: 'header',
                name: headerName,
                level,
                isHeader: true,
                section: headerName
              });
              if (row.Rows?.Row) {
                const childRows = Array.isArray(row.Rows.Row) ? row.Rows.Row : [row.Rows.Row];
                result.push(...extractRows({ Rows: { Row: childRows } }, level + 1, headerName));
              }
              if (row.Summary?.ColData) {
                const summaryName = row.Summary.ColData[0]?.value || `Total ${headerName}`;
                const value = row.Summary.ColData[row.Summary.ColData.length - 1]?.value;
                let calculatedTotal = 0;
                const dataRows = result.filter(r => r.section === headerName && r.type === 'data');
                if (dataRows.length > 0) {
                  calculatedTotal = dataRows.reduce((sum, r) => sum + (parseFloat(r.value) || 0), 0);
                } else {
                  calculatedTotal = parseFloat(value) || 0;
                }
                if (summaryName && !isNaN(calculatedTotal)) {
                  result.push({
                    type: 'total',
                    name: summaryName,
                    value: calculatedTotal,
                    level,
                    isTotal: true
                  });
                }
              }
            } else if (row.type === 'Data' && row.ColData) {
              const name = row.ColData[0]?.value || '';
              let value = '0';
              for (let i = row.ColData.length - 1; i >= 1; i--) {
                const colValue = row.ColData[i]?.value;
                if (colValue !== undefined && colValue !== '' && !isNaN(parseFloat(colValue))) {
                  value = colValue;
                  break;
                }
              }
              result.push({
                type: 'data',
                name,
                value: parseFloat(value) || 0,
                level,
                section: parentSection,
                colData: row.ColData
              });
            }
          }
          return result;
        };

        const plRows = qbRawData.profitAndLoss?.Rows?.Row ? extractRows(qbRawData.profitAndLoss) : [];
        const bsRows = qbRawData.balanceSheet?.Rows?.Row ? extractRows(qbRawData.balanceSheet) : [];
        
        return (
          <div key={`financial-statements-${selectedCompanyId}-${dataRefreshKey}`} style={{ maxWidth: '1800px', margin: '0 auto', padding: '32px' }}>
            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '8px' }}>
              <h1 style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b', margin: 0 }}>Financial Statements</h1>
              {companyName && <div style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b' }}>{companyName}</div>}
            </div>
            <p style={{ fontSize: '14px', color: '#64748b', marginBottom: '12px' }}>
              QuickBooks Data • Synced: {qbRawData.syncDate ? new Date(qbRawData.syncDate).toLocaleString() : 'Unknown'}
            </p>

            {/* Tab Navigation */}
            <div style={{ display: 'flex', gap: '8px', marginBottom: '12px', borderBottom: '2px solid #e2e8f0' }}>
              <button
                onClick={() => setFinancialStatementsTab('aggregated')}
                style={{
                  padding: '12px 24px',
                  background: financialStatementsTab === 'aggregated' ? '#667eea' : 'transparent',
                  color: financialStatementsTab === 'aggregated' ? 'white' : '#64748b',
                  border: 'none',
                  borderBottom: financialStatementsTab === 'aggregated' ? '3px solid #667eea' : '3px solid transparent',
                  fontSize: '16px',
                  fontWeight: '600',
                  cursor: 'pointer',
                  borderRadius: '8px 8px 0 0',
                  transition: 'all 0.2s'
                }}
              >
                Aggregated Financials
              </button>
              <button
                onClick={() => setFinancialStatementsTab('line-of-business')}
                style={{
                  padding: '12px 24px',
                  background: financialStatementsTab === 'line-of-business' ? '#667eea' : 'transparent',
                  color: financialStatementsTab === 'line-of-business' ? 'white' : '#64748b',
                  border: 'none',
                  borderBottom: financialStatementsTab === 'line-of-business' ? '3px solid #667eea' : '3px solid transparent',
                  fontSize: '16px',
                  fontWeight: '600',
                  cursor: 'pointer',
                  borderRadius: '8px 8px 0 0',
                  transition: 'all 0.2s'
                }}
              >
                Line of Business Reporting
              </button>
            </div>

            {/* Aggregated Financials Tab */}
            {financialStatementsTab === 'aggregated' && (
            <>
            {/* Statement Controls */}
            <div style={{ marginBottom: '32px', padding: '24px', background: 'white', borderRadius: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
              <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr 1fr', gap: '16px' }}>
                {/* Type of Statement */}
                <div>
                  <label style={{ display: 'block', fontSize: '13px', fontWeight: '600', color: '#475569', marginBottom: '8px' }}>
                    Type of Statement
                  </label>
                  <select 
                    value={statementType}
                    onChange={(e) => setStatementType(e.target.value as 'income-statement' | 'balance-sheet')}
                    style={{ 
                      width: '100%', 
                      padding: '10px 12px', 
                      border: '1px solid #cbd5e1', 
                      borderRadius: '6px', 
                      fontSize: '14px',
                      color: '#1e293b',
                      background: 'white',
                      cursor: 'pointer'
                    }}
                  >
                    <option value="income-statement">Income Statement</option>
                    <option value="balance-sheet">Balance Sheet</option>
                  </select>
                </div>

                {/* Period */}
                <div>
                  <label style={{ display: 'block', fontSize: '13px', fontWeight: '600', color: '#475569', marginBottom: '8px' }}>
                    Period
                  </label>
                  <select 
                    value={statementPeriod}
                    onChange={(e) => setStatementPeriod(e.target.value as any)}
                    style={{ 
                      width: '100%', 
                      padding: '10px 12px', 
                      border: '1px solid #cbd5e1', 
                      borderRadius: '6px', 
                      fontSize: '14px',
                      color: '#1e293b',
                      background: 'white',
                      cursor: 'pointer'
                    }}
                  >
                    <option value="current-month">Current Month</option>
                    <option value="current-quarter">Current Quarter</option>
                    <option value="last-12-months">Last 12 months</option>
                    <option value="ytd">YTD</option>
                    <option value="last-year">Last Year</option>
                    <option value="last-3-years">Last 3 Years</option>
                  </select>
                </div>

                {/* Display As */}
                <div>
                  <label style={{ display: 'block', fontSize: '13px', fontWeight: '600', color: '#475569', marginBottom: '8px' }}>
                    Display As
                  </label>
                  <select 
                    value={statementDisplay}
                    onChange={(e) => setStatementDisplay(e.target.value as 'monthly' | 'quarterly' | 'annual')}
                    style={{ 
                      width: '100%', 
                      padding: '10px 12px', 
                      border: '1px solid #cbd5e1', 
                      borderRadius: '6px', 
                      fontSize: '14px',
                      color: '#1e293b',
                      background: 'white',
                      cursor: 'pointer'
                    }}
                  >
                    <option value="monthly">Monthly</option>
                    <option value="quarterly">Quarterly</option>
                    <option value="annual">Annual</option>
                  </select>
                </div>
              </div>
            </div>

            {/* Statement Content Area */}
            {(() => {
              console.log('📊 Financial Statement Render Check:', {
                statementType,
                statementPeriod,
                monthlyLength: monthly?.length || 0,
                loadedMonthlyDataLength: loadedMonthlyData?.length || 0,
                hasMonthly: !!monthly,
                monthlyFirst: monthly?.[0],
                condition: statementType === 'income-statement' && statementPeriod === 'current-month' && monthly.length > 0
              });
              
              if (statementType === 'income-statement' && statementPeriod === 'current-month' && monthly.length > 0) {
                const currentMonth = monthly[monthly.length - 1];
                const monthDate = new Date(currentMonth.date || currentMonth.month);
                const monthName = monthDate.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
                
                // Revenue
                const revenue = currentMonth.revenue || 0;
                
                // Cost of Goods Sold
                const cogsPayroll = currentMonth.cogsPayroll || 0;
                const cogsOwnerPay = currentMonth.cogsOwnerPay || 0;
                const cogsContractors = currentMonth.cogsContractors || 0;
                const cogsMaterials = currentMonth.cogsMaterials || 0;
                const cogsCommissions = currentMonth.cogsCommissions || 0;
                const cogsOther = currentMonth.cogsOther || 0;
                const cogs = cogsPayroll + cogsOwnerPay + cogsContractors + cogsMaterials + cogsCommissions + cogsOther;
                
                const grossProfit = revenue - cogs;
                const grossMargin = revenue > 0 ? (grossProfit / revenue) * 100 : 0;
                
                // Operating Expenses
                const opexPayroll = currentMonth.opexPayroll || 0;
                const ownersBasePay = currentMonth.ownersBasePay || 0;
                const ownersRetirement = currentMonth.ownersRetirement || 0;
                const professionalServices = currentMonth.professionalServices || 0;
                const rentLease = currentMonth.rentLease || 0;
                const utilities = currentMonth.utilities || 0;
                const equipment = currentMonth.equipment || 0;
                const travel = currentMonth.travel || 0;
                const insurance = currentMonth.insurance || 0;
                const opexSalesMarketing = currentMonth.opexSalesMarketing || 0;
                const contractorsDistribution = currentMonth.contractorsDistribution || 0;
                const depreciationExpense = currentMonth.depreciationExpense || 0;
                const opexOther = currentMonth.opexOther || 0;
                
                const totalOpex = opexPayroll + ownersBasePay + ownersRetirement + professionalServices + 
                                 rentLease + utilities + equipment + travel + insurance + 
                                 opexSalesMarketing + contractorsDistribution + depreciationExpense + opexOther;
                
                const operatingIncome = grossProfit - totalOpex;
                const operatingMargin = revenue > 0 ? (operatingIncome / revenue) * 100 : 0;
                
                // Other Income/Expense
                const interestExpense = currentMonth.interestExpense || 0;
                const nonOperatingIncome = currentMonth.nonOperatingIncome || 0;
                const extraordinaryItems = currentMonth.extraordinaryItems || 0;
                
                const netIncome = operatingIncome - interestExpense + nonOperatingIncome + extraordinaryItems;
                const netMargin = revenue > 0 ? (netIncome / revenue) * 100 : 0;
                
                return (
                  <div style={{ background: 'white', borderRadius: '12px', padding: '32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                      <div style={{ marginBottom: '32px', borderBottom: '2px solid #e2e8f0', paddingBottom: '16px' }}>
                        <h2 style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b', marginBottom: '4px' }}>Income Statement</h2>
                        <div style={{ fontSize: '14px', color: '#64748b' }}>For the Month Ended {monthName}</div>
                      </div>

                      {/* Revenue Section */}
                      <div style={{ marginBottom: '12px' }}>
                        <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0', borderBottom: '1px solid #e2e8f0' }}>
                          <span style={{ fontWeight: '600', color: '#1e293b' }}>Revenue</span>
                          <span style={{ fontWeight: '600', color: '#1e293b' }}>${revenue.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                      </div>

                      {/* COGS Section */}
                      <div style={{ marginBottom: '12px' }}>
                        <div style={{ fontWeight: '600', color: '#1e293b', marginBottom: '8px' }}>Cost of Goods Sold</div>
                        {cogsPayroll > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>COGS - Payroll</span>
                            <span style={{ color: '#475569' }}>${cogsPayroll.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {cogsOwnerPay > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>COGS - Owner Pay</span>
                            <span style={{ color: '#475569' }}>${cogsOwnerPay.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {cogsContractors > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>COGS - Contractors</span>
                            <span style={{ color: '#475569' }}>${cogsContractors.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {cogsMaterials > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>COGS - Materials</span>
                            <span style={{ color: '#475569' }}>${cogsMaterials.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {cogsCommissions > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>COGS - Commissions</span>
                            <span style={{ color: '#475569' }}>${cogsCommissions.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {cogsOther > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>COGS - Other</span>
                            <span style={{ color: '#475569' }}>${cogsOther.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0', borderTop: '1px solid #e2e8f0', marginTop: '4px' }}>
                          <span style={{ fontWeight: '600', color: '#1e293b' }}>Total COGS</span>
                          <span style={{ fontWeight: '600', color: '#1e293b' }}>${cogs.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                      </div>

                      {/* Gross Profit */}
                      <div style={{ marginBottom: '12px', background: '#dbeafe', padding: '12px', borderRadius: '8px' }}>
                        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '4px' }}>
                          <span style={{ fontWeight: '700', color: '#1e40af' }}>Gross Profit</span>
                          <span style={{ fontWeight: '700', color: '#1e40af' }}>${grossProfit.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                        <div style={{ fontSize: '13px', color: '#1e40af', textAlign: 'right' }}>
                          {grossMargin.toFixed(1)}% margin
                        </div>
                      </div>

                      {/* Operating Expenses */}
                      <div style={{ marginBottom: '12px' }}>
                        <div style={{ fontWeight: '600', color: '#1e293b', marginBottom: '8px' }}>Operating Expenses</div>
                        {opexPayroll > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Payroll</span>
                            <span style={{ color: '#475569' }}>${opexPayroll.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {ownersBasePay > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Owner's Base Pay</span>
                            <span style={{ color: '#475569' }}>${ownersBasePay.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {ownersRetirement > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Owner's Retirement</span>
                            <span style={{ color: '#475569' }}>${ownersRetirement.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {professionalServices > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Professional Services</span>
                            <span style={{ color: '#475569' }}>${professionalServices.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {rentLease > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Rent/Lease</span>
                            <span style={{ color: '#475569' }}>${rentLease.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {utilities > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Utilities</span>
                            <span style={{ color: '#475569' }}>${utilities.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {equipment > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Equipment</span>
                            <span style={{ color: '#475569' }}>${equipment.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {travel > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Travel</span>
                            <span style={{ color: '#475569' }}>${travel.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {insurance > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Insurance</span>
                            <span style={{ color: '#475569' }}>${insurance.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {opexSalesMarketing > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Sales & Marketing</span>
                            <span style={{ color: '#475569' }}>${opexSalesMarketing.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {contractorsDistribution > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Contractors Distribution</span>
                            <span style={{ color: '#475569' }}>${contractorsDistribution.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {depreciationExpense > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Depreciation & Amortization</span>
                            <span style={{ color: '#475569' }}>${depreciationExpense.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {opexOther > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Other Operating Expenses</span>
                            <span style={{ color: '#475569' }}>${opexOther.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0', borderTop: '1px solid #e2e8f0', marginTop: '4px' }}>
                          <span style={{ fontWeight: '600', color: '#1e293b' }}>Total Operating Expenses</span>
                          <span style={{ fontWeight: '600', color: '#1e293b' }}>${totalOpex.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                      </div>

                      {/* Operating Income */}
                      <div style={{ marginBottom: '12px', background: '#f0fdf4', padding: '12px', borderRadius: '8px' }}>
                        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '4px' }}>
                          <span style={{ fontWeight: '700', color: '#166534' }}>Operating Income</span>
                          <span style={{ fontWeight: '700', color: '#166534' }}>${operatingIncome.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                        <div style={{ fontSize: '13px', color: '#166534', textAlign: 'right' }}>
                          {operatingMargin.toFixed(1)}% margin
                        </div>
                      </div>

                      {/* Other Income/Expense */}
                      {(interestExpense > 0 || nonOperatingIncome > 0 || extraordinaryItems !== 0) && (
                        <div style={{ marginBottom: '12px' }}>
                          <div style={{ fontWeight: '600', color: '#1e293b', marginBottom: '8px' }}>Other Income/(Expense)</div>
                          {nonOperatingIncome > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#475569' }}>Non-Operating Income</span>
                              <span style={{ color: '#10b981' }}>${nonOperatingIncome.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {interestExpense > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#475569' }}>Interest Expense</span>
                              <span style={{ color: '#ef4444' }}>($  {interestExpense.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })})</span>
                            </div>
                          )}
                          {extraordinaryItems !== 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#475569' }}>Extraordinary Items</span>
                              <span style={{ color: extraordinaryItems >= 0 ? '#10b981' : '#ef4444' }}>
                                {extraordinaryItems >= 0 ? '$' : '($'}{Math.abs(extraordinaryItems).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}{extraordinaryItems < 0 ? ')' : ''}
                              </span>
                            </div>
                          )}
                        </div>
                      )}

                      {/* Net Income */}
                      <div style={{ background: netIncome >= 0 ? '#dcfce7' : '#fee2e2', padding: '16px', borderRadius: '8px', marginTop: '32px' }}>
                        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '4px' }}>
                          <span style={{ fontWeight: '700', fontSize: '18px', color: netIncome >= 0 ? '#166534' : '#991b1b' }}>Net Income</span>
                          <span style={{ fontWeight: '700', fontSize: '18px', color: netIncome >= 0 ? '#166534' : '#991b1b' }}>
                            ${netIncome.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                          </span>
                        </div>
                        <div style={{ fontSize: '14px', color: netIncome >= 0 ? '#166534' : '#991b1b', textAlign: 'right' }}>
                          {netMargin.toFixed(1)}% net margin
                        </div>
                      </div>
                  </div>
                );
              } else if (statementType === 'income-statement-percent' && statementPeriod === 'current-month') {
                const currentMonth = monthly[monthly.length - 1];
                const monthDate = new Date(currentMonth.date || currentMonth.month);
                const monthName = monthDate.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
                
                // Revenue
                const revenue = currentMonth.revenue || 0;
                
                // Cost of Goods Sold
                const cogsPayroll = currentMonth.cogsPayroll || 0;
                const cogsOwnerPay = currentMonth.cogsOwnerPay || 0;
                const cogsContractors = currentMonth.cogsContractors || 0;
                const cogsMaterials = currentMonth.cogsMaterials || 0;
                const cogsCommissions = currentMonth.cogsCommissions || 0;
                const cogsOther = currentMonth.cogsOther || 0;
                const cogs = cogsPayroll + cogsOwnerPay + cogsContractors + cogsMaterials + cogsCommissions + cogsOther;
                
                const grossProfit = revenue - cogs;
                const grossMargin = revenue > 0 ? (grossProfit / revenue) * 100 : 0;
                
                // Operating Expenses
                const opexPayroll = currentMonth.opexPayroll || 0;
                const ownersBasePay = currentMonth.ownersBasePay || 0;
                const ownersRetirement = currentMonth.ownersRetirement || 0;
                const professionalServices = currentMonth.professionalServices || 0;
                const rentLease = currentMonth.rentLease || 0;
                const utilities = currentMonth.utilities || 0;
                const equipment = currentMonth.equipment || 0;
                const travel = currentMonth.travel || 0;
                const insurance = currentMonth.insurance || 0;
                const opexSalesMarketing = currentMonth.opexSalesMarketing || 0;
                const contractorsDistribution = currentMonth.contractorsDistribution || 0;
                const depreciationExpense = currentMonth.depreciationExpense || 0;
                const opexOther = currentMonth.opexOther || 0;
                
                const totalOpex = opexPayroll + ownersBasePay + ownersRetirement + professionalServices + 
                                 rentLease + utilities + equipment + travel + insurance + 
                                 opexSalesMarketing + contractorsDistribution + depreciationExpense + opexOther;
                
                const operatingIncome = grossProfit - totalOpex;
                const operatingMargin = revenue > 0 ? (operatingIncome / revenue) * 100 : 0;
                
                // Other Income/Expense
                const interestExpense = currentMonth.interestExpense || 0;
                const nonOperatingIncome = currentMonth.nonOperatingIncome || 0;
                const extraordinaryItems = currentMonth.extraordinaryItems || 0;
                
                const netIncome = operatingIncome - interestExpense + nonOperatingIncome + extraordinaryItems;
                const netMargin = revenue > 0 ? (netIncome / revenue) * 100 : 0;
                
                // Helper function to calculate percentage
                const pct = (amount: number) => revenue > 0 ? (amount / revenue) * 100 : 0;
                
                return (
                  <div style={{ background: 'white', borderRadius: '12px', padding: '32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                    <div style={{ marginBottom: '32px', borderBottom: '2px solid #e2e8f0', paddingBottom: '16px' }}>
                      <h2 style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b', marginBottom: '4px' }}>Income Statement - Common Size Analysis</h2>
                      <div style={{ fontSize: '14px', color: '#64748b' }}>For the Month Ended {monthName} • All items shown as % of Revenue</div>
                    </div>

                    {/* Column Headers */}
                    <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '8px 0', borderBottom: '2px solid #cbd5e1', marginBottom: '12px', fontWeight: '600', fontSize: '13px', color: '#475569' }}>
                      <div>Line Item</div>
                      <div style={{ textAlign: 'right' }}>Amount</div>
                      <div style={{ textAlign: 'right' }}>% of Revenue</div>
                    </div>

                    {/* Revenue Section */}
                    <div style={{ marginBottom: '12px' }}>
                      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '8px 0', borderBottom: '1px solid #e2e8f0', background: '#f8fafc' }}>
                        <span style={{ fontWeight: '600', color: '#1e293b' }}>Revenue</span>
                        <span style={{ fontWeight: '600', color: '#1e293b', textAlign: 'right' }}>${revenue.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                        <span style={{ fontWeight: '600', color: '#1e293b', textAlign: 'right' }}>100.0%</span>
                      </div>
                    </div>

                    {/* COGS Section */}
                    <div style={{ marginBottom: '12px' }}>
                      <div style={{ fontWeight: '600', color: '#1e293b', marginBottom: '8px', fontSize: '15px' }}>Cost of Goods Sold</div>
                      {cogsPayroll > 0 && (
                        <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                          <span style={{ color: '#475569', paddingLeft: '20px' }}>COGS - Payroll</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>${cogsPayroll.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>{pct(cogsPayroll).toFixed(1)}%</span>
                        </div>
                      )}
                      {cogsOwnerPay > 0 && (
                        <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                          <span style={{ color: '#475569', paddingLeft: '20px' }}>COGS - Owner Pay</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>${cogsOwnerPay.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>{pct(cogsOwnerPay).toFixed(1)}%</span>
                        </div>
                      )}
                      {cogsContractors > 0 && (
                        <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                          <span style={{ color: '#475569', paddingLeft: '20px' }}>COGS - Contractors</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>${cogsContractors.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>{pct(cogsContractors).toFixed(1)}%</span>
                        </div>
                      )}
                      {cogsMaterials > 0 && (
                        <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                          <span style={{ color: '#475569', paddingLeft: '20px' }}>COGS - Materials</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>${cogsMaterials.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>{pct(cogsMaterials).toFixed(1)}%</span>
                        </div>
                      )}
                      {cogsCommissions > 0 && (
                        <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                          <span style={{ color: '#475569', paddingLeft: '20px' }}>COGS - Commissions</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>${cogsCommissions.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>{pct(cogsCommissions).toFixed(1)}%</span>
                        </div>
                      )}
                      {cogsOther > 0 && (
                        <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                          <span style={{ color: '#475569', paddingLeft: '20px' }}>COGS - Other</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>${cogsOther.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>{pct(cogsOther).toFixed(1)}%</span>
                        </div>
                      )}
                      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '8px 0', borderTop: '1px solid #e2e8f0', marginTop: '4px' }}>
                        <span style={{ fontWeight: '600', color: '#1e293b', paddingLeft: '20px' }}>Total COGS</span>
                        <span style={{ fontWeight: '600', color: '#1e293b', textAlign: 'right' }}>${cogs.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                        <span style={{ fontWeight: '600', color: '#1e293b', textAlign: 'right' }}>{pct(cogs).toFixed(1)}%</span>
                      </div>
                    </div>

                    {/* Gross Profit */}
                    <div style={{ marginBottom: '12px', background: '#dbeafe', padding: '12px', borderRadius: '8px' }}>
                      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr' }}>
                        <span style={{ fontWeight: '700', color: '#1e40af' }}>Gross Profit</span>
                        <span style={{ fontWeight: '700', color: '#1e40af', textAlign: 'right' }}>${grossProfit.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                        <span style={{ fontWeight: '700', color: '#1e40af', textAlign: 'right' }}>{grossMargin.toFixed(1)}%</span>
                      </div>
                    </div>

                    {/* Operating Expenses */}
                    <div style={{ marginBottom: '12px' }}>
                      <div style={{ fontWeight: '600', color: '#1e293b', marginBottom: '8px', fontSize: '15px' }}>Operating Expenses</div>
                      {opexPayroll > 0 && (
                        <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                          <span style={{ color: '#475569', paddingLeft: '20px' }}>Payroll</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>${opexPayroll.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>{pct(opexPayroll).toFixed(1)}%</span>
                        </div>
                      )}
                      {ownersBasePay > 0 && (
                        <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                          <span style={{ color: '#475569', paddingLeft: '20px' }}>Owner's Base Pay</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>${ownersBasePay.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>{pct(ownersBasePay).toFixed(1)}%</span>
                        </div>
                      )}
                      {ownersRetirement > 0 && (
                        <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                          <span style={{ color: '#475569', paddingLeft: '20px' }}>Owner's Retirement</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>${ownersRetirement.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>{pct(ownersRetirement).toFixed(1)}%</span>
                        </div>
                      )}
                      {professionalServices > 0 && (
                        <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                          <span style={{ color: '#475569', paddingLeft: '20px' }}>Professional Services</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>${professionalServices.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>{pct(professionalServices).toFixed(1)}%</span>
                        </div>
                      )}
                      {rentLease > 0 && (
                        <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                          <span style={{ color: '#475569', paddingLeft: '20px' }}>Rent/Lease</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>${rentLease.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>{pct(rentLease).toFixed(1)}%</span>
                        </div>
                      )}
                      {utilities > 0 && (
                        <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                          <span style={{ color: '#475569', paddingLeft: '20px' }}>Utilities</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>${utilities.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>{pct(utilities).toFixed(1)}%</span>
                        </div>
                      )}
                      {equipment > 0 && (
                        <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                          <span style={{ color: '#475569', paddingLeft: '20px' }}>Equipment</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>${equipment.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>{pct(equipment).toFixed(1)}%</span>
                        </div>
                      )}
                      {travel > 0 && (
                        <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                          <span style={{ color: '#475569', paddingLeft: '20px' }}>Travel</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>${travel.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>{pct(travel).toFixed(1)}%</span>
                        </div>
                      )}
                      {insurance > 0 && (
                        <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                          <span style={{ color: '#475569', paddingLeft: '20px' }}>Insurance</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>${insurance.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>{pct(insurance).toFixed(1)}%</span>
                        </div>
                      )}
                      {opexSalesMarketing > 0 && (
                        <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                          <span style={{ color: '#475569', paddingLeft: '20px' }}>Sales & Marketing</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>${opexSalesMarketing.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>{pct(opexSalesMarketing).toFixed(1)}%</span>
                        </div>
                      )}
                      {contractorsDistribution > 0 && (
                        <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                          <span style={{ color: '#475569', paddingLeft: '20px' }}>Contractors Distribution</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>${contractorsDistribution.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>{pct(contractorsDistribution).toFixed(1)}%</span>
                        </div>
                      )}
                      {depreciationExpense > 0 && (
                        <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                          <span style={{ color: '#475569', paddingLeft: '20px' }}>Depreciation & Amortization</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>${depreciationExpense.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>{pct(depreciationExpense).toFixed(1)}%</span>
                        </div>
                      )}
                      {opexOther > 0 && (
                        <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                          <span style={{ color: '#475569', paddingLeft: '20px' }}>Other Operating Expenses</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>${opexOther.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                          <span style={{ color: '#475569', textAlign: 'right' }}>{pct(opexOther).toFixed(1)}%</span>
                        </div>
                      )}
                      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '8px 0', borderTop: '1px solid #e2e8f0', marginTop: '4px' }}>
                        <span style={{ fontWeight: '600', color: '#1e293b', paddingLeft: '20px' }}>Total Operating Expenses</span>
                        <span style={{ fontWeight: '600', color: '#1e293b', textAlign: 'right' }}>${totalOpex.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                        <span style={{ fontWeight: '600', color: '#1e293b', textAlign: 'right' }}>{pct(totalOpex).toFixed(1)}%</span>
                      </div>
                    </div>

                    {/* Operating Income */}
                    <div style={{ marginBottom: '12px', background: '#f0fdf4', padding: '12px', borderRadius: '8px' }}>
                      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr' }}>
                        <span style={{ fontWeight: '700', color: '#166534' }}>Operating Income</span>
                        <span style={{ fontWeight: '700', color: '#166534', textAlign: 'right' }}>${operatingIncome.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                        <span style={{ fontWeight: '700', color: '#166534', textAlign: 'right' }}>{operatingMargin.toFixed(1)}%</span>
                      </div>
                    </div>

                    {/* Other Income/Expense */}
                    {(interestExpense > 0 || nonOperatingIncome > 0 || extraordinaryItems !== 0) && (
                      <div style={{ marginBottom: '12px' }}>
                        <div style={{ fontWeight: '600', color: '#1e293b', marginBottom: '8px', fontSize: '15px' }}>Other Income/(Expense)</div>
                        {nonOperatingIncome > 0 && (
                          <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                            <span style={{ color: '#475569', paddingLeft: '20px' }}>Non-Operating Income</span>
                            <span style={{ color: '#10b981', textAlign: 'right' }}>${nonOperatingIncome.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                            <span style={{ color: '#10b981', textAlign: 'right' }}>{pct(nonOperatingIncome).toFixed(1)}%</span>
                          </div>
                        )}
                        {interestExpense > 0 && (
                          <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                            <span style={{ color: '#475569', paddingLeft: '20px' }}>Interest Expense</span>
                            <span style={{ color: '#ef4444', textAlign: 'right' }}>($  {interestExpense.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })})</span>
                            <span style={{ color: '#ef4444', textAlign: 'right' }}>({pct(interestExpense).toFixed(1)}%)</span>
                          </div>
                        )}
                        {extraordinaryItems !== 0 && (
                          <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                            <span style={{ color: '#475569', paddingLeft: '20px' }}>Extraordinary Items</span>
                            <span style={{ color: extraordinaryItems >= 0 ? '#10b981' : '#ef4444', textAlign: 'right' }}>
                              {extraordinaryItems >= 0 ? '$' : '($'}{Math.abs(extraordinaryItems).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}{extraordinaryItems < 0 ? ')' : ''}
                            </span>
                            <span style={{ color: extraordinaryItems >= 0 ? '#10b981' : '#ef4444', textAlign: 'right' }}>
                              {extraordinaryItems >= 0 ? '' : '('}{pct(Math.abs(extraordinaryItems)).toFixed(1)}%{extraordinaryItems < 0 ? ')' : ''}
                            </span>
                          </div>
                        )}
                      </div>
                    )}

                    {/* Net Income */}
                    <div style={{ background: netIncome >= 0 ? '#dcfce7' : '#fee2e2', padding: '16px', borderRadius: '8px', marginTop: '32px' }}>
                      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr' }}>
                        <span style={{ fontWeight: '700', fontSize: '18px', color: netIncome >= 0 ? '#166534' : '#991b1b' }}>Net Income</span>
                        <span style={{ fontWeight: '700', fontSize: '18px', color: netIncome >= 0 ? '#166534' : '#991b1b', textAlign: 'right' }}>
                          ${netIncome.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                        </span>
                        <span style={{ fontWeight: '700', fontSize: '18px', color: netIncome >= 0 ? '#166534' : '#991b1b', textAlign: 'right' }}>
                          {netMargin.toFixed(1)}%
                        </span>
                      </div>
                    </div>
                  </div>
                );
              } else if (statementType === 'balance-sheet' && statementPeriod === 'current-month') {
                const currentMonth = monthly[monthly.length - 1];
                const monthDate = new Date(currentMonth.date || currentMonth.month);
                const monthName = monthDate.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
                
                // Assets
                const cash = currentMonth.cash || 0;
                const ar = currentMonth.ar || 0;
                const inventory = currentMonth.inventory || 0;
                const otherCA = currentMonth.otherCA || 0;
                const tca = cash + ar + inventory + otherCA;
                
                const fixedAssets = currentMonth.fixedAssets || 0;
                const otherAssets = currentMonth.otherAssets || 0;
                const totalAssets = tca + fixedAssets + otherAssets;
                
                // Liabilities
                const ap = currentMonth.ap || 0;
                const otherCL = currentMonth.otherCL || 0;
                const tcl = ap + otherCL;
                
                const ltd = currentMonth.ltd || 0;
                const totalLiabilities = tcl + ltd;
                
                // Equity
                const totalEquity = currentMonth.totalEquity || 0;
                
                // Total L&E
                const totalLAndE = totalLiabilities + totalEquity;
                
                return (
                  <div style={{ background: 'white', borderRadius: '12px', padding: '32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                    <div style={{ marginBottom: '32px', borderBottom: '2px solid #e2e8f0', paddingBottom: '16px' }}>
                      <h2 style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b', marginBottom: '4px' }}>Balance Sheet</h2>
                      <div style={{ fontSize: '14px', color: '#64748b' }}>As of {monthName}</div>
                    </div>

                    {/* ASSETS */}
                    <div style={{ marginBottom: '32px' }}>
                      <div style={{ fontSize: '18px', fontWeight: '700', color: '#1e293b', marginBottom: '16px', paddingBottom: '8px', borderBottom: '2px solid #667eea' }}>ASSETS</div>
                      
                      {/* Current Assets */}
                      <div style={{ marginBottom: '20px' }}>
                        <div style={{ fontWeight: '600', color: '#1e293b', marginBottom: '8px', fontSize: '15px' }}>Current Assets</div>
                        {cash > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Cash</span>
                            <span style={{ color: '#475569' }}>${cash.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {ar > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Accounts Receivable</span>
                            <span style={{ color: '#475569' }}>${ar.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {inventory > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Inventory</span>
                            <span style={{ color: '#475569' }}>${inventory.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {otherCA > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Other Current Assets</span>
                            <span style={{ color: '#475569' }}>${otherCA.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0 8px 20px', borderTop: '1px solid #e2e8f0', marginTop: '4px' }}>
                          <span style={{ fontWeight: '600', color: '#1e293b' }}>Total Current Assets</span>
                          <span style={{ fontWeight: '600', color: '#1e293b' }}>${tca.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                      </div>

                      {/* Non-Current Assets */}
                      {fixedAssets > 0 && (
                        <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0', fontSize: '14px' }}>
                          <span style={{ color: '#475569' }}>Fixed Assets</span>
                          <span style={{ color: '#475569' }}>${fixedAssets.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                      )}
                      {otherAssets > 0 && (
                        <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0', fontSize: '14px' }}>
                          <span style={{ color: '#475569' }}>Other Assets</span>
                          <span style={{ color: '#475569' }}>${otherAssets.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                      )}
                      
                      <div style={{ display: 'flex', justifyContent: 'space-between', padding: '12px 0', borderTop: '2px solid #667eea', marginTop: '8px', background: '#f8fafc' }}>
                        <span style={{ fontWeight: '700', fontSize: '16px', color: '#1e293b' }}>TOTAL ASSETS</span>
                        <span style={{ fontWeight: '700', fontSize: '16px', color: '#1e293b' }}>${totalAssets.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                      </div>
                    </div>

                    {/* LIABILITIES */}
                    <div style={{ marginBottom: '32px' }}>
                      <div style={{ fontSize: '18px', fontWeight: '700', color: '#1e293b', marginBottom: '16px', paddingBottom: '8px', borderBottom: '2px solid #f59e0b' }}>LIABILITIES</div>
                      
                      {/* Current Liabilities */}
                      <div style={{ marginBottom: '20px' }}>
                        <div style={{ fontWeight: '600', color: '#1e293b', marginBottom: '8px', fontSize: '15px' }}>Current Liabilities</div>
                        {ap > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Accounts Payable</span>
                            <span style={{ color: '#475569' }}>${ap.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {otherCL > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Other Current Liabilities</span>
                            <span style={{ color: '#475569' }}>${otherCL.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0 8px 20px', borderTop: '1px solid #e2e8f0', marginTop: '4px' }}>
                          <span style={{ fontWeight: '600', color: '#1e293b' }}>Total Current Liabilities</span>
                          <span style={{ fontWeight: '600', color: '#1e293b' }}>${tcl.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                      </div>

                      {/* Long-term Debt */}
                      {ltd > 0 && (
                        <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0', fontSize: '14px' }}>
                          <span style={{ color: '#475569' }}>Long-term Debt</span>
                          <span style={{ color: '#475569' }}>${ltd.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                      )}
                      
                      <div style={{ display: 'flex', justifyContent: 'space-between', padding: '12px 0', borderTop: '2px solid #f59e0b', marginTop: '8px', background: '#fef3c7' }}>
                        <span style={{ fontWeight: '700', fontSize: '16px', color: '#1e293b' }}>TOTAL LIABILITIES</span>
                        <span style={{ fontWeight: '700', fontSize: '16px', color: '#1e293b' }}>${totalLiabilities.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                      </div>
                    </div>

                    {/* EQUITY */}
                    <div style={{ marginBottom: '12px' }}>
                      <div style={{ fontSize: '18px', fontWeight: '700', color: '#1e293b', marginBottom: '16px', paddingBottom: '8px', borderBottom: '2px solid #10b981' }}>EQUITY</div>
                      
                      <div style={{ display: 'flex', justifyContent: 'space-between', padding: '12px 0', borderTop: '2px solid #10b981', background: '#d1fae5' }}>
                        <span style={{ fontWeight: '700', fontSize: '16px', color: '#1e293b' }}>TOTAL EQUITY</span>
                        <span style={{ fontWeight: '700', fontSize: '16px', color: '#1e293b' }}>${totalEquity.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                      </div>
                    </div>

                    {/* TOTAL LIABILITIES & EQUITY */}
                    <div style={{ background: '#f1f5f9', padding: '16px', borderRadius: '8px', marginTop: '32px' }}>
                      <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '4px' }}>
                        <span style={{ fontWeight: '700', fontSize: '18px', color: '#1e293b' }}>TOTAL LIABILITIES & EQUITY</span>
                        <span style={{ fontWeight: '700', fontSize: '18px', color: '#1e293b' }}>
                          ${totalLAndE.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                        </span>
                      </div>
                      {Math.abs(totalAssets - totalLAndE) > 0.01 && (
                        <div style={{ fontSize: '12px', color: '#ef4444', marginTop: '8px', textAlign: 'right' }}>
                          ⚠️ Balance check: Assets - (Liabilities + Equity) = ${(totalAssets - totalLAndE).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                        </div>
                      )}
                    </div>
                  </div>
                );
              }
              
              // Multi-period logic (Current Quarter, Last 12 Months, YTD, Last Year, Last 3 Years)
              else if (monthly.length > 0 && statementPeriod !== 'current-month') {
                // Helper function to get months for the selected period
                const getMonthsForPeriod = () => {
                  const now = new Date();
                  const currentYear = now.getFullYear();
                  const currentMonth = now.getMonth(); // 0-11
                  
                  switch (statementPeriod) {
                    case 'current-quarter':
                      // Last 3 months
                      return monthly.slice(-3);
                    
                    case 'last-12-months':
                      // Last 12 months
                      return monthly.slice(-12);
                    
                    case 'ytd':
                      // Year to date - from January of current year to now
                      return monthly.filter(m => {
                        const mDate = new Date(m.date || m.month);
                        return mDate.getFullYear() === currentYear;
                      });
                    
                    case 'last-year':
                      // Full previous year
                      return monthly.filter(m => {
                        const mDate = new Date(m.date || m.month);
                        return mDate.getFullYear() === currentYear - 1;
                      });
                    
                    case 'last-3-years':
                      // Last 36 months
                      return monthly.slice(-36);
                    
                    default:
                      return [];
                  }
                };
                
                const periodMonths = getMonthsForPeriod();
                
                if (periodMonths.length === 0) {
                  return (
                    <div style={{ background: 'white', borderRadius: '12px', padding: '48px 32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', minHeight: '400px', textAlign: 'center' }}>
                      <div style={{ fontSize: '18px', fontWeight: '600', color: '#64748b', marginBottom: '12px' }}>
                        📊 No Data Available
                      </div>
                      <p style={{ fontSize: '14px', color: '#94a3b8' }}>
                        No financial data available for the selected period.
                      </p>
                    </div>
                  );
                }
                
                // Get period label
                const getPeriodLabel = () => {
                  const firstMonth = periodMonths[0];
                  const lastMonth = periodMonths[periodMonths.length - 1];
                  const firstDate = new Date(firstMonth.date || firstMonth.month);
                  const lastDate = new Date(lastMonth.date || lastMonth.month);
                  
                  switch (statementPeriod) {
                    case 'current-quarter':
                      return `Current Quarter (${firstDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' })} - ${lastDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' })})`;
                    case 'last-12-months':
                      return `Last 12 Months (${firstDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' })} - ${lastDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' })})`;
                    case 'ytd':
                      return `Year to Date ${lastDate.getFullYear()} (Jan - ${lastDate.toLocaleDateString('en-US', { month: 'short' })})`;
                    case 'last-year':
                      return `Fiscal Year ${firstDate.getFullYear()}`;
                    case 'last-3-years':
                      return `Last 3 Years (${firstDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' })} - ${lastDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' })})`;
                    default:
                      return '';
                  }
                };
                
              const periodLabel = getPeriodLabel();
              const latestMonth = periodMonths[periodMonths.length - 1];
              
              // Helper function to group months by display period
              const groupMonthsByDisplay = () => {
                if (statementDisplay === 'monthly') {
                  return periodMonths.map(m => ({
                    label: new Date(m.date || m.month).toLocaleDateString('en-US', { month: 'short', year: 'numeric' }),
                    months: [m]
                  }));
                } else if (statementDisplay === 'quarterly') {
                  const quarters: { [key: string]: any[] } = {};
                  periodMonths.forEach(m => {
                    const date = new Date(m.date || m.month);
                    const year = date.getFullYear();
                    const quarter = Math.floor(date.getMonth() / 3) + 1;
                    const key = `${year}-Q${quarter}`;
                    if (!quarters[key]) quarters[key] = [];
                    quarters[key].push(m);
                  });
                  return Object.entries(quarters).map(([key, months]) => ({
                    label: key,
                    months
                  }));
                } else {
                  const years: { [key: string]: any[] } = {};
                  periodMonths.forEach(m => {
                    const year = new Date(m.date || m.month).getFullYear().toString();
                    if (!years[year]) years[year] = [];
                    years[year].push(m);
                  });
                  return Object.entries(years).map(([year, months]) => ({
                    label: year,
                    months
                  }));
                }
              };
              
              const displayPeriods = groupMonthsByDisplay();
              
              // INCOME STATEMENT - Aggregate across period
              if (statementType === 'income-statement') {
                // Check if showing multiple periods side-by-side
                if (displayPeriods.length > 1) {
                  const calc = (months: any[], field: string) => months.reduce((sum, m) => sum + (m[field] || 0), 0);
                  const periodsData = displayPeriods.map(p => {
                    const m = p.months;
                    const cogsPayroll = calc(m, 'cogsPayroll');
                    const cogsOwnerPay = calc(m, 'cogsOwnerPay');
                    const cogsContractors = calc(m, 'cogsContractors');
                    const cogsMaterials = calc(m, 'cogsMaterials');
                    const cogsCommissions = calc(m, 'cogsCommissions');
                    const cogsOther = calc(m, 'cogsOther');
                    const opexPayroll = calc(m, 'opexPayroll');
                    const ownersBasePay = calc(m, 'ownersBasePay');
                    const ownersRetirement = calc(m, 'ownersRetirement');
                    const professionalServices = calc(m, 'professionalServices');
                    const rentLease = calc(m, 'rentLease');
                    const utilities = calc(m, 'utilities');
                    const equipment = calc(m, 'equipment');
                    const travel = calc(m, 'travel');
                    const insurance = calc(m, 'insurance');
                    const opexSalesMarketing = calc(m, 'opexSalesMarketing');
                    const contractorsDistribution = calc(m, 'contractorsDistribution');
                    const depreciationExpense = calc(m, 'depreciationExpense');
                    const opexOther = calc(m, 'opexOther');
                    const revenue = calc(m, 'revenue');
                    const cogs = cogsPayroll + cogsOwnerPay + cogsContractors + cogsMaterials + cogsCommissions + cogsOther;
                    const grossProfit = revenue - cogs;
                    const totalOpex = opexPayroll + ownersBasePay + ownersRetirement + professionalServices + rentLease + utilities + equipment + travel + insurance + opexSalesMarketing + contractorsDistribution + depreciationExpense + opexOther;
                    const operatingIncome = grossProfit - totalOpex;
                    const interestExpense = calc(m, 'interestExpense');
                    const nonOperatingIncome = calc(m, 'nonOperatingIncome');
                    const extraordinaryItems = calc(m, 'extraordinaryItems');
                    const netIncome = operatingIncome - interestExpense + nonOperatingIncome + extraordinaryItems;
                    return { label: p.label, revenue, cogsPayroll, cogsOwnerPay, cogsContractors, cogsMaterials, cogsCommissions, cogsOther, cogs, grossProfit, opexPayroll, ownersBasePay, ownersRetirement, professionalServices, rentLease, utilities, equipment, travel, insurance, opexSalesMarketing, contractorsDistribution, depreciationExpense, opexOther, totalOpex, operatingIncome, interestExpense, nonOperatingIncome, extraordinaryItems, netIncome };
                  });
                  const Row = ({ label, values, indent = 0, bold = false }: any) => (
                    <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: bold ? '14px' : '13px', fontWeight: bold ? '600' : 'normal' }}>
                      <div style={{ color: bold ? '#475569' : '#64748b', paddingLeft: `${indent}px` }}>{label}</div>
                      {values.map((v: number, i: number) => (
                        <div key={i} style={{ textAlign: 'right', color: bold ? '#475569' : '#64748b' }}>${(v / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                      ))}
                    </div>
                  );
                  return (
                    <div style={{ background: 'white', borderRadius: '12px', padding: '32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', overflowX: 'auto' }}>
                      <div style={{ marginBottom: '12px', borderBottom: '2px solid #e2e8f0', paddingBottom: '16px' }}>
                        <h2 style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b', marginBottom: '4px' }}>Comparative Income Statement</h2>
                        <div style={{ fontSize: '14px', color: '#64748b' }}>{periodLabel} - {statementDisplay === 'monthly' ? 'Monthly' : statementDisplay === 'quarterly' ? 'Quarterly' : 'Annual'}</div>
                      </div>
                      <div style={{ minWidth: `${200 + (periodsData.length * 110)}px` }}>
                        <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '12px 0', borderBottom: '2px solid #1e293b', fontWeight: '600', color: '#1e293b' }}>
                          <div>Line Item</div>
                          {periodsData.map((p, i) => <div key={i} style={{ textAlign: 'right' }}>{p.label}</div>)}
                        </div>
                        <Row label="Revenue" values={periodsData.map(p => p.revenue)} bold />
                        <div style={{ margin: '8px 0 4px', fontSize: '14px', fontWeight: '600', color: '#475569' }}>Cost of Goods Sold</div>
                        {periodsData.some(p => p.cogsPayroll > 0) && <Row label="COGS - Payroll" values={periodsData.map(p => p.cogsPayroll)} indent={20} />}
                        {periodsData.some(p => p.cogsOwnerPay > 0) && <Row label="COGS - Owner Pay" values={periodsData.map(p => p.cogsOwnerPay)} indent={20} />}
                        {periodsData.some(p => p.cogsContractors > 0) && <Row label="COGS - Contractors" values={periodsData.map(p => p.cogsContractors)} indent={20} />}
                        {periodsData.some(p => p.cogsMaterials > 0) && <Row label="COGS - Materials" values={periodsData.map(p => p.cogsMaterials)} indent={20} />}
                        {periodsData.some(p => p.cogsCommissions > 0) && <Row label="COGS - Commissions" values={periodsData.map(p => p.cogsCommissions)} indent={20} />}
                        {periodsData.some(p => p.cogsOther > 0) && <Row label="COGS - Other" values={periodsData.map(p => p.cogsOther)} indent={20} />}
                        <Row label="Total COGS" values={periodsData.map(p => p.cogs)} bold />
                        <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '10px 8px', background: '#dbeafe', borderRadius: '4px', margin: '8px 0', fontWeight: '700', color: '#1e40af' }}>
                          <div>Gross Profit</div>
                          {periodsData.map((p, i) => <div key={i} style={{ textAlign: 'right' }}>${(p.grossProfit / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>)}
                        </div>
                        <div style={{ margin: '12px 0 4px', fontSize: '14px', fontWeight: '600', color: '#475569' }}>Operating Expenses</div>
                        {periodsData.some(p => p.opexPayroll > 0) && <Row label="Payroll" values={periodsData.map(p => p.opexPayroll)} indent={20} />}
                        {periodsData.some(p => p.ownersBasePay > 0) && <Row label="Owner's Base Pay" values={periodsData.map(p => p.ownersBasePay)} indent={20} />}
                        {periodsData.some(p => p.ownersRetirement > 0) && <Row label="Owner's Retirement" values={periodsData.map(p => p.ownersRetirement)} indent={20} />}
                        {periodsData.some(p => p.professionalServices > 0) && <Row label="Professional Services" values={periodsData.map(p => p.professionalServices)} indent={20} />}
                        {periodsData.some(p => p.rentLease > 0) && <Row label="Rent/Lease" values={periodsData.map(p => p.rentLease)} indent={20} />}
                        {periodsData.some(p => p.utilities > 0) && <Row label="Utilities" values={periodsData.map(p => p.utilities)} indent={20} />}
                        {periodsData.some(p => p.equipment > 0) && <Row label="Equipment" values={periodsData.map(p => p.equipment)} indent={20} />}
                        {periodsData.some(p => p.travel > 0) && <Row label="Travel" values={periodsData.map(p => p.travel)} indent={20} />}
                        {periodsData.some(p => p.insurance > 0) && <Row label="Insurance" values={periodsData.map(p => p.insurance)} indent={20} />}
                        {periodsData.some(p => p.opexSalesMarketing > 0) && <Row label="Sales & Marketing" values={periodsData.map(p => p.opexSalesMarketing)} indent={20} />}
                        {periodsData.some(p => p.contractorsDistribution > 0) && <Row label="Contractors - Distribution" values={periodsData.map(p => p.contractorsDistribution)} indent={20} />}
                        {periodsData.some(p => p.depreciationExpense > 0) && <Row label="Depreciation & Amortization" values={periodsData.map(p => p.depreciationExpense)} indent={20} />}
                        {periodsData.some(p => p.opexOther > 0) && <Row label="Other Operating Expenses" values={periodsData.map(p => p.opexOther)} indent={20} />}
                        <Row label="Total Operating Expenses" values={periodsData.map(p => p.totalOpex)} bold />
                        <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '10px 8px', background: '#dbeafe', borderRadius: '4px', margin: '8px 0', fontWeight: '700', color: '#1e40af' }}>
                          <div>Operating Income</div>
                          {periodsData.map((p, i) => <div key={i} style={{ textAlign: 'right' }}>${(p.operatingIncome / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>)}
                        </div>
                        {periodsData.some(p => p.interestExpense > 0 || p.nonOperatingIncome > 0 || p.extraordinaryItems !== 0) && (
                          <>
                            <div style={{ margin: '12px 0 4px', fontSize: '14px', fontWeight: '600', color: '#475569' }}>Other Income/(Expense)</div>
                            {periodsData.some(p => p.interestExpense > 0) && <Row label="Interest Expense" values={periodsData.map(p => -p.interestExpense)} indent={20} />}
                            {periodsData.some(p => p.nonOperatingIncome > 0) && <Row label="Non-Operating Income" values={periodsData.map(p => p.nonOperatingIncome)} indent={20} />}
                            {periodsData.some(p => p.extraordinaryItems !== 0) && <Row label="Extraordinary Items" values={periodsData.map(p => p.extraordinaryItems)} indent={20} />}
                          </>
                        )}
                        <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '12px 8px', background: '#dcfce7', borderRadius: '4px', margin: '12px 0 0', fontWeight: '700', fontSize: '15px' }}>
                          <div style={{ color: '#166534' }}>Net Income</div>
                          {periodsData.map((p, i) => (
                            <div key={i} style={{ textAlign: 'right', color: p.netIncome >= 0 ? '#166534' : '#991b1b' }}>
                              {p.netIncome >= 0 ? '$' : '($'}{(Math.abs(p.netIncome) / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K{p.netIncome < 0 ? ')' : ''}
                            </div>
                          ))}
                        </div>
                      </div>
                    </div>
                  );
                }
                
                // Sum all income statement items
                const revenue = periodMonths.reduce((sum, m) => sum + (m.revenue || 0), 0);
                  
                  const cogsPayroll = periodMonths.reduce((sum, m) => sum + (m.cogsPayroll || 0), 0);
                  const cogsOwnerPay = periodMonths.reduce((sum, m) => sum + (m.cogsOwnerPay || 0), 0);
                  const cogsContractors = periodMonths.reduce((sum, m) => sum + (m.cogsContractors || 0), 0);
                  const cogsMaterials = periodMonths.reduce((sum, m) => sum + (m.cogsMaterials || 0), 0);
                  const cogsCommissions = periodMonths.reduce((sum, m) => sum + (m.cogsCommissions || 0), 0);
                  const cogsOther = periodMonths.reduce((sum, m) => sum + (m.cogsOther || 0), 0);
                  const cogs = cogsPayroll + cogsOwnerPay + cogsContractors + cogsMaterials + cogsCommissions + cogsOther;
                  
                  const grossProfit = revenue - cogs;
                  const grossMargin = revenue > 0 ? (grossProfit / revenue) * 100 : 0;
                  
                  const opexPayroll = periodMonths.reduce((sum, m) => sum + (m.opexPayroll || 0), 0);
                  const ownersBasePay = periodMonths.reduce((sum, m) => sum + (m.ownersBasePay || 0), 0);
                  const ownersRetirement = periodMonths.reduce((sum, m) => sum + (m.ownersRetirement || 0), 0);
                  const professionalServices = periodMonths.reduce((sum, m) => sum + (m.professionalServices || 0), 0);
                  const rentLease = periodMonths.reduce((sum, m) => sum + (m.rentLease || 0), 0);
                  const utilities = periodMonths.reduce((sum, m) => sum + (m.utilities || 0), 0);
                  const equipment = periodMonths.reduce((sum, m) => sum + (m.equipment || 0), 0);
                  const travel = periodMonths.reduce((sum, m) => sum + (m.travel || 0), 0);
                  const insurance = periodMonths.reduce((sum, m) => sum + (m.insurance || 0), 0);
                  const opexSalesMarketing = periodMonths.reduce((sum, m) => sum + (m.opexSalesMarketing || 0), 0);
                  const contractorsDistribution = periodMonths.reduce((sum, m) => sum + (m.contractorsDistribution || 0), 0);
                  const depreciationExpense = periodMonths.reduce((sum, m) => sum + (m.depreciationExpense || 0), 0);
                  const opexOther = periodMonths.reduce((sum, m) => sum + (m.opexOther || 0), 0);
                  
                  const totalOpex = opexPayroll + ownersBasePay + ownersRetirement + professionalServices + 
                                   rentLease + utilities + equipment + travel + insurance + 
                                   opexSalesMarketing + contractorsDistribution + depreciationExpense + opexOther;
                  
                  const operatingIncome = grossProfit - totalOpex;
                  const operatingMargin = revenue > 0 ? (operatingIncome / revenue) * 100 : 0;
                  
                  const interestExpense = periodMonths.reduce((sum, m) => sum + (m.interestExpense || 0), 0);
                  const nonOperatingIncome = periodMonths.reduce((sum, m) => sum + (m.nonOperatingIncome || 0), 0);
                  const extraordinaryItems = periodMonths.reduce((sum, m) => sum + (m.extraordinaryItems || 0), 0);
                  
                  const netIncome = operatingIncome - interestExpense + nonOperatingIncome + extraordinaryItems;
                  const netMargin = revenue > 0 ? (netIncome / revenue) * 100 : 0;
                  
                  return (
                    <div style={{ background: 'white', borderRadius: '12px', padding: '32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                        <div style={{ marginBottom: '32px', borderBottom: '2px solid #e2e8f0', paddingBottom: '16px' }}>
                          <h2 style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b', marginBottom: '4px' }}>Income Statement</h2>
                          <div style={{ fontSize: '14px', color: '#64748b' }}>For the Period: {periodLabel}</div>
                        </div>

                        {/* Revenue Section */}
                        <div style={{ marginBottom: '12px' }}>
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0', borderBottom: '1px solid #e2e8f0' }}>
                            <span style={{ fontWeight: '600', color: '#1e293b' }}>Revenue</span>
                            <span style={{ fontWeight: '600', color: '#1e293b' }}>${revenue.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        </div>

                        {/* COGS Section */}
                        <div style={{ marginBottom: '12px' }}>
                          <div style={{ fontWeight: '600', color: '#1e293b', marginBottom: '8px' }}>Cost of Goods Sold</div>
                          {cogsPayroll > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#475569' }}>COGS - Payroll</span>
                              <span style={{ color: '#475569' }}>${cogsPayroll.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {cogsOwnerPay > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#475569' }}>COGS - Owner Pay</span>
                              <span style={{ color: '#475569' }}>${cogsOwnerPay.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {cogsContractors > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#475569' }}>COGS - Contractors</span>
                              <span style={{ color: '#475569' }}>${cogsContractors.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {cogsMaterials > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#475569' }}>COGS - Materials</span>
                              <span style={{ color: '#475569' }}>${cogsMaterials.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {cogsCommissions > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#475569' }}>COGS - Commissions</span>
                              <span style={{ color: '#475569' }}>${cogsCommissions.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {cogsOther > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#475569' }}>COGS - Other</span>
                              <span style={{ color: '#475569' }}>${cogsOther.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0', borderTop: '1px solid #e2e8f0', marginTop: '4px' }}>
                            <span style={{ fontWeight: '600', color: '#1e293b' }}>Total COGS</span>
                            <span style={{ fontWeight: '600', color: '#1e293b' }}>${cogs.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        </div>

                        {/* Gross Profit */}
                        <div style={{ marginBottom: '12px', background: '#dbeafe', padding: '12px', borderRadius: '8px' }}>
                          <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '4px' }}>
                            <span style={{ fontWeight: '700', color: '#1e40af' }}>Gross Profit</span>
                            <span style={{ fontWeight: '700', color: '#1e40af' }}>${grossProfit.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                          <div style={{ fontSize: '13px', color: '#1e40af', textAlign: 'right' }}>
                            {grossMargin.toFixed(1)}% margin
                          </div>
                        </div>

                        {/* Operating Expenses */}
                        <div style={{ marginBottom: '12px' }}>
                          <div style={{ fontWeight: '600', color: '#1e293b', marginBottom: '8px' }}>Operating Expenses</div>
                          {opexPayroll > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#475569' }}>Payroll</span>
                              <span style={{ color: '#475569' }}>${opexPayroll.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {ownersBasePay > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#475569' }}>Owner's Base Pay</span>
                              <span style={{ color: '#475569' }}>${ownersBasePay.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {ownersRetirement > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#475569' }}>Owner's Retirement</span>
                              <span style={{ color: '#475569' }}>${ownersRetirement.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {professionalServices > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#475569' }}>Professional Services</span>
                              <span style={{ color: '#475569' }}>${professionalServices.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {rentLease > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#475569' }}>Rent/Lease</span>
                              <span style={{ color: '#475569' }}>${rentLease.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {utilities > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#475569' }}>Utilities</span>
                              <span style={{ color: '#475569' }}>${utilities.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {equipment > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#475569' }}>Equipment</span>
                              <span style={{ color: '#475569' }}>${equipment.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {travel > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#475569' }}>Travel</span>
                              <span style={{ color: '#475569' }}>${travel.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {insurance > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#475569' }}>Insurance</span>
                              <span style={{ color: '#475569' }}>${insurance.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {opexSalesMarketing > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#475569' }}>Sales & Marketing</span>
                              <span style={{ color: '#475569' }}>${opexSalesMarketing.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {contractorsDistribution > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#475569' }}>Contractors - Distribution</span>
                              <span style={{ color: '#475569' }}>${contractorsDistribution.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {depreciationExpense > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#475569' }}>Depreciation & Amortization</span>
                              <span style={{ color: '#475569' }}>${depreciationExpense.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {opexOther > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#475569' }}>Other Operating Expenses</span>
                              <span style={{ color: '#475569' }}>${opexOther.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0', borderTop: '1px solid #e2e8f0', marginTop: '4px' }}>
                            <span style={{ fontWeight: '600', color: '#1e293b' }}>Total Operating Expenses</span>
                            <span style={{ fontWeight: '600', color: '#1e293b' }}>${totalOpex.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        </div>

                        {/* Operating Income */}
                        <div style={{ marginBottom: '12px', background: '#dbeafe', padding: '12px', borderRadius: '8px' }}>
                          <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '4px' }}>
                            <span style={{ fontWeight: '700', color: '#1e40af' }}>Operating Income</span>
                            <span style={{ fontWeight: '700', color: '#1e40af' }}>${operatingIncome.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                          <div style={{ fontSize: '13px', color: '#1e40af', textAlign: 'right' }}>
                            {operatingMargin.toFixed(1)}% operating margin
                          </div>
                        </div>

                        {/* Other Income/Expense */}
                        <div style={{ marginBottom: '12px' }}>
                          <div style={{ fontWeight: '600', color: '#1e293b', marginBottom: '8px' }}>Other Income/(Expense)</div>
                          {interestExpense > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#475569' }}>Interest Expense</span>
                              <span style={{ color: '#475569' }}>(${ interestExpense.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })})</span>
                            </div>
                          )}
                          {nonOperatingIncome > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#475569' }}>Non-Operating Income</span>
                              <span style={{ color: '#475569' }}>${nonOperatingIncome.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {extraordinaryItems !== 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#475569' }}>Extraordinary Items</span>
                              <span style={{ color: '#475569' }}>{extraordinaryItems >= 0 ? '$' : '($'}{Math.abs(extraordinaryItems).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}{extraordinaryItems < 0 ? ')' : ''}</span>
                            </div>
                          )}
                        </div>

                        {/* Net Income */}
                        <div style={{ background: netIncome >= 0 ? '#dcfce7' : '#fee2e2', padding: '16px', borderRadius: '8px', marginTop: '24px' }}>
                          <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '4px' }}>
                            <span style={{ fontWeight: '700', fontSize: '18px', color: netIncome >= 0 ? '#166534' : '#991b1b' }}>Net Income</span>
                            <span style={{ fontWeight: '700', fontSize: '18px', color: netIncome >= 0 ? '#166534' : '#991b1b' }}>
                              {netIncome >= 0 ? '$' : '($'}{Math.abs(netIncome).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}{netIncome < 0 ? ')' : ''}
                            </span>
                          </div>
                          <div style={{ fontSize: '14px', color: netIncome >= 0 ? '#166534' : '#991b1b', textAlign: 'right' }}>
                            {netMargin.toFixed(1)}% net margin
                          </div>
                        </div>
                    </div>
                  );
                }
                
                // COMMON SIZE INCOME STATEMENT - Aggregate with percentages
                else if (statementType === 'income-statement-percent') {
                  // Check if showing multiple periods side-by-side
                  if (displayPeriods.length > 1) {
                    const calc = (months: any[], field: string) => months.reduce((sum, m) => sum + (m[field] || 0), 0);
                    const periodsData = displayPeriods.map(p => {
                      const m = p.months;
                      const revenue = calc(m, 'revenue');
                      const cogsPayroll = calc(m, 'cogsPayroll');
                      const cogsOwnerPay = calc(m, 'cogsOwnerPay');
                      const cogsContractors = calc(m, 'cogsContractors');
                      const cogsMaterials = calc(m, 'cogsMaterials');
                      const cogsCommissions = calc(m, 'cogsCommissions');
                      const cogsOther = calc(m, 'cogsOther');
                      const opexPayroll = calc(m, 'opexPayroll');
                      const ownersBasePay = calc(m, 'ownersBasePay');
                      const ownersRetirement = calc(m, 'ownersRetirement');
                      const professionalServices = calc(m, 'professionalServices');
                      const rentLease = calc(m, 'rentLease');
                      const utilities = calc(m, 'utilities');
                      const equipment = calc(m, 'equipment');
                      const travel = calc(m, 'travel');
                      const insurance = calc(m, 'insurance');
                      const opexSalesMarketing = calc(m, 'opexSalesMarketing');
                      const contractorsDistribution = calc(m, 'contractorsDistribution');
                      const depreciationExpense = calc(m, 'depreciationExpense');
                      const opexOther = calc(m, 'opexOther');
                      const interestExpense = calc(m, 'interestExpense');
                      const nonOperatingIncome = calc(m, 'nonOperatingIncome');
                      const extraordinaryItems = calc(m, 'extraordinaryItems');
                      const cogs = cogsPayroll + cogsOwnerPay + cogsContractors + cogsMaterials + cogsCommissions + cogsOther;
                      const totalOpex = opexPayroll + ownersBasePay + ownersRetirement + professionalServices + rentLease + utilities + equipment + travel + insurance + opexSalesMarketing + contractorsDistribution + depreciationExpense + opexOther;
                      const grossProfit = revenue - cogs;
                      const operatingIncome = grossProfit - totalOpex;
                      const netIncome = operatingIncome - interestExpense + nonOperatingIncome + extraordinaryItems;
                      return { label: p.label, revenue, cogsPayroll, cogsOwnerPay, cogsContractors, cogsMaterials, cogsCommissions, cogsOther, cogs, grossProfit, opexPayroll, ownersBasePay, ownersRetirement, professionalServices, rentLease, utilities, equipment, travel, insurance, opexSalesMarketing, contractorsDistribution, depreciationExpense, opexOther, totalOpex, operatingIncome, interestExpense, nonOperatingIncome, extraordinaryItems, netIncome };
                    });
                    const RowWithPercent = ({ label, values, indent = 0, bold = false }: any) => (
                      <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 90px 60px)`, gap: '4px', padding: '4px 0', fontSize: bold ? '14px' : '13px', fontWeight: bold ? '600' : 'normal' }}>
                        <div style={{ color: bold ? '#475569' : '#64748b', paddingLeft: `${indent}px` }}>{label}</div>
                        {values.map((v: number, i: number) => {
                          const pct = periodsData[i].revenue > 0 ? (v / periodsData[i].revenue) * 100 : 0;
                          return (
                            <div key={i} style={{ display: 'contents' }}>
                              <div style={{ textAlign: 'right', color: bold ? '#475569' : '#64748b' }}>${(v / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                              <div style={{ textAlign: 'right', color: '#64748b', fontSize: '12px' }}>{pct.toFixed(1)}%</div>
                            </div>
                          );
                        })}
                      </div>
                    );
                    return (
                      <div style={{ background: 'white', borderRadius: '12px', padding: '32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', overflowX: 'auto' }}>
                        <div style={{ marginBottom: '12px', borderBottom: '2px solid #e2e8f0', paddingBottom: '16px' }}>
                          <h2 style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b', marginBottom: '4px' }}>Comparative Common Size Income Statement</h2>
                          <div style={{ fontSize: '14px', color: '#64748b' }}>{periodLabel} - {statementDisplay === 'monthly' ? 'Monthly' : statementDisplay === 'quarterly' ? 'Quarterly' : 'Annual'}</div>
                        </div>
                        <div style={{ minWidth: `${200 + (periodsData.length * 150)}px` }}>
                        <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 90px 60px)`, gap: '4px', padding: '12px 0', borderBottom: '2px solid #1e293b', fontWeight: '600', color: '#1e293b' }}>
                          <div>Line Item</div>
                          {periodsData.map((p, i) => (
                            <div key={i} style={{ display: 'contents' }}>
                              <div style={{ textAlign: 'right' }}>{p.label}</div>
                              <div style={{ textAlign: 'right', fontSize: '12px' }}>% of Rev</div>
                            </div>
                          ))}
                          </div>
                          <RowWithPercent label="Revenue" values={periodsData.map(p => p.revenue)} bold />
                          <div style={{ margin: '8px 0 4px', fontSize: '14px', fontWeight: '600', color: '#475569' }}>Cost of Goods Sold</div>
                          {periodsData.some(p => p.cogsPayroll > 0) && <RowWithPercent label="COGS - Payroll" values={periodsData.map(p => p.cogsPayroll)} indent={20} />}
                          {periodsData.some(p => p.cogsOwnerPay > 0) && <RowWithPercent label="COGS - Owner Pay" values={periodsData.map(p => p.cogsOwnerPay)} indent={20} />}
                          {periodsData.some(p => p.cogsContractors > 0) && <RowWithPercent label="COGS - Contractors" values={periodsData.map(p => p.cogsContractors)} indent={20} />}
                          {periodsData.some(p => p.cogsMaterials > 0) && <RowWithPercent label="COGS - Materials" values={periodsData.map(p => p.cogsMaterials)} indent={20} />}
                          {periodsData.some(p => p.cogsCommissions > 0) && <RowWithPercent label="COGS - Commissions" values={periodsData.map(p => p.cogsCommissions)} indent={20} />}
                          {periodsData.some(p => p.cogsOther > 0) && <RowWithPercent label="COGS - Other" values={periodsData.map(p => p.cogsOther)} indent={20} />}
                          <RowWithPercent label="Total COGS" values={periodsData.map(p => p.cogs)} bold />
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 90px 60px)`, gap: '4px', padding: '10px 8px', background: '#dbeafe', borderRadius: '4px', margin: '8px 0', fontWeight: '700', color: '#1e40af' }}>
                            <div>Gross Profit</div>
                            {periodsData.map((p, i) => {
                              const pct = p.revenue > 0 ? (p.grossProfit / p.revenue) * 100 : 0;
                              return (
                                <div key={i} style={{ display: 'contents' }}>
                                  <div style={{ textAlign: 'right' }}>${(p.grossProfit / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                                  <div style={{ textAlign: 'right', fontSize: '12px' }}>{pct.toFixed(1)}%</div>
                                </div>
                              );
                            })}
                          </div>
                          <div style={{ margin: '12px 0 4px', fontSize: '14px', fontWeight: '600', color: '#475569' }}>Operating Expenses</div>
                          {periodsData.some(p => p.opexPayroll > 0) && <RowWithPercent label="Payroll" values={periodsData.map(p => p.opexPayroll)} indent={20} />}
                          {periodsData.some(p => p.ownersBasePay > 0) && <RowWithPercent label="Owner's Base Pay" values={periodsData.map(p => p.ownersBasePay)} indent={20} />}
                          {periodsData.some(p => p.ownersRetirement > 0) && <RowWithPercent label="Owner's Retirement" values={periodsData.map(p => p.ownersRetirement)} indent={20} />}
                          {periodsData.some(p => p.professionalServices > 0) && <RowWithPercent label="Professional Services" values={periodsData.map(p => p.professionalServices)} indent={20} />}
                          {periodsData.some(p => p.rentLease > 0) && <RowWithPercent label="Rent/Lease" values={periodsData.map(p => p.rentLease)} indent={20} />}
                          {periodsData.some(p => p.utilities > 0) && <RowWithPercent label="Utilities" values={periodsData.map(p => p.utilities)} indent={20} />}
                          {periodsData.some(p => p.equipment > 0) && <RowWithPercent label="Equipment" values={periodsData.map(p => p.equipment)} indent={20} />}
                          {periodsData.some(p => p.travel > 0) && <RowWithPercent label="Travel" values={periodsData.map(p => p.travel)} indent={20} />}
                          {periodsData.some(p => p.insurance > 0) && <RowWithPercent label="Insurance" values={periodsData.map(p => p.insurance)} indent={20} />}
                          {periodsData.some(p => p.opexSalesMarketing > 0) && <RowWithPercent label="Sales & Marketing" values={periodsData.map(p => p.opexSalesMarketing)} indent={20} />}
                          {periodsData.some(p => p.contractorsDistribution > 0) && <RowWithPercent label="Contractors - Distribution" values={periodsData.map(p => p.contractorsDistribution)} indent={20} />}
                          {periodsData.some(p => p.depreciationExpense > 0) && <RowWithPercent label="Depreciation & Amortization" values={periodsData.map(p => p.depreciationExpense)} indent={20} />}
                          {periodsData.some(p => p.opexOther > 0) && <RowWithPercent label="Other Operating Expenses" values={periodsData.map(p => p.opexOther)} indent={20} />}
                          <RowWithPercent label="Total Operating Expenses" values={periodsData.map(p => p.totalOpex)} bold />
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 90px 60px)`, gap: '4px', padding: '10px 8px', background: '#dbeafe', borderRadius: '4px', margin: '8px 0', fontWeight: '700', color: '#1e40af' }}>
                            <div>Operating Income</div>
                            {periodsData.map((p, i) => {
                              const pct = p.revenue > 0 ? (p.operatingIncome / p.revenue) * 100 : 0;
                              return (
                                <div key={i} style={{ display: 'contents' }}>
                                  <div style={{ textAlign: 'right' }}>${(p.operatingIncome / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                                  <div style={{ textAlign: 'right', fontSize: '12px' }}>{pct.toFixed(1)}%</div>
                                </div>
                              );
                            })}
                          </div>
                          {periodsData.some(p => p.interestExpense > 0 || p.nonOperatingIncome > 0 || p.extraordinaryItems !== 0) && (
                            <>
                              <div style={{ margin: '12px 0 4px', fontSize: '14px', fontWeight: '600', color: '#475569' }}>Other Income/(Expense)</div>
                              {periodsData.some(p => p.interestExpense > 0) && <RowWithPercent label="Interest Expense" values={periodsData.map(p => -p.interestExpense)} indent={20} />}
                              {periodsData.some(p => p.nonOperatingIncome > 0) && <RowWithPercent label="Non-Operating Income" values={periodsData.map(p => p.nonOperatingIncome)} indent={20} />}
                              {periodsData.some(p => p.extraordinaryItems !== 0) && <RowWithPercent label="Extraordinary Items" values={periodsData.map(p => p.extraordinaryItems)} indent={20} />}
                            </>
                          )}
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 90px 60px)`, gap: '4px', padding: '12px 8px', background: '#dcfce7', borderRadius: '4px', margin: '12px 0 0', fontWeight: '700', fontSize: '15px' }}>
                            <div style={{ color: '#166534' }}>Net Income</div>
                            {periodsData.map((p, i) => {
                              const pct = p.revenue > 0 ? (p.netIncome / p.revenue) * 100 : 0;
                              return (
                                <div key={i} style={{ display: 'contents' }}>
                                  <div style={{ textAlign: 'right', color: p.netIncome >= 0 ? '#166534' : '#991b1b' }}>
                                    {p.netIncome >= 0 ? '$' : '($'}{(Math.abs(p.netIncome) / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K{p.netIncome < 0 ? ')' : ''}
                                  </div>
                                  <div style={{ textAlign: 'right', fontSize: '12px', color: p.netIncome >= 0 ? '#166534' : '#991b1b' }}>{pct.toFixed(1)}%</div>
                                </div>
                              );
                            })}
                          </div>
                        </div>
                      </div>
                    );
                  }
                  
                  const revenue = periodMonths.reduce((sum, m) => sum + (m.revenue || 0), 0);
                  
                  const cogsPayroll = periodMonths.reduce((sum, m) => sum + (m.cogsPayroll || 0), 0);
                  const cogsOwnerPay = periodMonths.reduce((sum, m) => sum + (m.cogsOwnerPay || 0), 0);
                  const cogsContractors = periodMonths.reduce((sum, m) => sum + (m.cogsContractors || 0), 0);
                  const cogsMaterials = periodMonths.reduce((sum, m) => sum + (m.cogsMaterials || 0), 0);
                  const cogsCommissions = periodMonths.reduce((sum, m) => sum + (m.cogsCommissions || 0), 0);
                  const cogsOther = periodMonths.reduce((sum, m) => sum + (m.cogsOther || 0), 0);
                  const cogs = cogsPayroll + cogsOwnerPay + cogsContractors + cogsMaterials + cogsCommissions + cogsOther;
                  
                  const grossProfit = revenue - cogs;
                  
                  const opexPayroll = periodMonths.reduce((sum, m) => sum + (m.opexPayroll || 0), 0);
                  const ownersBasePay = periodMonths.reduce((sum, m) => sum + (m.ownersBasePay || 0), 0);
                  const ownersRetirement = periodMonths.reduce((sum, m) => sum + (m.ownersRetirement || 0), 0);
                  const professionalServices = periodMonths.reduce((sum, m) => sum + (m.professionalServices || 0), 0);
                  const rentLease = periodMonths.reduce((sum, m) => sum + (m.rentLease || 0), 0);
                  const utilities = periodMonths.reduce((sum, m) => sum + (m.utilities || 0), 0);
                  const equipment = periodMonths.reduce((sum, m) => sum + (m.equipment || 0), 0);
                  const travel = periodMonths.reduce((sum, m) => sum + (m.travel || 0), 0);
                  const insurance = periodMonths.reduce((sum, m) => sum + (m.insurance || 0), 0);
                  const opexSalesMarketing = periodMonths.reduce((sum, m) => sum + (m.opexSalesMarketing || 0), 0);
                  const contractorsDistribution = periodMonths.reduce((sum, m) => sum + (m.contractorsDistribution || 0), 0);
                  const depreciationExpense = periodMonths.reduce((sum, m) => sum + (m.depreciationExpense || 0), 0);
                  const opexOther = periodMonths.reduce((sum, m) => sum + (m.opexOther || 0), 0);
                  
                  const totalOpex = opexPayroll + ownersBasePay + ownersRetirement + professionalServices + 
                                   rentLease + utilities + equipment + travel + insurance + 
                                   opexSalesMarketing + contractorsDistribution + depreciationExpense + opexOther;
                  
                  const operatingIncome = grossProfit - totalOpex;
                  
                  const interestExpense = periodMonths.reduce((sum, m) => sum + (m.interestExpense || 0), 0);
                  const nonOperatingIncome = periodMonths.reduce((sum, m) => sum + (m.nonOperatingIncome || 0), 0);
                  const extraordinaryItems = periodMonths.reduce((sum, m) => sum + (m.extraordinaryItems || 0), 0);
                  
                  const netIncome = operatingIncome - interestExpense + nonOperatingIncome + extraordinaryItems;
                  
                  const calcPercent = (value: number) => revenue > 0 ? ((value / revenue) * 100).toFixed(1) + '%' : '0.0%';
                  
                  return (
                    <div style={{ background: 'white', borderRadius: '12px', padding: '32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                        <div style={{ marginBottom: '32px', borderBottom: '2px solid #e2e8f0', paddingBottom: '16px' }}>
                          <h2 style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b', marginBottom: '4px' }}>Common Size Income Statement</h2>
                          <div style={{ fontSize: '14px', color: '#64748b' }}>For the Period: {periodLabel}</div>
                        </div>

                        {/* Header Row */}
                        <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '12px 0', borderBottom: '2px solid #1e293b', marginBottom: '16px', fontWeight: '600', color: '#1e293b' }}>
                          <div>Line Item</div>
                          <div style={{ textAlign: 'right' }}>Amount</div>
                          <div style={{ textAlign: 'right' }}>% of Revenue</div>
                        </div>

                        {/* Revenue */}
                        <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '8px 0', borderBottom: '1px solid #e2e8f0', fontWeight: '600' }}>
                          <div style={{ color: '#1e293b' }}>Revenue</div>
                          <div style={{ textAlign: 'right', color: '#1e293b' }}>${revenue.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                          <div style={{ textAlign: 'right', color: '#1e293b' }}>100.0%</div>
                        </div>

                        {/* COGS */}
                        <div style={{ marginTop: '16px' }}>
                          <div style={{ fontWeight: '600', color: '#475569', marginBottom: '8px', fontSize: '14px' }}>Cost of Goods Sold</div>
                          {cogsPayroll > 0 && (
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                              <div style={{ color: '#64748b' }}>COGS - Payroll</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>${cogsPayroll.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(cogsPayroll)}</div>
                            </div>
                          )}
                          {cogsOwnerPay > 0 && (
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                              <div style={{ color: '#64748b' }}>COGS - Owner Pay</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>${cogsOwnerPay.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(cogsOwnerPay)}</div>
                            </div>
                          )}
                          {cogsContractors > 0 && (
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                              <div style={{ color: '#64748b' }}>COGS - Contractors</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>${cogsContractors.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(cogsContractors)}</div>
                            </div>
                          )}
                          {cogsMaterials > 0 && (
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                              <div style={{ color: '#64748b' }}>COGS - Materials</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>${cogsMaterials.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(cogsMaterials)}</div>
                            </div>
                          )}
                          {cogsCommissions > 0 && (
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                              <div style={{ color: '#64748b' }}>COGS - Commissions</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>${cogsCommissions.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(cogsCommissions)}</div>
                            </div>
                          )}
                          {cogsOther > 0 && (
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                              <div style={{ color: '#64748b' }}>COGS - Other</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>${cogsOther.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(cogsOther)}</div>
                            </div>
                          )}
                          <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '8px 0', borderTop: '1px solid #cbd5e1', marginTop: '4px', fontWeight: '600' }}>
                            <div style={{ color: '#475569' }}>Total COGS</div>
                            <div style={{ textAlign: 'right', color: '#475569' }}>${cogs.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                            <div style={{ textAlign: 'right', color: '#475569' }}>{calcPercent(cogs)}</div>
                          </div>
                        </div>

                        {/* Gross Profit */}
                        <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '12px 8px', background: '#dbeafe', borderRadius: '6px', margin: '16px 0', fontWeight: '700', color: '#1e40af' }}>
                          <div>Gross Profit</div>
                          <div style={{ textAlign: 'right' }}>${grossProfit.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                          <div style={{ textAlign: 'right' }}>{calcPercent(grossProfit)}</div>
                        </div>

                        {/* Operating Expenses */}
                        <div style={{ marginTop: '16px' }}>
                          <div style={{ fontWeight: '600', color: '#475569', marginBottom: '8px', fontSize: '14px' }}>Operating Expenses</div>
                          {opexPayroll > 0 && (
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                              <div style={{ color: '#64748b' }}>Payroll</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>${opexPayroll.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(opexPayroll)}</div>
                            </div>
                          )}
                          {ownersBasePay > 0 && (
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                              <div style={{ color: '#64748b' }}>Owner's Base Pay</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>${ownersBasePay.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(ownersBasePay)}</div>
                            </div>
                          )}
                          {ownersRetirement > 0 && (
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                              <div style={{ color: '#64748b' }}>Owner's Retirement</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>${ownersRetirement.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(ownersRetirement)}</div>
                            </div>
                          )}
                          {professionalServices > 0 && (
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                              <div style={{ color: '#64748b' }}>Professional Services</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>${professionalServices.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(professionalServices)}</div>
                            </div>
                          )}
                          {rentLease > 0 && (
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                              <div style={{ color: '#64748b' }}>Rent/Lease</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>${rentLease.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(rentLease)}</div>
                            </div>
                          )}
                          {utilities > 0 && (
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                              <div style={{ color: '#64748b' }}>Utilities</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>${utilities.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(utilities)}</div>
                            </div>
                          )}
                          {equipment > 0 && (
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                              <div style={{ color: '#64748b' }}>Equipment</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>${equipment.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(equipment)}</div>
                            </div>
                          )}
                          {travel > 0 && (
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                              <div style={{ color: '#64748b' }}>Travel</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>${travel.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(travel)}</div>
                            </div>
                          )}
                          {insurance > 0 && (
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                              <div style={{ color: '#64748b' }}>Insurance</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>${insurance.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(insurance)}</div>
                            </div>
                          )}
                          {opexSalesMarketing > 0 && (
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                              <div style={{ color: '#64748b' }}>Sales & Marketing</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>${opexSalesMarketing.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(opexSalesMarketing)}</div>
                            </div>
                          )}
                          {contractorsDistribution > 0 && (
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                              <div style={{ color: '#64748b' }}>Contractors - Distribution</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>${contractorsDistribution.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(contractorsDistribution)}</div>
                            </div>
                          )}
                          {depreciationExpense > 0 && (
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                              <div style={{ color: '#64748b' }}>Depreciation & Amortization</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>${depreciationExpense.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(depreciationExpense)}</div>
                            </div>
                          )}
                          {opexOther > 0 && (
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                              <div style={{ color: '#64748b' }}>Other Operating Expenses</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>${opexOther.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(opexOther)}</div>
                            </div>
                          )}
                          <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '8px 0', borderTop: '1px solid #cbd5e1', marginTop: '4px', fontWeight: '600' }}>
                            <div style={{ color: '#475569' }}>Total Operating Expenses</div>
                            <div style={{ textAlign: 'right', color: '#475569' }}>${totalOpex.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                            <div style={{ textAlign: 'right', color: '#475569' }}>{calcPercent(totalOpex)}</div>
                          </div>
                        </div>

                        {/* Operating Income */}
                        <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '12px 8px', background: '#dbeafe', borderRadius: '6px', margin: '16px 0', fontWeight: '700', color: '#1e40af' }}>
                          <div>Operating Income</div>
                          <div style={{ textAlign: 'right' }}>${operatingIncome.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                          <div style={{ textAlign: 'right' }}>{calcPercent(operatingIncome)}</div>
                        </div>

                        {/* Other Income/Expense */}
                        {(interestExpense > 0 || nonOperatingIncome > 0 || extraordinaryItems !== 0) && (
                          <div style={{ marginTop: '16px' }}>
                            <div style={{ fontWeight: '600', color: '#475569', marginBottom: '8px', fontSize: '14px' }}>Other Income/(Expense)</div>
                            {interestExpense > 0 && (
                              <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                                <div style={{ color: '#64748b' }}>Interest Expense</div>
                                <div style={{ textAlign: 'right', color: '#64748b' }}>(${ interestExpense.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })})</div>
                                <div style={{ textAlign: 'right', color: '#64748b' }}>({calcPercent(interestExpense)})</div>
                              </div>
                            )}
                            {nonOperatingIncome > 0 && (
                              <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                                <div style={{ color: '#64748b' }}>Non-Operating Income</div>
                                <div style={{ textAlign: 'right', color: '#64748b' }}>${nonOperatingIncome.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                                <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(nonOperatingIncome)}</div>
                              </div>
                            )}
                            {extraordinaryItems !== 0 && (
                              <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                                <div style={{ color: '#64748b' }}>Extraordinary Items</div>
                                <div style={{ textAlign: 'right', color: '#64748b' }}>
                                  {extraordinaryItems >= 0 ? '$' : '($'}{Math.abs(extraordinaryItems).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}{extraordinaryItems < 0 ? ')' : ''}
                                </div>
                                <div style={{ textAlign: 'right', color: '#64748b' }}>
                                  {extraordinaryItems >= 0 ? calcPercent(extraordinaryItems) : `(${calcPercent(Math.abs(extraordinaryItems))})`}
                                </div>
                              </div>
                            )}
                          </div>
                        )}

                        {/* Net Income */}
                        <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '16px 8px', background: netIncome >= 0 ? '#dcfce7' : '#fee2e2', borderRadius: '6px', marginTop: '24px', fontWeight: '700', fontSize: '16px', color: netIncome >= 0 ? '#166534' : '#991b1b' }}>
                          <div>Net Income</div>
                          <div style={{ textAlign: 'right' }}>
                            {netIncome >= 0 ? '$' : '($'}{Math.abs(netIncome).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}{netIncome < 0 ? ')' : ''}
                          </div>
                          <div style={{ textAlign: 'right' }}>{calcPercent(netIncome)}</div>
                        </div>
                    </div>
                  );
                }
                
                // BALANCE SHEET - Latest point in time
                else if (statementType === 'balance-sheet') {
                  // Check if we're showing multiple periods side-by-side
                  if (displayPeriods.length > 1) {
                    // Multi-column comparative balance sheet
                    const calculateBalanceData = (months: any[]) => {
                      // For balance sheet, use the latest month's values (point-in-time)
                      const latest = months[months.length - 1];
                      const cash = latest.cash || 0;
                      const ar = latest.ar || 0;
                      const inventory = latest.inventory || 0;
                      const otherCA = latest.otherCA || 0;
                      const tca = cash + ar + inventory + otherCA;
                      
                      const fixedAssets = latest.fixedAssets || 0;
                      const intangibleAssets = latest.intangibleAssets || 0;
                      const otherNonCurrentAssets = latest.otherNonCurrentAssets || 0;
                      const nonCurrentAssets = fixedAssets + intangibleAssets + otherNonCurrentAssets;
                      const totalAssets = tca + nonCurrentAssets;
                      
                      const ap = latest.ap || 0;
                      const shortTermDebt = latest.shortTermDebt || 0;
                      const currentPortionLTD = latest.currentPortionLTD || 0;
                      const otherCurrentLiabilities = latest.otherCurrentLiabilities || 0;
                      const totalCurrentLiabilities = ap + shortTermDebt + currentPortionLTD + otherCurrentLiabilities;
                      
                      const ltd = latest.ltd || 0;
                      const otherLongTermLiabilities = latest.otherLongTermLiabilities || 0;
                      const totalLongTermLiabilities = ltd + otherLongTermLiabilities;
                      const totalLiabilities = totalCurrentLiabilities + totalLongTermLiabilities;
                      
                      const paidInCapital = latest.paidInCapital || 0;
                      const retainedEarnings = latest.retainedEarnings || 0;
                      const totalEquity = paidInCapital + retainedEarnings;
                      
                      return {
                        cash, ar, inventory, otherCA, tca,
                        fixedAssets, intangibleAssets, otherNonCurrentAssets, nonCurrentAssets, totalAssets,
                        ap, shortTermDebt, currentPortionLTD, otherCurrentLiabilities, totalCurrentLiabilities,
                        ltd, otherLongTermLiabilities, totalLongTermLiabilities, totalLiabilities,
                        paidInCapital, retainedEarnings, totalEquity
                      };
                    };
                    
                    const balanceData = displayPeriods.map(p => ({
                      label: p.label,
                      ...calculateBalanceData(p.months)
                    }));
                    
                    return (
                      <div style={{ background: 'white', borderRadius: '12px', padding: '32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', overflowX: 'auto' }}>
                        <div style={{ marginBottom: '32px', borderBottom: '2px solid #e2e8f0', paddingBottom: '16px' }}>
                          <h2 style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b', marginBottom: '4px' }}>Comparative Balance Sheet</h2>
                          <div style={{ fontSize: '14px', color: '#64748b' }}>{periodLabel} - {statementDisplay === 'monthly' ? 'Monthly' : statementDisplay === 'quarterly' ? 'Quarterly' : 'Annual'}</div>
                        </div>
                        
                        {/* Table with multiple columns */}
                        <div style={{ minWidth: `${200 + (balanceData.length * 110)}px` }}>
                          {/* Header Row */}
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '12px 0', borderBottom: '2px solid #1e293b', fontWeight: '600', color: '#1e293b', position: 'sticky', top: 0, background: 'white' }}>
                            <div>Line Item</div>
                            {balanceData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right' }}>{p.label}</div>
                            ))}
                          </div>
                          
                          {/* ASSETS Section Header */}
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '12px 0 4px 0', fontSize: '15px', fontWeight: '700', marginTop: '8px' }}>
                            <div style={{ color: '#1e293b' }}>ASSETS</div>
                            {balanceData.map((p, i) => <div key={i}></div>)}
                          </div>
                          
                          {/* Current Assets Header */}
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '8px 0 4px 0', fontSize: '14px', fontWeight: '600' }}>
                            <div style={{ color: '#475569' }}>Current Assets</div>
                            {balanceData.map((p, i) => <div key={i}></div>)}
                          </div>
                          
                          {/* Current Assets Details */}
                          {balanceData.some(p => p.cash > 0) && (
                            <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                              <div style={{ color: '#64748b', paddingLeft: '20px' }}>Cash & Cash Equivalents</div>
                              {balanceData.map((p, i) => (
                                <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.cash / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                              ))}
                            </div>
                          )}
                          {balanceData.some(p => p.ar > 0) && (
                            <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                              <div style={{ color: '#64748b', paddingLeft: '20px' }}>Accounts Receivable</div>
                              {balanceData.map((p, i) => (
                                <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.ar / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                              ))}
                            </div>
                          )}
                          {balanceData.some(p => p.inventory > 0) && (
                            <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                              <div style={{ color: '#64748b', paddingLeft: '20px' }}>Inventory</div>
                              {balanceData.map((p, i) => (
                                <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.inventory / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                              ))}
                            </div>
                          )}
                          {balanceData.some(p => p.otherCA > 0) && (
                            <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                              <div style={{ color: '#64748b', paddingLeft: '20px' }}>Other Current Assets</div>
                              {balanceData.map((p, i) => (
                                <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.otherCA / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                              ))}
                            </div>
                          )}
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '6px 0', fontSize: '14px', fontWeight: '600', borderTop: '1px solid #cbd5e1', marginTop: '4px' }}>
                            <div style={{ color: '#475569' }}>Total Current Assets</div>
                            {balanceData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right', color: '#475569' }}>${(p.tca / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                            ))}
                          </div>
                          
                          {/* Non-Current Assets Header */}
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '8px 0 4px 0', fontSize: '14px', fontWeight: '600', marginTop: '8px' }}>
                            <div style={{ color: '#475569' }}>Non-Current Assets</div>
                            {balanceData.map((p, i) => <div key={i}></div>)}
                          </div>
                          
                          {balanceData.some(p => p.fixedAssets > 0) && (
                            <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                              <div style={{ color: '#64748b', paddingLeft: '20px' }}>Property, Plant & Equipment</div>
                              {balanceData.map((p, i) => (
                                <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.fixedAssets / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                              ))}
                            </div>
                          )}
                          {balanceData.some(p => p.intangibleAssets > 0) && (
                            <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                              <div style={{ color: '#64748b', paddingLeft: '20px' }}>Intangible Assets</div>
                              {balanceData.map((p, i) => (
                                <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.intangibleAssets / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                              ))}
                            </div>
                          )}
                          {balanceData.some(p => p.otherNonCurrentAssets > 0) && (
                            <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                              <div style={{ color: '#64748b', paddingLeft: '20px' }}>Other Non-Current Assets</div>
                              {balanceData.map((p, i) => (
                                <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.otherNonCurrentAssets / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                              ))}
                            </div>
                          )}
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '6px 0', fontSize: '14px', fontWeight: '600', borderTop: '1px solid #cbd5e1', marginTop: '4px' }}>
                            <div style={{ color: '#475569' }}>Total Non-Current Assets</div>
                            {balanceData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right', color: '#475569' }}>${(p.nonCurrentAssets / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                            ))}
                          </div>
                          
                          {/* TOTAL ASSETS */}
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '10px 8px', background: '#dbeafe', borderRadius: '4px', marginTop: '8px', fontWeight: '700' }}>
                            <div style={{ color: '#1e40af' }}>TOTAL ASSETS</div>
                            {balanceData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right', color: '#1e40af' }}>${(p.totalAssets / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                            ))}
                          </div>
                          
                          {/* LIABILITIES Section Header */}
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '12px 0 4px 0', fontSize: '15px', fontWeight: '700', marginTop: '16px' }}>
                            <div style={{ color: '#1e293b' }}>LIABILITIES</div>
                            {balanceData.map((p, i) => <div key={i}></div>)}
                          </div>
                          
                          {/* Current Liabilities Header */}
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '8px 0 4px 0', fontSize: '14px', fontWeight: '600' }}>
                            <div style={{ color: '#475569' }}>Current Liabilities</div>
                            {balanceData.map((p, i) => <div key={i}></div>)}
                          </div>
                          
                          {balanceData.some(p => p.ap > 0) && (
                            <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                              <div style={{ color: '#64748b', paddingLeft: '20px' }}>Accounts Payable</div>
                              {balanceData.map((p, i) => (
                                <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.ap / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                              ))}
                            </div>
                          )}
                          {balanceData.some(p => p.shortTermDebt > 0) && (
                            <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                              <div style={{ color: '#64748b', paddingLeft: '20px' }}>Short-Term Debt</div>
                              {balanceData.map((p, i) => (
                                <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.shortTermDebt / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                              ))}
                            </div>
                          )}
                          {balanceData.some(p => p.currentPortionLTD > 0) && (
                            <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                              <div style={{ color: '#64748b', paddingLeft: '20px' }}>Current Portion of LT Debt</div>
                              {balanceData.map((p, i) => (
                                <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.currentPortionLTD / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                              ))}
                            </div>
                          )}
                          {balanceData.some(p => p.otherCurrentLiabilities > 0) && (
                            <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                              <div style={{ color: '#64748b', paddingLeft: '20px' }}>Other Current Liabilities</div>
                              {balanceData.map((p, i) => (
                                <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.otherCurrentLiabilities / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                              ))}
                            </div>
                          )}
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '6px 0', fontSize: '14px', fontWeight: '600', borderTop: '1px solid #cbd5e1', marginTop: '4px' }}>
                            <div style={{ color: '#475569' }}>Total Current Liabilities</div>
                            {balanceData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right', color: '#475569' }}>${(p.totalCurrentLiabilities / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                            ))}
                          </div>
                          
                          {/* Long-Term Liabilities Header */}
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '8px 0 4px 0', fontSize: '14px', fontWeight: '600', marginTop: '8px' }}>
                            <div style={{ color: '#475569' }}>Long-Term Liabilities</div>
                            {balanceData.map((p, i) => <div key={i}></div>)}
                          </div>
                          
                          {balanceData.some(p => p.ltd > 0) && (
                            <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                              <div style={{ color: '#64748b', paddingLeft: '20px' }}>Long-Term Debt</div>
                              {balanceData.map((p, i) => (
                                <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.ltd / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                              ))}
                            </div>
                          )}
                          {balanceData.some(p => p.otherLongTermLiabilities > 0) && (
                            <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                              <div style={{ color: '#64748b', paddingLeft: '20px' }}>Other Long-Term Liabilities</div>
                              {balanceData.map((p, i) => (
                                <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.otherLongTermLiabilities / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                              ))}
                            </div>
                          )}
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '6px 0', fontSize: '14px', fontWeight: '600', borderTop: '1px solid #cbd5e1', marginTop: '4px' }}>
                            <div style={{ color: '#475569' }}>Total Long-Term Liabilities</div>
                            {balanceData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right', color: '#475569' }}>${(p.totalLongTermLiabilities / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                            ))}
                          </div>
                          
                          {/* TOTAL LIABILITIES */}
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '10px 8px', background: '#fef3c7', borderRadius: '4px', marginTop: '8px', fontWeight: '700' }}>
                            <div style={{ color: '#92400e' }}>TOTAL LIABILITIES</div>
                            {balanceData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right', color: '#92400e' }}>${(p.totalLiabilities / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                            ))}
                          </div>
                          
                          {/* EQUITY Section Header */}
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '12px 0 4px 0', fontSize: '15px', fontWeight: '700', marginTop: '16px' }}>
                            <div style={{ color: '#1e293b' }}>EQUITY</div>
                            {balanceData.map((p, i) => <div key={i}></div>)}
                          </div>
                          
                          {balanceData.some(p => p.paidInCapital > 0) && (
                            <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                              <div style={{ color: '#64748b', paddingLeft: '20px' }}>Paid-in Capital</div>
                              {balanceData.map((p, i) => (
                                <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.paidInCapital / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                              ))}
                            </div>
                          )}
                          {balanceData.some(p => p.retainedEarnings !== 0) && (
                            <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                              <div style={{ color: '#64748b', paddingLeft: '20px' }}>Retained Earnings</div>
                              {balanceData.map((p, i) => (
                                <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>
                                  {p.retainedEarnings >= 0 ? '$' : '($'}{(Math.abs(p.retainedEarnings) / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K{p.retainedEarnings < 0 ? ')' : ''}
                                </div>
                              ))}
                            </div>
                          )}
                          
                          {/* TOTAL EQUITY */}
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '10px 8px', background: '#dcfce7', borderRadius: '4px', marginTop: '8px', fontWeight: '700' }}>
                            <div style={{ color: '#166534' }}>TOTAL EQUITY</div>
                            {balanceData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right', color: p.totalEquity >= 0 ? '#166534' : '#991b1b' }}>
                                {p.totalEquity >= 0 ? '$' : '($'}{(Math.abs(p.totalEquity) / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K{p.totalEquity < 0 ? ')' : ''}
                              </div>
                            ))}
                          </div>
                        </div>
                      </div>
                    );
                  }
                  
                  // Single period balance sheet (original logic)
                  const cash = latestMonth.cash || 0;
                  const ar = latestMonth.ar || 0;
                  const inventory = latestMonth.inventory || 0;
                  const otherCA = latestMonth.otherCA || 0;
                  const tca = cash + ar + inventory + otherCA;
                  
                  const fixedAssets = latestMonth.fixedAssets || 0;
                  const intangibleAssets = latestMonth.intangibleAssets || 0;
                  const otherNonCurrentAssets = latestMonth.otherNonCurrentAssets || 0;
                  const nonCurrentAssets = fixedAssets + intangibleAssets + otherNonCurrentAssets;
                  
                  const totalAssets = tca + nonCurrentAssets;
                  
                  const ap = latestMonth.ap || 0;
                  const shortTermDebt = latestMonth.shortTermDebt || 0;
                  const currentPortionLTD = latestMonth.currentPortionLTD || 0;
                  const otherCurrentLiabilities = latestMonth.otherCurrentLiabilities || 0;
                  const totalCurrentLiabilities = ap + shortTermDebt + currentPortionLTD + otherCurrentLiabilities;
                  
                  const ltd = latestMonth.ltd || 0;
                  const otherLongTermLiabilities = latestMonth.otherLongTermLiabilities || 0;
                  const totalLongTermLiabilities = ltd + otherLongTermLiabilities;
                  
                  const totalLiabilities = totalCurrentLiabilities + totalLongTermLiabilities;
                  
                  const paidInCapital = latestMonth.paidInCapital || 0;
                  const retainedEarnings = latestMonth.retainedEarnings || 0;
                  const totalEquity = paidInCapital + retainedEarnings;
                  
                  const totalLAndE = totalLiabilities + totalEquity;
                  
                  const latestDate = new Date(latestMonth.date || latestMonth.month);
                  const asOfDate = latestDate.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });
                  
                  return (
                    <div style={{ background: 'white', borderRadius: '12px', padding: '32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                      <div style={{ marginBottom: '32px', borderBottom: '2px solid #e2e8f0', paddingBottom: '16px' }}>
                        <h2 style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b', marginBottom: '4px' }}>Balance Sheet</h2>
                        <div style={{ fontSize: '14px', color: '#64748b' }}>As of {asOfDate} (Period: {periodLabel})</div>
                      </div>

                      {/* ASSETS */}
                      <div style={{ marginBottom: '32px' }}>
                        <div style={{ fontWeight: '700', fontSize: '18px', color: '#1e293b', marginBottom: '12px' }}>ASSETS</div>
                        
                        {/* Current Assets */}
                        <div style={{ marginBottom: '16px' }}>
                          <div style={{ fontWeight: '600', color: '#475569', marginBottom: '8px' }}>Current Assets</div>
                          {cash > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#64748b' }}>Cash & Cash Equivalents</span>
                              <span style={{ color: '#64748b' }}>${cash.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {ar > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#64748b' }}>Accounts Receivable</span>
                              <span style={{ color: '#64748b' }}>${ar.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {inventory > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#64748b' }}>Inventory</span>
                              <span style={{ color: '#64748b' }}>${inventory.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {otherCA > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#64748b' }}>Other Current Assets</span>
                              <span style={{ color: '#64748b' }}>${otherCA.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0 8px 10px', borderTop: '1px solid #cbd5e1', marginTop: '4px', fontWeight: '600' }}>
                            <span style={{ color: '#475569' }}>Total Current Assets</span>
                            <span style={{ color: '#475569' }}>${tca.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        </div>

                        {/* Non-Current Assets */}
                        <div style={{ marginBottom: '16px' }}>
                          <div style={{ fontWeight: '600', color: '#475569', marginBottom: '8px' }}>Non-Current Assets</div>
                          {fixedAssets > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#64748b' }}>Property, Plant & Equipment</span>
                              <span style={{ color: '#64748b' }}>${fixedAssets.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {intangibleAssets > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#64748b' }}>Intangible Assets</span>
                              <span style={{ color: '#64748b' }}>${intangibleAssets.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {otherNonCurrentAssets > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#64748b' }}>Other Non-Current Assets</span>
                              <span style={{ color: '#64748b' }}>${otherNonCurrentAssets.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0 8px 10px', borderTop: '1px solid #cbd5e1', marginTop: '4px', fontWeight: '600' }}>
                            <span style={{ color: '#475569' }}>Total Non-Current Assets</span>
                            <span style={{ color: '#475569' }}>${nonCurrentAssets.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        </div>

                        {/* TOTAL ASSETS */}
                        <div style={{ background: '#dbeafe', padding: '12px', borderRadius: '8px' }}>
                          <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                            <span style={{ fontWeight: '700', fontSize: '16px', color: '#1e40af' }}>TOTAL ASSETS</span>
                            <span style={{ fontWeight: '700', fontSize: '16px', color: '#1e40af' }}>
                              ${totalAssets.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                            </span>
                          </div>
                        </div>
                      </div>

                      {/* LIABILITIES */}
                      <div style={{ marginBottom: '32px' }}>
                        <div style={{ fontWeight: '700', fontSize: '18px', color: '#1e293b', marginBottom: '12px' }}>LIABILITIES</div>
                        
                        {/* Current Liabilities */}
                        <div style={{ marginBottom: '16px' }}>
                          <div style={{ fontWeight: '600', color: '#475569', marginBottom: '8px' }}>Current Liabilities</div>
                          {ap > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#64748b' }}>Accounts Payable</span>
                              <span style={{ color: '#64748b' }}>${ap.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {shortTermDebt > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#64748b' }}>Short-Term Debt</span>
                              <span style={{ color: '#64748b' }}>${shortTermDebt.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {currentPortionLTD > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#64748b' }}>Current Portion of LT Debt</span>
                              <span style={{ color: '#64748b' }}>${currentPortionLTD.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {otherCurrentLiabilities > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#64748b' }}>Other Current Liabilities</span>
                              <span style={{ color: '#64748b' }}>${otherCurrentLiabilities.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0 8px 10px', borderTop: '1px solid #cbd5e1', marginTop: '4px', fontWeight: '600' }}>
                            <span style={{ color: '#475569' }}>Total Current Liabilities</span>
                            <span style={{ color: '#475569' }}>${totalCurrentLiabilities.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        </div>

                        {/* Long-Term Liabilities */}
                        <div style={{ marginBottom: '16px' }}>
                          <div style={{ fontWeight: '600', color: '#475569', marginBottom: '8px' }}>Long-Term Liabilities</div>
                          {ltd > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#64748b' }}>Long-Term Debt</span>
                              <span style={{ color: '#64748b' }}>${ltd.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          {otherLongTermLiabilities > 0 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                              <span style={{ color: '#64748b' }}>Other Long-Term Liabilities</span>
                              <span style={{ color: '#64748b' }}>${otherLongTermLiabilities.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                            </div>
                          )}
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0 8px 10px', borderTop: '1px solid #cbd5e1', marginTop: '4px', fontWeight: '600' }}>
                            <span style={{ color: '#475569' }}>Total Long-Term Liabilities</span>
                            <span style={{ color: '#475569' }}>${totalLongTermLiabilities.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        </div>

                        {/* TOTAL LIABILITIES */}
                        <div style={{ background: '#fef3c7', padding: '12px', borderRadius: '8px' }}>
                          <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                            <span style={{ fontWeight: '700', fontSize: '16px', color: '#92400e' }}>TOTAL LIABILITIES</span>
                            <span style={{ fontWeight: '700', fontSize: '16px', color: '#92400e' }}>
                              ${totalLiabilities.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                            </span>
                          </div>
                        </div>
                      </div>

                      {/* EQUITY */}
                      <div style={{ marginBottom: '32px' }}>
                        <div style={{ fontWeight: '700', fontSize: '18px', color: '#1e293b', marginBottom: '12px' }}>EQUITY</div>
                        {paidInCapital > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#64748b' }}>Paid-in Capital</span>
                            <span style={{ color: '#64748b' }}>${paidInCapital.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {retainedEarnings !== 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#64748b' }}>Retained Earnings</span>
                            <span style={{ color: '#64748b' }}>
                              {retainedEarnings >= 0 ? '$' : '($'}{Math.abs(retainedEarnings).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}{retainedEarnings < 0 ? ')' : ''}
                            </span>
                          </div>
                        )}

                        {/* TOTAL EQUITY */}
                        <div style={{ background: '#dcfce7', padding: '12px', borderRadius: '8px', marginTop: '8px' }}>
                          <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                            <span style={{ fontWeight: '700', fontSize: '16px', color: '#166534' }}>TOTAL EQUITY</span>
                            <span style={{ fontWeight: '700', fontSize: '16px', color: '#166534' }}>
                              {totalEquity >= 0 ? '$' : '($'}{Math.abs(totalEquity).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}{totalEquity < 0 ? ')' : ''}
                            </span>
                          </div>
                        </div>
                      </div>

                      {/* TOTAL LIABILITIES & EQUITY */}
                      <div style={{ background: '#f1f5f9', padding: '16px', borderRadius: '8px', marginTop: '32px' }}>
                        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '4px' }}>
                          <span style={{ fontWeight: '700', fontSize: '18px', color: '#1e293b' }}>TOTAL LIABILITIES & EQUITY</span>
                          <span style={{ fontWeight: '700', fontSize: '18px', color: '#1e293b' }}>
                            ${totalLAndE.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                          </span>
                        </div>
                        {Math.abs(totalAssets - totalLAndE) > 0.01 && (
                          <div style={{ fontSize: '12px', color: '#ef4444', marginTop: '8px', textAlign: 'right' }}>
                            ⚠️ Balance check: Assets - (Liabilities + Equity) = ${(totalAssets - totalLAndE).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                          </div>
                        )}
                      </div>
                    </div>
                  );
                }
              }
              
              else {
                return (
                  <div style={{ background: 'white', borderRadius: '12px', padding: '48px 32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', minHeight: '400px', textAlign: 'center' }}>
                    <div style={{ fontSize: '18px', fontWeight: '600', color: '#64748b', marginBottom: '12px' }}>
                      📊 Financial Statement Viewer
                    </div>
                    <p style={{ fontSize: '14px', color: '#94a3b8', maxWidth: '600px', margin: '0 auto' }}>
                      {monthly.length === 0 
                        ? 'No financial data available. Please import financial data or sync from QuickBooks.'
                        : 'Select options above to view financial statements.'}
                    </p>
                  </div>
                );
              }
            })()}

            {/* Hidden: Old P&L and Balance Sheet containers - will be removed in future update */}
            <div style={{ display: 'none' }}>
            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '24px' }}>
              {/* Left: QuickBooks Raw Data */}
              <div style={{ background: 'white', borderRadius: '12px', padding: '32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
              {/* Profit & Loss Report */}
              <div style={{ marginBottom: '48px' }}>
                <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '20px', paddingBottom: '12px', borderBottom: '3px solid #667eea' }}>Profit & Loss</h2>
                {plRows.length > 0 ? (
                  <div>
                    {plRows.map((row, idx) => (
                      <div 
                        key={idx} 
                        style={{ 
                          display: 'flex', 
                          justifyContent: 'space-between', 
                          padding: row.isHeader ? '12px 8px 8px' : (row.isTotal ? '10px 8px' : '6px 8px'),
                          paddingLeft: `${8 + (row.level * 20)}px`,
                          borderBottom: row.isTotal ? '2px solid #e2e8f0' : (row.isHeader ? '1px solid #e2e8f0' : 'none'),
                          background: row.isHeader ? '#f8fafc' : (row.isTotal ? '#f1f5f9' : 'transparent'),
                          fontWeight: row.isHeader || row.isTotal ? '600' : '400',
                          fontSize: row.isHeader ? '15px' : (row.isTotal ? '14px' : '13px'),
                          color: row.isHeader ? '#1e293b' : (row.isTotal ? '#0f172a' : '#475569')
                        }}
                      >
                        <span>{row.name}</span>
                        {!row.isHeader && <span style={{ fontFamily: 'monospace', whiteSpace: 'nowrap' }}>{row.value}</span>}
                      </div>
                    ))}
                  </div>
                ) : (
                  <div style={{ padding: '32px', textAlign: 'center', color: '#64748b' }}>No Profit & Loss data available</div>
                )}
              </div>

              {/* Balance Sheet Report */}
              <div>
                <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '20px', paddingBottom: '12px', borderBottom: '3px solid #667eea' }}>Balance Sheet</h2>
                {bsRows.length > 0 ? (
                  <div>
                    {bsRows.map((row, idx) => (
                      <div 
                        key={idx} 
                        style={{ 
                          display: 'flex', 
                          justifyContent: 'space-between', 
                          padding: row.isHeader ? '12px 8px 8px' : (row.isTotal ? '10px 8px' : '6px 8px'),
                          paddingLeft: `${8 + (row.level * 20)}px`,
                          borderBottom: row.isTotal ? '2px solid #e2e8f0' : (row.isHeader ? '1px solid #e2e8f0' : 'none'),
                          background: row.isHeader ? '#f8fafc' : (row.isTotal ? '#f1f5f9' : 'transparent'),
                          fontWeight: row.isHeader || row.isTotal ? '600' : '400',
                          fontSize: row.isHeader ? '15px' : (row.isTotal ? '14px' : '13px'),
                          color: row.isHeader ? '#1e293b' : (row.isTotal ? '#0f172a' : '#475569')
                        }}
                      >
                        <span>{row.name}</span>
                        {!row.isHeader && <span style={{ fontFamily: 'monospace', whiteSpace: 'nowrap' }}>{row.value}</span>}
                      </div>
                    ))}
                  </div>
                ) : (
                  <div style={{ padding: '32px', textAlign: 'center', color: '#64748b' }}>No Balance Sheet data available</div>
                )}
              </div>
              </div>

              {/* Right: Your Minimal Viable Financial Statement Structure */}
              <div style={{ background: 'white', borderRadius: '12px', padding: '32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                {/* Income Statement Structure */}
                <div style={{ marginBottom: '48px' }}>
                  <div style={{ marginBottom: '20px' }}>
                    <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '8px', paddingBottom: '12px', borderBottom: '3px solid #10b981' }}>Income Statement Fields</h2>
                    {qbRawData?.profitAndLoss?.Header && (() => {
                      const columns = qbRawData.profitAndLoss.Columns?.Column || [];
                      const hasMultipleMonths = columns.length > 2;
                      const lastMonthColumn = hasMultipleMonths && columns.length >= 2 ? columns[columns.length - 2] : null;
                      const monthLabel = lastMonthColumn?.ColTitle || qbRawData.profitAndLoss.Header.EndPeriod;
                      
                      return (
                        <div style={{ fontSize: '13px', marginTop: '8px' }}>
                          <div style={{ color: '#64748b' }}>
                            <strong>Report Period:</strong> {qbRawData.profitAndLoss.Header.StartPeriod || 'N/A'} to {qbRawData.profitAndLoss.Header.EndPeriod || 'N/A'}
                          </div>
                          <div style={{ color: '#10b981', fontWeight: '600', marginTop: '4px', padding: '8px', background: '#f0fdf4', borderRadius: '6px', border: '1px solid #86efac' }}>
                            📅 Displaying: {hasMultipleMonths ? `Monthly data for ${monthLabel}` : `Period total for ${monthLabel}`}
                          </div>
                          {!hasMultipleMonths && (
                            <div style={{ color: '#f59e0b', fontWeight: '500', fontSize: '12px', marginTop: '4px', padding: '6px', background: '#fffbeb', borderRadius: '6px', border: '1px solid #fcd34d' }}>
                              ⚠️ Note: This appears to be cumulative for the entire period, not monthly breakdowns
                            </div>
                          )}
                        </div>
                      );
                    })()}
                  </div>
                  
                  {aiMappings.length > 0 ? (
                    <div style={{ fontSize: '13px' }}>
                      {/* Group mappings by category */}
                      {(() => {
                        // Deduplicate mappings by QB account name (keep first occurrence)
                        const uniqueMappings = aiMappings.filter((m, index, self) =>
                          index === self.findIndex((t) => t.qbAccount === m.qbAccount)
                        );
                        
                        const revenueMappings = uniqueMappings.filter(m => ['Revenue', 'Income'].some(c => m.qbAccountClassification?.includes(c)));
                        const cogsMappings = uniqueMappings.filter(m => ['Cost of Goods Sold', 'COGS'].some(c => m.qbAccountClassification?.includes(c)));
                        const expenseMappings = uniqueMappings.filter(m => m.qbAccountClassification?.includes('Expense'));
                        
                        // Helper to get amount - extract from the appropriate column
                        const getAmount = (qbAccountName: string) => {
                          if (!qbRawData) return 0;
                          const extractRows = (reportData: any) => {
                            const result: any[] = [];
                            if (!reportData || !reportData.Rows || !reportData.Rows.Row) return result;
                            
                            const processRow = (row: any) => {
                              if (row.type === 'Data' && row.ColData) {
                                const name = row.ColData[0]?.value || '';
                                if (name) {
                                  // Try to find a numeric value from the columns
                                  // Start from the end and work backwards to find the first valid number
                                  let value = 0;
                                  for (let i = row.ColData.length - 1; i >= 1; i--) {
                                    const colValue = row.ColData[i]?.value;
                                    if (colValue !== undefined && colValue !== '' && !isNaN(parseFloat(colValue))) {
                                      value = parseFloat(colValue);
                                      break;
                                    }
                                  }
                                  result.push({ name, value });
                                }
                              }
                              if (row.Rows && row.Rows.Row) {
                                const subRows = Array.isArray(row.Rows.Row) ? row.Rows.Row : [row.Rows.Row];
                                subRows.forEach((r: any) => processRow(r));
                              }
                            };
                            const rows = Array.isArray(reportData.Rows.Row) ? reportData.Rows.Row : [reportData.Rows.Row];
                            rows.forEach((r: any) => processRow(r));
                            return result;
                          };
                          const plRows = extractRows(qbRawData.profitAndLoss);
                          const accountRow = plRows.find((row: any) => row.name === qbAccountName);
                          return accountRow ? accountRow.value : 0;
                        };
                        
                        // Calculate totals
                        const totalRevenue = revenueMappings.reduce((sum, m) => sum + getAmount(m.qbAccount), 0);
                        const totalCOGS = cogsMappings.reduce((sum, m) => sum + getAmount(m.qbAccount), 0);
                        const totalExpenses = expenseMappings.reduce((sum, m) => sum + getAmount(m.qbAccount), 0);
                        const grossProfit = totalRevenue - totalCOGS;
                        const netIncome = grossProfit - totalExpenses;
                        
                        return (
                          <>
                            {/* REVENUE SECTION */}
                            {revenueMappings.length > 0 && (
                              <>
                                <div style={{ padding: '8px', background: '#f8fafc', fontWeight: '600', borderBottom: '1px solid #e2e8f0' }}>REVENUE</div>
                                {revenueMappings.map((m, i) => {
                                  const amount = getAmount(m.qbAccount);
                                  return (
                                    <div key={i} style={{ padding: '6px 16px 6px 32px', borderBottom: '1px solid #f1f5f9', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                      <div>
                                        <div style={{ color: '#475569', fontSize: '13px' }}>{m.qbAccount}</div>
                                        <div style={{ color: '#94a3b8', fontSize: '11px' }}>→ {m.targetField}</div>
                                      </div>
                                      <span style={{ color: '#0f172a', fontFamily: 'monospace', fontWeight: '600' }}>
                                        ${amount.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                                      </span>
                                    </div>
                                  );
                                })}
                              </>
                            )}
                            
                            {/* COGS SECTION */}
                            {cogsMappings.length > 0 && (
                              <>
                                <div style={{ padding: '8px', background: '#f8fafc', fontWeight: '600', borderBottom: '1px solid #e2e8f0', marginTop: '12px' }}>COST OF GOODS SOLD</div>
                                {cogsMappings.map((m, i) => {
                                  const amount = getAmount(m.qbAccount);
                                  return (
                                    <div key={i} style={{ padding: '6px 16px 6px 32px', borderBottom: '1px solid #f1f5f9', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                      <div>
                                        <div style={{ color: '#475569', fontSize: '13px' }}>{m.qbAccount}</div>
                                        <div style={{ color: '#94a3b8', fontSize: '11px' }}>→ {m.targetField}</div>
                                      </div>
                                      <span style={{ color: '#0f172a', fontFamily: 'monospace', fontWeight: '600' }}>
                                        ${amount.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                                      </span>
                                    </div>
                                  );
                                })}
                                <div style={{ padding: '10px 16px', background: '#fee2e2', borderBottom: '2px solid #ef4444', display: 'flex', justifyContent: 'space-between', fontWeight: '700' }}>
                                  <span style={{ color: '#991b1b' }}>Total COGS</span>
                                  <span style={{ color: '#991b1b', fontFamily: 'monospace' }}>
                                    ${totalCOGS.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                                  </span>
                                </div>
                                <div style={{ padding: '10px 16px', background: '#dbeafe', borderBottom: '3px solid #3b82f6', display: 'flex', justifyContent: 'space-between', fontWeight: '700', marginTop: '4px' }}>
                                  <span style={{ color: '#1e40af' }}>GROSS PROFIT</span>
                                  <span style={{ color: '#1e40af', fontFamily: 'monospace' }}>
                                    ${grossProfit.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                                  </span>
                                </div>
                              </>
                            )}
                            
                            {/* EXPENSES SECTION */}
                            {expenseMappings.length > 0 && (
                              <>
                                <div style={{ padding: '8px', background: '#f8fafc', fontWeight: '600', borderBottom: '1px solid #e2e8f0', marginTop: '12px' }}>OPERATING EXPENSES</div>
                                {expenseMappings.map((m, i) => {
                                  const amount = getAmount(m.qbAccount);
                                  return (
                                    <div key={i} style={{ padding: '6px 16px 6px 32px', borderBottom: '1px solid #f1f5f9', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                      <div>
                                        <div style={{ color: '#475569', fontSize: '13px' }}>{m.qbAccount}</div>
                                        <div style={{ color: '#94a3b8', fontSize: '11px' }}>→ {m.targetField}</div>
                                      </div>
                                      <span style={{ color: '#0f172a', fontFamily: 'monospace', fontWeight: '600' }}>
                                        ${amount.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                                      </span>
                                    </div>
                                  );
                                })}
                                <div style={{ padding: '10px 16px', background: '#fef3c7', borderBottom: '2px solid #f59e0b', display: 'flex', justifyContent: 'space-between', fontWeight: '700' }}>
                                  <span style={{ color: '#92400e' }}>Total Operating Expenses</span>
                                  <span style={{ color: '#92400e', fontFamily: 'monospace' }}>
                                    ${totalExpenses.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                                  </span>
                                </div>
                                <div style={{ padding: '12px 16px', background: '#dcfce7', borderBottom: '4px solid #10b981', display: 'flex', justifyContent: 'space-between', fontWeight: '700', marginTop: '4px' }}>
                                  <span style={{ color: '#166534', fontSize: '16px' }}>NET INCOME</span>
                                  <span style={{ color: '#166534', fontFamily: 'monospace', fontSize: '16px' }}>
                                    ${netIncome.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                                  </span>
                                </div>
                              </>
                            )}
                          </>
                        );
                      })()}
                    </div>
                  ) : (
                    <div style={{ padding: '20px', textAlign: 'center', color: '#94a3b8', fontSize: '14px' }}>
                      No mappings saved yet. Generate and save mappings above to see them here.
                    </div>
                  )}
                </div>

                {/* Balance Sheet Structure */}
                <div>
                  <div style={{ marginBottom: '20px' }}>
                    <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '8px', paddingBottom: '12px', borderBottom: '3px solid #10b981' }}>Balance Sheet Fields</h2>
                    {qbRawData?.balanceSheet?.Header && (
                      <div style={{ fontSize: '13px', marginTop: '8px' }}>
                        <div style={{ color: '#64748b' }}>
                          As of: {qbRawData.balanceSheet.Header.Time || qbRawData.balanceSheet.Header.EndPeriod || 'N/A'}
                        </div>
                        <div style={{ color: '#3b82f6', fontWeight: '500', fontSize: '12px', marginTop: '4px' }}>
                          📊 Balance Sheet shows point-in-time snapshot as of the date above
                        </div>
                      </div>
                    )}
                  </div>
                  
                  {aiMappings.length > 0 ? (
                    <div style={{ fontSize: '13px' }}>
                      {/* Group mappings by category */}
                      {(() => {
                        // Deduplicate mappings by QB account name (keep first occurrence)
                        const uniqueMappings = aiMappings.filter((m, index, self) =>
                          index === self.findIndex((t) => t.qbAccount === m.qbAccount)
                        );
                        
                        const assetMappings = uniqueMappings.filter(m => m.qbAccountClassification?.includes('Asset'));
                        const currentAssetMappings = assetMappings.filter(m => m.qbAccountClassification?.includes('Current'));
                        const fixedAssetMappings = assetMappings.filter(m => m.qbAccountClassification?.includes('Fixed') || m.qbAccountClassification?.includes('Property'));
                        const otherAssetMappings = assetMappings.filter(m => !m.qbAccountClassification?.includes('Current') && !m.qbAccountClassification?.includes('Fixed') && !m.qbAccountClassification?.includes('Property'));
                        
                        const liabilityMappings = uniqueMappings.filter(m => m.qbAccountClassification?.includes('Liability'));
                        const currentLiabMappings = liabilityMappings.filter(m => m.qbAccountClassification?.includes('Current'));
                        const longTermLiabMappings = liabilityMappings.filter(m => m.qbAccountClassification?.includes('Long') || !m.qbAccountClassification?.includes('Current'));
                        
                        const equityMappings = uniqueMappings.filter(m => m.qbAccountClassification?.includes('Equity'));
                        
                        // Helper to get amount from balance sheet - extract from the appropriate column
                        const getBSAmount = (qbAccountName: string) => {
                          if (!qbRawData) return 0;
                          const extractRows = (reportData: any) => {
                            const result: any[] = [];
                            if (!reportData || !reportData.Rows || !reportData.Rows.Row) return result;
                            
                            const processRow = (row: any) => {
                              if (row.type === 'Data' && row.ColData) {
                                const name = row.ColData[0]?.value || '';
                                if (name) {
                                  // Try to find a numeric value from the columns
                                  // Start from the end and work backwards to find the first valid number
                                  let value = 0;
                                  for (let i = row.ColData.length - 1; i >= 1; i--) {
                                    const colValue = row.ColData[i]?.value;
                                    if (colValue !== undefined && colValue !== '' && !isNaN(parseFloat(colValue))) {
                                      value = parseFloat(colValue);
                                      break;
                                    }
                                  }
                                  result.push({ name, value });
                                }
                              }
                              if (row.Rows && row.Rows.Row) {
                                const subRows = Array.isArray(row.Rows.Row) ? row.Rows.Row : [row.Rows.Row];
                                subRows.forEach((r: any) => processRow(r));
                              }
                            };
                            const rows = Array.isArray(reportData.Rows.Row) ? reportData.Rows.Row : [reportData.Rows.Row];
                            rows.forEach((r: any) => processRow(r));
                            return result;
                          };
                          const bsRows = extractRows(qbRawData.balanceSheet);
                          const accountRow = bsRows.find((row: any) => row.name === qbAccountName);
                          return accountRow ? accountRow.value : 0;
                        };
                        
                        // Calculate totals
                        const totalCurrentAssets = currentAssetMappings.reduce((sum, m) => sum + getBSAmount(m.qbAccount), 0);
                        const totalFixedAssets = fixedAssetMappings.reduce((sum, m) => sum + getBSAmount(m.qbAccount), 0);
                        const totalOtherAssets = otherAssetMappings.reduce((sum, m) => sum + getBSAmount(m.qbAccount), 0);
                        const totalAssets = totalCurrentAssets + totalFixedAssets + totalOtherAssets;
                        
                        const totalCurrentLiab = currentLiabMappings.reduce((sum, m) => sum + getBSAmount(m.qbAccount), 0);
                        const totalLongTermLiab = longTermLiabMappings.reduce((sum, m) => sum + getBSAmount(m.qbAccount), 0);
                        const totalLiabilities = totalCurrentLiab + totalLongTermLiab;
                        
                        const totalEquity = equityMappings.reduce((sum, m) => sum + getBSAmount(m.qbAccount), 0);
                        const totalLiabAndEquity = totalLiabilities + totalEquity;
                        
                        return (
                          <>
                            {/* ASSETS SECTION */}
                            <div style={{ padding: '8px', background: '#1e40af', fontWeight: '700', borderBottom: '2px solid #1e3a8a', color: 'white' }}>ASSETS</div>
                            
                            {currentAssetMappings.length > 0 && (
                              <>
                                <div style={{ padding: '6px 16px', background: '#eff6ff', fontWeight: '600', borderBottom: '1px solid #dbeafe', color: '#1e40af' }}>Current Assets</div>
                                {currentAssetMappings.map((m, i) => {
                                  const amount = getBSAmount(m.qbAccount);
                                  return (
                                    <div key={i} style={{ padding: '6px 16px 6px 32px', borderBottom: '1px solid #f1f5f9', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                      <div>
                                        <div style={{ color: '#475569', fontSize: '13px' }}>{m.qbAccount}</div>
                                        <div style={{ color: '#94a3b8', fontSize: '11px' }}>→ {m.targetField}</div>
                                      </div>
                                      <span style={{ color: '#0f172a', fontFamily: 'monospace', fontWeight: '600' }}>
                                        ${amount.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                                      </span>
                                    </div>
                                  );
                                })}
                              </>
                            )}
                            
                            {fixedAssetMappings.length > 0 && (
                              <>
                                <div style={{ padding: '6px 16px', background: '#eff6ff', fontWeight: '600', borderBottom: '1px solid #dbeafe', color: '#1e40af', marginTop: '8px' }}>Fixed Assets</div>
                                {fixedAssetMappings.map((m, i) => {
                                  const amount = getBSAmount(m.qbAccount);
                                  return (
                                    <div key={i} style={{ padding: '6px 16px 6px 32px', borderBottom: '1px solid #f1f5f9', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                      <div>
                                        <div style={{ color: '#475569', fontSize: '13px' }}>{m.qbAccount}</div>
                                        <div style={{ color: '#94a3b8', fontSize: '11px' }}>→ {m.targetField}</div>
                                      </div>
                                      <span style={{ color: '#0f172a', fontFamily: 'monospace', fontWeight: '600' }}>
                                        ${amount.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                                      </span>
                                    </div>
                                  );
                                })}
                              </>
                            )}
                            
                            {otherAssetMappings.length > 0 && (
                              <>
                                <div style={{ padding: '6px 16px', background: '#eff6ff', fontWeight: '600', borderBottom: '1px solid #dbeafe', color: '#1e40af', marginTop: '8px' }}>Other Assets</div>
                                {otherAssetMappings.map((m, i) => {
                                  const amount = getBSAmount(m.qbAccount);
                                  return (
                                    <div key={i} style={{ padding: '6px 16px 6px 32px', borderBottom: '1px solid #f1f5f9', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                      <div>
                                        <div style={{ color: '#475569', fontSize: '13px' }}>{m.qbAccount}</div>
                                        <div style={{ color: '#94a3b8', fontSize: '11px' }}>→ {m.targetField}</div>
                                      </div>
                                      <span style={{ color: '#0f172a', fontFamily: 'monospace', fontWeight: '600' }}>
                                        ${amount.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                                      </span>
                                    </div>
                                  );
                                })}
                              </>
                            )}
                            
                            {/* LIABILITIES SECTION */}
                            <div style={{ padding: '8px', background: '#991b1b', fontWeight: '700', borderBottom: '2px solid #7f1d1d', color: 'white', marginTop: '16px' }}>LIABILITIES</div>
                            
                            {currentLiabMappings.length > 0 && (
                              <>
                                <div style={{ padding: '6px 16px', background: '#fef2f2', fontWeight: '600', borderBottom: '1px solid #fee2e2', color: '#991b1b' }}>Current Liabilities</div>
                                {currentLiabMappings.map((m, i) => {
                                  const amount = getBSAmount(m.qbAccount);
                                  return (
                                    <div key={i} style={{ padding: '6px 16px 6px 32px', borderBottom: '1px solid #f1f5f9', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                      <div>
                                        <div style={{ color: '#475569', fontSize: '13px' }}>{m.qbAccount}</div>
                                        <div style={{ color: '#94a3b8', fontSize: '11px' }}>→ {m.targetField}</div>
                                      </div>
                                      <span style={{ color: '#0f172a', fontFamily: 'monospace', fontWeight: '600' }}>
                                        ${amount.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                                      </span>
                                    </div>
                                  );
                                })}
                              </>
                            )}
                            
                            {longTermLiabMappings.length > 0 && (
                              <>
                                <div style={{ padding: '6px 16px', background: '#fef2f2', fontWeight: '600', borderBottom: '1px solid #fee2e2', color: '#991b1b', marginTop: '8px' }}>Long-Term Liabilities</div>
                                {longTermLiabMappings.map((m, i) => {
                                  const amount = getBSAmount(m.qbAccount);
                                  return (
                                    <div key={i} style={{ padding: '6px 16px 6px 32px', borderBottom: '1px solid #f1f5f9', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                      <div>
                                        <div style={{ color: '#475569', fontSize: '13px' }}>{m.qbAccount}</div>
                                        <div style={{ color: '#94a3b8', fontSize: '11px' }}>→ {m.targetField}</div>
                                      </div>
                                      <span style={{ color: '#0f172a', fontFamily: 'monospace', fontWeight: '600' }}>
                                        ${amount.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                                      </span>
                                    </div>
                                  );
                                })}
                              </>
                            )}
                            
                            {/* EQUITY SECTION */}
                            {equityMappings.length > 0 && (
                              <>
                                <div style={{ padding: '8px', background: '#166534', fontWeight: '700', borderBottom: '2px solid #14532d', color: 'white', marginTop: '16px' }}>EQUITY</div>
                                {equityMappings.map((m, i) => {
                                  const amount = getBSAmount(m.qbAccount);
                                  return (
                                    <div key={i} style={{ padding: '6px 16px 6px 32px', borderBottom: '1px solid #f1f5f9', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                      <div>
                                        <div style={{ color: '#475569', fontSize: '13px' }}>{m.qbAccount}</div>
                                        <div style={{ color: '#94a3b8', fontSize: '11px' }}>→ {m.targetField}</div>
                                      </div>
                                      <span style={{ color: '#0f172a', fontFamily: 'monospace', fontWeight: '600' }}>
                                        ${amount.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                                      </span>
                                    </div>
                                  );
                                })}
                              </>
                            )}
                            
                            {/* TOTAL LIABILITIES & EQUITY */}
                            <div style={{ padding: '12px 16px', background: '#8b5cf6', borderBottom: '4px solid #6b21a8', display: 'flex', justifyContent: 'space-between', fontWeight: '700', marginTop: '8px' }}>
                              <span style={{ color: 'white', fontSize: '16px' }}>TOTAL LIABILITIES & EQUITY</span>
                              <span style={{ color: 'white', fontFamily: 'monospace', fontSize: '16px' }}>
                                ${totalLiabAndEquity.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                              </span>
                            </div>
                            
                            {/* Balance Check */}
                            {Math.abs(totalAssets - totalLiabAndEquity) > 0.01 && (
                              <div style={{ padding: '10px 16px', background: '#fef2f2', border: '2px solid #ef4444', marginTop: '8px', borderRadius: '6px' }}>
                                <span style={{ color: '#991b1b', fontWeight: '600' }}>⚠️ Balance Check: Assets and Liabilities+Equity do not match!</span>
                              </div>
                            )}
                          </>
                        );
                      })()}
                    </div>
                  ) : (
                    <div style={{ padding: '20px', textAlign: 'center', color: '#94a3b8', fontSize: '14px' }}>
                      No mappings saved yet. Generate and save mappings above to see them here.
                    </div>
                  )}
                </div>
              </div>
            </div>
            </div>
            {/* End hidden section */}
            </>
            )}

            {/* Line of Business Reporting Tab */}
            {financialStatementsTab === 'line-of-business' && (
              <div style={{ background: 'white', borderRadius: '12px', padding: '24px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                <div style={{ marginBottom: '12px' }}>
                  <h2 style={{ fontSize: '20px', fontWeight: '600', color: '#1e293b', marginBottom: '16px' }}>Line of Business Reporting</h2>
                  <p style={{ fontSize: '14px', color: '#64748b', marginBottom: '12px' }}>
                    View financial performance by line of business. Select a specific business line or view all lines side by side.
                  </p>
                  
                  {/* Line of Business Selector */}
                  <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr 1fr', gap: '16px', marginBottom: '12px' }}>
                    <div>
                      <label style={{ display: 'block', fontSize: '13px', fontWeight: '600', color: '#475569', marginBottom: '8px' }}>
                        Line of Business
                      </label>
                      <select 
                        value={selectedLineOfBusiness}
                        onChange={(e) => setSelectedLineOfBusiness(e.target.value)}
                        style={{ 
                          width: '100%', 
                          padding: '10px 12px', 
                          border: '1px solid #cbd5e1', 
                          borderRadius: '6px', 
                          fontSize: '14px',
                          color: '#1e293b',
                          background: 'white',
                          cursor: 'pointer'
                        }}
                      >
                        <option value="all">All Lines of Business (Side by Side)</option>
                        {qbRawData?.profitAndLoss?.Columns?.Column && Array.isArray(qbRawData.profitAndLoss.Columns.Column) 
                          ? qbRawData.profitAndLoss.Columns.Column
                              .filter((col: any) => col.ColType !== 'Total')
                              .map((col: any, idx: number) => (
                                <option key={idx} value={col.ColTitle || `Column ${idx + 1}`}>
                                  {col.ColTitle || `Column ${idx + 1}`}
                                </option>
                              ))
                          : null
                        }
                      </select>
                    </div>

                    <div>
                      <label style={{ display: 'block', fontSize: '13px', fontWeight: '600', color: '#475569', marginBottom: '8px' }}>
                        Period
                      </label>
                      <select 
                        value={statementPeriod}
                        onChange={(e) => setStatementPeriod(e.target.value as any)}
                        style={{ 
                          width: '100%', 
                          padding: '10px 12px', 
                          border: '1px solid #cbd5e1', 
                          borderRadius: '6px', 
                          fontSize: '14px',
                          color: '#1e293b',
                          background: 'white',
                          cursor: 'pointer'
                        }}
                      >
                        <option value="current-month">Current Month</option>
                        <option value="current-quarter">Current Quarter</option>
                        <option value="last-12-months">Last 12 months</option>
                        <option value="ytd">YTD</option>
                        <option value="last-year">Last Year</option>
                        <option value="last-3-years">Last 3 Years</option>
                      </select>
                    </div>

                    <div>
                      <label style={{ display: 'block', fontSize: '13px', fontWeight: '600', color: '#475569', marginBottom: '8px' }}>
                        Display As
                      </label>
                      <select 
                        value={statementDisplay}
                        onChange={(e) => setStatementDisplay(e.target.value as 'monthly' | 'quarterly' | 'annual')}
                        style={{ 
                          width: '100%', 
                          padding: '10px 12px', 
                          border: '1px solid #cbd5e1', 
                          borderRadius: '6px', 
                          fontSize: '14px',
                          color: '#1e293b',
                          background: 'white',
                          cursor: 'pointer'
                        }}
                      >
                        <option value="monthly">Monthly</option>
                        <option value="quarterly">Quarterly</option>
                        <option value="annual">Annual</option>
                      </select>
                    </div>
                  </div>
                </div>

                {/* Coming Soon Message */}
                <div style={{ background: '#f8fafc', border: '2px dashed #cbd5e1', borderRadius: '8px', padding: '48px 24px', textAlign: 'center' }}>
                  <div style={{ fontSize: '48px', marginBottom: '16px' }}>📊</div>
                  <div style={{ fontSize: '18px', fontWeight: '600', color: '#1e293b', marginBottom: '8px' }}>
                    Line of Business Reporting
                  </div>
                  <p style={{ fontSize: '14px', color: '#64748b', maxWidth: '500px', margin: '0 auto' }}>
                    This feature will display Income Statement data broken down by line of business from your QuickBooks class tracking. 
                    You'll be able to compare performance across different business lines side by side for the selected period.
                  </p>
                </div>
              </div>
            )}
          </div>
        );
      })()}

      {/* Financial Statements View - Works with CSV or QB data via monthly array */}
      {currentView === 'financial-statements' && selectedCompanyId && !qbRawData && monthly.length > 0 && (
        <div style={{ maxWidth: '1800px', margin: '0 auto', padding: '32px' }}>
          <style>{`
            @media print {
              @page {
                size: letter;
                margin: 0.1in 0.15in 0.1in 0.15in;
              }
              
              /* Hide navigation and UI elements */
              .no-print,
              header,
              nav,
              aside,
              [role="navigation"],
              button {
                display: none !important;
              }
              
              /* Remove background colors and shadows */
              * {
                box-shadow: none !important;
              }
              
              /* Force very tight column spacing */
              [style*="display: grid"] {
                gap: 2px !important;
                column-gap: 2px !important;
              }
              
              /* Reduce padding to bring content closer */
              [style*="display: grid"] > * {
                padding-left: 2px !important;
                padding-right: 2px !important;
              }
              
              /* Reduce font sizes slightly for better fit */
              div[style*="fontSize: '14px'"],
              div[style*="fontSize: '13px'"] {
                font-size: 11px !important;
              }
            }
          `}</style>
          
          <div className="no-print" style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '8px' }}>
            <h1 style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b', margin: 0 }}>Financial Statements</h1>
            {companyName && <div style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b' }}>{companyName}</div>}
          </div>
          <p className="no-print" style={{ fontSize: '14px', color: '#64748b', marginBottom: '12px' }}>
            Based on imported financial data
          </p>

          {/* Tab Navigation */}
          <div className="no-print" style={{ display: 'flex', gap: '8px', marginBottom: '12px', borderBottom: '2px solid #e2e8f0' }}>
            <button
              onClick={() => setFinancialStatementsTab('aggregated')}
              style={{
                padding: '12px 24px',
                background: financialStatementsTab === 'aggregated' ? '#667eea' : 'transparent',
                color: financialStatementsTab === 'aggregated' ? 'white' : '#64748b',
                border: 'none',
                borderBottom: financialStatementsTab === 'aggregated' ? '3px solid #667eea' : '3px solid transparent',
                fontSize: '16px',
                fontWeight: '600',
                cursor: 'pointer',
                borderRadius: '8px 8px 0 0',
                transition: 'all 0.2s'
              }}
            >
              Aggregated Financials
            </button>
            <button
              onClick={() => setFinancialStatementsTab('line-of-business')}
              style={{
                padding: '12px 24px',
                background: financialStatementsTab === 'line-of-business' ? '#667eea' : 'transparent',
                color: financialStatementsTab === 'line-of-business' ? 'white' : '#64748b',
                border: 'none',
                borderBottom: financialStatementsTab === 'line-of-business' ? '3px solid #667eea' : '3px solid transparent',
                fontSize: '16px',
                fontWeight: '600',
                cursor: 'pointer',
                borderRadius: '8px 8px 0 0',
                transition: 'all 0.2s'
              }}
            >
              Line of Business Reporting
            </button>
          </div>

          {/* Aggregated Financials Tab */}
          {financialStatementsTab === 'aggregated' && (
          <>
          {/* Statement Controls */}
          <div className="no-print" style={{ marginBottom: '32px', padding: '24px', background: 'white', borderRadius: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr 1fr 1fr', gap: '16px' }}>
              {/* Type of Statement */}
              <div>
                <label style={{ display: 'block', fontSize: '13px', fontWeight: '600', color: '#475569', marginBottom: '8px' }}>
                  Type of Statement
                </label>
                <select 
                  value={statementType}
                  onChange={(e) => setStatementType(e.target.value as any)}
                  style={{ 
                    width: '100%', 
                    padding: '10px 12px', 
                    border: '1px solid #cbd5e1', 
                    borderRadius: '6px', 
                    fontSize: '14px',
                    color: '#1e293b',
                    background: 'white',
                    cursor: 'pointer'
                  }}
                >
                  <option value="income-statement">Income Statement</option>
                  <option value="income-statement-percent">Income Stmt as % of Revenue</option>
                  <option value="balance-sheet">Balance Sheet</option>
                </select>
              </div>

              {/* Period */}
              <div>
                <label style={{ display: 'block', fontSize: '13px', fontWeight: '600', color: '#475569', marginBottom: '8px' }}>
                  Period
                </label>
                <select 
                  value={statementPeriod}
                  onChange={(e) => setStatementPeriod(e.target.value as any)}
                  style={{ 
                    width: '100%', 
                    padding: '10px 12px', 
                    border: '1px solid #cbd5e1', 
                    borderRadius: '6px', 
                    fontSize: '14px',
                    color: '#1e293b',
                    background: 'white',
                    cursor: 'pointer'
                  }}
                >
                  <option value="current-month">Current Month</option>
                  <option value="current-quarter">Current Quarter</option>
                  <option value="last-12-months">Last 12 months</option>
                  <option value="ytd">YTD</option>
                  <option value="last-year">Last Year</option>
                  <option value="last-3-years">Last 3 Years</option>
                </select>
              </div>

              {/* Display As */}
              <div>
                <label style={{ display: 'block', fontSize: '13px', fontWeight: '600', color: '#475569', marginBottom: '8px' }}>
                  Display As
                </label>
                <select 
                  value={statementDisplay}
                  onChange={(e) => setStatementDisplay(e.target.value as 'monthly' | 'quarterly' | 'annual')}
                  style={{ 
                    width: '100%', 
                    padding: '10px 12px', 
                    border: '1px solid #cbd5e1', 
                    borderRadius: '6px', 
                    fontSize: '14px',
                    color: '#1e293b',
                    background: 'white',
                    cursor: 'pointer'
                  }}
                >
                  <option value="monthly">Monthly</option>
                  <option value="quarterly">Quarterly</option>
                  <option value="annual">Annual</option>
                </select>
              </div>
              
              {/* Print Button */}
              <div style={{ display: 'flex', alignItems: 'flex-end' }}>
                <button
                  onClick={() => window.print()}
                  style={{
                    width: '100%',
                    padding: '10px 12px',
                    background: '#10b981',
                    color: 'white',
                    border: 'none',
                    borderRadius: '6px',
                    fontSize: '14px',
                    fontWeight: '600',
                    cursor: 'pointer',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'center',
                    gap: '8px'
                  }}
                >
                  🖨️ Print
                </button>
              </div>
            </div>
          </div>

          {/* Statement Content Area */}
          {(() => {
            console.log('📊 Financial Statement Render Check (CSV/Monthly Data):', {
              statementType,
              statementPeriod,
              monthlyLength: monthly?.length || 0,
              monthlyFirst: monthly?.[0],
              condition: statementType === 'income-statement' && statementPeriod === 'current-month'
            });
            
            if (statementType === 'income-statement' && statementPeriod === 'current-month') {
              const currentMonth = monthly[monthly.length - 1];
              const monthDate = new Date(currentMonth.date || currentMonth.month);
              const monthName = monthDate.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
              
              // Revenue
              const revenue = currentMonth.revenue || 0;
              
              // Cost of Goods Sold
              const cogsPayroll = currentMonth.cogsPayroll || 0;
              const cogsOwnerPay = currentMonth.cogsOwnerPay || 0;
              const cogsContractors = currentMonth.cogsContractors || 0;
              const cogsMaterials = currentMonth.cogsMaterials || 0;
              const cogsCommissions = currentMonth.cogsCommissions || 0;
              const cogsOther = currentMonth.cogsOther || 0;
              const cogs = cogsPayroll + cogsOwnerPay + cogsContractors + cogsMaterials + cogsCommissions + cogsOther;
              
              const grossProfit = revenue - cogs;
              const grossMargin = revenue > 0 ? (grossProfit / revenue) * 100 : 0;
              
              // Operating Expenses
              const opexPayroll = currentMonth.opexPayroll || 0;
              const ownersBasePay = currentMonth.ownersBasePay || 0;
              const ownersRetirement = currentMonth.ownersRetirement || 0;
              const professionalServices = currentMonth.professionalServices || 0;
              const rentLease = currentMonth.rentLease || 0;
              const utilities = currentMonth.utilities || 0;
              const equipment = currentMonth.equipment || 0;
              const travel = currentMonth.travel || 0;
              const insurance = currentMonth.insurance || 0;
              const opexSalesMarketing = currentMonth.opexSalesMarketing || 0;
              const contractorsDistribution = currentMonth.contractorsDistribution || 0;
              const depreciationExpense = currentMonth.depreciationExpense || 0;
              const opexOther = currentMonth.opexOther || 0;
              
              const totalOpex = opexPayroll + ownersBasePay + ownersRetirement + professionalServices + 
                               rentLease + utilities + equipment + travel + insurance + 
                               opexSalesMarketing + contractorsDistribution + depreciationExpense + opexOther;
              
              const operatingIncome = grossProfit - totalOpex;
              const operatingMargin = revenue > 0 ? (operatingIncome / revenue) * 100 : 0;
              
              // Other Income/Expense
              const interestExpense = currentMonth.interestExpense || 0;
              const nonOperatingIncome = currentMonth.nonOperatingIncome || 0;
              const extraordinaryItems = currentMonth.extraordinaryItems || 0;
              
              const netIncome = operatingIncome - interestExpense + nonOperatingIncome + extraordinaryItems;
              const netMargin = revenue > 0 ? (netIncome / revenue) * 100 : 0;
              
              return (
                <div style={{ background: 'white', borderRadius: '12px', padding: '32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                  <div style={{ marginBottom: '32px', borderBottom: '2px solid #e2e8f0', paddingBottom: '16px' }}>
                    <h2 style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b', marginBottom: '4px' }}>Income Statement</h2>
                    <div style={{ fontSize: '14px', color: '#64748b' }}>For the Month Ended {monthName}</div>
                  </div>

                  {/* Revenue Section */}
                  <div style={{ marginBottom: '12px' }}>
                    <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0', borderBottom: '1px solid #e2e8f0' }}>
                      <span style={{ fontWeight: '600', color: '#1e293b' }}>Revenue</span>
                      <span style={{ fontWeight: '600', color: '#1e293b' }}>${revenue.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                    </div>
                  </div>

                  {/* COGS Section */}
                  <div style={{ marginBottom: '12px' }}>
                    <div style={{ fontWeight: '600', color: '#1e293b', marginBottom: '8px' }}>Cost of Goods Sold</div>
                    {cogsPayroll > 0 && (
                      <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                        <span style={{ color: '#475569' }}>COGS - Payroll</span>
                        <span style={{ color: '#475569' }}>${cogsPayroll.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                      </div>
                    )}
                    {cogsOwnerPay > 0 && (
                      <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                        <span style={{ color: '#475569' }}>COGS - Owner Pay</span>
                        <span style={{ color: '#475569' }}>${cogsOwnerPay.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                      </div>
                    )}
                    {cogsContractors > 0 && (
                      <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                        <span style={{ color: '#475569' }}>COGS - Contractors</span>
                        <span style={{ color: '#475569' }}>${cogsContractors.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                      </div>
                    )}
                    {cogsMaterials > 0 && (
                      <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                        <span style={{ color: '#475569' }}>COGS - Materials</span>
                        <span style={{ color: '#475569' }}>${cogsMaterials.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                      </div>
                    )}
                    {cogsCommissions > 0 && (
                      <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                        <span style={{ color: '#475569' }}>COGS - Commissions</span>
                        <span style={{ color: '#475569' }}>${cogsCommissions.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                      </div>
                    )}
                    {cogsOther > 0 && (
                      <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                        <span style={{ color: '#475569' }}>COGS - Other</span>
                        <span style={{ color: '#475569' }}>${cogsOther.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                      </div>
                    )}
                    <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0', borderTop: '1px solid #e2e8f0', marginTop: '4px' }}>
                      <span style={{ fontWeight: '600', color: '#1e293b' }}>Total COGS</span>
                      <span style={{ fontWeight: '600', color: '#1e293b' }}>${cogs.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                    </div>
                  </div>

                  {/* Gross Profit */}
                  <div style={{ marginBottom: '12px', background: '#dbeafe', padding: '12px', borderRadius: '8px' }}>
                    <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '4px' }}>
                      <span style={{ fontWeight: '700', color: '#1e40af' }}>Gross Profit</span>
                      <span style={{ fontWeight: '700', color: '#1e40af' }}>${grossProfit.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                    </div>
                    <div style={{ fontSize: '13px', color: '#1e40af', textAlign: 'right' }}>
                      {grossMargin.toFixed(1)}% margin
                    </div>
                  </div>

                  {/* Operating Expenses */}
                  <div style={{ marginBottom: '12px' }}>
                    <div style={{ fontWeight: '600', color: '#1e293b', marginBottom: '8px' }}>Operating Expenses</div>
                    {opexPayroll > 0 && (
                      <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                        <span style={{ color: '#475569' }}>Payroll</span>
                        <span style={{ color: '#475569' }}>${opexPayroll.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                      </div>
                    )}
                    {ownersBasePay > 0 && (
                      <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                        <span style={{ color: '#475569' }}>Owner's Base Pay</span>
                        <span style={{ color: '#475569' }}>${ownersBasePay.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                      </div>
                    )}
                    {ownersRetirement > 0 && (
                      <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                        <span style={{ color: '#475569' }}>Owner's Retirement</span>
                        <span style={{ color: '#475569' }}>${ownersRetirement.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                      </div>
                    )}
                    {professionalServices > 0 && (
                      <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                        <span style={{ color: '#475569' }}>Professional Services</span>
                        <span style={{ color: '#475569' }}>${professionalServices.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                      </div>
                    )}
                    {rentLease > 0 && (
                      <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                        <span style={{ color: '#475569' }}>Rent/Lease</span>
                        <span style={{ color: '#475569' }}>${rentLease.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                      </div>
                    )}
                    {utilities > 0 && (
                      <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                        <span style={{ color: '#475569' }}>Utilities</span>
                        <span style={{ color: '#475569' }}>${utilities.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                      </div>
                    )}
                    {equipment > 0 && (
                      <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                        <span style={{ color: '#475569' }}>Equipment</span>
                        <span style={{ color: '#475569' }}>${equipment.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                      </div>
                    )}
                    {travel > 0 && (
                      <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                        <span style={{ color: '#475569' }}>Travel</span>
                        <span style={{ color: '#475569' }}>${travel.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                      </div>
                    )}
                    {insurance > 0 && (
                      <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                        <span style={{ color: '#475569' }}>Insurance</span>
                        <span style={{ color: '#475569' }}>${insurance.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                      </div>
                    )}
                    {opexSalesMarketing > 0 && (
                      <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                        <span style={{ color: '#475569' }}>Sales & Marketing</span>
                        <span style={{ color: '#475569' }}>${opexSalesMarketing.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                      </div>
                    )}
                    {contractorsDistribution > 0 && (
                      <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                        <span style={{ color: '#475569' }}>Contractors Distribution</span>
                        <span style={{ color: '#475569' }}>${contractorsDistribution.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                      </div>
                    )}
                    {depreciationExpense > 0 && (
                      <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                        <span style={{ color: '#475569' }}>Depreciation & Amortization</span>
                        <span style={{ color: '#475569' }}>${depreciationExpense.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                      </div>
                    )}
                    {opexOther > 0 && (
                      <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                        <span style={{ color: '#475569' }}>Other Operating Expenses</span>
                        <span style={{ color: '#475569' }}>${opexOther.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                      </div>
                    )}
                    <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0', borderTop: '1px solid #e2e8f0', marginTop: '4px' }}>
                      <span style={{ fontWeight: '600', color: '#1e293b' }}>Total Operating Expenses</span>
                      <span style={{ fontWeight: '600', color: '#1e293b' }}>${totalOpex.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                    </div>
                  </div>

                  {/* Operating Income */}
                  <div style={{ marginBottom: '12px', background: '#f0fdf4', padding: '12px', borderRadius: '8px' }}>
                    <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '4px' }}>
                      <span style={{ fontWeight: '700', color: '#166534' }}>Operating Income</span>
                      <span style={{ fontWeight: '700', color: '#166534' }}>${operatingIncome.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                    </div>
                    <div style={{ fontSize: '13px', color: '#166534', textAlign: 'right' }}>
                      {operatingMargin.toFixed(1)}% margin
                    </div>
                  </div>

                  {/* Other Income/Expense */}
                  {(interestExpense > 0 || nonOperatingIncome > 0 || extraordinaryItems !== 0) && (
                    <div style={{ marginBottom: '12px' }}>
                      <div style={{ fontWeight: '600', color: '#1e293b', marginBottom: '8px' }}>Other Income/(Expense)</div>
                      {nonOperatingIncome > 0 && (
                        <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                          <span style={{ color: '#475569' }}>Non-Operating Income</span>
                          <span style={{ color: '#10b981' }}>${nonOperatingIncome.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                      )}
                      {interestExpense > 0 && (
                        <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                          <span style={{ color: '#475569' }}>Interest Expense</span>
                          <span style={{ color: '#ef4444' }}>($  {interestExpense.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })})</span>
                        </div>
                      )}
                      {extraordinaryItems !== 0 && (
                        <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                          <span style={{ color: '#475569' }}>Extraordinary Items</span>
                          <span style={{ color: extraordinaryItems >= 0 ? '#10b981' : '#ef4444' }}>
                            {extraordinaryItems >= 0 ? '$' : '($'}{Math.abs(extraordinaryItems).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}{extraordinaryItems < 0 ? ')' : ''}
                          </span>
                        </div>
                      )}
                    </div>
                  )}

                  {/* Net Income */}
                  <div style={{ background: netIncome >= 0 ? '#dcfce7' : '#fee2e2', padding: '16px', borderRadius: '8px', marginTop: '32px' }}>
                    <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '4px' }}>
                      <span style={{ fontWeight: '700', fontSize: '18px', color: netIncome >= 0 ? '#166534' : '#991b1b' }}>Net Income</span>
                      <span style={{ fontWeight: '700', fontSize: '18px', color: netIncome >= 0 ? '#166534' : '#991b1b' }}>
                        ${netIncome.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                      </span>
                    </div>
                    <div style={{ fontSize: '14px', color: netIncome >= 0 ? '#166534' : '#991b1b', textAlign: 'right' }}>
                      {netMargin.toFixed(1)}% net margin
                    </div>
                  </div>
                </div>
              );
            } else if (statementType === 'income-statement-percent' && statementPeriod === 'current-month') {
              // Copy the entire common size logic from QB version
              const currentMonth = monthly[monthly.length - 1];
              const monthDate = new Date(currentMonth.date || currentMonth.month);
              const monthName = monthDate.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
              
              // Revenue
              const revenue = currentMonth.revenue || 0;
              
              // Cost of Goods Sold
              const cogsPayroll = currentMonth.cogsPayroll || 0;
              const cogsOwnerPay = currentMonth.cogsOwnerPay || 0;
              const cogsContractors = currentMonth.cogsContractors || 0;
              const cogsMaterials = currentMonth.cogsMaterials || 0;
              const cogsCommissions = currentMonth.cogsCommissions || 0;
              const cogsOther = currentMonth.cogsOther || 0;
              const cogs = cogsPayroll + cogsOwnerPay + cogsContractors + cogsMaterials + cogsCommissions + cogsOther;
              
              const grossProfit = revenue - cogs;
              const grossMargin = revenue > 0 ? (grossProfit / revenue) * 100 : 0;
              
              // Operating Expenses
              const opexPayroll = currentMonth.opexPayroll || 0;
              const ownersBasePay = currentMonth.ownersBasePay || 0;
              const ownersRetirement = currentMonth.ownersRetirement || 0;
              const professionalServices = currentMonth.professionalServices || 0;
              const rentLease = currentMonth.rentLease || 0;
              const utilities = currentMonth.utilities || 0;
              const equipment = currentMonth.equipment || 0;
              const travel = currentMonth.travel || 0;
              const insurance = currentMonth.insurance || 0;
              const opexSalesMarketing = currentMonth.opexSalesMarketing || 0;
              const contractorsDistribution = currentMonth.contractorsDistribution || 0;
              const depreciationExpense = currentMonth.depreciationExpense || 0;
              const opexOther = currentMonth.opexOther || 0;
              
              const totalOpex = opexPayroll + ownersBasePay + ownersRetirement + professionalServices + 
                               rentLease + utilities + equipment + travel + insurance + 
                               opexSalesMarketing + contractorsDistribution + depreciationExpense + opexOther;
              
              const operatingIncome = grossProfit - totalOpex;
              const operatingMargin = revenue > 0 ? (operatingIncome / revenue) * 100 : 0;
              
              // Other Income/Expense
              const interestExpense = currentMonth.interestExpense || 0;
              const nonOperatingIncome = currentMonth.nonOperatingIncome || 0;
              const extraordinaryItems = currentMonth.extraordinaryItems || 0;
              
              const netIncome = operatingIncome - interestExpense + nonOperatingIncome + extraordinaryItems;
              const netMargin = revenue > 0 ? (netIncome / revenue) * 100 : 0;
              
              // Helper function to calculate percentage
              const pct = (amount: number) => revenue > 0 ? (amount / revenue) * 100 : 0;
              
              return (
                <div style={{ background: 'white', borderRadius: '12px', padding: '32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                  <div style={{ marginBottom: '32px', borderBottom: '2px solid #e2e8f0', paddingBottom: '16px' }}>
                    <h2 style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b', marginBottom: '4px' }}>Income Statement - Common Size Analysis</h2>
                    <div style={{ fontSize: '14px', color: '#64748b' }}>For the Month Ended {monthName} • All items shown as % of Revenue</div>
                  </div>

                  {/* Column Headers */}
                  <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '8px 0', borderBottom: '2px solid #cbd5e1', marginBottom: '12px', fontWeight: '600', fontSize: '13px', color: '#475569' }}>
                    <div>Line Item</div>
                    <div style={{ textAlign: 'right' }}>Amount</div>
                    <div style={{ textAlign: 'right' }}>% of Revenue</div>
                  </div>

                  {/* Revenue Section */}
                  <div style={{ marginBottom: '12px' }}>
                    <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '8px 0', borderBottom: '1px solid #e2e8f0', background: '#f8fafc' }}>
                      <span style={{ fontWeight: '600', color: '#1e293b' }}>Revenue</span>
                      <span style={{ fontWeight: '600', color: '#1e293b', textAlign: 'right' }}>${revenue.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                      <span style={{ fontWeight: '600', color: '#1e293b', textAlign: 'right' }}>100.0%</span>
                    </div>
                  </div>

                  {/* COGS Section */}
                  <div style={{ marginBottom: '12px' }}>
                    <div style={{ fontWeight: '600', color: '#1e293b', marginBottom: '8px', fontSize: '15px' }}>Cost of Goods Sold</div>
                    {cogsPayroll > 0 && (
                      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                        <span style={{ color: '#475569', paddingLeft: '20px' }}>COGS - Payroll</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>${cogsPayroll.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>{pct(cogsPayroll).toFixed(1)}%</span>
                      </div>
                    )}
                    {cogsOwnerPay > 0 && (
                      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                        <span style={{ color: '#475569', paddingLeft: '20px' }}>COGS - Owner Pay</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>${cogsOwnerPay.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>{pct(cogsOwnerPay).toFixed(1)}%</span>
                      </div>
                    )}
                    {cogsContractors > 0 && (
                      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                        <span style={{ color: '#475569', paddingLeft: '20px' }}>COGS - Contractors</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>${cogsContractors.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>{pct(cogsContractors).toFixed(1)}%</span>
                      </div>
                    )}
                    {cogsMaterials > 0 && (
                      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                        <span style={{ color: '#475569', paddingLeft: '20px' }}>COGS - Materials</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>${cogsMaterials.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>{pct(cogsMaterials).toFixed(1)}%</span>
                      </div>
                    )}
                    {cogsCommissions > 0 && (
                      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                        <span style={{ color: '#475569', paddingLeft: '20px' }}>COGS - Commissions</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>${cogsCommissions.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>{pct(cogsCommissions).toFixed(1)}%</span>
                      </div>
                    )}
                    {cogsOther > 0 && (
                      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                        <span style={{ color: '#475569', paddingLeft: '20px' }}>COGS - Other</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>${cogsOther.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>{pct(cogsOther).toFixed(1)}%</span>
                      </div>
                    )}
                    <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '8px 0', borderTop: '1px solid #e2e8f0', marginTop: '4px' }}>
                      <span style={{ fontWeight: '600', color: '#1e293b', paddingLeft: '20px' }}>Total COGS</span>
                      <span style={{ fontWeight: '600', color: '#1e293b', textAlign: 'right' }}>${cogs.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                      <span style={{ fontWeight: '600', color: '#1e293b', textAlign: 'right' }}>{pct(cogs).toFixed(1)}%</span>
                    </div>
                  </div>

                  {/* Gross Profit */}
                  <div style={{ marginBottom: '12px', background: '#dbeafe', padding: '12px', borderRadius: '8px' }}>
                    <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr' }}>
                      <span style={{ fontWeight: '700', color: '#1e40af' }}>Gross Profit</span>
                      <span style={{ fontWeight: '700', color: '#1e40af', textAlign: 'right' }}>${grossProfit.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                      <span style={{ fontWeight: '700', color: '#1e40af', textAlign: 'right' }}>{grossMargin.toFixed(1)}%</span>
                    </div>
                  </div>

                  {/* Operating Expenses */}
                  <div style={{ marginBottom: '12px' }}>
                    <div style={{ fontWeight: '600', color: '#1e293b', marginBottom: '8px', fontSize: '15px' }}>Operating Expenses</div>
                    {opexPayroll > 0 && (
                      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                        <span style={{ color: '#475569', paddingLeft: '20px' }}>Payroll</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>${opexPayroll.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>{pct(opexPayroll).toFixed(1)}%</span>
                      </div>
                    )}
                    {ownersBasePay > 0 && (
                      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                        <span style={{ color: '#475569', paddingLeft: '20px' }}>Owner's Base Pay</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>${ownersBasePay.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>{pct(ownersBasePay).toFixed(1)}%</span>
                      </div>
                    )}
                    {ownersRetirement > 0 && (
                      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                        <span style={{ color: '#475569', paddingLeft: '20px' }}>Owner's Retirement</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>${ownersRetirement.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>{pct(ownersRetirement).toFixed(1)}%</span>
                      </div>
                    )}
                    {professionalServices > 0 && (
                      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                        <span style={{ color: '#475569', paddingLeft: '20px' }}>Professional Services</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>${professionalServices.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>{pct(professionalServices).toFixed(1)}%</span>
                      </div>
                    )}
                    {rentLease > 0 && (
                      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                        <span style={{ color: '#475569', paddingLeft: '20px' }}>Rent/Lease</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>${rentLease.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>{pct(rentLease).toFixed(1)}%</span>
                      </div>
                    )}
                    {utilities > 0 && (
                      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                        <span style={{ color: '#475569', paddingLeft: '20px' }}>Utilities</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>${utilities.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>{pct(utilities).toFixed(1)}%</span>
                      </div>
                    )}
                    {equipment > 0 && (
                      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                        <span style={{ color: '#475569', paddingLeft: '20px' }}>Equipment</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>${equipment.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>{pct(equipment).toFixed(1)}%</span>
                      </div>
                    )}
                    {travel > 0 && (
                      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                        <span style={{ color: '#475569', paddingLeft: '20px' }}>Travel</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>${travel.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>{pct(travel).toFixed(1)}%</span>
                      </div>
                    )}
                    {insurance > 0 && (
                      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                        <span style={{ color: '#475569', paddingLeft: '20px' }}>Insurance</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>${insurance.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>{pct(insurance).toFixed(1)}%</span>
                      </div>
                    )}
                    {opexSalesMarketing > 0 && (
                      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                        <span style={{ color: '#475569', paddingLeft: '20px' }}>Sales & Marketing</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>${opexSalesMarketing.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>{pct(opexSalesMarketing).toFixed(1)}%</span>
                      </div>
                    )}
                    {contractorsDistribution > 0 && (
                      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                        <span style={{ color: '#475569', paddingLeft: '20px' }}>Contractors Distribution</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>${contractorsDistribution.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>{pct(contractorsDistribution).toFixed(1)}%</span>
                      </div>
                    )}
                    {depreciationExpense > 0 && (
                      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                        <span style={{ color: '#475569', paddingLeft: '20px' }}>Depreciation & Amortization</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>${depreciationExpense.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>{pct(depreciationExpense).toFixed(1)}%</span>
                      </div>
                    )}
                    {opexOther > 0 && (
                      <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                        <span style={{ color: '#475569', paddingLeft: '20px' }}>Other Operating Expenses</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>${opexOther.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                        <span style={{ color: '#475569', textAlign: 'right' }}>{pct(opexOther).toFixed(1)}%</span>
                      </div>
                    )}
                    <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '8px 0', borderTop: '1px solid #e2e8f0', marginTop: '4px' }}>
                      <span style={{ fontWeight: '600', color: '#1e293b', paddingLeft: '20px' }}>Total Operating Expenses</span>
                      <span style={{ fontWeight: '600', color: '#1e293b', textAlign: 'right' }}>${totalOpex.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                      <span style={{ fontWeight: '600', color: '#1e293b', textAlign: 'right' }}>{pct(totalOpex).toFixed(1)}%</span>
                    </div>
                  </div>

                  {/* Operating Income */}
                  <div style={{ marginBottom: '12px', background: '#f0fdf4', padding: '12px', borderRadius: '8px' }}>
                    <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr' }}>
                      <span style={{ fontWeight: '700', color: '#166534' }}>Operating Income</span>
                      <span style={{ fontWeight: '700', color: '#166534', textAlign: 'right' }}>${operatingIncome.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                      <span style={{ fontWeight: '700', color: '#166534', textAlign: 'right' }}>{operatingMargin.toFixed(1)}%</span>
                    </div>
                  </div>

                  {/* Other Income/Expense */}
                  {(interestExpense > 0 || nonOperatingIncome > 0 || extraordinaryItems !== 0) && (
                    <div style={{ marginBottom: '12px' }}>
                      <div style={{ fontWeight: '600', color: '#1e293b', marginBottom: '8px', fontSize: '15px' }}>Other Income/(Expense)</div>
                      {nonOperatingIncome > 0 && (
                        <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                          <span style={{ color: '#475569', paddingLeft: '20px' }}>Non-Operating Income</span>
                          <span style={{ color: '#10b981', textAlign: 'right' }}>${nonOperatingIncome.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}</span>
                          <span style={{ color: '#10b981', textAlign: 'right' }}>{pct(nonOperatingIncome).toFixed(1)}%</span>
                        </div>
                      )}
                      {interestExpense > 0 && (
                        <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                          <span style={{ color: '#475569', paddingLeft: '20px' }}>Interest Expense</span>
                          <span style={{ color: '#ef4444', textAlign: 'right' }}>($  {interestExpense.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })})</span>
                          <span style={{ color: '#ef4444', textAlign: 'right' }}>({pct(interestExpense).toFixed(1)}%)</span>
                        </div>
                      )}
                      {extraordinaryItems !== 0 && (
                        <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr', padding: '6px 0', fontSize: '14px' }}>
                          <span style={{ color: '#475569', paddingLeft: '20px' }}>Extraordinary Items</span>
                          <span style={{ color: extraordinaryItems >= 0 ? '#10b981' : '#ef4444', textAlign: 'right' }}>
                            {extraordinaryItems >= 0 ? '$' : '($'}{Math.abs(extraordinaryItems).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}{extraordinaryItems < 0 ? ')' : ''}
                          </span>
                          <span style={{ color: extraordinaryItems >= 0 ? '#10b981' : '#ef4444', textAlign: 'right' }}>
                            {extraordinaryItems >= 0 ? '' : '('}{pct(Math.abs(extraordinaryItems)).toFixed(1)}%{extraordinaryItems < 0 ? ')' : ''}
                          </span>
                        </div>
                      )}
                    </div>
                  )}

                  {/* Net Income */}
                  <div style={{ background: netIncome >= 0 ? '#dcfce7' : '#fee2e2', padding: '16px', borderRadius: '8px', marginTop: '32px' }}>
                    <div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr 1fr' }}>
                      <span style={{ fontWeight: '700', fontSize: '18px', color: netIncome >= 0 ? '#166534' : '#991b1b' }}>Net Income</span>
                      <span style={{ fontWeight: '700', fontSize: '18px', color: netIncome >= 0 ? '#166534' : '#991b1b', textAlign: 'right' }}>
                        ${netIncome.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}
                      </span>
                      <span style={{ fontWeight: '700', fontSize: '18px', color: netIncome >= 0 ? '#166534' : '#991b1b', textAlign: 'right' }}>
                        {netMargin.toFixed(1)}%
                      </span>
                    </div>
                  </div>
                </div>
              );
            } else if (statementType === 'balance-sheet' && statementPeriod === 'current-month') {
              const currentMonth = monthly[monthly.length - 1];
              const monthDate = new Date(currentMonth.date || currentMonth.month);
              const monthName = monthDate.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
              
              // Assets
              const cash = currentMonth.cash || 0;
              const ar = currentMonth.ar || 0;
              const inventory = currentMonth.inventory || 0;
              const otherCA = currentMonth.otherCA || 0;
              const tca = cash + ar + inventory + otherCA;
              
              const fixedAssets = currentMonth.fixedAssets || 0;
              const otherAssets = currentMonth.otherAssets || 0;
              const totalAssets = tca + fixedAssets + otherAssets;
              
              // Liabilities
              const ap = currentMonth.ap || 0;
              const otherCL = currentMonth.otherCL || 0;
              const tcl = ap + otherCL;
              
              const ltd = currentMonth.ltd || 0;
              const totalLiabilities = tcl + ltd;
              
              // Equity
              const totalEquity = currentMonth.totalEquity || 0;
              
              // Total L&E
              const totalLAndE = totalLiabilities + totalEquity;
              
              return (
                <div style={{ background: 'white', borderRadius: '12px', padding: '32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                  <div style={{ marginBottom: '32px', borderBottom: '2px solid #e2e8f0', paddingBottom: '16px' }}>
                    <h2 style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b', marginBottom: '4px' }}>Balance Sheet</h2>
                    <div style={{ fontSize: '14px', color: '#64748b' }}>As of {monthName}</div>
                  </div>

                  {/* ASSETS */}
                  <div style={{ marginBottom: '32px' }}>
                    <div style={{ fontSize: '18px', fontWeight: '700', color: '#1e293b', marginBottom: '16px', paddingBottom: '8px', borderBottom: '2px solid #667eea' }}>ASSETS</div>
                    
                    {/* Current Assets */}
                    <div style={{ marginBottom: '20px' }}>
                      <div style={{ fontWeight: '600', color: '#1e293b', marginBottom: '8px', fontSize: '15px' }}>Current Assets</div>
                      {cash > 0 && (
                        <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                          <span style={{ color: '#475569' }}>Cash</span>
                          <span style={{ color: '#475569' }}>${cash.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                      )}
                      {ar > 0 && (
                        <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                          <span style={{ color: '#475569' }}>Accounts Receivable</span>
                          <span style={{ color: '#475569' }}>${ar.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                      )}
                      {inventory > 0 && (
                        <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                          <span style={{ color: '#475569' }}>Inventory</span>
                          <span style={{ color: '#475569' }}>${inventory.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                      )}
                      {otherCA > 0 && (
                        <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                          <span style={{ color: '#475569' }}>Other Current Assets</span>
                          <span style={{ color: '#475569' }}>${otherCA.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                      )}
                      <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0 8px 20px', borderTop: '1px solid #e2e8f0', marginTop: '4px' }}>
                        <span style={{ fontWeight: '600', color: '#1e293b' }}>Total Current Assets</span>
                        <span style={{ fontWeight: '600', color: '#1e293b' }}>${tca.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                      </div>
                    </div>

                    {/* Non-Current Assets */}
                    {fixedAssets > 0 && (
                      <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0', fontSize: '14px' }}>
                        <span style={{ color: '#475569' }}>Fixed Assets</span>
                        <span style={{ color: '#475569' }}>${fixedAssets.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                      </div>
                    )}
                    {otherAssets > 0 && (
                      <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0', fontSize: '14px' }}>
                        <span style={{ color: '#475569' }}>Other Assets</span>
                        <span style={{ color: '#475569' }}>${otherAssets.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                      </div>
                    )}
                    
                    <div style={{ display: 'flex', justifyContent: 'space-between', padding: '12px 0', borderTop: '2px solid #667eea', marginTop: '8px', background: '#f8fafc' }}>
                      <span style={{ fontWeight: '700', fontSize: '16px', color: '#1e293b' }}>TOTAL ASSETS</span>
                      <span style={{ fontWeight: '700', fontSize: '16px', color: '#1e293b' }}>${totalAssets.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                    </div>
                  </div>

                  {/* LIABILITIES */}
                  <div style={{ marginBottom: '32px' }}>
                    <div style={{ fontSize: '18px', fontWeight: '700', color: '#1e293b', marginBottom: '16px', paddingBottom: '8px', borderBottom: '2px solid #f59e0b' }}>LIABILITIES</div>
                    
                    {/* Current Liabilities */}
                    <div style={{ marginBottom: '20px' }}>
                      <div style={{ fontWeight: '600', color: '#1e293b', marginBottom: '8px', fontSize: '15px' }}>Current Liabilities</div>
                      {ap > 0 && (
                        <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                          <span style={{ color: '#475569' }}>Accounts Payable</span>
                          <span style={{ color: '#475569' }}>${ap.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                      )}
                      {otherCL > 0 && (
                        <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                          <span style={{ color: '#475569' }}>Other Current Liabilities</span>
                          <span style={{ color: '#475569' }}>${otherCL.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                      )}
                      <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0 8px 20px', borderTop: '1px solid #e2e8f0', marginTop: '4px' }}>
                        <span style={{ fontWeight: '600', color: '#1e293b' }}>Total Current Liabilities</span>
                        <span style={{ fontWeight: '600', color: '#1e293b' }}>${tcl.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                      </div>
                    </div>

                    {/* Long-term Debt */}
                    {ltd > 0 && (
                      <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0', fontSize: '14px' }}>
                        <span style={{ color: '#475569' }}>Long-term Debt</span>
                        <span style={{ color: '#475569' }}>${ltd.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                      </div>
                    )}
                    
                    <div style={{ display: 'flex', justifyContent: 'space-between', padding: '12px 0', borderTop: '2px solid #f59e0b', marginTop: '8px', background: '#fef3c7' }}>
                      <span style={{ fontWeight: '700', fontSize: '16px', color: '#1e293b' }}>TOTAL LIABILITIES</span>
                      <span style={{ fontWeight: '700', fontSize: '16px', color: '#1e293b' }}>${totalLiabilities.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                    </div>
                  </div>

                  {/* EQUITY */}
                  <div style={{ marginBottom: '12px' }}>
                    <div style={{ fontSize: '18px', fontWeight: '700', color: '#1e293b', marginBottom: '16px', paddingBottom: '8px', borderBottom: '2px solid #10b981' }}>EQUITY</div>
                    
                    <div style={{ display: 'flex', justifyContent: 'space-between', padding: '12px 0', borderTop: '2px solid #10b981', background: '#d1fae5' }}>
                      <span style={{ fontWeight: '700', fontSize: '16px', color: '#1e293b' }}>TOTAL EQUITY</span>
                      <span style={{ fontWeight: '700', fontSize: '16px', color: '#1e293b' }}>${totalEquity.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                    </div>
                  </div>

                  {/* TOTAL LIABILITIES & EQUITY */}
                  <div style={{ background: '#f1f5f9', padding: '16px', borderRadius: '8px', marginTop: '32px' }}>
                    <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '4px' }}>
                      <span style={{ fontWeight: '700', fontSize: '18px', color: '#1e293b' }}>TOTAL LIABILITIES & EQUITY</span>
                      <span style={{ fontWeight: '700', fontSize: '18px', color: '#1e293b' }}>
                        ${totalLAndE.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                      </span>
                    </div>
                    {Math.abs(totalAssets - totalLAndE) > 0.01 && (
                      <div style={{ fontSize: '12px', color: '#ef4444', marginTop: '8px', textAlign: 'right' }}>
                        ⚠️ Balance check: Assets - (Liabilities + Equity) = ${(totalAssets - totalLAndE).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                      </div>
                    )}
                  </div>
                </div>
              );
            }
            
            // Multi-period logic (Current Quarter, Last 12 Months, YTD, Last Year, Last 3 Years)
            else if (monthly.length > 0 && statementPeriod !== 'current-month') {
              // Helper function to get months for the selected period
              const getMonthsForPeriod = () => {
                const now = new Date();
                const currentYear = now.getFullYear();
                const currentMonth = now.getMonth(); // 0-11
                
                switch (statementPeriod) {
                  case 'current-quarter':
                    // Last 3 months
                    return monthly.slice(-3);
                  
                  case 'last-12-months':
                    // Last 12 months
                    return monthly.slice(-12);
                  
                  case 'ytd':
                    // Year to date - from January of current year to now
                    return monthly.filter(m => {
                      const mDate = new Date(m.date || m.month);
                      return mDate.getFullYear() === currentYear;
                    });
                  
                  case 'last-year':
                    // Full previous year
                    return monthly.filter(m => {
                      const mDate = new Date(m.date || m.month);
                      return mDate.getFullYear() === currentYear - 1;
                    });
                  
                  case 'last-3-years':
                    // Last 36 months
                    return monthly.slice(-36);
                  
                  default:
                    return [];
                }
              };
              
              const periodMonths = getMonthsForPeriod();
              
              if (periodMonths.length === 0) {
                return (
                  <div style={{ background: 'white', borderRadius: '12px', padding: '48px 32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', minHeight: '400px', textAlign: 'center' }}>
                    <div style={{ fontSize: '18px', fontWeight: '600', color: '#64748b', marginBottom: '12px' }}>
                      📊 No Data Available
                    </div>
                    <p style={{ fontSize: '14px', color: '#94a3b8' }}>
                      No financial data available for the selected period.
                    </p>
                  </div>
                );
              }
              
              // Get period label
              const getPeriodLabel = () => {
                const firstMonth = periodMonths[0];
                const lastMonth = periodMonths[periodMonths.length - 1];
                const firstDate = new Date(firstMonth.date || firstMonth.month);
                const lastDate = new Date(lastMonth.date || lastMonth.month);
                
                switch (statementPeriod) {
                  case 'current-quarter':
                    return `Current Quarter (${firstDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' })} - ${lastDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' })})`;
                  case 'last-12-months':
                    return `Last 12 Months (${firstDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' })} - ${lastDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' })})`;
                  case 'ytd':
                    return `Year to Date ${lastDate.getFullYear()} (Jan - ${lastDate.toLocaleDateString('en-US', { month: 'short' })})`;
                  case 'last-year':
                    return `Fiscal Year ${firstDate.getFullYear()}`;
                  case 'last-3-years':
                    return `Last 3 Years (${firstDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' })} - ${lastDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' })})`;
                  default:
                    return '';
                }
              };
              
              const periodLabel = getPeriodLabel();
              const latestMonth = periodMonths[periodMonths.length - 1];
              
              // Helper function to group months by display period
              const groupMonthsByDisplay = () => {
                if (statementDisplay === 'monthly') {
                  // Each month is its own period
                  return periodMonths.map(m => ({
                    label: new Date(m.date || m.month).toLocaleDateString('en-US', { month: 'short', year: 'numeric' }),
                    months: [m]
                  }));
                } else if (statementDisplay === 'quarterly') {
                  // Group by quarter
                  const quarters: { [key: string]: any[] } = {};
                  periodMonths.forEach(m => {
                    const date = new Date(m.date || m.month);
                    const year = date.getFullYear();
                    const quarter = Math.floor(date.getMonth() / 3) + 1;
                    const key = `${year}-Q${quarter}`;
                    if (!quarters[key]) quarters[key] = [];
                    quarters[key].push(m);
                  });
                  return Object.entries(quarters).map(([key, months]) => ({
                    label: key,
                    months
                  }));
                } else {
                  // Annual - group by year
                  const years: { [key: string]: any[] } = {};
                  periodMonths.forEach(m => {
                    const year = new Date(m.date || m.month).getFullYear().toString();
                    if (!years[year]) years[year] = [];
                    years[year].push(m);
                  });
                  return Object.entries(years).map(([year, months]) => ({
                    label: year,
                    months
                  }));
                }
              };
              
              const displayPeriods = groupMonthsByDisplay();
              
              // INCOME STATEMENT - Aggregate across period
              if (statementType === 'income-statement') {
                // Check if we're showing multiple periods side-by-side
                if (displayPeriods.length > 1) {
                // Multi-column comparative income statement
                const calculatePeriodData = (months: any[]) => {
                  const revenue = months.reduce((sum, m) => sum + (m.revenue || 0), 0);
                  
                  // COGS detailed
                  const cogsPayroll = months.reduce((sum, m) => sum + (m.cogsPayroll || 0), 0);
                  const cogsOwnerPay = months.reduce((sum, m) => sum + (m.cogsOwnerPay || 0), 0);
                  const cogsContractors = months.reduce((sum, m) => sum + (m.cogsContractors || 0), 0);
                  const cogsMaterials = months.reduce((sum, m) => sum + (m.cogsMaterials || 0), 0);
                  const cogsCommissions = months.reduce((sum, m) => sum + (m.cogsCommissions || 0), 0);
                  const cogsOther = months.reduce((sum, m) => sum + (m.cogsOther || 0), 0);
                  const cogs = cogsPayroll + cogsOwnerPay + cogsContractors + cogsMaterials + cogsCommissions + cogsOther;
                  const grossProfit = revenue - cogs;
                  
                  // Operating Expenses detailed
                  const opexPayroll = months.reduce((sum, m) => sum + (m.opexPayroll || 0), 0);
                  const ownersBasePay = months.reduce((sum, m) => sum + (m.ownersBasePay || 0), 0);
                  const ownersRetirement = months.reduce((sum, m) => sum + (m.ownersRetirement || 0), 0);
                  const professionalServices = months.reduce((sum, m) => sum + (m.professionalServices || 0), 0);
                  const rentLease = months.reduce((sum, m) => sum + (m.rentLease || 0), 0);
                  const utilities = months.reduce((sum, m) => sum + (m.utilities || 0), 0);
                  const equipment = months.reduce((sum, m) => sum + (m.equipment || 0), 0);
                  const travel = months.reduce((sum, m) => sum + (m.travel || 0), 0);
                  const insurance = months.reduce((sum, m) => sum + (m.insurance || 0), 0);
                  const opexSalesMarketing = months.reduce((sum, m) => sum + (m.opexSalesMarketing || 0), 0);
                  const contractorsDistribution = months.reduce((sum, m) => sum + (m.contractorsDistribution || 0), 0);
                  const depreciationExpense = months.reduce((sum, m) => sum + (m.depreciationExpense || 0), 0);
                  const opexOther = months.reduce((sum, m) => sum + (m.opexOther || 0), 0);
                  const totalOpex = opexPayroll + ownersBasePay + ownersRetirement + professionalServices + 
                                   rentLease + utilities + equipment + travel + insurance + 
                                   opexSalesMarketing + contractorsDistribution + depreciationExpense + opexOther;
                  const operatingIncome = grossProfit - totalOpex;
                  
                  // Other Income/Expense
                  const interestExpense = months.reduce((sum, m) => sum + (m.interestExpense || 0), 0);
                  const nonOperatingIncome = months.reduce((sum, m) => sum + (m.nonOperatingIncome || 0), 0);
                  const extraordinaryItems = months.reduce((sum, m) => sum + (m.extraordinaryItems || 0), 0);
                  const netIncome = operatingIncome - interestExpense + nonOperatingIncome + extraordinaryItems;
                  
                  return { 
                    revenue, 
                    cogsPayroll, cogsOwnerPay, cogsContractors, cogsMaterials, cogsCommissions, cogsOther, cogs, 
                    grossProfit, 
                    opexPayroll, ownersBasePay, ownersRetirement, professionalServices, rentLease, utilities, 
                    equipment, travel, insurance, opexSalesMarketing, contractorsDistribution, depreciationExpense, opexOther, totalOpex,
                    operatingIncome, 
                    interestExpense, nonOperatingIncome, extraordinaryItems, 
                    netIncome 
                  };
                };
                  
                  const periodsData = displayPeriods.map(p => ({
                    label: p.label,
                    ...calculatePeriodData(p.months)
                  }));
                  
                  return (
                    <div style={{ background: 'white', borderRadius: '12px', padding: '32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', overflowX: 'auto' }}>
                      <div style={{ marginBottom: '32px', borderBottom: '2px solid #e2e8f0', paddingBottom: '16px' }}>
                        <h2 style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b', marginBottom: '4px' }}>Comparative Income Statement</h2>
                        <div style={{ fontSize: '14px', color: '#64748b' }}>{periodLabel} - {statementDisplay === 'monthly' ? 'Monthly' : statementDisplay === 'quarterly' ? 'Quarterly' : 'Annual'}</div>
                      </div>
                      
                      {/* Table with multiple columns */}
                      <div style={{ minWidth: `${200 + (periodsData.length * 110)}px` }}>
                        {/* Header Row */}
                        <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '12px 0', borderBottom: '2px solid #1e293b', fontWeight: '600', color: '#1e293b', position: 'sticky', top: 0, background: 'white' }}>
                          <div>Line Item</div>
                          {periodsData.map((p, i) => (
                            <div key={i} style={{ textAlign: 'right' }}>{p.label}</div>
                          ))}
                        </div>
                        
                        {/* Revenue */}
                        <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '8px 0', borderBottom: '1px solid #e2e8f0', fontWeight: '600' }}>
                          <div style={{ color: '#1e293b' }}>Revenue</div>
                          {periodsData.map((p, i) => (
                            <div key={i} style={{ textAlign: 'right', color: '#1e293b' }}>${(p.revenue / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                          ))}
                        </div>
                        
                        {/* COGS Section Header */}
                        <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '12px 0 4px 0', fontSize: '14px', fontWeight: '600', marginTop: '8px' }}>
                          <div style={{ color: '#475569' }}>Cost of Goods Sold</div>
                          {periodsData.map((p, i) => <div key={i}></div>)}
                        </div>
                        
                        {/* COGS Details */}
                        {periodsData.some(p => p.cogsPayroll > 0) && (
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                            <div style={{ color: '#64748b', paddingLeft: '20px' }}>COGS - Payroll</div>
                            {periodsData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.cogsPayroll / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                            ))}
                          </div>
                        )}
                        {periodsData.some(p => p.cogsOwnerPay > 0) && (
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                            <div style={{ color: '#64748b', paddingLeft: '20px' }}>COGS - Owner Pay</div>
                            {periodsData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.cogsOwnerPay / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                            ))}
                          </div>
                        )}
                        {periodsData.some(p => p.cogsContractors > 0) && (
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                            <div style={{ color: '#64748b', paddingLeft: '20px' }}>COGS - Contractors</div>
                            {periodsData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.cogsContractors / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                            ))}
                          </div>
                        )}
                        {periodsData.some(p => p.cogsMaterials > 0) && (
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                            <div style={{ color: '#64748b', paddingLeft: '20px' }}>COGS - Materials</div>
                            {periodsData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.cogsMaterials / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                            ))}
                          </div>
                        )}
                        {periodsData.some(p => p.cogsCommissions > 0) && (
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                            <div style={{ color: '#64748b', paddingLeft: '20px' }}>COGS - Commissions</div>
                            {periodsData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.cogsCommissions / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                            ))}
                          </div>
                        )}
                        {periodsData.some(p => p.cogsOther > 0) && (
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                            <div style={{ color: '#64748b', paddingLeft: '20px' }}>COGS - Other</div>
                            {periodsData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.cogsOther / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                            ))}
                          </div>
                        )}
                        <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '6px 0', fontSize: '14px', fontWeight: '600', borderTop: '1px solid #cbd5e1', marginTop: '4px' }}>
                          <div style={{ color: '#475569' }}>Total COGS</div>
                          {periodsData.map((p, i) => (
                            <div key={i} style={{ textAlign: 'right', color: '#475569' }}>${(p.cogs / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                          ))}
                        </div>
                        
                        {/* Gross Profit */}
                        <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '10px 8px', background: '#dbeafe', borderRadius: '4px', marginTop: '8px', fontWeight: '700' }}>
                          <div style={{ color: '#1e40af' }}>Gross Profit</div>
                          {periodsData.map((p, i) => (
                            <div key={i} style={{ textAlign: 'right', color: '#1e40af' }}>${(p.grossProfit / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                          ))}
                        </div>
                        
                        {/* Operating Expenses Section Header */}
                        <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '12px 0 4px 0', fontSize: '14px', fontWeight: '600', marginTop: '12px' }}>
                          <div style={{ color: '#475569' }}>Operating Expenses</div>
                          {periodsData.map((p, i) => <div key={i}></div>)}
                        </div>
                        
                        {/* Operating Expenses Details */}
                        {periodsData.some(p => p.opexPayroll > 0) && (
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                            <div style={{ color: '#64748b', paddingLeft: '20px' }}>Payroll</div>
                            {periodsData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.opexPayroll / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                            ))}
                          </div>
                        )}
                        {periodsData.some(p => p.ownersBasePay > 0) && (
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                            <div style={{ color: '#64748b', paddingLeft: '20px' }}>Owner's Base Pay</div>
                            {periodsData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.ownersBasePay / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                            ))}
                          </div>
                        )}
                        {periodsData.some(p => p.ownersRetirement > 0) && (
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                            <div style={{ color: '#64748b', paddingLeft: '20px' }}>Owner's Retirement</div>
                            {periodsData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.ownersRetirement / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                            ))}
                          </div>
                        )}
                        {periodsData.some(p => p.professionalServices > 0) && (
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                            <div style={{ color: '#64748b', paddingLeft: '20px' }}>Professional Services</div>
                            {periodsData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.professionalServices / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                            ))}
                          </div>
                        )}
                        {periodsData.some(p => p.rentLease > 0) && (
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                            <div style={{ color: '#64748b', paddingLeft: '20px' }}>Rent/Lease</div>
                            {periodsData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.rentLease / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                            ))}
                          </div>
                        )}
                        {periodsData.some(p => p.utilities > 0) && (
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                            <div style={{ color: '#64748b', paddingLeft: '20px' }}>Utilities</div>
                            {periodsData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.utilities / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                            ))}
                          </div>
                        )}
                        {periodsData.some(p => p.equipment > 0) && (
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                            <div style={{ color: '#64748b', paddingLeft: '20px' }}>Equipment</div>
                            {periodsData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.equipment / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                            ))}
                          </div>
                        )}
                        {periodsData.some(p => p.travel > 0) && (
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                            <div style={{ color: '#64748b', paddingLeft: '20px' }}>Travel</div>
                            {periodsData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.travel / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                            ))}
                          </div>
                        )}
                        {periodsData.some(p => p.insurance > 0) && (
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                            <div style={{ color: '#64748b', paddingLeft: '20px' }}>Insurance</div>
                            {periodsData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.insurance / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                            ))}
                          </div>
                        )}
                        {periodsData.some(p => p.opexSalesMarketing > 0) && (
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                            <div style={{ color: '#64748b', paddingLeft: '20px' }}>Sales & Marketing</div>
                            {periodsData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.opexSalesMarketing / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                            ))}
                          </div>
                        )}
                        {periodsData.some(p => p.contractorsDistribution > 0) && (
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                            <div style={{ color: '#64748b', paddingLeft: '20px' }}>Contractors - Distribution</div>
                            {periodsData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.contractorsDistribution / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                            ))}
                          </div>
                        )}
                        {periodsData.some(p => p.depreciationExpense > 0) && (
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                            <div style={{ color: '#64748b', paddingLeft: '20px' }}>Depreciation & Amortization</div>
                            {periodsData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.depreciationExpense / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                            ))}
                          </div>
                        )}
                        {periodsData.some(p => p.opexOther > 0) && (
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                            <div style={{ color: '#64748b', paddingLeft: '20px' }}>Other Operating Expenses</div>
                            {periodsData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.opexOther / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                            ))}
                          </div>
                        )}
                        <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '6px 0', fontSize: '14px', fontWeight: '600', borderTop: '1px solid #cbd5e1', marginTop: '4px' }}>
                          <div style={{ color: '#475569' }}>Total Operating Expenses</div>
                          {periodsData.map((p, i) => (
                            <div key={i} style={{ textAlign: 'right', color: '#475569' }}>${(p.totalOpex / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                          ))}
                        </div>
                        
                        {/* Operating Income */}
                        <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '10px 8px', background: '#dbeafe', borderRadius: '4px', marginTop: '8px', fontWeight: '700' }}>
                          <div style={{ color: '#1e40af' }}>Operating Income</div>
                          {periodsData.map((p, i) => (
                            <div key={i} style={{ textAlign: 'right', color: '#1e40af' }}>${(p.operatingIncome / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                          ))}
                        </div>
                        
                        {/* Other Income/Expense Section */}
                        {periodsData.some(p => p.interestExpense > 0 || p.nonOperatingIncome > 0 || p.extraordinaryItems !== 0) && (
                          <>
                            <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '12px 0 4px 0', fontSize: '14px', fontWeight: '600', marginTop: '12px' }}>
                              <div style={{ color: '#475569' }}>Other Income/(Expense)</div>
                              {periodsData.map((p, i) => <div key={i}></div>)}
                            </div>
                            {periodsData.some(p => p.interestExpense > 0) && (
                              <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                                <div style={{ color: '#64748b', paddingLeft: '20px' }}>Interest Expense</div>
                                {periodsData.map((p, i) => (
                                  <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>(${ (p.interestExpense / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K)</div>
                                ))}
                              </div>
                            )}
                            {periodsData.some(p => p.nonOperatingIncome > 0) && (
                              <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                                <div style={{ color: '#64748b', paddingLeft: '20px' }}>Non-Operating Income</div>
                                {periodsData.map((p, i) => (
                                  <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>${(p.nonOperatingIncome / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                                ))}
                              </div>
                            )}
                            {periodsData.some(p => p.extraordinaryItems !== 0) && (
                              <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                                <div style={{ color: '#64748b', paddingLeft: '20px' }}>Extraordinary Items</div>
                                {periodsData.map((p, i) => (
                                  <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>
                                    {p.extraordinaryItems >= 0 ? '$' : '($'}{(Math.abs(p.extraordinaryItems) / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K{p.extraordinaryItems < 0 ? ')' : ''}
                                  </div>
                                ))}
                              </div>
                            )}
                          </>
                        )}
                        
                        {/* Net Income */}
                        <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 110px)`, gap: '4px', padding: '12px 8px', background: '#dcfce7', borderRadius: '4px', marginTop: '12px', fontWeight: '700', fontSize: '15px' }}>
                          <div style={{ color: '#166534' }}>Net Income</div>
                          {periodsData.map((p, i) => (
                            <div key={i} style={{ textAlign: 'right', color: p.netIncome >= 0 ? '#166534' : '#991b1b' }}>
                              {p.netIncome >= 0 ? '$' : '($'}{(Math.abs(p.netIncome) / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K{p.netIncome < 0 ? ')' : ''}
                            </div>
                          ))}
                        </div>
                      </div>
                    </div>
                  );
                }
                
                // Single period aggregation (original logic)
                const revenue = periodMonths.reduce((sum, m) => sum + (m.revenue || 0), 0);
                
                const cogsPayroll = periodMonths.reduce((sum, m) => sum + (m.cogsPayroll || 0), 0);
                const cogsOwnerPay = periodMonths.reduce((sum, m) => sum + (m.cogsOwnerPay || 0), 0);
                const cogsContractors = periodMonths.reduce((sum, m) => sum + (m.cogsContractors || 0), 0);
                const cogsMaterials = periodMonths.reduce((sum, m) => sum + (m.cogsMaterials || 0), 0);
                const cogsCommissions = periodMonths.reduce((sum, m) => sum + (m.cogsCommissions || 0), 0);
                const cogsOther = periodMonths.reduce((sum, m) => sum + (m.cogsOther || 0), 0);
                const cogs = cogsPayroll + cogsOwnerPay + cogsContractors + cogsMaterials + cogsCommissions + cogsOther;
                
                const grossProfit = revenue - cogs;
                const grossMargin = revenue > 0 ? (grossProfit / revenue) * 100 : 0;
                
                const opexPayroll = periodMonths.reduce((sum, m) => sum + (m.opexPayroll || 0), 0);
                const ownersBasePay = periodMonths.reduce((sum, m) => sum + (m.ownersBasePay || 0), 0);
                const ownersRetirement = periodMonths.reduce((sum, m) => sum + (m.ownersRetirement || 0), 0);
                const professionalServices = periodMonths.reduce((sum, m) => sum + (m.professionalServices || 0), 0);
                const rentLease = periodMonths.reduce((sum, m) => sum + (m.rentLease || 0), 0);
                const utilities = periodMonths.reduce((sum, m) => sum + (m.utilities || 0), 0);
                const equipment = periodMonths.reduce((sum, m) => sum + (m.equipment || 0), 0);
                const travel = periodMonths.reduce((sum, m) => sum + (m.travel || 0), 0);
                const insurance = periodMonths.reduce((sum, m) => sum + (m.insurance || 0), 0);
                const opexSalesMarketing = periodMonths.reduce((sum, m) => sum + (m.opexSalesMarketing || 0), 0);
                const contractorsDistribution = periodMonths.reduce((sum, m) => sum + (m.contractorsDistribution || 0), 0);
                const depreciationExpense = periodMonths.reduce((sum, m) => sum + (m.depreciationExpense || 0), 0);
                const opexOther = periodMonths.reduce((sum, m) => sum + (m.opexOther || 0), 0);
                
                const totalOpex = opexPayroll + ownersBasePay + ownersRetirement + professionalServices + 
                                 rentLease + utilities + equipment + travel + insurance + 
                                 opexSalesMarketing + contractorsDistribution + depreciationExpense + opexOther;
                
                const operatingIncome = grossProfit - totalOpex;
                const operatingMargin = revenue > 0 ? (operatingIncome / revenue) * 100 : 0;
                
                const interestExpense = periodMonths.reduce((sum, m) => sum + (m.interestExpense || 0), 0);
                const nonOperatingIncome = periodMonths.reduce((sum, m) => sum + (m.nonOperatingIncome || 0), 0);
                const extraordinaryItems = periodMonths.reduce((sum, m) => sum + (m.extraordinaryItems || 0), 0);
                
                const netIncome = operatingIncome - interestExpense + nonOperatingIncome + extraordinaryItems;
                const netMargin = revenue > 0 ? (netIncome / revenue) * 100 : 0;
                
                return (
                  <div style={{ background: 'white', borderRadius: '12px', padding: '32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                      <div style={{ marginBottom: '32px', borderBottom: '2px solid #e2e8f0', paddingBottom: '16px' }}>
                        <h2 style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b', marginBottom: '4px' }}>Income Statement</h2>
                        <div style={{ fontSize: '14px', color: '#64748b' }}>For the Period: {periodLabel}</div>
                      </div>

                      {/* Revenue Section */}
                      <div style={{ marginBottom: '12px' }}>
                        <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0', borderBottom: '1px solid #e2e8f0' }}>
                          <span style={{ fontWeight: '600', color: '#1e293b' }}>Revenue</span>
                          <span style={{ fontWeight: '600', color: '#1e293b' }}>${revenue.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                      </div>

                      {/* COGS Section */}
                      <div style={{ marginBottom: '12px' }}>
                        <div style={{ fontWeight: '600', color: '#1e293b', marginBottom: '8px' }}>Cost of Goods Sold</div>
                        {cogsPayroll > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>COGS - Payroll</span>
                            <span style={{ color: '#475569' }}>${cogsPayroll.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {cogsOwnerPay > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>COGS - Owner Pay</span>
                            <span style={{ color: '#475569' }}>${cogsOwnerPay.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {cogsContractors > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>COGS - Contractors</span>
                            <span style={{ color: '#475569' }}>${cogsContractors.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {cogsMaterials > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>COGS - Materials</span>
                            <span style={{ color: '#475569' }}>${cogsMaterials.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {cogsCommissions > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>COGS - Commissions</span>
                            <span style={{ color: '#475569' }}>${cogsCommissions.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {cogsOther > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>COGS - Other</span>
                            <span style={{ color: '#475569' }}>${cogsOther.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0', borderTop: '1px solid #e2e8f0', marginTop: '4px' }}>
                          <span style={{ fontWeight: '600', color: '#1e293b' }}>Total COGS</span>
                          <span style={{ fontWeight: '600', color: '#1e293b' }}>${cogs.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                      </div>

                      {/* Gross Profit */}
                      <div style={{ marginBottom: '12px', background: '#dbeafe', padding: '12px', borderRadius: '8px' }}>
                        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '4px' }}>
                          <span style={{ fontWeight: '700', color: '#1e40af' }}>Gross Profit</span>
                          <span style={{ fontWeight: '700', color: '#1e40af' }}>${grossProfit.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                        <div style={{ fontSize: '13px', color: '#1e40af', textAlign: 'right' }}>
                          {grossMargin.toFixed(1)}% margin
                        </div>
                      </div>

                      {/* Operating Expenses */}
                      <div style={{ marginBottom: '12px' }}>
                        <div style={{ fontWeight: '600', color: '#1e293b', marginBottom: '8px' }}>Operating Expenses</div>
                        {opexPayroll > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Payroll</span>
                            <span style={{ color: '#475569' }}>${opexPayroll.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {ownersBasePay > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Owner's Base Pay</span>
                            <span style={{ color: '#475569' }}>${ownersBasePay.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {ownersRetirement > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Owner's Retirement</span>
                            <span style={{ color: '#475569' }}>${ownersRetirement.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {professionalServices > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Professional Services</span>
                            <span style={{ color: '#475569' }}>${professionalServices.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {rentLease > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Rent/Lease</span>
                            <span style={{ color: '#475569' }}>${rentLease.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {utilities > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Utilities</span>
                            <span style={{ color: '#475569' }}>${utilities.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {equipment > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Equipment</span>
                            <span style={{ color: '#475569' }}>${equipment.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {travel > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Travel</span>
                            <span style={{ color: '#475569' }}>${travel.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {insurance > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Insurance</span>
                            <span style={{ color: '#475569' }}>${insurance.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {opexSalesMarketing > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Sales & Marketing</span>
                            <span style={{ color: '#475569' }}>${opexSalesMarketing.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {contractorsDistribution > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Contractors - Distribution</span>
                            <span style={{ color: '#475569' }}>${contractorsDistribution.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {depreciationExpense > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Depreciation & Amortization</span>
                            <span style={{ color: '#475569' }}>${depreciationExpense.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {opexOther > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Other Operating Expenses</span>
                            <span style={{ color: '#475569' }}>${opexOther.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0', borderTop: '1px solid #e2e8f0', marginTop: '4px' }}>
                          <span style={{ fontWeight: '600', color: '#1e293b' }}>Total Operating Expenses</span>
                          <span style={{ fontWeight: '600', color: '#1e293b' }}>${totalOpex.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                      </div>

                      {/* Operating Income */}
                      <div style={{ marginBottom: '12px', background: '#dbeafe', padding: '12px', borderRadius: '8px' }}>
                        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '4px' }}>
                          <span style={{ fontWeight: '700', color: '#1e40af' }}>Operating Income</span>
                          <span style={{ fontWeight: '700', color: '#1e40af' }}>${operatingIncome.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                        <div style={{ fontSize: '13px', color: '#1e40af', textAlign: 'right' }}>
                          {operatingMargin.toFixed(1)}% operating margin
                        </div>
                      </div>

                      {/* Other Income/Expense */}
                      <div style={{ marginBottom: '12px' }}>
                        <div style={{ fontWeight: '600', color: '#1e293b', marginBottom: '8px' }}>Other Income/(Expense)</div>
                        {interestExpense > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Interest Expense</span>
                            <span style={{ color: '#475569' }}>(${ interestExpense.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })})</span>
                          </div>
                        )}
                        {nonOperatingIncome > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Non-Operating Income</span>
                            <span style={{ color: '#475569' }}>${nonOperatingIncome.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {extraordinaryItems !== 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '6px 0 6px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#475569' }}>Extraordinary Items</span>
                            <span style={{ color: '#475569' }}>{extraordinaryItems >= 0 ? '$' : '($'}{Math.abs(extraordinaryItems).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}{extraordinaryItems < 0 ? ')' : ''}</span>
                          </div>
                        )}
                      </div>

                      {/* Net Income */}
                      <div style={{ background: netIncome >= 0 ? '#dcfce7' : '#fee2e2', padding: '16px', borderRadius: '8px', marginTop: '24px' }}>
                        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '4px' }}>
                          <span style={{ fontWeight: '700', fontSize: '18px', color: netIncome >= 0 ? '#166534' : '#991b1b' }}>Net Income</span>
                          <span style={{ fontWeight: '700', fontSize: '18px', color: netIncome >= 0 ? '#166534' : '#991b1b' }}>
                            {netIncome >= 0 ? '$' : '($'}{Math.abs(netIncome).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}{netIncome < 0 ? ')' : ''}
                          </span>
                        </div>
                        <div style={{ fontSize: '14px', color: netIncome >= 0 ? '#166534' : '#991b1b', textAlign: 'right' }}>
                          {netMargin.toFixed(1)}% net margin
                        </div>
                      </div>
                  </div>
                );
              }
              
              // COMMON SIZE INCOME STATEMENT - Aggregate with percentages
              else if (statementType === 'income-statement-percent') {
                // Check if showing multiple periods side-by-side
                if (displayPeriods.length > 1) {
                  const calc = (months: any[], field: string) => months.reduce((sum, m) => sum + (m[field] || 0), 0);
                  const periodsData = displayPeriods.map(p => {
                    const m = p.months;
                    const revenue = calc(m, 'revenue');
                    const cogsPayroll = calc(m, 'cogsPayroll');
                    const cogsOwnerPay = calc(m, 'cogsOwnerPay');
                    const cogsContractors = calc(m, 'cogsContractors');
                    const cogsMaterials = calc(m, 'cogsMaterials');
                    const cogsCommissions = calc(m, 'cogsCommissions');
                    const cogsOther = calc(m, 'cogsOther');
                    const opexPayroll = calc(m, 'opexPayroll');
                    const ownersBasePay = calc(m, 'ownersBasePay');
                    const ownersRetirement = calc(m, 'ownersRetirement');
                    const professionalServices = calc(m, 'professionalServices');
                    const rentLease = calc(m, 'rentLease');
                    const utilities = calc(m, 'utilities');
                    const equipment = calc(m, 'equipment');
                    const travel = calc(m, 'travel');
                    const insurance = calc(m, 'insurance');
                    const opexSalesMarketing = calc(m, 'opexSalesMarketing');
                    const contractorsDistribution = calc(m, 'contractorsDistribution');
                    const depreciationExpense = calc(m, 'depreciationExpense');
                    const opexOther = calc(m, 'opexOther');
                    const interestExpense = calc(m, 'interestExpense');
                    const nonOperatingIncome = calc(m, 'nonOperatingIncome');
                    const extraordinaryItems = calc(m, 'extraordinaryItems');
                    const cogs = cogsPayroll + cogsOwnerPay + cogsContractors + cogsMaterials + cogsCommissions + cogsOther;
                    const totalOpex = opexPayroll + ownersBasePay + ownersRetirement + professionalServices + rentLease + utilities + equipment + travel + insurance + opexSalesMarketing + contractorsDistribution + depreciationExpense + opexOther;
                    const grossProfit = revenue - cogs;
                    const operatingIncome = grossProfit - totalOpex;
                    const netIncome = operatingIncome - interestExpense + nonOperatingIncome + extraordinaryItems;
                    return { label: p.label, revenue, cogsPayroll, cogsOwnerPay, cogsContractors, cogsMaterials, cogsCommissions, cogsOther, cogs, grossProfit, opexPayroll, ownersBasePay, ownersRetirement, professionalServices, rentLease, utilities, equipment, travel, insurance, opexSalesMarketing, contractorsDistribution, depreciationExpense, opexOther, totalOpex, operatingIncome, interestExpense, nonOperatingIncome, extraordinaryItems, netIncome };
                  });
                  const RowWithPercent = ({ label, values, indent = 0, bold = false }: any) => (
                    <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 90px 60px)`, gap: '4px', padding: '4px 0', fontSize: bold ? '14px' : '13px', fontWeight: bold ? '600' : 'normal' }}>
                      <div style={{ color: bold ? '#475569' : '#64748b', paddingLeft: `${indent}px` }}>{label}</div>
                      {values.map((v: number, i: number) => {
                        const pct = periodsData[i].revenue > 0 ? (v / periodsData[i].revenue) * 100 : 0;
                        return (
                          <div key={i} style={{ display: 'contents' }}>
                            <div style={{ textAlign: 'right', color: bold ? '#475569' : '#64748b' }}>${(v / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                            <div style={{ textAlign: 'right', color: '#64748b', fontSize: '12px' }}>{pct.toFixed(1)}%</div>
                          </div>
                        );
                      })}
                    </div>
                  );
                  return (
                    <div style={{ background: 'white', borderRadius: '12px', padding: '32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', overflowX: 'auto' }}>
                      <div style={{ marginBottom: '12px', borderBottom: '2px solid #e2e8f0', paddingBottom: '16px' }}>
                        <h2 style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b', marginBottom: '4px' }}>Comparative Common Size Income Statement</h2>
                        <div style={{ fontSize: '14px', color: '#64748b' }}>{periodLabel} - {statementDisplay === 'monthly' ? 'Monthly' : statementDisplay === 'quarterly' ? 'Quarterly' : 'Annual'}</div>
                      </div>
                      <div style={{ minWidth: `${200 + (periodsData.length * 150)}px` }}>
                        <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 90px 60px)`, gap: '4px', padding: '12px 0', borderBottom: '2px solid #1e293b', fontWeight: '600', color: '#1e293b' }}>
                          <div>Line Item</div>
                          {periodsData.map((p, i) => (
                            <div key={i} style={{ display: 'contents' }}>
                              <div style={{ textAlign: 'right' }}>{p.label}</div>
                              <div style={{ textAlign: 'right', fontSize: '12px' }}>% of Rev</div>
                            </div>
                          ))}
                        </div>
                        <RowWithPercent label="Revenue" values={periodsData.map(p => p.revenue)} bold />
                        <div style={{ margin: '8px 0 4px', fontSize: '14px', fontWeight: '600', color: '#475569' }}>Cost of Goods Sold</div>
                        {periodsData.some(p => p.cogsPayroll > 0) && <RowWithPercent label="COGS - Payroll" values={periodsData.map(p => p.cogsPayroll)} indent={20} />}
                        {periodsData.some(p => p.cogsOwnerPay > 0) && <RowWithPercent label="COGS - Owner Pay" values={periodsData.map(p => p.cogsOwnerPay)} indent={20} />}
                        {periodsData.some(p => p.cogsContractors > 0) && <RowWithPercent label="COGS - Contractors" values={periodsData.map(p => p.cogsContractors)} indent={20} />}
                        {periodsData.some(p => p.cogsMaterials > 0) && <RowWithPercent label="COGS - Materials" values={periodsData.map(p => p.cogsMaterials)} indent={20} />}
                        {periodsData.some(p => p.cogsCommissions > 0) && <RowWithPercent label="COGS - Commissions" values={periodsData.map(p => p.cogsCommissions)} indent={20} />}
                        {periodsData.some(p => p.cogsOther > 0) && <RowWithPercent label="COGS - Other" values={periodsData.map(p => p.cogsOther)} indent={20} />}
                        <RowWithPercent label="Total COGS" values={periodsData.map(p => p.cogs)} bold />
                        <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 90px 60px)`, gap: '4px', padding: '10px 8px', background: '#dbeafe', borderRadius: '4px', margin: '8px 0', fontWeight: '700', color: '#1e40af' }}>
                          <div>Gross Profit</div>
                          {periodsData.map((p, i) => {
                            const pct = p.revenue > 0 ? (p.grossProfit / p.revenue) * 100 : 0;
                            return (
                              <div key={i} style={{ display: 'contents' }}>
                                <div style={{ textAlign: 'right' }}>${(p.grossProfit / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                                <div style={{ textAlign: 'right', fontSize: '12px' }}>{pct.toFixed(1)}%</div>
                              </div>
                            );
                          })}
                        </div>
                        <div style={{ margin: '12px 0 4px', fontSize: '14px', fontWeight: '600', color: '#475569' }}>Operating Expenses</div>
                        {periodsData.some(p => p.opexPayroll > 0) && <RowWithPercent label="Payroll" values={periodsData.map(p => p.opexPayroll)} indent={20} />}
                        {periodsData.some(p => p.ownersBasePay > 0) && <RowWithPercent label="Owner's Base Pay" values={periodsData.map(p => p.ownersBasePay)} indent={20} />}
                        {periodsData.some(p => p.ownersRetirement > 0) && <RowWithPercent label="Owner's Retirement" values={periodsData.map(p => p.ownersRetirement)} indent={20} />}
                        {periodsData.some(p => p.professionalServices > 0) && <RowWithPercent label="Professional Services" values={periodsData.map(p => p.professionalServices)} indent={20} />}
                        {periodsData.some(p => p.rentLease > 0) && <RowWithPercent label="Rent/Lease" values={periodsData.map(p => p.rentLease)} indent={20} />}
                        {periodsData.some(p => p.utilities > 0) && <RowWithPercent label="Utilities" values={periodsData.map(p => p.utilities)} indent={20} />}
                        {periodsData.some(p => p.equipment > 0) && <RowWithPercent label="Equipment" values={periodsData.map(p => p.equipment)} indent={20} />}
                        {periodsData.some(p => p.travel > 0) && <RowWithPercent label="Travel" values={periodsData.map(p => p.travel)} indent={20} />}
                        {periodsData.some(p => p.insurance > 0) && <RowWithPercent label="Insurance" values={periodsData.map(p => p.insurance)} indent={20} />}
                        {periodsData.some(p => p.opexSalesMarketing > 0) && <RowWithPercent label="Sales & Marketing" values={periodsData.map(p => p.opexSalesMarketing)} indent={20} />}
                        {periodsData.some(p => p.contractorsDistribution > 0) && <RowWithPercent label="Contractors - Distribution" values={periodsData.map(p => p.contractorsDistribution)} indent={20} />}
                        {periodsData.some(p => p.depreciationExpense > 0) && <RowWithPercent label="Depreciation & Amortization" values={periodsData.map(p => p.depreciationExpense)} indent={20} />}
                        {periodsData.some(p => p.opexOther > 0) && <RowWithPercent label="Other Operating Expenses" values={periodsData.map(p => p.opexOther)} indent={20} />}
                        <RowWithPercent label="Total Operating Expenses" values={periodsData.map(p => p.totalOpex)} bold />
                        <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 90px 60px)`, gap: '4px', padding: '10px 8px', background: '#dbeafe', borderRadius: '4px', margin: '8px 0', fontWeight: '700', color: '#1e40af' }}>
                          <div>Operating Income</div>
                          {periodsData.map((p, i) => {
                            const pct = p.revenue > 0 ? (p.operatingIncome / p.revenue) * 100 : 0;
                            return (
                              <div key={i} style={{ display: 'contents' }}>
                                <div style={{ textAlign: 'right' }}>${(p.operatingIncome / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                                <div style={{ textAlign: 'right', fontSize: '12px' }}>{pct.toFixed(1)}%</div>
                              </div>
                            );
                          })}
                        </div>
                        {periodsData.some(p => p.interestExpense > 0 || p.nonOperatingIncome > 0 || p.extraordinaryItems !== 0) && (
                          <>
                            <div style={{ margin: '12px 0 4px', fontSize: '14px', fontWeight: '600', color: '#475569' }}>Other Income/(Expense)</div>
                            {periodsData.some(p => p.interestExpense > 0) && <RowWithPercent label="Interest Expense" values={periodsData.map(p => -p.interestExpense)} indent={20} />}
                            {periodsData.some(p => p.nonOperatingIncome > 0) && <RowWithPercent label="Non-Operating Income" values={periodsData.map(p => p.nonOperatingIncome)} indent={20} />}
                            {periodsData.some(p => p.extraordinaryItems !== 0) && <RowWithPercent label="Extraordinary Items" values={periodsData.map(p => p.extraordinaryItems)} indent={20} />}
                          </>
                        )}
                        <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${periodsData.length}, 90px 60px)`, gap: '4px', padding: '12px 8px', background: '#dcfce7', borderRadius: '4px', margin: '12px 0 0', fontWeight: '700', fontSize: '15px' }}>
                          <div style={{ color: '#166534' }}>Net Income</div>
                          {periodsData.map((p, i) => {
                            const pct = p.revenue > 0 ? (p.netIncome / p.revenue) * 100 : 0;
                            return (
                              <div key={i} style={{ display: 'contents' }}>
                                <div style={{ textAlign: 'right', color: p.netIncome >= 0 ? '#166534' : '#991b1b' }}>
                                  {p.netIncome >= 0 ? '$' : '($'}{(Math.abs(p.netIncome) / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K{p.netIncome < 0 ? ')' : ''}
                                </div>
                                <div style={{ textAlign: 'right', fontSize: '12px', color: p.netIncome >= 0 ? '#166534' : '#991b1b' }}>{pct.toFixed(1)}%</div>
                              </div>
                            );
                          })}
                        </div>
                      </div>
                    </div>
                  );
                }
                
                const revenue = periodMonths.reduce((sum, m) => sum + (m.revenue || 0), 0);
                
                const cogsPayroll = periodMonths.reduce((sum, m) => sum + (m.cogsPayroll || 0), 0);
                const cogsOwnerPay = periodMonths.reduce((sum, m) => sum + (m.cogsOwnerPay || 0), 0);
                const cogsContractors = periodMonths.reduce((sum, m) => sum + (m.cogsContractors || 0), 0);
                const cogsMaterials = periodMonths.reduce((sum, m) => sum + (m.cogsMaterials || 0), 0);
                const cogsCommissions = periodMonths.reduce((sum, m) => sum + (m.cogsCommissions || 0), 0);
                const cogsOther = periodMonths.reduce((sum, m) => sum + (m.cogsOther || 0), 0);
                const cogs = cogsPayroll + cogsOwnerPay + cogsContractors + cogsMaterials + cogsCommissions + cogsOther;
                
                const grossProfit = revenue - cogs;
                
                const opexPayroll = periodMonths.reduce((sum, m) => sum + (m.opexPayroll || 0), 0);
                const ownersBasePay = periodMonths.reduce((sum, m) => sum + (m.ownersBasePay || 0), 0);
                const ownersRetirement = periodMonths.reduce((sum, m) => sum + (m.ownersRetirement || 0), 0);
                const professionalServices = periodMonths.reduce((sum, m) => sum + (m.professionalServices || 0), 0);
                const rentLease = periodMonths.reduce((sum, m) => sum + (m.rentLease || 0), 0);
                const utilities = periodMonths.reduce((sum, m) => sum + (m.utilities || 0), 0);
                const equipment = periodMonths.reduce((sum, m) => sum + (m.equipment || 0), 0);
                const travel = periodMonths.reduce((sum, m) => sum + (m.travel || 0), 0);
                const insurance = periodMonths.reduce((sum, m) => sum + (m.insurance || 0), 0);
                const opexSalesMarketing = periodMonths.reduce((sum, m) => sum + (m.opexSalesMarketing || 0), 0);
                const contractorsDistribution = periodMonths.reduce((sum, m) => sum + (m.contractorsDistribution || 0), 0);
                const depreciationExpense = periodMonths.reduce((sum, m) => sum + (m.depreciationExpense || 0), 0);
                const opexOther = periodMonths.reduce((sum, m) => sum + (m.opexOther || 0), 0);
                
                const totalOpex = opexPayroll + ownersBasePay + ownersRetirement + professionalServices + 
                                 rentLease + utilities + equipment + travel + insurance + 
                                 opexSalesMarketing + contractorsDistribution + depreciationExpense + opexOther;
                
                const operatingIncome = grossProfit - totalOpex;
                
                const interestExpense = periodMonths.reduce((sum, m) => sum + (m.interestExpense || 0), 0);
                const nonOperatingIncome = periodMonths.reduce((sum, m) => sum + (m.nonOperatingIncome || 0), 0);
                const extraordinaryItems = periodMonths.reduce((sum, m) => sum + (m.extraordinaryItems || 0), 0);
                
                const netIncome = operatingIncome - interestExpense + nonOperatingIncome + extraordinaryItems;
                
                const calcPercent = (value: number) => revenue > 0 ? ((value / revenue) * 100).toFixed(1) + '%' : '0.0%';
                
                return (
                  <div style={{ background: 'white', borderRadius: '12px', padding: '32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                      <div style={{ marginBottom: '32px', borderBottom: '2px solid #e2e8f0', paddingBottom: '16px' }}>
                        <h2 style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b', marginBottom: '4px' }}>Common Size Income Statement</h2>
                        <div style={{ fontSize: '14px', color: '#64748b' }}>For the Period: {periodLabel}</div>
                      </div>

                      {/* Header Row */}
                      <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '12px 0', borderBottom: '2px solid #1e293b', marginBottom: '16px', fontWeight: '600', color: '#1e293b' }}>
                        <div>Line Item</div>
                        <div style={{ textAlign: 'right' }}>Amount</div>
                        <div style={{ textAlign: 'right' }}>% of Revenue</div>
                      </div>

                      {/* Revenue */}
                      <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '8px 0', borderBottom: '1px solid #e2e8f0', fontWeight: '600' }}>
                        <div style={{ color: '#1e293b' }}>Revenue</div>
                        <div style={{ textAlign: 'right', color: '#1e293b' }}>${revenue.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                        <div style={{ textAlign: 'right', color: '#1e293b' }}>100.0%</div>
                      </div>

                      {/* COGS */}
                      <div style={{ marginTop: '16px' }}>
                        <div style={{ fontWeight: '600', color: '#475569', marginBottom: '8px', fontSize: '14px' }}>Cost of Goods Sold</div>
                        {cogsPayroll > 0 && (
                          <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                            <div style={{ color: '#64748b' }}>COGS - Payroll</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>${cogsPayroll.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(cogsPayroll)}</div>
                          </div>
                        )}
                        {cogsOwnerPay > 0 && (
                          <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                            <div style={{ color: '#64748b' }}>COGS - Owner Pay</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>${cogsOwnerPay.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(cogsOwnerPay)}</div>
                          </div>
                        )}
                        {cogsContractors > 0 && (
                          <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                            <div style={{ color: '#64748b' }}>COGS - Contractors</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>${cogsContractors.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(cogsContractors)}</div>
                          </div>
                        )}
                        {cogsMaterials > 0 && (
                          <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                            <div style={{ color: '#64748b' }}>COGS - Materials</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>${cogsMaterials.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(cogsMaterials)}</div>
                          </div>
                        )}
                        {cogsCommissions > 0 && (
                          <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                            <div style={{ color: '#64748b' }}>COGS - Commissions</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>${cogsCommissions.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(cogsCommissions)}</div>
                          </div>
                        )}
                        {cogsOther > 0 && (
                          <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                            <div style={{ color: '#64748b' }}>COGS - Other</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>${cogsOther.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(cogsOther)}</div>
                          </div>
                        )}
                        <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '8px 0', borderTop: '1px solid #cbd5e1', marginTop: '4px', fontWeight: '600' }}>
                          <div style={{ color: '#475569' }}>Total COGS</div>
                          <div style={{ textAlign: 'right', color: '#475569' }}>${cogs.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                          <div style={{ textAlign: 'right', color: '#475569' }}>{calcPercent(cogs)}</div>
                        </div>
                      </div>

                      {/* Gross Profit */}
                      <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '12px 8px', background: '#dbeafe', borderRadius: '6px', margin: '16px 0', fontWeight: '700', color: '#1e40af' }}>
                        <div>Gross Profit</div>
                        <div style={{ textAlign: 'right' }}>${grossProfit.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                        <div style={{ textAlign: 'right' }}>{calcPercent(grossProfit)}</div>
                      </div>

                      {/* Operating Expenses */}
                      <div style={{ marginTop: '16px' }}>
                        <div style={{ fontWeight: '600', color: '#475569', marginBottom: '8px', fontSize: '14px' }}>Operating Expenses</div>
                        {opexPayroll > 0 && (
                          <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                            <div style={{ color: '#64748b' }}>Payroll</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>${opexPayroll.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(opexPayroll)}</div>
                          </div>
                        )}
                        {ownersBasePay > 0 && (
                          <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                            <div style={{ color: '#64748b' }}>Owner's Base Pay</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>${ownersBasePay.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(ownersBasePay)}</div>
                          </div>
                        )}
                        {ownersRetirement > 0 && (
                          <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                            <div style={{ color: '#64748b' }}>Owner's Retirement</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>${ownersRetirement.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(ownersRetirement)}</div>
                          </div>
                        )}
                        {professionalServices > 0 && (
                          <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                            <div style={{ color: '#64748b' }}>Professional Services</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>${professionalServices.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(professionalServices)}</div>
                          </div>
                        )}
                        {rentLease > 0 && (
                          <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                            <div style={{ color: '#64748b' }}>Rent/Lease</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>${rentLease.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(rentLease)}</div>
                          </div>
                        )}
                        {utilities > 0 && (
                          <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                            <div style={{ color: '#64748b' }}>Utilities</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>${utilities.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(utilities)}</div>
                          </div>
                        )}
                        {equipment > 0 && (
                          <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                            <div style={{ color: '#64748b' }}>Equipment</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>${equipment.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(equipment)}</div>
                          </div>
                        )}
                        {travel > 0 && (
                          <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                            <div style={{ color: '#64748b' }}>Travel</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>${travel.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(travel)}</div>
                          </div>
                        )}
                        {insurance > 0 && (
                          <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                            <div style={{ color: '#64748b' }}>Insurance</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>${insurance.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(insurance)}</div>
                          </div>
                        )}
                        {opexSalesMarketing > 0 && (
                          <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                            <div style={{ color: '#64748b' }}>Sales & Marketing</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>${opexSalesMarketing.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(opexSalesMarketing)}</div>
                          </div>
                        )}
                        {contractorsDistribution > 0 && (
                          <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                            <div style={{ color: '#64748b' }}>Contractors - Distribution</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>${contractorsDistribution.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(contractorsDistribution)}</div>
                          </div>
                        )}
                        {depreciationExpense > 0 && (
                          <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                            <div style={{ color: '#64748b' }}>Depreciation & Amortization</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>${depreciationExpense.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(depreciationExpense)}</div>
                          </div>
                        )}
                        {opexOther > 0 && (
                          <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                            <div style={{ color: '#64748b' }}>Other Operating Expenses</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>${opexOther.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                            <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(opexOther)}</div>
                          </div>
                        )}
                        <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '8px 0', borderTop: '1px solid #cbd5e1', marginTop: '4px', fontWeight: '600' }}>
                          <div style={{ color: '#475569' }}>Total Operating Expenses</div>
                          <div style={{ textAlign: 'right', color: '#475569' }}>${totalOpex.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                          <div style={{ textAlign: 'right', color: '#475569' }}>{calcPercent(totalOpex)}</div>
                        </div>
                      </div>

                      {/* Operating Income */}
                      <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '12px 8px', background: '#dbeafe', borderRadius: '6px', margin: '16px 0', fontWeight: '700', color: '#1e40af' }}>
                        <div>Operating Income</div>
                        <div style={{ textAlign: 'right' }}>${operatingIncome.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                        <div style={{ textAlign: 'right' }}>{calcPercent(operatingIncome)}</div>
                      </div>

                      {/* Other Income/Expense */}
                      {(interestExpense > 0 || nonOperatingIncome > 0 || extraordinaryItems !== 0) && (
                        <div style={{ marginTop: '16px' }}>
                          <div style={{ fontWeight: '600', color: '#475569', marginBottom: '8px', fontSize: '14px' }}>Other Income/(Expense)</div>
                          {interestExpense > 0 && (
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                              <div style={{ color: '#64748b' }}>Interest Expense</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>(${ interestExpense.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })})</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>({calcPercent(interestExpense)})</div>
                            </div>
                          )}
                          {nonOperatingIncome > 0 && (
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                              <div style={{ color: '#64748b' }}>Non-Operating Income</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>${nonOperatingIncome.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>{calcPercent(nonOperatingIncome)}</div>
                            </div>
                          )}
                          {extraordinaryItems !== 0 && (
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '4px 0 4px 20px', fontSize: '13px' }}>
                              <div style={{ color: '#64748b' }}>Extraordinary Items</div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>
                                {extraordinaryItems >= 0 ? '$' : '($'}{Math.abs(extraordinaryItems).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}{extraordinaryItems < 0 ? ')' : ''}
                              </div>
                              <div style={{ textAlign: 'right', color: '#64748b' }}>
                                {extraordinaryItems >= 0 ? calcPercent(extraordinaryItems) : `(${calcPercent(Math.abs(extraordinaryItems))})`}
                              </div>
                            </div>
                          )}
                        </div>
                      )}

                      {/* Net Income */}
                      <div style={{ display: 'grid', gridTemplateColumns: '1fr 0.7fr 0.7fr', gap: '16px', padding: '16px 8px', background: netIncome >= 0 ? '#dcfce7' : '#fee2e2', borderRadius: '6px', marginTop: '24px', fontWeight: '700', fontSize: '16px', color: netIncome >= 0 ? '#166534' : '#991b1b' }}>
                        <div>Net Income</div>
                        <div style={{ textAlign: 'right' }}>
                          {netIncome >= 0 ? '$' : '($'}{Math.abs(netIncome).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}{netIncome < 0 ? ')' : ''}
                        </div>
                        <div style={{ textAlign: 'right' }}>{calcPercent(netIncome)}</div>
                      </div>
                  </div>
                );
              }
              
              // BALANCE SHEET - Latest point in time
              else if (statementType === 'balance-sheet') {
                // Check if showing multiple periods side-by-side
                if (displayPeriods.length > 1) {
                  const balanceData = displayPeriods.map(p => {
                    const latest = p.months[p.months.length - 1];
                    const cash = latest.cash || 0;
                    const ar = latest.ar || 0;
                    const inventory = latest.inventory || 0;
                    const otherCA = latest.otherCA || 0;
                    const tca = cash + ar + inventory + otherCA;
                    const fixedAssets = latest.fixedAssets || 0;
                    const intangibleAssets = latest.intangibleAssets || 0;
                    const otherNonCurrentAssets = latest.otherNonCurrentAssets || 0;
                    const nonCurrentAssets = fixedAssets + intangibleAssets + otherNonCurrentAssets;
                    const totalAssets = tca + nonCurrentAssets;
                    const ap = latest.ap || 0;
                    const shortTermDebt = latest.shortTermDebt || 0;
                    const currentPortionLTD = latest.currentPortionLTD || 0;
                    const otherCurrentLiabilities = latest.otherCurrentLiabilities || 0;
                    const totalCurrentLiabilities = ap + shortTermDebt + currentPortionLTD + otherCurrentLiabilities;
                    const ltd = latest.ltd || 0;
                    const otherLongTermLiabilities = latest.otherLongTermLiabilities || 0;
                    const totalLongTermLiabilities = ltd + otherLongTermLiabilities;
                    const totalLiabilities = totalCurrentLiabilities + totalLongTermLiabilities;
                    const paidInCapital = latest.paidInCapital || 0;
                    const retainedEarnings = latest.retainedEarnings || 0;
                    const totalEquity = paidInCapital + retainedEarnings;
                    return { label: p.label, cash, ar, inventory, otherCA, tca, fixedAssets, intangibleAssets, otherNonCurrentAssets, nonCurrentAssets, totalAssets, ap, shortTermDebt, currentPortionLTD, otherCurrentLiabilities, totalCurrentLiabilities, ltd, otherLongTermLiabilities, totalLongTermLiabilities, totalLiabilities, paidInCapital, retainedEarnings, totalEquity };
                  });
                  const Row = ({ label, values, indent = 0, bold = false }: any) => (
                    <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: bold ? '14px' : '13px', fontWeight: bold ? '600' : 'normal' }}>
                      <div style={{ color: bold ? '#475569' : '#64748b', paddingLeft: `${indent}px` }}>{label}</div>
                      {values.map((v: number, i: number) => (
                        <div key={i} style={{ textAlign: 'right', color: bold ? '#475569' : '#64748b' }}>${(v / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>
                      ))}
                    </div>
                  );
                  return (
                    <div style={{ background: 'white', borderRadius: '12px', padding: '32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', overflowX: 'auto' }}>
                      <div style={{ marginBottom: '12px', borderBottom: '2px solid #e2e8f0', paddingBottom: '16px' }}>
                        <h2 style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b', marginBottom: '4px' }}>Comparative Balance Sheet</h2>
                        <div style={{ fontSize: '14px', color: '#64748b' }}>{periodLabel} - {statementDisplay === 'monthly' ? 'Monthly' : statementDisplay === 'quarterly' ? 'Quarterly' : 'Annual'}</div>
                      </div>
                      <div style={{ minWidth: `${200 + (balanceData.length * 110)}px` }}>
                        <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '12px 0', borderBottom: '2px solid #1e293b', fontWeight: '600', color: '#1e293b' }}>
                          <div>Line Item</div>
                          {balanceData.map((p, i) => <div key={i} style={{ textAlign: 'right' }}>{p.label}</div>)}
                        </div>
                        <div style={{ margin: '8px 0 4px', fontSize: '15px', fontWeight: '700', color: '#1e293b' }}>ASSETS</div>
                        <div style={{ margin: '8px 0 4px', fontSize: '14px', fontWeight: '600', color: '#475569' }}>Current Assets</div>
                        {balanceData.some(p => p.cash > 0) && <Row label="Cash & Cash Equivalents" values={balanceData.map(p => p.cash)} indent={20} />}
                        {balanceData.some(p => p.ar > 0) && <Row label="Accounts Receivable" values={balanceData.map(p => p.ar)} indent={20} />}
                        {balanceData.some(p => p.inventory > 0) && <Row label="Inventory" values={balanceData.map(p => p.inventory)} indent={20} />}
                        {balanceData.some(p => p.otherCA > 0) && <Row label="Other Current Assets" values={balanceData.map(p => p.otherCA)} indent={20} />}
                        <Row label="Total Current Assets" values={balanceData.map(p => p.tca)} bold />
                        <div style={{ margin: '8px 0 4px', fontSize: '14px', fontWeight: '600', color: '#475569' }}>Non-Current Assets</div>
                        {balanceData.some(p => p.fixedAssets > 0) && <Row label="Property, Plant & Equipment" values={balanceData.map(p => p.fixedAssets)} indent={20} />}
                        {balanceData.some(p => p.intangibleAssets > 0) && <Row label="Intangible Assets" values={balanceData.map(p => p.intangibleAssets)} indent={20} />}
                        {balanceData.some(p => p.otherNonCurrentAssets > 0) && <Row label="Other Non-Current Assets" values={balanceData.map(p => p.otherNonCurrentAssets)} indent={20} />}
                        <Row label="Total Non-Current Assets" values={balanceData.map(p => p.nonCurrentAssets)} bold />
                        <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '10px 8px', background: '#dbeafe', borderRadius: '4px', margin: '8px 0', fontWeight: '700', color: '#1e40af' }}>
                          <div>TOTAL ASSETS</div>
                          {balanceData.map((p, i) => <div key={i} style={{ textAlign: 'right' }}>${(p.totalAssets / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>)}
                        </div>
                        <div style={{ margin: '12px 0 4px', fontSize: '15px', fontWeight: '700', color: '#1e293b' }}>LIABILITIES</div>
                        <div style={{ margin: '8px 0 4px', fontSize: '14px', fontWeight: '600', color: '#475569' }}>Current Liabilities</div>
                        {balanceData.some(p => p.ap > 0) && <Row label="Accounts Payable" values={balanceData.map(p => p.ap)} indent={20} />}
                        {balanceData.some(p => p.shortTermDebt > 0) && <Row label="Short-Term Debt" values={balanceData.map(p => p.shortTermDebt)} indent={20} />}
                        {balanceData.some(p => p.currentPortionLTD > 0) && <Row label="Current Portion of LT Debt" values={balanceData.map(p => p.currentPortionLTD)} indent={20} />}
                        {balanceData.some(p => p.otherCurrentLiabilities > 0) && <Row label="Other Current Liabilities" values={balanceData.map(p => p.otherCurrentLiabilities)} indent={20} />}
                        <Row label="Total Current Liabilities" values={balanceData.map(p => p.totalCurrentLiabilities)} bold />
                        <div style={{ margin: '8px 0 4px', fontSize: '14px', fontWeight: '600', color: '#475569' }}>Long-Term Liabilities</div>
                        {balanceData.some(p => p.ltd > 0) && <Row label="Long-Term Debt" values={balanceData.map(p => p.ltd)} indent={20} />}
                        {balanceData.some(p => p.otherLongTermLiabilities > 0) && <Row label="Other Long-Term Liabilities" values={balanceData.map(p => p.otherLongTermLiabilities)} indent={20} />}
                        <Row label="Total Long-Term Liabilities" values={balanceData.map(p => p.totalLongTermLiabilities)} bold />
                        <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '10px 8px', background: '#fef3c7', borderRadius: '4px', margin: '8px 0', fontWeight: '700', color: '#92400e' }}>
                          <div>TOTAL LIABILITIES</div>
                          {balanceData.map((p, i) => <div key={i} style={{ textAlign: 'right' }}>${(p.totalLiabilities / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K</div>)}
                        </div>
                        <div style={{ margin: '12px 0 4px', fontSize: '15px', fontWeight: '700', color: '#1e293b' }}>EQUITY</div>
                        {balanceData.some(p => p.paidInCapital > 0) && <Row label="Paid-in Capital" values={balanceData.map(p => p.paidInCapital)} indent={20} />}
                        {balanceData.some(p => p.retainedEarnings !== 0) && (
                          <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '4px 0', fontSize: '13px' }}>
                            <div style={{ color: '#64748b', paddingLeft: '20px' }}>Retained Earnings</div>
                            {balanceData.map((p, i) => (
                              <div key={i} style={{ textAlign: 'right', color: '#64748b' }}>
                                {p.retainedEarnings >= 0 ? '$' : '($'}{(Math.abs(p.retainedEarnings) / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K{p.retainedEarnings < 0 ? ')' : ''}
                              </div>
                            ))}
                          </div>
                        )}
                        <div style={{ display: 'grid', gridTemplateColumns: `180px repeat(${balanceData.length}, 110px)`, gap: '4px', padding: '12px 8px', background: '#dcfce7', borderRadius: '4px', margin: '12px 0 0', fontWeight: '700', fontSize: '15px' }}>
                          <div style={{ color: '#166534' }}>TOTAL EQUITY</div>
                          {balanceData.map((p, i) => (
                            <div key={i} style={{ textAlign: 'right', color: p.totalEquity >= 0 ? '#166534' : '#991b1b' }}>
                              {p.totalEquity >= 0 ? '$' : '($'}{(Math.abs(p.totalEquity) / 1000).toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}K{p.totalEquity < 0 ? ')' : ''}
                            </div>
                          ))}
                        </div>
                      </div>
                    </div>
                  );
                }
                
                // For balance sheet, use the latest month's values
                const cash = latestMonth.cash || 0;
                const ar = latestMonth.ar || 0;
                const inventory = latestMonth.inventory || 0;
                const otherCA = latestMonth.otherCA || 0;
                const tca = cash + ar + inventory + otherCA;
                
                const fixedAssets = latestMonth.fixedAssets || 0;
                const intangibleAssets = latestMonth.intangibleAssets || 0;
                const otherNonCurrentAssets = latestMonth.otherNonCurrentAssets || 0;
                const nonCurrentAssets = fixedAssets + intangibleAssets + otherNonCurrentAssets;
                
                const totalAssets = tca + nonCurrentAssets;
                
                const ap = latestMonth.ap || 0;
                const shortTermDebt = latestMonth.shortTermDebt || 0;
                const currentPortionLTD = latestMonth.currentPortionLTD || 0;
                const otherCurrentLiabilities = latestMonth.otherCurrentLiabilities || 0;
                const totalCurrentLiabilities = ap + shortTermDebt + currentPortionLTD + otherCurrentLiabilities;
                
                const ltd = latestMonth.ltd || 0;
                const otherLongTermLiabilities = latestMonth.otherLongTermLiabilities || 0;
                const totalLongTermLiabilities = ltd + otherLongTermLiabilities;
                
                const totalLiabilities = totalCurrentLiabilities + totalLongTermLiabilities;
                
                const paidInCapital = latestMonth.paidInCapital || 0;
                const retainedEarnings = latestMonth.retainedEarnings || 0;
                const totalEquity = paidInCapital + retainedEarnings;
                
                const totalLAndE = totalLiabilities + totalEquity;
                
                const latestDate = new Date(latestMonth.date || latestMonth.month);
                const asOfDate = latestDate.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });
                
                return (
                  <div style={{ background: 'white', borderRadius: '12px', padding: '32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                    <div style={{ marginBottom: '32px', borderBottom: '2px solid #e2e8f0', paddingBottom: '16px' }}>
                      <h2 style={{ fontSize: '24px', fontWeight: '700', color: '#1e293b', marginBottom: '4px' }}>Balance Sheet</h2>
                      <div style={{ fontSize: '14px', color: '#64748b' }}>As of {asOfDate} (Period: {periodLabel})</div>
                    </div>

                    {/* ASSETS */}
                    <div style={{ marginBottom: '32px' }}>
                      <div style={{ fontWeight: '700', fontSize: '18px', color: '#1e293b', marginBottom: '12px' }}>ASSETS</div>
                      
                      {/* Current Assets */}
                      <div style={{ marginBottom: '16px' }}>
                        <div style={{ fontWeight: '600', color: '#475569', marginBottom: '8px' }}>Current Assets</div>
                        {cash > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#64748b' }}>Cash & Cash Equivalents</span>
                            <span style={{ color: '#64748b' }}>${cash.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {ar > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#64748b' }}>Accounts Receivable</span>
                            <span style={{ color: '#64748b' }}>${ar.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {inventory > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#64748b' }}>Inventory</span>
                            <span style={{ color: '#64748b' }}>${inventory.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {otherCA > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#64748b' }}>Other Current Assets</span>
                            <span style={{ color: '#64748b' }}>${otherCA.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0 8px 10px', borderTop: '1px solid #cbd5e1', marginTop: '4px', fontWeight: '600' }}>
                          <span style={{ color: '#475569' }}>Total Current Assets</span>
                          <span style={{ color: '#475569' }}>${tca.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                      </div>

                      {/* Non-Current Assets */}
                      <div style={{ marginBottom: '16px' }}>
                        <div style={{ fontWeight: '600', color: '#475569', marginBottom: '8px' }}>Non-Current Assets</div>
                        {fixedAssets > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#64748b' }}>Property, Plant & Equipment</span>
                            <span style={{ color: '#64748b' }}>${fixedAssets.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {intangibleAssets > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#64748b' }}>Intangible Assets</span>
                            <span style={{ color: '#64748b' }}>${intangibleAssets.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {otherNonCurrentAssets > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#64748b' }}>Other Non-Current Assets</span>
                            <span style={{ color: '#64748b' }}>${otherNonCurrentAssets.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0 8px 10px', borderTop: '1px solid #cbd5e1', marginTop: '4px', fontWeight: '600' }}>
                          <span style={{ color: '#475569' }}>Total Non-Current Assets</span>
                          <span style={{ color: '#475569' }}>${nonCurrentAssets.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                      </div>

                      {/* TOTAL ASSETS */}
                      <div style={{ background: '#dbeafe', padding: '12px', borderRadius: '8px' }}>
                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                          <span style={{ fontWeight: '700', fontSize: '16px', color: '#1e40af' }}>TOTAL ASSETS</span>
                          <span style={{ fontWeight: '700', fontSize: '16px', color: '#1e40af' }}>
                            ${totalAssets.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                          </span>
                        </div>
                      </div>
                    </div>

                    {/* LIABILITIES */}
                    <div style={{ marginBottom: '32px' }}>
                      <div style={{ fontWeight: '700', fontSize: '18px', color: '#1e293b', marginBottom: '12px' }}>LIABILITIES</div>
                      
                      {/* Current Liabilities */}
                      <div style={{ marginBottom: '16px' }}>
                        <div style={{ fontWeight: '600', color: '#475569', marginBottom: '8px' }}>Current Liabilities</div>
                        {ap > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#64748b' }}>Accounts Payable</span>
                            <span style={{ color: '#64748b' }}>${ap.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {shortTermDebt > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#64748b' }}>Short-Term Debt</span>
                            <span style={{ color: '#64748b' }}>${shortTermDebt.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {currentPortionLTD > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#64748b' }}>Current Portion of LT Debt</span>
                            <span style={{ color: '#64748b' }}>${currentPortionLTD.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {otherCurrentLiabilities > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#64748b' }}>Other Current Liabilities</span>
                            <span style={{ color: '#64748b' }}>${otherCurrentLiabilities.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0 8px 10px', borderTop: '1px solid #cbd5e1', marginTop: '4px', fontWeight: '600' }}>
                          <span style={{ color: '#475569' }}>Total Current Liabilities</span>
                          <span style={{ color: '#475569' }}>${totalCurrentLiabilities.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                      </div>

                      {/* Long-Term Liabilities */}
                      <div style={{ marginBottom: '16px' }}>
                        <div style={{ fontWeight: '600', color: '#475569', marginBottom: '8px' }}>Long-Term Liabilities</div>
                        {ltd > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#64748b' }}>Long-Term Debt</span>
                            <span style={{ color: '#64748b' }}>${ltd.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        {otherLongTermLiabilities > 0 && (
                          <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                            <span style={{ color: '#64748b' }}>Other Long-Term Liabilities</span>
                            <span style={{ color: '#64748b' }}>${otherLongTermLiabilities.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                          </div>
                        )}
                        <div style={{ display: 'flex', justifyContent: 'space-between', padding: '8px 0 8px 10px', borderTop: '1px solid #cbd5e1', marginTop: '4px', fontWeight: '600' }}>
                          <span style={{ color: '#475569' }}>Total Long-Term Liabilities</span>
                          <span style={{ color: '#475569' }}>${totalLongTermLiabilities.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                      </div>

                      {/* TOTAL LIABILITIES */}
                      <div style={{ background: '#fef3c7', padding: '12px', borderRadius: '8px' }}>
                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                          <span style={{ fontWeight: '700', fontSize: '16px', color: '#92400e' }}>TOTAL LIABILITIES</span>
                          <span style={{ fontWeight: '700', fontSize: '16px', color: '#92400e' }}>
                            ${totalLiabilities.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                          </span>
                        </div>
                      </div>
                    </div>

                    {/* EQUITY */}
                    <div style={{ marginBottom: '32px' }}>
                      <div style={{ fontWeight: '700', fontSize: '18px', color: '#1e293b', marginBottom: '12px' }}>EQUITY</div>
                      {paidInCapital > 0 && (
                        <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                          <span style={{ color: '#64748b' }}>Paid-in Capital</span>
                          <span style={{ color: '#64748b' }}>${paidInCapital.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
                        </div>
                      )}
                      {retainedEarnings !== 0 && (
                        <div style={{ display: 'flex', justifyContent: 'space-between', padding: '4px 0 4px 20px', fontSize: '14px' }}>
                          <span style={{ color: '#64748b' }}>Retained Earnings</span>
                          <span style={{ color: '#64748b' }}>
                            {retainedEarnings >= 0 ? '$' : '($'}{Math.abs(retainedEarnings).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}{retainedEarnings < 0 ? ')' : ''}
                          </span>
                        </div>
                      )}

                      {/* TOTAL EQUITY */}
                      <div style={{ background: '#dcfce7', padding: '12px', borderRadius: '8px', marginTop: '8px' }}>
                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                          <span style={{ fontWeight: '700', fontSize: '16px', color: '#166534' }}>TOTAL EQUITY</span>
                          <span style={{ fontWeight: '700', fontSize: '16px', color: '#166534' }}>
                            {totalEquity >= 0 ? '$' : '($'}{Math.abs(totalEquity).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}{totalEquity < 0 ? ')' : ''}
                          </span>
                        </div>
                      </div>
                    </div>

                    {/* TOTAL LIABILITIES & EQUITY */}
                    <div style={{ background: '#f1f5f9', padding: '16px', borderRadius: '8px', marginTop: '32px' }}>
                      <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '4px' }}>
                        <span style={{ fontWeight: '700', fontSize: '18px', color: '#1e293b' }}>TOTAL LIABILITIES & EQUITY</span>
                        <span style={{ fontWeight: '700', fontSize: '18px', color: '#1e293b' }}>
                          ${totalLAndE.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                        </span>
                      </div>
                      {Math.abs(totalAssets - totalLAndE) > 0.01 && (
                        <div style={{ fontSize: '12px', color: '#ef4444', marginTop: '8px', textAlign: 'right' }}>
                          ⚠️ Balance check: Assets - (Liabilities + Equity) = ${(totalAssets - totalLAndE).toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                        </div>
                      )}
                    </div>
                  </div>
                );
              }
            }
            
            else {
              return (
                <div style={{ background: 'white', borderRadius: '12px', padding: '48px 32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', minHeight: '400px', textAlign: 'center' }}>
                  <div style={{ fontSize: '18px', fontWeight: '600', color: '#64748b', marginBottom: '12px' }}>
                    📊 Financial Statement Viewer
                  </div>
                  <p style={{ fontSize: '14px', color: '#94a3b8', maxWidth: '600px', margin: '0 auto' }}>
                    Select options above to view financial statements.
                  </p>
                </div>
              );
            }
          })()}
          </>
          )}

          {/* Line of Business Reporting Tab */}
          {financialStatementsTab === 'line-of-business' && (
            <div style={{ background: 'white', borderRadius: '12px', padding: '24px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
              <div style={{ marginBottom: '12px' }}>
                <h2 style={{ fontSize: '20px', fontWeight: '600', color: '#1e293b', marginBottom: '16px' }}>Line of Business Reporting</h2>
                <p style={{ fontSize: '14px', color: '#64748b', marginBottom: '12px' }}>
                  Line of Business reporting is currently only available for QuickBooks data with class tracking enabled.
                </p>
              </div>

              <div style={{ background: '#f8fafc', border: '2px dashed #cbd5e1', borderRadius: '8px', padding: '48px 24px', textAlign: 'center' }}>
                <div style={{ fontSize: '48px', marginBottom: '16px' }}>📊</div>
                <div style={{ fontSize: '18px', fontWeight: '600', color: '#1e293b', marginBottom: '8px' }}>
                  QuickBooks Data Required
                </div>
                <p style={{ fontSize: '14px', color: '#64748b', maxWidth: '500px', margin: '0 auto' }}>
                  To use Line of Business reporting, please connect your QuickBooks account and ensure class tracking is enabled for your company.
                </p>
              </div>
            </div>
          )}
        </div>
      )}

      {/* Financial Statements View - No Data Available */}
      {currentView === 'financial-statements' && selectedCompanyId && !qbRawData && monthly.length === 0 && (
        <div style={{ maxWidth: '1800px', margin: '0 auto', padding: '32px' }}>
          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '8px' }}>
            <h1 style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b', margin: 0 }}>Financial Statements</h1>
            {companyName && <div style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b' }}>{companyName}</div>}
          </div>
          <div style={{ background: 'white', borderRadius: '12px', padding: '48px 32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', minHeight: '400px', textAlign: 'center', marginTop: '32px' }}>
            <div style={{ fontSize: '18px', fontWeight: '600', color: '#64748b', marginBottom: '12px' }}>
              📊 No Financial Data Available
            </div>
            <p style={{ fontSize: '14px', color: '#94a3b8', maxWidth: '600px', margin: '0 auto' }}>
              Please import financial data via CSV or sync from QuickBooks to view financial statements.
            </p>
          </div>
        </div>
      )}

      {/* Profile View */}
      {currentView === 'admin' && adminDashboardTab === 'profile' && selectedCompanyId && currentUser?.role === 'consultant' && (
        <div style={{ maxWidth: '1400px', margin: '0 auto', padding: '8px 32px 32px 32px' }}>
          <style>{`
            @media print {
              @page {
                margin: 0.75in 0.75in 0.75in 0.75in;
              }
              
              body, main, main * {
                margin-top: 0 !important;
              }
              
              #first-profile-section {
                padding: 0 32px 32px 32px !important;
                margin-top: 0 !important;
                margin-bottom: 0 !important;
              }
              
              .page-break {
                page-break-after: always;
                break-after: page;
                padding: 32px !important;
                margin: 0 !important;
              }
              
              .print-page-header {
                display: none !important;
              }
              
              aside, header, .no-print, .dashboard-header-print-hide, .dashboard-tabs-print-hide {
                display: none !important;
              }
              
              body {
                background: white !important;
                padding: 0 !important;
                margin: 0 !important;
              }
              
              main {
                padding: 0 !important;
                margin: 0 !important;
              }
              
              main > div {
                padding: 0 !important;
                margin: 0 !important;
                max-width: none !important;
              }
              
              * {
                box-shadow: none !important;
                border-radius: 0 !important;
              }
            }
            
            .print-page-header {
              display: none;
            }
          `}</style>
          
          <div className="no-print" style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '12px' }}>
            <div style={{ flex: 1 }}>
              <div style={{ marginBottom: '8px' }}>
                <h1 style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b', margin: 0 }}>Company Profile</h1>
              </div>
              <p style={{ fontSize: '14px', color: '#64748b', margin: 0 }}>
                This summary was constructed from the company's past three years of financial statements.
              </p>
            </div>
            <button
              onClick={() => window.print()}
              style={{ 
                padding: '12px 24px', 
                background: '#667eea', 
                color: 'white', 
                border: 'none', 
                borderRadius: '8px', 
                fontSize: '14px', 
                fontWeight: '600', 
                cursor: 'pointer',
                boxShadow: '0 2px 6px rgba(102, 126, 234, 0.3)'
              }}
            >
              🖨️ Print Profile
            </button>
          </div>

          {(() => {
            // Get or create profile for this company
            let profile = companyProfiles.find(p => p.companyId === selectedCompanyId);
            
            if (!profile) {
              profile = {
                companyId: selectedCompanyId,
                legalStructure: '',
                businessStatus: '',
                ownership: '',
                workforce: '',
                keyAdvisors: '',
                specialNotes: '',
                qoeNotes: '',
                disclosures: {
                  bankruptcies: 'None',
                  liens: 'None',
                  contracts: 'None',
                  lawsuits: 'None',
                  mostFavoredNation: 'None',
                  equityControl: 'None',
                  rightOfFirstRefusal: 'None',
                  shareholderProtections: 'None',
                  changeInControl: 'None',
                  regulatoryApprovals: 'None',
                  auditedFinancials: 'No'
                }
              };
            }

            const updateProfile = (updates: Partial<CompanyProfile>) => {
              const updatedProfiles = companyProfiles.filter(p => p.companyId !== selectedCompanyId);
              updatedProfiles.push({ ...profile!, ...updates });
              setCompanyProfiles(updatedProfiles);
            };

            // Get company data
            const ltmData = monthly.length >= 12 ? monthly.slice(-12) : monthly;
            const ltmRev = ltmData.reduce((sum, m) => sum + m.revenue, 0);
            const ltmAssets = ltmData.length > 0 ? ltmData[ltmData.length - 1].totalAssets : 0;
            
            // Get latest 3 years of data for financial statement overview
            const latest = monthly[monthly.length - 1];
            const oneYearAgo = monthly.length >= 13 ? monthly[monthly.length - 13] : null;
            const twoYearsAgo = monthly.length >= 25 ? monthly[monthly.length - 25] : null;

            // Get industry info
            const industry = INDUSTRY_SECTORS.find(i => i.id === company?.industrySector);
            
            // Calculate Last 12 months for ratio table
            // Get up to last 12 trend data points (or fewer if less data available)
            const last12Trends = trendData.slice(-12);
            // Get the corresponding months for these trend points
            // trendData starts at month index 12, so we need to match up the months
            const trendStartIndex = Math.max(0, monthly.length - trendData.length);
            const last12Months = monthly.slice(trendStartIndex + Math.max(0, trendData.length - 12));

            return (
              <>
                {/* Section 1: Business Profile */}
                <div id="first-profile-section" className="page-break" style={{ background: 'white', borderRadius: '12px', padding: '32px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                  <div className="print-page-header">
                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                      <div style={{ fontSize: '16px', fontWeight: '700', color: '#1e293b' }}>{company?.name}</div>
                      <div style={{ fontSize: '13px', color: '#64748b' }}>{new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</div>
                    </div>
                  </div>
                  <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '12px', borderBottom: '2px solid #e2e8f0', paddingBottom: '12px' }}>
                    Business Profile
                  </h2>
                  
                  <div style={{ display: 'grid', gridTemplateColumns: '200px 1fr', gap: '16px', marginBottom: '16px' }}>
                    <div style={{ fontWeight: '600', color: '#475569' }}>COMPANY NAME</div>
                    <div style={{ color: '#1e293b' }}>{company?.name || 'N/A'}</div>
                    
                    <div style={{ fontWeight: '600', color: '#475569' }}>LEGAL STRUCTURE</div>
                    <input 
                      type="text" 
                      value={profile.legalStructure} 
                      onChange={(e) => updateProfile({ legalStructure: e.target.value })}
                      placeholder="e.g., C Corp, S Corp, LLC"
                      style={{ padding: '8px 12px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '14px' }}
                    />
                    
                    <div style={{ fontWeight: '600', color: '#475569' }}>BUSINESS STATUS</div>
                    <select
                      value={profile.businessStatus}
                      onChange={(e) => updateProfile({ businessStatus: e.target.value })}
                      style={{ padding: '8px 12px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '14px' }}
                    >
                      <option value="">Select status</option>
                      <option value="ACTIVE">ACTIVE</option>
                      <option value="INACTIVE">INACTIVE</option>
                      <option value="PENDING">PENDING</option>
                    </select>
                    
                    <div style={{ fontWeight: '600', color: '#475569' }}>OWNERSHIP</div>
                    <input 
                      type="text" 
                      value={profile.ownership} 
                      onChange={(e) => updateProfile({ ownership: e.target.value })}
                      placeholder="Owner name(s)"
                      style={{ padding: '8px 12px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '14px' }}
                    />
                    
                    <div style={{ fontWeight: '600', color: '#475569' }}>ADDRESS</div>
                    <div style={{ color: '#1e293b' }}>
                      {company?.addressStreet || company?.addressCity ? (
                        <>
                          {company?.addressStreet && <div>{company.addressStreet}</div>}
                          <div>
                            {company?.addressCity && company.addressCity}
                            {company?.addressState && `, ${company.addressState}`}
                            {company?.addressZip && ` ${company.addressZip}`}
                          </div>
                          {company?.addressCountry && <div>{company.addressCountry}</div>}
                        </>
                      ) : (
                        'Not set'
                      )}
                    </div>
                    
                    <div style={{ fontWeight: '600', color: '#475569' }}>INDUSTRY</div>
                    <div style={{ color: '#1e293b' }}>
                      {industry ? `${industry.id} - ${industry.name}` : 'Not set'}
                    </div>
                    
                    <div style={{ fontWeight: '600', color: '#475569' }}>WORKFORCE</div>
                    <input 
                      type="text" 
                      value={profile.workforce} 
                      onChange={(e) => updateProfile({ workforce: e.target.value })}
                      placeholder="e.g., 3 FT, 1 owner"
                      style={{ padding: '8px 12px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '14px' }}
                    />
                    
                    <div style={{ fontWeight: '600', color: '#475569' }}>LTM REVENUE</div>
                    <div style={{ color: '#1e293b' }}>
                      {ltmRev < 500000 ? 'Under $500K' : `$${(ltmRev / 1000).toFixed(0)}K`}
                    </div>
                    
                    <div style={{ fontWeight: '600', color: '#475569' }}>TOTAL ASSETS</div>
                    <div style={{ color: '#1e293b' }}>
                      ${ltmAssets.toLocaleString()}
                    </div>
                    
                    <div style={{ fontWeight: '600', color: '#475569' }}>KEY ADVISORS</div>
                    <input 
                      type="text" 
                      value={profile.keyAdvisors} 
                      onChange={(e) => updateProfile({ keyAdvisors: e.target.value })}
                      placeholder="Advisor names"
                      style={{ padding: '8px 12px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '14px' }}
                    />
                  </div>
                  
                  <div style={{ marginTop: '24px' }}>
                    <div style={{ fontWeight: '600', color: '#475569', marginBottom: '8px' }}>SPECIAL NOTES</div>
                    <textarea
                      value={profile.specialNotes}
                      onChange={(e) => updateProfile({ specialNotes: e.target.value })}
                      placeholder="Any special notes about sale, buyer requirements, financing, etc."
                      rows={4}
                      style={{ width: '100%', padding: '12px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '14px', fontFamily: 'inherit', resize: 'vertical' }}
                    />
                  </div>
                  
                  <div style={{ marginTop: '16px' }}>
                    <div style={{ fontWeight: '600', color: '#475569', marginBottom: '8px' }}>Quality of Earnings (QoE)</div>
                    <textarea
                      value={profile.qoeNotes}
                      onChange={(e) => updateProfile({ qoeNotes: e.target.value })}
                      placeholder="Notes on revenue quality, recurring vs. non-recurring, cash vs. credit, etc."
                      rows={3}
                      style={{ width: '100%', padding: '12px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '14px', fontFamily: 'inherit', resize: 'vertical' }}
                    />
                  </div>
                </div>

                {/* Section 2: Financial Statement Overview */}
                <div className="page-break" style={{ background: 'white', borderRadius: '12px', padding: '32px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                  <div className="print-page-header">
                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                      <div style={{ fontSize: '16px', fontWeight: '700', color: '#1e293b' }}>{company?.name}</div>
                      <div style={{ fontSize: '13px', color: '#64748b' }}>{new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</div>
                    </div>
                  </div>
                  <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '12px', borderBottom: '2px solid #e2e8f0', paddingBottom: '12px' }}>
                    Financial Statement Overview
                  </h2>
                  
                  <h3 style={{ fontSize: '18px', fontWeight: '600', color: '#475569', marginBottom: '16px' }}>BALANCE SHEET</h3>
                  <div style={{ overflowX: 'auto' }}>
                    <table style={{ width: '100%', borderCollapse: 'collapse' }}>
                      <thead>
                        <tr style={{ borderBottom: '2px solid #e2e8f0' }}>
                          <th style={{ textAlign: 'left', padding: '12px', fontSize: '14px', fontWeight: '600', color: '#64748b' }}></th>
                          <th style={{ textAlign: 'right', padding: '12px', fontSize: '14px', fontWeight: '600', color: '#64748b' }}>Current</th>
                          <th style={{ textAlign: 'right', padding: '12px', fontSize: '14px', fontWeight: '600', color: '#64748b' }}>Yr End 2024</th>
                          <th style={{ textAlign: 'right', padding: '12px', fontSize: '14px', fontWeight: '600', color: '#64748b' }}>Yr End 2023</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '12px', fontSize: '14px', color: '#475569' }}>Total Assets</td>
                          <td style={{ padding: '12px', fontSize: '14px', color: '#1e293b', textAlign: 'right' }}>
                            ${latest ? latest.totalAssets.toLocaleString() : 'N/A'}
                          </td>
                          <td style={{ padding: '12px', fontSize: '14px', color: '#1e293b', textAlign: 'right' }}>
                            ${oneYearAgo ? oneYearAgo.totalAssets.toLocaleString() : 'N/A'}
                          </td>
                          <td style={{ padding: '12px', fontSize: '14px', color: '#1e293b', textAlign: 'right' }}>
                            ${twoYearsAgo ? twoYearsAgo.totalAssets.toLocaleString() : 'N/A'}
                          </td>
                        </tr>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '12px', fontSize: '14px', color: '#475569' }}>Total Liabilities</td>
                          <td style={{ padding: '12px', fontSize: '14px', color: '#1e293b', textAlign: 'right' }}>
                            ${latest ? latest.totalLiab.toLocaleString() : 'N/A'}
                          </td>
                          <td style={{ padding: '12px', fontSize: '14px', color: '#1e293b', textAlign: 'right' }}>
                            ${oneYearAgo ? oneYearAgo.totalLiab.toLocaleString() : 'N/A'}
                          </td>
                          <td style={{ padding: '12px', fontSize: '14px', color: '#1e293b', textAlign: 'right' }}>
                            ${twoYearsAgo ? twoYearsAgo.totalLiab.toLocaleString() : 'N/A'}
                          </td>
                        </tr>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '12px', fontSize: '14px', color: '#475569' }}>Total Equity</td>
                          <td style={{ padding: '12px', fontSize: '14px', color: '#1e293b', textAlign: 'right' }}>
                            ${latest ? latest.totalEquity.toLocaleString() : 'N/A'}
                          </td>
                          <td style={{ padding: '12px', fontSize: '14px', color: '#1e293b', textAlign: 'right' }}>
                            ${oneYearAgo ? oneYearAgo.totalEquity.toLocaleString() : 'N/A'}
                          </td>
                          <td style={{ padding: '12px', fontSize: '14px', color: '#1e293b', textAlign: 'right' }}>
                            ${twoYearsAgo ? twoYearsAgo.totalEquity.toLocaleString() : 'N/A'}
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  
                  <h3 style={{ fontSize: '18px', fontWeight: '600', color: '#475569', marginTop: '32px', marginBottom: '16px' }}>INCOME STATEMENT</h3>
                  <div style={{ overflowX: 'auto' }}>
                    <table style={{ width: '100%', borderCollapse: 'collapse' }}>
                      <thead>
                        <tr style={{ borderBottom: '2px solid #e2e8f0' }}>
                          <th style={{ textAlign: 'left', padding: '12px', fontSize: '14px', fontWeight: '600', color: '#64748b' }}></th>
                          <th style={{ textAlign: 'right', padding: '12px', fontSize: '14px', fontWeight: '600', color: '#64748b' }}>LTM</th>
                          <th style={{ textAlign: 'right', padding: '12px', fontSize: '14px', fontWeight: '600', color: '#64748b' }}>2024</th>
                          <th style={{ textAlign: 'right', padding: '12px', fontSize: '14px', fontWeight: '600', color: '#64748b' }}>2023</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '12px', fontSize: '14px', color: '#475569' }}>Revenue</td>
                          <td style={{ padding: '12px', fontSize: '14px', color: '#1e293b', textAlign: 'right' }}>
                            ${ltmRev.toLocaleString()}
                          </td>
                          <td style={{ padding: '12px', fontSize: '14px', color: '#1e293b', textAlign: 'right' }}>
                            ${oneYearAgo ? monthly.slice(-24, -12).reduce((sum, m) => sum + m.revenue, 0).toLocaleString() : 'N/A'}
                          </td>
                          <td style={{ padding: '12px', fontSize: '14px', color: '#1e293b', textAlign: 'right' }}>
                            ${twoYearsAgo ? monthly.slice(-36, -24).reduce((sum, m) => sum + m.revenue, 0).toLocaleString() : 'N/A'}
                          </td>
                        </tr>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '12px', fontSize: '14px', color: '#475569' }}>Margin %</td>
                          <td style={{ padding: '12px', fontSize: '14px', color: '#1e293b', textAlign: 'right' }}>
                            {((ltmData.reduce((sum, m) => sum + (m.revenue - m.cogsTotal), 0) / ltmRev) * 100).toFixed(2)}%
                          </td>
                          <td style={{ padding: '12px', fontSize: '14px', color: '#1e293b', textAlign: 'right' }}>
                            {oneYearAgo ? ((monthly.slice(-24, -12).reduce((sum, m) => sum + (m.revenue - m.cogsTotal), 0) / monthly.slice(-24, -12).reduce((sum, m) => sum + m.revenue, 0)) * 100).toFixed(1) + '%' : 'N/A'}
                          </td>
                          <td style={{ padding: '12px', fontSize: '14px', color: '#1e293b', textAlign: 'right' }}>
                            {twoYearsAgo ? ((monthly.slice(-36, -24).reduce((sum, m) => sum + (m.revenue - m.cogsTotal), 0) / monthly.slice(-36, -24).reduce((sum, m) => sum + m.revenue, 0)) * 100).toFixed(1) + '%' : 'N/A'}
                          </td>
                        </tr>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '12px', fontSize: '14px', color: '#475569' }}>Total Expenses</td>
                          <td style={{ padding: '12px', fontSize: '14px', color: '#1e293b', textAlign: 'right' }}>
                            ${ltmData.reduce((sum, m) => sum + m.expense, 0).toLocaleString()}
                          </td>
                          <td style={{ padding: '12px', fontSize: '14px', color: '#1e293b', textAlign: 'right' }}>
                            ${oneYearAgo ? monthly.slice(-24, -12).reduce((sum, m) => sum + m.expense, 0).toLocaleString() : 'N/A'}
                          </td>
                          <td style={{ padding: '12px', fontSize: '14px', color: '#1e293b', textAlign: 'right' }}>
                            ${twoYearsAgo ? monthly.slice(-36, -24).reduce((sum, m) => sum + m.expense, 0).toLocaleString() : 'N/A'}
                          </td>
                        </tr>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '12px', fontSize: '14px', fontWeight: '600', color: '#475569' }}>Net Income</td>
                          <td style={{ padding: '12px', fontSize: '14px', fontWeight: '600', color: '#1e293b', textAlign: 'right' }}>
                            ${ltmData.reduce((sum, m) => sum + (m.revenue - m.expense), 0).toLocaleString()}
                          </td>
                          <td style={{ padding: '12px', fontSize: '14px', fontWeight: '600', color: '#1e293b', textAlign: 'right' }}>
                            ${oneYearAgo ? monthly.slice(-24, -12).reduce((sum, m) => sum + (m.revenue - m.expense), 0).toLocaleString() : 'N/A'}
                          </td>
                          <td style={{ padding: '12px', fontSize: '14px', fontWeight: '600', color: '#1e293b', textAlign: 'right' }}>
                            ${twoYearsAgo ? monthly.slice(-36, -24).reduce((sum, m) => sum + (m.revenue - m.expense), 0).toLocaleString() : 'N/A'}
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>

                {/* Section 3: Financial Ratios Overview */}
                <div className="page-break" style={{ background: 'white', borderRadius: '12px', padding: '32px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                  <div className="print-page-header">
                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                      <div style={{ fontSize: '16px', fontWeight: '700', color: '#1e293b' }}>{company?.name}</div>
                      <div style={{ fontSize: '13px', color: '#64748b' }}>{new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</div>
                    </div>
                  </div>
                  <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '12px', borderBottom: '2px solid #e2e8f0', paddingBottom: '12px' }}>
                    Financial Ratios Overview
                  </h2>
                  
                  {/* Liquidity Ratios */}
                  <h3 style={{ fontSize: '16px', fontWeight: '600', color: '#475569', marginBottom: '12px' }}>Liquidity Ratios</h3>
                  <div style={{ overflowX: 'auto', marginBottom: '12px' }}>
                    <table style={{ width: '100%', fontSize: '12px', borderCollapse: 'collapse' }}>
                      <thead>
                        <tr style={{ borderBottom: '2px solid #e2e8f0' }}>
                          <th style={{ textAlign: 'left', padding: '8px', fontSize: '12px', fontWeight: '600', color: '#64748b', minWidth: '120px' }}>Ratio</th>
                          {last12Months.map((m, i) => (
                            <th key={i} style={{ textAlign: 'right', padding: '8px', fontSize: '11px', fontWeight: '600', color: '#64748b', minWidth: '60px' }}>
                              {m.month.substring(0, m.month.lastIndexOf('/'))}
                            </th>
                          ))}
                        </tr>
                      </thead>
                      <tbody>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '8px', fontSize: '12px', color: '#475569' }}>Current Ratio</td>
                          {last12Trends.map((data, i) => (
                            <td key={i} style={{ padding: '8px', fontSize: '12px', color: '#1e293b', textAlign: 'right' }}>
                              {data?.currentRatio !== undefined ? data.currentRatio.toFixed(1) : 'N/A'}
                            </td>
                          ))}
                        </tr>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '8px', fontSize: '12px', color: '#475569' }}>Quick Ratio</td>
                          {last12Trends.map((data, i) => (
                            <td key={i} style={{ padding: '8px', fontSize: '12px', color: '#1e293b', textAlign: 'right' }}>
                              {data?.quickRatio !== undefined ? data.quickRatio.toFixed(1) : 'N/A'}
                            </td>
                          ))}
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  
                  {/* Activity Ratios */}
                  <h3 style={{ fontSize: '16px', fontWeight: '600', color: '#475569', marginBottom: '12px' }}>Activity Ratios</h3>
                  <div style={{ overflowX: 'auto', marginBottom: '12px' }}>
                    <table style={{ width: '100%', fontSize: '12px', borderCollapse: 'collapse' }}>
                      <thead>
                        <tr style={{ borderBottom: '2px solid #e2e8f0' }}>
                          <th style={{ textAlign: 'left', padding: '8px', fontSize: '12px', fontWeight: '600', color: '#64748b', minWidth: '120px' }}>Ratio</th>
                          {last12Months.map((m, i) => (
                            <th key={i} style={{ textAlign: 'right', padding: '8px', fontSize: '11px', fontWeight: '600', color: '#64748b', minWidth: '60px' }}>
                              {m.month.substring(0, m.month.lastIndexOf('/'))}
                            </th>
                          ))}
                        </tr>
                      </thead>
                      <tbody>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '8px', fontSize: '12px', color: '#475569' }}>Inventory Turnover</td>
                          {last12Trends.map((data, i) => (
                            <td key={i} style={{ padding: '8px', fontSize: '12px', color: '#1e293b', textAlign: 'right' }}>
                              {data?.invTurnover !== undefined ? data.invTurnover.toFixed(1) : 'N/A'}
                            </td>
                          ))}
                        </tr>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '8px', fontSize: '12px', color: '#475569' }}>Receivables Turnover</td>
                          {last12Trends.map((data, i) => (
                            <td key={i} style={{ padding: '8px', fontSize: '12px', color: '#1e293b', textAlign: 'right' }}>
                              {data?.arTurnover !== undefined ? data.arTurnover.toFixed(1) : 'N/A'}
                            </td>
                          ))}
                        </tr>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '8px', fontSize: '12px', color: '#475569' }}>Sales/Working Capital</td>
                          {last12Trends.map((data, i) => (
                            <td key={i} style={{ padding: '8px', fontSize: '12px', color: '#1e293b', textAlign: 'right' }}>
                              {data?.salesWC !== undefined ? data.salesWC.toFixed(1) : 'N/A'}
                            </td>
                          ))}
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  
                  {/* Coverage Ratios */}
                  <h3 style={{ fontSize: '16px', fontWeight: '600', color: '#475569', marginBottom: '12px' }}>Coverage Ratios</h3>
                  <div style={{ overflowX: 'auto', marginBottom: '12px' }}>
                    <table style={{ width: '100%', fontSize: '12px', borderCollapse: 'collapse' }}>
                      <thead>
                        <tr style={{ borderBottom: '2px solid #e2e8f0' }}>
                          <th style={{ textAlign: 'left', padding: '8px', fontSize: '12px', fontWeight: '600', color: '#64748b', minWidth: '120px' }}>Ratio</th>
                          {last12Months.map((m, i) => (
                            <th key={i} style={{ textAlign: 'right', padding: '8px', fontSize: '11px', fontWeight: '600', color: '#64748b', minWidth: '60px' }}>
                              {m.month.substring(0, m.month.lastIndexOf('/'))}
                            </th>
                          ))}
                        </tr>
                      </thead>
                      <tbody>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '8px', fontSize: '12px', color: '#475569' }}>Interest Coverage</td>
                          {last12Trends.map((data, i) => (
                            <td key={i} style={{ padding: '8px', fontSize: '12px', color: '#1e293b', textAlign: 'right' }}>
                              {data?.interestCov !== undefined ? data.interestCov.toFixed(1) : 'N/A'}
                            </td>
                          ))}
                        </tr>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '8px', fontSize: '12px', color: '#475569' }}>Debt Service Coverage</td>
                          {last12Trends.map((data, i) => (
                            <td key={i} style={{ padding: '8px', fontSize: '12px', color: '#1e293b', textAlign: 'right' }}>
                              {data?.debtSvcCov !== undefined ? data.debtSvcCov.toFixed(1) : 'N/A'}
                            </td>
                          ))}
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  
                  {/* Leverage Ratios */}
                  <h3 style={{ fontSize: '16px', fontWeight: '600', color: '#475569', marginBottom: '12px' }}>Leverage Ratios</h3>
                  <div style={{ overflowX: 'auto', marginBottom: '12px' }}>
                    <table style={{ width: '100%', fontSize: '12px', borderCollapse: 'collapse' }}>
                      <thead>
                        <tr style={{ borderBottom: '2px solid #e2e8f0' }}>
                          <th style={{ textAlign: 'left', padding: '8px', fontSize: '12px', fontWeight: '600', color: '#64748b', minWidth: '120px' }}>Ratio</th>
                          {last12Months.map((m, i) => (
                            <th key={i} style={{ textAlign: 'right', padding: '8px', fontSize: '11px', fontWeight: '600', color: '#64748b', minWidth: '60px' }}>
                              {m.month.substring(0, m.month.lastIndexOf('/'))}
                            </th>
                          ))}
                        </tr>
                      </thead>
                      <tbody>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '8px', fontSize: '12px', color: '#475569' }}>Debt/Net Worth</td>
                          {last12Trends.map((data, i) => (
                            <td key={i} style={{ padding: '8px', fontSize: '12px', color: '#1e293b', textAlign: 'right' }}>
                              {data?.debtToNW !== undefined ? data.debtToNW.toFixed(1) : 'N/A'}
                            </td>
                          ))}
                        </tr>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '8px', fontSize: '12px', color: '#475569' }}>Leverage Ratio</td>
                          {last12Trends.map((data, i) => (
                            <td key={i} style={{ padding: '8px', fontSize: '12px', color: '#1e293b', textAlign: 'right' }}>
                              {data?.leverage !== undefined ? data.leverage.toFixed(1) : 'N/A'}
                            </td>
                          ))}
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  
                  {/* Operating Ratios */}
                  <h3 style={{ fontSize: '16px', fontWeight: '600', color: '#475569', marginBottom: '12px' }}>Operating Ratios</h3>
                  <div style={{ overflowX: 'auto' }}>
                    <table style={{ width: '100%', fontSize: '12px', borderCollapse: 'collapse' }}>
                      <thead>
                        <tr style={{ borderBottom: '2px solid #e2e8f0' }}>
                          <th style={{ textAlign: 'left', padding: '8px', fontSize: '12px', fontWeight: '600', color: '#64748b', minWidth: '120px' }}>Ratio</th>
                          {last12Months.map((m, i) => (
                            <th key={i} style={{ textAlign: 'right', padding: '8px', fontSize: '11px', fontWeight: '600', color: '#64748b', minWidth: '60px' }}>
                              {m.month.substring(0, m.month.lastIndexOf('/'))}
                            </th>
                          ))}
                        </tr>
                      </thead>
                      <tbody>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '8px', fontSize: '12px', color: '#475569' }}>ROE</td>
                          {last12Trends.map((data, i) => (
                            <td key={i} style={{ padding: '8px', fontSize: '12px', color: '#1e293b', textAlign: 'right' }}>
                              {data?.roe !== undefined ? `${(data.roe * 100).toFixed(1)}%` : 'N/A'}
                            </td>
                          ))}
                        </tr>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '8px', fontSize: '12px', color: '#475569' }}>ROA</td>
                          {last12Trends.map((data, i) => (
                            <td key={i} style={{ padding: '8px', fontSize: '12px', color: '#1e293b', textAlign: 'right' }}>
                              {data?.roa !== undefined ? `${(data.roa * 100).toFixed(1)}%` : 'N/A'}
                            </td>
                          ))}
                        </tr>
                        <tr style={{ borderBottom: '1px solid #f1f5f9' }}>
                          <td style={{ padding: '8px', fontSize: '12px', color: '#475569' }}>EBITDA/Revenue</td>
                          {last12Trends.map((data, i) => (
                            <td key={i} style={{ padding: '8px', fontSize: '12px', color: '#1e293b', textAlign: 'right' }}>
                              {data?.ebitdaMargin !== undefined ? `${(data.ebitdaMargin * 100).toFixed(1)}%` : 'N/A'}
                            </td>
                          ))}
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>

                {/* Section 4: Company Disclosures */}
                <div style={{ background: 'white', borderRadius: '12px', padding: '32px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                  <div className="print-page-header">
                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                      <div style={{ fontSize: '16px', fontWeight: '700', color: '#1e293b' }}>{company?.name}</div>
                      <div style={{ fontSize: '13px', color: '#64748b' }}>{new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</div>
                    </div>
                  </div>
                  <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '12px', borderBottom: '2px solid #e2e8f0', paddingBottom: '12px' }}>
                    Company Disclosures
                  </h2>
                  
                  <div style={{ display: 'grid', gridTemplateColumns: '1fr 200px', gap: '12px' }}>
                    <div style={{ fontWeight: '600', color: '#475569' }}>DISCLOSURE</div>
                    <div style={{ fontWeight: '600', color: '#475569' }}>STATUS</div>
                    
                    <div style={{ fontSize: '14px', color: '#1e293b' }}>Bankruptcies</div>
                    <input 
                      type="text" 
                      value={profile.disclosures.bankruptcies} 
                      onChange={(e) => updateProfile({ disclosures: { ...profile.disclosures, bankruptcies: e.target.value } })}
                      style={{ padding: '8px 12px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '14px' }}
                    />
                    
                    <div style={{ fontSize: '14px', color: '#1e293b' }}>Liens or Judgements (business, equipment)</div>
                    <input 
                      type="text" 
                      value={profile.disclosures.liens} 
                      onChange={(e) => updateProfile({ disclosures: { ...profile.disclosures, liens: e.target.value } })}
                      style={{ padding: '8px 12px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '14px' }}
                    />
                    
                    <div style={{ fontSize: '14px', color: '#1e293b' }}>Material Contract Covenants (e.g. on loans)</div>
                    <input 
                      type="text" 
                      value={profile.disclosures.contracts} 
                      onChange={(e) => updateProfile({ disclosures: { ...profile.disclosures, contracts: e.target.value } })}
                      style={{ padding: '8px 12px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '14px' }}
                    />
                    
                    <div style={{ fontSize: '14px', color: '#1e293b' }}>Lawsuits (as plaintiff a/o defendant)</div>
                    <input 
                      type="text" 
                      value={profile.disclosures.lawsuits} 
                      onChange={(e) => updateProfile({ disclosures: { ...profile.disclosures, lawsuits: e.target.value } })}
                      style={{ padding: '8px 12px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '14px' }}
                    />
                    
                    <div style={{ fontSize: '14px', color: '#1e293b' }}>Most Favored Nation on contracts</div>
                    <input 
                      type="text" 
                      value={profile.disclosures.mostFavoredNation} 
                      onChange={(e) => updateProfile({ disclosures: { ...profile.disclosures, mostFavoredNation: e.target.value } })}
                      style={{ padding: '8px 12px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '14px' }}
                    />
                    
                    <div style={{ fontSize: '14px', color: '#1e293b' }}>Equity Control (who/how many needed)</div>
                    <input 
                      type="text" 
                      value={profile.disclosures.equityControl} 
                      onChange={(e) => updateProfile({ disclosures: { ...profile.disclosures, equityControl: e.target.value } })}
                      style={{ padding: '8px 12px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '14px' }}
                    />
                    
                    <div style={{ fontSize: '14px', color: '#1e293b' }}>Right of First Refusal on sale</div>
                    <input 
                      type="text" 
                      value={profile.disclosures.rightOfFirstRefusal} 
                      onChange={(e) => updateProfile({ disclosures: { ...profile.disclosures, rightOfFirstRefusal: e.target.value } })}
                      style={{ padding: '8px 12px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '14px' }}
                    />
                    
                    <div style={{ fontSize: '14px', color: '#1e293b' }}>Shareholder Protections (i.e. blocking/approvals)</div>
                    <input 
                      type="text" 
                      value={profile.disclosures.shareholderProtections} 
                      onChange={(e) => updateProfile({ disclosures: { ...profile.disclosures, shareholderProtections: e.target.value } })}
                      style={{ padding: '8px 12px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '14px' }}
                    />
                    
                    <div style={{ fontSize: '14px', color: '#1e293b' }}>Change-in-Control triggers (i.e. with customers and/or suppliers)</div>
                    <input 
                      type="text" 
                      value={profile.disclosures.changeInControl} 
                      onChange={(e) => updateProfile({ disclosures: { ...profile.disclosures, changeInControl: e.target.value } })}
                      style={{ padding: '8px 12px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '14px' }}
                    />
                    
                    <div style={{ fontSize: '14px', color: '#1e293b' }}>Regulatory Approvals (local/State/Federal)</div>
                    <input 
                      type="text" 
                      value={profile.disclosures.regulatoryApprovals} 
                      onChange={(e) => updateProfile({ disclosures: { ...profile.disclosures, regulatoryApprovals: e.target.value } })}
                      style={{ padding: '8px 12px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '14px' }}
                    />
                    
                    <div style={{ fontSize: '14px', color: '#1e293b' }}>Audited Financial Statements</div>
                    <select
                      value={profile.disclosures.auditedFinancials}
                      onChange={(e) => updateProfile({ disclosures: { ...profile.disclosures, auditedFinancials: e.target.value } })}
                      style={{ padding: '8px 12px', borderRadius: '6px', border: '1px solid #cbd5e1', fontSize: '14px' }}
                    >
                      <option value="Yes">Yes</option>
                      <option value="No">No</option>
                      <option value="Partial">Partial</option>
                    </select>
                  </div>
                </div>

                <div className="no-print" style={{ textAlign: 'center', padding: '24px' }}>
                  <button
                    onClick={async () => {
                      setIsLoading(true);
                      try {
                        await profilesApi.save(selectedCompanyId, profile);
                        alert('Profile saved successfully!');
                      } catch (error) {
                        alert(error instanceof ApiError ? error.message : 'Failed to save profile');
                      } finally {
                        setIsLoading(false);
                      }
                    }}
                    disabled={isLoading}
                    style={{ 
                      padding: '12px 32px', 
                      background: isLoading ? '#94a3b8' : '#667eea', 
                      color: 'white', 
                      border: 'none', 
                      borderRadius: '8px', 
                      fontSize: '16px', 
                      fontWeight: '600', 
                      cursor: isLoading ? 'not-allowed' : 'pointer',
                      boxShadow: '0 4px 6px rgba(102, 126, 234, 0.3)',
                      opacity: isLoading ? 0.7 : 1
                    }}
                  >
                    {isLoading ? 'Saving...' : 'Save Profile'}
                  </button>
                </div>
              </>
            );
          })()}
        </div>
      )}

      {/* Management Assessment - Questionnaire View */}
      {(() => {
        const hasCompanyId = selectedCompanyId || currentUser?.companyId;
        const hasCorrectRole = (currentUser?.role === 'user' && currentUser?.userType === 'assessment') || currentUser?.role === 'consultant';
        const canView = currentView === 'ma-questionnaire' && hasCompanyId && hasCorrectRole;
        
        console.log('📋 Questionnaire render check:', {
          currentView,
          isQuestionnaireView: currentView === 'ma-questionnaire',
          selectedCompanyId,
          userCompanyId: currentUser?.companyId,
          hasCompanyId,
          role: currentUser?.role,
          userType: currentUser?.userType,
          hasCorrectRole,
          canView
        });
        
        return canView;
      })() && (
        <div style={{ maxWidth: '1200px', margin: '0 auto', padding: '32px' }}>
          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '32px' }}>
            <h1 style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b', margin: 0 }}>Management Assessment Questionnaire</h1>
            {companyName && <div style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b' }}>{companyName}</div>}
          </div>
          
          {currentUser?.role === 'consultant' && (
            <div style={{ background: '#fffbeb', border: '2px solid #fbbf24', borderRadius: '12px', padding: '20px', marginBottom: '12px' }}>
              <h3 style={{ fontSize: '18px', fontWeight: '600', color: '#92400e', marginBottom: '8px' }}>⚠ Consultant View Only</h3>
              <p style={{ fontSize: '14px', color: '#78350f', margin: 0 }}>
                As a consultant, you can view this questionnaire but cannot fill it out. Only company users can complete assessments. 
                Navigate to "View Assessments" in the Administrator Dashboard to see user responses.
              </p>
            </div>
          )}
          
          <div style={{ background: 'white', borderRadius: '12px', padding: '24px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)', opacity: currentUser?.role === 'consultant' ? 0.6 : 1, pointerEvents: currentUser?.role === 'consultant' ? 'none' : 'auto' }}>
            <div style={{ background: '#f0f9ff', border: '1px solid #bae6fd', borderRadius: '8px', padding: '16px', marginBottom: '12px' }}>
              <h3 style={{ fontSize: '16px', fontWeight: '600', color: '#0c4a6e', marginBottom: '8px' }}>Rating Scale</h3>
              <div style={{ fontSize: '13px', color: '#0c4a6e', lineHeight: '1.6' }}>
                <strong>1:</strong> No evidence to support practices or any knowledge of subject<br />
                <strong>2:</strong> Limited practices in place, limited knowledge of subject<br />
                <strong>3:</strong> Basic practices in place, basic awareness of subject<br />
                <strong>4:</strong> Clear practices in place, above average knowledge of subject<br />
                <strong>5:</strong> Extensive practices in place, extensive knowledge of subject
              </div>
            </div>

            {assessmentData.map((category) => (
              <div key={category.id} style={{ marginBottom: '32px', background: '#f8fafc', borderRadius: '8px', padding: '20px', border: '1px solid #e2e8f0' }}>
                <h2 style={{ fontSize: '20px', fontWeight: '600', color: '#1e293b', marginBottom: '16px', borderBottom: '2px solid #cbd5e1', paddingBottom: '8px' }}>
                  {category.id}. {category.name}
                </h2>
                
                {category.questions.map((question) => (
                  <div key={question.id} style={{ marginBottom: '16px', background: 'white', borderRadius: '8px', padding: '16px', border: unansweredQuestions.includes(question.id) ? '2px solid #ef4444' : '1px solid #e2e8f0' }}>
                    <label style={{ display: 'block', fontSize: '14px', color: '#475569', marginBottom: '12px', fontWeight: '500' }}>
                      {question.text}
                    </label>
                    <div style={{ display: 'flex', gap: '12px', flexWrap: 'wrap' }}>
                      {[1, 2, 3, 4, 5].map((rating) => (
                        <label key={rating} style={{ display: 'flex', alignItems: 'center', gap: '6px', cursor: 'pointer', padding: '8px 12px', background: assessmentResponses[question.id] === rating ? '#667eea' : '#f1f5f9', color: assessmentResponses[question.id] === rating ? 'white' : '#475569', borderRadius: '6px', fontSize: '14px', fontWeight: '600', border: assessmentResponses[question.id] === rating ? '2px solid #667eea' : '1px solid #cbd5e1', transition: 'all 0.2s' }}>
                          <input 
                            type="radio" 
                            name={question.id} 
                            value={rating} 
                            checked={assessmentResponses[question.id] === rating}
                            onChange={() => setAssessmentResponses(prev => ({ ...prev, [question.id]: rating }))}
                            style={{ display: 'none' }}
                          />
                          {rating}
                        </label>
                      ))}
                    </div>
                    {unansweredQuestions.includes(question.id) && (
                      <div style={{ marginTop: '8px', fontSize: '12px', color: '#ef4444', fontWeight: '600' }}>
                        ⚠ Please select a rating
                      </div>
                    )}
                  </div>
                ))}
                
                <div style={{ marginTop: '16px' }}>
                  <label style={{ display: 'block', fontSize: '14px', fontWeight: '600', color: '#475569', marginBottom: '8px' }}>
                    Notes for {category.name}:
                  </label>
                  <textarea
                    value={assessmentNotes[category.id] || ''}
                    onChange={(e) => setAssessmentNotes(prev => ({ ...prev, [category.id]: e.target.value }))}
                    style={{ width: '100%', minHeight: '80px', padding: '12px', borderRadius: '8px', border: '1px solid #cbd5e1', fontSize: '14px', fontFamily: 'inherit', resize: 'vertical' }}
                    placeholder="Add notes or action items..."
                  />
                </div>
              </div>
            ))}

            <div style={{ display: 'flex', gap: '12px', justifyContent: 'center', marginTop: '32px' }}>
              <button 
                onClick={async () => {
                  const allQuestions = assessmentData.flatMap(cat => cat.questions.map(q => q.id));
                  const unanswered = allQuestions.filter(qId => !assessmentResponses[qId]);
                  setUnansweredQuestions(unanswered);
                  
                  if (unanswered.length === 0) {
                    setIsLoading(true);
                    try {
                      const totalScore = Object.values(assessmentResponses).reduce((sum, val) => sum + val, 0) / Object.keys(assessmentResponses).length;
                      
                      const { record } = await assessmentsApi.create({
                        userId: currentUser!.id,
                        companyId: selectedCompanyId,
                        responses: assessmentResponses,
                        notes: assessmentNotes,
                        overallScore: totalScore,
                        isCompleted: true
                      });
                      
                      // Add to local state with proper structure
                      const assessmentRecord: AssessmentRecord = {
                        id: record.id,
                        userEmail: currentUser?.email || '',
                        userName: currentUser?.name || '',
                        companyId: selectedCompanyId,
                        companyName: company?.name || '',
                        responses: assessmentResponses,
                        notes: assessmentNotes,
                        completedDate: record.completedAt,
                        overallScore: totalScore
                      };
                      
                      setAssessmentRecords(prev => [...prev, assessmentRecord]);
                      alert('Assessment saved successfully!');
                      setCurrentView('ma-your-results');
                    } catch (error) {
                      alert(error instanceof ApiError ? error.message : 'Failed to save assessment');
                    } finally {
                      setIsLoading(false);
                    }
                  } else {
                    alert(`Please answer all ${unanswered.length} unanswered question(s) before saving.`);
                  }
                }}
                disabled={isLoading}
                style={{ padding: '14px 32px', background: isLoading ? '#94a3b8' : '#667eea', color: 'white', border: 'none', borderRadius: '8px', fontSize: '16px', fontWeight: '600', cursor: isLoading ? 'not-allowed' : 'pointer', boxShadow: '0 4px 12px rgba(102,126,234,0.3)', opacity: isLoading ? 0.7 : 1 }}
              >
                {isLoading ? 'Saving...' : 'Save Assessment'}
              </button>
              <button 
                onClick={() => {
                  if (confirm('Are you sure you want to reset all responses?')) {
                    setAssessmentResponses({});
                    setAssessmentNotes({});
                    setUnansweredQuestions([]);
                  }
                }}
                style={{ padding: '14px 32px', background: '#f1f5f9', color: '#475569', border: 'none', borderRadius: '8px', fontSize: '16px', fontWeight: '600', cursor: 'pointer' }}
              >
                Reset
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Management Assessment - Your Results View */}
      {currentView === 'ma-your-results' && selectedCompanyId && ((currentUser?.role === 'user' && currentUser?.userType === 'assessment') || currentUser?.role === 'consultant') && (
        <div style={{ maxWidth: '1400px', margin: '0 auto', padding: '32px' }}>
          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '32px' }}>
            <h1 style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b', margin: 0 }}>
              {currentUser?.role === 'consultant' ? 'Assessment Results - All Participants' : 'Your Assessment Results'}
            </h1>
            {companyName && <div style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b' }}>{companyName}</div>}
          </div>
          
          {currentUser?.role === 'consultant' ? (
            // Show all participants' results for consultants
            <>
              {assessmentRecords.filter(r => r.companyId === selectedCompanyId).length === 0 ? (
                <div style={{ background: 'white', borderRadius: '12px', padding: '60px', textAlign: 'center', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                  <div style={{ fontSize: '48px', marginBottom: '16px' }}>📋</div>
                  <h3 style={{ fontSize: '20px', fontWeight: '600', color: '#64748b', marginBottom: '8px' }}>No Assessments Yet</h3>
                  <p style={{ fontSize: '14px', color: '#94a3b8' }}>No users have completed assessments for this company</p>
                </div>
              ) : (
                <div style={{ display: 'grid', gap: '24px' }}>
                  {assessmentRecords.filter(r => r.companyId === selectedCompanyId).map((record) => (
                    <div key={record.id} style={{ background: 'white', borderRadius: '12px', padding: '24px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px', borderBottom: '2px solid #e2e8f0', paddingBottom: '16px' }}>
                        <div>
                          <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '4px' }}>{record.user?.name || record.userName || 'Unknown User'}</h2>
                          <div style={{ fontSize: '14px', color: '#64748b' }}>
                            Completed: {new Date(record.completedAt || record.completedDate || '').toLocaleDateString()} | 
                            <span style={{ fontWeight: '600', color: '#667eea', marginLeft: '8px' }}>Overall Score: {record.overallScore.toFixed(2)}/5.0</span>
                          </div>
                        </div>
                      </div>
                      
                      <h3 style={{ fontSize: '18px', fontWeight: '600', color: '#475569', marginBottom: '16px' }}>Scores by Category</h3>
                      <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(180px, 1fr))', gap: '12px' }}>
                        {assessmentData.map((category) => {
                          const categoryQuestions = category.questions.map(q => q.id);
                          const categoryResponses = categoryQuestions.map(qId => record.responses[qId]).filter(r => r !== undefined);
                          const avgScore = categoryResponses.length > 0 ? categoryResponses.reduce((sum, val) => sum + val, 0) / categoryResponses.length : 0;
                          
                          return (
                            <div key={category.id} style={{ background: '#f8fafc', borderRadius: '8px', padding: '12px', border: '1px solid #e2e8f0' }}>
                              <div style={{ fontSize: '11px', fontWeight: '600', color: '#64748b', marginBottom: '6px' }}>{category.name}</div>
                              <div style={{ fontSize: '24px', fontWeight: '700', color: '#667eea' }}>{avgScore.toFixed(2)}</div>
                              <div style={{ fontSize: '10px', color: '#64748b', marginTop: '2px' }}>out of 5.0</div>
                            </div>
                          );
                        })}
                      </div>
                    </div>
                  ))}
                </div>
              )}
            </>
          ) : (
            // Show individual results for users
            <div style={{ background: 'white', borderRadius: '12px', padding: '24px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
              <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '12px' }}>Score by Category</h2>
              
              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '16px', marginBottom: '12px' }}>
                {assessmentData.map((category) => {
                  const categoryQuestions = category.questions.map(q => q.id);
                  const categoryResponses = categoryQuestions.map(qId => assessmentResponses[qId]).filter(r => r !== undefined);
                  const avgScore = categoryResponses.length > 0 ? categoryResponses.reduce((sum, val) => sum + val, 0) / categoryResponses.length : 0;
                  
                  return (
                    <div key={category.id} style={{ background: '#f8fafc', borderRadius: '8px', padding: '16px', border: '1px solid #e2e8f0' }}>
                      <div style={{ fontSize: '12px', fontWeight: '600', color: '#64748b', marginBottom: '8px' }}>{category.name}</div>
                      <div style={{ fontSize: '32px', fontWeight: '700', color: '#667eea' }}>{avgScore.toFixed(2)}</div>
                      <div style={{ fontSize: '11px', color: '#64748b', marginTop: '4px' }}>out of 5.0</div>
                    </div>
                  );
                })}
              </div>

              <div style={{ display: 'flex', gap: '12px', justifyContent: 'center' }}>
                <button 
                  onClick={() => setCurrentView('ma-questionnaire')}
                  style={{ padding: '12px 24px', background: '#667eea', color: 'white', border: 'none', borderRadius: '8px', fontSize: '14px', fontWeight: '600', cursor: 'pointer' }}
                >
                  Edit Assessment
                </button>
              </div>
            </div>
          )}
        </div>
      )}
          </>
          )}

          {/* Management Assessment Views - Available to all users including assessment users */}
          {/* Management Assessment - Welcome View */}
      {currentView === 'ma-welcome' && ((currentUser?.role === 'user' && currentUser?.userType === 'assessment') || currentUser?.role === 'consultant') && (
        <div style={{ maxWidth: '1200px', margin: '0 auto', padding: '32px' }}>
          <div style={{ background: 'white', borderRadius: '12px', padding: '40px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
            {companyName && <div style={{ fontSize: '36px', fontWeight: '700', color: '#1e293b', textAlign: 'center', marginBottom: '12px' }}>{companyName}</div>}
            <h1 style={{ fontSize: '36px', fontWeight: '700', color: '#1e293b', marginBottom: '12px', textAlign: 'center' }}>Management Assessment Questionnaire</h1>
            
            <div style={{ fontSize: '16px', color: '#475569', lineHeight: '1.8', maxWidth: '900px', margin: '0 auto 32px', textAlign: 'left' }}>
              <p style={{ marginBottom: '16px' }}>
                Our Trademarked assessment tool is designed to facilitate the discovery of Management Maturity Level in small businesses. It has been developed to highlight areas under financial management that can be targeted for improvement.
              </p>
              
              <p style={{ marginBottom: '16px' }}>
                The tool is a questionnaire to be completed by the key employees in your company. It is designed as a tool for management to help you better understand the strengths and weaknesses of your processes and communications across teams in your company.
              </p>
              
              <p style={{ marginBottom: '0' }}>
                The Management Assessment service provides detailed evaluation of your company's management practices, leadership effectiveness, and organizational structure to help you optimize performance and drive growth.
              </p>
            </div>
            
            <div style={{ background: '#f8fafc', borderRadius: '12px', padding: '32px', marginTop: '32px', textAlign: 'left' }}>
              <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '20px' }}>Topics Covered</h2>
              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '12px', fontSize: '14px', color: '#475569' }}>
                {assessmentData.map((cat) => (
                  <div key={cat.id} style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
                    <span style={{ color: '#10b981', fontSize: '18px' }}>✓</span>
                    <span>{cat.name}</span>
                  </div>
                ))}
              </div>
            </div>

            <button 
              onClick={() => setCurrentView('ma-questionnaire')}
              style={{ marginTop: '32px', padding: '16px 48px', background: '#667eea', color: 'white', border: 'none', borderRadius: '8px', fontSize: '18px', fontWeight: '600', cursor: 'pointer', boxShadow: '0 4px 12px rgba(102,126,234,0.3)' }}
            >
              Start Assessment
            </button>
          </div>
        </div>
      )}

      {/* Management Assessment - Scores Summary View */}
      {currentView === 'ma-scores-summary' && selectedCompanyId && ((currentUser?.role === 'user' && currentUser?.userType === 'assessment') || currentUser?.role === 'consultant') && (
        <div style={{ maxWidth: '1200px', margin: '0 auto', padding: '32px' }}>
          <h1 style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b', marginBottom: '32px' }}>Scores Summary - All Participants</h1>
          
          <div style={{ background: 'white', borderRadius: '12px', padding: '24px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
            <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '12px' }}>Average Scores Across All Participants</h2>
            
            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '16px' }}>
              {assessmentData.map((category) => {
                const companyRecords = assessmentRecords.filter(r => r.companyId === selectedCompanyId);
                const allCategoryScores = companyRecords.map(record => {
                  const categoryQuestions = category.questions.map(q => q.id);
                  const categoryResponses = categoryQuestions.map(qId => record.responses[qId]).filter(r => r !== undefined);
                  return categoryResponses.length > 0 ? categoryResponses.reduce((sum, val) => sum + val, 0) / categoryResponses.length : 0;
                }).filter(s => s > 0);
                
                const avgScore = allCategoryScores.length > 0 ? allCategoryScores.reduce((sum, val) => sum + val, 0) / allCategoryScores.length : 0;
                
                return (
                  <div key={category.id} style={{ background: '#f8fafc', borderRadius: '8px', padding: '16px', border: '1px solid #e2e8f0' }}>
                    <div style={{ fontSize: '12px', fontWeight: '600', color: '#64748b', marginBottom: '8px' }}>{category.name}</div>
                    <div style={{ fontSize: '32px', fontWeight: '700', color: '#667eea' }}>{avgScore.toFixed(2)}</div>
                    <div style={{ fontSize: '11px', color: '#64748b', marginTop: '4px' }}>avg across {allCategoryScores.length} participant(s)</div>
                  </div>
                );
              })}
            </div>
          </div>
        </div>
      )}

      {/* Management Assessment - Scoring Guide View */}
      {currentView === 'ma-scoring-guide' && ((currentUser?.role === 'user' && currentUser?.userType === 'assessment') || currentUser?.role === 'consultant') && (
        <div style={{ maxWidth: '1200px', margin: '0 auto', padding: '32px' }}>
          <h1 style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b', marginBottom: '32px' }}>Scoring Guide</h1>
          
          <div style={{ background: 'white', borderRadius: '12px', padding: '32px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
            <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '12px' }}>Rating Scale Descriptions</h2>
            
            <div style={{ display: 'grid', gap: '16px' }}>
              <div style={{ background: '#fee2e2', borderRadius: '8px', padding: '20px', border: '2px solid #ef4444' }}>
                <div style={{ fontSize: '24px', fontWeight: '700', color: '#991b1b', marginBottom: '8px' }}>1 - No Evidence</div>
                <p style={{ fontSize: '14px', color: '#7f1d1d', margin: 0 }}>No evidence to support practices or any knowledge of subject</p>
              </div>
              <div style={{ background: '#fed7aa', borderRadius: '8px', padding: '20px', border: '2px solid #f97316' }}>
                <div style={{ fontSize: '24px', fontWeight: '700', color: '#9a3412', marginBottom: '8px' }}>2 - Limited</div>
                <p style={{ fontSize: '14px', color: '#7c2d12', margin: 0 }}>Limited practices in place, limited knowledge of subject</p>
              </div>
              <div style={{ background: '#fef3c7', borderRadius: '8px', padding: '20px', border: '2px solid #f59e0b' }}>
                <div style={{ fontSize: '24px', fontWeight: '700', color: '#92400e', marginBottom: '8px' }}>3 - Basic</div>
                <p style={{ fontSize: '14px', color: '#78350f', margin: 0 }}>Basic practices in place, basic awareness of subject</p>
              </div>
              <div style={{ background: '#dbeafe', borderRadius: '8px', padding: '20px', border: '2px solid #3b82f6' }}>
                <div style={{ fontSize: '24px', fontWeight: '700', color: '#1e40af', marginBottom: '8px' }}>4 - Clear Practices</div>
                <p style={{ fontSize: '14px', color: '#1e3a8a', margin: 0 }}>Clear practices in place, above average knowledge of subject</p>
              </div>
              <div style={{ background: '#d1fae5', borderRadius: '8px', padding: '20px', border: '2px solid #10b981' }}>
                <div style={{ fontSize: '24px', fontWeight: '700', color: '#065f46', marginBottom: '8px' }}>5 - Extensive</div>
                <p style={{ fontSize: '14px', color: '#064e3b', margin: 0 }}>Extensive practices in place, extensive knowledge of subject</p>
              </div>
            </div>
          </div>
        </div>
      )}

      {/* Management Assessment - Charts View */}
      {currentView === 'ma-charts' && selectedCompanyId && ((currentUser?.role === 'user' && currentUser?.userType === 'assessment') || currentUser?.role === 'consultant') && (
        <div style={{ maxWidth: '1200px', margin: '0 auto', padding: '32px' }}>
          <h1 style={{ fontSize: '32px', fontWeight: '700', color: '#1e293b', marginBottom: '32px' }}>Assessment Charts</h1>
          
          {(currentUser?.role === 'consultant' ? assessmentRecords.filter(r => r.companyId === selectedCompanyId).length === 0 : Object.keys(assessmentResponses).length === 0) ? (
            <div style={{ background: 'white', borderRadius: '12px', padding: '40px', textAlign: 'center', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
              <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#64748b', marginBottom: '16px' }}>No Assessment Data</h2>
              <p style={{ fontSize: '16px', color: '#94a3b8', marginBottom: '12px' }}>
                {currentUser?.role === 'consultant' ? 'No users have completed assessments for this company yet.' : 'Please complete the questionnaire first to view charts.'}
              </p>
              {currentUser?.role !== 'consultant' && (
                <button 
                  onClick={() => setCurrentView('ma-questionnaire')}
                  style={{ padding: '12px 32px', background: '#667eea', color: 'white', border: 'none', borderRadius: '8px', fontSize: '16px', fontWeight: '600', cursor: 'pointer' }}
                >
                  Go to Questionnaire
                </button>
              )}
            </div>
          ) : (
            <>
              <div style={{ background: 'white', borderRadius: '12px', padding: '24px', marginBottom: '12px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
                <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '12px' }}>
                  {currentUser?.role === 'consultant' ? 'Average Category Scores - All Participants' : 'Category Scores - Bar Chart'}
                </h2>
                
                <div style={{ padding: '20px' }}>
              {assessmentData.map((category) => {
                const categoryQuestions = category.questions.map(q => q.id);
                
                let avgScore = 0;
                if (currentUser?.role === 'consultant') {
                  // Calculate average across all assessment records for this company
                  const companyRecords = assessmentRecords.filter(r => r.companyId === selectedCompanyId);
                  const allCategoryScores = companyRecords.map(record => {
                    const categoryResponses = categoryQuestions.map(qId => record.responses[qId]).filter(r => r !== undefined);
                    return categoryResponses.length > 0 ? categoryResponses.reduce((sum, val) => sum + val, 0) / categoryResponses.length : 0;
                  }).filter(s => s > 0);
                  avgScore = allCategoryScores.length > 0 ? allCategoryScores.reduce((sum, val) => sum + val, 0) / allCategoryScores.length : 0;
                } else {
                  // Use current user's responses
                  const categoryResponses = categoryQuestions.map(qId => assessmentResponses[qId]).filter(r => r !== undefined);
                  avgScore = categoryResponses.length > 0 ? categoryResponses.reduce((sum, val) => sum + val, 0) / categoryResponses.length : 0;
                }
                
                const percentage = (avgScore / 5) * 100;
                
                return (
                  <div key={category.id} style={{ marginBottom: '16px' }}>
                    <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '6px' }}>
                      <span style={{ fontSize: '14px', fontWeight: '600', color: '#475569' }}>{category.name}</span>
                      <span style={{ fontSize: '14px', fontWeight: '700', color: '#667eea' }}>{avgScore.toFixed(2)} / 5.0</span>
                    </div>
                    <div style={{ background: '#e2e8f0', borderRadius: '8px', height: '24px', overflow: 'hidden' }}>
                      <div style={{ background: 'linear-gradient(90deg, #667eea 0%, #764ba2 100%)', height: '100%', width: `${percentage}%`, transition: 'width 0.5s', display: 'flex', alignItems: 'center', justifyContent: 'flex-end', paddingRight: '8px' }}>
                        {percentage > 15 && <span style={{ fontSize: '12px', fontWeight: '600', color: 'white' }}>{percentage.toFixed(0)}%</span>}
                      </div>
                    </div>
                  </div>
                );
              })}
            </div>
          </div>

          <div style={{ background: 'white', borderRadius: '12px', padding: '24px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
            <h2 style={{ fontSize: '24px', fontWeight: '600', color: '#1e293b', marginBottom: '12px' }}>Category Scores - Radar Chart</h2>
            
            <div style={{ display: 'flex', justifyContent: 'center', padding: '20px' }}>
              <svg width="500" height="500" viewBox="0 0 500 500">
                <g transform="translate(250, 250)">
                  {/* Draw concentric circles */}
                  {[1, 2, 3, 4, 5].map((level) => (
                    <circle
                      key={level}
                      cx="0"
                      cy="0"
                      r={level * 40}
                      fill="none"
                      stroke="#e2e8f0"
                      strokeWidth="1"
                    />
                  ))}
                  
                  {/* Draw axis lines and labels */}
                  {assessmentData.map((category, idx) => {
                    const angle = (idx * 2 * Math.PI) / assessmentData.length - Math.PI / 2;
                    const x2 = Math.cos(angle) * 200;
                    const y2 = Math.sin(angle) * 200;
                    const labelX = Math.cos(angle) * 220;
                    const labelY = Math.sin(angle) * 220;
                    
                    return (
                      <g key={category.id}>
                        <line x1="0" y1="0" x2={x2} y2={y2} stroke="#cbd5e1" strokeWidth="1" />
                        <text
                          x={labelX}
                          y={labelY}
                          textAnchor="middle"
                          fontSize="11"
                          fontWeight="600"
                          fill="#475569"
                          dominantBaseline="middle"
                        >
                          {category.name.length > 20 ? category.name.substring(0, 18) + '...' : category.name}
                        </text>
                      </g>
                    );
                  })}
                  
                  {/* Draw data polygon */}
                  <polygon
                    points={assessmentData.map((category, idx) => {
                      const categoryQuestions = category.questions.map(q => q.id);
                      
                      let avgScore = 0;
                      if (currentUser?.role === 'consultant') {
                        // Calculate average across all assessment records for this company
                        const companyRecords = assessmentRecords.filter(r => r.companyId === selectedCompanyId);
                        const allCategoryScores = companyRecords.map(record => {
                          const categoryResponses = categoryQuestions.map(qId => record.responses[qId]).filter(r => r !== undefined);
                          return categoryResponses.length > 0 ? categoryResponses.reduce((sum, val) => sum + val, 0) / categoryResponses.length : 0;
                        }).filter(s => s > 0);
                        avgScore = allCategoryScores.length > 0 ? allCategoryScores.reduce((sum, val) => sum + val, 0) / allCategoryScores.length : 0;
                      } else {
                        // Use current user's responses
                        const categoryResponses = categoryQuestions.map(qId => assessmentResponses[qId]).filter(r => r !== undefined);
                        avgScore = categoryResponses.length > 0 ? categoryResponses.reduce((sum, val) => sum + val, 0) / categoryResponses.length : 0;
                      }
                      
                      const angle = (idx * 2 * Math.PI) / assessmentData.length - Math.PI / 2;
                      const radius = (avgScore / 5) * 200;
                      const x = Math.cos(angle) * radius;
                      const y = Math.sin(angle) * radius;
                      return `${x},${y}`;
                    }).join(' ')}
                    fill="rgba(102, 126, 234, 0.2)"
                    stroke="#667eea"
                    strokeWidth="3"
                  />
                  
                  {/* Draw data points */}
                  {assessmentData.map((category, idx) => {
                    const categoryQuestions = category.questions.map(q => q.id);
                    
                    let avgScore = 0;
                    if (currentUser?.role === 'consultant') {
                      // Calculate average across all assessment records for this company
                      const companyRecords = assessmentRecords.filter(r => r.companyId === selectedCompanyId);
                      const allCategoryScores = companyRecords.map(record => {
                        const categoryResponses = categoryQuestions.map(qId => record.responses[qId]).filter(r => r !== undefined);
                        return categoryResponses.length > 0 ? categoryResponses.reduce((sum, val) => sum + val, 0) / categoryResponses.length : 0;
                      }).filter(s => s > 0);
                      avgScore = allCategoryScores.length > 0 ? allCategoryScores.reduce((sum, val) => sum + val, 0) / allCategoryScores.length : 0;
                    } else {
                      // Use current user's responses
                      const categoryResponses = categoryQuestions.map(qId => assessmentResponses[qId]).filter(r => r !== undefined);
                      avgScore = categoryResponses.length > 0 ? categoryResponses.reduce((sum, val) => sum + val, 0) / categoryResponses.length : 0;
                    }
                    
                    const angle = (idx * 2 * Math.PI) / assessmentData.length - Math.PI / 2;
                    const radius = (avgScore / 5) * 200;
                    const x = Math.cos(angle) * radius;
                    const y = Math.sin(angle) * radius;
                    
                    return (
                      <circle key={category.id} cx={x} cy={y} r="6" fill="#667eea" stroke="white" strokeWidth="2">
                        <title>{category.name}: {avgScore.toFixed(2)}</title>
                      </circle>
                    );
                  })}
                  
                  {/* Center circle with legend */}
                  <circle cx="0" cy="0" r="30" fill="white" stroke="#cbd5e1" strokeWidth="1" />
                  <text x="0" y="-5" textAnchor="middle" fontSize="10" fontWeight="600" fill="#64748b">Scale</text>
                  <text x="0" y="8" textAnchor="middle" fontSize="10" fill="#64748b">1 to 5</text>
                </g>
              </svg>
            </div>
          </div>
            </>
          )}
        </div>
      )}

      {/* Custom Print View - For Consultants and Company Users */}
      {currentView === 'custom-print' && (currentUser?.role === 'consultant' || (currentUser?.role === 'user' && currentUser?.userType === 'company')) && (
        <div style={{ maxWidth: '1000px', margin: '0 auto', padding: '32px' }}>
          <div style={{ background: 'white', borderRadius: '12px', padding: '40px', boxShadow: '0 2px 8px rgba(0,0,0,0.06)' }}>
            <h1 style={{ fontSize: '36px', fontWeight: '700', color: '#1e293b', marginBottom: '16px' }}>Custom Print Package</h1>
            <p style={{ fontSize: '16px', color: '#64748b', marginBottom: '32px' }}>
              Select the reports you want to include in your custom print package
            </p>
            
            <div style={{ marginBottom: '32px' }}>
              {/* MD&A Report */}
              <div style={{ marginBottom: '20px', padding: '16px', background: '#f8fafc', borderRadius: '8px', border: '1px solid #e2e8f0' }}>
                <label style={{ display: 'flex', alignItems: 'center', cursor: 'pointer' }}>
                  <input 
                    type="checkbox" 
                    checked={printPackageSelections.mda}
                    onChange={(e) => setPrintPackageSelections({...printPackageSelections, mda: e.target.checked})}
                    style={{ width: '18px', height: '18px', marginRight: '12px', cursor: 'pointer' }}
                  />
                  <div>
                    <div style={{ fontSize: '16px', fontWeight: '600', color: '#1e293b' }}>MD&A (Management Discussion & Analysis)</div>
                    <div style={{ fontSize: '13px', color: '#64748b', marginTop: '4px' }}>Includes all 3 tabs: Key Metrics, Analysis, and Recommendations</div>
                  </div>
                </label>
              </div>

              {/* Financial Score */}
              <div style={{ marginBottom: '20px', padding: '16px', background: '#f8fafc', borderRadius: '8px', border: '1px solid #e2e8f0' }}>
                <label style={{ display: 'flex', alignItems: 'center', cursor: 'pointer' }}>
                  <input 
                    type="checkbox" 
                    checked={printPackageSelections.financialScore}
                    onChange={(e) => setPrintPackageSelections({...printPackageSelections, financialScore: e.target.checked})}
                    style={{ width: '18px', height: '18px', marginRight: '12px', cursor: 'pointer' }}
                  />
                  <div>
                    <div style={{ fontSize: '16px', fontWeight: '600', color: '#1e293b' }}>Financial Score</div>
                    <div style={{ fontSize: '13px', color: '#64748b', marginTop: '4px' }}>Score summary and trends</div>
                  </div>
                </label>
              </div>

              {/* Priority Ratios */}
              <div style={{ marginBottom: '20px', padding: '16px', background: '#f8fafc', borderRadius: '8px', border: '1px solid #e2e8f0' }}>
                <label style={{ display: 'flex', alignItems: 'center', cursor: 'pointer' }}>
                  <input 
                    type="checkbox" 
                    checked={printPackageSelections.priorityRatios}
                    onChange={(e) => setPrintPackageSelections({...printPackageSelections, priorityRatios: e.target.checked})}
                    style={{ width: '18px', height: '18px', marginRight: '12px', cursor: 'pointer' }}
                  />
                  <div>
                    <div style={{ fontSize: '16px', fontWeight: '600', color: '#1e293b' }}>Priority Ratios</div>
                    <div style={{ fontSize: '13px', color: '#64748b', marginTop: '4px' }}>Key financial ratios and metrics</div>
                  </div>
                </label>
              </div>

              {/* Working Capital */}
              <div style={{ marginBottom: '20px', padding: '16px', background: '#f8fafc', borderRadius: '8px', border: '1px solid #e2e8f0' }}>
                <label style={{ display: 'flex', alignItems: 'center', cursor: 'pointer' }}>
                  <input 
                    type="checkbox" 
                    checked={printPackageSelections.workingCapital}
                    onChange={(e) => setPrintPackageSelections({...printPackageSelections, workingCapital: e.target.checked})}
                    style={{ width: '18px', height: '18px', marginRight: '12px', cursor: 'pointer' }}
                  />
                  <div>
                    <div style={{ fontSize: '16px', fontWeight: '600', color: '#1e293b' }}>Working Capital</div>
                    <div style={{ fontSize: '13px', color: '#64748b', marginTop: '4px' }}>Working capital analysis</div>
                  </div>
                </label>
              </div>

              {/* Cash Flow Tabs */}
              <div style={{ marginBottom: '20px', padding: '16px', background: '#f8fafc', borderRadius: '8px', border: '1px solid #e2e8f0' }}>
                <div style={{ marginBottom: '12px' }}>
                  <div style={{ fontSize: '16px', fontWeight: '600', color: '#1e293b' }}>Cash Flow Analysis</div>
                  <div style={{ fontSize: '13px', color: '#64748b', marginTop: '4px' }}>Cash flow reports</div>
                </div>
                <div style={{ display: 'flex', flexDirection: 'column', gap: '12px', marginLeft: '0px' }}>
                  <label style={{ display: 'flex', alignItems: 'center', cursor: 'pointer', fontSize: '14px', color: '#475569' }}>
                    <input 
                      type="checkbox" 
                      checked={printPackageSelections.cashFlow4Quarters}
                      onChange={(e) => setPrintPackageSelections({...printPackageSelections, cashFlow4Quarters: e.target.checked})}
                      style={{ width: '16px', height: '16px', marginRight: '8px', cursor: 'pointer' }} 
                    />
                    Last 4 Quarters
                  </label>
                  <label style={{ display: 'flex', alignItems: 'center', cursor: 'pointer', fontSize: '14px', color: '#475569' }}>
                    <input 
                      type="checkbox" 
                      checked={printPackageSelections.cashFlow3Years}
                      onChange={(e) => setPrintPackageSelections({...printPackageSelections, cashFlow3Years: e.target.checked})}
                      style={{ width: '16px', height: '16px', marginRight: '8px', cursor: 'pointer' }} 
                    />
                    Last 3 Years
                  </label>
                </div>
              </div>

              {/* Financial Statements */}
              <div style={{ marginBottom: '20px', padding: '16px', background: '#f8fafc', borderRadius: '8px', border: '1px solid #e2e8f0' }}>
                <div>
                  <div style={{ fontSize: '16px', fontWeight: '600', color: '#1e293b', marginBottom: '8px' }}>Financial Statements</div>
                  <div style={{ fontSize: '13px', color: '#64748b', marginBottom: '12px' }}>Select specific financial statements</div>
                  <div style={{ display: 'flex', flexDirection: 'column', gap: '8px', marginLeft: '0px' }}>
                    {/* Income Statement with sub-options */}
                    <div>
                      <div style={{ fontSize: '14px', fontWeight: '600', color: '#1e293b', marginBottom: '8px' }}>Income Statement</div>
                      <div style={{ display: 'flex', flexDirection: 'column', gap: '6px', marginLeft: '16px' }}>
                        <label style={{ display: 'flex', alignItems: 'center', cursor: 'pointer', fontSize: '14px', color: '#475569' }}>
                          <input 
                            type="checkbox" 
                            checked={printPackageSelections.incomeStatement12MonthsQuarterly}
                            onChange={(e) => setPrintPackageSelections({...printPackageSelections, incomeStatement12MonthsQuarterly: e.target.checked})}
                            style={{ width: '16px', height: '16px', marginRight: '8px', cursor: 'pointer' }} 
                          />
                          Income Statement, Last 12 months, Quarterly
                        </label>
                        <label style={{ display: 'flex', alignItems: 'center', cursor: 'pointer', fontSize: '14px', color: '#475569' }}>
                          <input 
                            type="checkbox" 
                            checked={printPackageSelections.incomeStatement3YearsAnnual}
                            onChange={(e) => setPrintPackageSelections({...printPackageSelections, incomeStatement3YearsAnnual: e.target.checked})}
                            style={{ width: '16px', height: '16px', marginRight: '8px', cursor: 'pointer' }} 
                          />
                          Income Statement, Last 3 Years, Annual
                        </label>
                      </div>
                    </div>
                    {/* Balance Sheet with sub-options */}
                    <div style={{ marginTop: '12px' }}>
                      <div style={{ fontSize: '14px', fontWeight: '600', color: '#1e293b', marginBottom: '8px' }}>Balance Sheet</div>
                      <div style={{ display: 'flex', flexDirection: 'column', gap: '6px', marginLeft: '16px' }}>
                        <label style={{ display: 'flex', alignItems: 'center', cursor: 'pointer', fontSize: '14px', color: '#475569' }}>
                          <input 
                            type="checkbox" 
                            checked={printPackageSelections.balanceSheet12MonthsQuarterly}
                            onChange={(e) => setPrintPackageSelections({...printPackageSelections, balanceSheet12MonthsQuarterly: e.target.checked})}
                            style={{ width: '16px', height: '16px', marginRight: '8px', cursor: 'pointer' }} 
                          />
                          Balance Sheet, Last 12 months, Quarterly
                        </label>
                        <label style={{ display: 'flex', alignItems: 'center', cursor: 'pointer', fontSize: '14px', color: '#475569' }}>
                          <input 
                            type="checkbox" 
                            checked={printPackageSelections.balanceSheet3YearsAnnual}
                            onChange={(e) => setPrintPackageSelections({...printPackageSelections, balanceSheet3YearsAnnual: e.target.checked})}
                            style={{ width: '16px', height: '16px', marginRight: '8px', cursor: 'pointer' }} 
                          />
                          Balance Sheet, Last 3 Years, Annual
                        </label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              {/* Company Profile */}
              <div style={{ marginBottom: '20px', padding: '16px', background: '#f8fafc', borderRadius: '8px', border: '1px solid #e2e8f0' }}>
                <label style={{ display: 'flex', alignItems: 'center', cursor: 'pointer' }}>
                  <input 
                    type="checkbox" 
                    checked={printPackageSelections.profile}
                    onChange={(e) => setPrintPackageSelections({...printPackageSelections, profile: e.target.checked})}
                    style={{ width: '18px', height: '18px', marginRight: '12px', cursor: 'pointer' }}
                  />
                  <div>
                    <div style={{ fontSize: '16px', fontWeight: '600', color: '#1e293b' }}>Company Profile</div>
                    <div style={{ fontSize: '13px', color: '#64748b', marginTop: '4px' }}>Business profile, financial overview, ratios, and disclosures</div>
                  </div>
                </label>
              </div>
            </div>

            {/* Action Buttons */}
            <div style={{ display: 'flex', gap: '16px', justifyContent: 'center', paddingTop: '24px', borderTop: '2px solid #e2e8f0' }}>
              <button
                onClick={handleGeneratePrintPackage}
                style={{
                  padding: '14px 32px',
                  background: '#667eea',
                  color: 'white',
                  border: 'none',
                  borderRadius: '8px',
                  fontSize: '16px',
                  fontWeight: '600',
                  cursor: 'pointer',
                  boxShadow: '0 2px 8px rgba(102, 126, 234, 0.3)',
                  transition: 'all 0.2s'
                }}
                onMouseEnter={(e) => e.currentTarget.style.background = '#5568d3'}
                onMouseLeave={(e) => e.currentTarget.style.background = '#667eea'}
              >
                🖨️ Generate Print Package
              </button>
              <button
                onClick={() => {
                  setPrintPackageSelections({
                    mda: false,
                    financialScore: false,
                    priorityRatios: false,
                    workingCapital: false,
                    cashFlow4Quarters: false,
                    cashFlow3Years: false,
                    incomeStatement12MonthsQuarterly: false,
                    incomeStatement3YearsAnnual: false,
                    balanceSheet12MonthsQuarterly: false,
                    balanceSheet3YearsAnnual: false,
                    profile: false
                  });
                }}
                style={{
                  padding: '14px 32px',
                  background: '#f1f5f9',
                  color: '#475569',
                  border: '1px solid #cbd5e1',
                  borderRadius: '8px',
                  fontSize: '16px',
                  fontWeight: '600',
                  cursor: 'pointer',
                  transition: 'all 0.2s'
                }}
                onMouseEnter={(e) => {
                  e.currentTarget.style.background = '#e2e8f0';
                  e.currentTarget.style.borderColor = '#94a3b8';
                }}
                onMouseLeave={(e) => {
                  e.currentTarget.style.background = '#f1f5f9';
                  e.currentTarget.style.borderColor = '#cbd5e1';
                }}
              >
                Clear All
              </button>
            </div>

            {/* Info Box */}
            <div style={{ marginTop: '32px', padding: '16px', background: '#eff6ff', border: '1px solid #bfdbfe', borderRadius: '8px' }}>
              <div style={{ display: 'flex', gap: '12px', alignItems: 'flex-start' }}>
                <span style={{ fontSize: '20px' }}>ℹ️</span>
                <div style={{ fontSize: '14px', color: '#1e40af', lineHeight: '1.6' }}>
                  <strong>How it works:</strong> Select the reports you want to include, then click "Generate Print Package" to create a combined PDF with all selected reports in a single document ready for printing.
                </div>
              </div>
            </div>
          </div>
        </div>
      )}
        </main>
      </div>
    </div>
  );
}

);
}
 
     r e t u r n   (  
         < d i v   s t y l e = { {   m i n H e i g h t :   ' 1 0 0 v h ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   d i s p l a y :   ' f l e x ' ,   f l e x D i r e c t i o n :   ' c o l u m n '   } } >  
             { / *   H e a d e r   -   D i f f e r e n t   f o r   S i t e   A d m i n   * / }  
             { c u r r e n t U s e r ? . r o l e   = = =   ' s i t e a d m i n '   ?   (  
                 < h e a d e r   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g :   ' 1 6 p x   3 2 p x ' ,   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 5 ) ' ,   p o s i t i o n :   ' f i x e d ' ,   t o p :   0 ,   l e f t :   0 ,   r i g h t :   0 ,   z I n d e x :   1 0 0 0   } } >  
                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 8 0 p x '   } } >  
                         < d i v    
                             s t y l e = { {   f o n t S i z e :   ' 2 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 4 3 3 8 c a ' ,   c u r s o r :   ' p o i n t e r ' ,   l e t t e r S p a c i n g :   ' - 0 . 5 p x '   } }    
                             o n C l i c k = { ( )   = >   s e t C u r r e n t V i e w ( ' s i t e a d m i n ' ) }  
                         >  
                             V e n t u r i s < s u p   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 4 0 0 '   } } > T M < / s u p >  
                         < / d i v >  
                         < h 2   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > S i t e   A d m i n i s t r a t i o n < / h 2 >  
                     < / d i v >  
                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 1 6 p x '   } } >  
                         < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c u r r e n t U s e r ? . n a m e } < / s p a n >  
                         < b u t t o n   o n C l i c k = { h a n d l e L o g o u t }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 6 p x ' ,   b a c k g r o u n d :   ' # e f 4 4 4 4 ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } } > L o g o u t < / b u t t o n >  
                     < / d i v >  
                 < / h e a d e r >  
             )   :   (  
                 < >  
                 { / *   H i d e   t o p   n a v i g a t i o n   f o r   a s s e s s m e n t   u s e r s   * / }  
                 { ! ( c u r r e n t U s e r ? . u s e r T y p e   = = =   ' a s s e s s m e n t ' )   & &   (  
                 < h e a d e r   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g :   ' 1 6 p x   3 2 p x ' ,   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 5 ) ' ,   p o s i t i o n :   ' f i x e d ' ,   t o p :   0 ,   l e f t :   0 ,   r i g h t :   0 ,   z I n d e x :   1 0 0 0   } } >  
                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 8 0 p x '   } } >  
                         < d i v    
                             s t y l e = { {   f o n t S i z e :   ' 2 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 4 3 3 8 c a ' ,   c u r s o r :   ' p o i n t e r ' ,   l e t t e r S p a c i n g :   ' - 0 . 5 p x '   } }    
                             o n C l i c k = { ( )   = >   c u r r e n t U s e r ? . r o l e   = = =   ' c o n s u l t a n t '   ?   s e t C u r r e n t V i e w ( ' a d m i n ' )   :   s e t C u r r e n t V i e w ( ' f s - s c o r e ' ) }  
                         >  
                             V e n t u r i s < s u p   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 4 0 0 '   } } > T M < / s u p >  
                         < / d i v >  
                         < n a v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 2 4 p x '   } } >  
                             < b u t t o n   o n C l i c k = { ( )   = >   s e t C u r r e n t V i e w ( ' m d a ' ) }   s t y l e = { {   b a c k g r o u n d :   ' n o n e ' ,   b o r d e r :   ' n o n e ' ,   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   c u r r e n t V i e w   = = =   ' m d a '   ?   ' # 6 6 7 e e a '   :   ' # 6 4 7 4 8 b ' ,   c u r s o r :   ' p o i n t e r ' ,   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r B o t t o m :   c u r r e n t V i e w   = = =   ' m d a '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t '   } } > M D & A < / b u t t o n >  
                             < b u t t o n   o n C l i c k = { ( )   = >   s e t C u r r e n t V i e w ( ' k p i s ' ) }   s t y l e = { {   b a c k g r o u n d :   ' n o n e ' ,   b o r d e r :   ' n o n e ' ,   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   c u r r e n t V i e w   = = =   ' k p i s '   ?   ' # 6 6 7 e e a '   :   ' # 6 4 7 4 8 b ' ,   c u r s o r :   ' p o i n t e r ' ,   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r B o t t o m :   c u r r e n t V i e w   = = =   ' k p i s '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t '   } } > K P I   D a s h b o a r d < / b u t t o n >  
                             < b u t t o n   o n C l i c k = { ( )   = >   s e t C u r r e n t V i e w ( ' t r e n d - a n a l y s i s ' ) }   s t y l e = { {   b a c k g r o u n d :   ' n o n e ' ,   b o r d e r :   ' n o n e ' ,   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   c u r r e n t V i e w   = = =   ' t r e n d - a n a l y s i s '   ?   ' # 6 6 7 e e a '   :   ' # 6 4 7 4 8 b ' ,   c u r s o r :   ' p o i n t e r ' ,   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r B o t t o m :   c u r r e n t V i e w   = = =   ' t r e n d - a n a l y s i s '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t '   } } > T r e n d   A n a l y s i s < / b u t t o n >  
                             < b u t t o n   o n C l i c k = { ( )   = >   s e t C u r r e n t V i e w ( ' p r o j e c t i o n s ' ) }   s t y l e = { {   b a c k g r o u n d :   ' n o n e ' ,   b o r d e r :   ' n o n e ' ,   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   c u r r e n t V i e w   = = =   ' p r o j e c t i o n s '   ?   ' # 6 6 7 e e a '   :   ' # 6 4 7 4 8 b ' ,   c u r s o r :   ' p o i n t e r ' ,   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r B o t t o m :   c u r r e n t V i e w   = = =   ' p r o j e c t i o n s '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t '   } } > P r o j e c t i o n s < / b u t t o n >  
                             < b u t t o n   o n C l i c k = { ( )   = >   s e t C u r r e n t V i e w ( ' w o r k i n g - c a p i t a l ' ) }   s t y l e = { {   b a c k g r o u n d :   ' n o n e ' ,   b o r d e r :   ' n o n e ' ,   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   c u r r e n t V i e w   = = =   ' w o r k i n g - c a p i t a l '   ?   ' # 6 6 7 e e a '   :   ' # 6 4 7 4 8 b ' ,   c u r s o r :   ' p o i n t e r ' ,   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r B o t t o m :   c u r r e n t V i e w   = = =   ' w o r k i n g - c a p i t a l '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t '   } } > W o r k i n g   C a p i t a l < / b u t t o n >  
                             < b u t t o n   o n C l i c k = { ( )   = >   s e t C u r r e n t V i e w ( ' v a l u a t i o n ' ) }   s t y l e = { {   b a c k g r o u n d :   ' n o n e ' ,   b o r d e r :   ' n o n e ' ,   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   c u r r e n t V i e w   = = =   ' v a l u a t i o n '   ?   ' # 6 6 7 e e a '   :   ' # 6 4 7 4 8 b ' ,   c u r s o r :   ' p o i n t e r ' ,   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r B o t t o m :   c u r r e n t V i e w   = = =   ' v a l u a t i o n '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t '   } } > V a l u a t i o n < / b u t t o n >  
                             < b u t t o n   o n C l i c k = { ( )   = >   s e t C u r r e n t V i e w ( ' c a s h - f l o w ' ) }   s t y l e = { {   b a c k g r o u n d :   ' n o n e ' ,   b o r d e r :   ' n o n e ' ,   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   c u r r e n t V i e w   = = =   ' c a s h - f l o w '   ?   ' # 6 6 7 e e a '   :   ' # 6 4 7 4 8 b ' ,   c u r s o r :   ' p o i n t e r ' ,   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r B o t t o m :   c u r r e n t V i e w   = = =   ' c a s h - f l o w '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t '   } } > C a s h   F l o w < / b u t t o n >  
                             < b u t t o n   o n C l i c k = { ( )   = >   s e t C u r r e n t V i e w ( ' f i n a n c i a l - s t a t e m e n t s ' ) }   s t y l e = { {   b a c k g r o u n d :   ' n o n e ' ,   b o r d e r :   ' n o n e ' ,   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   c u r r e n t V i e w   = = =   ' f i n a n c i a l - s t a t e m e n t s '   ?   ' # 6 6 7 e e a '   :   ' # 6 4 7 4 8 b ' ,   c u r s o r :   ' p o i n t e r ' ,   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r B o t t o m :   c u r r e n t V i e w   = = =   ' f i n a n c i a l - s t a t e m e n t s '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t '   } } > F i n a n c i a l   S t a t e m e n t s < / b u t t o n >  
                         < / n a v >  
                     < / d i v >  
                 < / h e a d e r >  
                 ) }  
                  
                 { / *   S i m p l e   h e a d e r   f o r   a s s e s s m e n t   u s e r s   * / }  
                 { c u r r e n t U s e r ? . u s e r T y p e   = = =   ' a s s e s s m e n t '   & &   (  
                 < h e a d e r   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g :   ' 1 6 p x   3 2 p x ' ,   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 5 ) ' ,   p o s i t i o n :   ' f i x e d ' ,   t o p :   0 ,   l e f t :   0 ,   r i g h t :   0 ,   z I n d e x :   1 0 0 0   } } >  
                     < d i v   s t y l e = { {   f o n t S i z e :   ' 2 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 4 3 3 8 c a ' ,   l e t t e r S p a c i n g :   ' - 0 . 5 p x '   } } >  
                         V e n t u r i s < s u p   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 4 0 0 '   } } > T M < / s u p >   -   M a n a g e m e n t   A s s e s s m e n t  
                     < / d i v >  
                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 1 6 p x '   } } >  
                         < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c u r r e n t U s e r ? . n a m e } < / s p a n >  
                         < b u t t o n   o n C l i c k = { h a n d l e L o g o u t }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 6 p x ' ,   b a c k g r o u n d :   ' # e f 4 4 4 4 ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } } > L o g o u t < / b u t t o n >  
                     < / d i v >  
                 < / h e a d e r >  
                 ) }  
                 < / >  
             ) }  
  
             { / *   M a i n   C o n t e n t   A r e a   w i t h   S i d e b a r   * / }  
             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   f l e x :   1 ,   o v e r f l o w :   ' h i d d e n ' ,   p a d d i n g T o p :   ' 7 0 p x '   } } >  
                 { / *   L e f t   N a v i g a t i o n   S i d e b a r   -   N o t   f o r   S i t e   A d m i n   * / }  
                 { c u r r e n t U s e r ? . r o l e   ! = =   ' s i t e a d m i n '   & &   ! ( c u r r e n t U s e r ? . u s e r T y p e   = = =   ' a s s e s s m e n t ' )   & &   (  
                 < a s i d e   s t y l e = { {    
                     w i d t h :   ' 2 8 0 p x ' ,    
                     b a c k g r o u n d :   ' w h i t e ' ,    
                     b o r d e r R i g h t :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,    
                     p a d d i n g :   ' 2 4 p x   0 ' ,  
                     o v e r f l o w Y :   ' a u t o ' ,  
                     f l e x S h r i n k :   0 ,  
                     b o x S h a d o w :   ' 2 p x   0   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 3 ) ' ,  
                     d i s p l a y :   ' f l e x ' ,  
                     f l e x D i r e c t i o n :   ' c o l u m n '  
                 } } >  
                     { / *   U s e r   I n f o   a n d   L o g o u t   a t   T o p   * / }  
                     < d i v   s t y l e = { {   p a d d i n g :   ' 0   2 4 p x   2 4 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                         { c o m p a n y N a m e   & &   (  
                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x ' ,   p a d d i n g :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # f 0 f 9 f f ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # b a e 6 f d '   } } >  
                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 0 c 4 a 6 e ' ,   m a r g i n B o t t o m :   ' 4 p x ' ,   t e x t T r a n s f o r m :   ' u p p e r c a s e ' ,   l e t t e r S p a c i n g :   ' 0 . 5 p x '   } } > A c t i v e   C o m p a n y < / d i v >  
                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } > { c o m p a n y N a m e } < / d i v >  
                             < / d i v >  
                         ) }  
                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 1 2 p x '   } } >  
                             < d i v   s t y l e = { {   f l e x :   1   } } >  
                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x ' ,   t e x t T r a n s f o r m :   ' u p p e r c a s e ' ,   l e t t e r S p a c i n g :   ' 0 . 5 p x '   } } > L o g g e d   I n   A s < / d i v >  
                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > { c u r r e n t U s e r ? . n a m e } < / d i v >  
                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 9 4 a 3 b 8 '   } } > { c u r r e n t U s e r ? . e m a i l } < / d i v >  
                             < / d i v >  
                             < b u t t o n    
                                 o n C l i c k = { h a n d l e L o g o u t }    
                                 s t y l e = { {    
                                     p a d d i n g :   ' 8 p x   1 6 p x ' ,    
                                     b a c k g r o u n d :   ' # e f 4 4 4 4 ' ,    
                                     c o l o r :   ' w h i t e ' ,    
                                     b o r d e r :   ' n o n e ' ,    
                                     b o r d e r R a d i u s :   ' 6 p x ' ,    
                                     f o n t S i z e :   ' 1 3 p x ' ,    
                                     f o n t W e i g h t :   ' 6 0 0 ' ,    
                                     c u r s o r :   ' p o i n t e r ' ,  
                                     t r a n s i t i o n :   ' b a c k g r o u n d   0 . 2 s ' ,  
                                     w h i t e S p a c e :   ' n o w r a p '  
                                 } }  
                                 o n M o u s e E n t e r = { ( e )   = >   e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # d c 2 6 2 6 ' }  
                                 o n M o u s e L e a v e = { ( e )   = >   e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # e f 4 4 4 4 ' }  
                             >  
                                 L o g o u t  
                             < / b u t t o n >  
                         < / d i v >  
                     < / d i v >  
                      
                     < n a v   s t y l e = { {   f l e x :   1 ,   d i s p l a y :   ' f l e x ' ,   f l e x D i r e c t i o n :   ' c o l u m n ' ,   p a d d i n g T o p :   ' 2 4 p x '   } } >  
                         { / *   F i n a n c i a l   S c o r e   S e c t i o n   * / }  
                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                             < h 3    
                                 o n C l i c k = { ( )   = >   s e t I s F i n a n c i a l S c o r e E x p a n d e d ( ! i s F i n a n c i a l S c o r e E x p a n d e d ) }  
                                 s t y l e = { {    
                                     f o n t S i z e :   ' 1 4 p x ' ,    
                                     f o n t W e i g h t :   ' 7 0 0 ' ,    
                                     c o l o r :   ' # 1 e 2 9 3 b ' ,  
                                     t e x t T r a n s f o r m :   ' u p p e r c a s e ' ,    
                                     l e t t e r S p a c i n g :   ' 0 . 5 p x ' ,  
                                     p a d d i n g :   ' 8 p x   2 4 p x ' ,  
                                     m a r g i n B o t t o m :   ' 8 p x ' ,  
                                     c u r s o r :   ' p o i n t e r ' ,  
                                     d i s p l a y :   ' f l e x ' ,  
                                     j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,  
                                     a l i g n I t e m s :   ' c e n t e r ' ,  
                                     t r a n s i t i o n :   ' c o l o r   0 . 2 s '  
                                 } }  
                                 o n M o u s e E n t e r = { ( e )   = >   e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 6 6 7 e e a ' }  
                                 o n M o u s e L e a v e = { ( e )   = >   e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 1 e 2 9 3 b ' }  
                             >  
                                 < s p a n > F i n a n c i a l   S c o r e < / s p a n >  
                                 < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 6 6 7 e e a '   } } > { i s F i n a n c i a l S c o r e E x p a n d e d   ?   ' - '   :   ' + ' } < / s p a n >  
                             < / h 3 >  
                             { i s F i n a n c i a l S c o r e E x p a n d e d   & &   (  
                                 < d i v   s t y l e = { {   p a d d i n g L e f t :   ' 2 8 p x '   } } >  
                                     < d i v  
                                         o n C l i c k = { ( )   = >   s e t C u r r e n t V i e w ( ' f s - i n t r o ' ) }  
                                         s t y l e = { {  
                                             f o n t S i z e :   ' 1 4 p x ' ,  
                                             c o l o r :   c u r r e n t V i e w   = = =   ' f s - i n t r o '   ?   ' # 6 6 7 e e a '   :   ' # 4 7 5 5 6 9 ' ,  
                                             p a d d i n g :   ' 8 p x   1 2 p x ' ,  
                                             c u r s o r :   ' p o i n t e r ' ,  
                                             b o r d e r R a d i u s :   ' 6 p x ' ,  
                                             m a r g i n B o t t o m :   ' 4 p x ' ,  
                                             b a c k g r o u n d :   c u r r e n t V i e w   = = =   ' f s - i n t r o '   ?   ' # e d e 9 f e '   :   ' t r a n s p a r e n t ' ,  
                                             f o n t W e i g h t :   c u r r e n t V i e w   = = =   ' f s - i n t r o '   ?   ' 6 0 0 '   :   ' 4 0 0 ' ,  
                                             t r a n s i t i o n :   ' a l l   0 . 2 s '  
                                         } }  
                                         o n M o u s e E n t e r = { ( e )   = >   {  
                                             i f   ( c u r r e n t V i e w   ! = =   ' f s - i n t r o ' )   {  
                                                 e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # f 8 f a f c ' ;  
                                                 e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 6 6 7 e e a ' ;  
                                             }  
                                         } }  
                                         o n M o u s e L e a v e = { ( e )   = >   {  
                                             i f   ( c u r r e n t V i e w   ! = =   ' f s - i n t r o ' )   {  
                                                 e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' t r a n s p a r e n t ' ;  
                                                 e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 4 7 5 5 6 9 ' ;  
                                             }  
                                         } }  
                                     >  
                                         { c u r r e n t V i e w   = = =   ' f s - i n t r o '   & &   '      ' } I n t r o d u c t i o n  
                                     < / d i v >  
                                     < d i v  
                                         o n C l i c k = { ( )   = >   s e t C u r r e n t V i e w ( ' f s - s c o r e ' ) }  
                                         s t y l e = { {  
                                             f o n t S i z e :   ' 1 4 p x ' ,  
                                             c o l o r :   c u r r e n t V i e w   = = =   ' f s - s c o r e '   ?   ' # 6 6 7 e e a '   :   ' # 4 7 5 5 6 9 ' ,  
                                             p a d d i n g :   ' 8 p x   1 2 p x ' ,  
                                             c u r s o r :   ' p o i n t e r ' ,  
                                             b o r d e r R a d i u s :   ' 6 p x ' ,  
                                             m a r g i n B o t t o m :   ' 4 p x ' ,  
                                             b a c k g r o u n d :   c u r r e n t V i e w   = = =   ' f s - s c o r e '   ?   ' # e d e 9 f e '   :   ' t r a n s p a r e n t ' ,  
                                             f o n t W e i g h t :   c u r r e n t V i e w   = = =   ' f s - s c o r e '   ?   ' 6 0 0 '   :   ' 4 0 0 ' ,  
                                             t r a n s i t i o n :   ' a l l   0 . 2 s '  
                                         } }  
                                         o n M o u s e E n t e r = { ( e )   = >   {  
                                             i f   ( c u r r e n t V i e w   ! = =   ' f s - s c o r e ' )   {  
                                                 e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # f 8 f a f c ' ;  
                                                 e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 6 6 7 e e a ' ;  
                                             }  
                                         } }  
                                         o n M o u s e L e a v e = { ( e )   = >   {  
                                             i f   ( c u r r e n t V i e w   ! = =   ' f s - s c o r e ' )   {  
                                                 e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' t r a n s p a r e n t ' ;  
                                                 e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 4 7 5 5 6 9 ' ;  
                                             }  
                                         } }  
                                     >  
                                         { c u r r e n t V i e w   = = =   ' f s - s c o r e '   & &   '      ' } F i n a n c i a l   S c o r e  
                                     < / d i v >  
                                 < / d i v >  
                             ) }  
                         < / d i v >  
  
                         { / *   M a n a g e m e n t   A s s e s s m e n t   S e c t i o n   -   F o r   A s s e s s m e n t   U s e r s   a n d   C o n s u l t a n t s   * / }  
                         { ( ( c u r r e n t U s e r ? . r o l e   = = =   ' u s e r '   & &   c u r r e n t U s e r ? . u s e r T y p e   = = =   ' a s s e s s m e n t ' )   | |   c u r r e n t U s e r ? . r o l e   = = =   ' c o n s u l t a n t ' )   & &   (  
                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                             < h 3    
                                 o n C l i c k = { ( )   = >   s e t I s M a n a g e m e n t A s s e s s m e n t E x p a n d e d ( ! i s M a n a g e m e n t A s s e s s m e n t E x p a n d e d ) }  
                                 s t y l e = { {    
                                     f o n t S i z e :   ' 1 4 p x ' ,    
                                     f o n t W e i g h t :   ' 7 0 0 ' ,    
                                     c o l o r :   ' # 1 e 2 9 3 b ' ,  
                                     t e x t T r a n s f o r m :   ' u p p e r c a s e ' ,    
                                     l e t t e r S p a c i n g :   ' 0 . 5 p x ' ,  
                                     p a d d i n g :   ' 8 p x   2 4 p x ' ,  
                                     m a r g i n B o t t o m :   ' 8 p x ' ,  
                                     c u r s o r :   ' p o i n t e r ' ,  
                                     d i s p l a y :   ' f l e x ' ,  
                                     j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,  
                                     a l i g n I t e m s :   ' c e n t e r ' ,  
                                     t r a n s i t i o n :   ' c o l o r   0 . 2 s '  
                                 } }  
                                 o n M o u s e E n t e r = { ( e )   = >   e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 6 6 7 e e a ' }  
                                 o n M o u s e L e a v e = { ( e )   = >   e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 1 e 2 9 3 b ' }  
                             >  
                                 < s p a n > M a n a g e m e n t   A s s e s s m e n t < / s p a n >  
                                 < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 6 6 7 e e a '   } } > { i s M a n a g e m e n t A s s e s s m e n t E x p a n d e d   ?   ' - '   :   ' + ' } < / s p a n >  
                             < / h 3 >  
                             { i s M a n a g e m e n t A s s e s s m e n t E x p a n d e d   & &   (  
                                 < d i v   s t y l e = { {   p a d d i n g L e f t :   ' 2 8 p x '   } } >  
                                 < d i v  
                                     o n C l i c k = { ( )   = >   s e t C u r r e n t V i e w ( ' m a - w e l c o m e ' ) }  
                                     s t y l e = { {  
                                         f o n t S i z e :   ' 1 4 p x ' ,  
                                         c o l o r :   c u r r e n t V i e w   = = =   ' m a - w e l c o m e '   ?   ' # 6 6 7 e e a '   :   ' # 4 7 5 5 6 9 ' ,  
                                         p a d d i n g :   ' 8 p x   1 2 p x ' ,  
                                         c u r s o r :   ' p o i n t e r ' ,  
                                         b o r d e r R a d i u s :   ' 6 p x ' ,  
                                         m a r g i n B o t t o m :   ' 4 p x ' ,  
                                         b a c k g r o u n d :   c u r r e n t V i e w   = = =   ' m a - w e l c o m e '   ?   ' # e d e 9 f e '   :   ' t r a n s p a r e n t ' ,  
                                         f o n t W e i g h t :   c u r r e n t V i e w   = = =   ' m a - w e l c o m e '   ?   ' 6 0 0 '   :   ' 4 0 0 ' ,  
                                         t r a n s i t i o n :   ' a l l   0 . 2 s '  
                                     } }  
                                     o n M o u s e E n t e r = { ( e )   = >   {  
                                         i f   ( c u r r e n t V i e w   ! = =   ' m a - w e l c o m e ' )   {  
                                             e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # f 8 f a f c ' ;  
                                             e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 6 6 7 e e a ' ;  
                                         }  
                                     } }  
                                     o n M o u s e L e a v e = { ( e )   = >   {  
                                         i f   ( c u r r e n t V i e w   ! = =   ' m a - w e l c o m e ' )   {  
                                             e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' t r a n s p a r e n t ' ;  
                                             e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 4 7 5 5 6 9 ' ;  
                                         }  
                                     } }  
                                 >  
                                     { c u r r e n t V i e w   = = =   ' m a - w e l c o m e '   & &   '      ' } W e l c o m e  
                                 < / d i v >  
                                 < d i v  
                                     o n C l i c k = { ( )   = >   s e t C u r r e n t V i e w ( ' m a - q u e s t i o n n a i r e ' ) }  
                                     s t y l e = { {  
                                         f o n t S i z e :   ' 1 4 p x ' ,  
                                         c o l o r :   c u r r e n t V i e w   = = =   ' m a - q u e s t i o n n a i r e '   ?   ' # 6 6 7 e e a '   :   ' # 4 7 5 5 6 9 ' ,  
                                         p a d d i n g :   ' 8 p x   1 2 p x ' ,  
                                         c u r s o r :   ' p o i n t e r ' ,  
                                         b o r d e r R a d i u s :   ' 6 p x ' ,  
                                         m a r g i n B o t t o m :   ' 4 p x ' ,  
                                         b a c k g r o u n d :   c u r r e n t V i e w   = = =   ' m a - q u e s t i o n n a i r e '   ?   ' # e d e 9 f e '   :   ' t r a n s p a r e n t ' ,  
                                         f o n t W e i g h t :   c u r r e n t V i e w   = = =   ' m a - q u e s t i o n n a i r e '   ?   ' 6 0 0 '   :   ' 4 0 0 ' ,  
                                         t r a n s i t i o n :   ' a l l   0 . 2 s '  
                                     } }  
                                     o n M o u s e E n t e r = { ( e )   = >   {  
                                         i f   ( c u r r e n t V i e w   ! = =   ' m a - q u e s t i o n n a i r e ' )   {  
                                             e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # f 8 f a f c ' ;  
                                             e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 6 6 7 e e a ' ;  
                                         }  
                                     } }  
                                     o n M o u s e L e a v e = { ( e )   = >   {  
                                         i f   ( c u r r e n t V i e w   ! = =   ' m a - q u e s t i o n n a i r e ' )   {  
                                             e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' t r a n s p a r e n t ' ;  
                                             e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 4 7 5 5 6 9 ' ;  
                                         }  
                                     } }  
                                 >  
                                     { c u r r e n t V i e w   = = =   ' m a - q u e s t i o n n a i r e '   & &   '      ' } Q u e s t i o n n a i r e  
                                 < / d i v >  
                                 < d i v  
                                     o n C l i c k = { ( )   = >   s e t C u r r e n t V i e w ( ' m a - y o u r - r e s u l t s ' ) }  
                                     s t y l e = { {  
                                         f o n t S i z e :   ' 1 4 p x ' ,  
                                         c o l o r :   c u r r e n t V i e w   = = =   ' m a - y o u r - r e s u l t s '   ?   ' # 6 6 7 e e a '   :   ' # 4 7 5 5 6 9 ' ,  
                                         p a d d i n g :   ' 8 p x   1 2 p x ' ,  
                                         c u r s o r :   ' p o i n t e r ' ,  
                                         b o r d e r R a d i u s :   ' 6 p x ' ,  
                                         m a r g i n B o t t o m :   ' 4 p x ' ,  
                                         b a c k g r o u n d :   c u r r e n t V i e w   = = =   ' m a - y o u r - r e s u l t s '   ?   ' # e d e 9 f e '   :   ' t r a n s p a r e n t ' ,  
                                         f o n t W e i g h t :   c u r r e n t V i e w   = = =   ' m a - y o u r - r e s u l t s '   ?   ' 6 0 0 '   :   ' 4 0 0 ' ,  
                                         t r a n s i t i o n :   ' a l l   0 . 2 s '  
                                     } }  
                                     o n M o u s e E n t e r = { ( e )   = >   {  
                                         i f   ( c u r r e n t V i e w   ! = =   ' m a - y o u r - r e s u l t s ' )   {  
                                             e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # f 8 f a f c ' ;  
                                             e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 6 6 7 e e a ' ;  
                                         }  
                                     } }  
                                     o n M o u s e L e a v e = { ( e )   = >   {  
                                         i f   ( c u r r e n t V i e w   ! = =   ' m a - y o u r - r e s u l t s ' )   {  
                                             e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' t r a n s p a r e n t ' ;  
                                             e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 4 7 5 5 6 9 ' ;  
                                         }  
                                     } }  
                                 >  
                                     { c u r r e n t V i e w   = = =   ' m a - y o u r - r e s u l t s '   & &   '      ' } { c u r r e n t U s e r ? . r o l e   = = =   ' c o n s u l t a n t '   ?   ' R e s u l t s '   :   ' Y o u r   R e s u l t s ' }  
                                 < / d i v >  
                                 < d i v  
                                     o n C l i c k = { ( )   = >   s e t C u r r e n t V i e w ( ' m a - s c o r e s - s u m m a r y ' ) }  
                                     s t y l e = { {  
                                         f o n t S i z e :   ' 1 4 p x ' ,  
                                         c o l o r :   c u r r e n t V i e w   = = =   ' m a - s c o r e s - s u m m a r y '   ?   ' # 6 6 7 e e a '   :   ' # 4 7 5 5 6 9 ' ,  
                                         p a d d i n g :   ' 8 p x   1 2 p x ' ,  
                                         c u r s o r :   ' p o i n t e r ' ,  
                                         b o r d e r R a d i u s :   ' 6 p x ' ,  
                                         m a r g i n B o t t o m :   ' 4 p x ' ,  
                                         b a c k g r o u n d :   c u r r e n t V i e w   = = =   ' m a - s c o r e s - s u m m a r y '   ?   ' # e d e 9 f e '   :   ' t r a n s p a r e n t ' ,  
                                         f o n t W e i g h t :   c u r r e n t V i e w   = = =   ' m a - s c o r e s - s u m m a r y '   ?   ' 6 0 0 '   :   ' 4 0 0 ' ,  
                                         t r a n s i t i o n :   ' a l l   0 . 2 s '  
                                     } }  
                                     o n M o u s e E n t e r = { ( e )   = >   {  
                                         i f   ( c u r r e n t V i e w   ! = =   ' m a - s c o r e s - s u m m a r y ' )   {  
                                             e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # f 8 f a f c ' ;  
                                             e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 6 6 7 e e a ' ;  
                                         }  
                                     } }  
                                     o n M o u s e L e a v e = { ( e )   = >   {  
                                         i f   ( c u r r e n t V i e w   ! = =   ' m a - s c o r e s - s u m m a r y ' )   {  
                                             e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' t r a n s p a r e n t ' ;  
                                             e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 4 7 5 5 6 9 ' ;  
                                         }  
                                     } }  
                                 >  
                                     { c u r r e n t V i e w   = = =   ' m a - s c o r e s - s u m m a r y '   & &   '      ' } S c o r e s   S u m m a r y  
                                 < / d i v >  
                                 < d i v  
                                     o n C l i c k = { ( )   = >   s e t C u r r e n t V i e w ( ' m a - s c o r i n g - g u i d e ' ) }  
                                     s t y l e = { {  
                                         f o n t S i z e :   ' 1 4 p x ' ,  
                                         c o l o r :   c u r r e n t V i e w   = = =   ' m a - s c o r i n g - g u i d e '   ?   ' # 6 6 7 e e a '   :   ' # 4 7 5 5 6 9 ' ,  
                                         p a d d i n g :   ' 8 p x   1 2 p x ' ,  
                                         c u r s o r :   ' p o i n t e r ' ,  
                                         b o r d e r R a d i u s :   ' 6 p x ' ,  
                                         m a r g i n B o t t o m :   ' 4 p x ' ,  
                                         b a c k g r o u n d :   c u r r e n t V i e w   = = =   ' m a - s c o r i n g - g u i d e '   ?   ' # e d e 9 f e '   :   ' t r a n s p a r e n t ' ,  
                                         f o n t W e i g h t :   c u r r e n t V i e w   = = =   ' m a - s c o r i n g - g u i d e '   ?   ' 6 0 0 '   :   ' 4 0 0 ' ,  
                                         t r a n s i t i o n :   ' a l l   0 . 2 s '  
                                     } }  
                                     o n M o u s e E n t e r = { ( e )   = >   {  
                                         i f   ( c u r r e n t V i e w   ! = =   ' m a - s c o r i n g - g u i d e ' )   {  
                                             e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # f 8 f a f c ' ;  
                                             e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 6 6 7 e e a ' ;  
                                         }  
                                     } }  
                                     o n M o u s e L e a v e = { ( e )   = >   {  
                                         i f   ( c u r r e n t V i e w   ! = =   ' m a - s c o r i n g - g u i d e ' )   {  
                                             e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' t r a n s p a r e n t ' ;  
                                             e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 4 7 5 5 6 9 ' ;  
                                         }  
                                     } }  
                                 >  
                                     { c u r r e n t V i e w   = = =   ' m a - s c o r i n g - g u i d e '   & &   '      ' } S c o r i n g   G u i d e  
                                 < / d i v >  
                                 < d i v  
                                     o n C l i c k = { ( )   = >   s e t C u r r e n t V i e w ( ' m a - c h a r t s ' ) }  
                                     s t y l e = { {  
                                         f o n t S i z e :   ' 1 4 p x ' ,  
                                         c o l o r :   c u r r e n t V i e w   = = =   ' m a - c h a r t s '   ?   ' # 6 6 7 e e a '   :   ' # 4 7 5 5 6 9 ' ,  
                                         p a d d i n g :   ' 8 p x   1 2 p x ' ,  
                                         c u r s o r :   ' p o i n t e r ' ,  
                                         b o r d e r R a d i u s :   ' 6 p x ' ,  
                                         m a r g i n B o t t o m :   ' 4 p x ' ,  
                                         b a c k g r o u n d :   c u r r e n t V i e w   = = =   ' m a - c h a r t s '   ?   ' # e d e 9 f e '   :   ' t r a n s p a r e n t ' ,  
                                         f o n t W e i g h t :   c u r r e n t V i e w   = = =   ' m a - c h a r t s '   ?   ' 6 0 0 '   :   ' 4 0 0 ' ,  
                                         t r a n s i t i o n :   ' a l l   0 . 2 s '  
                                     } }  
                                     o n M o u s e E n t e r = { ( e )   = >   {  
                                         i f   ( c u r r e n t V i e w   ! = =   ' m a - c h a r t s ' )   {  
                                             e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # f 8 f a f c ' ;  
                                             e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 6 6 7 e e a ' ;  
                                         }  
                                     } }  
                                     o n M o u s e L e a v e = { ( e )   = >   {  
                                         i f   ( c u r r e n t V i e w   ! = =   ' m a - c h a r t s ' )   {  
                                             e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' t r a n s p a r e n t ' ;  
                                             e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 4 7 5 5 6 9 ' ;  
                                         }  
                                     } }  
                                 >  
                                     { c u r r e n t V i e w   = = =   ' m a - c h a r t s '   & &   '      ' } C h a r t s  
                                 < / d i v >  
                             < / d i v >  
                             ) }  
                         < / d i v >  
                         ) }  
  
                         { / *   C u s t o m   P r i n t   S e c t i o n   -   F o r   C o n s u l t a n t s   a n d   C o m p a n y   U s e r s   o n l y   * / }  
                         { ( c u r r e n t U s e r ? . r o l e   = = =   ' c o n s u l t a n t '   | |   ( c u r r e n t U s e r ? . r o l e   = = =   ' u s e r '   & &   c u r r e n t U s e r ? . u s e r T y p e   = = =   ' c o m p a n y ' ) )   & &   (  
                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                 < h 3    
                                     o n C l i c k = { ( )   = >   s e t C u r r e n t V i e w ( ' c u s t o m - p r i n t ' ) }  
                                     s t y l e = { {    
                                         f o n t S i z e :   ' 1 4 p x ' ,    
                                         f o n t W e i g h t :   ' 7 0 0 ' ,    
                                         c o l o r :   c u r r e n t V i e w   = = =   ' c u s t o m - p r i n t '   ?   ' # 6 6 7 e e a '   :   ' # 1 e 2 9 3 b ' ,  
                                         t e x t T r a n s f o r m :   ' u p p e r c a s e ' ,    
                                         l e t t e r S p a c i n g :   ' 0 . 5 p x ' ,  
                                         p a d d i n g :   ' 8 p x   2 4 p x ' ,  
                                         m a r g i n B o t t o m :   ' 8 p x ' ,  
                                         c u r s o r :   ' p o i n t e r ' ,  
                                         t r a n s i t i o n :   ' c o l o r   0 . 2 s ' ,  
                                         b o r d e r L e f t :   c u r r e n t V i e w   = = =   ' c u s t o m - p r i n t '   ?   ' 4 p x   s o l i d   # 6 6 7 e e a '   :   ' 4 p x   s o l i d   t r a n s p a r e n t '  
                                     } }  
                                     o n M o u s e E n t e r = { ( e )   = >   e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 6 6 7 e e a ' }  
                                     o n M o u s e L e a v e = { ( e )   = >   e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   c u r r e n t V i e w   = = =   ' c u s t o m - p r i n t '   ?   ' # 6 6 7 e e a '   :   ' # 1 e 2 9 3 b ' }  
                                 >  
                                     C u s t o m   P r i n t  
                                 < / h 3 >  
                             < / d i v >  
                         ) }  
  
                         { / *   C o n s u l t a n t   D a s h b o a r d   S e c t i o n   * / }  
                         { c u r r e n t U s e r ? . r o l e   = = =   ' c o n s u l t a n t '   & &   (  
                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                 < h 3    
                                     o n C l i c k = { ( )   = >   s e t C u r r e n t V i e w ( ' a d m i n ' ) }  
                                     s t y l e = { {    
                                         f o n t S i z e :   ' 1 4 p x ' ,    
                                         f o n t W e i g h t :   ' 7 0 0 ' ,    
                                         c o l o r :   c u r r e n t V i e w   = = =   ' a d m i n '   ?   ' # 6 6 7 e e a '   :   ' # 1 e 2 9 3 b ' ,  
                                         t e x t T r a n s f o r m :   ' u p p e r c a s e ' ,    
                                         l e t t e r S p a c i n g :   ' 0 . 5 p x ' ,  
                                         p a d d i n g :   ' 8 p x   2 4 p x ' ,  
                                         m a r g i n B o t t o m :   ' 8 p x ' ,  
                                         c u r s o r :   ' p o i n t e r ' ,  
                                         t r a n s i t i o n :   ' c o l o r   0 . 2 s ' ,  
                                         b o r d e r L e f t :   c u r r e n t V i e w   = = =   ' a d m i n '   ?   ' 4 p x   s o l i d   # 6 6 7 e e a '   :   ' 4 p x   s o l i d   t r a n s p a r e n t '  
                                     } }  
                                     o n M o u s e E n t e r = { ( e )   = >   e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 6 6 7 e e a ' }  
                                     o n M o u s e L e a v e = { ( e )   = >   e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   c u r r e n t V i e w   = = =   ' a d m i n '   ?   ' # 6 6 7 e e a '   :   ' # 1 e 2 9 3 b ' }  
                                 >  
                                     { c u r r e n t U s e r . c o n s u l t a n t T y p e   = = =   ' b u s i n e s s '   ?   ' B u s i n e s s   D a s h b o a r d '   :   ' C o n s u l t a n t   D a s h b o a r d ' }  
                                 < / h 3 >  
                                  
                                 { / *   S e l e c t e d   C o m p a n y   N a m e   D i s p l a y   f o r   B u s i n e s s   U s e r s   * / }  
                                 { c u r r e n t U s e r . c o n s u l t a n t T y p e   = = =   ' b u s i n e s s '   & &   s e l e c t e d C o m p a n y I d   & &   c o m p a n i e s . f i n d ( c   = >   c . i d   = = =   s e l e c t e d C o m p a n y I d )   & &   (  
                                     < d i v   s t y l e = { {    
                                         p a d d i n g L e f t :   ' 2 8 p x ' ,    
                                         m a r g i n B o t t o m :   ' 1 2 p x ' ,  
                                         p a d d i n g B o t t o m :   ' 1 2 p x ' ,  
                                         b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '  
                                     } } >  
                                         < d i v   s t y l e = { {    
                                             f o n t S i z e :   ' 1 6 p x ' ,    
                                             f o n t W e i g h t :   ' 6 0 0 ' ,    
                                             c o l o r :   ' # 6 6 7 e e a ' ,  
                                             p a d d i n g :   ' 8 p x   1 2 p x ' ,  
                                             b a c k g r o u n d :   ' # f 0 f 9 f f ' ,  
                                             b o r d e r R a d i u s :   ' 8 p x ' ,  
                                             b o r d e r :   ' 2 p x   s o l i d   # b f d b f e '  
                                         } } >  
                                             { c o m p a n i e s . f i n d ( c   = >   c . i d   = = =   s e l e c t e d C o m p a n y I d ) ? . n a m e }  
                                         < / d i v >  
                                     < / d i v >  
                                 ) }  
                                  
                                 { / *   M y   C o m p a n i e s   L i s t   -   O n l y   f o r   R e g u l a r   C o n s u l t a n t s   * / }  
                                 { c u r r e n t U s e r . c o n s u l t a n t T y p e   ! = =   ' b u s i n e s s '   & &   (  
                                     < d i v   s t y l e = { {   p a d d i n g L e f t :   ' 2 8 p x '   } } >  
                                         { / *   L i s t   o f   C o m p a n i e s   * / }  
                                         { c o m p a n i e s . f i l t e r ( c   = >   c . c o n s u l t a n t I d   = = =   c u r r e n t U s e r . c o n s u l t a n t I d ) . l e n g t h   >   0   ?   (  
                                             < d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   t e x t T r a n s f o r m :   ' u p p e r c a s e ' ,   l e t t e r S p a c i n g :   ' 0 . 5 p x ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   p a d d i n g :   ' 4 p x   0 '   } } >  
                                                     M y   C o m p a n i e s  
                                                 < / d i v >  
                                                 { c o m p a n i e s . f i l t e r ( c   = >   c . c o n s u l t a n t I d   = = =   c u r r e n t U s e r . c o n s u l t a n t I d ) . m a p ( c o m p   = >   (  
                                                     < d i v  
                                                         k e y = { c o m p . i d }  
                                                         o n C l i c k = { ( )   = >   h a n d l e S e l e c t C o m p a n y ( c o m p . i d ) }  
                                                         s t y l e = { {  
                                                             f o n t S i z e :   ' 1 4 p x ' ,  
                                                             c o l o r :   s e l e c t e d C o m p a n y I d   = = =   c o m p . i d   ?   ' # 6 6 7 e e a '   :   ' # 4 7 5 5 6 9 ' ,  
                                                             p a d d i n g :   ' 8 p x   1 2 p x ' ,  
                                                             c u r s o r :   ' p o i n t e r ' ,  
                                                             b o r d e r R a d i u s :   ' 6 p x ' ,  
                                                             m a r g i n B o t t o m :   ' 4 p x ' ,  
                                                             b a c k g r o u n d :   s e l e c t e d C o m p a n y I d   = = =   c o m p . i d   ?   ' # e d e 9 f e '   :   ' t r a n s p a r e n t ' ,  
                                                             f o n t W e i g h t :   s e l e c t e d C o m p a n y I d   = = =   c o m p . i d   ?   ' 6 0 0 '   :   ' 4 0 0 ' ,  
                                                             t r a n s i t i o n :   ' a l l   0 . 2 s '  
                                                         } }  
                                                         o n M o u s e E n t e r = { ( e )   = >   {  
                                                             i f   ( s e l e c t e d C o m p a n y I d   ! = =   c o m p . i d )   {  
                                                                 e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # f 8 f a f c ' ;  
                                                                 e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 6 6 7 e e a ' ;  
                                                             }  
                                                         } }  
                                                         o n M o u s e L e a v e = { ( e )   = >   {  
                                                             i f   ( s e l e c t e d C o m p a n y I d   ! = =   c o m p . i d )   {  
                                                                 e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' t r a n s p a r e n t ' ;  
                                                                 e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 4 7 5 5 6 9 ' ;  
                                                             }  
                                                         } }  
                                                     >  
                                                         { s e l e c t e d C o m p a n y I d   = = =   c o m p . i d   & &   '      ' } { c o m p . n a m e }  
                                                     < / d i v >  
                                                 ) ) }  
                                             < / d i v >  
                                         )   :   (  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 9 4 a 3 b 8 ' ,   p a d d i n g :   ' 8 p x   0 ' ,   f o n t S t y l e :   ' i t a l i c '   } } >  
                                                 N o   c o m p a n i e s   y e t  
                                             < / d i v >  
                                         ) }  
                                          
                                         { / *   A d d   C o m p a n y   B u t t o n   * / }  
                                         < b u t t o n  
                                             o n C l i c k = { ( )   = >   {  
                                                 s e t C u r r e n t V i e w ( ' a d m i n ' ) ;  
                                                 s e t S e l e c t e d C o m p a n y I d ( ' ' ) ;  
                                                 s e t A d m i n D a s h b o a r d T a b ( ' c o m p a n y - m a n a g e m e n t ' ) ;  
                                             } }  
                                             s t y l e = { {  
                                                 m a r g i n T o p :   ' 1 2 p x ' ,  
                                                 w i d t h :   ' 1 0 0 % ' ,  
                                                 p a d d i n g :   ' 8 p x   1 2 p x ' ,  
                                                 b a c k g r o u n d :   ' # 1 0 b 9 8 1 ' ,  
                                                 c o l o r :   ' w h i t e ' ,  
                                                 b o r d e r :   ' n o n e ' ,  
                                                 b o r d e r R a d i u s :   ' 6 p x ' ,  
                                                 f o n t S i z e :   ' 1 3 p x ' ,  
                                                 f o n t W e i g h t :   ' 6 0 0 ' ,  
                                                 c u r s o r :   ' p o i n t e r ' ,  
                                                 t r a n s i t i o n :   ' a l l   0 . 2 s ' ,  
                                                 d i s p l a y :   ' f l e x ' ,  
                                                 a l i g n I t e m s :   ' c e n t e r ' ,  
                                                 j u s t i f y C o n t e n t :   ' c e n t e r ' ,  
                                                 g a p :   ' 6 p x '  
                                             } }  
                                             o n M o u s e E n t e r = { ( e )   = >   e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # 0 5 9 6 6 9 ' }  
                                             o n M o u s e L e a v e = { ( e )   = >   e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # 1 0 b 9 8 1 ' }  
                                         >  
                                             < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 7 0 0 '   } } > + < / s p a n >   A d d   C o m p a n y  
                                         < / b u t t o n >  
                                     < / d i v >  
                                 ) }  
                             < / d i v >  
                         ) }  
                     < / n a v >  
                 < / a s i d e >  
                 ) }  
  
                 { / *   A s s e s s m e n t   U s e r   S i d e b a r   -   O n l y   M a n a g e m e n t   A s s e s s m e n t   * / }  
                 { c u r r e n t U s e r ? . u s e r T y p e   = = =   ' a s s e s s m e n t '   & &   (  
                 < a s i d e   s t y l e = { {    
                     w i d t h :   ' 2 8 0 p x ' ,    
                     b a c k g r o u n d :   ' w h i t e ' ,    
                     b o r d e r R i g h t :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,    
                     p a d d i n g :   ' 2 4 p x   0 ' ,  
                     d i s p l a y :   ' f l e x ' ,  
                     f l e x D i r e c t i o n :   ' c o l u m n '  
                 } } >  
                     < d i v   s t y l e = { {   p a d d i n g :   ' 0   2 4 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                         < h 2   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > N a v i g a t i o n < / h 2 >  
                         < p   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > M a n a g e m e n t   A s s e s s m e n t < / p >  
                     < / d i v >  
                      
                     < n a v   s t y l e = { {   f l e x :   1 ,   d i s p l a y :   ' f l e x ' ,   f l e x D i r e c t i o n :   ' c o l u m n ' ,   p a d d i n g T o p :   ' 2 4 p x '   } } >  
                         { / *   M a n a g e m e n t   A s s e s s m e n t   S e c t i o n   * / }  
                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                             < h 3    
                                 o n C l i c k = { ( )   = >   s e t I s M a n a g e m e n t A s s e s s m e n t E x p a n d e d ( ! i s M a n a g e m e n t A s s e s s m e n t E x p a n d e d ) }  
                                 s t y l e = { {    
                                     f o n t S i z e :   ' 1 4 p x ' ,    
                                     f o n t W e i g h t :   ' 7 0 0 ' ,    
                                     c o l o r :   ' # 1 e 2 9 3 b ' ,  
                                     t e x t T r a n s f o r m :   ' u p p e r c a s e ' ,    
                                     l e t t e r S p a c i n g :   ' 0 . 5 p x ' ,  
                                     p a d d i n g :   ' 8 p x   2 4 p x ' ,  
                                     m a r g i n B o t t o m :   ' 8 p x ' ,  
                                     c u r s o r :   ' p o i n t e r ' ,  
                                     d i s p l a y :   ' f l e x ' ,  
                                     j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,  
                                     a l i g n I t e m s :   ' c e n t e r ' ,  
                                     t r a n s i t i o n :   ' c o l o r   0 . 2 s '  
                                 } }  
                                 o n M o u s e E n t e r = { ( e )   = >   e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 6 6 7 e e a ' }  
                                 o n M o u s e L e a v e = { ( e )   = >   e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 1 e 2 9 3 b ' }  
                             >  
                                 < s p a n > M a n a g e m e n t   A s s e s s m e n t < / s p a n >  
                                 < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 6 6 7 e e a '   } } > { i s M a n a g e m e n t A s s e s s m e n t E x p a n d e d   ?   ' - '   :   ' + ' } < / s p a n >  
                             < / h 3 >  
                             { i s M a n a g e m e n t A s s e s s m e n t E x p a n d e d   & &   (  
                                 < d i v   s t y l e = { {   p a d d i n g L e f t :   ' 2 8 p x '   } } >  
                                     < d i v  
                                         o n C l i c k = { ( )   = >   h a n d l e V i e w C h a n g e ( ' m a - w e l c o m e ' ) }  
                                         s t y l e = { {  
                                             f o n t S i z e :   ' 1 4 p x ' ,  
                                             c o l o r :   c u r r e n t V i e w   = = =   ' m a - w e l c o m e '   ?   ' # 6 6 7 e e a '   :   ' # 4 7 5 5 6 9 ' ,  
                                             p a d d i n g :   ' 8 p x   1 2 p x ' ,  
                                             c u r s o r :   ' p o i n t e r ' ,  
                                             b o r d e r R a d i u s :   ' 6 p x ' ,  
                                             m a r g i n B o t t o m :   ' 4 p x ' ,  
                                             b a c k g r o u n d :   c u r r e n t V i e w   = = =   ' m a - w e l c o m e '   ?   ' # e d e 9 f e '   :   ' t r a n s p a r e n t ' ,  
                                             f o n t W e i g h t :   c u r r e n t V i e w   = = =   ' m a - w e l c o m e '   ?   ' 6 0 0 '   :   ' 4 0 0 ' ,  
                                             t r a n s i t i o n :   ' a l l   0 . 2 s '  
                                         } }  
                                         o n M o u s e E n t e r = { ( e )   = >   {  
                                             i f   ( c u r r e n t V i e w   ! = =   ' m a - w e l c o m e ' )   {  
                                                 e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # f 8 f a f c ' ;  
                                                 e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 6 6 7 e e a ' ;  
                                             }  
                                         } }  
                                         o n M o u s e L e a v e = { ( e )   = >   {  
                                             i f   ( c u r r e n t V i e w   ! = =   ' m a - w e l c o m e ' )   {  
                                                 e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' t r a n s p a r e n t ' ;  
                                                 e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 4 7 5 5 6 9 ' ;  
                                             }  
                                         } }  
                                     >  
                                         W e l c o m e  
                                     < / d i v >  
                                     < d i v  
                                         o n C l i c k = { ( )   = >   h a n d l e V i e w C h a n g e ( ' m a - q u e s t i o n n a i r e ' ) }  
                                         s t y l e = { {  
                                             f o n t S i z e :   ' 1 4 p x ' ,  
                                             c o l o r :   c u r r e n t V i e w   = = =   ' m a - q u e s t i o n n a i r e '   ?   ' # 6 6 7 e e a '   :   ' # 4 7 5 5 6 9 ' ,  
                                             p a d d i n g :   ' 8 p x   1 2 p x ' ,  
                                             c u r s o r :   ' p o i n t e r ' ,  
                                             b o r d e r R a d i u s :   ' 6 p x ' ,  
                                             m a r g i n B o t t o m :   ' 4 p x ' ,  
                                             b a c k g r o u n d :   c u r r e n t V i e w   = = =   ' m a - q u e s t i o n n a i r e '   ?   ' # e d e 9 f e '   :   ' t r a n s p a r e n t ' ,  
                                             f o n t W e i g h t :   c u r r e n t V i e w   = = =   ' m a - q u e s t i o n n a i r e '   ?   ' 6 0 0 '   :   ' 4 0 0 ' ,  
                                             t r a n s i t i o n :   ' a l l   0 . 2 s '  
                                         } }  
                                         o n M o u s e E n t e r = { ( e )   = >   {  
                                             i f   ( c u r r e n t V i e w   ! = =   ' m a - q u e s t i o n n a i r e ' )   {  
                                                 e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # f 8 f a f c ' ;  
                                                 e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 6 6 7 e e a ' ;  
                                             }  
                                         } }  
                                         o n M o u s e L e a v e = { ( e )   = >   {  
                                             i f   ( c u r r e n t V i e w   ! = =   ' m a - q u e s t i o n n a i r e ' )   {  
                                                 e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' t r a n s p a r e n t ' ;  
                                                 e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 4 7 5 5 6 9 ' ;  
                                             }  
                                         } }  
                                     >  
                                         Q u e s t i o n n a i r e  
                                     < / d i v >  
                                     < d i v  
                                         o n C l i c k = { ( )   = >   h a n d l e V i e w C h a n g e ( ' m a - y o u r - r e s u l t s ' ) }  
                                         s t y l e = { {  
                                             f o n t S i z e :   ' 1 4 p x ' ,  
                                             c o l o r :   c u r r e n t V i e w   = = =   ' m a - y o u r - r e s u l t s '   ?   ' # 6 6 7 e e a '   :   ' # 4 7 5 5 6 9 ' ,  
                                             p a d d i n g :   ' 8 p x   1 2 p x ' ,  
                                             c u r s o r :   ' p o i n t e r ' ,  
                                             b o r d e r R a d i u s :   ' 6 p x ' ,  
                                             m a r g i n B o t t o m :   ' 4 p x ' ,  
                                             b a c k g r o u n d :   c u r r e n t V i e w   = = =   ' m a - y o u r - r e s u l t s '   ?   ' # e d e 9 f e '   :   ' t r a n s p a r e n t ' ,  
                                             f o n t W e i g h t :   c u r r e n t V i e w   = = =   ' m a - y o u r - r e s u l t s '   ?   ' 6 0 0 '   :   ' 4 0 0 ' ,  
                                             t r a n s i t i o n :   ' a l l   0 . 2 s '  
                                         } }  
                                         o n M o u s e E n t e r = { ( e )   = >   {  
                                             i f   ( c u r r e n t V i e w   ! = =   ' m a - y o u r - r e s u l t s ' )   {  
                                                 e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # f 8 f a f c ' ;  
                                                 e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 6 6 7 e e a ' ;  
                                             }  
                                         } }  
                                         o n M o u s e L e a v e = { ( e )   = >   {  
                                             i f   ( c u r r e n t V i e w   ! = =   ' m a - y o u r - r e s u l t s ' )   {  
                                                 e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' t r a n s p a r e n t ' ;  
                                                 e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 4 7 5 5 6 9 ' ;  
                                             }  
                                         } }  
                                     >  
                                         R e s u l t s  
                                     < / d i v >  
                                 < / d i v >  
                             ) }  
                         < / d i v >  
                     < / n a v >  
                 < / a s i d e >  
                 ) }  
  
                 { / *   M a i n   C o n t e n t   A r e a   * / }  
                 < m a i n   s t y l e = { {   f l e x :   1 ,   o v e r f l o w Y :   ' a u t o ' ,   o v e r f l o w X :   ' h i d d e n '   } } >  
                     { / *   R e s t r i c t   a c c e s s   f o r   a s s e s s m e n t   u s e r s   -   o n l y   s h o w   M a n a g e m e n t   A s s e s s m e n t   v i e w s   * / }  
                     { ( ! ( c u r r e n t U s e r ? . u s e r T y p e   = = =   ' a s s e s s m e n t ' )   | |   c u r r e n t V i e w   = = =   ' m a - q u e s t i o n n a i r e '   | |   c u r r e n t V i e w   = = =   ' m a - y o u r - r e s u l t s '   | |   c u r r e n t V i e w   = = =   ' m a - s c o r e s - s u m m a r y '   | |   c u r r e n t V i e w   = = =   ' m a - c h a r t s '   | |   c u r r e n t V i e w   = = =   ' m a - s c o r i n g - g u i d e ' )   & &   (  
                     < >  
                     { / *   S i t e   A d m i n i s t r a t i o n   * / }  
                     { c u r r e n t V i e w   = = =   ' s i t e a d m i n '   & &   c u r r e n t U s e r ? . r o l e   = = =   ' s i t e a d m i n '   & &   (  
                         < d i v   s t y l e = { {   m a x W i d t h :   ' 1 6 0 0 p x ' ,   m a r g i n :   ' 0   a u t o ' ,   p a d d i n g :   ' 2 0 p x '   } } >  
                             < h 1   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } > S i t e   A d m i n i s t r a t i o n < / h 1 >  
                              
                             { / *   T a b   N a v i g a t i o n   * / }  
                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 4 p x ' ,   m a r g i n B o t t o m :   ' 1 6 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                 < b u t t o n  
                                     o n C l i c k = { ( )   = >   s e t S i t e A d m i n T a b ( ' c o n s u l t a n t s ' ) }  
                                     s t y l e = { {  
                                         p a d d i n g :   ' 8 p x   1 6 p x ' ,  
                                         b a c k g r o u n d :   s i t e A d m i n T a b   = = =   ' c o n s u l t a n t s '   ?   ' # 6 6 7 e e a '   :   ' t r a n s p a r e n t ' ,  
                                         c o l o r :   s i t e A d m i n T a b   = = =   ' c o n s u l t a n t s '   ?   ' w h i t e '   :   ' # 6 4 7 4 8 b ' ,  
                                         b o r d e r :   ' n o n e ' ,  
                                         b o r d e r B o t t o m :   s i t e A d m i n T a b   = = =   ' c o n s u l t a n t s '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t ' ,  
                                         f o n t S i z e :   ' 1 4 p x ' ,  
                                         f o n t W e i g h t :   ' 6 0 0 ' ,  
                                         c u r s o r :   ' p o i n t e r ' ,  
                                         b o r d e r R a d i u s :   ' 6 p x   6 p x   0   0 ' ,  
                                         t r a n s i t i o n :   ' a l l   0 . 2 s '  
                                     } }  
                                 >  
                                     C o n s u l t a n t s  
                                 < / b u t t o n >  
                                 < b u t t o n  
                                     o n C l i c k = { ( )   = >   s e t S i t e A d m i n T a b ( ' b u s i n e s s e s ' ) }  
                                     s t y l e = { {  
                                         p a d d i n g :   ' 8 p x   1 6 p x ' ,  
                                         b a c k g r o u n d :   s i t e A d m i n T a b   = = =   ' b u s i n e s s e s '   ?   ' # 6 6 7 e e a '   :   ' t r a n s p a r e n t ' ,  
                                         c o l o r :   s i t e A d m i n T a b   = = =   ' b u s i n e s s e s '   ?   ' w h i t e '   :   ' # 6 4 7 4 8 b ' ,  
                                         b o r d e r :   ' n o n e ' ,  
                                         b o r d e r B o t t o m :   s i t e A d m i n T a b   = = =   ' b u s i n e s s e s '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t ' ,  
                                         f o n t S i z e :   ' 1 4 p x ' ,  
                                         f o n t W e i g h t :   ' 6 0 0 ' ,  
                                         c u r s o r :   ' p o i n t e r ' ,  
                                         b o r d e r R a d i u s :   ' 6 p x   6 p x   0   0 ' ,  
                                         t r a n s i t i o n :   ' a l l   0 . 2 s '  
                                     } }  
                                 >  
                                     B u s i n e s s e s  
                                 < / b u t t o n >  
                             < / d i v >  
  
                             { / *   C o n s u l t a n t s   T a b   * / }  
                             { s i t e A d m i n T a b   = = =   ' c o n s u l t a n t s '   & &   (  
                             < >  
                             { / *   A d d   C o n s u l t a n t   F o r m   * / }  
                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 2 p x   1 6 p x ' ,   m a r g i n B o t t o m :   ' 1 6 p x ' ,   b o x S h a d o w :   ' 0   1 p x   3 p x   r g b a ( 0 , 0 , 0 , 0 . 0 8 ) '   } } >  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   m a r g i n B o t t o m :   s h o w A d d C o n s u l t a n t F o r m   ?   ' 1 2 p x '   :   ' 0 '   } } >  
                                     < h 2   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n :   0   } } > A d d   N e w   C o n s u l t a n t < / h 2 >  
                                     < b u t t o n  
                                         o n C l i c k = { ( )   = >   s e t S h o w A d d C o n s u l t a n t F o r m ( ! s h o w A d d C o n s u l t a n t F o r m ) }  
                                         s t y l e = { {    
                                             p a d d i n g :   ' 4 p x   1 2 p x ' ,    
                                             b a c k g r o u n d :   s h o w A d d C o n s u l t a n t F o r m   ?   ' # f 1 f 5 f 9 '   :   ' # 6 6 7 e e a ' ,    
                                             c o l o r :   s h o w A d d C o n s u l t a n t F o r m   ?   ' # 4 7 5 5 6 9 '   :   ' w h i t e ' ,    
                                             b o r d e r :   ' n o n e ' ,    
                                             b o r d e r R a d i u s :   ' 6 p x ' ,    
                                             f o n t S i z e :   ' 1 2 p x ' ,    
                                             f o n t W e i g h t :   ' 6 0 0 ' ,    
                                             c u r s o r :   ' p o i n t e r '    
                                         } }  
                                     >  
                                         { s h o w A d d C o n s u l t a n t F o r m   ?   '    '   :   '    ' }  
                                     < / b u t t o n >  
                                 < / d i v >  
                                 { s h o w A d d C o n s u l t a n t F o r m   & &   (  
                                     < >  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( 3 ,   1 f r ) ' ,   g a p :   ' 8 p x ' ,   m a r g i n B o t t o m :   ' 1 0 p x '   } } >  
                                             < i n p u t  
                                                 t y p e = " t e x t "  
                                                 p l a c e h o l d e r = " T y p e "  
                                                 v a l u e = { n e w C o n s u l t a n t T y p e }  
                                                 o n C h a n g e = { ( e )   = >   s e t N e w C o n s u l t a n t T y p e ( e . t a r g e t . v a l u e ) }  
                                                 s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 3 p x '   } }  
                                             / >  
                                             < i n p u t  
                                                 t y p e = " t e x t "  
                                                 p l a c e h o l d e r = " F u l l   N a m e "  
                                                 v a l u e = { n e w C o n s u l t a n t F u l l N a m e }  
                                                 o n C h a n g e = { ( e )   = >   s e t N e w C o n s u l t a n t F u l l N a m e ( e . t a r g e t . v a l u e ) }  
                                                 s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 3 p x '   } }  
                                             / >  
                                             < i n p u t  
                                                 t y p e = " t e x t "  
                                                 p l a c e h o l d e r = " A d d r e s s "  
                                                 v a l u e = { n e w C o n s u l t a n t A d d r e s s }  
                                                 o n C h a n g e = { ( e )   = >   s e t N e w C o n s u l t a n t A d d r e s s ( e . t a r g e t . v a l u e ) }  
                                                 s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 3 p x '   } }  
                                             / >  
                                             < i n p u t  
                                                 t y p e = " e m a i l "  
                                                 p l a c e h o l d e r = " E m a i l "  
                                                 v a l u e = { n e w C o n s u l t a n t E m a i l }  
                                                 o n C h a n g e = { ( e )   = >   s e t N e w C o n s u l t a n t E m a i l ( e . t a r g e t . v a l u e ) }  
                                                 s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 3 p x '   } }  
                                             / >  
                                             < i n p u t  
                                                 t y p e = " t e l "  
                                                 p l a c e h o l d e r = " P h o n e "  
                                                 v a l u e = { n e w C o n s u l t a n t P h o n e }  
                                                 o n C h a n g e = { ( e )   = >   s e t N e w C o n s u l t a n t P h o n e ( e . t a r g e t . v a l u e ) }  
                                                 s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 3 p x '   } }  
                                             / >  
                                             < i n p u t  
                                                 t y p e = " p a s s w o r d "  
                                                 p l a c e h o l d e r = " P a s s w o r d "  
                                                 v a l u e = { n e w C o n s u l t a n t P a s s w o r d }  
                                                 o n C h a n g e = { ( e )   = >   s e t N e w C o n s u l t a n t P a s s w o r d ( e . t a r g e t . v a l u e ) }  
                                                 s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 3 p x '   } }  
                                             / >  
                                         < / d i v >  
                                         < b u t t o n  
                                             o n C l i c k = { a d d C o n s u l t a n t }  
                                             s t y l e = { {   p a d d i n g :   ' 8 p x   2 0 p x ' ,   b a c k g r o u n d :   ' # 1 0 b 9 8 1 ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } }  
                                         >  
                                             A d d   C o n s u l t a n t  
                                         < / b u t t o n >  
                                     < / >  
                                 ) }  
                             < / d i v >  
  
                             { / *   C o n s u l t a n t s   L i s t   * / }  
                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 0 p x '   } } >  
                                 T o t a l   C o n s u l t a n t s :   { c o n s u l t a n t s . f i l t e r ( c   = >   c . t y p e   ! = =   ' b u s i n e s s ' ) . l e n g t h }  
                             < / d i v >  
  
                             { c o n s u l t a n t s . f i l t e r ( c   = >   c . t y p e   ! = =   ' b u s i n e s s ' ) . l e n g t h   = = =   0   ?   (  
                                 < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 4 0 p x ' ,   t e x t A l i g n :   ' c e n t e r ' ,   b o x S h a d o w :   ' 0   1 p x   3 p x   r g b a ( 0 , 0 , 0 , 0 . 0 8 ) '   } } >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 3 6 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  x  < / d i v >  
                                     < h 3   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 6 p x '   } } > N o   C o n s u l t a n t s < / h 3 >  
                                     < p   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 9 4 a 3 b 8 '   } } > A d d   y o u r   f i r s t   c o n s u l t a n t   t o   g e t   s t a r t e d < / p >  
                                 < / d i v >  
                             )   :   (  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g a p :   ' 1 2 p x '   } } >  
                                     { c o n s u l t a n t s . f i l t e r ( c   = >   c . t y p e   ! = =   ' b u s i n e s s ' ) . m a p ( ( c o n s u l t a n t )   = >   {  
                                         c o n s t   c o n s u l t a n t C o m p a n i e s   =   g e t C o n s u l t a n t C o m p a n i e s ( c o n s u l t a n t . i d ) ;  
                                         c o n s t   e x p a n d e d   =   s e l e c t e d C o n s u l t a n t I d   = = =   c o n s u l t a n t . i d ;  
  
                                         r e t u r n   (  
                                             < d i v   k e y = { c o n s u l t a n t . i d }   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 2 p x   1 6 p x ' ,   b o x S h a d o w :   ' 0   1 p x   3 p x   r g b a ( 0 , 0 , 0 , 0 . 0 8 ) ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                 { / *   C o n s u l t a n t   H e a d e r   * / }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r '   } } >  
                                                     < d i v   s t y l e = { {   f l e x :   1   } } >  
                                                         < h 3    
                                                             o n C l i c k = { ( )   = >   {  
                                                                 / /   S a v e   c u r r e n t   a d m i n   u s e r  
                                                                 s e t S i t e A d m i n V i e w i n g A s ( c u r r e n t U s e r ) ;  
                                                                 / /   S w i t c h   t o   v i e w i n g   t h i s   c o n s u l t a n t ' s   d a s h b o a r d  
                                                                 s e t C u r r e n t U s e r ( {  
                                                                     . . . c o n s u l t a n t . u s e r ,  
                                                                     r o l e :   ' c o n s u l t a n t ' ,  
                                                                     c o n s u l t a n t I d :   c o n s u l t a n t . i d ,  
                                                                     c o n s u l t a n t T y p e :   c o n s u l t a n t . t y p e  
                                                                 } ) ;  
                                                                 s e t C u r r e n t V i e w ( ' a d m i n ' ) ;  
                                                             } }  
                                                             s t y l e = { {    
                                                                 f o n t S i z e :   ' 1 5 p x ' ,    
                                                                 f o n t W e i g h t :   ' 6 0 0 ' ,    
                                                                 c o l o r :   ' # 6 6 7 e e a ' ,    
                                                                 m a r g i n B o t t o m :   ' 0 ' ,  
                                                                 c u r s o r :   ' p o i n t e r ' ,  
                                                                 t e x t D e c o r a t i o n :   ' u n d e r l i n e '  
                                                             } }  
                                                             o n M o u s e E n t e r = { ( e )   = >   e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 5 5 6 8 d 3 ' }  
                                                             o n M o u s e L e a v e = { ( e )   = >   e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 6 6 7 e e a ' }  
                                                         >  
                                                             { c o n s u l t a n t . f u l l N a m e }  
                                                         < / h 3 >  
                                                     < / d i v >  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 8 p x '   } } >  
                                                         < b u t t o n  
                                                             o n C l i c k = { ( )   = >   s e t S e l e c t e d C o n s u l t a n t I d ( e x p a n d e d   ?   ' '   :   c o n s u l t a n t . i d ) }  
                                                             s t y l e = { {   p a d d i n g :   ' 6 p x   1 2 p x ' ,   b a c k g r o u n d :   ' # 6 6 7 e e a ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } }  
                                                         >  
                                                             { e x p a n d e d   ?   ' C o l l a p s e '   :   ' E x p a n d ' }  
                                                         < / b u t t o n >  
                                                         < b u t t o n  
                                                             o n C l i c k = { ( )   = >   d e l e t e C o n s u l t a n t ( c o n s u l t a n t . i d ) }  
                                                             s t y l e = { {   p a d d i n g :   ' 6 p x   1 2 p x ' ,   b a c k g r o u n d :   ' # e f 4 4 4 4 ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } }  
                                                         >  
                                                             D e l e t e  
                                                         < / b u t t o n >  
                                                     < / d i v >  
                                                 < / d i v >  
  
                                                 { / *   E x p a n d e d   D e t a i l s   * / }  
                                                 { e x p a n d e d   & &   (  
                                                     < d i v   s t y l e = { {   b o r d e r T o p :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g T o p :   ' 1 0 p x ' ,   m a r g i n T o p :   ' 1 0 p x '   } } >  
                                                         { / *   C o n s u l t a n t   I n f o r m a t i o n   * / }  
                                                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 0 p x ' ,   p a d d i n g :   ' 8 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 6 p x '   } } >  
                                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   m a r g i n B o t t o m :   ' 6 p x '   } } >  
                                                                 < h 4   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n :   0   } } > C o n s u l t a n t   I n f o r m a t i o n < / h 4 >  
                                                                 { ! e d i t i n g C o n s u l t a n t I n f o [ c o n s u l t a n t . i d ]   & &   (  
                                                                     < b u t t o n  
                                                                         o n C l i c k = { ( )   = >   {  
                                                                             s e t E d i t i n g C o n s u l t a n t I n f o ( {  
                                                                                 . . . e d i t i n g C o n s u l t a n t I n f o ,  
                                                                                 [ c o n s u l t a n t . i d ] :   {  
                                                                                     f u l l N a m e :   c o n s u l t a n t . f u l l N a m e ,  
                                                                                     e m a i l :   c o n s u l t a n t . e m a i l ,  
                                                                                     a d d r e s s :   c o n s u l t a n t . a d d r e s s   | |   ' ' ,  
                                                                                     p h o n e :   c o n s u l t a n t . p h o n e   | |   ' ' ,  
                                                                                     t y p e :   c o n s u l t a n t . t y p e   | |   ' '  
                                                                                 }  
                                                                             } ) ;  
                                                                         } }  
                                                                         s t y l e = { {   p a d d i n g :   ' 3 p x   8 p x ' ,   b a c k g r o u n d :   ' # 6 6 7 e e a ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   f o n t S i z e :   ' 1 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } }  
                                                                     >  
                                                                         E d i t  
                                                                     < / b u t t o n >  
                                                                 ) }  
                                                             < / d i v >  
                                                              
                                                             { e d i t i n g C o n s u l t a n t I n f o [ c o n s u l t a n t . i d ]   ?   (  
                                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   f l e x D i r e c t i o n :   ' c o l u m n ' ,   g a p :   ' 6 p x '   } } >  
                                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( 2 ,   1 f r ) ' ,   g a p :   ' 6 p x '   } } >  
                                                                         < d i v >  
                                                                             < l a b e l   s t y l e = { {   f o n t S i z e :   ' 1 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   d i s p l a y :   ' b l o c k ' ,   m a r g i n B o t t o m :   ' 2 p x '   } } > F u l l   N a m e < / l a b e l >  
                                                                             < i n p u t  
                                                                                 t y p e = " t e x t "  
                                                                                 v a l u e = { e d i t i n g C o n s u l t a n t I n f o [ c o n s u l t a n t . i d ] . f u l l N a m e }  
                                                                                 o n C h a n g e = { ( e )   = >   s e t E d i t i n g C o n s u l t a n t I n f o ( {  
                                                                                     . . . e d i t i n g C o n s u l t a n t I n f o ,  
                                                                                     [ c o n s u l t a n t . i d ] :   {   . . . e d i t i n g C o n s u l t a n t I n f o [ c o n s u l t a n t . i d ] ,   f u l l N a m e :   e . t a r g e t . v a l u e   }  
                                                                                 } ) }  
                                                                                 s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 4 p x   6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   f o n t S i z e :   ' 1 1 p x '   } }  
                                                                             / >  
                                                                         < / d i v >  
                                                                         < d i v >  
                                                                             < l a b e l   s t y l e = { {   f o n t S i z e :   ' 1 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   d i s p l a y :   ' b l o c k ' ,   m a r g i n B o t t o m :   ' 2 p x '   } } > T y p e < / l a b e l >  
                                                                             < i n p u t  
                                                                                 t y p e = " t e x t "  
                                                                                 v a l u e = { e d i t i n g C o n s u l t a n t I n f o [ c o n s u l t a n t . i d ] . t y p e }  
                                                                                 o n C h a n g e = { ( e )   = >   s e t E d i t i n g C o n s u l t a n t I n f o ( {  
                                                                                     . . . e d i t i n g C o n s u l t a n t I n f o ,  
                                                                                     [ c o n s u l t a n t . i d ] :   {   . . . e d i t i n g C o n s u l t a n t I n f o [ c o n s u l t a n t . i d ] ,   t y p e :   e . t a r g e t . v a l u e   }  
                                                                                 } ) }  
                                                                                 s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 4 p x   6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   f o n t S i z e :   ' 1 1 p x '   } }  
                                                                             / >  
                                                                         < / d i v >  
                                                                         < d i v >  
                                                                             < l a b e l   s t y l e = { {   f o n t S i z e :   ' 1 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   d i s p l a y :   ' b l o c k ' ,   m a r g i n B o t t o m :   ' 2 p x '   } } > E m a i l < / l a b e l >  
                                                                             < i n p u t  
                                                                                 t y p e = " e m a i l "  
                                                                                 v a l u e = { e d i t i n g C o n s u l t a n t I n f o [ c o n s u l t a n t . i d ] . e m a i l }  
                                                                                 o n C h a n g e = { ( e )   = >   s e t E d i t i n g C o n s u l t a n t I n f o ( {  
                                                                                     . . . e d i t i n g C o n s u l t a n t I n f o ,  
                                                                                     [ c o n s u l t a n t . i d ] :   {   . . . e d i t i n g C o n s u l t a n t I n f o [ c o n s u l t a n t . i d ] ,   e m a i l :   e . t a r g e t . v a l u e   }  
                                                                                 } ) }  
                                                                                 s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 4 p x   6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   f o n t S i z e :   ' 1 1 p x '   } }  
                                                                             / >  
                                                                         < / d i v >  
                                                                         < d i v >  
                                                                             < l a b e l   s t y l e = { {   f o n t S i z e :   ' 1 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   d i s p l a y :   ' b l o c k ' ,   m a r g i n B o t t o m :   ' 2 p x '   } } > P h o n e < / l a b e l >  
                                                                             < i n p u t  
                                                                                 t y p e = " t e x t "  
                                                                                 v a l u e = { e d i t i n g C o n s u l t a n t I n f o [ c o n s u l t a n t . i d ] . p h o n e }  
                                                                                 o n C h a n g e = { ( e )   = >   s e t E d i t i n g C o n s u l t a n t I n f o ( {  
                                                                                     . . . e d i t i n g C o n s u l t a n t I n f o ,  
                                                                                     [ c o n s u l t a n t . i d ] :   {   . . . e d i t i n g C o n s u l t a n t I n f o [ c o n s u l t a n t . i d ] ,   p h o n e :   e . t a r g e t . v a l u e   }  
                                                                                 } ) }  
                                                                                 s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 4 p x   6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   f o n t S i z e :   ' 1 1 p x '   } }  
                                                                             / >  
                                                                         < / d i v >  
                                                                     < / d i v >  
                                                                     < d i v >  
                                                                         < l a b e l   s t y l e = { {   f o n t S i z e :   ' 1 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   d i s p l a y :   ' b l o c k ' ,   m a r g i n B o t t o m :   ' 2 p x '   } } > A d d r e s s < / l a b e l >  
                                                                         < i n p u t  
                                                                             t y p e = " t e x t "  
                                                                             v a l u e = { e d i t i n g C o n s u l t a n t I n f o [ c o n s u l t a n t . i d ] . a d d r e s s }  
                                                                             o n C h a n g e = { ( e )   = >   s e t E d i t i n g C o n s u l t a n t I n f o ( {  
                                                                                 . . . e d i t i n g C o n s u l t a n t I n f o ,  
                                                                                 [ c o n s u l t a n t . i d ] :   {   . . . e d i t i n g C o n s u l t a n t I n f o [ c o n s u l t a n t . i d ] ,   a d d r e s s :   e . t a r g e t . v a l u e   }  
                                                                             } ) }  
                                                                             s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 4 p x   6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   f o n t S i z e :   ' 1 1 p x '   } }  
                                                                         / >  
                                                                     < / d i v >  
                                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 6 p x ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                                                         < b u t t o n  
                                                                             o n C l i c k = { ( )   = >   {  
                                                                                 u p d a t e C o n s u l t a n t I n f o ( c o n s u l t a n t . i d ,   e d i t i n g C o n s u l t a n t I n f o [ c o n s u l t a n t . i d ] ) ;  
                                                                             } }  
                                                                             s t y l e = { {   p a d d i n g :   ' 4 p x   1 2 p x ' ,   b a c k g r o u n d :   ' # 1 0 b 9 8 1 ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   f o n t S i z e :   ' 1 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } }  
                                                                         >  
                                                                             S a v e  
                                                                         < / b u t t o n >  
                                                                         < b u t t o n  
                                                                             o n C l i c k = { ( )   = >   {  
                                                                                 s e t E d i t i n g C o n s u l t a n t I n f o ( ( p r e v )   = >   {  
                                                                                     c o n s t   n e w S t a t e   =   {   . . . p r e v   } ;  
                                                                                     d e l e t e   n e w S t a t e [ c o n s u l t a n t . i d ] ;  
                                                                                     r e t u r n   n e w S t a t e ;  
                                                                                 } ) ;  
                                                                             } }  
                                                                             s t y l e = { {   p a d d i n g :   ' 4 p x   1 2 p x ' ,   b a c k g r o u n d :   ' # 6 4 7 4 8 b ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   f o n t S i z e :   ' 1 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } }  
                                                                         >  
                                                                             C a n c e l  
                                                                         < / b u t t o n >  
                                                                     < / d i v >  
                                                                 < / d i v >  
                                                             )   :   (  
                                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( 2 ,   1 f r ) ' ,   g a p :   ' 4 p x ' ,   f o n t S i z e :   ' 1 1 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } >  
                                                                     < d i v > < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 '   } } > T y p e : < / s p a n >   { c o n s u l t a n t . t y p e } < / d i v >  
                                                                     < d i v > < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 '   } } > E m a i l : < / s p a n >   { c o n s u l t a n t . e m a i l } < / d i v >  
                                                                     < d i v > < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 '   } } > A d d r e s s : < / s p a n >   { c o n s u l t a n t . a d d r e s s } < / d i v >  
                                                                     < d i v > < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 '   } } > P h o n e : < / s p a n >   { c o n s u l t a n t . p h o n e } < / d i v >  
                                                                 < / d i v >  
                                                             ) }  
                                                         < / d i v >  
  
                                                         < h 4   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                                             C o m p a n i e s   ( { c o n s u l t a n t C o m p a n i e s . l e n g t h } )  
                                                         < / h 4 >  
                                                          
                                                         { c o n s u l t a n t C o m p a n i e s . l e n g t h   = = =   0   ?   (  
                                                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   t e x t A l i g n :   ' c e n t e r ' ,   b o r d e r :   ' 1 p x   d a s h e d   # c b d 5 e 1 '   } } >  
                                                                 < p   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n :   0   } } > N o   c o m p a n i e s   y e t < / p >  
                                                             < / d i v >  
                                                         )   :   (  
                                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g a p :   ' 8 p x '   } } >  
                                                                 { c o n s u l t a n t C o m p a n i e s . m a p ( ( c o m p a n y )   = >   {  
                                                                     c o n s t   c o m p a n y U s e r s   =   g e t C o m p a n y U s e r s ( c o m p a n y . i d ) ;  
                                                                     c o n s t   i s C o m p a n y E x p a n d e d   =   e x p a n d e d C o m p a n y I d s . i n c l u d e s ( c o m p a n y . i d ) ;  
                                                                     c o n s t   e d i t i n g   =   e d i t i n g P r i c i n g [ c o m p a n y . i d ] ;  
                                                                      
                                                                     r e t u r n   (  
                                                                         < d i v   k e y = { c o m p a n y . i d }   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   p a d d i n g :   ' 1 0 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   m a r g i n B o t t o m :   i s C o m p a n y E x p a n d e d   ?   ' 8 p x '   :   ' 0 '   } } >  
                                                                                 < d i v   s t y l e = { {   f l e x :   1   } } >  
                                                                                     < h 5   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 2 p x '   } } > { c o m p a n y . n a m e } < / h 5 >  
                                                                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } >  
                                                                                         < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 '   } } > I n d u s t r y : < / s p a n >   {  
                                                                                             c o m p a n y . i n d u s t r y S e c t o r    
                                                                                                 ?   ` $ { c o m p a n y . i n d u s t r y S e c t o r }   -   $ { I N D U S T R Y _ S E C T O R S . f i n d ( s   = >   s . i d   = = =   c o m p a n y . i n d u s t r y S e c t o r ) ? . n a m e   | |   ' U n k n o w n ' } `    
                                                                                                 :   ' N o t   s e t '  
                                                                                         }  
                                                                                     < / d i v >  
                                                                                 < / d i v >  
                                                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 8 p x '   } } >  
                                                                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 6 7 e e a '   } } >  
                                                                                         { c o m p a n y U s e r s . l e n g t h }   u s e r { c o m p a n y U s e r s . l e n g t h   ! = =   1   ?   ' s '   :   ' ' }  
                                                                                     < / d i v >  
                                                                                     < b u t t o n  
                                                                                         o n C l i c k = { ( )   = >   {  
                                                                                             s e t E x p a n d e d C o m p a n y I d s ( p r e v   = >    
                                                                                                 p r e v . i n c l u d e s ( c o m p a n y . i d )    
                                                                                                     ?   p r e v . f i l t e r ( i d   = >   i d   ! = =   c o m p a n y . i d )  
                                                                                                     :   [ . . . p r e v ,   c o m p a n y . i d ]  
                                                                                             ) ;  
                                                                                         } }  
                                                                                         s t y l e = { {    
                                                                                             p a d d i n g :   ' 4 p x   1 0 p x ' ,    
                                                                                             b a c k g r o u n d :   i s C o m p a n y E x p a n d e d   ?   ' # f 1 f 5 f 9 '   :   ' # 6 6 7 e e a ' ,    
                                                                                             c o l o r :   i s C o m p a n y E x p a n d e d   ?   ' # 4 7 5 5 6 9 '   :   ' w h i t e ' ,    
                                                                                             b o r d e r :   ' n o n e ' ,    
                                                                                             b o r d e r R a d i u s :   ' 4 p x ' ,    
                                                                                             f o n t S i z e :   ' 1 1 p x ' ,    
                                                                                             f o n t W e i g h t :   ' 6 0 0 ' ,    
                                                                                             c u r s o r :   ' p o i n t e r '    
                                                                                         } }  
                                                                                     >  
                                                                                         { i s C o m p a n y E x p a n d e d   ?   '    '   :   '    ' }  
                                                                                     < / b u t t o n >  
                                                                                 < / d i v >  
                                                                             < / d i v >  
  
                                                                             { / *   E x p a n d e d   D e t a i l s   * / }  
                                                                             { i s C o m p a n y E x p a n d e d   & &   (  
                                                                                 < d i v   s t y l e = { {   b o r d e r T o p :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   p a d d i n g T o p :   ' 8 p x ' ,   m a r g i n T o p :   ' 8 p x '   } } >  
                                                                                     { / *   C o m p a n y   A d d r e s s   * / }  
                                                                                     { ( c o m p a n y . a d d r e s s S t r e e t   | |   c o m p a n y . a d d r e s s C i t y )   & &   (  
                                                                                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 8 p x ' ,   p a d d i n g :   ' 8 p x ' ,   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 '   } } >  
                                                                                             < h 6   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > A d d r e s s < / h 6 >  
                                                                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 0 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   l i n e H e i g h t :   ' 1 . 5 '   } } >  
                                                                                                 { c o m p a n y . a d d r e s s S t r e e t   & &   < d i v > { c o m p a n y . a d d r e s s S t r e e t } < / d i v > }  
                                                                                                 < d i v >  
                                                                                                     { c o m p a n y . a d d r e s s C i t y   & &   c o m p a n y . a d d r e s s C i t y }  
                                                                                                     { c o m p a n y . a d d r e s s S t a t e   & &   ` ,   $ { c o m p a n y . a d d r e s s S t a t e } ` }  
                                                                                                     { c o m p a n y . a d d r e s s Z i p   & &   `   $ { c o m p a n y . a d d r e s s Z i p } ` }  
                                                                                                 < / d i v >  
                                                                                                 { c o m p a n y . a d d r e s s C o u n t r y   & &   < d i v > { c o m p a n y . a d d r e s s C o u n t r y } < / d i v > }  
                                                                                             < / d i v >  
                                                                                         < / d i v >  
                                                                                     ) }  
                                                                                      
                                                                                     { / *   S u b s c r i p t i o n   P r i c i n g   * / }  
                                                                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   c o m p a n y U s e r s . l e n g t h   >   0   ?   ' 8 p x '   :   ' 0 ' ,   p a d d i n g :   ' 8 p x ' ,   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 '   } } >  
                                                                                         < h 6   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 6 p x '   } } > S u b s c r i p t i o n   P r i c i n g < / h 6 >  
                                                                                         { e d i t i n g   ?   (  
                                                                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( 3 ,   1 f r ) ' ,   g a p :   ' 6 p x '   } } >  
                                                                                                 < d i v >  
                                                                                                     < l a b e l   s t y l e = { {   f o n t S i z e :   ' 1 0 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   d i s p l a y :   ' b l o c k ' ,   m a r g i n B o t t o m :   ' 2 p x '   } } > M o n t h l y   ( $ ) < / l a b e l >  
                                                                                                     < i n p u t  
                                                                                                         t y p e = " n u m b e r "  
                                                                                                         v a l u e = { e d i t i n g . m o n t h l y }  
                                                                                                         o n C h a n g e = { ( e )   = >   s e t E d i t i n g P r i c i n g ( {  
                                                                                                             . . . e d i t i n g P r i c i n g ,  
                                                                                                             [ c o m p a n y . i d ] :   {   . . . e d i t i n g ,   m o n t h l y :   p a r s e F l o a t ( e . t a r g e t . v a l u e )   | |   0   }  
                                                                                                         } ) }  
                                                                                                         s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 4 p x   6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   f o n t S i z e :   ' 1 1 p x '   } }  
                                                                                                     / >  
                                                                                                 < / d i v >  
                                                                                                 < d i v >  
                                                                                                     < l a b e l   s t y l e = { {   f o n t S i z e :   ' 1 0 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   d i s p l a y :   ' b l o c k ' ,   m a r g i n B o t t o m :   ' 2 p x '   } } > Q u a r t e r l y   ( $ ) < / l a b e l >  
                                                                                                     < i n p u t  
                                                                                                         t y p e = " n u m b e r "  
                                                                                                         v a l u e = { e d i t i n g . q u a r t e r l y }  
                                                                                                         o n C h a n g e = { ( e )   = >   s e t E d i t i n g P r i c i n g ( {  
                                                                                                             . . . e d i t i n g P r i c i n g ,  
                                                                                                             [ c o m p a n y . i d ] :   {   . . . e d i t i n g ,   q u a r t e r l y :   p a r s e F l o a t ( e . t a r g e t . v a l u e )   | |   0   }  
                                                                                                         } ) }  
                                                                                                         s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 4 p x   6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   f o n t S i z e :   ' 1 1 p x '   } }  
                                                                                                     / >  
                                                                                                 < / d i v >  
                                                                                                 < d i v >  
                                                                                                     < l a b e l   s t y l e = { {   f o n t S i z e :   ' 1 0 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   d i s p l a y :   ' b l o c k ' ,   m a r g i n B o t t o m :   ' 2 p x '   } } > A n n u a l   ( $ ) < / l a b e l >  
                                                                                                     < i n p u t  
                                                                                                         t y p e = " n u m b e r "  
                                                                                                         v a l u e = { e d i t i n g . a n n u a l }  
                                                                                                         o n C h a n g e = { ( e )   = >   s e t E d i t i n g P r i c i n g ( {  
                                                                                                             . . . e d i t i n g P r i c i n g ,  
                                                                                                             [ c o m p a n y . i d ] :   {   . . . e d i t i n g ,   a n n u a l :   p a r s e F l o a t ( e . t a r g e t . v a l u e )   | |   0   }  
                                                                                                         } ) }  
                                                                                                         s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 4 p x   6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   f o n t S i z e :   ' 1 1 p x '   } }  
                                                                                                     / >  
                                                                                                 < / d i v >  
                                                                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 6 p x ' ,   g r i d C o l u m n :   ' s p a n   3 '   } } >  
                                                                                                     < b u t t o n  
                                                                                                         o n C l i c k = { ( )   = >   {  
                                                                                                             u p d a t e C o m p a n y P r i c i n g ( c o m p a n y . i d ,   e d i t i n g ) ;  
                                                                                                         } }  
                                                                                                         s t y l e = { {   p a d d i n g :   ' 4 p x   1 0 p x ' ,   b a c k g r o u n d :   ' # 1 0 b 9 8 1 ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   f o n t S i z e :   ' 1 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } }  
                                                                                                     >  
                                                                                                         S a v e  
                                                                                                     < / b u t t o n >  
                                                                                                     < b u t t o n  
                                                                                                         o n C l i c k = { ( )   = >   {  
                                                                                                             s e t E d i t i n g P r i c i n g ( ( p r e v )   = >   {  
                                                                                                                 c o n s t   n e w S t a t e   =   {   . . . p r e v   } ;  
                                                                                                                 d e l e t e   n e w S t a t e [ c o m p a n y . i d ] ;  
                                                                                                                 r e t u r n   n e w S t a t e ;  
                                                                                                             } ) ;  
                                                                                                         } }  
                                                                                                         s t y l e = { {   p a d d i n g :   ' 4 p x   1 0 p x ' ,   b a c k g r o u n d :   ' # 9 4 a 3 b 8 ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   f o n t S i z e :   ' 1 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } }  
                                                                                                     >  
                                                                                                         C a n c e l  
                                                                                                     < / b u t t o n >  
                                                                                                 < / d i v >  
                                                                                             < / d i v >  
                                                                                         )   :   (  
                                                                                             < d i v >  
                                                                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 0 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   l i n e H e i g h t :   ' 1 . 5 ' ,   m a r g i n B o t t o m :   ' 6 p x '   } } >  
                                                                                                     < d i v > < s t r o n g > M o n t h l y : < / s t r o n g >   $ { c o m p a n y . s u b s c r i p t i o n M o n t h l y P r i c e ? . t o F i x e d ( 2 )   | |   ' 1 9 5 . 0 0 ' } < / d i v >  
                                                                                                     < d i v > < s t r o n g > Q u a r t e r l y : < / s t r o n g >   $ { c o m p a n y . s u b s c r i p t i o n Q u a r t e r l y P r i c e ? . t o F i x e d ( 2 )   | |   ' 5 0 0 . 0 0 ' } < / d i v >  
                                                                                                     < d i v > < s t r o n g > A n n u a l : < / s t r o n g >   $ { c o m p a n y . s u b s c r i p t i o n A n n u a l P r i c e ? . t o F i x e d ( 2 )   | |   ' 1 7 5 0 . 0 0 ' } < / d i v >  
                                                                                                 < / d i v >  
                                                                                                 < b u t t o n  
                                                                                                     o n C l i c k = { ( )   = >   {  
                                                                                                         s e t E d i t i n g P r i c i n g ( {  
                                                                                                             . . . e d i t i n g P r i c i n g ,  
                                                                                                             [ c o m p a n y . i d ] :   {  
                                                                                                                 m o n t h l y :   c o m p a n y . s u b s c r i p t i o n M o n t h l y P r i c e   | |   1 9 5 ,  
                                                                                                                 q u a r t e r l y :   c o m p a n y . s u b s c r i p t i o n Q u a r t e r l y P r i c e   | |   5 0 0 ,  
                                                                                                                 a n n u a l :   c o m p a n y . s u b s c r i p t i o n A n n u a l P r i c e   | |   1 7 5 0  
                                                                                                             }  
                                                                                                         } ) ;  
                                                                                                     } }  
                                                                                                     s t y l e = { {   p a d d i n g :   ' 4 p x   1 0 p x ' ,   b a c k g r o u n d :   ' # 6 6 7 e e a ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   f o n t S i z e :   ' 1 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } }  
                                                                                                 >  
                                                                                                     E d i t   P r i c i n g  
                                                                                                 < / b u t t o n >  
                                                                                             < / d i v >  
                                                                                         ) }  
                                                                                     < / d i v >  
  
                                                                                     { / *   U s e r s   * / }  
                                                                                     { c o m p a n y U s e r s . l e n g t h   >   0   & &   (  
                                                                                         < d i v >  
                                                                                             < h 6   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > U s e r s : < / h 6 >  
                                                                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g a p :   ' 4 p x '   } } >  
                                                                                                 { c o m p a n y U s e r s . m a p ( ( u s e r )   = >   (  
                                                                                                     < d i v   k e y = { u s e r . i d }   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   p a d d i n g :   ' 6 p x   8 p x ' ,   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r '   } } >  
                                                                                                         < d i v >  
                                                                                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > { u s e r . n a m e } < / d i v >  
                                                                                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 0 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { u s e r . e m a i l } < / d i v >  
                                                                                                         < / d i v >  
                                                                                                     < / d i v >  
                                                                                                 ) ) }  
                                                                                             < / d i v >  
                                                                                         < / d i v >  
                                                                                     ) }  
                                                                                 < / d i v >  
                                                                             ) }  
                                                                         < / d i v >  
                                                                     ) ;  
                                                                 } ) }  
                                                             < / d i v >  
                                                         ) }  
                                                     < / d i v >  
                                                 ) }  
                                             < / d i v >  
                                         ) ;  
                                     } ) }  
                                 < / d i v >  
                             ) }  
                             < / >  
                             ) }  
  
                             { / *   B u s i n e s s e s   T a b   * / }  
                             { s i t e A d m i n T a b   = = =   ' b u s i n e s s e s '   & &   (  
                                 < d i v >  
                                     { / *   B u s i n e s s e s   L i s t   * / }  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 0 p x '   } } >  
                                         T o t a l   B u s i n e s s e s :   { c o n s u l t a n t s . f i l t e r ( c   = >   c . t y p e   = = =   ' b u s i n e s s ' ) . l e n g t h }  
                                     < / d i v >  
  
                                     { c o n s u l t a n t s . f i l t e r ( c   = >   c . t y p e   = = =   ' b u s i n e s s ' ) . l e n g t h   = = =   0   ?   (  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 4 0 p x ' ,   t e x t A l i g n :   ' c e n t e r ' ,   b o x S h a d o w :   ' 0   1 p x   3 p x   r g b a ( 0 , 0 , 0 , 0 . 0 8 ) '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 3 6 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  x  < / d i v >  
                                             < h 3   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 6 p x '   } } > N o   b u s i n e s s e s   r e g i s t e r e d   y e t < / h 3 >  
                                             < p   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 9 4 a 3 b 8 '   } } > B u s i n e s s e s   w i l l   a p p e a r   h e r e   o n c e   t h e y   r e g i s t e r < / p >  
                                         < / d i v >  
                                     )   :   (  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g a p :   ' 1 2 p x '   } } >  
                                             { c o n s u l t a n t s . f i l t e r ( c   = >   c . t y p e   = = =   ' b u s i n e s s ' ) . m a p ( ( b u s i n e s s )   = >   {  
                                                 c o n s t   b u s i n e s s C o m p a n y   =   c o m p a n i e s . f i n d ( c o m p   = >   c o m p . c o n s u l t a n t I d   = = =   b u s i n e s s . i d ) ;  
                                                 c o n s t   i s E x p a n d e d   =   e x p a n d e d B u s i n e s s I d s . h a s ( b u s i n e s s . i d ) ;  
                                                 c o n s t   e d i t i n g   =   e d i t i n g P r i c i n g [ b u s i n e s s . i d ] ;  
                                                  
                                                 r e t u r n   (  
                                                     < d i v   k e y = { b u s i n e s s . i d }   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 2 p x   1 6 p x ' ,   b o x S h a d o w :   ' 0   1 p x   3 p x   r g b a ( 0 , 0 , 0 , 0 . 0 8 ) ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                         { / *   B u s i n e s s   H e a d e r   * / }  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r '   } } >  
                                                             < d i v   s t y l e = { {   f l e x :   1   } } >  
                                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 8 p x '   } } >  
                                                                     < h 3    
                                                                         o n C l i c k = { ( )   = >   {  
                                                                             / /   S a v e   c u r r e n t   a d m i n   u s e r  
                                                                             s e t S i t e A d m i n V i e w i n g A s ( c u r r e n t U s e r ) ;  
                                                                             / /   S w i t c h   t o   v i e w i n g   t h i s   b u s i n e s s ' s   d a s h b o a r d  
                                                                             s e t C u r r e n t U s e r ( {  
                                                                                 . . . b u s i n e s s . u s e r ,  
                                                                                 r o l e :   ' c o n s u l t a n t ' ,  
                                                                                 c o n s u l t a n t I d :   b u s i n e s s . i d ,  
                                                                                 c o n s u l t a n t T y p e :   b u s i n e s s . t y p e  
                                                                             } ) ;  
                                                                             s e t C u r r e n t V i e w ( ' a d m i n ' ) ;  
                                                                         } }  
                                                                         s t y l e = { {    
                                                                             f o n t S i z e :   ' 1 5 p x ' ,    
                                                                             f o n t W e i g h t :   ' 6 0 0 ' ,    
                                                                             c o l o r :   ' # 6 6 7 e e a ' ,    
                                                                             m a r g i n :   0 ,  
                                                                             c u r s o r :   ' p o i n t e r ' ,  
                                                                             t e x t D e c o r a t i o n :   ' u n d e r l i n e '  
                                                                         } }  
                                                                         o n M o u s e E n t e r = { ( e )   = >   e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 5 5 6 8 d 3 ' }  
                                                                         o n M o u s e L e a v e = { ( e )   = >   e . c u r r e n t T a r g e t . s t y l e . c o l o r   =   ' # 6 6 7 e e a ' }  
                                                                     >  
                                                                         { b u s i n e s s . f u l l N a m e }  
                                                                     < / h 3 >  
                                                                 < / d i v >  
                                                             < / d i v >  
                                                             < b u t t o n  
                                                                 o n C l i c k = { ( )   = >   {  
                                                                     s e t E x p a n d e d B u s i n e s s I d s ( p r e v   = >   {  
                                                                         c o n s t   n e w S e t   =   n e w   S e t ( p r e v ) ;  
                                                                         i f   ( n e w S e t . h a s ( b u s i n e s s . i d ) )   {  
                                                                             n e w S e t . d e l e t e ( b u s i n e s s . i d ) ;  
                                                                         }   e l s e   {  
                                                                             n e w S e t . a d d ( b u s i n e s s . i d ) ;  
                                                                         }  
                                                                         r e t u r n   n e w S e t ;  
                                                                     } ) ;  
                                                                 } }  
                                                                 s t y l e = { {   p a d d i n g :   ' 6 p x   1 2 p x ' ,   b a c k g r o u n d :   ' # 6 6 7 e e a ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } }  
                                                             >  
                                                                 { i s E x p a n d e d   ?   ' C o l l a p s e '   :   ' E x p a n d ' }  
                                                             < / b u t t o n >  
                                                         < / d i v >  
  
                                                         { / *   E x p a n d e d   D e t a i l s   * / }  
                                                         { i s E x p a n d e d   & &   (  
                                                             < d i v   s t y l e = { {   b o r d e r T o p :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   m a r g i n T o p :   ' 1 0 p x ' ,   p a d d i n g T o p :   ' 1 0 p x '   } } >  
  
                                                                 { / *   B u s i n e s s   I n f o r m a t i o n   * / }  
                                                                 < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 8 p x ' ,   p a d d i n g :   ' 8 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 6 p x '   } } >  
                                                                     < h 4   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > B u s i n e s s   I n f o r m a t i o n < / h 4 >  
                                                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 0 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   l i n e H e i g h t :   ' 1 . 5 '   } } >  
                                                                         < d i v > < s t r o n g > T y p e : < / s t r o n g >   { b u s i n e s s . t y p e } < / d i v >  
                                                                         < d i v > < s t r o n g > E m a i l : < / s t r o n g >   { b u s i n e s s . u s e r ? . e m a i l } < / d i v >  
                                                                         < d i v > < s t r o n g > P h o n e : < / s t r o n g >   { b u s i n e s s . p h o n e   | |   ' N o t   p r o v i d e d ' } < / d i v >  
                                                                         < d i v > < s t r o n g > A d d r e s s : < / s t r o n g >   {  
                                                                             b u s i n e s s C o m p a n y   & &   ( b u s i n e s s C o m p a n y . a d d r e s s S t r e e t   | |   b u s i n e s s C o m p a n y . a d d r e s s C i t y )   ?   (  
                                                                                 < >  
                                                                                     { b u s i n e s s C o m p a n y . a d d r e s s S t r e e t   & &   < > { b u s i n e s s C o m p a n y . a d d r e s s S t r e e t } < b r   / > < / > }  
                                                                                     { b u s i n e s s C o m p a n y . a d d r e s s C i t y   & &   b u s i n e s s C o m p a n y . a d d r e s s C i t y }  
                                                                                     { b u s i n e s s C o m p a n y . a d d r e s s S t a t e   & &   ` ,   $ { b u s i n e s s C o m p a n y . a d d r e s s S t a t e } ` }  
                                                                                     { b u s i n e s s C o m p a n y . a d d r e s s Z i p   & &   `   $ { b u s i n e s s C o m p a n y . a d d r e s s Z i p } ` }  
                                                                                     { b u s i n e s s C o m p a n y . a d d r e s s C o u n t r y   & &   < > < b r   / > { b u s i n e s s C o m p a n y . a d d r e s s C o u n t r y } < / > }  
                                                                                 < / >  
                                                                             )   :   ' N o t   p r o v i d e d '  
                                                                         } < / d i v >  
                                                                     < / d i v >  
                                                                 < / d i v >  
  
                                                                 { / *   C o m p a n y   D e t a i l s   * / }  
                                                                 { b u s i n e s s C o m p a n y   & &   (  
                                                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 8 p x ' ,   p a d d i n g :   ' 8 p x ' ,   b a c k g r o u n d :   ' # f 0 f 9 f f ' ,   b o r d e r R a d i u s :   ' 6 p x '   } } >  
                                                                         < h 4   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > C o m p a n y   D e t a i l s < / h 4 >  
                                                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 0 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   l i n e H e i g h t :   ' 1 . 5 '   } } >  
                                                                             < d i v > < s t r o n g > C o m p a n y   N a m e : < / s t r o n g >   { b u s i n e s s C o m p a n y . n a m e } < / d i v >  
                                                                             < d i v > < s t r o n g > I n d u s t r y : < / s t r o n g >   { b u s i n e s s C o m p a n y . i n d u s t r y S e c t o r   | |   ' N o t   s e t ' } < / d i v >  
                                                                         < / d i v >  
                                                                     < / d i v >  
                                                                 ) }  
  
                                                                 { / *   S u b s c r i p t i o n   P r i c i n g   * / }  
                                                                 < d i v   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   b a c k g r o u n d :   ' # f e f 3 c 7 ' ,   b o r d e r R a d i u s :   ' 6 p x '   } } >  
                                                                     < h 4   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 6 p x '   } } > S u b s c r i p t i o n   P r i c i n g < / h 4 >  
                                                                     { e d i t i n g   ?   (  
                                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( 3 ,   1 f r ) ' ,   g a p :   ' 6 p x '   } } >  
                                                                             < d i v >  
                                                                                 < l a b e l   s t y l e = { {   f o n t S i z e :   ' 1 0 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   d i s p l a y :   ' b l o c k ' ,   m a r g i n B o t t o m :   ' 2 p x '   } } > M o n t h l y   ( $ ) < / l a b e l >  
                                                                                 < i n p u t  
                                                                                     t y p e = " n u m b e r "  
                                                                                     v a l u e = { e d i t i n g . m o n t h l y }  
                                                                                     o n C h a n g e = { ( e )   = >   s e t E d i t i n g P r i c i n g ( {  
                                                                                         . . . e d i t i n g P r i c i n g ,  
                                                                                         [ b u s i n e s s . i d ] :   {   . . . e d i t i n g ,   m o n t h l y :   p a r s e F l o a t ( e . t a r g e t . v a l u e )   | |   0   }  
                                                                                     } ) }  
                                                                                     s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 4 p x   6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   f o n t S i z e :   ' 1 1 p x '   } }  
                                                                                 / >  
                                                                             < / d i v >  
                                                                             < d i v >  
                                                                                 < l a b e l   s t y l e = { {   f o n t S i z e :   ' 1 0 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   d i s p l a y :   ' b l o c k ' ,   m a r g i n B o t t o m :   ' 2 p x '   } } > Q u a r t e r l y   ( $ ) < / l a b e l >  
                                                                                 < i n p u t  
                                                                                     t y p e = " n u m b e r "  
                                                                                     v a l u e = { e d i t i n g . q u a r t e r l y }  
                                                                                     o n C h a n g e = { ( e )   = >   s e t E d i t i n g P r i c i n g ( {  
                                                                                         . . . e d i t i n g P r i c i n g ,  
                                                                                         [ b u s i n e s s . i d ] :   {   . . . e d i t i n g ,   q u a r t e r l y :   p a r s e F l o a t ( e . t a r g e t . v a l u e )   | |   0   }  
                                                                                     } ) }  
                                                                                     s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 4 p x   6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   f o n t S i z e :   ' 1 1 p x '   } }  
                                                                                 / >  
                                                                             < / d i v >  
                                                                             < d i v >  
                                                                                 < l a b e l   s t y l e = { {   f o n t S i z e :   ' 1 0 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   d i s p l a y :   ' b l o c k ' ,   m a r g i n B o t t o m :   ' 2 p x '   } } > A n n u a l   ( $ ) < / l a b e l >  
                                                                                 < i n p u t  
                                                                                     t y p e = " n u m b e r "  
                                                                                     v a l u e = { e d i t i n g . a n n u a l }  
                                                                                     o n C h a n g e = { ( e )   = >   s e t E d i t i n g P r i c i n g ( {  
                                                                                         . . . e d i t i n g P r i c i n g ,  
                                                                                         [ b u s i n e s s . i d ] :   {   . . . e d i t i n g ,   a n n u a l :   p a r s e F l o a t ( e . t a r g e t . v a l u e )   | |   0   }  
                                                                                     } ) }  
                                                                                     s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 4 p x   6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   f o n t S i z e :   ' 1 1 p x '   } }  
                                                                                 / >  
                                                                             < / d i v >  
                                                                             < b u t t o n  
                                                                                 o n C l i c k = { ( )   = >   {  
                                                                                     i f   ( b u s i n e s s C o m p a n y )   {  
                                                                                         u p d a t e C o m p a n y P r i c i n g ( b u s i n e s s C o m p a n y . i d ,   e d i t i n g ) ;  
                                                                                     }  
                                                                                 } }  
                                                                                 s t y l e = { {   p a d d i n g :   ' 4 p x   1 0 p x ' ,   b a c k g r o u n d :   ' # 1 0 b 9 8 1 ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   f o n t S i z e :   ' 1 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } }  
                                                                             >  
                                                                                 S a v e  
                                                                             < / b u t t o n >  
                                                                             < b u t t o n  
                                                                                 o n C l i c k = { ( )   = >   {  
                                                                                     s e t E d i t i n g P r i c i n g ( ( p r e v )   = >   {  
                                                                                         c o n s t   n e w S t a t e   =   {   . . . p r e v   } ;  
                                                                                         d e l e t e   n e w S t a t e [ b u s i n e s s . i d ] ;  
                                                                                         r e t u r n   n e w S t a t e ;  
                                                                                     } ) ;  
                                                                                 } }  
                                                                                 s t y l e = { {   p a d d i n g :   ' 4 p x   1 0 p x ' ,   b a c k g r o u n d :   ' # 9 4 a 3 b 8 ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   f o n t S i z e :   ' 1 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } }  
                                                                             >  
                                                                                 C a n c e l  
                                                                             < / b u t t o n >  
                                                                         < / d i v >  
                                                                     )   :   (  
                                                                         < d i v >  
                                                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 0 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   l i n e H e i g h t :   ' 1 . 5 ' ,   m a r g i n B o t t o m :   ' 6 p x '   } } >  
                                                                                 < d i v > < s t r o n g > M o n t h l y : < / s t r o n g >   $ { b u s i n e s s C o m p a n y ? . s u b s c r i p t i o n M o n t h l y P r i c e ? . t o F i x e d ( 2 )   | |   ' 1 9 5 . 0 0 ' } < / d i v >  
                                                                                 < d i v > < s t r o n g > Q u a r t e r l y : < / s t r o n g >   $ { b u s i n e s s C o m p a n y ? . s u b s c r i p t i o n Q u a r t e r l y P r i c e ? . t o F i x e d ( 2 )   | |   ' 5 0 0 . 0 0 ' } < / d i v >  
                                                                                 < d i v > < s t r o n g > A n n u a l : < / s t r o n g >   $ { b u s i n e s s C o m p a n y ? . s u b s c r i p t i o n A n n u a l P r i c e ? . t o F i x e d ( 2 )   | |   ' 1 7 5 0 . 0 0 ' } < / d i v >  
                                                                             < / d i v >  
                                                                             < b u t t o n  
                                                                                 o n C l i c k = { ( )   = >   {  
                                                                                     s e t E d i t i n g P r i c i n g ( {  
                                                                                         . . . e d i t i n g P r i c i n g ,  
                                                                                         [ b u s i n e s s . i d ] :   {  
                                                                                             m o n t h l y :   b u s i n e s s C o m p a n y ? . s u b s c r i p t i o n M o n t h l y P r i c e   | |   1 9 5 ,  
                                                                                             q u a r t e r l y :   b u s i n e s s C o m p a n y ? . s u b s c r i p t i o n Q u a r t e r l y P r i c e   | |   5 0 0 ,  
                                                                                             a n n u a l :   b u s i n e s s C o m p a n y ? . s u b s c r i p t i o n A n n u a l P r i c e   | |   1 7 5 0  
                                                                                         }  
                                                                                     } ) ;  
                                                                                 } }  
                                                                                 s t y l e = { {   p a d d i n g :   ' 4 p x   1 0 p x ' ,   b a c k g r o u n d :   ' # 6 6 7 e e a ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   f o n t S i z e :   ' 1 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } }  
                                                                             >  
                                                                                 E d i t   P r i c i n g  
                                                                             < / b u t t o n >  
                                                                         < / d i v >  
                                                                     ) }  
                                                                 < / d i v >  
                                                             < / d i v >  
                                                         ) }  
                                                     < / d i v >  
                                                 ) ;  
                                             } ) }  
                                         < / d i v >  
                                     ) }  
                                 < / d i v >  
                             ) }  
                         < / d i v >  
                     ) }  
  
                     { / *   A d m i n   D a s h b o a r d   * / }  
                     { c u r r e n t V i e w   = = =   ' a d m i n '   & &   c u r r e n t U s e r ? . r o l e   = = =   ' c o n s u l t a n t '   & &   (  
                 < d i v   s t y l e = { {   m a x W i d t h :   ' 1 4 0 0 p x ' ,   m a r g i n :   ' 0   a u t o ' ,   p a d d i n g :   ' 3 2 p x '   } } >  
                     < d i v   c l a s s N a m e = " d a s h b o a r d - h e a d e r - p r i n t - h i d e "   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                         < h 1   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n :   0   } } >  
                             { c u r r e n t U s e r . c o n s u l t a n t T y p e   = = =   ' b u s i n e s s '   ?   ' B u s i n e s s   D a s h b o a r d '   :   ' C o n s u l t a n t   D a s h b o a r d ' }  
                         < / h 1 >  
                         { s i t e A d m i n V i e w i n g A s   & &   (  
                             < b u t t o n  
                                 o n C l i c k = { ( )   = >   {  
                                     / /   R e s t o r e   a d m i n   u s e r  
                                     s e t C u r r e n t U s e r ( s i t e A d m i n V i e w i n g A s ) ;  
                                     s e t S i t e A d m i n V i e w i n g A s ( n u l l ) ;  
                                     s e t C u r r e n t V i e w ( ' s i t e a d m i n ' ) ;  
                                 } }  
                                 s t y l e = { {    
                                     p a d d i n g :   ' 1 0 p x   2 0 p x ' ,    
                                     b a c k g r o u n d :   ' # f 5 9 e 0 b ' ,    
                                     c o l o r :   ' w h i t e ' ,    
                                     b o r d e r :   ' n o n e ' ,    
                                     b o r d e r R a d i u s :   ' 8 p x ' ,    
                                     f o n t S i z e :   ' 1 4 p x ' ,    
                                     f o n t W e i g h t :   ' 6 0 0 ' ,    
                                     c u r s o r :   ' p o i n t e r ' ,  
                                     d i s p l a y :   ' f l e x ' ,  
                                     a l i g n I t e m s :   ' c e n t e r ' ,  
                                     g a p :   ' 8 p x '  
                                 } }  
                             >  
                                       B a c k   t o   S i t e   A d m i n  
                             < / b u t t o n >  
                         ) }  
                     < / d i v >  
                      
                     { / *   T a b   N a v i g a t i o n   * / }  
                     < d i v   c l a s s N a m e = " d a s h b o a r d - t a b s - p r i n t - h i d e "   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 8 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                         < b u t t o n  
                             o n C l i c k = { ( )   = >   s e t A d m i n D a s h b o a r d T a b ( ' c o m p a n y - m a n a g e m e n t ' ) }  
                             s t y l e = { {  
                                 p a d d i n g :   ' 1 2 p x   2 4 p x ' ,  
                                 b a c k g r o u n d :   a d m i n D a s h b o a r d T a b   = = =   ' c o m p a n y - m a n a g e m e n t '   ?   ' # 6 6 7 e e a '   :   ' t r a n s p a r e n t ' ,  
                                 c o l o r :   a d m i n D a s h b o a r d T a b   = = =   ' c o m p a n y - m a n a g e m e n t '   ?   ' w h i t e '   :   ' # 6 4 7 4 8 b ' ,  
                                 b o r d e r :   ' n o n e ' ,  
                                 b o r d e r B o t t o m :   a d m i n D a s h b o a r d T a b   = = =   ' c o m p a n y - m a n a g e m e n t '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t ' ,  
                                 f o n t S i z e :   ' 1 6 p x ' ,  
                                 f o n t W e i g h t :   ' 6 0 0 ' ,  
                                 c u r s o r :   ' p o i n t e r ' ,  
                                 b o r d e r R a d i u s :   ' 8 p x   8 p x   0   0 ' ,  
                                 t r a n s i t i o n :   ' a l l   0 . 2 s '  
                             } }  
                         >  
                             C o m p a n y   M a n a g e m e n t  
                         < / b u t t o n >  
                         < b u t t o n  
                             o n C l i c k = { ( )   = >   s e t A d m i n D a s h b o a r d T a b ( ' p a y m e n t s ' ) }  
                             s t y l e = { {  
                                 p a d d i n g :   ' 1 2 p x   2 4 p x ' ,  
                                 b a c k g r o u n d :   a d m i n D a s h b o a r d T a b   = = =   ' p a y m e n t s '   ?   ' # 6 6 7 e e a '   :   ' t r a n s p a r e n t ' ,  
                                 c o l o r :   a d m i n D a s h b o a r d T a b   = = =   ' p a y m e n t s '   ?   ' w h i t e '   :   ' # 6 4 7 4 8 b ' ,  
                                 b o r d e r :   ' n o n e ' ,  
                                 b o r d e r B o t t o m :   a d m i n D a s h b o a r d T a b   = = =   ' p a y m e n t s '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t ' ,  
                                 f o n t S i z e :   ' 1 6 p x ' ,  
                                 f o n t W e i g h t :   ' 6 0 0 ' ,  
                                 c u r s o r :   ' p o i n t e r ' ,  
                                 b o r d e r R a d i u s :   ' 8 p x   8 p x   0   0 ' ,  
                                 t r a n s i t i o n :   ' a l l   0 . 2 s '  
                             } }  
                         >  
                             B i l l i n g  
                         < / b u t t o n >  
                         < b u t t o n  
                             o n C l i c k = { ( )   = >   s e t A d m i n D a s h b o a r d T a b ( ' i m p o r t - f i n a n c i a l s ' ) }  
                             s t y l e = { {  
                                 p a d d i n g :   ' 1 2 p x   2 4 p x ' ,  
                                 b a c k g r o u n d :   a d m i n D a s h b o a r d T a b   = = =   ' i m p o r t - f i n a n c i a l s '   ?   ' # 6 6 7 e e a '   :   ' t r a n s p a r e n t ' ,  
                                 c o l o r :   a d m i n D a s h b o a r d T a b   = = =   ' i m p o r t - f i n a n c i a l s '   ?   ' w h i t e '   :   ' # 6 4 7 4 8 b ' ,  
                                 b o r d e r :   ' n o n e ' ,  
                                 b o r d e r B o t t o m :   a d m i n D a s h b o a r d T a b   = = =   ' i m p o r t - f i n a n c i a l s '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t ' ,  
                                 f o n t S i z e :   ' 1 6 p x ' ,  
                                 f o n t W e i g h t :   ' 6 0 0 ' ,  
                                 c u r s o r :   ' p o i n t e r ' ,  
                                 b o r d e r R a d i u s :   ' 8 p x   8 p x   0   0 ' ,  
                                 t r a n s i t i o n :   ' a l l   0 . 2 s '  
                             } }  
                         >  
                             I m p o r t   F i n a n c i a l s  
                         < / b u t t o n >  
                         < b u t t o n  
                             o n C l i c k = { ( )   = >   s e t A d m i n D a s h b o a r d T a b ( ' a p i - c o n n e c t i o n s ' ) }  
                             s t y l e = { {  
                                 p a d d i n g :   ' 1 2 p x   2 4 p x ' ,  
                                 b a c k g r o u n d :   a d m i n D a s h b o a r d T a b   = = =   ' a p i - c o n n e c t i o n s '   ?   ' # 6 6 7 e e a '   :   ' t r a n s p a r e n t ' ,  
                                 c o l o r :   a d m i n D a s h b o a r d T a b   = = =   ' a p i - c o n n e c t i o n s '   ?   ' w h i t e '   :   ' # 6 4 7 4 8 b ' ,  
                                 b o r d e r :   ' n o n e ' ,  
                                 b o r d e r B o t t o m :   a d m i n D a s h b o a r d T a b   = = =   ' a p i - c o n n e c t i o n s '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t ' ,  
                                 f o n t S i z e :   ' 1 6 p x ' ,  
                                 f o n t W e i g h t :   ' 6 0 0 ' ,  
                                 c u r s o r :   ' p o i n t e r ' ,  
                                 b o r d e r R a d i u s :   ' 8 p x   8 p x   0   0 ' ,  
                                 t r a n s i t i o n :   ' a l l   0 . 2 s '  
                             } }  
                         >  
                             A c c o u n t i n g   A P I   C o n n e c t i o n s  
                         < / b u t t o n >  
                         < b u t t o n  
                             o n C l i c k = { ( )   = >   s e t A d m i n D a s h b o a r d T a b ( ' d a t a - r e v i e w ' ) }  
                             s t y l e = { {  
                                 p a d d i n g :   ' 1 2 p x   2 4 p x ' ,  
                                 b a c k g r o u n d :   a d m i n D a s h b o a r d T a b   = = =   ' d a t a - r e v i e w '   ?   ' # 6 6 7 e e a '   :   ' t r a n s p a r e n t ' ,  
                                 c o l o r :   a d m i n D a s h b o a r d T a b   = = =   ' d a t a - r e v i e w '   ?   ' w h i t e '   :   ' # 6 4 7 4 8 b ' ,  
                                 b o r d e r :   ' n o n e ' ,  
                                 b o r d e r B o t t o m :   a d m i n D a s h b o a r d T a b   = = =   ' d a t a - r e v i e w '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t ' ,  
                                 f o n t S i z e :   ' 1 6 p x ' ,  
                                 f o n t W e i g h t :   ' 6 0 0 ' ,  
                                 c u r s o r :   ' p o i n t e r ' ,  
                                 b o r d e r R a d i u s :   ' 8 p x   8 p x   0   0 ' ,  
                                 t r a n s i t i o n :   ' a l l   0 . 2 s '  
                             } }  
                         >  
                             D a t a   R e v i e w  
                         < / b u t t o n >  
                         < b u t t o n  
                             o n C l i c k = { ( )   = >   s e t A d m i n D a s h b o a r d T a b ( ' d a t a - m a p p i n g ' ) }  
                             s t y l e = { {  
                                 p a d d i n g :   ' 1 2 p x   2 4 p x ' ,  
                                 b a c k g r o u n d :   a d m i n D a s h b o a r d T a b   = = =   ' d a t a - m a p p i n g '   ?   ' # 6 6 7 e e a '   :   ' t r a n s p a r e n t ' ,  
                                 c o l o r :   a d m i n D a s h b o a r d T a b   = = =   ' d a t a - m a p p i n g '   ?   ' w h i t e '   :   ' # 6 4 7 4 8 b ' ,  
                                 b o r d e r :   ' n o n e ' ,  
                                 b o r d e r B o t t o m :   a d m i n D a s h b o a r d T a b   = = =   ' d a t a - m a p p i n g '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t ' ,  
                                 f o n t S i z e :   ' 1 6 p x ' ,  
                                 f o n t W e i g h t :   ' 6 0 0 ' ,  
                                 c u r s o r :   ' p o i n t e r ' ,  
                                 b o r d e r R a d i u s :   ' 8 p x   8 p x   0   0 ' ,  
                                 t r a n s i t i o n :   ' a l l   0 . 2 s '  
                             } }  
                         >  
                             D a t a   M a p p i n g  
                         < / b u t t o n >  
                     < / d i v >  
                      
                     { / *   C o m p a n y   M a n a g e m e n t   T a b   * / }  
                     { a d m i n D a s h b o a r d T a b   = = =   ' c o m p a n y - m a n a g e m e n t '   & &   (  
                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                         { / *   S u b - T a b   N a v i g a t i o n   * / }  
                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 8 p x ' ,   m a r g i n B o t t o m :   ' 2 4 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                             < b u t t o n  
                                 o n C l i c k = { ( )   = >   s e t C o m p a n y M a n a g e m e n t S u b T a b ( ' c o m p a n y - m a n a g e m e n t ' ) }  
                                 s t y l e = { {  
                                     p a d d i n g :   ' 1 2 p x   2 4 p x ' ,  
                                     b a c k g r o u n d :   c o m p a n y M a n a g e m e n t S u b T a b   = = =   ' c o m p a n y - m a n a g e m e n t '   ?   ' # 6 6 7 e e a '   :   ' t r a n s p a r e n t ' ,  
                                     c o l o r :   c o m p a n y M a n a g e m e n t S u b T a b   = = =   ' c o m p a n y - m a n a g e m e n t '   ?   ' w h i t e '   :   ' # 6 4 7 4 8 b ' ,  
                                     b o r d e r :   ' n o n e ' ,  
                                     b o r d e r B o t t o m :   c o m p a n y M a n a g e m e n t S u b T a b   = = =   ' c o m p a n y - m a n a g e m e n t '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t ' ,  
                                     f o n t S i z e :   ' 1 4 p x ' ,  
                                     f o n t W e i g h t :   ' 6 0 0 ' ,  
                                     c u r s o r :   ' p o i n t e r ' ,  
                                     b o r d e r R a d i u s :   ' 8 p x   8 p x   0   0 ' ,  
                                     t r a n s i t i o n :   ' a l l   0 . 2 s '  
                                 } }  
                             >  
                                 C o m p a n y   M a n a g e m e n t  
                             < / b u t t o n >  
                             < b u t t o n  
                                 o n C l i c k = { ( )   = >   s e t C o m p a n y M a n a g e m e n t S u b T a b ( ' b i l l i n g ' ) }  
                                 s t y l e = { {  
                                     p a d d i n g :   ' 1 2 p x   2 4 p x ' ,  
                                     b a c k g r o u n d :   c o m p a n y M a n a g e m e n t S u b T a b   = = =   ' b i l l i n g '   ?   ' # 6 6 7 e e a '   :   ' t r a n s p a r e n t ' ,  
                                     c o l o r :   c o m p a n y M a n a g e m e n t S u b T a b   = = =   ' b i l l i n g '   ?   ' w h i t e '   :   ' # 6 4 7 4 8 b ' ,  
                                     b o r d e r :   ' n o n e ' ,  
                                     b o r d e r B o t t o m :   c o m p a n y M a n a g e m e n t S u b T a b   = = =   ' b i l l i n g '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t ' ,  
                                     f o n t S i z e :   ' 1 4 p x ' ,  
                                     f o n t W e i g h t :   ' 6 0 0 ' ,  
                                     c u r s o r :   ' p o i n t e r ' ,  
                                     b o r d e r R a d i u s :   ' 8 p x   8 p x   0   0 ' ,  
                                     t r a n s i t i o n :   ' a l l   0 . 2 s '  
                                 } }  
                             >  
                                 B i l l i n g  
                             < / b u t t o n >  
                             < b u t t o n  
                                 o n C l i c k = { ( )   = >   s e t C o m p a n y M a n a g e m e n t S u b T a b ( ' p r o f i l e ' ) }  
                                 s t y l e = { {  
                                     p a d d i n g :   ' 1 2 p x   2 4 p x ' ,  
                                     b a c k g r o u n d :   c o m p a n y M a n a g e m e n t S u b T a b   = = =   ' p r o f i l e '   ?   ' # 6 6 7 e e a '   :   ' t r a n s p a r e n t ' ,  
                                     c o l o r :   c o m p a n y M a n a g e m e n t S u b T a b   = = =   ' p r o f i l e '   ?   ' w h i t e '   :   ' # 6 4 7 4 8 b ' ,  
                                     b o r d e r :   ' n o n e ' ,  
                                     b o r d e r B o t t o m :   c o m p a n y M a n a g e m e n t S u b T a b   = = =   ' p r o f i l e '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t ' ,  
                                     f o n t S i z e :   ' 1 4 p x ' ,  
                                     f o n t W e i g h t :   ' 6 0 0 ' ,  
                                     c u r s o r :   ' p o i n t e r ' ,  
                                     b o r d e r R a d i u s :   ' 8 p x   8 p x   0   0 ' ,  
                                     t r a n s i t i o n :   ' a l l   0 . 2 s '  
                                 } }  
                             >  
                                 P r o f i l e  
                             < / b u t t o n >  
                         < / d i v >  
  
                         { / *   C o m p a n y   M a n a g e m e n t   S u b - T a b   C o n t e n t   * / }  
                         { c o m p a n y M a n a g e m e n t S u b T a b   = = =   ' c o m p a n y - m a n a g e m e n t '   & &   (  
                             < >  
                                 { / *   S h o w   s e l e c t e d   c o m p a n y   o r   a d d   n e w   c o m p a n y   o p t i o n   * / }  
                                 { ( ( )   = >   {  
                             / /   F o r   b u s i n e s s   u s e r s ,   a u t o - s e l e c t   t h e i r   c o m p a n y   i f   n o t   a l r e a d y   s e l e c t e d  
                             i f   ( c u r r e n t U s e r . c o n s u l t a n t T y p e   = = =   ' b u s i n e s s '   & &   ! s e l e c t e d C o m p a n y I d   & &   c o m p a n i e s . l e n g t h   >   0 )   {  
                                 c o n s t   b u s i n e s s C o m p a n y   =   c o m p a n i e s . f i n d ( c   = >   c . c o n s u l t a n t I d   = = =   c u r r e n t U s e r . c o n s u l t a n t I d ) ;  
                                 i f   ( b u s i n e s s C o m p a n y )   {  
                                     s e t T i m e o u t ( ( )   = >   s e t S e l e c t e d C o m p a n y I d ( b u s i n e s s C o m p a n y . i d ) ,   0 ) ;  
                                 }  
                             }  
                              
                             r e t u r n   ! s e l e c t e d C o m p a n y I d   ?   (  
                                 < >  
                                     { / *   O n l y   s h o w   A d d   C o m p a n y   f o r   r e g u l a r   c o n s u l t a n t s   * / }  
                                     { c u r r e n t U s e r . c o n s u l t a n t T y p e   ! = =   ' b u s i n e s s '   & &   (  
                                         < >  
                                             < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                                 S e l e c t   a   c o m p a n y   f r o m   t h e   s i d e b a r   o r   c r e a t e   a   n e w   o n e :  
                                             < / p >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 1 2 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                                 < i n p u t    
                                                     t y p e = " t e x t "    
                                                     p l a c e h o l d e r = " C o m p a n y   N a m e "    
                                                     v a l u e = { n e w C o m p a n y N a m e }    
                                                     o n C h a n g e = { ( e )   = >   s e t N e w C o m p a n y N a m e ( e . t a r g e t . v a l u e ) }    
                                                     o n K e y D o w n = { ( e )   = >   e . k e y   = = =   ' E n t e r '   & &   ! i s L o a d i n g   & &   a d d C o m p a n y ( ) }  
                                                     d i s a b l e d = { i s L o a d i n g }  
                                                     s t y l e = { {   f l e x :   1 ,   p a d d i n g :   ' 1 2 p x   1 6 p x ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 4 p x '   } }    
                                                 / >  
                                                 < b u t t o n    
                                                     o n C l i c k = { a d d C o m p a n y }    
                                                     d i s a b l e d = { i s L o a d i n g }  
                                                     s t y l e = { {    
                                                         p a d d i n g :   ' 1 2 p x   2 4 p x ' ,    
                                                         b a c k g r o u n d :   i s L o a d i n g   ?   ' # 9 4 a 3 b 8 '   :   ' # 6 6 7 e e a ' ,    
                                                         c o l o r :   ' w h i t e ' ,    
                                                         b o r d e r :   ' n o n e ' ,    
                                                         b o r d e r R a d i u s :   ' 8 p x ' ,    
                                                         f o n t S i z e :   ' 1 4 p x ' ,    
                                                         f o n t W e i g h t :   ' 6 0 0 ' ,    
                                                         c u r s o r :   i s L o a d i n g   ?   ' n o t - a l l o w e d '   :   ' p o i n t e r ' ,  
                                                         o p a c i t y :   i s L o a d i n g   ?   0 . 7   :   1    
                                                     } }  
                                                 >  
                                                     { i s L o a d i n g   ?   ' A d d i n g . . . '   :   ' A d d   C o m p a n y ' }  
                                                 < / b u t t o n >  
                                             < / d i v >  
                                         < / >  
                                     ) }  
                                     { / *   F o r   b u s i n e s s   u s e r s   w i t h   n o   c o m p a n y   s e l e c t e d ,   s h o w   l o a d i n g   m e s s a g e   * / }  
                                     { c u r r e n t U s e r . c o n s u l t a n t T y p e   = = =   ' b u s i n e s s '   & &   (  
                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' c e n t e r ' ,   p a d d i n g :   ' 4 0 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } >  
                                             < p > L o a d i n g   y o u r   c o m p a n y   i n f o r m a t i o n . . . < / p >  
                                         < / d i v >  
                                     ) }  
                                 < / >  
                             )   :   (  
                             < >  
                                 { / *   O n l y   s h o w   t h e   s e l e c t e d   c o m p a n y   -   a l w a y s   e x p a n d e d   * / }  
                                 { c o m p a n i e s . f i l t e r ( c   = >   c . i d   = = =   s e l e c t e d C o m p a n y I d ) . m a p ( c o m p   = >   (  
                                 < d i v   k e y = { c o m p . i d }   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   b o r d e r :   ' 2 p x   s o l i d   # 6 6 7 e e a '   } } >  
                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                         < d i v >  
                                             < h 3   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > { c o m p . n a m e } < / h 3 >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 1 0 b 9 8 1 ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  S   A c t i v e   C o m p a n y < / d i v >  
                                         < / d i v >  
                                         { / *   O n l y   s h o w   D e l e t e   b u t t o n   f o r   r e g u l a r   c o n s u l t a n t s ,   n o t   b u s i n e s s   u s e r s   * / }  
                                         { c u r r e n t U s e r . c o n s u l t a n t T y p e   ! = =   ' b u s i n e s s '   & &   (  
                                             < b u t t o n   o n C l i c k = { ( )   = >   d e l e t e C o m p a n y ( c o m p . i d ) }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 6 p x ' ,   b a c k g r o u n d :   ' # e f 4 4 4 4 ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   f o n t S i z e :   ' 1 3 p x ' ,   c u r s o r :   ' p o i n t e r ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } > D e l e t e   C o m p a n y < / b u t t o n >  
                                         ) }  
                                     < / d i v >  
                                      
                                     { / *   C o m p a n y   I n f o r m a t i o n   * / }  
                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   p a d d i n g :   ' 1 2 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' s t a r t '   } } >  
                                             < d i v   s t y l e = { {   f l e x :   1   } } >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 6 p x '   } } >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   d i s p l a y :   ' b l o c k ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > A d d r e s s : < / s p a n >  
                                                     { c o m p . a d d r e s s S t r e e t   | |   c o m p . a d d r e s s C i t y   ?   (  
                                                         < >  
                                                             { c o m p . a d d r e s s S t r e e t   & &   < d i v   s t y l e = { {   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 2 p x '   } } > { c o m p . a d d r e s s S t r e e t } < / d i v > }  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 1 e 2 9 3 b '   } } >  
                                                                 { c o m p . a d d r e s s C i t y   & &   c o m p . a d d r e s s C i t y }  
                                                                 { c o m p . a d d r e s s S t a t e   & &   ` ,   $ { c o m p . a d d r e s s S t a t e } ` }  
                                                                 { c o m p . a d d r e s s Z i p   & &   `   $ { c o m p . a d d r e s s Z i p } ` }  
                                                             < / d i v >  
                                                             { c o m p . a d d r e s s C o u n t r y   & &   < d i v   s t y l e = { {   c o l o r :   ' # 1 e 2 9 3 b '   } } > { c o m p . a d d r e s s C o u n t r y } < / d i v > }  
                                                         < / >  
                                                     )   :   (  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 9 4 a 3 b 8 ' ,   f o n t S t y l e :   ' i t a l i c '   } } > N o t   s e t < / s p a n >  
                                                     ) }  
                                                 < / d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 '   } } > I n d u s t r y : < / s p a n >   < s p a n   s t y l e = { {   c o l o r :   ' # 1 e 2 9 3 b '   } } >  
                                                         { c o m p . i n d u s t r y S e c t o r    
                                                             ?   ` $ { c o m p . i n d u s t r y S e c t o r }   -   $ { I N D U S T R Y _ S E C T O R S . f i n d ( s   = >   s . i d   = = =   c o m p . i n d u s t r y S e c t o r ) ? . n a m e   | |   ' U n k n o w n ' } `    
                                                             :   ' N o t   s e t ' }  
                                                     < / s p a n >  
                                                 < / d i v >  
                                             < / d i v >  
                                             < b u t t o n    
                                                 o n C l i c k = { ( )   = >   {  
                                                     s e t E d i t i n g C o m p a n y I d ( c o m p . i d ) ;  
                                                     s e t C o m p a n y A d d r e s s S t r e e t ( c o m p . a d d r e s s S t r e e t   | |   ' ' ) ;  
                                                     s e t C o m p a n y A d d r e s s C i t y ( c o m p . a d d r e s s C i t y   | |   ' ' ) ;  
                                                     s e t C o m p a n y A d d r e s s S t a t e ( c o m p . a d d r e s s S t a t e   | |   ' ' ) ;  
                                                     s e t C o m p a n y A d d r e s s Z i p ( c o m p . a d d r e s s Z i p   | |   ' ' ) ;  
                                                     s e t C o m p a n y A d d r e s s C o u n t r y ( c o m p . a d d r e s s C o u n t r y   | |   ' U S A ' ) ;  
                                                     s e t C o m p a n y I n d u s t r y S e c t o r ( c o m p . i n d u s t r y S e c t o r   | |   ' ' ) ;  
                                                     s e t S h o w C o m p a n y D e t a i l s M o d a l ( t r u e ) ;  
                                                 } }  
                                                 s t y l e = { {   p a d d i n g :   ' 6 p x   1 2 p x ' ,   b a c k g r o u n d :   ' # 6 6 7 e e a ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c u r s o r :   ' p o i n t e r ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   w h i t e S p a c e :   ' n o w r a p '   } }  
                                             >  
                                                 E d i t   D e t a i l s  
                                             < / b u t t o n >  
                                         < / d i v >  
                                     < / d i v >  
                                      
                                     { / *   U s e r s   S e c t i o n   -   S i d e   b y   S i d e   * / }  
                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   1 f r ' ,   g a p :   ' 1 6 p x ' ,   b o r d e r T o p :   ' 2 p x   s o l i d   # c b d 5 e 1 ' ,   p a d d i n g T o p :   ' 1 6 p x '   } } >  
                                          
                                         { / *   C o m p a n y   U s e r s   ( M a n a g e m e n t   T e a m )   * / }  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r :   ' 2 p x   s o l i d   # 1 0 b 9 8 1 '   } } >  
                                             < h 4   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > C o m p a n y   U s e r s < / h 4 >  
                                             < p   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > M a n a g e m e n t   t e a m   -   c a n   v i e w   a l l   c o m p a n y   p a g e s < / p >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 0 b 9 8 1 ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                                 { u s e r s . f i l t e r ( u   = >   u . c o m p a n y I d   = = =   c o m p . i d   & &   u . u s e r T y p e   = = =   ' c o m p a n y ' ) . l e n g t h }  
                                             < / d i v >  
                                              
                                             { u s e r s . f i l t e r ( u   = >   u . c o m p a n y I d   = = =   c o m p . i d   & &   u . u s e r T y p e   = = =   ' c o m p a n y ' ) . m a p ( u   = >   (  
                                                 < d i v   k e y = { u . i d }   s t y l e = { {   b a c k g r o u n d :   ' # f 0 f d f 4 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 2 p x ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # 8 6 e f a c '   } } >  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' s t a r t '   } } >  
                                                         < d i v   s t y l e = { {   f l e x :   1   } } >  
                                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 6 p x ' ,   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 8 p x ' ,   f l e x W r a p :   ' w r a p '   } } >  
                                                                 < s p a n > { u . n a m e } < / s p a n >  
                                                                 { u . t i t l e   & &   < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 5 0 0 ' ,   c o l o r :   ' # 0 5 9 6 6 9 ' ,   b a c k g r o u n d :   ' # d 1 f a e 5 ' ,   p a d d i n g :   ' 2 p x   8 p x ' ,   b o r d e r R a d i u s :   ' 4 p x '   } } > { u . t i t l e } < / s p a n > }  
                                                             < / d i v >  
                                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 1 2 p x ' ,   f l e x W r a p :   ' w r a p '   } } >  
                                                                 < d i v > < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 '   } } > E m a i l : < / s p a n >   { u . e m a i l } < / d i v >  
                                                                 { u . p h o n e   & &   < d i v > < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 '   } } > P h o n e : < / s p a n >   { u . p h o n e } < / d i v > }  
                                                             < / d i v >  
                                                         < / d i v >  
                                                         < b u t t o n   o n C l i c k = { ( )   = >   d e l e t e U s e r ( u . i d ) }   s t y l e = { {   p a d d i n g :   ' 4 p x   8 p x ' ,   b a c k g r o u n d :   ' # e f 4 4 4 4 ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   f o n t S i z e :   ' 1 0 p x ' ,   c u r s o r :   ' p o i n t e r ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } > D e l e t e < / b u t t o n >  
                                                     < / d i v >  
                                                 < / d i v >  
                                             ) ) }  
                                              
                                             < d i v   s t y l e = { {   b o r d e r T o p :   ' 1 p x   s o l i d   # d 1 f a e 5 ' ,   p a d d i n g T o p :   ' 1 2 p x ' ,   m a r g i n T o p :   ' 1 2 p x '   } } >  
                                                 < h 5   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > A d d   C o m p a n y   U s e r < / h 5 >  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   f l e x D i r e c t i o n :   ' c o l u m n ' ,   g a p :   ' 6 p x '   } } >  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   1 f r ' ,   g a p :   ' 6 p x '   } } >  
                                                         < i n p u t    
                                                             t y p e = " t e x t "    
                                                             n a m e = { ` c o m p a n y _ u s e r _ n a m e _ $ { D a t e . n o w ( ) } ` }  
                                                             p l a c e h o l d e r = " N a m e "    
                                                             v a l u e = { n e w C o m p a n y U s e r N a m e }    
                                                             o n C h a n g e = { ( e )   = >   s e t N e w C o m p a n y U s e r N a m e ( e . t a r g e t . v a l u e ) }    
                                                             a u t o C o m p l e t e = " o f f "  
                                                             s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 2 p x '   } }    
                                                         / >  
                                                         < i n p u t    
                                                             t y p e = " t e x t "    
                                                             n a m e = { ` c o m p a n y _ u s e r _ t i t l e _ $ { D a t e . n o w ( ) } ` }  
                                                             p l a c e h o l d e r = " T i t l e "    
                                                             v a l u e = { n e w C o m p a n y U s e r T i t l e }    
                                                             o n C h a n g e = { ( e )   = >   s e t N e w C o m p a n y U s e r T i t l e ( e . t a r g e t . v a l u e ) }    
                                                             a u t o C o m p l e t e = " o f f "  
                                                             s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 2 p x '   } }    
                                                         / >  
                                                     < / d i v >  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   1 f r ' ,   g a p :   ' 6 p x '   } } >  
                                                         < i n p u t    
                                                             t y p e = " t e x t "    
                                                             n a m e = { ` c o m p a n y _ u s e r _ e m a i l _ $ { D a t e . n o w ( ) } ` }  
                                                             p l a c e h o l d e r = " E m a i l "    
                                                             v a l u e = { n e w C o m p a n y U s e r E m a i l }    
                                                             o n C h a n g e = { ( e )   = >   s e t N e w C o m p a n y U s e r E m a i l ( e . t a r g e t . v a l u e ) }    
                                                             a u t o C o m p l e t e = " o f f "  
                                                             s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 2 p x '   } }    
                                                         / >  
                                                         < i n p u t    
                                                             t y p e = " t e x t "    
                                                             n a m e = { ` c o m p a n y _ u s e r _ p h o n e _ $ { D a t e . n o w ( ) } ` }  
                                                             p l a c e h o l d e r = " P h o n e   N u m b e r "    
                                                             v a l u e = { n e w C o m p a n y U s e r P h o n e }    
                                                             o n C h a n g e = { ( e )   = >   s e t N e w C o m p a n y U s e r P h o n e ( e . t a r g e t . v a l u e ) }    
                                                             a u t o C o m p l e t e = " o f f "  
                                                             s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 2 p x '   } }    
                                                         / >  
                                                     < / d i v >  
                                                     < i n p u t    
                                                         t y p e = " p a s s w o r d "    
                                                         n a m e = { ` c o m p a n y _ u s e r _ p a s s w o r d _ $ { D a t e . n o w ( ) } ` }  
                                                         p l a c e h o l d e r = " P a s s w o r d "    
                                                         v a l u e = { n e w C o m p a n y U s e r P a s s w o r d }    
                                                         o n C h a n g e = { ( e )   = >   s e t N e w C o m p a n y U s e r P a s s w o r d ( e . t a r g e t . v a l u e ) }    
                                                         a u t o C o m p l e t e = " n e w - p a s s w o r d "  
                                                         s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 2 p x '   } }    
                                                     / >  
                                                     < b u t t o n   o n C l i c k = { ( )   = >   a d d U s e r ( c o m p . i d ,   ' c o m p a n y ' ) }   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   b a c k g r o u n d :   ' # 1 0 b 9 8 1 ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } } > A d d   C o m p a n y   U s e r < / b u t t o n >  
                                                 < / d i v >  
                                             < / d i v >  
                                         < / d i v >  
                                          
                                         { / *   A s s e s s m e n t   U s e r s   * / }  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r :   ' 2 p x   s o l i d   # 8 b 5 c f 6 '   } } >  
                                             < h 4   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > A s s e s s m e n t   U s e r s < / h 4 >  
                                             < p   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > F i l l   o u t   M a n a g e m e n t   A s s e s s m e n t   ( m a x   5 ) < / p >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 8 b 5 c f 6 ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                                 { u s e r s . f i l t e r ( u   = >   u . c o m p a n y I d   = = =   c o m p . i d   & &   u . u s e r T y p e   = = =   ' a s s e s s m e n t ' ) . l e n g t h }   /   5  
                                             < / d i v >  
                                              
                                             { u s e r s . f i l t e r ( u   = >   u . c o m p a n y I d   = = =   c o m p . i d   & &   u . u s e r T y p e   = = =   ' a s s e s s m e n t ' ) . m a p ( u   = >   {  
                                                 c o n s t   h a s C o m p l e t e d   =   a s s e s s m e n t R e c o r d s . s o m e ( r   = >   r . u s e r ? . e m a i l   = = =   u . e m a i l   & &   r . c o m p a n y I d   = = =   c o m p . i d ) ;  
                                                 c o n s o l e . l o g ( `  x    C h e c k i n g   u s e r :   $ { u . e m a i l } ,   C o m p a n y :   $ { c o m p . i d } ,   A s s e s s m e n t   R e c o r d s   f o r   t h i s   u s e r : ` ,    
                                                     a s s e s s m e n t R e c o r d s . f i l t e r ( r   = >   r . u s e r ? . e m a i l   = = =   u . e m a i l ) . m a p ( r   = >   ( {   u s e r E m a i l :   r . u s e r ? . e m a i l ,   c o m p a n y I d :   r . c o m p a n y I d   } ) ) ,  
                                                     ' h a s C o m p l e t e d : ' ,   h a s C o m p l e t e d  
                                                 ) ;  
                                                 r e t u r n   (  
                                                     < d i v   k e y = { u . i d }   s t y l e = { {   b a c k g r o u n d :   ' # f a f 5 f f ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   p a d d i n g :   ' 8 p x   1 2 p x ' ,   m a r g i n B o t t o m :   ' 6 p x ' ,   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   b o r d e r :   ' 1 p x   s o l i d   # d d d 6 f e '   } } >  
                                                         < d i v   s t y l e = { {   f l e x :   1   } } >  
                                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } >  
                                                                 { u . n a m e }  
                                                                 { u . t i t l e   & &   < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 5 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n L e f t :   ' 6 p x '   } } > ( { u . t i t l e } ) < / s p a n > }  
                                                             < / d i v >  
                                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { u . e m a i l } < / d i v >  
                                                         < / d i v >  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 6 p x ' ,   a l i g n I t e m s :   ' c e n t e r '   } } >  
                                                             < d i v   s t y l e = { {    
                                                                 f o n t S i z e :   ' 1 0 p x ' ,    
                                                                 f o n t W e i g h t :   ' 6 0 0 ' ,    
                                                                 c o l o r :   h a s C o m p l e t e d   ?   ' # 0 6 5 f 4 6 '   :   ' # 9 9 1 b 1 b ' ,  
                                                                 b a c k g r o u n d :   h a s C o m p l e t e d   ?   ' # d 1 f a e 5 '   :   ' # f e e 2 e 2 ' ,  
                                                                 p a d d i n g :   ' 3 p x   8 p x ' ,    
                                                                 b o r d e r R a d i u s :   ' 4 p x '    
                                                             } } >  
                                                                 { h a s C o m p l e t e d   ?   '  S   D o n e '   :   '  a   N o t   S t a r t e d ' }  
                                                             < / d i v >  
                                                             < b u t t o n   o n C l i c k = { ( )   = >   d e l e t e U s e r ( u . i d ) }   s t y l e = { {   p a d d i n g :   ' 4 p x   8 p x ' ,   b a c k g r o u n d :   ' # e f 4 4 4 4 ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   f o n t S i z e :   ' 1 0 p x ' ,   c u r s o r :   ' p o i n t e r '   } } >  S" < / b u t t o n >  
                                                         < / d i v >  
                                                     < / d i v >  
                                                 ) ;  
                                             } ) }  
                                              
                                             { u s e r s . f i l t e r ( u   = >   u . c o m p a n y I d   = = =   c o m p . i d   & &   u . u s e r T y p e   = = =   ' a s s e s s m e n t ' ) . l e n g t h   <   5   ?   (  
                                                 < d i v   s t y l e = { {   b o r d e r T o p :   ' 1 p x   s o l i d   # e d e 9 f e ' ,   p a d d i n g T o p :   ' 1 2 p x ' ,   m a r g i n T o p :   ' 1 2 p x '   } } >  
                                                     < h 5   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > A d d   A s s e s s m e n t   U s e r < / h 5 >  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   f l e x D i r e c t i o n :   ' c o l u m n ' ,   g a p :   ' 6 p x '   } } >  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   1 f r ' ,   g a p :   ' 6 p x '   } } >  
                                                             < i n p u t    
                                                                 t y p e = " t e x t "    
                                                                 n a m e = { ` a s s e s s m e n t _ u s e r _ n a m e _ $ { D a t e . n o w ( ) } ` }  
                                                                 p l a c e h o l d e r = " N a m e "    
                                                                 v a l u e = { n e w A s s e s s m e n t U s e r N a m e }    
                                                                 o n C h a n g e = { ( e )   = >   s e t N e w A s s e s s m e n t U s e r N a m e ( e . t a r g e t . v a l u e ) }    
                                                                 a u t o C o m p l e t e = " o f f "  
                                                                 s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 2 p x '   } }    
                                                             / >  
                                                             < i n p u t    
                                                                 t y p e = " t e x t "    
                                                                 n a m e = { ` a s s e s s m e n t _ u s e r _ t i t l e _ $ { D a t e . n o w ( ) } ` }  
                                                                 p l a c e h o l d e r = " T i t l e "    
                                                                 v a l u e = { n e w A s s e s s m e n t U s e r T i t l e }    
                                                                 o n C h a n g e = { ( e )   = >   s e t N e w A s s e s s m e n t U s e r T i t l e ( e . t a r g e t . v a l u e ) }    
                                                                 a u t o C o m p l e t e = " o f f "  
                                                                 s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 2 p x '   } }    
                                                             / >  
                                                         < / d i v >  
                                                         < i n p u t    
                                                             t y p e = " t e x t "    
                                                             n a m e = { ` a s s e s s m e n t _ u s e r _ e m a i l _ $ { D a t e . n o w ( ) } ` }  
                                                             p l a c e h o l d e r = " E m a i l "    
                                                             v a l u e = { n e w A s s e s s m e n t U s e r E m a i l }    
                                                             o n C h a n g e = { ( e )   = >   s e t N e w A s s e s s m e n t U s e r E m a i l ( e . t a r g e t . v a l u e ) }    
                                                             a u t o C o m p l e t e = " o f f "  
                                                             s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 2 p x '   } }    
                                                         / >  
                                                         < i n p u t    
                                                             t y p e = " p a s s w o r d "    
                                                             n a m e = { ` a s s e s s m e n t _ u s e r _ p a s s w o r d _ $ { D a t e . n o w ( ) } ` }  
                                                             p l a c e h o l d e r = " P a s s w o r d "    
                                                             v a l u e = { n e w A s s e s s m e n t U s e r P a s s w o r d }    
                                                             o n C h a n g e = { ( e )   = >   s e t N e w A s s e s s m e n t U s e r P a s s w o r d ( e . t a r g e t . v a l u e ) }    
                                                             a u t o C o m p l e t e = " n e w - p a s s w o r d "  
                                                             s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 2 p x '   } }    
                                                         / >  
                                                         < b u t t o n   o n C l i c k = { ( )   = >   a d d U s e r ( c o m p . i d ,   ' a s s e s s m e n t ' ) }   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   b a c k g r o u n d :   ' # 8 b 5 c f 6 ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } } > A d d   A s s e s s m e n t   U s e r < / b u t t o n >  
                                                     < / d i v >  
                                                 < / d i v >  
                                             )   :   (  
                                                 < d i v   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   b a c k g r o u n d :   ' # f e f 3 c 7 ' ,   b o r d e r :   ' 1 p x   s o l i d   # f b b f 2 4 ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   f o n t S i z e :   ' 1 1 p x ' ,   c o l o r :   ' # 9 2 4 0 0 e ' ,   m a r g i n T o p :   ' 8 p x '   } } >  
                                                      a   M a x i m u m   5   a s s e s s m e n t   u s e r s   r e a c h e d  
                                                 < / d i v >  
                                             ) }  
                                         < / d i v >  
                                     < / d i v >  
                                 < / d i v >  
                             ) ) }  
                             < / >  
                             ) ;  
                         } ) ( ) }  
                     < / d i v >  
                     ) }  
                      
                     { / *   I m p o r t   F i n a n c i a l s   T a b   * / }  
                     { a d m i n D a s h b o a r d T a b   = = =   ' i m p o r t - f i n a n c i a l s '   & &   s e l e c t e d C o m p a n y I d   & &   (  
                         < >  
                             { / *   Q u i c k B o o k s   D a t a   V e r i f i c a t i o n   S e c t i o n   * / }  
                             { l o a d e d M o n t h l y D a t a   & &   l o a d e d M o n t h l y D a t a . l e n g t h   >   0   & &   q b R a w D a t a   & &   (  
                                 < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   b o r d e r :   ' 2 p x   s o l i d   # 1 0 b 9 8 1 '   } } >  
                                     < h 2   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  S   Q u i c k B o o k s   D a t a   V e r i f i c a t i o n < / h 2 >  
                                     < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                         I m p o r t e d   f r o m   Q u i c k B o o k s        { l o a d e d M o n t h l y D a t a . l e n g t h }   m o n t h s   o f   d a t a   v e r i f i e d  
                                     < / p >  
  
                                     { / *   S u m m a r y   S t a t s   * / }  
                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( a u t o - f i t ,   m i n m a x ( 2 0 0 p x ,   1 f r ) ) ' ,   g a p :   ' 1 6 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 0 f d f 4 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # 8 6 e f a c '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 0 6 5 f 4 6 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > M O N T H S   I M P O R T E D < / d i v >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 2 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 0 b 9 8 1 '   } } > { l o a d e d M o n t h l y D a t a . l e n g t h } < / d i v >  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' # e d e 9 f e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c 4 b 5 f d '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 5 b 2 1 b 6 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > D A T E   R A N G E < / d i v >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 7 c 3 a e d '   } } >  
                                                 { n e w   D a t e ( l o a d e d M o n t h l y D a t a [ 0 ] . d a t e ) . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' s h o r t ' ,   y e a r :   ' n u m e r i c '   } ) }   -   { n e w   D a t e ( l o a d e d M o n t h l y D a t a [ l o a d e d M o n t h l y D a t a . l e n g t h   -   1 ] . d a t e ) . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' s h o r t ' ,   y e a r :   ' n u m e r i c '   } ) }  
                                             < / d i v >  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' # d b e a f e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # 9 3 c 5 f d '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > T O T A L   R E V E N U E < / d i v >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 2 5 6 3 e b '   } } >  
                                                 $ { ( l o a d e d M o n t h l y D a t a . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . r e v e n u e   | |   0 ) ,   0 )   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K  
                                             < / d i v >  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f e f 3 c 7 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # f c d 3 4 d '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 9 2 4 0 0 e ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > T O T A L   A S S E T S < / d i v >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # d 9 7 7 0 6 '   } } >  
                                                 $ { ( l o a d e d M o n t h l y D a t a [ l o a d e d M o n t h l y D a t a . l e n g t h   -   1 ] . t o t a l A s s e t s   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K  
                                             < / d i v >  
                                         < / d i v >  
                                     < / d i v >  
  
                                     { / *   S a m p l e   D a t a   T a b l e s   * / }  
                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                                         < h 3   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > S a m p l e   I n c o m e   S t a t e m e n t   D a t a   ( L a s t   6   M o n t h s ) < / h 3 >  
                                         < d i v   s t y l e = { {   o v e r f l o w X :   ' a u t o '   } } >  
                                             < t a b l e   s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   f o n t S i z e :   ' 1 3 p x ' ,   b o r d e r C o l l a p s e :   ' c o l l a p s e '   } } >  
                                                 < t h e a d >  
                                                     < t r   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                         < t h   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' l e f t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > M o n t h < / t h >  
                                                         < t h   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > R e v e n u e < / t h >  
                                                         < t h   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > E x p e n s e < / t h >  
                                                         < t h   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C O G S   T o t a l < / t h >  
                                                         < t h   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > N e t   I n c o m e < / t h >  
                                                     < / t r >  
                                                 < / t h e a d >  
                                                 < t b o d y >  
                                                     { l o a d e d M o n t h l y D a t a . s l i c e ( - 6 ) . m a p ( ( m ,   i d x )   = >   (  
                                                         < t r   k e y = { i d x }   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                             < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > { n e w   D a t e ( m . d a t e ) . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' s h o r t ' ,   y e a r :   ' n u m e r i c '   } ) } < / t d >  
                                                             < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 1 0 b 9 8 1 ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } > $ { m . r e v e n u e . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / t d >  
                                                             < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # e f 4 4 4 4 ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } > $ { m . e x p e n s e . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / t d >  
                                                             < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # f 5 9 e 0 b '   } } > $ { m . c o g s T o t a l . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / t d >  
                                                             < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ( m . r e v e n u e   -   m . e x p e n s e   -   m . c o g s T o t a l )   > =   0   ?   ' # 1 0 b 9 8 1 '   :   ' # e f 4 4 4 4 ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                                 $ { ( m . r e v e n u e   -   m . e x p e n s e   -   m . c o g s T o t a l ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                             < / t d >  
                                                         < / t r >  
                                                     ) ) }  
                                                 < / t b o d y >  
                                             < / t a b l e >  
                                         < / d i v >  
                                     < / d i v >  
  
                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                                         < h 3   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > S a m p l e   B a l a n c e   S h e e t   D a t a   ( L a s t   6   M o n t h s ) < / h 3 >  
                                         < d i v   s t y l e = { {   o v e r f l o w X :   ' a u t o '   } } >  
                                             < t a b l e   s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   f o n t S i z e :   ' 1 3 p x ' ,   b o r d e r C o l l a p s e :   ' c o l l a p s e '   } } >  
                                                 < t h e a d >  
                                                     < t r   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                         < t h   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' l e f t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > M o n t h < / t h >  
                                                         < t h   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C a s h < / t h >  
                                                         < t h   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > A / R < / t h >  
                                                         < t h   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > A / P < / t h >  
                                                         < t h   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T o t a l   A s s e t s < / t h >  
                                                         < t h   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T o t a l   E q u i t y < / t h >  
                                                     < / t r >  
                                                 < / t h e a d >  
                                                 < t b o d y >  
                                                     { l o a d e d M o n t h l y D a t a . s l i c e ( - 6 ) . m a p ( ( m ,   i d x )   = >   (  
                                                         < t r   k e y = { i d x }   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                             < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > { n e w   D a t e ( m . d a t e ) . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' s h o r t ' ,   y e a r :   ' n u m e r i c '   } ) } < / t d >  
                                                             < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 1 0 b 9 8 1 ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } > $ { m . c a s h . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / t d >  
                                                             < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 3 b 8 2 f 6 '   } } > $ { m . a r . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / t d >  
                                                             < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # f 5 9 e 0 b '   } } > $ { m . a p . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / t d >  
                                                             < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 8 b 5 c f 6 ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } > $ { m . t o t a l A s s e t s . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / t d >  
                                                             < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # e c 4 8 9 9 ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } > $ { m . t o t a l E q u i t y . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / t d >  
                                                         < / t r >  
                                                     ) ) }  
                                                 < / t b o d y >  
                                             < / t a b l e >  
                                         < / d i v >  
                                     < / d i v >  
  
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 0 f d f 4 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # 8 6 e f a c '   } } >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 0 6 5 f 4 6 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  S   D a t a   Q u a l i t y   C h e c k < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 0 5 9 6 6 9 '   } } >  
                                                  A l l   { l o a d e d M o n t h l y D a t a . l e n g t h }   m o n t h s   h a v e   c o m p l e t e   d a t a < b r / >  
                                                  I n c o m e   S t a t e m e n t   f i e l d s   p o p u l a t e d :   R e v e n u e ,   E x p e n s e s ,   C O G S < b r / >  
                                                  B a l a n c e   S h e e t   f i e l d s   p o p u l a t e d :   A s s e t s ,   L i a b i l i t i e s ,   E q u i t y < b r / >  
                                                  R e a d y   f o r   A I - a s s i s t e d   m a p p i n g  
                                         < / d i v >  
                                     < / d i v >  
                                 < / d i v >  
                             ) }  
  
                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                 < h 2   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } > I m p o r t   F i n a n c i a l s < / h 2 >  
                                  
                                 < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                                     < h 3   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > U p l o a d   F i n a n c i a l   D a t a < / h 3 >  
                                     < i n p u t   t y p e = " f i l e "   a c c e p t = " . x l s x , . x l s , . c s v "   o n C h a n g e = { h a n d l e F i l e }   s t y l e = { {   m a r g i n B o t t o m :   ' 1 6 p x ' ,   p a d d i n g :   ' 1 2 p x ' ,   b o r d e r :   ' 2 p x   d a s h e d   # c b d 5 e 1 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   w i d t h :   ' 1 0 0 % ' ,   c u r s o r :   ' p o i n t e r '   } }   / >  
                                     { e r r o r   & &   < d i v   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # f e e 2 e 2 ' ,   c o l o r :   ' # 9 9 1 b 1 b ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } > { e r r o r } < / d i v > }  
                                     { f i l e   & &   < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 0 b 9 8 1 ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  S   L o a d e d :   { f i l e . n a m e } < / d i v > }  
                                 < / d i v >  
  
                             { f i l e   & &   c o l u m n s . l e n g t h   >   0   & &   (  
                                 < d i v >  
                                     < h 3   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > C o l u m n   M a p p i n g < / h 3 >  
                                     < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 2 0 p x '   } } > V e r i f y   o r   a d j u s t   t h e   c o l u m n   m a p p i n g s   b e l o w .   C o l u m n s   h a v e   b e e n   a u t o - d e t e c t e d . < / p >  
                                      
                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( a u t o - f i t ,   m i n m a x ( 2 8 0 p x ,   1 f r ) ) ' ,   g a p :   ' 2 0 p x '   } } >  
                                         < d i v >  
                                             < h 4   s t y l e = { {   f o n t S i z e :   ' 1 5 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 8 p x '   } } > R e q u i r e d   F i e l d s < / h 4 >  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' D a t e / P e r i o d ' ,   ' d a t e ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' T o t a l   R e v e n u e ' ,   ' r e v e n u e ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' T o t a l   E x p e n s e s ' ,   ' e x p e n s e ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' T o t a l   A s s e t s ' ,   ' t o t a l A s s e t s ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' T o t a l   L i a b i l i t i e s ' ,   ' t o t a l L i a b ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' T o t a l   E q u i t y ' ,   ' t o t a l E q u i t y ' ) }  
                                         < / d i v >  
                                          
                                         < d i v >  
                                             < h 4   s t y l e = { {   f o n t S i z e :   ' 1 5 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 8 p x '   } } > C o s t   o f   G o o d s   S o l d < / h 4 >  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' C O G S   P a y r o l l ' ,   ' c o g s P a y r o l l ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' C O G S   O w n e r   P a y ' ,   ' c o g s O w n e r P a y ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' C O G S   C o n t r a c t o r s ' ,   ' c o g s C o n t r a c t o r s ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' C O G S   M a t e r i a l s ' ,   ' c o g s M a t e r i a l s ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' C O G S   C o m m i s s i o n s ' ,   ' c o g s C o m m i s s i o n s ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' C O G S   O t h e r ' ,   ' c o g s O t h e r ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' C O G S   T o t a l ' ,   ' c o g s T o t a l ' ) }  
                                         < / d i v >  
                                          
                                         < d i v >  
                                             < h 4   s t y l e = { {   f o n t S i z e :   ' 1 5 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 8 p x '   } } > O p e r a t i n g   E x p e n s e s < / h 4 >  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' S a l e s   &   M a r k e t i n g ' ,   ' o p e x S a l e s M a r k e t i n g ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' R e n t / L e a s e ' ,   ' r e n t L e a s e ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' U t i l i t i e s ' ,   ' u t i l i t i e s ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' E q u i p m e n t ' ,   ' e q u i p m e n t ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' T r a v e l ' ,   ' t r a v e l ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' P r o f e s s i o n a l   S e r v i c e s ' ,   ' p r o f e s s i o n a l S e r v i c e s ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' I n s u r a n c e ' ,   ' i n s u r a n c e ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' O P E X   O t h e r ' ,   ' o p e x O t h e r ' ) }  
                                         < / d i v >  
                                          
                                         < d i v >  
                                             < h 4   s t y l e = { {   f o n t S i z e :   ' 1 5 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 8 p x '   } } > P a y r o l l   &   O w n e r s < / h 4 >  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' O P E X   P a y r o l l ' ,   ' o p e x P a y r o l l ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' O w n e r s   B a s e   P a y ' ,   ' o w n e r s B a s e P a y ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' O w n e r s   R e t i r e m e n t ' ,   ' o w n e r s R e t i r e m e n t ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' C o n t r a c t o r s / D i s t r i b u t i o n ' ,   ' c o n t r a c t o r s D i s t r i b u t i o n ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' I n t e r e s t   E x p e n s e ' ,   ' i n t e r e s t E x p e n s e ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' D e p r e c i a t i o n   E x p e n s e ' ,   ' d e p r e c i a t i o n E x p e n s e ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' O p e r a t i n g   E x p e n s e   T o t a l ' ,   ' o p e r a t i n g E x p e n s e T o t a l ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' N o n - O p e r a t i n g   I n c o m e ' ,   ' n o n O p e r a t i n g I n c o m e ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' E x t r a o r d i n a r y   I t e m s ' ,   ' e x t r a o r d i n a r y I t e m s ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' N e t   P r o f i t ' ,   ' n e t P r o f i t ' ) }  
                                         < / d i v >  
                                          
                                         < d i v >  
                                             < h 4   s t y l e = { {   f o n t S i z e :   ' 1 5 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 8 p x '   } } > A s s e t s < / h 4 >  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' C a s h ' ,   ' c a s h ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' A c c o u n t s   R e c e i v a b l e ' ,   ' a r ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' I n v e n t o r y ' ,   ' i n v e n t o r y ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' O t h e r   C u r r e n t   A s s e t s ' ,   ' o t h e r C A ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' T o t a l   C u r r e n t   A s s e t s ' ,   ' t c a ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' F i x e d   A s s e t s ' ,   ' f i x e d A s s e t s ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' O t h e r   A s s e t s ' ,   ' o t h e r A s s e t s ' ) }  
                                         < / d i v >  
                                          
                                         < d i v >  
                                             < h 4   s t y l e = { {   f o n t S i z e :   ' 1 5 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 8 p x '   } } > L i a b i l i t i e s   &   O t h e r < / h 4 >  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' A c c o u n t s   P a y a b l e ' ,   ' a p ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' O t h e r   C u r r e n t   L i a b i l i t i e s ' ,   ' o t h e r C L ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' T o t a l   C u r r e n t   L i a b i l i t i e s ' ,   ' t c l ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' L o n g   T e r m   D e b t ' ,   ' l t d ' ) }  
                                             { r e n d e r C o l u m n S e l e c t o r ( ' T o t a l   L i a b i l i t i e s   &   E q u i t y ' ,   ' t o t a l L A n d E ' ) }  
                                         < / d i v >  
                                     < / d i v >  
                                      
                                     < d i v   s t y l e = { {   m a r g i n T o p :   ' 2 0 p x ' ,   p a d d i n g :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # f 0 f 9 f f ' ,   b o r d e r :   ' 1 p x   s o l i d   # b a e 6 f d ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                         < p   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 0 c 4 a 6 e ' ,   m a r g i n :   0   } } >  
                                             < s t r o n g > T i p : < / s t r o n g >   A t   m i n i m u m ,   m a p   D a t e ,   T o t a l   R e v e n u e ,   T o t a l   E x p e n s e s ,   T o t a l   A s s e t s ,   a n d   T o t a l   L i a b i l i t i e s   f o r   b a s i c   a n a l y s i s .    
                                             M a p   d e t a i l e d   P & L   a n d   b a l a n c e   s h e e t   i t e m s   f o r   c o m p r e h e n s i v e   a n a l y s i s   a n d   r e p o r t i n g .  
                                         < / p >  
                                     < / d i v >  
                                 < / d i v >  
                             ) }  
                         < / d i v >  
                         < / >  
                     ) }  
                      
                     { ! s e l e c t e d C o m p a n y I d   & &   a d m i n D a s h b o a r d T a b   = = =   ' i m p o r t - f i n a n c i a l s '   & &   (  
                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 4 8 p x   2 4 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   t e x t A l i g n :   ' c e n t e r '   } } >  
                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > N o   C o m p a n y   S e l e c t e d < / d i v >  
                             < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 9 4 a 3 b 8 '   } } > P l e a s e   s e l e c t   a   c o m p a n y   f r o m   t h e   s i d e b a r   t o   i m p o r t   f i n a n c i a l s . < / p >  
                         < / d i v >  
                     ) }  
  
                     { / *   A c c o u n t i n g   A P I   C o n n e c t i o n s   T a b   * / }  
                     { a d m i n D a s h b o a r d T a b   = = =   ' a p i - c o n n e c t i o n s '   & &   s e l e c t e d C o m p a n y I d   & &   (  
                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                             < h 2   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } > A c c o u n t i n g   A P I   C o n n e c t i o n s < / h 2 >  
                             < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                 C o n n e c t   t o   a c c o u n t i n g   p l a t f o r m s   t o   a u t o m a t i c a l l y   i m p o r t   f i n a n c i a l   d a t a   f o r   { c o m p a n y N a m e   | |   ' y o u r   c o m p a n y ' } .  
                             < / p >  
  
                             { / *   Q u i c k B o o k s   C o n n e c t i o n   * / }  
                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   m a r g i n B o t t o m :   ' 2 0 p x ' ,   b o r d e r :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 1 6 p x ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                     < d i v   s t y l e = { {   w i d t h :   ' 6 0 p x ' ,   h e i g h t :   ' 6 0 p x ' ,   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   j u s t i f y C o n t e n t :   ' c e n t e r ' ,   b o r d e r :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 2 c a 0 1 c '   } } > Q B < / d i v >  
                                     < / d i v >  
                                     < d i v >  
                                         < h 3   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > Q u i c k B o o k s   O n l i n e < / h 3 >  
                                         < p   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n :   0   } } > I n t u i t   Q u i c k B o o k s   O n l i n e < / p >  
                                     < / d i v >  
                                 < / d i v >  
                                  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 1 2 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                     < d i v   s t y l e = { {    
                                         f l e x :   1 ,    
                                         p a d d i n g :   ' 1 2 p x ' ,    
                                         b a c k g r o u n d :   q b C o n n e c t e d   & &   q b S t a t u s   = = =   ' A C T I V E '   ?   ' # d 1 f a e 5 '   :   q b S t a t u s   = = =   ' E R R O R '   ?   ' # f e e 2 e 2 '   :   q b S t a t u s   = = =   ' E X P I R E D '   ?   ' # f e d 7 a a '   :   ' # f e f 3 c 7 ' ,    
                                         b o r d e r R a d i u s :   ' 8 p x ' ,    
                                         b o r d e r :   ` 1 p x   s o l i d   $ { q b C o n n e c t e d   & &   q b S t a t u s   = = =   ' A C T I V E '   ?   ' # 1 0 b 9 8 1 '   :   q b S t a t u s   = = =   ' E R R O R '   ?   ' # e f 4 4 4 4 '   :   q b S t a t u s   = = =   ' E X P I R E D '   ?   ' # f 9 7 3 1 6 '   :   ' # f b b f 2 4 ' } `    
                                     } } >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   q b C o n n e c t e d   & &   q b S t a t u s   = = =   ' A C T I V E '   ?   ' # 0 6 5 f 4 6 '   :   q b S t a t u s   = = =   ' E R R O R '   ?   ' # 9 9 1 b 1 b '   :   q b S t a t u s   = = =   ' E X P I R E D '   ?   ' # 9 a 3 4 1 2 '   :   ' # 9 2 4 0 0 e ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                             { q b C o n n e c t e d   & &   q b S t a t u s   = = =   ' A C T I V E '   ?   '  S   C o n n e c t e d '   :   q b S t a t u s   = = =   ' E R R O R '   ?   '  S   E r r o r '   :   q b S t a t u s   = = =   ' E X P I R E D '   ?   '  a   T o k e n   E x p i r e d '   :   '  a   S t a t u s :   N o t   C o n n e c t e d ' }  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   q b C o n n e c t e d   & &   q b S t a t u s   = = =   ' A C T I V E '   ?   ' # 0 6 5 f 4 6 '   :   q b S t a t u s   = = =   ' E R R O R '   ?   ' # 9 9 1 b 1 b '   :   q b S t a t u s   = = =   ' E X P I R E D '   ?   ' # 9 a 3 4 1 2 '   :   ' # 9 2 4 0 0 e '   } } >  
                                             { q b E r r o r   | |   ( q b C o n n e c t e d   & &   q b S t a t u s   = = =   ' A C T I V E '   ?   ( q b L a s t S y n c   ?   ` L a s t   s y n c e d :   $ { q b L a s t S y n c . t o L o c a l e S t r i n g ( ) } `   :   ' R e a d y   t o   s y n c ' )   :   q b S t a t u s   = = =   ' E X P I R E D '   ?   ' P l e a s e   r e c o n n e c t '   :   ' S a n d b o x   e n v i r o n m e n t   r e a d y   f o r   t e s t i n g ' ) }  
                                         < / d i v >  
                                     < / d i v >  
                                 < / d i v >  
  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 1 2 p x '   } } >  
                                     { ! q b C o n n e c t e d   | |   q b S t a t u s   = = =   ' E X P I R E D '   | |   q b S t a t u s   = = =   ' E R R O R '   ?   (  
                                         < b u t t o n  
                                             o n C l i c k = { c o n n e c t Q u i c k B o o k s }  
                                             s t y l e = { {  
                                                 p a d d i n g :   ' 1 2 p x   2 4 p x ' ,  
                                                 b a c k g r o u n d :   ' # 2 c a 0 1 c ' ,  
                                                 c o l o r :   ' w h i t e ' ,  
                                                 b o r d e r :   ' n o n e ' ,  
                                                 b o r d e r R a d i u s :   ' 8 p x ' ,  
                                                 f o n t S i z e :   ' 1 4 p x ' ,  
                                                 f o n t W e i g h t :   ' 6 0 0 ' ,  
                                                 c u r s o r :   ' p o i n t e r ' ,  
                                                 t r a n s i t i o n :   ' b a c k g r o u n d   0 . 2 s '  
                                             } }  
                                             o n M o u s e E n t e r = { ( e )   = >   e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # 2 3 9 0 1 7 ' }  
                                             o n M o u s e L e a v e = { ( e )   = >   e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # 2 c a 0 1 c ' }  
                                         >  
                                             { q b C o n n e c t e d   ?   ' R e c o n n e c t '   :   ' C o n n e c t ' }   t o   Q u i c k B o o k s   ( S a n d b o x )  
                                         < / b u t t o n >  
                                     )   :   (  
                                         < >  
                                             < b u t t o n  
                                                 o n C l i c k = { s y n c Q u i c k B o o k s }  
                                                 d i s a b l e d = { q b S y n c i n g }  
                                                 s t y l e = { {  
                                                     p a d d i n g :   ' 1 2 p x   2 4 p x ' ,  
                                                     b a c k g r o u n d :   q b S y n c i n g   ?   ' # 9 4 a 3 b 8 '   :   ' # 6 6 7 e e a ' ,  
                                                     c o l o r :   ' w h i t e ' ,  
                                                     b o r d e r :   ' n o n e ' ,  
                                                     b o r d e r R a d i u s :   ' 8 p x ' ,  
                                                     f o n t S i z e :   ' 1 4 p x ' ,  
                                                     f o n t W e i g h t :   ' 6 0 0 ' ,  
                                                     c u r s o r :   q b S y n c i n g   ?   ' n o t - a l l o w e d '   :   ' p o i n t e r ' ,  
                                                     t r a n s i t i o n :   ' b a c k g r o u n d   0 . 2 s ' ,  
                                                     o p a c i t y :   q b S y n c i n g   ?   0 . 7   :   1  
                                                 } }  
                                                 o n M o u s e E n t e r = { ( e )   = >   ! q b S y n c i n g   & &   ( e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # 5 5 6 8 d 3 ' ) }  
                                                 o n M o u s e L e a v e = { ( e )   = >   ! q b S y n c i n g   & &   ( e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # 6 6 7 e e a ' ) }  
                                             >  
                                                 { q b S y n c i n g   ?   ' S y n c i n g . . . '   :   ' S y n c   D a t a ' }  
                                             < / b u t t o n >  
                                             < b u t t o n  
                                                 o n C l i c k = { d i s c o n n e c t Q u i c k B o o k s }  
                                                 d i s a b l e d = { q b S y n c i n g }  
                                                 s t y l e = { {  
                                                     p a d d i n g :   ' 1 2 p x   2 4 p x ' ,  
                                                     b a c k g r o u n d :   ' w h i t e ' ,  
                                                     c o l o r :   ' # e f 4 4 4 4 ' ,  
                                                     b o r d e r :   ' 2 p x   s o l i d   # e f 4 4 4 4 ' ,  
                                                     b o r d e r R a d i u s :   ' 8 p x ' ,  
                                                     f o n t S i z e :   ' 1 4 p x ' ,  
                                                     f o n t W e i g h t :   ' 6 0 0 ' ,  
                                                     c u r s o r :   q b S y n c i n g   ?   ' n o t - a l l o w e d '   :   ' p o i n t e r ' ,  
                                                     t r a n s i t i o n :   ' a l l   0 . 2 s ' ,  
                                                     o p a c i t y :   q b S y n c i n g   ?   0 . 7   :   1  
                                                 } }  
                                                 o n M o u s e E n t e r = { ( e )   = >   ! q b S y n c i n g   & &   ( e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # f e f 2 f 2 ' ) }  
                                                 o n M o u s e L e a v e = { ( e )   = >   ! q b S y n c i n g   & &   ( e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' w h i t e ' ) }  
                                             >  
                                                 D i s c o n n e c t  
                                             < / b u t t o n >  
                                         < / >  
                                     ) }  
                                 < / d i v >  
                             < / d i v >  
  
                             { / *   Q u i c k B o o k s   D a t a   V e r i f i c a t i o n   * / }  
                             { l o a d e d M o n t h l y D a t a   & &   l o a d e d M o n t h l y D a t a . l e n g t h   >   0   & &   q b R a w D a t a   & &   (  
                                 < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   b o r d e r :   ' 2 p x   s o l i d   # 1 0 b 9 8 1 '   } } >  
                                     < h 3   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  S   Q u i c k B o o k s   D a t a   V e r i f i c a t i o n < / h 3 >  
                                     < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                         S y n c e d   s u c c e s s f u l l y        { l o a d e d M o n t h l y D a t a . l e n g t h }   m o n t h s   o f   d a t a   i m p o r t e d  
                                     < / p >  
  
                                     { / *   S u m m a r y   S t a t s   * / }  
                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( a u t o - f i t ,   m i n m a x ( 2 0 0 p x ,   1 f r ) ) ' ,   g a p :   ' 1 6 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 0 f d f 4 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # 8 6 e f a c '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 0 6 5 f 4 6 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > M O N T H S   I M P O R T E D < / d i v >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 2 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 0 b 9 8 1 '   } } > { l o a d e d M o n t h l y D a t a . l e n g t h } < / d i v >  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' # e d e 9 f e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c 4 b 5 f d '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 5 b 2 1 b 6 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > D A T E   R A N G E < / d i v >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 7 c 3 a e d '   } } >  
                                                 { n e w   D a t e ( l o a d e d M o n t h l y D a t a [ 0 ] . d a t e ) . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' s h o r t ' ,   y e a r :   ' n u m e r i c '   } ) }   -   { n e w   D a t e ( l o a d e d M o n t h l y D a t a [ l o a d e d M o n t h l y D a t a . l e n g t h   -   1 ] . d a t e ) . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' s h o r t ' ,   y e a r :   ' n u m e r i c '   } ) }  
                                             < / d i v >  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' # d b e a f e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # 9 3 c 5 f d '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > T O T A L   R E V E N U E < / d i v >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 2 5 6 3 e b '   } } >  
                                                 $ { ( l o a d e d M o n t h l y D a t a . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . r e v e n u e   | |   0 ) ,   0 )   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K  
                                             < / d i v >  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f e f 3 c 7 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # f c d 3 4 d '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 9 2 4 0 0 e ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > T O T A L   A S S E T S < / d i v >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # d 9 7 7 0 6 '   } } >  
                                                 $ { ( l o a d e d M o n t h l y D a t a [ l o a d e d M o n t h l y D a t a . l e n g t h   -   1 ] . t o t a l A s s e t s   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K  
                                             < / d i v >  
                                         < / d i v >  
                                     < / d i v >  
  
                                     { / *   S a m p l e   D a t a   T a b l e s   -   S h o w   I n d i v i d u a l   A c c o u n t s   * / }  
                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                                         < h 4   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > S a m p l e   I n c o m e   &   E x p e n s e   A c c o u n t s   ( L a s t   3   M o n t h s ) < / h 4 >  
                                         < d i v   s t y l e = { {   o v e r f l o w X :   ' a u t o '   } } >  
                                             < t a b l e   s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   f o n t S i z e :   ' 1 2 p x ' ,   b o r d e r C o l l a p s e :   ' c o l l a p s e '   } } >  
                                                 < t h e a d >  
                                                     < t r   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                         < t h   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' l e f t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > A c c o u n t < / t h >  
                                                         { l o a d e d M o n t h l y D a t a . s l i c e ( - 3 ) . m a p ( ( m ,   i d x )   = >   (  
                                                             < t h   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } >  
                                                                 { n e w   D a t e ( m . d a t e ) . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' s h o r t ' ,   y e a r :   ' n u m e r i c '   } ) }  
                                                             < / t h >  
                                                         ) ) }  
                                                     < / t r >  
                                                 < / t h e a d >  
                                                 < t b o d y >  
                                                     { ( ( )   = >   {  
                                                         / /   E x t r a c t   i n d i v i d u a l   a c c o u n t s   f r o m   q b R a w D a t a  
                                                         c o n s t   e x t r a c t R o w s   =   ( d a t a :   a n y ,   t y p e :   ' d a t a '   |   ' t o t a l '   =   ' d a t a ' ) :   a n y [ ]   = >   {  
                                                             c o n s t   r e s u l t :   a n y [ ]   =   [ ] ;  
                                                             i f   ( ! d a t a   | |   ! d a t a . R o w s   | |   ! d a t a . R o w s . R o w )   r e t u r n   r e s u l t ;  
                                                             c o n s t   r o w s   =   A r r a y . i s A r r a y ( d a t a . R o w s . R o w )   ?   d a t a . R o w s . R o w   :   [ d a t a . R o w s . R o w ] ;  
                                                              
                                                             c o n s t   p r o c e s s R o w s   =   ( r o w s :   a n y [ ] ,   p a r e n t S e c t i o n :   s t r i n g   =   ' ' ) :   v o i d   = >   {  
                                                                 f o r   ( c o n s t   r o w   o f   r o w s )   {  
                                                                     i f   ( r o w . t y p e   = = =   ' S e c t i o n ' )   {  
                                                                         c o n s t   s e c t i o n N a m e   =   r o w . H e a d e r ? . C o l D a t a ? . [ 0 ] ? . v a l u e   | |   ' ' ;  
                                                                         i f   ( r o w . R o w s   & &   r o w . R o w s . R o w )   {  
                                                                             c o n s t   n e s t e d   =   A r r a y . i s A r r a y ( r o w . R o w s . R o w )   ?   r o w . R o w s . R o w   :   [ r o w . R o w s . R o w ] ;  
                                                                             p r o c e s s R o w s ( n e s t e d ,   s e c t i o n N a m e ) ;  
                                                                         }  
                                                                         i f   ( t y p e   = = =   ' t o t a l '   & &   r o w . S u m m a r y ? . C o l D a t a )   {  
                                                                             c o n s t   n a m e   =   r o w . S u m m a r y . C o l D a t a [ 0 ] ? . v a l u e   | |   ' ' ;  
                                                                             i f   ( n a m e )   {  
                                                                                 r e s u l t . p u s h ( {   n a m e ,   s e c t i o n :   p a r e n t S e c t i o n ,   c o l D a t a :   r o w . S u m m a r y . C o l D a t a   } ) ;  
                                                                             }  
                                                                         }  
                                                                     }   e l s e   i f   ( r o w . t y p e   = = =   ' D a t a '   & &   r o w . C o l D a t a   & &   t y p e   = = =   ' d a t a ' )   {  
                                                                         c o n s t   n a m e   =   r o w . C o l D a t a [ 0 ] ? . v a l u e   | |   ' ' ;  
                                                                         i f   ( n a m e   & &   ! n a m e . t o L o w e r C a s e ( ) . i n c l u d e s ( ' t o t a l ' ) )   {  
                                                                             r e s u l t . p u s h ( {   n a m e ,   s e c t i o n :   p a r e n t S e c t i o n ,   c o l D a t a :   r o w . C o l D a t a   } ) ;  
                                                                         }  
                                                                     }  
                                                                 }  
                                                             } ;  
                                                              
                                                             p r o c e s s R o w s ( r o w s ) ;  
                                                             r e t u r n   r e s u l t ;  
                                                         } ;  
  
                                                         / /   G e t   i n c o m e   a n d   e x p e n s e   a c c o u n t s  
                                                         c o n s t   a l l A c c o u n t s   =   e x t r a c t R o w s ( q b R a w D a t a ? . p r o f i t A n d L o s s ) ;  
                                                         c o n s t   i n c o m e A c c o u n t s   =   a l l A c c o u n t s . f i l t e r ( a   = >    
                                                             ( a . s e c t i o n   | |   ' ' ) . t o L o w e r C a s e ( ) . i n c l u d e s ( ' i n c o m e ' )   | |    
                                                             ( a . s e c t i o n   | |   ' ' ) . t o L o w e r C a s e ( ) . i n c l u d e s ( ' r e v e n u e ' )   | |  
                                                             ( a . s e c t i o n   | |   ' ' ) . t o L o w e r C a s e ( ) . i n c l u d e s ( ' s e r v i c e ' )  
                                                         ) . s l i c e ( 0 ,   5 ) ;  
                                                         c o n s t   e x p e n s e A c c o u n t s   =   a l l A c c o u n t s . f i l t e r ( a   = >    
                                                             ( a . s e c t i o n   | |   ' ' ) . t o L o w e r C a s e ( ) . i n c l u d e s ( ' e x p e n s e ' )   | |    
                                                             ( a . s e c t i o n   | |   ' ' ) . t o L o w e r C a s e ( ) . i n c l u d e s ( ' c o s t ' )  
                                                         ) . s l i c e ( 0 ,   5 ) ;  
  
                                                         c o n s t   d i s p l a y A c c o u n t s   =   [ . . . i n c o m e A c c o u n t s ,   . . . e x p e n s e A c c o u n t s ] . s l i c e ( 0 ,   1 0 ) ;  
                                                          
                                                         r e t u r n   d i s p l a y A c c o u n t s . m a p ( ( a c c o u n t ,   i d x )   = >   {  
                                                             / /   G e t   v a l u e s   f o r   l a s t   3   m o n t h s  
                                                             c o n s t   c o l u m n C o u n t   =   q b R a w D a t a . p r o f i t A n d L o s s ? . C o l u m n s ? . C o l u m n ? . l e n g t h   | |   0 ;  
                                                             c o n s t   l a s t T h r e e M o n t h s   =   A r r a y . f r o m ( { l e n g t h :   3 } ,   ( _ ,   i )   = >   {  
                                                                 c o n s t   c o l I n d e x   =   c o l u m n C o u n t   -   4   -   ( 2   -   i ) ;   / /   S k i p   t h e   " T o t a l "   c o l u m n  
                                                                 c o n s t   v a l u e   =   a c c o u n t . c o l D a t a [ c o l I n d e x ] ? . v a l u e ;  
                                                                 r e t u r n   p a r s e F l o a t ( v a l u e   | |   ' 0 ' ) ;  
                                                             } ) ;  
  
                                                             c o n s t   i s I n c o m e   =   i n c o m e A c c o u n t s . i n c l u d e s ( a c c o u n t ) ;  
                                                              
                                                             r e t u r n   (  
                                                                 < t r   k e y = { i d x }   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                                     < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } >  
                                                                         < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 0 p x ' ,   c o l o r :   ' # 9 4 a 3 b 8 ' ,   m a r g i n R i g h t :   ' 8 p x '   } } >  
                                                                             { i s I n c o m e   ?   '  x '   :   '  x 0 ' }  
                                                                         < / s p a n >  
                                                                         { a c c o u n t . n a m e }  
                                                                     < / t d >  
                                                                     { l a s t T h r e e M o n t h s . m a p ( ( v a l ,   m i d x )   = >   (  
                                                                         < t d   k e y = { m i d x }   s t y l e = { {    
                                                                             p a d d i n g :   ' 8 p x ' ,    
                                                                             t e x t A l i g n :   ' r i g h t ' ,    
                                                                             c o l o r :   i s I n c o m e   ?   ' # 1 0 b 9 8 1 '   :   ' # e f 4 4 4 4 ' ,    
                                                                             f o n t W e i g h t :   v a l   ! = =   0   ?   ' 6 0 0 '   :   ' 4 0 0 '    
                                                                         } } >  
                                                                             $ { v a l . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                                         < / t d >  
                                                                     ) ) }  
                                                                 < / t r >  
                                                             ) ;  
                                                         } ) ;  
                                                     } ) ( ) }  
                                                 < / t b o d y >  
                                             < / t a b l e >  
                                         < / d i v >  
                                     < / d i v >  
  
                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                                         < h 4   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > S a m p l e   B a l a n c e   S h e e t   D a t a   ( L a s t   6   M o n t h s ) < / h 4 >  
                                         < d i v   s t y l e = { {   o v e r f l o w X :   ' a u t o '   } } >  
                                             < t a b l e   s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   f o n t S i z e :   ' 1 3 p x ' ,   b o r d e r C o l l a p s e :   ' c o l l a p s e '   } } >  
                                                 < t h e a d >  
                                                     < t r   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                         < t h   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' l e f t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > M o n t h < / t h >  
                                                         < t h   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C a s h < / t h >  
                                                         < t h   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > A / R < / t h >  
                                                         < t h   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > A / P < / t h >  
                                                         < t h   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T o t a l   A s s e t s < / t h >  
                                                         < t h   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T o t a l   E q u i t y < / t h >  
                                                     < / t r >  
                                                 < / t h e a d >  
                                                 < t b o d y >  
                                                     { l o a d e d M o n t h l y D a t a . s l i c e ( - 6 ) . m a p ( ( m ,   i d x )   = >   (  
                                                         < t r   k e y = { i d x }   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                             < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > { n e w   D a t e ( m . d a t e ) . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' s h o r t ' ,   y e a r :   ' n u m e r i c '   } ) } < / t d >  
                                                             < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 1 0 b 9 8 1 ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } > $ { m . c a s h . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / t d >  
                                                             < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 3 b 8 2 f 6 '   } } > $ { m . a r . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / t d >  
                                                             < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # f 5 9 e 0 b '   } } > $ { m . a p . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / t d >  
                                                             < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 8 b 5 c f 6 ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } > $ { m . t o t a l A s s e t s . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / t d >  
                                                             < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # e c 4 8 9 9 ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } > $ { m . t o t a l E q u i t y . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / t d >  
                                                         < / t r >  
                                                     ) ) }  
                                                 < / t b o d y >  
                                             < / t a b l e >  
                                         < / d i v >  
                                     < / d i v >  
  
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 0 f d f 4 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # 8 6 e f a c ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 0 6 5 f 4 6 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  S   D a t a   Q u a l i t y   C h e c k < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 0 5 9 6 6 9 '   } } >  
                                                  A l l   { l o a d e d M o n t h l y D a t a . l e n g t h }   m o n t h s   h a v e   c o m p l e t e   d a t a < b r / >  
                                                  I n c o m e   S t a t e m e n t :   R e v e n u e ,   E x p e n s e s ,   C O G S   p o p u l a t e d < b r / >  
                                                  B a l a n c e   S h e e t :   A s s e t s ,   L i a b i l i t i e s ,   E q u i t y   p o p u l a t e d < b r / >  
                                                  R e a d y   f o r   A I - a s s i s t e d   a c c o u n t   m a p p i n g  
                                         < / d i v >  
                                     < / d i v >  
  
                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 1 2 p x '   } } >  
                                         < b u t t o n  
                                             o n C l i c k = { ( )   = >   {  
                                                 / /   N a v i g a t e   t o   D a t a   M a p p i n g   t a b  
                                                 s e t A d m i n D a s h b o a r d T a b ( ' d a t a - m a p p i n g ' ) ;  
                                             } }  
                                             s t y l e = { {  
                                                 p a d d i n g :   ' 1 2 p x   2 4 p x ' ,  
                                                 b a c k g r o u n d :   ' # 6 6 7 e e a ' ,  
                                                 c o l o r :   ' w h i t e ' ,  
                                                 b o r d e r :   ' n o n e ' ,  
                                                 b o r d e r R a d i u s :   ' 8 p x ' ,  
                                                 f o n t S i z e :   ' 1 4 p x ' ,  
                                                 f o n t W e i g h t :   ' 6 0 0 ' ,  
                                                 c u r s o r :   ' p o i n t e r ' ,  
                                                 t r a n s i t i o n :   ' b a c k g r o u n d   0 . 2 s ' ,  
                                                 d i s p l a y :   ' f l e x ' ,  
                                                 a l i g n I t e m s :   ' c e n t e r ' ,  
                                                 g a p :   ' 8 p x '  
                                             } }  
                                             o n M o u s e E n t e r = { ( e )   = >   e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # 5 5 6 8 d 3 ' }  
                                             o n M o u s e L e a v e = { ( e )   = >   e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # 6 6 7 e e a ' }  
                                         >  
                                             < s p a n >  x  < / s p a n >  
                                             < s p a n > P r o c e e d   t o   A I   A c c o u n t   M a p p i n g       < / s p a n >  
                                         < / b u t t o n >  
                                     < / d i v >  
                                 < / d i v >  
                             ) }  
  
  
                             { / *   S a g e   C o n n e c t i o n   * / }  
                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   m a r g i n B o t t o m :   ' 2 0 p x ' ,   b o r d e r :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   o p a c i t y :   0 . 6   } } >  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 1 6 p x ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                     < d i v   s t y l e = { {   w i d t h :   ' 6 0 p x ' ,   h e i g h t :   ' 6 0 p x ' ,   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   j u s t i f y C o n t e n t :   ' c e n t e r ' ,   b o r d e r :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 0 0 a 8 5 1 '   } } > S < / d i v >  
                                     < / d i v >  
                                     < d i v >  
                                         < h 3   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > S a g e < / h 3 >  
                                         < p   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n :   0   } } > S a g e   B u s i n e s s   C l o u d   A c c o u n t i n g < / p >  
                                     < / d i v >  
                                 < / d i v >  
                                 < d i v   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # e 2 e 8 f 0 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                     C o m i n g   S o o n  
                                 < / d i v >  
                             < / d i v >  
  
                             { / *   N e t S u i t e   C o n n e c t i o n   * / }  
                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   m a r g i n B o t t o m :   ' 2 0 p x ' ,   b o r d e r :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   o p a c i t y :   0 . 6   } } >  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 1 6 p x ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                     < d i v   s t y l e = { {   w i d t h :   ' 6 0 p x ' ,   h e i g h t :   ' 6 0 p x ' ,   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   j u s t i f y C o n t e n t :   ' c e n t e r ' ,   b o r d e r :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # E 9 1 C 2 4 '   } } > N S < / d i v >  
                                     < / d i v >  
                                     < d i v >  
                                         < h 3   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > N e t S u i t e < / h 3 >  
                                         < p   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n :   0   } } > O r a c l e   N e t S u i t e   E R P < / p >  
                                     < / d i v >  
                                 < / d i v >  
                                 < d i v   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # e 2 e 8 f 0 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                     C o m i n g   S o o n  
                                 < / d i v >  
                             < / d i v >  
  
                             { / *   D y n a m i c s   C o n n e c t i o n   * / }  
                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   b o r d e r :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   o p a c i t y :   0 . 6   } } >  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 1 6 p x ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                     < d i v   s t y l e = { {   w i d t h :   ' 6 0 p x ' ,   h e i g h t :   ' 6 0 p x ' ,   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   j u s t i f y C o n t e n t :   ' c e n t e r ' ,   b o r d e r :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 0 0 7 8 D 4 '   } } > D < / d i v >  
                                     < / d i v >  
                                     < d i v >  
                                         < h 3   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > M i c r o s o f t   D y n a m i c s   3 6 5 < / h 3 >  
                                         < p   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n :   0   } } > M i c r o s o f t   D y n a m i c s   3 6 5   F i n a n c e < / p >  
                                     < / d i v >  
                                 < / d i v >  
                                 < d i v   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # e 2 e 8 f 0 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                     C o m i n g   S o o n  
                                 < / d i v >  
                             < / d i v >  
  
                             < d i v   s t y l e = { {   m a r g i n T o p :   ' 2 4 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' # f 0 f 9 f f ' ,   b o r d e r :   ' 1 p x   s o l i d   # b a e 6 f d ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                 < p   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 0 c 4 a 6 e ' ,   m a r g i n :   0 ,   l i n e H e i g h t :   ' 1 . 6 '   } } >  
                                     < s t r o n g > N o t e : < / s t r o n g >   A P I   c o n n e c t i o n s   a l l o w   a u t o m a t i c   s y n c h r o n i z a t i o n   o f   f i n a n c i a l   d a t a .   O n c e   c o n n e c t e d ,    
                                     y o u   c a n   s c h e d u l e   a u t o m a t i c   i m p o r t s   o r   m a n u a l l y   t r i g g e r   d a t a   p u l l s .   A l l   c o n n e c t i o n s   u s e   O A u t h   2 . 0   f o r    
                                     s e c u r e   a u t h e n t i c a t i o n   a n d   a r e   e n c r y p t e d   i n   t r a n s i t   a n d   a t   r e s t .  
                                 < / p >  
                             < / d i v >  
                         < / d i v >  
                     ) }  
  
                     { / *   B i l l i n g   S u b - T a b   C o n t e n t   * / }  
                     { c o m p a n y M a n a g e m e n t S u b T a b   = = =   ' b i l l i n g '   & &   (  
                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                             < h 2   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } > B i l l i n g   &   S u b s c r i p t i o n < / h 2 >  
  
                             { / *   C u r r e n t   S u b s c r i p t i o n   S t a t u s   * / }  
                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 4 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' # f 0 f 9 f f ' ,   b o r d e r :   ' 1 p x   s o l i d   # b a e 6 f d ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                     < h 3   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 0 c 4 a 6 e ' ,   m a r g i n :   0   } } > C u r r e n t   S u b s c r i p t i o n < / h 3 >  
                                     < s p a n   s t y l e = { {   p a d d i n g :   ' 4 p x   1 2 p x ' ,   b a c k g r o u n d :   ' # 1 0 b 9 8 1 ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 2 0 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                         A C T I V E  
                                     < / s p a n >  
                                 < / d i v >  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( a u t o - f i t ,   m i n m a x ( 2 0 0 p x ,   1 f r ) ) ' ,   g a p :   ' 1 6 p x '   } } >  
                                     < d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > P l a n < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > P r o f e s s i o n a l < / d i v >  
                                     < / d i v >  
                                     < d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > B i l l i n g   C y c l e < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > M o n t h l y < / d i v >  
                                     < / d i v >  
                                     < d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > N e x t   B i l l i n g < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > D e c   1 5 ,   2 0 2 4 < / d i v >  
                                     < / d i v >  
                                     < d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > A m o u n t < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ 9 9 . 0 0 / m o n t h < / d i v >  
                                     < / d i v >  
                                 < / d i v >  
                             < / d i v >  
  
                             { / *   P a y m e n t   M e t h o d   * / }  
                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 4 p x '   } } >  
                                 < h 3   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > P a y m e n t   M e t h o d < / h 3 >  
                                 < d i v   s t y l e = { {   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r '   } } >  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 1 2 p x '   } } >  
                                             < d i v   s t y l e = { {   w i d t h :   ' 4 0 p x ' ,   h e i g h t :   ' 3 2 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   j u s t i f y C o n t e n t :   ' c e n t e r '   } } >  
                                                 < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 6 p x '   } } >  x  < / s p a n >  
                                             < / d i v >  
                                             < d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } >                                           4 2 4 2 < / d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > E x p i r e s   1 2 / 2 5 < / d i v >  
                                             < / d i v >  
                                         < / d i v >  
                                         < b u t t o n   s t y l e = { {   p a d d i n g :   ' 8 p x   1 6 p x ' ,   b a c k g r o u n d :   ' # 6 6 7 e e a ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } } >  
                                             U p d a t e  
                                         < / b u t t o n >  
                                     < / d i v >  
                                 < / d i v >  
                             < / d i v >  
  
                             { / *   B i l l i n g   H i s t o r y   * / }  
                             < d i v >  
                                 < h 3   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > B i l l i n g   H i s t o r y < / h 3 >  
                                 < d i v   s t y l e = { {   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   o v e r f l o w :   ' h i d d e n '   } } >  
                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   1 0 0 p x   1 0 0 p x   1 2 0 p x ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } >  
                                         < d i v > D a t e < / d i v >  
                                         < d i v > A m o u n t < / d i v >  
                                         < d i v > S t a t u s < / d i v >  
                                         < d i v > I n v o i c e < / d i v >  
                                     < / d i v >  
                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   1 0 0 p x   1 0 0 p x   1 2 0 p x ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                         < d i v > N o v   1 5 ,   2 0 2 4 < / d i v >  
                                         < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ 9 9 . 0 0 < / d i v >  
                                         < d i v >  
                                             < s p a n   s t y l e = { {   p a d d i n g :   ' 2 p x   8 p x ' ,   b a c k g r o u n d :   ' # 1 0 b 9 8 1 ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                 P A I D  
                                             < / s p a n >  
                                         < / d i v >  
                                         < d i v >  
                                             < b u t t o n   s t y l e = { {   p a d d i n g :   ' 4 p x   8 p x ' ,   b a c k g r o u n d :   ' t r a n s p a r e n t ' ,   c o l o r :   ' # 6 6 7 e e a ' ,   b o r d e r :   ' 1 p x   s o l i d   # 6 6 7 e e a ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   f o n t S i z e :   ' 1 0 p x ' ,   c u r s o r :   ' p o i n t e r '   } } >  
                                                 P D F  
                                             < / b u t t o n >  
                                         < / d i v >  
                                     < / d i v >  
                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   1 0 0 p x   1 0 0 p x   1 2 0 p x ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   f o n t S i z e :   ' 1 4 p x ' ,   b a c k g r o u n d :   ' # f 9 f a f b '   } } >  
                                         < d i v > O c t   1 5 ,   2 0 2 4 < / d i v >  
                                         < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ 9 9 . 0 0 < / d i v >  
                                         < d i v >  
                                             < s p a n   s t y l e = { {   p a d d i n g :   ' 2 p x   8 p x ' ,   b a c k g r o u n d :   ' # 1 0 b 9 8 1 ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                 P A I D  
                                             < / s p a n >  
                                         < / d i v >  
                                         < d i v >  
                                             < b u t t o n   s t y l e = { {   p a d d i n g :   ' 4 p x   8 p x ' ,   b a c k g r o u n d :   ' t r a n s p a r e n t ' ,   c o l o r :   ' # 6 6 7 e e a ' ,   b o r d e r :   ' 1 p x   s o l i d   # 6 6 7 e e a ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   f o n t S i z e :   ' 1 0 p x ' ,   c u r s o r :   ' p o i n t e r '   } } >  
                                                 P D F  
                                             < / b u t t o n >  
                                         < / d i v >  
                                     < / d i v >  
                                 < / d i v >  
                             < / d i v >  
                         < / d i v >  
                     ) }  
  
                     { / *   P r o f i l e   S u b - T a b   C o n t e n t   * / }  
                     { c o m p a n y M a n a g e m e n t S u b T a b   = = =   ' p r o f i l e '   & &   (  
                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                             < h 2   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } > C o m p a n y   P r o f i l e < / h 2 >  
  
                             { / *   C o m p a n y   I n f o r m a t i o n   * / }  
                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 4 p x '   } } >  
                                 < h 3   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > C o m p a n y   I n f o r m a t i o n < / h 3 >  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( a u t o - f i t ,   m i n m a x ( 2 5 0 p x ,   1 f r ) ) ' ,   g a p :   ' 1 6 p x '   } } >  
                                     < d i v >  
                                         < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                             C o m p a n y   N a m e  
                                         < / l a b e l >  
                                         < d i v   s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                             { c o m p a n i e s . f i n d ( c   = >   c . i d   = = =   s e l e c t e d C o m p a n y I d ) ? . n a m e   | |   ' N o t   A v a i l a b l e ' }  
                                         < / d i v >  
                                     < / d i v >  
                                     < d i v >  
                                         < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                             I n d u s t r y  
                                         < / l a b e l >  
                                         < d i v   s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                             { c o m p a n y I n d u s t r y S e c t o r   & &   I N D U S T R Y _ S E C T O R S . f i n d ( i   = >   i . i d   = = =   c o m p a n y I n d u s t r y S e c t o r ) ? . n a m e   | |   ' N o t   S e t ' }  
                                         < / d i v >  
                                     < / d i v >  
                                     < d i v >  
                                         < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                             E m p l o y e e s  
                                         < / l a b e l >  
                                         < d i v   s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                             { c o m p a n i e s . f i n d ( c   = >   c . i d   = = =   s e l e c t e d C o m p a n y I d ) ? . e m p l o y e e C o u n t   | |   ' N o t   S e t ' }  
                                         < / d i v >  
                                     < / d i v >  
                                     < d i v >  
                                         < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                             F o u n d e d  
                                         < / l a b e l >  
                                         < d i v   s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                             { c o m p a n i e s . f i n d ( c   = >   c . i d   = = =   s e l e c t e d C o m p a n y I d ) ? . f o u n d e d Y e a r   | |   ' N o t   S e t ' }  
                                         < / d i v >  
                                     < / d i v >  
                                 < / d i v >  
                             < / d i v >  
  
                             { / *   C o n t a c t   I n f o r m a t i o n   * / }  
                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 4 p x '   } } >  
                                 < h 3   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > C o n t a c t   I n f o r m a t i o n < / h 3 >  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( a u t o - f i t ,   m i n m a x ( 2 5 0 p x ,   1 f r ) ) ' ,   g a p :   ' 1 6 p x '   } } >  
                                     < d i v >  
                                         < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                             E m a i l  
                                         < / l a b e l >  
                                         < d i v   s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                             { c o m p a n i e s . f i n d ( c   = >   c . i d   = = =   s e l e c t e d C o m p a n y I d ) ? . e m a i l   | |   ' N o t   S e t ' }  
                                         < / d i v >  
                                     < / d i v >  
                                     < d i v >  
                                         < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                             P h o n e  
                                         < / l a b e l >  
                                         < d i v   s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                             { c o m p a n i e s . f i n d ( c   = >   c . i d   = = =   s e l e c t e d C o m p a n y I d ) ? . p h o n e   | |   ' N o t   S e t ' }  
                                         < / d i v >  
                                     < / d i v >  
                                     < d i v >  
                                         < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                             W e b s i t e  
                                         < / l a b e l >  
                                         < d i v   s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                             { c o m p a n i e s . f i n d ( c   = >   c . i d   = = =   s e l e c t e d C o m p a n y I d ) ? . w e b s i t e   | |   ' N o t   S e t ' }  
                                         < / d i v >  
                                     < / d i v >  
                                 < / d i v >  
                             < / d i v >  
  
                             { / *   A c t i o n s   * / }  
                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 1 2 p x ' ,   j u s t i f y C o n t e n t :   ' f l e x - e n d '   } } >  
                                 < b u t t o n   s t y l e = { {   p a d d i n g :   ' 1 2 p x   2 4 p x ' ,   b a c k g r o u n d :   ' # 6 6 7 e e a ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } } >  
                                     E d i t   P r o f i l e  
                                 < / b u t t o n >  
                                 < b u t t o n   s t y l e = { {   p a d d i n g :   ' 1 2 p x   2 4 p x ' ,   b a c k g r o u n d :   ' # f 1 f 5 f 9 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } } >  
                                     E x p o r t   D a t a  
                                 < / b u t t o n >  
                             < / d i v >  
                         < / d i v >  
                     ) }  
  
                     { ! s e l e c t e d C o m p a n y I d   & &   a d m i n D a s h b o a r d T a b   = = =   ' a p i - c o n n e c t i o n s '   & &   (  
                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 4 8 p x   2 4 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   t e x t A l i g n :   ' c e n t e r '   } } >  
                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > N o   C o m p a n y   S e l e c t e d < / d i v >  
                             < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 9 4 a 3 b 8 '   } } > P l e a s e   s e l e c t   a   c o m p a n y   f r o m   t h e   s i d e b a r   t o   m a n a g e   A P I   c o n n e c t i o n s . < / p >  
                         < / d i v >  
                     ) }  
  
                     { ! s e l e c t e d C o m p a n y I d   & &   a d m i n D a s h b o a r d T a b   = = =   ' d a t a - r e v i e w '   & &   (  
                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 4 8 p x   2 4 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   t e x t A l i g n :   ' c e n t e r '   } } >  
                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > N o   C o m p a n y   S e l e c t e d < / d i v >  
                             < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 9 4 a 3 b 8 '   } } > P l e a s e   s e l e c t   a   c o m p a n y   f r o m   t h e   s i d e b a r   t o   r e v i e w   f i n a n c i a l   d a t a . < / p >  
                         < / d i v >  
                     ) }  
  
                     { / *   P a y m e n t s / B i l l i n g   T a b   * / }  
                     { a d m i n D a s h b o a r d T a b   = = =   ' p a y m e n t s '   & &   s e l e c t e d C o m p a n y I d   & &   ( ( )   = >   {  
                         c o n s t   s e l e c t e d C o m p a n y   =   c o m p a n i e s . f i n d ( c   = >   c . i d   = = =   s e l e c t e d C o m p a n y I d ) ;  
                         c o n s t   m o n t h l y P r i c e   =   s e l e c t e d C o m p a n y ? . s u b s c r i p t i o n M o n t h l y P r i c e   | |   1 9 5 ;  
                         c o n s t   q u a r t e r l y P r i c e   =   s e l e c t e d C o m p a n y ? . s u b s c r i p t i o n Q u a r t e r l y P r i c e   | |   5 0 0 ;  
                         c o n s t   a n n u a l P r i c e   =   s e l e c t e d C o m p a n y ? . s u b s c r i p t i o n A n n u a l P r i c e   | |   1 7 5 0 ;  
                          
                         r e t u r n   (  
                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   m a r g i n B o t t o m :   ' 2 0 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                             < h 2   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } > B i l l i n g   &   S u b s c r i p t i o n < / h 2 >  
  
                             { / *   S u b s c r i p t i o n   P l a n s   -   R e a d   O n l y   * / }  
                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                                 < h 3   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 1 0 p x '   } } > S u b s c r i p t i o n   P l a n s < / h 3 >  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( 3 ,   1 f r ) ' ,   g a p :   ' 1 2 p x '   } } >  
                                     { / *   M o n t h l y   P l a n   * / }  
                                     < d i v   s t y l e = { {    
                                         b o r d e r :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,    
                                         b o r d e r R a d i u s :   ' 8 p x ' ,    
                                         p a d d i n g :   ' 1 4 p x ' ,    
                                         b a c k g r o u n d :   ' # f a f a f a '  
                                     } } >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > M o n t h l y < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 6 6 7 e e a '   } } >  
                                             $ { m o n t h l y P r i c e . t o F i x e d ( 2 ) }  
                                             < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   f o n t W e i g h t :   ' 5 0 0 '   } } > / m o < / s p a n >  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   c o l o r :   ' # 9 4 a 3 b 8 ' ,   m a r g i n T o p :   ' 4 p x '   } } > B i l l e d   m o n t h l y < / d i v >  
                                     < / d i v >  
  
                                     { / *   Q u a r t e r l y   P l a n   * / }  
                                     < d i v   s t y l e = { {    
                                         b o r d e r :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,    
                                         b o r d e r R a d i u s :   ' 8 p x ' ,    
                                         p a d d i n g :   ' 1 4 p x ' ,    
                                         b a c k g r o u n d :   ' # f a f a f a '  
                                     } } >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > Q u a r t e r l y < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 6 6 7 e e a '   } } >  
                                             $ { q u a r t e r l y P r i c e . t o F i x e d ( 2 ) }  
                                             < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   f o n t W e i g h t :   ' 5 0 0 '   } } > / q t r < / s p a n >  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   c o l o r :   ' # 9 4 a 3 b 8 ' ,   m a r g i n T o p :   ' 4 p x '   } } > B i l l e d   e v e r y   3   m o n t h s < / d i v >  
                                     < / d i v >  
  
                                     { / *   A n n u a l   P l a n   * / }  
                                     < d i v   s t y l e = { {    
                                         b o r d e r :   ' 2 p x   s o l i d   # 1 0 b 9 8 1 ' ,    
                                         b o r d e r R a d i u s :   ' 8 p x ' ,    
                                         p a d d i n g :   ' 1 4 p x ' ,    
                                         b a c k g r o u n d :   ' # f 0 f d f 4 ' ,  
                                         p o s i t i o n :   ' r e l a t i v e '  
                                     } } >  
                                         < d i v   s t y l e = { {   p o s i t i o n :   ' a b s o l u t e ' ,   t o p :   ' 6 p x ' ,   r i g h t :   ' 6 p x ' ,   b a c k g r o u n d :   ' # 1 0 b 9 8 1 ' ,   c o l o r :   ' w h i t e ' ,   p a d d i n g :   ' 2 p x   6 p x ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   f o n t S i z e :   ' 9 p x ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                             B E S T   V A L U E  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > A n n u a l < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 0 5 9 6 6 9 '   } } >  
                                             $ { a n n u a l P r i c e . t o F i x e d ( 2 ) }  
                                             < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   f o n t W e i g h t :   ' 5 0 0 '   } } > / y r < / s p a n >  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   c o l o r :   ' # 0 5 9 6 6 9 ' ,   m a r g i n T o p :   ' 4 p x ' ,   f o n t W e i g h t :   ' 5 0 0 '   } } > S a v e   1 5 %   a n n u a l l y < / d i v >  
                                     < / d i v >  
                                 < / d i v >  
                             < / d i v >  
  
                             { / *   P a y m e n t   I n f o r m a t i o n   * / }  
                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                 < h 3   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 1 0 p x '   } } > P a y m e n t   I n f o r m a t i o n < / h 3 >  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g a p :   ' 1 0 p x '   } } >  
                                     { / *   C a r d h o l d e r   &   C a r d   N u m b e r   -   2   c o l u m n s   * / }  
                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   1 f r ' ,   g a p :   ' 1 0 p x '   } } >  
                                         < d i v >  
                                             < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                                 C a r d h o l d e r   N a m e   *  
                                             < / l a b e l >  
                                             < i n p u t    
                                                 t y p e = " t e x t "  
                                                 p l a c e h o l d e r = " J o h n   D o e "  
                                                 s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 8 p x   1 0 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 3 p x '   } }  
                                             / >  
                                         < / d i v >  
                                         < d i v >  
                                             < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                                 C a r d   N u m b e r   *  
                                             < / l a b e l >  
                                             < i n p u t    
                                                 t y p e = " t e x t "  
                                                 p l a c e h o l d e r = " 1 2 3 4   5 6 7 8   9 0 1 2   3 4 5 6 "  
                                                 m a x L e n g t h = { 1 9 }  
                                                 s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 8 p x   1 0 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 3 p x '   } }  
                                             / >  
                                         < / d i v >  
                                     < / d i v >  
  
                                     { / *   E x p   M o n t h ,   E x p   Y e a r ,   C V V   -   4   c o l u m n s   w i t h   f i x e d   w i d t h s   * / }  
                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 0 0 p x   1 0 0 p x   8 0 p x   1 f r ' ,   g a p :   ' 1 0 p x '   } } >  
                                         < d i v >  
                                             < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                                 E x p   M o n t h   *  
                                             < / l a b e l >  
                                             < s e l e c t   s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 8 p x   6 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                 < o p t i o n   v a l u e = " " > M M < / o p t i o n >  
                                                 { A r r a y . f r o m ( { l e n g t h :   1 2 } ,   ( _ ,   i )   = >   i   +   1 ) . m a p ( m o n t h   = >   (  
                                                     < o p t i o n   k e y = { m o n t h }   v a l u e = { m o n t h . t o S t r i n g ( ) . p a d S t a r t ( 2 ,   ' 0 ' ) } >  
                                                         { m o n t h . t o S t r i n g ( ) . p a d S t a r t ( 2 ,   ' 0 ' ) }  
                                                     < / o p t i o n >  
                                                 ) ) }  
                                             < / s e l e c t >  
                                         < / d i v >  
                                         < d i v >  
                                             < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                                 E x p   Y e a r   *  
                                             < / l a b e l >  
                                             < s e l e c t   s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 8 p x   6 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                 < o p t i o n   v a l u e = " " > Y Y Y Y < / o p t i o n >  
                                                 { A r r a y . f r o m ( { l e n g t h :   1 0 } ,   ( _ ,   i )   = >   n e w   D a t e ( ) . g e t F u l l Y e a r ( )   +   i ) . m a p ( y e a r   = >   (  
                                                     < o p t i o n   k e y = { y e a r }   v a l u e = { y e a r } >  
                                                         { y e a r }  
                                                     < / o p t i o n >  
                                                 ) ) }  
                                             < / s e l e c t >  
                                         < / d i v >  
                                         < d i v >  
                                             < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                                 C V V   *  
                                             < / l a b e l >  
                                             < i n p u t    
                                                 t y p e = " t e x t "  
                                                 p l a c e h o l d e r = " 1 2 3 "  
                                                 m a x L e n g t h = { 4 }  
                                                 s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 8 p x   1 0 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 3 p x '   } }  
                                             / >  
                                         < / d i v >  
                                         < d i v > < / d i v >  
                                     < / d i v >  
  
                                     { / *   A d d r e s s ,   C i t y ,   S t a t e ,   Z I P   -   S i n g l e   r o w   * / }  
                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 4 2 0 p x   2 0 0 p x   1 0 0 p x   1 2 0 p x ' ,   g a p :   ' 1 0 p x '   } } >  
                                         < d i v >  
                                             < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                                 B i l l i n g   A d d r e s s   *  
                                             < / l a b e l >  
                                             < i n p u t    
                                                 t y p e = " t e x t "  
                                                 p l a c e h o l d e r = " 1 2 3   M a i n   S t "  
                                                 s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 8 p x   1 0 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 3 p x '   } }  
                                             / >  
                                         < / d i v >  
                                         < d i v >  
                                             < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                                 C i t y   *  
                                             < / l a b e l >  
                                             < i n p u t    
                                                 t y p e = " t e x t "  
                                                 p l a c e h o l d e r = " S a n   F r a n c i s c o "  
                                                 s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 8 p x   1 0 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 3 p x '   } }  
                                             / >  
                                         < / d i v >  
                                         < d i v >  
                                             < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                                 S t a t e   *  
                                             < / l a b e l >  
                                             < s e l e c t   s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 8 p x   6 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                 < o p t i o n   v a l u e = " " > S t a t e < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " A L " > A L < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " A K " > A K < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " A Z " > A Z < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " A R " > A R < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " C A " > C A < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " C O " > C O < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " C T " > C T < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " D E " > D E < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " F L " > F L < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " G A " > G A < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " H I " > H I < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " I D " > I D < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " I L " > I L < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " I N " > I N < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " I A " > I A < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " K S " > K S < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " K Y " > K Y < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " L A " > L A < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " M E " > M E < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " M D " > M D < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " M A " > M A < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " M I " > M I < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " M N " > M N < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " M S " > M S < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " M O " > M O < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " M T " > M T < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " N E " > N E < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " N V " > N V < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " N H " > N H < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " N J " > N J < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " N M " > N M < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " N Y " > N Y < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " N C " > N C < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " N D " > N D < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " O H " > O H < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " O K " > O K < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " O R " > O R < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " P A " > P A < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " R I " > R I < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " S C " > S C < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " S D " > S D < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " T N " > T N < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " T X " > T X < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " U T " > U T < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " V T " > V T < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " V A " > V A < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " W A " > W A < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " W V " > W V < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " W I " > W I < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " W Y " > W Y < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " D C " > D C < / o p t i o n >  
                                             < / s e l e c t >  
                                         < / d i v >  
                                         < d i v >  
                                             < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                                 Z I P   *  
                                             < / l a b e l >  
                                             < i n p u t    
                                                 t y p e = " t e x t "  
                                                 p l a c e h o l d e r = " 9 4 1 0 2 "  
                                                 m a x L e n g t h = { 1 0 }  
                                                 s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 8 p x   1 0 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 3 p x '   } }  
                                             / >  
                                         < / d i v >  
                                     < / d i v >  
                                 < / d i v >  
                             < / d i v >  
  
                             { / *   A c t i o n   B u t t o n s   * / }  
                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 1 0 p x ' ,   j u s t i f y C o n t e n t :   ' f l e x - e n d ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g T o p :   ' 1 6 p x '   } } >  
                                 < b u t t o n  
                                     o n C l i c k = { ( )   = >   {  
                                         i f   ( c o n f i r m ( ' A r e   y o u   s u r e   y o u   w a n t   t o   c a n c e l   y o u r   s u b s c r i p t i o n ? ' ) )   {  
                                             a l e r t ( ' S u b s c r i p t i o n   c a n c e l l e d . ' ) ;  
                                         }  
                                     } }  
                                     s t y l e = { {  
                                         p a d d i n g :   ' 8 p x   1 6 p x ' ,  
                                         b a c k g r o u n d :   ' w h i t e ' ,  
                                         c o l o r :   ' # e f 4 4 4 4 ' ,  
                                         b o r d e r :   ' 1 p x   s o l i d   # e f 4 4 4 4 ' ,  
                                         b o r d e r R a d i u s :   ' 6 p x ' ,  
                                         f o n t S i z e :   ' 1 3 p x ' ,  
                                         f o n t W e i g h t :   ' 6 0 0 ' ,  
                                         c u r s o r :   ' p o i n t e r '  
                                     } }  
                                 >  
                                     C a n c e l   S u b s c r i p t i o n  
                                 < / b u t t o n >  
                                 < b u t t o n  
                                     o n C l i c k = { ( )   = >   {  
                                         a l e r t ( ' P r o c e s s i n g   p a y m e n t . . .   T h i s   w i l l   i n t e g r a t e   w i t h   U S A e P a y   A P I ' ) ;  
                                     } }  
                                     s t y l e = { {  
                                         p a d d i n g :   ' 8 p x   2 0 p x ' ,  
                                         b a c k g r o u n d :   ' # 6 6 7 e e a ' ,  
                                         c o l o r :   ' w h i t e ' ,  
                                         b o r d e r :   ' n o n e ' ,  
                                         b o r d e r R a d i u s :   ' 6 p x ' ,  
                                         f o n t S i z e :   ' 1 3 p x ' ,  
                                         f o n t W e i g h t :   ' 6 0 0 ' ,  
                                         c u r s o r :   ' p o i n t e r '  
                                     } }  
                                 >  
                                     S t a r t   S u b s c r i p t i o n  
                                 < / b u t t o n >  
                             < / d i v >  
  
                             { / *   S e c u r i t y   N o t i c e   * / }  
                             < d i v   s t y l e = { {   m a r g i n T o p :   ' 1 6 p x ' ,   p a d d i n g :   ' 1 0 p x   1 2 p x ' ,   b a c k g r o u n d :   ' # f 0 f d f 4 ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # 8 6 e f a c '   } } >  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 6 p x '   } } >  
                                     < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 4 p x '   } } >  x  < / s p a n >  
                                     < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 5 0 0 ' ,   c o l o r :   ' # 0 5 9 6 6 9 '   } } >  
                                         S e c u r e   p a y m e n t   p r o c e s s i n g   v i a   U S A e P a y .   C a r d   d a t a   i s   e n c r y p t e d   a n d   n e v e r   s t o r e d   o n   o u r   s e r v e r s .  
                                     < / s p a n >  
                                 < / d i v >  
                             < / d i v >  
                         < / d i v >  
                         ) ;  
                     } ) ( ) }  
  
                     { ! s e l e c t e d C o m p a n y I d   & &   a d m i n D a s h b o a r d T a b   = = =   ' p a y m e n t s '   & &   (  
                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 4 8 p x   2 4 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   t e x t A l i g n :   ' c e n t e r '   } } >  
                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > N o   C o m p a n y   S e l e c t e d < / d i v >  
                             < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 9 4 a 3 b 8 '   } } > P l e a s e   s e l e c t   a   c o m p a n y   f r o m   t h e   s i d e b a r   t o   m a n a g e   s u b s c r i p t i o n   a n d   b i l l i n g . < / p >  
                         < / d i v >  
                     ) }  
  
                     { / *   P r o f i l e   T a b   -   N o   C o m p a n y   S e l e c t e d   * / }  
                     { ! s e l e c t e d C o m p a n y I d   & &   a d m i n D a s h b o a r d T a b   = = =   ' p r o f i l e '   & &   (  
                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 4 8 p x   2 4 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   t e x t A l i g n :   ' c e n t e r '   } } >  
                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > N o   C o m p a n y   S e l e c t e d < / d i v >  
                             < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 9 4 a 3 b 8 '   } } > P l e a s e   s e l e c t   a   c o m p a n y   f r o m   t h e   s i d e b a r   t o   v i e w   a n d   e d i t   c o m p a n y   p r o f i l e . < / p >  
                         < / d i v >  
                     ) }  
  
                     { / *   D a t a   M a p p i n g   T a b   -   C o n t e n t   r e n d e r e d   t h r o u g h   F i n a n c i a l   S t a t e m e n t s   c o n d i t i o n a l   b e l o w   * / }  
  
                     { ! s e l e c t e d C o m p a n y I d   & &   a d m i n D a s h b o a r d T a b   = = =   ' d a t a - m a p p i n g '   & &   (  
                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 4 8 p x   2 4 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   t e x t A l i g n :   ' c e n t e r '   } } >  
                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > N o   C o m p a n y   S e l e c t e d < / d i v >  
                             < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 9 4 a 3 b 8 '   } } > P l e a s e   s e l e c t   a   c o m p a n y   f r o m   t h e   s i d e b a r   t o   m a p   Q u i c k B o o k s   a c c o u n t s . < / p >  
                         < / d i v >  
                     ) }  
  
                     { a d m i n D a s h b o a r d T a b   = = =   ' d a t a - m a p p i n g '   & &   s e l e c t e d C o m p a n y I d   & &   ! q b R a w D a t a   & &   (  
                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 4 8 p x   2 4 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   t e x t A l i g n :   ' c e n t e r '   } } >  
                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > N o   Q u i c k B o o k s   D a t a < / d i v >  
                             < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 9 4 a 3 b 8 ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } > P l e a s e   s y n c   Q u i c k B o o k s   d a t a   f i r s t   f r o m   t h e   A c c o u n t i n g   A P I   C o n n e c t i o n s   t a b . < / p >  
                             < b u t t o n  
                                 o n C l i c k = { ( )   = >   s e t A d m i n D a s h b o a r d T a b ( ' a p i - c o n n e c t i o n s ' ) }  
                                 s t y l e = { {  
                                     p a d d i n g :   ' 1 2 p x   2 4 p x ' ,  
                                     b a c k g r o u n d :   ' # 6 6 7 e e a ' ,  
                                     c o l o r :   ' w h i t e ' ,  
                                     b o r d e r :   ' n o n e ' ,  
                                     b o r d e r R a d i u s :   ' 8 p x ' ,  
                                     f o n t S i z e :   ' 1 4 p x ' ,  
                                     f o n t W e i g h t :   ' 6 0 0 ' ,  
                                     c u r s o r :   ' p o i n t e r '  
                                 } }  
                             >  
                                 G o   t o   A P I   C o n n e c t i o n s  
                             < / b u t t o n >  
                         < / d i v >  
                     ) }  
                 < / d i v >  
             ) }  
  
             { / *   C o m p a n y   D e t a i l s   M o d a l   * / }  
             { s h o w C o m p a n y D e t a i l s M o d a l   & &   (  
                 < d i v   s t y l e = { {   p o s i t i o n :   ' f i x e d ' ,   t o p :   0 ,   l e f t :   0 ,   r i g h t :   0 ,   b o t t o m :   0 ,   b a c k g r o u n d :   ' r g b a ( 0 , 0 , 0 , 0 . 5 ) ' ,   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' c e n t e r ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   z I n d e x :   1 0 0 0   } } >  
                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   m a x W i d t h :   ' 7 0 0 p x ' ,   w i d t h :   ' 1 0 0 % ' ,   m a x H e i g h t :   ' 8 0 v h ' ,   o v e r f l o w Y :   ' a u t o '   } } >  
                         < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > C o m p a n y   D e t a i l s < / h 2 >  
                          
                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                             < h 3   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 8 p x '   } } > A d d r e s s < / h 3 >  
                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   f l e x D i r e c t i o n :   ' c o l u m n ' ,   g a p :   ' 1 2 p x '   } } >  
                                 < i n p u t    
                                     t y p e = " t e x t "    
                                     v a l u e = { c o m p a n y A d d r e s s S t r e e t }    
                                     o n C h a n g e = { ( e )   = >   s e t C o m p a n y A d d r e s s S t r e e t ( e . t a r g e t . v a l u e ) }    
                                     s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 1 2 p x   1 6 p x ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 4 p x '   } }    
                                     p l a c e h o l d e r = " S t r e e t   A d d r e s s "    
                                 / >  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 2 p x '   } } >  
                                     < i n p u t    
                                         t y p e = " t e x t "    
                                         v a l u e = { c o m p a n y A d d r e s s C i t y }    
                                         o n C h a n g e = { ( e )   = >   s e t C o m p a n y A d d r e s s C i t y ( e . t a r g e t . v a l u e ) }    
                                         s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 1 2 p x   1 6 p x ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 4 p x '   } }    
                                         p l a c e h o l d e r = " C i t y "    
                                     / >  
                                     < s e l e c t    
                                         v a l u e = { c o m p a n y A d d r e s s S t a t e }    
                                         o n C h a n g e = { ( e )   = >   s e t C o m p a n y A d d r e s s S t a t e ( e . t a r g e t . v a l u e ) }    
                                         s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 1 2 p x   1 6 p x ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c u r s o r :   ' p o i n t e r '   } }  
                                     >  
                                         < o p t i o n   v a l u e = " " > S t a t e < / o p t i o n >  
                                         < o p t i o n   v a l u e = " A L " > A L < / o p t i o n >  
                                         < o p t i o n   v a l u e = " A K " > A K < / o p t i o n >  
                                         < o p t i o n   v a l u e = " A Z " > A Z < / o p t i o n >  
                                         < o p t i o n   v a l u e = " A R " > A R < / o p t i o n >  
                                         < o p t i o n   v a l u e = " C A " > C A < / o p t i o n >  
                                         < o p t i o n   v a l u e = " C O " > C O < / o p t i o n >  
                                         < o p t i o n   v a l u e = " C T " > C T < / o p t i o n >  
                                         < o p t i o n   v a l u e = " D E " > D E < / o p t i o n >  
                                         < o p t i o n   v a l u e = " F L " > F L < / o p t i o n >  
                                         < o p t i o n   v a l u e = " G A " > G A < / o p t i o n >  
                                         < o p t i o n   v a l u e = " H I " > H I < / o p t i o n >  
                                         < o p t i o n   v a l u e = " I D " > I D < / o p t i o n >  
                                         < o p t i o n   v a l u e = " I L " > I L < / o p t i o n >  
                                         < o p t i o n   v a l u e = " I N " > I N < / o p t i o n >  
                                         < o p t i o n   v a l u e = " I A " > I A < / o p t i o n >  
                                         < o p t i o n   v a l u e = " K S " > K S < / o p t i o n >  
                                         < o p t i o n   v a l u e = " K Y " > K Y < / o p t i o n >  
                                         < o p t i o n   v a l u e = " L A " > L A < / o p t i o n >  
                                         < o p t i o n   v a l u e = " M E " > M E < / o p t i o n >  
                                         < o p t i o n   v a l u e = " M D " > M D < / o p t i o n >  
                                         < o p t i o n   v a l u e = " M A " > M A < / o p t i o n >  
                                         < o p t i o n   v a l u e = " M I " > M I < / o p t i o n >  
                                         < o p t i o n   v a l u e = " M N " > M N < / o p t i o n >  
                                         < o p t i o n   v a l u e = " M S " > M S < / o p t i o n >  
                                         < o p t i o n   v a l u e = " M O " > M O < / o p t i o n >  
                                         < o p t i o n   v a l u e = " M T " > M T < / o p t i o n >  
                                         < o p t i o n   v a l u e = " N E " > N E < / o p t i o n >  
                                         < o p t i o n   v a l u e = " N V " > N V < / o p t i o n >  
                                         < o p t i o n   v a l u e = " N H " > N H < / o p t i o n >  
                                         < o p t i o n   v a l u e = " N J " > N J < / o p t i o n >  
                                         < o p t i o n   v a l u e = " N M " > N M < / o p t i o n >  
                                         < o p t i o n   v a l u e = " N Y " > N Y < / o p t i o n >  
                                         < o p t i o n   v a l u e = " N C " > N C < / o p t i o n >  
                                         < o p t i o n   v a l u e = " N D " > N D < / o p t i o n >  
                                         < o p t i o n   v a l u e = " O H " > O H < / o p t i o n >  
                                         < o p t i o n   v a l u e = " O K " > O K < / o p t i o n >  
                                         < o p t i o n   v a l u e = " O R " > O R < / o p t i o n >  
                                         < o p t i o n   v a l u e = " P A " > P A < / o p t i o n >  
                                         < o p t i o n   v a l u e = " R I " > R I < / o p t i o n >  
                                         < o p t i o n   v a l u e = " S C " > S C < / o p t i o n >  
                                         < o p t i o n   v a l u e = " S D " > S D < / o p t i o n >  
                                         < o p t i o n   v a l u e = " T N " > T N < / o p t i o n >  
                                         < o p t i o n   v a l u e = " T X " > T X < / o p t i o n >  
                                         < o p t i o n   v a l u e = " U T " > U T < / o p t i o n >  
                                         < o p t i o n   v a l u e = " V T " > V T < / o p t i o n >  
                                         < o p t i o n   v a l u e = " V A " > V A < / o p t i o n >  
                                         < o p t i o n   v a l u e = " W A " > W A < / o p t i o n >  
                                         < o p t i o n   v a l u e = " W V " > W V < / o p t i o n >  
                                         < o p t i o n   v a l u e = " W I " > W I < / o p t i o n >  
                                         < o p t i o n   v a l u e = " W Y " > W Y < / o p t i o n >  
                                         < o p t i o n   v a l u e = " D C " > D C < / o p t i o n >  
                                     < / s e l e c t >  
                                     < i n p u t    
                                         t y p e = " t e x t "    
                                         v a l u e = { c o m p a n y A d d r e s s Z i p }    
                                         o n C h a n g e = { ( e )   = >   s e t C o m p a n y A d d r e s s Z i p ( e . t a r g e t . v a l u e ) }    
                                         s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 1 2 p x   1 6 p x ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 4 p x '   } }    
                                         p l a c e h o l d e r = " Z I P "    
                                     / >  
                                 < / d i v >  
                                 < i n p u t    
                                     t y p e = " t e x t "    
                                     v a l u e = { c o m p a n y A d d r e s s C o u n t r y }    
                                     o n C h a n g e = { ( e )   = >   s e t C o m p a n y A d d r e s s C o u n t r y ( e . t a r g e t . v a l u e ) }    
                                     s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 1 2 p x   1 6 p x ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 4 p x '   } }    
                                     p l a c e h o l d e r = " C o u n t r y "    
                                 / >  
                             < / d i v >  
                         < / d i v >  
                          
                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                             < h 3   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 8 p x '   } } > I n d u s t r y   S e c t o r < / h 3 >  
                             < s e l e c t    
                                 v a l u e = { c o m p a n y I n d u s t r y S e c t o r }    
                                 o n C h a n g e = { ( e )   = >   s e t C o m p a n y I n d u s t r y S e c t o r ( p a r s e I n t ( e . t a r g e t . v a l u e ) ) }    
                                 s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 1 2 p x   1 6 p x ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c u r s o r :   ' p o i n t e r '   } }  
                             >  
                                 < o p t i o n   v a l u e = " " > - -   S e l e c t   I n d u s t r y   - - < / o p t i o n >  
                                 { S E C T O R _ C A T E G O R I E S . m a p ( s e c t o r   = >   (  
                                     < o p t g r o u p   k e y = { s e c t o r . c o d e }   l a b e l = { ` $ { s e c t o r . c o d e }   -   $ { s e c t o r . n a m e } ` } >  
                                         { I N D U S T R Y _ S E C T O R S  
                                             . f i l t e r ( i n d   = >   i n d . s e c t o r C o d e   = = =   s e c t o r . c o d e )  
                                             . m a p ( i n d u s t r y   = >   (  
                                                 < o p t i o n   k e y = { i n d u s t r y . i d }   v a l u e = { i n d u s t r y . i d } >  
                                                     { i n d u s t r y . i d }   -   { i n d u s t r y . n a m e }  
                                                 < / o p t i o n >  
                                             ) ) }  
                                     < / o p t g r o u p >  
                                 ) ) }  
                             < / s e l e c t >  
                             { c o m p a n y I n d u s t r y S e c t o r   & &   I N D U S T R Y _ S E C T O R S . f i n d ( i   = >   i . i d   = = =   c o m p a n y I n d u s t r y S e c t o r )   & &   (  
                                 < d i v   s t y l e = { {   m a r g i n T o p :   ' 8 p x ' ,   p a d d i n g :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # f 0 f 9 f f ' ,   b o r d e r :   ' 1 p x   s o l i d   # b a e 6 f d ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                     < p   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 0 c 4 a 6 e ' ,   m a r g i n :   0   } } >  
                                         < s t r o n g > { I N D U S T R Y _ S E C T O R S . f i n d ( i   = >   i . i d   = = =   c o m p a n y I n d u s t r y S e c t o r ) ? . n a m e } < / s t r o n g >  
                                         < b r   / >  
                                         < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 1 p x '   } } > { I N D U S T R Y _ S E C T O R S . f i n d ( i   = >   i . i d   = = =   c o m p a n y I n d u s t r y S e c t o r ) ? . d e s c r i p t i o n } < / s p a n >  
                                     < / p >  
                                 < / d i v >  
                             ) }  
                         < / d i v >  
                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 1 2 p x '   } } >  
                             < b u t t o n   o n C l i c k = { s a v e C o m p a n y D e t a i l s }   s t y l e = { {   f l e x :   1 ,   p a d d i n g :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # 6 6 7 e e a ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } } > S a v e < / b u t t o n >  
                             < b u t t o n   o n C l i c k = { ( )   = >   s e t S h o w C o m p a n y D e t a i l s M o d a l ( f a l s e ) }   s t y l e = { {   f l e x :   1 ,   p a d d i n g :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # f 1 f 5 f 9 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } } > C a n c e l < / b u t t o n >  
                         < / d i v >  
                     < / d i v >  
                 < / d i v >  
             ) }  
  
             { / *   C o n t e n t   A r e a   -   R e q u i r e s   C o m p a n y   S e l e c t i o n   * / }  
             { ! s e l e c t e d C o m p a n y I d   & &   c u r r e n t V i e w   ! = =   ' a d m i n '   & &   (  
                 < d i v   s t y l e = { {   m a x W i d t h :   ' 1 4 0 0 p x ' ,   m a r g i n :   ' 0   a u t o ' ,   p a d d i n g :   ' 6 4 p x   3 2 p x ' ,   t e x t A l i g n :   ' c e n t e r '   } } >  
                     < h 2   s t y l e = { {   f o n t S i z e :   ' 2 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } > N o   C o m p a n y   S e l e c t e d < / h 2 >  
                     < p   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > P l e a s e   s e l e c t   a   c o m p a n y   f r o m   t h e   C o n s u l t a n t   D a s h b o a r d   t o   c o n t i n u e . < / p >  
                     { c u r r e n t U s e r ? . r o l e   = = =   ' c o n s u l t a n t '   & &   (  
                         < b u t t o n   o n C l i c k = { ( )   = >   s e t C u r r e n t V i e w ( ' a d m i n ' ) }   s t y l e = { {   p a d d i n g :   ' 1 2 p x   2 4 p x ' ,   b a c k g r o u n d :   ' # 6 6 7 e e a ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } } > G o   t o   C o n s u l t a n t   D a s h b o a r d < / b u t t o n >  
                     ) }  
                 < / d i v >  
             ) }  
  
             { / *   D a t a   R e v i e w   T a b   * / }  
             { c u r r e n t V i e w   = = =   ' a d m i n '   & &   a d m i n D a s h b o a r d T a b   = = =   ' d a t a - r e v i e w '   & &   s e l e c t e d C o m p a n y I d   & &   (  
                 < d i v   s t y l e = { {   m a x W i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 3 2 p x ' ,   o v e r f l o w X :   ' a u t o '   } } >  
                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                         < h 1   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n :   0   } } >  x `  D a t a   R e v i e w   -   F i n a n c i a l   D a t a < / h 1 >  
                         { c o m p a n y N a m e   & &   < d i v   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > { c o m p a n y N a m e } < / d i v > }  
                     < / d i v >  
                     < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                         R e v i e w   a l l   i m p o r t e d   f i n a n c i a l   d a t a   f o r   { c o m p a n y N a m e   | |   ' t h i s   c o m p a n y ' }  
                     < / p >  
                      
                     { ( ! m o n t h l y   | |   m o n t h l y . l e n g t h   = = =   0 )   & &   (  
                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f e f 2 f 2 ' ,   b o r d e r :   ' 1 p x   s o l i d   # f e c a c a ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   c o l o r :   ' # 9 9 1 b 1 b '   } } >  
                             < s t r o n g > N o   f i n a n c i a l   d a t a   f o u n d . < / s t r o n g >  
                             < p   s t y l e = { {   m a r g i n T o p :   ' 8 p x ' ,   m a r g i n B o t t o m :   0   } } >  
                                 P l e a s e   u p l o a d   f i n a n c i a l   d a t a   i n   t h e   I m p o r t   F i n a n c i a l s   t a b   o r   s y n c   f r o m   Q u i c k B o o k s   i n   t h e   A c c o u n t i n g   A P I   C o n n e c t i o n s   t a b .  
                             < / p >  
                         < / d i v >  
                     ) }  
                      
                     { m o n t h l y   & &   m o n t h l y . l e n g t h   >   0   & &   (  
                         < >  
                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 0 f d f 4 ' ,   b o r d e r :   ' 1 p x   s o l i d   # 8 6 e f a c ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   c o l o r :   ' # 1 6 6 5 3 4 '   } } >  
                                 < s t r o n g >  S&   F i n a n c i a l   d a t a   l o a d e d < / s t r o n g >  
                                 < p   s t y l e = { {   m a r g i n T o p :   ' 8 p x ' ,   m a r g i n B o t t o m :   0   } } >  
                                     T o t a l   m o n t h s :   { m o n t h l y . l e n g t h }   |   D i s p l a y i n g :   L a s t   { M a t h . m i n ( 3 6 ,   m o n t h l y . l e n g t h ) }   m o n t h s  
                                 < / p >  
                             < / d i v >  
  
                             { / *   I n c o m e   S t a t e m e n t   -   L a s t   3 6   m o n t h s   * / }  
                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                 < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x ' ,   b o r d e r B o t t o m :   ' 3 p x   s o l i d   # 1 0 b 9 8 1 ' ,   p a d d i n g B o t t o m :   ' 8 p x '   } } >  
                                     I n c o m e   S t a t e m e n t   ( L a s t   3 6   M o n t h s )  
                                 < / h 2 >  
                                 < d i v   s t y l e = { {   o v e r f l o w X :   ' a u t o '   } } >  
                                     < t a b l e   s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   b o r d e r C o l l a p s e :   ' c o l l a p s e ' ,   f o n t S i z e :   ' 1 2 p x '   } } >  
                                         < t h e a d >  
                                             < t r   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                 < t h   s t y l e = { {   p a d d i n g :   ' 1 0 p x ' ,   t e x t A l i g n :   ' l e f t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   z I n d e x :   1 ,   m i n W i d t h :   ' 1 5 0 p x '   } } > I t e m < / t h >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t h   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   m i n W i d t h :   ' 9 0 p x '   } } > { m . m o n t h } < / t h >  
                                                 ) ) }  
                                             < / t r >  
                                         < / t h e a d >  
                                         < t b o d y >  
                                             { / *   T o t a l   R e v e n u e   * / }  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   b a c k g r o u n d :   ' # f 0 f d f 4 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' # f 0 f d f 4 ' ,   z I n d e x :   1   } } > T o t a l   R e v e n u e < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e ' ,   f o n t W e i g h t :   ' 7 0 0 '   } } >  
                                                         $ { ( m . r e v e n u e   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                              
                                             { / *   C O G S   D e t a i l   * / }  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 ' ,   b a c k g r o u n d :   ' # f e f 3 c 7 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' # f e f 3 c 7 ' ,   z I n d e x :   1   } } > C O S T   O F   G O O D S   S O L D < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x '   } } > < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > C O G S   P a y r o l l < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . c o g s P a y r o l l   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > C O G S   O w n e r   P a y < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . c o g s O w n e r P a y   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > C O G S   C o n t r a c t o r s < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . c o g s C o n t r a c t o r s   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > C O G S   M a t e r i a l s < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . c o g s M a t e r i a l s   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > C O G S   C o m m i s s i o n s < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . c o g s C o m m i s s i o n s   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > C O G S   O t h e r < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . c o g s O t h e r   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   b a c k g r o u n d :   ' # f e f 9 c 3 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' # f e f 9 c 3 ' ,   z I n d e x :   1   } } > T o t a l   C O G S < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e ' ,   f o n t W e i g h t :   ' 7 0 0 '   } } >  
                                                         $ { ( m . c o g s T o t a l   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                              
                                             { / *   G r o s s   P r o f i t   * / }  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # 1 0 b 9 8 1 ' ,   b a c k g r o u n d :   ' # d 1 f a e 5 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 1 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 4 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' # d 1 f a e 5 ' ,   z I n d e x :   1   } } > G R O S S   P R O F I T < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   {  
                                                     c o n s t   g r o s s P r o f i t   =   ( m . r e v e n u e   | |   0 )   -   ( m . c o g s T o t a l   | |   0 ) ;  
                                                     r e t u r n   (  
                                                         < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             $ { g r o s s P r o f i t . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                         < / t d >  
                                                     ) ;  
                                                 } ) }  
                                             < / t r >  
                                              
                                             { / *   O p e r a t i n g   E x p e n s e s   * / }  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 ' ,   b a c k g r o u n d :   ' # d b e a f e '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' # d b e a f e ' ,   z I n d e x :   1   } } > O P E R A T I N G   E X P E N S E S < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x '   } } > < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > P a y r o l l < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . o p e x P a y r o l l   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > O w n e r   B a s e   P a y < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . o w n e r s B a s e P a y   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > B e n e f i t s < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . b e n e f i t s   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > I n s u r a n c e < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . i n s u r a n c e   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > P r o f e s s i o n a l   F e e s < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . p r o f e s s i o n a l S e r v i c e s   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > S u b c o n t r a c t o r s < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . c o n t r a c t o r s D i s t r i b u t i o n   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > R e n t < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . r e n t L e a s e   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > T a x   &   L i c e n s e < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . t a x L i c e n s e   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > P h o n e   &   C o m m < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . p h o n e C o m m   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > I n f r a s t r u c t u r e < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . e q u i p m e n t   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > A u t o   &   T r a v e l < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . t r a v e l   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > S a l e s   E x p e n s e < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . o p e x S a l e s M a r k e t i n g   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > M a r k e t i n g < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . o p e x O t h e r   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > T r a i n i n g   &   C e r t < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . t r a i n i n g C e r t   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > M e a l s   &   E n t e r t a i n m e n t < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . m e a l s E n t e r t a i n m e n t   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > I n t e r e s t   E x p e n s e < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . i n t e r e s t E x p e n s e   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > D e p r e c i a t i o n   &   A m o r t i z a t i o n < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . d e p r e c i a t i o n E x p e n s e   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > O t h e r   E x p e n s e < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . o t h e r E x p e n s e   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   b a c k g r o u n d :   ' # e 0 f 2 f e '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' # e 0 f 2 f e ' ,   z I n d e x :   1   } } > T o t a l   O p e r a t i n g   E x p e n s e s < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e ' ,   f o n t W e i g h t :   ' 7 0 0 '   } } >  
                                                         $ { ( m . e x p e n s e   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                              
                                             { / *   N e t   I n c o m e   * / }  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 3 p x   s o l i d   # 1 0 b 9 8 1 ' ,   b a c k g r o u n d :   ' # 1 0 b 9 8 1 ' ,   c o l o r :   ' w h i t e '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x   1 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 5 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' # 1 0 b 9 8 1 ' ,   z I n d e x :   1   } } > N E T   I N C O M E < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   {  
                                                     c o n s t   n e t I n c o m e   =   ( m . r e v e n u e   | |   0 )   -   ( m . c o g s T o t a l   | |   0 )   -   ( m . e x p e n s e   | |   0 ) ;  
                                                     r e t u r n   (  
                                                         < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 1 2 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 5 p x '   } } >  
                                                             $ { n e t I n c o m e . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                         < / t d >  
                                                     ) ;  
                                                 } ) }  
                                             < / t r >  
                                         < / t b o d y >  
                                     < / t a b l e >  
                                 < / d i v >  
                             < / d i v >  
  
                             { / *   B a l a n c e   S h e e t   -   L a s t   3 6   m o n t h s   * / }  
                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                 < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x ' ,   b o r d e r B o t t o m :   ' 3 p x   s o l i d   # 3 b 8 2 f 6 ' ,   p a d d i n g B o t t o m :   ' 8 p x '   } } >  
                                     B a l a n c e   S h e e t   ( L a s t   3 6   M o n t h s )  
                                 < / h 2 >  
                                 < d i v   s t y l e = { {   o v e r f l o w X :   ' a u t o '   } } >  
                                     < t a b l e   s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   b o r d e r C o l l a p s e :   ' c o l l a p s e ' ,   f o n t S i z e :   ' 1 2 p x '   } } >  
                                         < t h e a d >  
                                             < t r   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                 < t h   s t y l e = { {   p a d d i n g :   ' 1 0 p x ' ,   t e x t A l i g n :   ' l e f t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   z I n d e x :   1 ,   m i n W i d t h :   ' 1 5 0 p x '   } } > I t e m < / t h >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t h   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   m i n W i d t h :   ' 9 0 p x '   } } > { m . m o n t h } < / t h >  
                                                 ) ) }  
                                             < / t r >  
                                         < / t h e a d >  
                                         < t b o d y >  
                                             { / *   C u r r e n t   A s s e t s   * / }  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 ' ,   b a c k g r o u n d :   ' # d b e a f e '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' # d b e a f e ' ,   z I n d e x :   1   } } > C U R R E N T   A S S E T S < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x '   } } > < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > C a s h < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . c a s h   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > A c c o u n t s   R e c e i v a b l e < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . a r   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > I n v e n t o r y < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . i n v e n t o r y   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > O t h e r   C u r r e n t   A s s e t s < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . o t h e r C A   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   b a c k g r o u n d :   ' # d b e a f e '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' # d b e a f e ' ,   z I n d e x :   1   } } > T o t a l   C u r r e n t   A s s e t s < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e ' ,   f o n t W e i g h t :   ' 7 0 0 '   } } >  
                                                         $ { ( m . t c a   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                              
                                             { / *   F i x e d   A s s e t s   * / }  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > F i x e d   A s s e t s < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . f i x e d A s s e t s   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > O t h e r   A s s e t s < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . o t h e r A s s e t s   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 3 p x   s o l i d   # 3 b 8 2 f 6 ' ,   b a c k g r o u n d :   ' # e 0 f 2 f e '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 1 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 4 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' # e 0 f 2 f e ' ,   z I n d e x :   1   } } > T O T A L   A S S E T S < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         $ { ( m . t o t a l A s s e t s   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                              
                                             { / *   C u r r e n t   L i a b i l i t i e s   * / }  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 ' ,   b a c k g r o u n d :   ' # f e f 3 c 7 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' # f e f 3 c 7 ' ,   z I n d e x :   1   } } > C U R R E N T   L I A B I L I T I E S < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x '   } } > < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > A c c o u n t s   P a y a b l e < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . a p   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > O t h e r   C u r r e n t   L i a b i l i t i e s < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . o t h e r C L   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   b a c k g r o u n d :   ' # f e f 3 c 7 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' # f e f 3 c 7 ' ,   z I n d e x :   1   } } > T o t a l   C u r r e n t   L i a b i l i t i e s < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e ' ,   f o n t W e i g h t :   ' 7 0 0 '   } } >  
                                                         $ { ( m . t c l   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                              
                                             { / *   L o n g - t e r m   L i a b i l i t i e s   * / }  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } > L o n g - t e r m   D e b t < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                         $ { ( m . l t d   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 3 p x   s o l i d   # f 5 9 e 0 b ' ,   b a c k g r o u n d :   ' # f e f 9 c 3 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 1 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 4 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' # f e f 9 c 3 ' ,   z I n d e x :   1   } } > T O T A L   L I A B I L I T I E S < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         $ { ( m . t o t a l L i a b   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                              
                                             { / *   E q u i t y   * / }  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 ' ,   b a c k g r o u n d :   ' # f 0 f d f 4 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' # f 0 f d f 4 ' ,   z I n d e x :   1   } } > E Q U I T Y < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x '   } } > < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 3 p x   s o l i d   # 1 0 b 9 8 1 ' ,   b a c k g r o u n d :   ' # f 0 f d f 4 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 1 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 4 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' # f 0 f d f 4 ' ,   z I n d e x :   1   } } > T O T A L   E Q U I T Y < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                     < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         $ { ( m . t o t a l E q u i t y   | |   0 ) . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                     < / t d >  
                                                 ) ) }  
                                             < / t r >  
                                              
                                             { / *   T o t a l   L i a b i l i t i e s   &   E q u i t y   C h e c k   * / }  
                                             < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 4 p x   d o u b l e   # 4 7 5 5 6 9 ' ,   b a c k g r o u n d :   ' # e 2 e 8 f 0 '   } } >  
                                                 < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x   1 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 5 p x ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' # e 2 e 8 f 0 ' ,   z I n d e x :   1   } } > T O T A L   L I A B I L I T I E S   &   E Q U I T Y < / t d >  
                                                 { m o n t h l y . s l i c e ( - 3 6 ) . m a p ( ( m :   a n y ,   i d x :   n u m b e r )   = >   {  
                                                     c o n s t   t o t a l L E   =   ( m . t o t a l L i a b   | |   0 )   +   ( m . t o t a l E q u i t y   | |   0 ) ;  
                                                     r e t u r n   (  
                                                         < t d   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 1 2 p x   1 0 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 5 p x '   } } >  
                                                             $ { t o t a l L E . t o L o c a l e S t r i n g ( ' e n - U S ' ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                         < / t d >  
                                                     ) ;  
                                                 } ) }  
                                             < / t r >  
                                         < / t b o d y >  
                                     < / t a b l e >  
                                 < / d i v >  
                             < / d i v >  
                         < / >  
                     ) }  
                 < / d i v >  
             ) }  
  
             { / *   T r e n d   A n a l y s i s   V i e w   * / }  
             { c u r r e n t V i e w   = = =   ' t r e n d - a n a l y s i s '   & &   s e l e c t e d C o m p a n y I d   & &   m o n t h l y . l e n g t h   >   0   & &   (  
                 < d i v   s t y l e = { {   m a x W i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 3 2 p x   3 2 p x   3 2 p x   1 6 p x '   } } >  
                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                         < h 1   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n :   0   } } > T r e n d   A n a l y s i s < / h 1 >  
                         { c o m p a n y N a m e   & &   < d i v   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > { c o m p a n y N a m e } < / d i v > }  
                     < / d i v >  
  
                     { / *   T a b s   * / }  
                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 1 2 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                         < b u t t o n    
                             o n C l i c k = { ( )   = >   s e t T r e n d A n a l y s i s T a b ( ' i t e m - t r e n d s ' ) }  
                             s t y l e = { {    
                                 p a d d i n g :   ' 1 2 p x   2 4 p x ' ,    
                                 b a c k g r o u n d :   ' n o n e ' ,    
                                 b o r d e r :   ' n o n e ' ,    
                                 f o n t S i z e :   ' 1 6 p x ' ,    
                                 f o n t W e i g h t :   ' 6 0 0 ' ,    
                                 c o l o r :   t r e n d A n a l y s i s T a b   = = =   ' i t e m - t r e n d s '   ?   ' # 6 6 7 e e a '   :   ' # 6 4 7 4 8 b ' ,    
                                 c u r s o r :   ' p o i n t e r ' ,  
                                 b o r d e r B o t t o m :   t r e n d A n a l y s i s T a b   = = =   ' i t e m - t r e n d s '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t ' ,  
                                 m a r g i n B o t t o m :   ' - 2 p x '  
                             } }  
                         >  
                             I t e m   T r e n d s  
                         < / b u t t o n >  
                         < b u t t o n    
                             o n C l i c k = { ( )   = >   s e t T r e n d A n a l y s i s T a b ( ' e x p e n s e - a n a l y s i s ' ) }  
                             s t y l e = { {    
                                 p a d d i n g :   ' 1 2 p x   2 4 p x ' ,    
                                 b a c k g r o u n d :   ' n o n e ' ,    
                                 b o r d e r :   ' n o n e ' ,    
                                 f o n t S i z e :   ' 1 6 p x ' ,    
                                 f o n t W e i g h t :   ' 6 0 0 ' ,    
                                 c o l o r :   t r e n d A n a l y s i s T a b   = = =   ' e x p e n s e - a n a l y s i s '   ?   ' # 6 6 7 e e a '   :   ' # 6 4 7 4 8 b ' ,    
                                 c u r s o r :   ' p o i n t e r ' ,  
                                 b o r d e r B o t t o m :   t r e n d A n a l y s i s T a b   = = =   ' e x p e n s e - a n a l y s i s '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t ' ,  
                                 m a r g i n B o t t o m :   ' - 2 p x '  
                             } }  
                         >  
                             E x p e n s e   A n a l y s i s  
                         < / b u t t o n >  
                     < / d i v >  
  
                     { / *   I t e m   T r e n d s   T a b   * / }  
                     { t r e n d A n a l y s i s T a b   = = =   ' i t e m - t r e n d s '   & &   (  
                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                                 < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                     S e l e c t   I t e m   t o   A n a l y z e :  
                                 < / l a b e l >  
                                 < s e l e c t    
                                     v a l u e = { s e l e c t e d T r e n d I t e m }    
                                     o n C h a n g e = { ( e )   = >   s e t S e l e c t e d T r e n d I t e m ( e . t a r g e t . v a l u e ) }  
                                     s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   m a x W i d t h :   ' 4 0 0 p x ' ,   p a d d i n g :   ' 1 2 p x   1 6 p x ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c u r s o r :   ' p o i n t e r ' ,   f o n t W e i g h t :   ' 5 0 0 '   } }  
                                 >  
                                     < o p t g r o u p   l a b e l = " I n c o m e   S t a t e m e n t " >  
                                         < o p t i o n   v a l u e = " r e v e n u e " > T o t a l   R e v e n u e < / o p t i o n >  
                                         < o p t i o n   v a l u e = " e x p e n s e " > T o t a l   E x p e n s e s < / o p t i o n >  
                                         { m a p p i n g . c o g s T o t a l   & &   < o p t i o n   v a l u e = " c o g s T o t a l " > C O G S   T o t a l < / o p t i o n > }  
                                         { m a p p i n g . c o g s P a y r o l l   & &   < o p t i o n   v a l u e = " c o g s P a y r o l l " > C O G S   P a y r o l l < / o p t i o n > }  
                                         { m a p p i n g . c o g s O w n e r P a y   & &   < o p t i o n   v a l u e = " c o g s O w n e r P a y " > C O G S   O w n e r   P a y < / o p t i o n > }  
                                         { m a p p i n g . c o g s C o n t r a c t o r s   & &   < o p t i o n   v a l u e = " c o g s C o n t r a c t o r s " > C O G S   C o n t r a c t o r s < / o p t i o n > }  
                                         { m a p p i n g . c o g s M a t e r i a l s   & &   < o p t i o n   v a l u e = " c o g s M a t e r i a l s " > C O G S   M a t e r i a l s < / o p t i o n > }  
                                         { m a p p i n g . c o g s C o m m i s s i o n s   & &   < o p t i o n   v a l u e = " c o g s C o m m i s s i o n s " > C O G S   C o m m i s s i o n s < / o p t i o n > }  
                                         { m a p p i n g . c o g s O t h e r   & &   < o p t i o n   v a l u e = " c o g s O t h e r " > C O G S   O t h e r < / o p t i o n > }  
                                         { m a p p i n g . o p e x S a l e s M a r k e t i n g   & &   < o p t i o n   v a l u e = " o p e x S a l e s M a r k e t i n g " > S a l e s   &   M a r k e t i n g < / o p t i o n > }  
                                         { m a p p i n g . r e n t L e a s e   & &   < o p t i o n   v a l u e = " r e n t L e a s e " > R e n t / L e a s e < / o p t i o n > }  
                                         { m a p p i n g . u t i l i t i e s   & &   < o p t i o n   v a l u e = " u t i l i t i e s " > U t i l i t i e s < / o p t i o n > }  
                                         { m a p p i n g . e q u i p m e n t   & &   < o p t i o n   v a l u e = " e q u i p m e n t " > E q u i p m e n t < / o p t i o n > }  
                                         { m a p p i n g . t r a v e l   & &   < o p t i o n   v a l u e = " t r a v e l " > T r a v e l < / o p t i o n > }  
                                         { m a p p i n g . p r o f e s s i o n a l S e r v i c e s   & &   < o p t i o n   v a l u e = " p r o f e s s i o n a l S e r v i c e s " > P r o f e s s i o n a l   S e r v i c e s < / o p t i o n > }  
                                         { m a p p i n g . i n s u r a n c e   & &   < o p t i o n   v a l u e = " i n s u r a n c e " > I n s u r a n c e < / o p t i o n > }  
                                         { m a p p i n g . o p e x O t h e r   & &   < o p t i o n   v a l u e = " o p e x O t h e r " > O P E X   O t h e r < / o p t i o n > }  
                                         { m a p p i n g . o p e x P a y r o l l   & &   < o p t i o n   v a l u e = " o p e x P a y r o l l " > O P E X   P a y r o l l < / o p t i o n > }  
                                         { m a p p i n g . o w n e r s B a s e P a y   & &   < o p t i o n   v a l u e = " o w n e r s B a s e P a y " > O w n e r s   B a s e   P a y < / o p t i o n > }  
                                         { m a p p i n g . o w n e r s R e t i r e m e n t   & &   < o p t i o n   v a l u e = " o w n e r s R e t i r e m e n t " > O w n e r s   R e t i r e m e n t < / o p t i o n > }  
                                         { m a p p i n g . c o n t r a c t o r s D i s t r i b u t i o n   & &   < o p t i o n   v a l u e = " c o n t r a c t o r s D i s t r i b u t i o n " > C o n t r a c t o r s / D i s t r i b u t i o n < / o p t i o n > }  
                                         { m a p p i n g . i n t e r e s t E x p e n s e   & &   < o p t i o n   v a l u e = " i n t e r e s t E x p e n s e " > I n t e r e s t   E x p e n s e < / o p t i o n > }  
                                         { m a p p i n g . d e p r e c i a t i o n E x p e n s e   & &   < o p t i o n   v a l u e = " d e p r e c i a t i o n E x p e n s e " > D e p r e c i a t i o n   E x p e n s e < / o p t i o n > }  
                                         { m a p p i n g . o p e r a t i n g E x p e n s e T o t a l   & &   < o p t i o n   v a l u e = " o p e r a t i n g E x p e n s e T o t a l " > O p e r a t i n g   E x p e n s e   T o t a l < / o p t i o n > }  
                                         { m a p p i n g . n o n O p e r a t i n g I n c o m e   & &   < o p t i o n   v a l u e = " n o n O p e r a t i n g I n c o m e " > N o n - O p e r a t i n g   I n c o m e < / o p t i o n > }  
                                         { m a p p i n g . e x t r a o r d i n a r y I t e m s   & &   < o p t i o n   v a l u e = " e x t r a o r d i n a r y I t e m s " > E x t r a o r d i n a r y   I t e m s < / o p t i o n > }  
                                         { m a p p i n g . n e t P r o f i t   & &   < o p t i o n   v a l u e = " n e t P r o f i t " > N e t   P r o f i t < / o p t i o n > }  
                                     < / o p t g r o u p >  
                                     < o p t g r o u p   l a b e l = " B a l a n c e   S h e e t   -   A s s e t s " >  
                                         < o p t i o n   v a l u e = " t o t a l A s s e t s " > T o t a l   A s s e t s < / o p t i o n >  
                                         < o p t i o n   v a l u e = " c a s h " > C a s h < / o p t i o n >  
                                         < o p t i o n   v a l u e = " a r " > A c c o u n t s   R e c e i v a b l e < / o p t i o n >  
                                         < o p t i o n   v a l u e = " i n v e n t o r y " > I n v e n t o r y < / o p t i o n >  
                                         { m a p p i n g . o t h e r C A   & &   < o p t i o n   v a l u e = " o t h e r C A " > O t h e r   C u r r e n t   A s s e t s < / o p t i o n > }  
                                         { m a p p i n g . t c a   & &   < o p t i o n   v a l u e = " t c a " > T o t a l   C u r r e n t   A s s e t s < / o p t i o n > }  
                                         { m a p p i n g . f i x e d A s s e t s   & &   < o p t i o n   v a l u e = " f i x e d A s s e t s " > F i x e d   A s s e t s < / o p t i o n > }  
                                         { m a p p i n g . o t h e r A s s e t s   & &   < o p t i o n   v a l u e = " o t h e r A s s e t s " > O t h e r   A s s e t s < / o p t i o n > }  
                                     < / o p t g r o u p >  
                                     < o p t g r o u p   l a b e l = " B a l a n c e   S h e e t   -   L i a b i l i t i e s " >  
                                         < o p t i o n   v a l u e = " t o t a l L i a b " > T o t a l   L i a b i l i t i e s < / o p t i o n >  
                                         < o p t i o n   v a l u e = " a p " > A c c o u n t s   P a y a b l e < / o p t i o n >  
                                         { m a p p i n g . o t h e r C L   & &   < o p t i o n   v a l u e = " o t h e r C L " > O t h e r   C u r r e n t   L i a b i l i t i e s < / o p t i o n > }  
                                         { m a p p i n g . t c l   & &   < o p t i o n   v a l u e = " t c l " > T o t a l   C u r r e n t   L i a b i l i t i e s < / o p t i o n > }  
                                         { m a p p i n g . l t d   & &   < o p t i o n   v a l u e = " l t d " > L o n g   T e r m   D e b t < / o p t i o n > }  
                                     < / o p t g r o u p >  
                                     < o p t g r o u p   l a b e l = " B a l a n c e   S h e e t   -   E q u i t y " >  
                                         < o p t i o n   v a l u e = " t o t a l E q u i t y " > T o t a l   E q u i t y < / o p t i o n >  
                                     < / o p t g r o u p >  
                                 < / s e l e c t >  
                             < / d i v >  
  
                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 2 0 p x ' ,   a l i g n I t e m s :   ' f l e x - s t a r t '   } } >  
                                 < d i v   s t y l e = { {   f l e x :   1 ,   m i n W i d t h :   0   } } >  
                                     < L i n e C h a r t    
                                         t i t l e = { ` $ { s e l e c t e d T r e n d I t e m . c h a r A t ( 0 ) . t o U p p e r C a s e ( )   +   s e l e c t e d T r e n d I t e m . s l i c e ( 1 ) . r e p l a c e ( / ( [ A - Z ] ) / g ,   '   $ 1 ' ) }   T r e n d ` }  
                                         d a t a = { m o n t h l y . m a p ( m   = >   ( {   m o n t h :   m . m o n t h ,   v a l u e :   m [ s e l e c t e d T r e n d I t e m   a s   k e y o f   t y p e o f   m ]   a s   n u m b e r   } ) ) }  
                                         c o l o r = " # 6 6 7 e e a "  
                                         s h o w T a b l e = { t r u e }  
                                         l a b e l F o r m a t = " q u a r t e r l y "  
                                     / >  
                                 < / d i v >  
                                  
                                 < d i v   s t y l e = { {   w i d t h :   ' 2 8 0 p x ' ,   f l e x S h r i n k :   0   } } >  
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   p o s i t i o n :   ' s t i c k y ' ,   t o p :   ' 1 0 0 p x '   } } >  
                                         < h 3   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x ' ,   t e x t A l i g n :   ' c e n t e r '   } } > G r o w t h   A n a l y s i s < / h 3 >  
                                          
                                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 6 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   t e x t A l i g n :   ' c e n t e r '   } } > G R O W T H   R A T E < / d i v >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 0 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x ' ,   t e x t A l i g n :   ' c e n t e r '   } } > L a s t   Y e a r < / d i v >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   t e x t A l i g n :   ' c e n t e r ' ,   c o l o r :   m o n t h l y . l e n g t h   > =   2 4   ?    
                                                 ( ( )   = >   {  
                                                     c o n s t   l a s t 1 2   =   m o n t h l y . s l i c e ( - 1 2 ) . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m [ s e l e c t e d T r e n d I t e m   a s   k e y o f   t y p e o f   m ]   a s   n u m b e r   | |   0 ) ,   0 ) ;  
                                                     c o n s t   p r e v 1 2   =   m o n t h l y . s l i c e ( - 2 4 ,   - 1 2 ) . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m [ s e l e c t e d T r e n d I t e m   a s   k e y o f   t y p e o f   m ]   a s   n u m b e r   | |   0 ) ,   0 ) ;  
                                                     c o n s t   g r o w t h R a t e   =   p r e v 1 2   ! = =   0   ?   ( ( l a s t 1 2   -   p r e v 1 2 )   /   p r e v 1 2 )   *   1 0 0   :   0 ;  
                                                     r e t u r n   g r o w t h R a t e   > =   0   ?   ' # 1 0 b 9 8 1 '   :   ' # e f 4 4 4 4 ' ;  
                                                 } ) ( )  
                                                 :   ' # 6 4 7 4 8 b '  
                                             } } >  
                                                 { m o n t h l y . l e n g t h   > =   2 4   ?   ( ( )   = >   {  
                                                     c o n s t   l a s t 1 2   =   m o n t h l y . s l i c e ( - 1 2 ) . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m [ s e l e c t e d T r e n d I t e m   a s   k e y o f   t y p e o f   m ]   a s   n u m b e r   | |   0 ) ,   0 ) ;  
                                                     c o n s t   p r e v 1 2   =   m o n t h l y . s l i c e ( - 2 4 ,   - 1 2 ) . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m [ s e l e c t e d T r e n d I t e m   a s   k e y o f   t y p e o f   m ]   a s   n u m b e r   | |   0 ) ,   0 ) ;  
                                                     c o n s t   g r o w t h R a t e   =   p r e v 1 2   ! = =   0   ?   ( ( l a s t 1 2   -   p r e v 1 2 )   /   p r e v 1 2 )   *   1 0 0   :   0 ;  
                                                     r e t u r n   ` $ { g r o w t h R a t e   > =   0   ?   ' + '   :   ' ' } $ { g r o w t h R a t e . t o F i x e d ( 2 ) } % ` ;  
                                                 } ) ( )   :   ' N / A ' }  
                                             < / d i v >  
                                         < / d i v >  
  
                                         < d i v   s t y l e = { {   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   t e x t A l i g n :   ' c e n t e r '   } } > G R O W T H   R A T E < / d i v >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 0 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x ' ,   t e x t A l i g n :   ' c e n t e r '   } } > P r e v i o u s   Y e a r < / d i v >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   t e x t A l i g n :   ' c e n t e r ' ,   c o l o r :   m o n t h l y . l e n g t h   > =   3 6   ?    
                                                 ( ( )   = >   {  
                                                     c o n s t   p r e v 1 2   =   m o n t h l y . s l i c e ( - 2 4 ,   - 1 2 ) . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m [ s e l e c t e d T r e n d I t e m   a s   k e y o f   t y p e o f   m ]   a s   n u m b e r   | |   0 ) ,   0 ) ;  
                                                     c o n s t   p r e v 2 4   =   m o n t h l y . s l i c e ( - 3 6 ,   - 2 4 ) . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m [ s e l e c t e d T r e n d I t e m   a s   k e y o f   t y p e o f   m ]   a s   n u m b e r   | |   0 ) ,   0 ) ;  
                                                     c o n s t   g r o w t h R a t e   =   p r e v 2 4   ! = =   0   ?   ( ( p r e v 1 2   -   p r e v 2 4 )   /   p r e v 2 4 )   *   1 0 0   :   0 ;  
                                                     r e t u r n   g r o w t h R a t e   > =   0   ?   ' # 1 0 b 9 8 1 '   :   ' # e f 4 4 4 4 ' ;  
                                                 } ) ( )  
                                                 :   ' # 6 4 7 4 8 b '  
                                             } } >  
                                                 { m o n t h l y . l e n g t h   > =   3 6   ?   ( ( )   = >   {  
                                                     c o n s t   p r e v 1 2   =   m o n t h l y . s l i c e ( - 2 4 ,   - 1 2 ) . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m [ s e l e c t e d T r e n d I t e m   a s   k e y o f   t y p e o f   m ]   a s   n u m b e r   | |   0 ) ,   0 ) ;  
                                                     c o n s t   p r e v 2 4   =   m o n t h l y . s l i c e ( - 3 6 ,   - 2 4 ) . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m [ s e l e c t e d T r e n d I t e m   a s   k e y o f   t y p e o f   m ]   a s   n u m b e r   | |   0 ) ,   0 ) ;  
                                                     c o n s t   g r o w t h R a t e   =   p r e v 2 4   ! = =   0   ?   ( ( p r e v 1 2   -   p r e v 2 4 )   /   p r e v 2 4 )   *   1 0 0   :   0 ;  
                                                     r e t u r n   ` $ { g r o w t h R a t e   > =   0   ?   ' + '   :   ' ' } $ { g r o w t h R a t e . t o F i x e d ( 2 ) } % ` ;  
                                                 } ) ( )   :   ' N / A ' }  
                                             < / d i v >  
                                         < / d i v >  
                                     < / d i v >  
                                 < / d i v >  
                             < / d i v >  
                         < / d i v >  
                     ) }  
  
                     { / *   E x p e n s e   A n a l y s i s   T a b   * / }  
                     { t r e n d A n a l y s i s T a b   = = =   ' e x p e n s e - a n a l y s i s '   & &   (  
                         < d i v >  
                             < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > E x p e n s e   I t e m s   a s   %   o f   T o t a l   R e v e n u e < / h 2 >  
                              
                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' # f 0 f d f 4 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # 8 6 e f a c '   } } >  
                                 < h 3   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 6 6 5 3 4 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  x    H o w   t o   U s e   T h i s   A n a l y s i s < / h 3 >  
                                 < u l   s t y l e = { {   m a r g i n :   0 ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 1 5 8 0 3 d ' ,   l i n e H e i g h t :   ' 1 . 6 '   } } >  
                                     < l i > E a c h   c h a r t   s h o w s   a n   e x p e n s e   c a t e g o r y   a s   a   < s t r o n g > p e r c e n t a g e   o f   t o t a l   r e v e n u e < / s t r o n g >   o v e r   t i m e < / l i >  
                                     < l i > L o o k   f o r   c a t e g o r i e s   w i t h   < s t r o n g > i n c r e a s i n g   t r e n d s < / s t r o n g >   t h a t   m a y   n e e d   c o s t   c o n t r o l < / l i >  
                                     < l i > C o m p a r e   p e r c e n t a g e s   t o   i n d u s t r y   b e n c h m a r k s   t o   i d e n t i f y   i n e f f i c i e n c i e s < / l i >  
                                     < l i > W a t c h   f o r   s u d d e n   s p i k e s   t h a t   m a y   i n d i c a t e   o n e - t i m e   e v e n t s   o r   p r o b l e m s < / l i >  
                                 < / u l >  
                             < / d i v >  
  
                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( 2 ,   1 f r ) ' ,   g a p :   ' 2 4 p x '   } } >  
                                 { / *   T o t a l   E x p e n s e s   * / }  
                                 < L i n e C h a r t    
                                     t i t l e = " T o t a l   E x p e n s e s   ( %   o f   R e v e n u e ) "  
                                     d a t a = { m o n t h l y . m a p ( m   = >   ( {    
                                         m o n t h :   m . m o n t h ,    
                                         v a l u e :   m . r e v e n u e   >   0   ?   ( m . e x p e n s e   /   m . r e v e n u e )   *   1 0 0   :   0    
                                     } ) ) }  
                                     c o l o r = " # e f 4 4 4 4 "  
                                     c o m p a c t  
                                 / >  
  
                                 { / *   C O G S   T o t a l   * / }  
                                 { m a p p i n g . c o g s T o t a l   & &   (  
                                     < L i n e C h a r t    
                                         t i t l e = " C O G S   T o t a l   ( %   o f   R e v e n u e ) "  
                                         d a t a = { m o n t h l y . m a p ( m   = >   ( {    
                                             m o n t h :   m . m o n t h ,    
                                             v a l u e :   m . r e v e n u e   >   0   ?   ( ( m . c o g s T o t a l   | |   0 )   /   m . r e v e n u e )   *   1 0 0   :   0    
                                         } ) ) }  
                                         c o l o r = " # f 5 9 e 0 b "  
                                         c o m p a c t  
                                     / >  
                                 ) }  
  
                                 { / *   C O G S   B r e a k d o w n   * / }  
                                 { m a p p i n g . c o g s P a y r o l l   & &   (  
                                     < L i n e C h a r t    
                                         t i t l e = " C O G S   P a y r o l l   ( %   o f   R e v e n u e ) "  
                                         d a t a = { m o n t h l y . m a p ( m   = >   ( {    
                                             m o n t h :   m . m o n t h ,    
                                             v a l u e :   m . r e v e n u e   >   0   ?   ( ( m . c o g s P a y r o l l   | |   0 )   /   m . r e v e n u e )   *   1 0 0   :   0    
                                         } ) ) }  
                                         c o l o r = " # f b 9 2 3 c "  
                                         c o m p a c t  
                                     / >  
                                 ) }  
  
                                 { m a p p i n g . c o g s O w n e r P a y   & &   (  
                                     < L i n e C h a r t    
                                         t i t l e = " C O G S   O w n e r   P a y   ( %   o f   R e v e n u e ) "  
                                         d a t a = { m o n t h l y . m a p ( m   = >   ( {    
                                             m o n t h :   m . m o n t h ,    
                                             v a l u e :   m . r e v e n u e   >   0   ?   ( ( m . c o g s O w n e r P a y   | |   0 )   /   m . r e v e n u e )   *   1 0 0   :   0    
                                         } ) ) }  
                                         c o l o r = " # f d b a 7 4 "  
                                         c o m p a c t  
                                     / >  
                                 ) }  
  
                                 { m a p p i n g . c o g s C o n t r a c t o r s   & &   (  
                                     < L i n e C h a r t    
                                         t i t l e = " C O G S   C o n t r a c t o r s   ( %   o f   R e v e n u e ) "  
                                         d a t a = { m o n t h l y . m a p ( m   = >   ( {    
                                             m o n t h :   m . m o n t h ,    
                                             v a l u e :   m . r e v e n u e   >   0   ?   ( ( m . c o g s C o n t r a c t o r s   | |   0 )   /   m . r e v e n u e )   *   1 0 0   :   0    
                                         } ) ) }  
                                         c o l o r = " # f e d 7 a a "  
                                         c o m p a c t  
                                     / >  
                                 ) }  
                                  
                                 { m a p p i n g . c o g s M a t e r i a l s   & &   (  
                                     < L i n e C h a r t    
                                         t i t l e = " C O G S   M a t e r i a l s   ( %   o f   R e v e n u e ) "  
                                         d a t a = { m o n t h l y . m a p ( m   = >   ( {    
                                             m o n t h :   m . m o n t h ,    
                                             v a l u e :   m . r e v e n u e   >   0   ?   ( ( m . c o g s M a t e r i a l s   | |   0 )   /   m . r e v e n u e )   *   1 0 0   :   0    
                                         } ) ) }  
                                         c o l o r = " # f d e 0 4 7 "  
                                         c o m p a c t  
                                     / >  
                                 ) }  
                                  
                                 { m a p p i n g . c o g s C o m m i s s i o n s   & &   (  
                                     < L i n e C h a r t    
                                         t i t l e = " C O G S   C o m m i s s i o n s   ( %   o f   R e v e n u e ) "  
                                         d a t a = { m o n t h l y . m a p ( m   = >   ( {    
                                             m o n t h :   m . m o n t h ,    
                                             v a l u e :   m . r e v e n u e   >   0   ?   ( ( m . c o g s C o m m i s s i o n s   | |   0 )   /   m . r e v e n u e )   *   1 0 0   :   0    
                                         } ) ) }  
                                         c o l o r = " # b e f 2 6 4 "  
                                         c o m p a c t  
                                     / >  
                                 ) }  
                                  
                                 { m a p p i n g . c o g s O t h e r   & &   (  
                                     < L i n e C h a r t    
                                         t i t l e = " C O G S   O t h e r   ( %   o f   R e v e n u e ) "  
                                         d a t a = { m o n t h l y . m a p ( m   = >   ( {    
                                             m o n t h :   m . m o n t h ,    
                                             v a l u e :   m . r e v e n u e   >   0   ?   ( ( m . c o g s O t h e r   | |   0 )   /   m . r e v e n u e )   *   1 0 0   :   0    
                                         } ) ) }  
                                         c o l o r = " # 8 6 e f a c "  
                                         c o m p a c t  
                                     / >  
                                 ) }  
                                  
                                 { m a p p i n g . o p e r a t i n g E x p e n s e T o t a l   & &   (  
                                     < L i n e C h a r t    
                                         t i t l e = " O p e r a t i n g   E x p e n s e   T o t a l   ( %   o f   R e v e n u e ) "  
                                         d a t a = { m o n t h l y . m a p ( m   = >   ( {    
                                             m o n t h :   m . m o n t h ,    
                                             v a l u e :   m . r e v e n u e   >   0   ?   ( ( m . o p e r a t i n g E x p e n s e T o t a l   | |   0 )   /   m . r e v e n u e )   *   1 0 0   :   0    
                                         } ) ) }  
                                         c o l o r = " # 3 b 8 2 f 6 "  
                                         c o m p a c t  
                                     / >  
                                 ) }  
                                  
                                 { m a p p i n g . o p e x P a y r o l l   & &   (  
                                     < L i n e C h a r t    
                                         t i t l e = " O P E X   P a y r o l l   ( %   o f   R e v e n u e ) "  
                                         d a t a = { m o n t h l y . m a p ( m   = >   ( {    
                                             m o n t h :   m . m o n t h ,    
                                             v a l u e :   m . r e v e n u e   >   0   ?   ( ( m . o p e x P a y r o l l   | |   0 )   /   m . r e v e n u e )   *   1 0 0   :   0    
                                         } ) ) }  
                                         c o l o r = " # 6 0 a 5 f a "  
                                         c o m p a c t  
                                     / >  
                                 ) }  
                                  
                                 { m a p p i n g . o p e x S a l e s M a r k e t i n g   & &   (  
                                     < L i n e C h a r t    
                                         t i t l e = " S a l e s   &   M a r k e t i n g   ( %   o f   R e v e n u e ) "  
                                         d a t a = { m o n t h l y . m a p ( m   = >   ( {    
                                             m o n t h :   m . m o n t h ,    
                                             v a l u e :   m . r e v e n u e   >   0   ?   ( ( m . o p e x S a l e s M a r k e t i n g   | |   0 )   /   m . r e v e n u e )   *   1 0 0   :   0    
                                         } ) ) }  
                                         c o l o r = " # 9 3 c 5 f d "  
                                         c o m p a c t  
                                     / >  
                                 ) }  
                                  
                                 { m a p p i n g . r e n t L e a s e   & &   (  
                                     < L i n e C h a r t    
                                         t i t l e = " R e n t / L e a s e   ( %   o f   R e v e n u e ) "  
                                         d a t a = { m o n t h l y . m a p ( m   = >   ( {    
                                             m o n t h :   m . m o n t h ,    
                                             v a l u e :   m . r e v e n u e   >   0   ?   ( ( m . r e n t L e a s e   | |   0 )   /   m . r e v e n u e )   *   1 0 0   :   0    
                                         } ) ) }  
                                         c o l o r = " # 8 b 5 c f 6 "  
                                         c o m p a c t  
                                     / >  
                                 ) }  
                                  
                                 { m a p p i n g . u t i l i t i e s   & &   (  
                                     < L i n e C h a r t    
                                         t i t l e = " U t i l i t i e s   ( %   o f   R e v e n u e ) "  
                                         d a t a = { m o n t h l y . m a p ( m   = >   ( {    
                                             m o n t h :   m . m o n t h ,    
                                             v a l u e :   m . r e v e n u e   >   0   ?   ( ( m . u t i l i t i e s   | |   0 )   /   m . r e v e n u e )   *   1 0 0   :   0    
                                         } ) ) }  
                                         c o l o r = " # a 7 8 b f a "  
                                         c o m p a c t  
                                     / >  
                                 ) }  
                                  
                                 { m a p p i n g . e q u i p m e n t   & &   (  
                                     < L i n e C h a r t    
                                         t i t l e = " E q u i p m e n t   ( %   o f   R e v e n u e ) "  
                                         d a t a = { m o n t h l y . m a p ( m   = >   ( {    
                                             m o n t h :   m . m o n t h ,    
                                             v a l u e :   m . r e v e n u e   >   0   ?   ( ( m . e q u i p m e n t   | |   0 )   /   m . r e v e n u e )   *   1 0 0   :   0    
                                         } ) ) }  
                                         c o l o r = " # c 4 b 5 f d "  
                                         c o m p a c t  
                                     / >  
                                 ) }  
                                  
                                 { m a p p i n g . t r a v e l   & &   (  
                                     < L i n e C h a r t    
                                         t i t l e = " T r a v e l   ( %   o f   R e v e n u e ) "  
                                         d a t a = { m o n t h l y . m a p ( m   = >   ( {    
                                             m o n t h :   m . m o n t h ,    
                                             v a l u e :   m . r e v e n u e   >   0   ?   ( ( m . t r a v e l   | |   0 )   /   m . r e v e n u e )   *   1 0 0   :   0    
                                         } ) ) }  
                                         c o l o r = " # e c 4 8 9 9 "  
                                         c o m p a c t  
                                     / >  
                                 ) }  
                                  
                                 { m a p p i n g . p r o f e s s i o n a l S e r v i c e s   & &   (  
                                     < L i n e C h a r t    
                                         t i t l e = " P r o f e s s i o n a l   S e r v i c e s   ( %   o f   R e v e n u e ) "  
                                         d a t a = { m o n t h l y . m a p ( m   = >   ( {    
                                             m o n t h :   m . m o n t h ,    
                                             v a l u e :   m . r e v e n u e   >   0   ?   ( ( m . p r o f e s s i o n a l S e r v i c e s   | |   0 )   /   m . r e v e n u e )   *   1 0 0   :   0    
                                         } ) ) }  
                                         c o l o r = " # f 4 7 2 b 6 "  
                                         c o m p a c t  
                                     / >  
                                 ) }  
                                  
                                 { m a p p i n g . i n s u r a n c e   & &   (  
                                     < L i n e C h a r t    
                                         t i t l e = " I n s u r a n c e   ( %   o f   R e v e n u e ) "  
                                         d a t a = { m o n t h l y . m a p ( m   = >   ( {    
                                             m o n t h :   m . m o n t h ,    
                                             v a l u e :   m . r e v e n u e   >   0   ?   ( ( m . i n s u r a n c e   | |   0 )   /   m . r e v e n u e )   *   1 0 0   :   0    
                                         } ) ) }  
                                         c o l o r = " # f 9 a 8 d 4 "  
                                         c o m p a c t  
                                     / >  
                                 ) }  
                                  
                                 { m a p p i n g . o w n e r s B a s e P a y   & &   (  
                                     < L i n e C h a r t    
                                         t i t l e = " O w n e r s   B a s e   P a y   ( %   o f   R e v e n u e ) "  
                                         d a t a = { m o n t h l y . m a p ( m   = >   ( {    
                                             m o n t h :   m . m o n t h ,    
                                             v a l u e :   m . r e v e n u e   >   0   ?   ( ( m . o w n e r s B a s e P a y   | |   0 )   /   m . r e v e n u e )   *   1 0 0   :   0    
                                         } ) ) }  
                                         c o l o r = " # 1 4 b 8 a 6 "  
                                         c o m p a c t  
                                     / >  
                                 ) }  
                                  
                                 { m a p p i n g . o w n e r s R e t i r e m e n t   & &   (  
                                     < L i n e C h a r t    
                                         t i t l e = " O w n e r s   R e t i r e m e n t   ( %   o f   R e v e n u e ) "  
                                         d a t a = { m o n t h l y . m a p ( m   = >   ( {    
                                             m o n t h :   m . m o n t h ,    
                                             v a l u e :   m . r e v e n u e   >   0   ?   ( ( m . o w n e r s R e t i r e m e n t   | |   0 )   /   m . r e v e n u e )   *   1 0 0   :   0    
                                         } ) ) }  
                                         c o l o r = " # 2 d d 4 b f "  
                                         c o m p a c t  
                                     / >  
                                 ) }  
                                  
                                 { m a p p i n g . c o n t r a c t o r s D i s t r i b u t i o n   & &   (  
                                     < L i n e C h a r t    
                                         t i t l e = " C o n t r a c t o r s / D i s t r i b u t i o n   ( %   o f   R e v e n u e ) "  
                                         d a t a = { m o n t h l y . m a p ( m   = >   ( {    
                                             m o n t h :   m . m o n t h ,    
                                             v a l u e :   m . r e v e n u e   >   0   ?   ( ( m . c o n t r a c t o r s D i s t r i b u t i o n   | |   0 )   /   m . r e v e n u e )   *   1 0 0   :   0    
                                         } ) ) }  
                                         c o l o r = " # 5 e e a d 4 "  
                                         c o m p a c t  
                                     / >  
                                 ) }  
                                  
                                 { m a p p i n g . i n t e r e s t E x p e n s e   & &   (  
                                     < L i n e C h a r t    
                                         t i t l e = " I n t e r e s t   E x p e n s e   ( %   o f   R e v e n u e ) "  
                                         d a t a = { m o n t h l y . m a p ( m   = >   ( {    
                                             m o n t h :   m . m o n t h ,    
                                             v a l u e :   m . r e v e n u e   >   0   ?   ( ( m . i n t e r e s t E x p e n s e   | |   0 )   /   m . r e v e n u e )   *   1 0 0   :   0    
                                         } ) ) }  
                                         c o l o r = " # f b 7 1 8 5 "  
                                         c o m p a c t  
                                     / >  
                                 ) }  
                                  
                                 { m a p p i n g . d e p r e c i a t i o n E x p e n s e   & &   (  
                                     < L i n e C h a r t    
                                         t i t l e = " D e p r e c i a t i o n   E x p e n s e   ( %   o f   R e v e n u e ) "  
                                         d a t a = { m o n t h l y . m a p ( m   = >   ( {    
                                             m o n t h :   m . m o n t h ,    
                                             v a l u e :   m . r e v e n u e   >   0   ?   ( ( m . d e p r e c i a t i o n E x p e n s e   | |   0 )   /   m . r e v e n u e )   *   1 0 0   :   0    
                                         } ) ) }  
                                         c o l o r = " # f c a 5 a 5 "  
                                         c o m p a c t  
                                     / >  
                                 ) }  
                                  
                                 { m a p p i n g . o p e x O t h e r   & &   (  
                                     < L i n e C h a r t    
                                         t i t l e = " O P E X   O t h e r   ( %   o f   R e v e n u e ) "  
                                         d a t a = { m o n t h l y . m a p ( m   = >   ( {    
                                             m o n t h :   m . m o n t h ,    
                                             v a l u e :   m . r e v e n u e   >   0   ?   ( ( m . o p e x O t h e r   | |   0 )   /   m . r e v e n u e )   *   1 0 0   :   0    
                                         } ) ) }  
                                         c o l o r = " # f e c a c a "  
                                         c o m p a c t  
                                     / >  
                                 ) }  
                             < / d i v >  
                         < / d i v >  
                     ) }  
                 < / d i v >  
             ) }  
  
             { / *   F i n a n c i a l   S c o r e   -   I n t r o d u c t i o n   V i e w   * / }  
             { c u r r e n t V i e w   = = =   ' f s - i n t r o '   & &   (  
                 < d i v   s t y l e = { {   m a x W i d t h :   ' 1 2 0 0 p x ' ,   m a r g i n :   ' 0   a u t o ' ,   p a d d i n g :   ' 3 2 p x '   } } >  
                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 4 0 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                         < h 1   s t y l e = { {   f o n t S i z e :   ' 3 6 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 3 2 p x ' ,   t e x t A l i g n :   ' c e n t e r '   } } > I n t r o d u c t i o n   t o   t h e   V e n t u r i s   F i n a n c i a l   S c o r e < / h 1 >  
                          
                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   l i n e H e i g h t :   ' 1 . 8 ' ,   m a x W i d t h :   ' 9 0 0 p x ' ,   m a r g i n :   ' 0   a u t o '   } } >  
                             < p   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                                 W e   w o u l d   l i k e   t o   i n t r o d u c e   t o   y o u   t h e   e m e r g i n g   s t a n d a r d   s c o r e   f o r   s m a l l   a n d   m e d i u m   b u s i n e s s e s .   I t   i s   c a l l e d   t h e   < s t r o n g > V e n t u r i s   F i n a n c i a l   S c o r e   ( V F S ) < / s t r o n g > .   O n   a   s c a l e   o f   1   t o   1 0 0 ,   1 0 0   i n d i c a t e s   a   c o m p a n y   t h a t   i s   f i r i n g   o n   a l l   c y l i n d e r s   a n d   b u i l d i n g   v a l u e   a t   a   s t e a d y   c l i p ;   a   s c o r e   o f   z e r o   i n d i c a t e s   n o   o p e r a t i o n s .   T h e   s c o r e s   i n   b e t w e e n   h a v e   a   l o t   t o   s a y   a b o u t   t h e   g e n e r a l   h e a l t h   o f   a n y   c o m p a n y   b e i n g   m e a s u r e d .  
                             < / p >  
                              
                             < p   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                                 T h e   s c o r e   t e l l s   a   l o t   a b o u t   a   c o m p a n y ' s   f i n a n c i a l   s t a b i l i t y   a n d   t h e i r   p o t e n t i a l   v a l u e   i n   t h e   m a r k e t   r e g a r d l e s s   o f   s p e c i f i c   i n d u s t r y .  
                             < / p >  
                              
                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                                 < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > A p p r o x i m a t e   I n t e r p r e t a t i o n   o f   V e n t u r i s   F i n a n c i a l   S c o r e s : < / h 2 >  
                                  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g a p :   ' 2 0 p x '   } } >  
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' # d 1 f a e 5 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b o r d e r :   ' 2 p x   s o l i d   # 1 0 b 9 8 1 '   } } >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 0 6 5 f 4 6 ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > 7 0        1 0 0 :   S t r o n g   F i n a n c i a l   P e r f o r m a n c e < / d i v >  
                                         < u l   s t y l e = { {   m a r g i n :   0 ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   c o l o r :   ' # 0 6 4 e 3 b ' ,   f o n t S i z e :   ' 1 5 p x ' ,   l i n e H e i g h t :   ' 1 . 6 '   } } >  
                                             < l i > G o o d   g r o w t h   a n d   g o o d   b a l a n c e < / l i >  
                                             < l i > I n   a   g o o d   p o s i t i o n   f o r   c o n s i d e r i n g   a n   M & A   t r a n s a c t i o n < / l i >  
                                             < l i > E x c e l l e n t   t i m e   t o   e x p a n d   o f f e r i n g s   a n d   i n v e s t   i n   R & D < / l i >  
                                         < / u l >  
                                     < / d i v >  
                                      
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' # d b e a f e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b o r d e r :   ' 2 p x   s o l i d   # 3 b 8 2 f 6 '   } } >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > 5 0        7 0 :   G o o d   F u n d a m e n t a l s < / d i v >  
                                         < u l   s t y l e = { {   m a r g i n :   0 ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   c o l o r :   ' # 1 e 3 a 8 a ' ,   f o n t S i z e :   ' 1 5 p x ' ,   l i n e H e i g h t :   ' 1 . 6 '   } } >  
                                             < l i > I n   a   g o o d   p o s i t i o n   f o r   r e v e n u e   g r o w t h < / l i >  
                                             < l i > N e e d s   t o   f o c u s   o n   b r i n g i n g   c o s t s   d o w n   a s   v o l u m e   g r o w s < / l i >  
                                         < / u l >  
                                     < / d i v >  
                                      
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f e f 3 c 7 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b o r d e r :   ' 2 p x   s o l i d   # f 5 9 e 0 b '   } } >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 9 2 4 0 0 e ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > 3 0        5 0 :   B a s i c   P r o b l e m s < / d i v >  
                                         < u l   s t y l e = { {   m a r g i n :   0 ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   c o l o r :   ' # 7 8 3 5 0 f ' ,   f o n t S i z e :   ' 1 5 p x ' ,   l i n e H e i g h t :   ' 1 . 6 '   } } >  
                                             < l i > C o s t   s t r u c t u r e   i s s u e s ;   n o t   i n   a   p o s i t i o n   t o   g r o w < / l i >  
                                             < l i > I m p r o v e m e n t s   n e e d e d   i n   o p e r a t i o n s   a n d   p r o c e s s   c o n t r o l s < / l i >  
                                             < l i > G r o w t h   w i t h o u t   o p e r a t i n g   i m p r o v e m e n t s   c o u l d   d o   s i g n i f i c a n t   h a r m < / l i >  
                                         < / u l >  
                                     < / d i v >  
                                      
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f e e 2 e 2 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b o r d e r :   ' 2 p x   s o l i d   # e f 4 4 4 4 '   } } >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 9 9 1 b 1 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > 0        3 0 :   S e r i o u s   P e r f o r m a n c e   P r o b l e m s < / d i v >  
                                         < u l   s t y l e = { {   m a r g i n :   0 ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   c o l o r :   ' # 7 f 1 d 1 d ' ,   f o n t S i z e :   ' 1 5 p x ' ,   l i n e H e i g h t :   ' 1 . 6 '   } } >  
                                             < l i > P r o b l e m s   e x i s t   w h i c h   m a y   n o t   b e   c o r r e c t a b l e < / l i >  
                                             < l i > S o m e   f o r m   o f   m a j o r   r e s t r u c t u r i n g   o r   l i q u i d a t i o n   m a y   b e   b e s t < / l i >  
                                         < / u l >  
                                     < / d i v >  
                                 < / d i v >  
                             < / d i v >  
                              
                             < p   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                                 T h e s e   s c o r e s   a r e   b o t h   < s t r o n g > d i a g n o s t i c < / s t r o n g >   a n d   < s t r o n g > p r e s c r i p t i v e < / s t r o n g > .   T h e y   a r e   d i a g n o s t i c   i n   t h a t   t h e y   i d e n t i f y   a   f u n d a m e n t a l   l e v e l   o f   p e r f o r m a n c e   a n d   r e l a t e d   p o t e n t i a l   p r o b l e m s ;   p r e s c r i p t i v e   i n   t h a t   t h e y   p o i n t   t o   s p e c i f i c   a c t i o n s   t h a t   s h o u l d   b e   t a k e n   t o   r e m e d y   i d e n t i f i e d   p r o b l e m s   o r   t a k e   a d v a n t a g e   o f   o p p o r t u n i t i e s .  
                             < / p >  
                              
                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' # e d e 9 f e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   m a r g i n T o p :   ' 3 2 p x '   } } >  
                                 < h 3   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 5 b 2 1 b 6 ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } > T h e   O v e r a l l   S c o r e   i s   B a s e d   O n : < / h 3 >  
                                 < u l   s t y l e = { {   m a r g i n :   0 ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   c o l o r :   ' # 6 b 2 1 a 8 ' ,   f o n t S i z e :   ' 1 5 p x ' ,   l i n e H e i g h t :   ' 1 . 8 '   } } >  
                                     < l i > L o n g - t e r m   a n d   s h o r t - t e r m   t r e n d s   i n   r e v e n u e   g r o w t h   a n d   e x p e n s e   g r o w t h < / l i >  
                                     < l i > T r e n d s   i n   a s s e t   a n d   l i a b i l i t y   g r o w t h < / l i >  
                                 < / u l >  
                             < / d i v >  
                         < / d i v >  
                     < / d i v >  
                 < / d i v >  
             ) }  
  
             { / *   F i n a n c i a l   S c o r e   T r e n d s   V i e w   * / }  
             { c u r r e n t V i e w   = = =   ' f s - s c o r e '   & &   s e l e c t e d C o m p a n y I d   & &   t r e n d D a t a . l e n g t h   >   0   & &   (  
                 < d i v   s t y l e = { {   m a x W i d t h :   ' 1 4 0 0 p x ' ,   m a r g i n :   ' 0   a u t o ' ,   p a d d i n g :   ' 3 2 p x '   } } >  
                     < s t y l e > { `  
                         @ m e d i a   p r i n t   {  
                             @ p a g e   {  
                                 s i z e :   p o r t r a i t ;  
                                 m a r g i n :   0 . 3 i n ;  
                             }  
                              
                             / *   H i d e   n a v i g a t i o n   a n d   U I   e l e m e n t s   * /  
                             . n o - p r i n t ,  
                             h e a d e r ,  
                             n a v ,  
                             a s i d e ,  
                             [ r o l e = " n a v i g a t i o n " ] ,  
                             b u t t o n   {  
                                 d i s p l a y :   n o n e   ! i m p o r t a n t ;  
                             }  
                              
                             / *   R e m o v e   b a c k g r o u n d s   a n d   s h a d o w s   f o r   p r i n t   * /  
                             *   {  
                                 b o x - s h a d o w :   n o n e   ! i m p o r t a n t ;  
                             }  
                              
                             / *   C o m p r e s s   t i t l e   a n d   h e a d e r   * /  
                             . f s - h e a d e r   h 1   {  
                                 f o n t - s i z e :   1 8 p x   ! i m p o r t a n t ;  
                                 m a r g i n - b o t t o m :   8 p x   ! i m p o r t a n t ;  
                             }  
                              
                             . f s - h e a d e r   >   d i v   {  
                                 f o n t - s i z e :   1 6 p x   ! i m p o r t a n t ;  
                             }  
                              
                             / *   C o m p r e s s   m a i n   s c o r e   c a r d s   * /  
                             . f s - s c o r e - c a r d s   {  
                                 m a r g i n - b o t t o m :   1 2 p x   ! i m p o r t a n t ;  
                                 g a p :   1 0 p x   ! i m p o r t a n t ;  
                             }  
                              
                             . f s - s c o r e - c a r d s   >   d i v   {  
                                 p a d d i n g :   1 0 p x   ! i m p o r t a n t ;  
                                 b o r d e r - r a d i u s :   6 p x   ! i m p o r t a n t ;  
                             }  
                              
                             . f s - s c o r e - c a r d s   >   d i v   >   d i v : f i r s t - c h i l d   {  
                                 f o n t - s i z e :   9 p x   ! i m p o r t a n t ;  
                                 m a r g i n - b o t t o m :   4 p x   ! i m p o r t a n t ;  
                             }  
                              
                             . f s - s c o r e - c a r d s   >   d i v   >   d i v : n t h - c h i l d ( 2 )   {  
                                 f o n t - s i z e :   2 2 p x   ! i m p o r t a n t ;  
                             }  
                              
                             / *   C o m p r e s s   d e t a i l   c a r d s   * /  
                             . f s - d e t a i l - c a r d s   {  
                                 g a p :   8 p x   ! i m p o r t a n t ;  
                                 m a r g i n - b o t t o m :   1 2 p x   ! i m p o r t a n t ;  
                             }  
                              
                             . f s - d e t a i l - c a r d s   >   d i v   {  
                                 p a d d i n g :   8 p x   ! i m p o r t a n t ;  
                             }  
                              
                             . f s - d e t a i l - c a r d s   >   d i v   >   d i v : f i r s t - c h i l d   {  
                                 f o n t - s i z e :   8 p x   ! i m p o r t a n t ;  
                             }  
                              
                             . f s - d e t a i l - c a r d s   >   d i v   >   d i v : n t h - c h i l d ( 2 )   {  
                                 f o n t - s i z e :   1 4 p x   ! i m p o r t a n t ;  
                             }  
                              
                             . f s - d e t a i l - c a r d s   >   d i v   >   d i v : l a s t - c h i l d   {  
                                 f o n t - s i z e :   7 p x   ! i m p o r t a n t ;  
                             }  
                              
                             / *   C o m p r e s s   c h a r t   g r i d   * /  
                             . f s - c h a r t s - g r i d   {  
                                 g a p :   8 p x   ! i m p o r t a n t ;  
                             }  
                              
                             . f s - c h a r t s - g r i d   >   d i v   {  
                                 t r a n s f o r m :   s c a l e ( 0 . 6 5 ) ;  
                                 t r a n s f o r m - o r i g i n :   t o p   l e f t ;  
                                 w i d t h :   1 5 3 . 8 5 % ;  
                                 h e i g h t :   2 5 0 p x ;  
                                 m a r g i n - b o t t o m :   - 6 9 p x ;  
                             }  
                              
                             / *   F o r c e   p a g e   b r e a k   a f t e r   r o w   2   ( a f t e r   4 t h   c h a r t )   * /  
                             . f s - c h a r t s - g r i d   >   d i v : n t h - c h i l d ( 4 )   {  
                                 p a g e - b r e a k - a f t e r :   a l w a y s ;  
                                 b r e a k - a f t e r :   p a g e ;  
                             }  
                              
                             / *   S h o w   p a g e   2   h e a d e r   o n l y   o n   p r i n t   * /  
                             . p a g e - 2 - h e a d e r   {  
                                 d i s p l a y :   b l o c k   ! i m p o r t a n t ;  
                                 m a r g i n - t o p :   7 2 p x   ! i m p o r t a n t ;  
                                 p a d d i n g - b o t t o m :   7 2 p x   ! i m p o r t a n t ;  
                             }  
                              
                             h 2   {  
                                 f o n t - s i z e :   1 2 p x   ! i m p o r t a n t ;  
                                 m a r g i n - b o t t o m :   8 p x   ! i m p o r t a n t ;  
                             }  
                         }  
                     ` } < / s t y l e >  
                      
                     < d i v   c l a s s N a m e = " f s - h e a d e r "   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                         < h 1   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n :   0   } } > F i n a n c i a l   S c o r e   T r e n d s < / h 1 >  
                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 1 6 p x '   } } >  
                             { c o m p a n y N a m e   & &   < d i v   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > { c o m p a n y N a m e } < / d i v > }  
                             < b u t t o n    
                                 c l a s s N a m e = " n o - p r i n t "  
                                 o n C l i c k = { ( )   = >   w i n d o w . p r i n t ( ) }    
                                 s t y l e = { {    
                                     p a d d i n g :   ' 1 2 p x   2 4 p x ' ,    
                                     b a c k g r o u n d :   ' # 6 6 7 e e a ' ,    
                                     c o l o r :   ' w h i t e ' ,    
                                     b o r d e r :   ' n o n e ' ,    
                                     b o r d e r R a d i u s :   ' 8 p x ' ,    
                                     f o n t S i z e :   ' 1 4 p x ' ,    
                                     f o n t W e i g h t :   ' 6 0 0 ' ,    
                                     c u r s o r :   ' p o i n t e r ' ,  
                                     b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 1 0 2 ,   1 2 6 ,   2 3 4 ,   0 . 3 ) '  
                                 } } >  
                                  x       P r i n t  
                             < / b u t t o n >  
                         < / d i v >  
                     < / d i v >  
                      
                     { m o n t h l y . l e n g t h   > =   2 4   & &   (  
                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                             < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > F i n a n c i a l   S c o r e   A n a l y s i s < / h 2 >  
                              
                             < d i v   c l a s s N a m e = " f s - s c o r e - c a r d s "   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( 3 ,   1 f r ) ' ,   g a p :   ' 2 0 p x ' ,   m a r g i n B o t t o m :   ' 3 2 p x ' ,   m a x W i d t h :   ' 9 0 0 p x '   } } >  
                                 < d i v   s t y l e = { {   b a c k g r o u n d :   ' l i n e a r - g r a d i e n t ( 1 3 5 d e g ,   # 6 6 7 e e a   0 % ,   # 7 6 4 b a 2   1 0 0 % ) ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   c o l o r :   ' w h i t e ' ,   b o x S h a d o w :   ' 0   4 p x   1 2 p x   r g b a ( 1 0 2 , 1 2 6 , 2 3 4 , 0 . 3 ) '   } } >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   o p a c i t y :   0 . 9   } } > V e n t u r i s   F i n a n c i a l   S c o r e < / d i v >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 4 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 '   } } > { f i n a l S c o r e . t o F i x e d ( 2 ) } < / d i v >  
                                 < / d i v >  
                                 < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 0 f d f 4 ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b o r d e r :   ' 2 p x   s o l i d   # 8 6 e f a c '   } } >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 6 6 5 3 4 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > P r o f i t a b i l i t y   S c o r e < / d i v >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 4 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 0 b 9 8 1 '   } } > { p r o f i t a b i l i t y S c o r e . t o F i x e d ( 2 ) } < / d i v >  
                                 < / d i v >  
                                 < d i v   s t y l e = { {   b a c k g r o u n d :   ' # e d e 9 f e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b o r d e r :   ' 2 p x   s o l i d   # c 4 b 5 f d '   } } >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 5 b 2 1 b 6 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > A s s e t   D e v e l o p m e n t   S c o r e < / d i v >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 4 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 8 b 5 c f 6 '   } } > { a s s e t D e v S c o r e . t o F i x e d ( 2 ) } < / d i v >  
                                 < / d i v >  
                             < / d i v >  
  
                             < d i v   c l a s s N a m e = " f s - d e t a i l - c a r d s "   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( 5 ,   1 f r ) ' ,   g a p :   ' 1 6 p x '   } } >  
                                 < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > B a s e   R G S   ( 2 4 m o ) < / d i v >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > { b a s e R G S . t o F i x e d ( 0 ) } < / d i v >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n T o p :   ' 4 p x '   } } > G r o w t h :   { g r o w t h _ 2 4 m o . t o F i x e d ( 1 ) } % < / d i v >  
                                 < / d i v >  
                                 < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > A d j u s t e d   R G S   ( 6 m o ) < / d i v >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > { a d j u s t e d R G S . t o F i x e d ( 1 ) } < / d i v >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n T o p :   ' 4 p x '   } } > G r o w t h :   { g r o w t h _ 6 m o . t o F i x e d ( 1 ) } % < / d i v >  
                                 < / d i v >  
                                 < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > E x p e n s e   A d j u s t m e n t < / d i v >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   e x p e n s e A d j u s t m e n t   > =   0   ?   ' # 1 0 b 9 8 1 '   :   ' # e f 4 4 4 4 '   } } >  
                                         { e x p e n s e A d j u s t m e n t   > =   0   ?   ' + '   :   ' ' } { e x p e n s e A d j u s t m e n t }  
                                     < / d i v >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                         { e x p e n s e A d j u s t m e n t   >   0   ?   '  S   B O N U S '   :   e x p e n s e A d j u s t m e n t   <   0   ?   '  S   P E N A L T Y '   :   ' N E U T R A L ' }  
                                     < / d i v >  
                                 < / d i v >  
                                 < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > A L R - 1   ( C u r r e n t ) < / d i v >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > { t y p e o f   a l r 1   = = =   ' n u m b e r '   ?   a l r 1 . t o F i x e d ( 2 )   :   a l r 1 } < / d i v >  
                                 < / d i v >  
                                 < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > A L R   G r o w t h   % < / d i v >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   a l r G r o w t h   > =   0   ?   ' # 1 0 b 9 8 1 '   :   ' # e f 4 4 4 4 '   } } >  
                                         { a l r G r o w t h   > =   0   ?   ' + '   :   ' ' } { a l r G r o w t h . t o F i x e d ( 1 ) } %  
                                     < / d i v >  
                                 < / d i v >  
                             < / d i v >  
                         < / d i v >  
                     ) }  
                      
                     < d i v   c l a s s N a m e = " f s - c h a r t s - g r i d "   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( 2 ,   1 f r ) ' ,   g a p :   ' 2 4 p x '   } } >  
                         < L i n e C h a r t   t i t l e = " F i n a n c i a l   S c o r e   T r e n d "   d a t a = { t r e n d D a t a }   v a l u e K e y = " f i n a n c i a l S c o r e "   c o l o r = " # 6 6 7 e e a "   c o m p a c t   / >  
                         < L i n e C h a r t   t i t l e = " P r o f i t a b i l i t y   S c o r e   T r e n d "   d a t a = { t r e n d D a t a }   v a l u e K e y = " p r o f i t a b i l i t y S c o r e "   c o l o r = " # 1 0 b 9 8 1 "   c o m p a c t   / >  
                         < L i n e C h a r t   t i t l e = " R e v e n u e   G r o w t h   S c o r e   ( R G S ) "   d a t a = { t r e n d D a t a }   v a l u e K e y = " r g s "   c o l o r = " # f 5 9 e 0 b "   c o m p a c t   / >  
                         < L i n e C h a r t   t i t l e = " R G S   w i t h   6 - M o n t h   A d j u s t m e n t "   d a t a = { t r e n d D a t a }   v a l u e K e y = " r g s A d j "   c o l o r = " # 3 b 8 2 f 6 "   c o m p a c t   / >  
                          
                         { / *   P a g e   2   H e a d e r   -   o n l y   v i s i b l e   i n   p r i n t   * / }  
                         < d i v   c l a s s N a m e = " p a g e - 2 - h e a d e r "   s t y l e = { {   d i s p l a y :   ' n o n e ' ,   g r i d C o l u m n :   ' 1   /   - 1 ' ,   p a d d i n g B o t t o m :   ' 7 2 p x '   } } >  
                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r '   } } >  
                                 < h 1   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n :   0   } } > F i n a n c i a l   S c o r e   T r e n d s   ( c o n t ) < / h 1 >  
                                 { c o m p a n y N a m e   & &   < d i v   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > { c o m p a n y N a m e } < / d i v > }  
                             < / d i v >  
                         < / d i v >  
                          
                         < L i n e C h a r t   t i t l e = " E x p e n s e   A d j u s t m e n t "   d a t a = { t r e n d D a t a }   v a l u e K e y = " e x p e n s e A d j "   c o l o r = " # 8 b 5 c f 6 "   c o m p a c t   / >  
                         < L i n e C h a r t   t i t l e = " A s s e t   D e v e l o p m e n t   S c o r e   ( A D S ) "   d a t a = { t r e n d D a t a }   v a l u e K e y = " a d s S c o r e "   c o l o r = " # e c 4 8 9 9 "   c o m p a c t   / >  
                         < L i n e C h a r t   t i t l e = " A L R - 1   ( A s s e t - L i a b i l i t y   R a t i o ) "   d a t a = { t r e n d D a t a }   v a l u e K e y = " a l r 1 "   c o l o r = " # 1 4 b 8 a 6 "   c o m p a c t   / >  
                         < L i n e C h a r t   t i t l e = " A L R   G r o w t h   % "   d a t a = { t r e n d D a t a }   v a l u e K e y = " a l r G r o w t h "   c o l o r = " # f 9 7 3 1 6 "   c o m p a c t   / >  
                     < / d i v >  
                 < / d i v >  
             ) }  
  
             { / *   F o r m u l a   P o p u p   M o d a l   * / }  
             { s h o w F o r m u l a P o p u p   & &   K P I _ F O R M U L A S [ s h o w F o r m u l a P o p u p ]   & &   (  
                 < d i v    
                     s t y l e = { {    
                         p o s i t i o n :   ' f i x e d ' ,    
                         t o p :   0 ,    
                         l e f t :   0 ,    
                         r i g h t :   0 ,    
                         b o t t o m :   0 ,    
                         b a c k g r o u n d :   ' r g b a ( 0 ,   0 ,   0 ,   0 . 5 ) ' ,    
                         z I n d e x :   9 9 9 9 ,    
                         d i s p l a y :   ' f l e x ' ,    
                         a l i g n I t e m s :   ' c e n t e r ' ,    
                         j u s t i f y C o n t e n t :   ' c e n t e r ' ,  
                         p a d d i n g :   ' 2 0 p x '  
                     } }  
                     o n C l i c k = { ( )   = >   s e t S h o w F o r m u l a P o p u p ( n u l l ) }  
                 >  
                     < d i v    
                         s t y l e = { {    
                             b a c k g r o u n d :   ' w h i t e ' ,    
                             b o r d e r R a d i u s :   ' 1 6 p x ' ,    
                             p a d d i n g :   ' 3 2 p x ' ,    
                             m a x W i d t h :   ' 6 0 0 p x ' ,    
                             w i d t h :   ' 1 0 0 % ' ,  
                             b o x S h a d o w :   ' 0   2 0 p x   6 0 p x   r g b a ( 0 , 0 , 0 , 0 . 3 ) ' ,  
                             m a x H e i g h t :   ' 9 0 v h ' ,  
                             o v e r f l o w Y :   ' a u t o '  
                         } }  
                         o n C l i c k = { ( e )   = >   e . s t o p P r o p a g a t i o n ( ) }  
                     >  
                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' f l e x - s t a r t ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                             < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n :   0   } } > { s h o w F o r m u l a P o p u p } < / h 2 >  
                             < b u t t o n  
                                 o n C l i c k = { ( )   = >   s e t S h o w F o r m u l a P o p u p ( n u l l ) }  
                                 s t y l e = { {  
                                     b a c k g r o u n d :   ' n o n e ' ,  
                                     b o r d e r :   ' n o n e ' ,  
                                     f o n t S i z e :   ' 2 4 p x ' ,  
                                     c u r s o r :   ' p o i n t e r ' ,  
                                     c o l o r :   ' # 9 4 a 3 b 8 ' ,  
                                     p a d d i n g :   ' 0 ' ,  
                                     l i n e H e i g h t :   1  
                                 } }  
                             >  
                                    
                             < / b u t t o n >  
                         < / d i v >  
                          
                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                             < h 3   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   t e x t T r a n s f o r m :   ' u p p e r c a s e ' ,   l e t t e r S p a c i n g :   ' 0 . 0 5 e m '   } } > F o r m u l a < / h 3 >  
                             < d i v   s t y l e = { {    
                                 b a c k g r o u n d :   ' # f 8 f a f c ' ,    
                                 p a d d i n g :   ' 1 6 p x ' ,    
                                 b o r d e r R a d i u s :   ' 8 p x ' ,    
                                 f o n t S i z e :   ' 1 8 p x ' ,    
                                 f o n t W e i g h t :   ' 6 0 0 ' ,    
                                 c o l o r :   ' # 1 e 2 9 3 b ' ,  
                                 f o n t F a m i l y :   ' m o n o s p a c e ' ,  
                                 b o r d e r :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '  
                             } } >  
                                 { K P I _ F O R M U L A S [ s h o w F o r m u l a P o p u p ] . f o r m u l a }  
                             < / d i v >  
                         < / d i v >  
                          
                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                             < h 3   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   t e x t T r a n s f o r m :   ' u p p e r c a s e ' ,   l e t t e r S p a c i n g :   ' 0 . 0 5 e m '   } } > P e r i o d   U s e d < / h 3 >  
                             < d i v   s t y l e = { {    
                                 b a c k g r o u n d :   ' # e d e 9 f e ' ,    
                                 p a d d i n g :   ' 1 2 p x   1 6 p x ' ,    
                                 b o r d e r R a d i u s :   ' 8 p x ' ,    
                                 f o n t S i z e :   ' 1 5 p x ' ,    
                                 c o l o r :   ' # 5 b 2 1 b 6 ' ,  
                                 f o n t W e i g h t :   ' 6 0 0 ' ,  
                                 b o r d e r :   ' 1 p x   s o l i d   # d 8 b 4 f e '  
                             } } >  
                                 { K P I _ F O R M U L A S [ s h o w F o r m u l a P o p u p ] . p e r i o d }  
                             < / d i v >  
                         < / d i v >  
                          
                         < d i v >  
                             < h 3   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   t e x t T r a n s f o r m :   ' u p p e r c a s e ' ,   l e t t e r S p a c i n g :   ' 0 . 0 5 e m '   } } > D e s c r i p t i o n < / h 3 >  
                             < p   s t y l e = { {   f o n t S i z e :   ' 1 5 p x ' ,   l i n e H e i g h t :   ' 1 . 7 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n :   0   } } >  
                                 { K P I _ F O R M U L A S [ s h o w F o r m u l a P o p u p ] . d e s c r i p t i o n }  
                             < / p >  
                         < / d i v >  
                          
                         < d i v   s t y l e = { {   m a r g i n T o p :   ' 2 4 p x ' ,   p a d d i n g T o p :   ' 2 0 p x ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                             < b u t t o n  
                                 o n C l i c k = { ( )   = >   s e t S h o w F o r m u l a P o p u p ( n u l l ) }  
                                 s t y l e = { {  
                                     w i d t h :   ' 1 0 0 % ' ,  
                                     p a d d i n g :   ' 1 2 p x ' ,  
                                     b a c k g r o u n d :   ' # 6 6 7 e e a ' ,  
                                     c o l o r :   ' w h i t e ' ,  
                                     b o r d e r :   ' n o n e ' ,  
                                     b o r d e r R a d i u s :   ' 8 p x ' ,  
                                     f o n t S i z e :   ' 1 6 p x ' ,  
                                     f o n t W e i g h t :   ' 6 0 0 ' ,  
                                     c u r s o r :   ' p o i n t e r ' ,  
                                     t r a n s i t i o n :   ' a l l   0 . 2 s '  
                                 } }  
                                 o n M o u s e O v e r = { ( e )   = >   e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # 4 f 4 6 e 5 ' }  
                                 o n M o u s e O u t = { ( e )   = >   e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # 6 6 7 e e a ' }  
                             >  
                                 C l o s e  
                             < / b u t t o n >  
                         < / d i v >  
                     < / d i v >  
                 < / d i v >  
             ) }  
  
             { / *   K P I   D a s h b o a r d   V i e w   * / }  
             { c u r r e n t V i e w   = = =   ' k p i s '   & &   s e l e c t e d C o m p a n y I d   & &   t r e n d D a t a . l e n g t h   >   0   & &   (  
                 < d i v   s t y l e = { {   m a x W i d t h :   ' 1 4 0 0 p x ' ,   m a r g i n :   ' 0   a u t o ' ,   p a d d i n g :   ' 3 2 p x '   } } >  
                     < s t y l e > { `  
                         @ m e d i a   p r i n t   {  
                             @ p a g e   {  
                                 s i z e :   l e t t e r ;  
                                 m a r g i n :   0 . 3 7 5 i n   0 . 3 7 5 i n   0 . 7 5 i n   0 . 3 7 5 i n ;  
                             }  
                              
                             / *   H i d e   n a v i g a t i o n   a n d   U I   e l e m e n t s   * /  
                             . n o - p r i n t ,  
                             h e a d e r ,  
                             n a v ,  
                             a s i d e ,  
                             [ r o l e = " n a v i g a t i o n " ] ,  
                             b u t t o n   {  
                                 d i s p l a y :   n o n e   ! i m p o r t a n t ;  
                             }  
                              
                             / *   S h o w   p r i n t   h e a d e r   * /  
                             . p r i n t - h e a d e r   {  
                                 d i s p l a y :   b l o c k   ! i m p o r t a n t ;  
                             }  
                              
                             / *   S c a l e   d o w n   c h a r t s   p r o p o r t i o n a l l y   a n d   a d j u s t   s p a c i n g   * /  
                             . p r i o r i t y - r a t i o s - p r i n t - c o n t e n t   >   d i v : l a s t - c h i l d   {  
                                 d i s p l a y :   g r i d   ! i m p o r t a n t ;  
                                 g r i d - t e m p l a t e - c o l u m n s :   r e p e a t ( 2 ,   1 f r )   ! i m p o r t a n t ;  
                                 g a p :   0 p x   ! i m p o r t a n t ;  
                                 r o w - g a p :   0 p x   ! i m p o r t a n t ;  
                             }  
                              
                             . p r i o r i t y - r a t i o s - p r i n t - c o n t e n t   >   d i v : l a s t - c h i l d   >   d i v   {  
                                 t r a n s f o r m :   s c a l e ( 0 . 7 5 ) ;  
                                 t r a n s f o r m - o r i g i n :   t o p   l e f t ;  
                                 w i d t h :   1 3 3 % ;  
                                 h e i g h t :   2 6 5 p x ;  
                                 o v e r f l o w :   v i s i b l e ;  
                             }  
                              
                             / *   F i r s t   r o w   * /  
                             . p r i o r i t y - r a t i o s - p r i n t - c o n t e n t   >   d i v : l a s t - c h i l d   >   d i v : n t h - c h i l d ( 1 ) ,  
                             . p r i o r i t y - r a t i o s - p r i n t - c o n t e n t   >   d i v : l a s t - c h i l d   >   d i v : n t h - c h i l d ( 2 )   {  
                                 m a r g i n - b o t t o m :   0 p x ;  
                             }  
                              
                             / *   S e c o n d   r o w   * /  
                             . p r i o r i t y - r a t i o s - p r i n t - c o n t e n t   >   d i v : l a s t - c h i l d   >   d i v : n t h - c h i l d ( 3 ) ,  
                             . p r i o r i t y - r a t i o s - p r i n t - c o n t e n t   >   d i v : l a s t - c h i l d   >   d i v : n t h - c h i l d ( 4 )   {  
                                 m a r g i n - b o t t o m :   0 p x ;  
                             }  
                              
                             / *   T h i r d   r o w   * /  
                             . p r i o r i t y - r a t i o s - p r i n t - c o n t e n t   >   d i v : l a s t - c h i l d   >   d i v : n t h - c h i l d ( 5 ) ,  
                             . p r i o r i t y - r a t i o s - p r i n t - c o n t e n t   >   d i v : l a s t - c h i l d   >   d i v : n t h - c h i l d ( 6 )   {  
                                 m a r g i n - b o t t o m :   0 ;  
                             }  
                         }  
                          
                         . p r i n t - h e a d e r   {  
                             d i s p l a y :   n o n e ;  
                         }  
                     ` } < / s t y l e >  
                     < d i v   c l a s s N a m e = " n o - p r i n t "   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                         < h 1   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n :   0   } } > K P I   D a s h b o a r d < / h 1 >  
                         { c o m p a n y N a m e   & &   < d i v   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > { c o m p a n y N a m e } < / d i v > }  
                     < / d i v >  
                      
                     { / *   B e n c h m a r k   S t a t u s   I n d i c a t o r   * / }  
                     { b e n c h m a r k s . l e n g t h   >   0   ?   (  
                         < d i v   c l a s s N a m e = " n o - p r i n t "   s t y l e = { {   b a c k g r o u n d :   ' # d 1 f a e 5 ' ,   b o r d e r :   ' 1 p x   s o l i d   # 1 0 b 9 8 1 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 2 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 0 6 5 f 4 6 '   } } >  
                              S   I n d u s t r y   b e n c h m a r k s   l o a d e d :   { b e n c h m a r k s . l e n g t h }   m e t r i c s   f o r   { b e n c h m a r k s [ 0 ] ? . i n d u s t r y N a m e   | |   ' U n k n o w n   I n d u s t r y ' }   ( { b e n c h m a r k s [ 0 ] ? . a s s e t S i z e C a t e g o r y   | |   ' N / A ' } )  
                         < / d i v >  
                     )   :   (  
                         < d i v   c l a s s N a m e = " n o - p r i n t "   s t y l e = { {   b a c k g r o u n d :   ' # f e f 2 f 2 ' ,   b o r d e r :   ' 1 p x   s o l i d   # e f 4 4 4 4 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 2 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 9 9 1 b 1 b '   } } >  
                              a   N o   i n d u s t r y   b e n c h m a r k s   l o a d e d .   { ! g e t C u r r e n t C o m p a n y ( ) ? . i n d u s t r y S e c t o r   ?   ' P l e a s e   s e t   t h e   i n d u s t r y   s e c t o r   i n   C o m p a n y   D e t a i l s . '   :   ' B e n c h m a r k s   m a y   n o t   b e   a v a i l a b l e   f o r   t h i s   i n d u s t r y . ' }  
                         < / d i v >  
                     ) }  
  
                     { / *   T a b   N a v i g a t i o n   * / }  
                     < d i v   c l a s s N a m e = " n o - p r i n t "   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 8 p x ' ,   m a r g i n B o t t o m :   ' 3 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                         < b u t t o n  
                             o n C l i c k = { ( )   = >   s e t K p i D a s h b o a r d T a b ( ' a l l - r a t i o s ' ) }  
                             s t y l e = { {  
                                 p a d d i n g :   ' 1 2 p x   2 4 p x ' ,  
                                 b a c k g r o u n d :   k p i D a s h b o a r d T a b   = = =   ' a l l - r a t i o s '   ?   ' # 6 6 7 e e a '   :   ' t r a n s p a r e n t ' ,  
                                 c o l o r :   k p i D a s h b o a r d T a b   = = =   ' a l l - r a t i o s '   ?   ' w h i t e '   :   ' # 6 4 7 4 8 b ' ,  
                                 b o r d e r :   ' n o n e ' ,  
                                 b o r d e r B o t t o m :   k p i D a s h b o a r d T a b   = = =   ' a l l - r a t i o s '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t ' ,  
                                 f o n t S i z e :   ' 1 6 p x ' ,  
                                 f o n t W e i g h t :   ' 6 0 0 ' ,  
                                 c u r s o r :   ' p o i n t e r ' ,  
                                 b o r d e r R a d i u s :   ' 8 p x   8 p x   0   0 ' ,  
                                 t r a n s i t i o n :   ' a l l   0 . 2 s '  
                             } }  
                         >  
                             A l l   R a t i o s  
                         < / b u t t o n >  
                         < b u t t o n  
                             o n C l i c k = { ( )   = >   s e t K p i D a s h b o a r d T a b ( ' p r i o r i t y - r a t i o s ' ) }  
                             s t y l e = { {  
                                 p a d d i n g :   ' 1 2 p x   2 4 p x ' ,  
                                 b a c k g r o u n d :   k p i D a s h b o a r d T a b   = = =   ' p r i o r i t y - r a t i o s '   ?   ' # 6 6 7 e e a '   :   ' t r a n s p a r e n t ' ,  
                                 c o l o r :   k p i D a s h b o a r d T a b   = = =   ' p r i o r i t y - r a t i o s '   ?   ' w h i t e '   :   ' # 6 4 7 4 8 b ' ,  
                                 b o r d e r :   ' n o n e ' ,  
                                 b o r d e r B o t t o m :   k p i D a s h b o a r d T a b   = = =   ' p r i o r i t y - r a t i o s '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t ' ,  
                                 f o n t S i z e :   ' 1 6 p x ' ,  
                                 f o n t W e i g h t :   ' 6 0 0 ' ,  
                                 c u r s o r :   ' p o i n t e r ' ,  
                                 b o r d e r R a d i u s :   ' 8 p x   8 p x   0   0 ' ,  
                                 t r a n s i t i o n :   ' a l l   0 . 2 s '  
                             } }  
                         >  
                             P r i o r i t y   R a t i o s  
                         < / b u t t o n >  
                     < / d i v >  
  
                     { / *   A l l   R a t i o s   T a b   * / }  
                     { k p i D a s h b o a r d T a b   = = =   ' a l l - r a t i o s '   & &   (  
                         < >  
                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                                 < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } > L i q u i d i t y   R a t i o s < / h 2 >  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( 2 ,   1 f r ) ' ,   g a p :   ' 2 0 p x '   } } >  
                                     < L i n e C h a r t   t i t l e = " C u r r e n t   R a t i o "   d a t a = { t r e n d D a t a }   v a l u e K e y = " c u r r e n t R a t i o "   c o l o r = " # 1 0 b 9 8 1 "   c o m p a c t   b e n c h m a r k V a l u e = { g e t B e n c h m a r k V a l u e ( b e n c h m a r k s ,   ' C u r r e n t   R a t i o ' ) }   f o r m a t t e r = { ( v )   = >   v . t o F i x e d ( 1 ) }   s h o w F o r m u l a B u t t o n   o n F o r m u l a C l i c k = { ( )   = >   s e t S h o w F o r m u l a P o p u p ( ' C u r r e n t   R a t i o ' ) }   / >  
                                     < L i n e C h a r t   t i t l e = " Q u i c k   R a t i o "   d a t a = { t r e n d D a t a }   v a l u e K e y = " q u i c k R a t i o "   c o l o r = " # 1 4 b 8 a 6 "   c o m p a c t   b e n c h m a r k V a l u e = { g e t B e n c h m a r k V a l u e ( b e n c h m a r k s ,   ' Q u i c k   R a t i o ' ) }   f o r m a t t e r = { ( v )   = >   v . t o F i x e d ( 1 ) }   s h o w F o r m u l a B u t t o n   o n F o r m u l a C l i c k = { ( )   = >   s e t S h o w F o r m u l a P o p u p ( ' Q u i c k   R a t i o ' ) }   / >  
                                 < / d i v >  
                             < / d i v >  
  
                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                                 < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } > A c t i v i t y   R a t i o s < / h 2 >  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( 2 ,   1 f r ) ' ,   g a p :   ' 2 0 p x '   } } >  
                                     < L i n e C h a r t   t i t l e = " I n v e n t o r y   T u r n o v e r "   d a t a = { t r e n d D a t a }   v a l u e K e y = " i n v T u r n o v e r "   c o l o r = " # f 5 9 e 0 b "   c o m p a c t   b e n c h m a r k V a l u e = { g e t B e n c h m a r k V a l u e ( b e n c h m a r k s ,   ' I n v e n t o r y   T u r n o v e r ' ) }   f o r m a t t e r = { ( v )   = >   v . t o F i x e d ( 1 ) }   s h o w F o r m u l a B u t t o n   o n F o r m u l a C l i c k = { ( )   = >   s e t S h o w F o r m u l a P o p u p ( ' I n v e n t o r y   T u r n o v e r ' ) }   / >  
                                     < L i n e C h a r t   t i t l e = " R e c e i v a b l e s   T u r n o v e r "   d a t a = { t r e n d D a t a }   v a l u e K e y = " a r T u r n o v e r "   c o l o r = " # f 9 7 3 1 6 "   c o m p a c t   b e n c h m a r k V a l u e = { g e t B e n c h m a r k V a l u e ( b e n c h m a r k s ,   ' R e c e i v a b l e s   T u r n o v e r ' ) }   f o r m a t t e r = { ( v )   = >   v . t o F i x e d ( 1 ) }   s h o w F o r m u l a B u t t o n   o n F o r m u l a C l i c k = { ( )   = >   s e t S h o w F o r m u l a P o p u p ( ' R e c e i v a b l e s   T u r n o v e r ' ) }   / >  
                                     < L i n e C h a r t   t i t l e = " P a y a b l e s   T u r n o v e r "   d a t a = { t r e n d D a t a }   v a l u e K e y = " a p T u r n o v e r "   c o l o r = " # e f 4 4 4 4 "   c o m p a c t   b e n c h m a r k V a l u e = { g e t B e n c h m a r k V a l u e ( b e n c h m a r k s ,   ' P a y a b l e s   T u r n o v e r ' ) }   f o r m a t t e r = { ( v )   = >   v . t o F i x e d ( 1 ) }   s h o w F o r m u l a B u t t o n   o n F o r m u l a C l i c k = { ( )   = >   s e t S h o w F o r m u l a P o p u p ( ' P a y a b l e s   T u r n o v e r ' ) }   / >  
                                     < L i n e C h a r t   t i t l e = " D a y s '   I n v e n t o r y "   d a t a = { t r e n d D a t a }   v a l u e K e y = " d a y s I n v "   c o l o r = " # f b b f 2 4 "   c o m p a c t   b e n c h m a r k V a l u e = { g e t B e n c h m a r k V a l u e ( b e n c h m a r k s ,   ' D a y s   I n v e n t o r y ' ) }   f o r m a t t e r = { ( v )   = >   v . t o F i x e d ( 0 ) }   s h o w F o r m u l a B u t t o n   o n F o r m u l a C l i c k = { ( )   = >   s e t S h o w F o r m u l a P o p u p ( ' D a y s \ '   I n v e n t o r y ' ) }   / >  
                                     < L i n e C h a r t   t i t l e = " D a y s '   R e c e i v a b l e s "   d a t a = { t r e n d D a t a }   v a l u e K e y = " d a y s A R "   c o l o r = " # f b 9 2 3 c "   c o m p a c t   b e n c h m a r k V a l u e = { g e t B e n c h m a r k V a l u e ( b e n c h m a r k s ,   ' D a y s   R e c e i v a b l e s ' ) }   f o r m a t t e r = { ( v )   = >   v . t o F i x e d ( 0 ) }   s h o w F o r m u l a B u t t o n   o n F o r m u l a C l i c k = { ( )   = >   s e t S h o w F o r m u l a P o p u p ( ' D a y s \ '   R e c e i v a b l e s ' ) }   / >  
                                     < L i n e C h a r t   t i t l e = " D a y s '   P a y a b l e s "   d a t a = { t r e n d D a t a }   v a l u e K e y = " d a y s A P "   c o l o r = " # f 8 7 1 7 1 "   c o m p a c t   b e n c h m a r k V a l u e = { g e t B e n c h m a r k V a l u e ( b e n c h m a r k s ,   ' D a y s   P a y a b l e s ' ) }   f o r m a t t e r = { ( v )   = >   v . t o F i x e d ( 0 ) }   s h o w F o r m u l a B u t t o n   o n F o r m u l a C l i c k = { ( )   = >   s e t S h o w F o r m u l a P o p u p ( ' D a y s \ '   P a y a b l e s ' ) }   / >  
                                     < L i n e C h a r t   t i t l e = " S a l e s / W o r k i n g   C a p i t a l "   d a t a = { t r e n d D a t a }   v a l u e K e y = " s a l e s W C "   c o l o r = " # 0 6 b 6 d 4 "   c o m p a c t   b e n c h m a r k V a l u e = { g e t B e n c h m a r k V a l u e ( b e n c h m a r k s ,   ' S a l e s / W o r k i n g   C a p i t a l ' ) }   f o r m a t t e r = { ( v )   = >   v . t o F i x e d ( 1 ) }   s h o w F o r m u l a B u t t o n   o n F o r m u l a C l i c k = { ( )   = >   s e t S h o w F o r m u l a P o p u p ( ' S a l e s / W o r k i n g   C a p i t a l ' ) }   / >  
                                 < / d i v >  
                             < / d i v >  
  
                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                                 < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } > C o v e r a g e   R a t i o s < / h 2 >  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( 2 ,   1 f r ) ' ,   g a p :   ' 2 0 p x '   } } >  
                                     < L i n e C h a r t   t i t l e = " I n t e r e s t   C o v e r a g e "   d a t a = { t r e n d D a t a }   v a l u e K e y = " i n t e r e s t C o v "   c o l o r = " # 8 b 5 c f 6 "   c o m p a c t   b e n c h m a r k V a l u e = { g e t B e n c h m a r k V a l u e ( b e n c h m a r k s ,   ' I n t e r e s t   C o v e r a g e ' ) }   f o r m a t t e r = { ( v )   = >   v . t o F i x e d ( 1 ) }   s h o w F o r m u l a B u t t o n   o n F o r m u l a C l i c k = { ( )   = >   s e t S h o w F o r m u l a P o p u p ( ' I n t e r e s t   C o v e r a g e ' ) }   / >  
                                     < L i n e C h a r t   t i t l e = " D e b t   S e r v i c e   C o v e r a g e "   d a t a = { t r e n d D a t a }   v a l u e K e y = " d e b t S v c C o v "   c o l o r = " # a 7 8 b f a "   c o m p a c t   b e n c h m a r k V a l u e = { g e t B e n c h m a r k V a l u e ( b e n c h m a r k s ,   ' D e b t   S e r v i c e   C o v e r a g e ' ) }   f o r m a t t e r = { ( v )   = >   v . t o F i x e d ( 1 ) }   s h o w F o r m u l a B u t t o n   o n F o r m u l a C l i c k = { ( )   = >   s e t S h o w F o r m u l a P o p u p ( ' D e b t   S e r v i c e   C o v e r a g e ' ) }   / >  
                                     < L i n e C h a r t   t i t l e = " C a s h   F l o w   t o   D e b t "   d a t a = { t r e n d D a t a }   v a l u e K e y = " c f T o D e b t "   c o l o r = " # c 4 b 5 f d "   c o m p a c t   b e n c h m a r k V a l u e = { g e t B e n c h m a r k V a l u e ( b e n c h m a r k s ,   ' C a s h   F l o w   t o   D e b t ' ) }   f o r m a t t e r = { ( v )   = >   v . t o F i x e d ( 1 ) }   s h o w F o r m u l a B u t t o n   o n F o r m u l a C l i c k = { ( )   = >   s e t S h o w F o r m u l a P o p u p ( ' C a s h   F l o w   t o   D e b t ' ) }   / >  
                                 < / d i v >  
                             < / d i v >  
  
                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                                 < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } > L e v e r a g e   R a t i o s < / h 2 >  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( 2 ,   1 f r ) ' ,   g a p :   ' 2 0 p x '   } } >  
                                     < L i n e C h a r t   t i t l e = " D e b t / N e t   W o r t h "   d a t a = { t r e n d D a t a }   v a l u e K e y = " d e b t T o N W "   c o l o r = " # e c 4 8 9 9 "   c o m p a c t   b e n c h m a r k V a l u e = { g e t B e n c h m a r k V a l u e ( b e n c h m a r k s ,   ' D e b t / N e t   W o r t h ' ) }   f o r m a t t e r = { ( v )   = >   v . t o F i x e d ( 1 ) }   s h o w F o r m u l a B u t t o n   o n F o r m u l a C l i c k = { ( )   = >   s e t S h o w F o r m u l a P o p u p ( ' D e b t / N e t   W o r t h ' ) }   / >  
                                     < L i n e C h a r t   t i t l e = " F i x e d   A s s e t s / N e t   W o r t h "   d a t a = { t r e n d D a t a }   v a l u e K e y = " f i x e d T o N W "   c o l o r = " # f 4 7 2 b 6 "   c o m p a c t   b e n c h m a r k V a l u e = { g e t B e n c h m a r k V a l u e ( b e n c h m a r k s ,   ' F i x e d   A s s e t s / N e t   W o r t h ' ) }   f o r m a t t e r = { ( v )   = >   v . t o F i x e d ( 1 ) }   s h o w F o r m u l a B u t t o n   o n F o r m u l a C l i c k = { ( )   = >   s e t S h o w F o r m u l a P o p u p ( ' F i x e d   A s s e t s / N e t   W o r t h ' ) }   / >  
                                     < L i n e C h a r t   t i t l e = " L e v e r a g e   R a t i o "   d a t a = { t r e n d D a t a }   v a l u e K e y = " l e v e r a g e "   c o l o r = " # f 9 a 8 d 4 "   c o m p a c t   b e n c h m a r k V a l u e = { g e t B e n c h m a r k V a l u e ( b e n c h m a r k s ,   ' L e v e r a g e   R a t i o ' ) }   f o r m a t t e r = { ( v )   = >   v . t o F i x e d ( 1 ) }   s h o w F o r m u l a B u t t o n   o n F o r m u l a C l i c k = { ( )   = >   s e t S h o w F o r m u l a P o p u p ( ' L e v e r a g e   R a t i o ' ) }   / >  
                                 < / d i v >  
                             < / d i v >  
  
                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                                 < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } > O p e r a t i n g   R a t i o s < / h 2 >  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( 2 ,   1 f r ) ' ,   g a p :   ' 2 0 p x '   } } >  
                                     < L i n e C h a r t   t i t l e = " T o t a l   A s s e t   T u r n o v e r "   d a t a = { t r e n d D a t a }   v a l u e K e y = " t o t a l A s s e t T O "   c o l o r = " # 3 b 8 2 f 6 "   c o m p a c t   b e n c h m a r k V a l u e = { g e t B e n c h m a r k V a l u e ( b e n c h m a r k s ,   ' T o t a l   A s s e t   T u r n o v e r ' ) }   f o r m a t t e r = { ( v )   = >   v . t o F i x e d ( 1 ) }   s h o w F o r m u l a B u t t o n   o n F o r m u l a C l i c k = { ( )   = >   s e t S h o w F o r m u l a P o p u p ( ' T o t a l   A s s e t   T u r n o v e r ' ) }   / >  
                                     < L i n e C h a r t   t i t l e = " R e t u r n   o n   E q u i t y   ( R O E ) "   d a t a = { t r e n d D a t a }   v a l u e K e y = " r o e "   c o l o r = " # 6 0 a 5 f a "   c o m p a c t   b e n c h m a r k V a l u e = { g e t B e n c h m a r k V a l u e ( b e n c h m a r k s ,   ' R O E ' ) }   f o r m a t t e r = { ( v )   = >   v . t o F i x e d ( 1 ) }   s h o w F o r m u l a B u t t o n   o n F o r m u l a C l i c k = { ( )   = >   s e t S h o w F o r m u l a P o p u p ( ' R e t u r n   o n   E q u i t y   ( R O E ) ' ) }   / >  
                                     < L i n e C h a r t   t i t l e = " R e t u r n   o n   A s s e t s   ( R O A ) "   d a t a = { t r e n d D a t a }   v a l u e K e y = " r o a "   c o l o r = " # 9 3 c 5 f d "   c o m p a c t   b e n c h m a r k V a l u e = { g e t B e n c h m a r k V a l u e ( b e n c h m a r k s ,   ' R O A ' ) }   f o r m a t t e r = { ( v )   = >   v . t o F i x e d ( 1 ) }   s h o w F o r m u l a B u t t o n   o n F o r m u l a C l i c k = { ( )   = >   s e t S h o w F o r m u l a P o p u p ( ' R e t u r n   o n   A s s e t s   ( R O A ) ' ) }   / >  
                                     < L i n e C h a r t   t i t l e = " E B I T D A   M a r g i n "   d a t a = { t r e n d D a t a }   v a l u e K e y = " e b i t d a M a r g i n "   c o l o r = " # 2 5 6 3 e b "   c o m p a c t   b e n c h m a r k V a l u e = { g e t B e n c h m a r k V a l u e ( b e n c h m a r k s ,   ' E B I T D A / R e v e n u e ' ) }   f o r m a t t e r = { ( v )   = >   v . t o F i x e d ( 1 ) }   s h o w F o r m u l a B u t t o n   o n F o r m u l a C l i c k = { ( )   = >   s e t S h o w F o r m u l a P o p u p ( ' E B I T D A   M a r g i n ' ) }   / >  
                                     < L i n e C h a r t   t i t l e = " E B I T   M a r g i n "   d a t a = { t r e n d D a t a }   v a l u e K e y = " e b i t M a r g i n "   c o l o r = " # 1 e 4 0 a f "   c o m p a c t   b e n c h m a r k V a l u e = { g e t B e n c h m a r k V a l u e ( b e n c h m a r k s ,   ' E B I T / R e v e n u e ' ) }   f o r m a t t e r = { ( v )   = >   v . t o F i x e d ( 1 ) }   s h o w F o r m u l a B u t t o n   o n F o r m u l a C l i c k = { ( )   = >   s e t S h o w F o r m u l a P o p u p ( ' E B I T   M a r g i n ' ) }   / >  
                                 < / d i v >  
                             < / d i v >  
                         < / >  
                     ) }  
  
                     { / *   P r i o r i t y   R a t i o s   T a b   * / }  
                     { k p i D a s h b o a r d T a b   = = =   ' p r i o r i t y - r a t i o s '   & &   (  
                         < d i v >  
                             < d i v   c l a s s N a m e = " n o - p r i n t "   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                 < h 3   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > C u s t o m i z e   Y o u r   P r i o r i t y   R a t i o s < / h 3 >  
                                 < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                     S e l e c t   u p   t o   6   r a t i o s   t o   t r a c k   a s   y o u r   p r i o r i t y   K P I s .   T h e s e   s e l e c t i o n s   w i l l   b e   s a v e d   a n d   p e r s i s t   a c r o s s   s e s s i o n s .  
                                 < / p >  
                                 { / *   U p d a t e d   l a y o u t   -   m o r e   c o m p a c t   a n d   h o r i z o n t a l   * / }  
                                  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   f l e x W r a p :   ' w r a p ' ,   g a p :   ' 1 2 p x ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                     { O b j e c t . e n t r i e s ( r a t i o C a t e g o r i e s ) . m a p ( ( [ c a t e g o r y ,   r a t i o s ] )   = >   (  
                                         < d i v   k e y = { c a t e g o r y }   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 8 p x '   } } >  
                                             < l a b e l   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 3 7 4 1 5 1 ' ,   w h i t e S p a c e :   ' n o w r a p '   } } >  
                                                 { c a t e g o r y } :  
                                             < / l a b e l >  
                                             < s e l e c t  
                                                 v a l u e = { p r i o r i t y R a t i o s . f i n d ( r a t i o   = >   r a t i o s . i n c l u d e s ( r a t i o ) )   | |   ' ' }  
                                                 o n C h a n g e = { ( e )   = >   {  
                                                     c o n s t   n e w R a t i o   =   e . t a r g e t . v a l u e ;  
                                                     i f   ( n e w R a t i o )   {  
                                                         c o n s t   c u r r e n t R a t i o F r o m C a t e g o r y   =   p r i o r i t y R a t i o s . f i n d ( r a t i o   = >   r a t i o s . i n c l u d e s ( r a t i o ) ) ;  
                                                         i f   ( c u r r e n t R a t i o F r o m C a t e g o r y )   {  
                                                             / /   R e p l a c e   e x i s t i n g   r a t i o   f r o m   t h i s   c a t e g o r y  
                                                             s e t P r i o r i t y R a t i o s ( p r e v   = >   p r e v . m a p ( r a t i o   = >    
                                                                 r a t i o   = = =   c u r r e n t R a t i o F r o m C a t e g o r y   ?   n e w R a t i o   :   r a t i o  
                                                             ) ) ;  
                                                         }   e l s e   i f   ( p r i o r i t y R a t i o s . l e n g t h   <   6 )   {  
                                                             / /   A d d   n e w   r a t i o   i f   u n d e r   l i m i t  
                                                             s e t P r i o r i t y R a t i o s ( p r e v   = >   [ . . . p r e v ,   n e w R a t i o ] ) ;  
                                                         }   e l s e   {  
                                                             a l e r t ( ' M a x i m u m   o f   6   p r i o r i t y   r a t i o s   a l l o w e d .   P l e a s e   r e m o v e   o n e   f i r s t . ' ) ;  
                                                         }  
                                                     }  
                                                 } }  
                                                 s t y l e = { {  
                                                     p a d d i n g :   ' 6 p x   8 p x ' ,  
                                                     b o r d e r :   ' 1 p x   s o l i d   # d 1 d 5 d b ' ,  
                                                     b o r d e r R a d i u s :   ' 4 p x ' ,  
                                                     f o n t S i z e :   ' 1 2 p x ' ,  
                                                     b a c k g r o u n d :   ' w h i t e ' ,  
                                                     m i n W i d t h :   ' 1 4 0 p x '  
                                                 } }  
                                             >  
                                                 < o p t i o n   v a l u e = " " > S e l e c t . . . < / o p t i o n >  
                                                 { r a t i o s . m a p ( r a t i o   = >   (  
                                                     < o p t i o n   k e y = { r a t i o }   v a l u e = { r a t i o } >  
                                                         { r a t i o }  
                                                     < / o p t i o n >  
                                                 ) ) }  
                                             < / s e l e c t >  
                                         < / d i v >  
                                     ) ) }  
                                 < / d i v >  
  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r '   } } >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } >  
                                         S e l e c t e d :   { p r i o r i t y R a t i o s . l e n g t h } / 6   r a t i o s  
                                     < / d i v >  
                                     < b u t t o n  
                                         o n C l i c k = { s a v e P r i o r i t y R a t i o s }  
                                         s t y l e = { {  
                                             p a d d i n g :   ' 6 p x   1 2 p x ' ,  
                                             b a c k g r o u n d :   ' # 6 6 7 e e a ' ,  
                                             c o l o r :   ' w h i t e ' ,  
                                             b o r d e r :   ' n o n e ' ,  
                                             b o r d e r R a d i u s :   ' 4 p x ' ,  
                                             f o n t S i z e :   ' 1 2 p x ' ,  
                                             f o n t W e i g h t :   ' 6 0 0 ' ,  
                                             c u r s o r :   ' p o i n t e r '  
                                         } }  
                                     >  
                                         S a v e  
                                     < / b u t t o n >  
                                 < / d i v >  
                             < / d i v >  
  
                             { / *   D i s p l a y   S e l e c t e d   P r i o r i t y   R a t i o s   * / }  
                             { p r i o r i t y R a t i o s . l e n g t h   >   0   & &   (  
                                 < d i v >  
                                     < d i v   c l a s s N a m e = " n o - p r i n t "   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                                         < h 3   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n :   0   } } >  
                                             Y o u r   P r i o r i t y   R a t i o s   ( { p r i o r i t y R a t i o s . l e n g t h } / 6 )  
                                         < / h 3 >  
                                         < b u t t o n  
                                             o n C l i c k = { ( )   = >   w i n d o w . p r i n t ( ) }  
                                             s t y l e = { {  
                                                 p a d d i n g :   ' 1 0 p x   2 0 p x ' ,  
                                                 b a c k g r o u n d :   ' # 1 0 b 9 8 1 ' ,  
                                                 c o l o r :   ' w h i t e ' ,  
                                                 b o r d e r :   ' n o n e ' ,  
                                                 b o r d e r R a d i u s :   ' 8 p x ' ,  
                                                 f o n t S i z e :   ' 1 4 p x ' ,  
                                                 f o n t W e i g h t :   ' 6 0 0 ' ,  
                                                 c u r s o r :   ' p o i n t e r ' ,  
                                                 d i s p l a y :   ' f l e x ' ,  
                                                 a l i g n I t e m s :   ' c e n t e r ' ,  
                                                 g a p :   ' 8 p x '  
                                             } }  
                                         >  
                                              x       P r i n t   P r i o r i t y   R a t i o s  
                                         < / b u t t o n >  
                                     < / d i v >  
                                     < d i v   c l a s s N a m e = " p r i o r i t y - r a t i o s - p r i n t - c o n t e n t " >  
                                         < d i v   c l a s s N a m e = " p r i n t - h e a d e r "   s t y l e = { {   d i s p l a y :   ' n o n e '   } } >  
                                             < h 1   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   m a r g i n T o p :   ' 0 ' ,   t e x t A l i g n :   ' c e n t e r '   } } >  
                                                 P r i o r i t y   R a t i o s   { c o m p a n y N a m e   & &   ` -   $ { c o m p a n y N a m e } ` }  
                                             < / h 1 >  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( 2 ,   1 f r ) ' ,   g a p :   ' 2 0 p x '   } } >  
                                         { p r i o r i t y R a t i o s . m a p ( ( r a t i o ,   i n d e x )   = >   (  
                                             < d i v   k e y = { r a t i o }   s t y l e = { {   p o s i t i o n :   ' r e l a t i v e '   } } >  
                                                 < L i n e C h a r t  
                                                     t i t l e = { r a t i o }  
                                                     d a t a = { t r e n d D a t a }  
                                                     v a l u e K e y = { g e t R a t i o V a l u e K e y ( r a t i o ) }  
                                                     c o l o r = { g e t R a t i o C o l o r ( r a t i o ) }  
                                                     c o m p a c t  
                                                     b e n c h m a r k V a l u e = { g e t B e n c h m a r k V a l u e ( b e n c h m a r k s ,   r a t i o ) }  
                                                     f o r m a t t e r = { g e t R a t i o F o r m a t t e r ( r a t i o ) }  
                                                     s h o w F o r m u l a B u t t o n  
                                                     o n F o r m u l a C l i c k = { ( )   = >   s e t S h o w F o r m u l a P o p u p ( r a t i o ) }  
                                                 / >  
                                                 < b u t t o n  
                                                     o n C l i c k = { ( )   = >   s e t P r i o r i t y R a t i o s ( p r e v   = >   p r e v . f i l t e r ( ( _ ,   i )   = >   i   ! = =   i n d e x ) ) }  
                                                     c l a s s N a m e = " n o - p r i n t "  
                                                     s t y l e = { {  
                                                         p o s i t i o n :   ' a b s o l u t e ' ,  
                                                         t o p :   ' 8 p x ' ,  
                                                         r i g h t :   ' 8 p x ' ,  
                                                         b a c k g r o u n d :   ' # e f 4 4 4 4 ' ,  
                                                         c o l o r :   ' w h i t e ' ,  
                                                         b o r d e r :   ' n o n e ' ,  
                                                         b o r d e r R a d i u s :   ' 5 0 % ' ,  
                                                         w i d t h :   ' 2 4 p x ' ,  
                                                         h e i g h t :   ' 2 4 p x ' ,  
                                                         f o n t S i z e :   ' 1 2 p x ' ,  
                                                         c u r s o r :   ' p o i n t e r ' ,  
                                                         d i s p l a y :   ' f l e x ' ,  
                                                         a l i g n I t e m s :   ' c e n t e r ' ,  
                                                         j u s t i f y C o n t e n t :   ' c e n t e r '  
                                                     } }  
                                                 >  
                                                        
                                                 < / b u t t o n >  
                                             < / d i v >  
                                         ) ) }  
                                         < / d i v >  
                                     < / d i v >  
                                 < / d i v >  
                             ) }  
  
                             { p r i o r i t y R a t i o s . l e n g t h   = = =   0   & &   (  
                                 < d i v   s t y l e = { {   t e x t A l i g n :   ' c e n t e r ' ,   p a d d i n g :   ' 6 0 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 4 8 p x ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  x `< / d i v >  
                                     < h 3   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > N o   P r i o r i t y   R a t i o s   S e l e c t e d < / h 3 >  
                                     < p > S e l e c t   r a t i o s   f r o m   t h e   d r o p d o w n s   a b o v e   t o   c r e a t e   y o u r   c u s t o m   K P I   d a s h b o a r d . < / p >  
                                 < / d i v >  
                             ) }  
                         < / d i v >  
                     ) }  
                 < / d i v >  
             ) }  
  
             { / *   M D & A   V i e w   * / }  
             { c u r r e n t V i e w   = = =   ' m d a '   & &   s e l e c t e d C o m p a n y I d   & &   t r e n d D a t a . l e n g t h   >   0   & &   (  
                 < d i v   s t y l e = { {   m a x W i d t h :   ' 1 4 0 0 p x ' ,   m a r g i n :   ' 0   a u t o ' ,   p a d d i n g :   ' 3 2 p x '   } } >  
                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                         < h 1   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n :   0   } } > M a n a g e m e n t   D i s c u s s i o n   &   A n a l y s i s < / h 1 >  
                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 1 6 p x '   } } >  
                             { c o m p a n y N a m e   & &   < d i v   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > { c o m p a n y N a m e } < / d i v > }  
                             < b u t t o n    
                                 c l a s s N a m e = " n o - p r i n t "  
                                 o n C l i c k = { ( )   = >   w i n d o w . p r i n t ( ) }    
                                 s t y l e = { {    
                                     p a d d i n g :   ' 1 2 p x   2 4 p x ' ,    
                                     b a c k g r o u n d :   ' # 6 6 7 e e a ' ,    
                                     c o l o r :   ' w h i t e ' ,    
                                     b o r d e r :   ' n o n e ' ,    
                                     b o r d e r R a d i u s :   ' 8 p x ' ,    
                                     f o n t S i z e :   ' 1 4 p x ' ,    
                                     f o n t W e i g h t :   ' 6 0 0 ' ,    
                                     c u r s o r :   ' p o i n t e r ' ,  
                                     b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 1 0 2 ,   1 2 6 ,   2 3 4 ,   0 . 3 ) '  
                                 } } >  
                                  x       P r i n t  
                             < / b u t t o n >  
                         < / d i v >  
                     < / d i v >  
                      
                     < s t y l e > { `  
                         @ m e d i a   p r i n t   {  
                             @ p a g e   {  
                                 s i z e :   p o r t r a i t ;  
                                 m a r g i n :   0 . 5 i n ;  
                             }  
                              
                             / *   H i d e   n a v i g a t i o n   a n d   U I   e l e m e n t s   * /  
                             . n o - p r i n t ,  
                             h e a d e r ,  
                             n a v ,  
                             a s i d e ,  
                             [ r o l e = " n a v i g a t i o n " ]   {  
                                 d i s p l a y :   n o n e   ! i m p o r t a n t ;  
                             }  
                              
                             / *   H i d e   t a b   n a v i g a t i o n   b u t t o n s   * /  
                             b u t t o n [ o n c l i c k * = " s e t M d a T a b " ]   {  
                                 d i s p l a y :   n o n e   ! i m p o r t a n t ;  
                             }  
                              
                             / *   R e m o v e   b o x   s h a d o w s   a n d   b a c k g r o u n d s   * /  
                             *   {  
                                 b o x - s h a d o w :   n o n e   ! i m p o r t a n t ;  
                             }  
                              
                             / *   E n s u r e   t e x t   i s   r e a d a b l e   * /  
                             b o d y ,   p ,   l i ,   d i v   {  
                                 c o l o r :   # 0 0 0   ! i m p o r t a n t ;  
                             }  
                              
                             h 1 ,   h 2 ,   h 3   {  
                                 p a g e - b r e a k - a f t e r :   a v o i d ;  
                             }  
                              
                             / *   A v o i d   b r e a k i n g   i n s i d e   s e c t i o n s   * /  
                             d i v [ s t y l e * = " b a c k g r o u n d :   w h i t e " ]   {  
                                 p a g e - b r e a k - i n s i d e :   a v o i d ;  
                             }  
                         }  
                     ` } < / s t y l e >  
                      
                     { / *   T a b   N a v i g a t i o n   * / }  
                     < d i v   c l a s s N a m e = " n o - p r i n t "   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 8 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                         < b u t t o n  
                             o n C l i c k = { ( )   = >   s e t M d a T a b ( ' e x e c u t i v e - s u m m a r y ' ) }  
                             s t y l e = { {  
                                 p a d d i n g :   ' 1 2 p x   2 4 p x ' ,  
                                 b a c k g r o u n d :   m d a T a b   = = =   ' e x e c u t i v e - s u m m a r y '   ?   ' # 6 6 7 e e a '   :   ' t r a n s p a r e n t ' ,  
                                 c o l o r :   m d a T a b   = = =   ' e x e c u t i v e - s u m m a r y '   ?   ' w h i t e '   :   ' # 6 4 7 4 8 b ' ,  
                                 b o r d e r :   ' n o n e ' ,  
                                 b o r d e r B o t t o m :   m d a T a b   = = =   ' e x e c u t i v e - s u m m a r y '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t ' ,  
                                 f o n t S i z e :   ' 1 6 p x ' ,  
                                 f o n t W e i g h t :   ' 6 0 0 ' ,  
                                 c u r s o r :   ' p o i n t e r ' ,  
                                 b o r d e r R a d i u s :   ' 8 p x   8 p x   0   0 ' ,  
                                 t r a n s i t i o n :   ' a l l   0 . 2 s '  
                             } }  
                         >  
                             E x e c u t i v e   S u m m a r y  
                         < / b u t t o n >  
                         < b u t t o n  
                             o n C l i c k = { ( )   = >   s e t M d a T a b ( ' s t r e n g t h s - i n s i g h t s ' ) }  
                             s t y l e = { {  
                                 p a d d i n g :   ' 1 2 p x   2 4 p x ' ,  
                                 b a c k g r o u n d :   m d a T a b   = = =   ' s t r e n g t h s - i n s i g h t s '   ?   ' # 6 6 7 e e a '   :   ' t r a n s p a r e n t ' ,  
                                 c o l o r :   m d a T a b   = = =   ' s t r e n g t h s - i n s i g h t s '   ?   ' w h i t e '   :   ' # 6 4 7 4 8 b ' ,  
                                 b o r d e r :   ' n o n e ' ,  
                                 b o r d e r B o t t o m :   m d a T a b   = = =   ' s t r e n g t h s - i n s i g h t s '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t ' ,  
                                 f o n t S i z e :   ' 1 6 p x ' ,  
                                 f o n t W e i g h t :   ' 6 0 0 ' ,  
                                 c u r s o r :   ' p o i n t e r ' ,  
                                 b o r d e r R a d i u s :   ' 8 p x   8 p x   0   0 ' ,  
                                 t r a n s i t i o n :   ' a l l   0 . 2 s '  
                             } }  
                         >  
                             S t r e n g t h s   a n d   I n s i g h t s  
                         < / b u t t o n >  
                         < b u t t o n  
                             o n C l i c k = { ( )   = >   s e t M d a T a b ( ' k e y - m e t r i c s ' ) }  
                             s t y l e = { {  
                                 p a d d i n g :   ' 1 2 p x   2 4 p x ' ,  
                                 b a c k g r o u n d :   m d a T a b   = = =   ' k e y - m e t r i c s '   ?   ' # 6 6 7 e e a '   :   ' t r a n s p a r e n t ' ,  
                                 c o l o r :   m d a T a b   = = =   ' k e y - m e t r i c s '   ?   ' w h i t e '   :   ' # 6 4 7 4 8 b ' ,  
                                 b o r d e r :   ' n o n e ' ,  
                                 b o r d e r B o t t o m :   m d a T a b   = = =   ' k e y - m e t r i c s '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t ' ,  
                                 f o n t S i z e :   ' 1 6 p x ' ,  
                                 f o n t W e i g h t :   ' 6 0 0 ' ,  
                                 c u r s o r :   ' p o i n t e r ' ,  
                                 b o r d e r R a d i u s :   ' 8 p x   8 p x   0   0 ' ,  
                                 t r a n s i t i o n :   ' a l l   0 . 2 s '  
                             } }  
                         >  
                             C r i t i c a l   R e v i e w   I t e m s  
                         < / b u t t o n >  
                     < / d i v >  
  
                     { / *   E x e c u t i v e   S u m m a r y   T a b   * / }  
                     { m d a T a b   = = =   ' e x e c u t i v e - s u m m a r y '   & &   (  
                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                         < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 1 2 p x '   } } > E x e c u t i v e   S u m m a r y < / h 2 >  
                          
                         { / *   O v e r v i e w   M e t r i c s   * / }  
                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( 4 ,   1 f r ) ' ,   g a p :   ' 1 6 p x ' ,   m a r g i n B o t t o m :   ' 3 2 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                             < d i v   s t y l e = { {   t e x t A l i g n :   ' c e n t e r '   } } >  
                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } > F i n a n c i a l   S c o r e < / d i v >  
                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 2 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   f i n a l S c o r e   > =   7 0   ?   ' # 1 0 b 9 8 1 '   :   f i n a l S c o r e   > =   5 0   ?   ' # f 5 9 e 0 b '   :   ' # e f 4 4 4 4 '   } } > { f i n a l S c o r e . t o F i x e d ( 1 ) } < / d i v >  
                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   c o l o r :   ' # 9 4 a 3 b 8 '   } } > O v e r a l l   H e a l t h < / d i v >  
                             < / d i v >  
                             < d i v   s t y l e = { {   t e x t A l i g n :   ' c e n t e r '   } } >  
                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } > 2 4 - M o   G r o w t h < / d i v >  
                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 2 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   g r o w t h _ 2 4 m o   >   1 0   ?   ' # 1 0 b 9 8 1 '   :   g r o w t h _ 2 4 m o   >   0   ?   ' # f 5 9 e 0 b '   :   ' # e f 4 4 4 4 '   } } > { g r o w t h _ 2 4 m o . t o F i x e d ( 1 ) } % < / d i v >  
                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   c o l o r :   ' # 9 4 a 3 b 8 '   } } > R e v e n u e   T r e n d < / d i v >  
                             < / d i v >  
                             < d i v   s t y l e = { {   t e x t A l i g n :   ' c e n t e r '   } } >  
                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } > C u r r e n t   R a t i o < / d i v >  
                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 2 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   t r e n d D a t a [ t r e n d D a t a . l e n g t h   -   1 ] ? . c u r r e n t R a t i o   > =   1 . 5   ?   ' # 1 0 b 9 8 1 '   :   t r e n d D a t a [ t r e n d D a t a . l e n g t h   -   1 ] ? . c u r r e n t R a t i o   > =   1 . 0   ?   ' # f 5 9 e 0 b '   :   ' # e f 4 4 4 4 '   } } >  
                                     { t r e n d D a t a [ t r e n d D a t a . l e n g t h   -   1 ] ? . c u r r e n t R a t i o ? . t o F i x e d ( 1 ) }  
                                 < / d i v >  
                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   c o l o r :   ' # 9 4 a 3 b 8 '   } } > L i q u i d i t y < / d i v >  
                             < / d i v >  
                             < d i v   s t y l e = { {   t e x t A l i g n :   ' c e n t e r '   } } >  
                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } > B e n c h m a r k s < / d i v >  
                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 2 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   b e n c h m a r k s . l e n g t h   >   0   ?   ' # 6 6 7 e e a '   :   ' # 9 4 a 3 b 8 '   } } > { b e n c h m a r k s . l e n g t h } < / d i v >  
                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   c o l o r :   ' # 9 4 a 3 b 8 '   } } > A v a i l a b l e < / d i v >  
                             < / d i v >  
                         < / d i v >  
  
                         { / *   C o m p r e h e n s i v e   A n a l y s i s   N a r r a t i v e   * / }  
                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 8 p x '   } } >  
                             < h 3   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x ' ,   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 8 p x '   } } >  
                                 < s p a n   s t y l e = { {   f o n t S i z e :   ' 2 0 p x '   } } >  x `< / s p a n >   F i n a n c i a l   P e r f o r m a n c e   O v e r v i e w  
                             < / h 3 >  
                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 5 p x ' ,   l i n e H e i g h t :   ' 1 . 8 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   p a d d i n g :   ' 2 0 p x ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   b o r d e r L e f t :   ' 4 p x   s o l i d   # 6 6 7 e e a '   } } >  
                                 < p   s t y l e = { {   m a r g i n :   ' 0   0   1 2 p x   0 '   } } >  
                                     { c o m p a n y N a m e   | |   ' T h e   c o m p a n y ' }   h a s   a c h i e v e d   a   F i n a n c i a l   S c o r e   o f   < s t r o n g   s t y l e = { {   c o l o r :   ' # 1 e 2 9 3 b '   } } > { f i n a l S c o r e . t o F i x e d ( 1 ) } < / s t r o n g > ,   i n d i c a t i n g   < s t r o n g > { f i n a l S c o r e   > =   7 0   ?   ' s t r o n g '   :   f i n a l S c o r e   > =   5 0   ?   ' m o d e r a t e '   :   ' d e v e l o p i n g ' } < / s t r o n g >   o v e r a l l   f i n a n c i a l   h e a l t h .    
                                     T h e   a n a l y s i s   e n c o m p a s s e s   { m o n t h l y . l e n g t h }   m o n t h s   o f   f i n a n c i a l   d a t a ,   p r o v i d i n g   c o m p r e h e n s i v e   i n s i g h t s   i n t o   o p e r a t i o n a l   p e r f o r m a n c e ,   l i q u i d i t y   p o s i t i o n ,   a n d   s t r a t e g i c   p o s i t i o n i n g .  
                                 < / p >  
                                 < p   s t y l e = { {   m a r g i n :   ' 1 2 p x   0   0   0 '   } } >  
                                     O v e r   t h e   p a s t   2 4   m o n t h s ,   r e v e n u e   h a s   { g r o w t h _ 2 4 m o   >   0   ?   ' g r o w n '   :   ' d e c l i n e d ' }   b y   < s t r o n g   s t y l e = { {   c o l o r :   g r o w t h _ 2 4 m o   >   0   ?   ' # 1 0 b 9 8 1 '   :   ' # e f 4 4 4 4 '   } } > { M a t h . a b s ( g r o w t h _ 2 4 m o ) . t o F i x e d ( 1 ) } % < / s t r o n g > ,    
                                     w i t h   p r o f i t a b i l i t y   s c o r e   o f   < s t r o n g   s t y l e = { {   c o l o r :   ' # 1 e 2 9 3 b '   } } > { p r o f i t a b i l i t y S c o r e . t o F i x e d ( 1 ) } < / s t r o n g >   a n d   a s s e t   d e v e l o p m e n t   s c o r e   o f   < s t r o n g   s t y l e = { {   c o l o r :   ' # 1 e 2 9 3 b '   } } > { a s s e t D e v S c o r e . t o F i x e d ( 1 ) } < / s t r o n g > .    
                                     { b e n c h m a r k s . l e n g t h   >   0   ?   `   I n d u s t r y   b e n c h m a r k   c o m p a r i s o n s   a g a i n s t   $ { b e n c h m a r k s . l e n g t h }   m e t r i c s   r e v e a l   $ { m d a A n a l y s i s . s t r e n g t h s . f i l t e r ( ( s :   s t r i n g )   = >   s . i n c l u d e s ( ' i n d u s t r y ' ) ) . l e n g t h }   a r e a s   o f   s u p e r i o r   p e r f o r m a n c e   a n d   $ { m d a A n a l y s i s . w e a k n e s s e s . f i l t e r ( ( w :   s t r i n g )   = >   w . i n c l u d e s ( ' i n d u s t r y ' ) ) . l e n g t h }   o p p o r t u n i t i e s   f o r   i m p r o v e m e n t   r e l a t i v e   t o   i n d u s t r y   p e e r s . `   :   ' ' }  
                                 < / p >  
                             < / d i v >  
                         < / d i v >  
                          
                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                             < h 3   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 0 b 9 8 1 ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 8 p x '   } } >  
                                 < s p a n   s t y l e = { {   f o n t S i z e :   ' 2 0 p x '   } } >  S < / s p a n >   K e y   S t r e n g t h s   &   C o m p e t i t i v e   A d v a n t a g e s  
                             < / h 3 >  
                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 5 p x ' ,   l i n e H e i g h t :   ' 1 . 8 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } >  
                                 { m d a A n a l y s i s . s t r e n g t h s . l e n g t h   >   0   ?   (  
                                     < u l   s t y l e = { {   m a r g i n :   0 ,   p a d d i n g L e f t :   ' 2 4 p x '   } } >  
                                         { m d a A n a l y s i s . s t r e n g t h s . m a p ( ( s t r :   s t r i n g ,   i d x :   n u m b e r )   = >   (  
                                             < l i   k e y = { i d x }   s t y l e = { {   m a r g i n B o t t o m :   ' 8 p x '   } } > { s t r } < / l i >  
                                         ) ) }  
                                     < / u l >  
                                 )   :   (  
                                     < p   s t y l e = { {   m a r g i n :   0 ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > T h e   c o m p a n y   i s   s h o w i n g   s t a b l e   f i n a n c i a l   p e r f o r m a n c e   a c r o s s   k e y   m e t r i c s .   C o n t i n u e d   m o n i t o r i n g   w i l l   h e l p   i d e n t i f y   e m e r g i n g   s t r e n g t h s . < / p >  
                                 ) }  
                             < / d i v >  
                         < / d i v >  
  
                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                             < h 3   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # e f 4 4 4 4 ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 8 p x '   } } >  
                                 < s p a n   s t y l e = { {   f o n t S i z e :   ' 2 0 p x '   } } >  a < / s p a n >   A r e a s   R e q u i r i n g   M a n a g e m e n t   A t t e n t i o n  
                             < / h 3 >  
                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 5 p x ' ,   l i n e H e i g h t :   ' 1 . 8 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } >  
                                 { m d a A n a l y s i s . w e a k n e s s e s . l e n g t h   >   0   ?   (  
                                     < u l   s t y l e = { {   m a r g i n :   0 ,   p a d d i n g L e f t :   ' 2 4 p x '   } } >  
                                         { m d a A n a l y s i s . w e a k n e s s e s . m a p ( ( w e a k :   s t r i n g ,   i d x :   n u m b e r )   = >   (  
                                             < l i   k e y = { i d x }   s t y l e = { {   m a r g i n B o t t o m :   ' 8 p x '   } } > { w e a k } < / l i >  
                                         ) ) }  
                                     < / u l >  
                                 )   :   (  
                                     < p   s t y l e = { {   m a r g i n :   0 ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > C o n t i n u e   m o n i t o r i n g   k e y   f i n a n c i a l   i n d i c a t o r s   t o   m a i n t a i n   c u r r e n t   p e r f o r m a n c e   l e v e l s   a n d   i d e n t i f y   p o t e n t i a l   c h a l l e n g e s   e a r l y . < / p >  
                                 ) }  
                             < / d i v >  
                         < / d i v >  
  
                         < d i v >  
                             < h 3   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 6 7 e e a ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 8 p x '   } } >  
                                 < s p a n   s t y l e = { {   f o n t S i z e :   ' 2 0 p x '   } } >  x  < / s p a n >   S t r a t e g i c   R e c o m m e n d a t i o n s   &   A c t i o n   I t e m s  
                             < / h 3 >  
                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 5 p x ' ,   l i n e H e i g h t :   ' 1 . 8 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } >  
                                 { m d a A n a l y s i s . i n s i g h t s . l e n g t h   >   0   ?   (  
                                     < u l   s t y l e = { {   m a r g i n :   0 ,   p a d d i n g L e f t :   ' 2 4 p x '   } } >  
                                         { m d a A n a l y s i s . i n s i g h t s . m a p ( ( i n s :   s t r i n g ,   i d x :   n u m b e r )   = >   (  
                                             < l i   k e y = { i d x }   s t y l e = { {   m a r g i n B o t t o m :   ' 8 p x '   } } > { i n s } < / l i >  
                                         ) ) }  
                                     < / u l >  
                                 )   :   (  
                                     < p   s t y l e = { {   m a r g i n :   0 ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > R e g u l a r   r e v i e w   o f   f i n a n c i a l   m e t r i c s   a n d   s t r a t e g i c   p l a n n i n g   w i l l   s u p p o r t   c o n t i n u e d   g r o w t h   a n d   f i n a n c i a l   s t a b i l i t y . < / p >  
                                 ) }  
                             < / d i v >  
                         < / d i v >  
                     < / d i v >  
                     ) }  
  
                     { / *   S t r e n g t h s   a n d   I n s i g h t s   T a b   * / }  
                     { m d a T a b   = = =   ' s t r e n g t h s - i n s i g h t s '   & &   (  
                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g a p :   ' 2 4 p x '   } } >  
                         { m d a A n a l y s i s . s t r e n g t h s . l e n g t h   >   0   & &   (  
                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                 < h 3   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 0 b 9 8 1 ' ,   m a r g i n B o t t o m :   ' 1 6 p x ' ,   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 8 p x '   } } >  
                                     < s p a n   s t y l e = { {   f o n t S i z e :   ' 2 4 p x '   } } >  S < / s p a n >   S t r e n g t h s  
                                 < / h 3 >  
                                 < u l   s t y l e = { {   l i s t S t y l e :   ' n o n e ' ,   p a d d i n g :   0 ,   m a r g i n :   0   } } >  
                                     { m d a A n a l y s i s . s t r e n g t h s . m a p ( ( s t r ,   i d x )   = >   (  
                                         < l i   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 1 2 p x   1 6 p x ' ,   b a c k g r o u n d :   ' # f 0 f d f 4 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   b o r d e r L e f t :   ' 4 p x   s o l i d   # 1 0 b 9 8 1 ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 6 6 5 3 4 '   } } > { s t r } < / l i >  
                                     ) ) }  
                                 < / u l >  
                             < / d i v >  
                         ) }  
  
                         { m d a A n a l y s i s . w e a k n e s s e s . l e n g t h   >   0   & &   (  
                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                 < h 3   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # e f 4 4 4 4 ' ,   m a r g i n B o t t o m :   ' 1 6 p x ' ,   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 8 p x '   } } >  
                                     < s p a n   s t y l e = { {   f o n t S i z e :   ' 2 4 p x '   } } >  a < / s p a n >   A r e a s   f o r   I m p r o v e m e n t  
                                 < / h 3 >  
                                 < u l   s t y l e = { {   l i s t S t y l e :   ' n o n e ' ,   p a d d i n g :   0 ,   m a r g i n :   0   } } >  
                                     { m d a A n a l y s i s . w e a k n e s s e s . m a p ( ( w e a k ,   i d x )   = >   (  
                                         < l i   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 1 2 p x   1 6 p x ' ,   b a c k g r o u n d :   ' # f e f 2 f 2 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   b o r d e r L e f t :   ' 4 p x   s o l i d   # e f 4 4 4 4 ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 9 9 1 b 1 b '   } } > { w e a k } < / l i >  
                                     ) ) }  
                                 < / u l >  
                             < / d i v >  
                         ) }  
  
                         { m d a A n a l y s i s . i n s i g h t s . l e n g t h   >   0   & &   (  
                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                 < h 3   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 6 7 e e a ' ,   m a r g i n B o t t o m :   ' 1 6 p x ' ,   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 8 p x '   } } >  
                                     < s p a n   s t y l e = { {   f o n t S i z e :   ' 2 4 p x '   } } >  x  < / s p a n >   S t r a t e g i c   I n s i g h t s  
                                 < / h 3 >  
                                 < u l   s t y l e = { {   l i s t S t y l e :   ' n o n e ' ,   p a d d i n g :   0 ,   m a r g i n :   0   } } >  
                                     { m d a A n a l y s i s . i n s i g h t s . m a p ( ( i n s ,   i d x )   = >   (  
                                         < l i   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 1 2 p x   1 6 p x ' ,   b a c k g r o u n d :   ' # e d e 9 f e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   b o r d e r L e f t :   ' 4 p x   s o l i d   # 6 6 7 e e a ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 5 b 2 1 b 6 '   } } > { i n s } < / l i >  
                                     ) ) }  
                                 < / u l >  
                             < / d i v >  
                         ) }  
                     < / d i v >  
                     ) }  
  
                     { / *   C r i t i c a l   R e v i e w   I t e m s   T a b   * / }  
                     { m d a T a b   = = =   ' k e y - m e t r i c s '   & &   m o n t h l y . l e n g t h   > =   1 2   & &   (  
                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                         < h 2   s t y l e = { {   f o n t S i z e :   ' 2 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o r d e r B o t t o m :   ' 3 p x   s o l i d   # e f 4 4 4 4 ' ,   p a d d i n g B o t t o m :   ' 1 2 p x '   } } >  
                              a      C r i t i c a l   R e v i e w   I t e m s  
                         < / h 2 >  
                          
                         < p   s t y l e = { {   f o n t S i z e :   ' 1 5 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 3 2 p x ' ,   l i n e H e i g h t :   ' 1 . 6 '   } } >  
                             T h i s   a n a l y s i s   r e v i e w s   a l l   f i n a n c i a l   d a t a   a c r o s s   T r e n d   A n a l y s i s ,   K P I   D a s h b o a r d ,   W o r k i n g   C a p i t a l ,   a n d   C a s h   F l o w   t o   i d e n t i f y   i s s u e s   r e q u i r i n g   i m m e d i a t e   a t t e n t i o n .  
                         < / p >  
  
                         { ( ( )   = >   {  
                             c o n s t   i s s u e s :   {   c a t e g o r y :   s t r i n g ;   s e v e r i t y :   ' h i g h '   |   ' m e d i u m '   |   ' l o w ' ;   t i t l e :   s t r i n g ;   d e s c r i p t i o n :   s t r i n g ;   m e t r i c ? :   s t r i n g   } [ ]   =   [ ] ;  
                             c o n s t   l a s t   =   m o n t h l y [ m o n t h l y . l e n g t h   -   1 ] ;  
                             c o n s t   p r e v   =   m o n t h l y . l e n g t h   > =   2   ?   m o n t h l y [ m o n t h l y . l e n g t h   -   2 ]   :   l a s t ;  
                             c o n s t   l a s t 1 2   =   m o n t h l y . s l i c e ( - 1 2 ) ;  
                             c o n s t   p r e v 1 2   =   m o n t h l y . l e n g t h   > =   2 4   ?   m o n t h l y . s l i c e ( - 2 4 ,   - 1 2 )   :   l a s t 1 2 ;  
  
                             / /   = = =   R E V E N U E   T R E N D   A N A L Y S I S   = = =  
                             c o n s t   r e v e n u e G r o w t h 1 2 m o   =   p r e v 1 2 . l e n g t h   >   0   ?    
                                 ( ( l a s t 1 2 . r e d u c e ( ( s ,   m )   = >   s   +   m . r e v e n u e ,   0 )   -   p r e v 1 2 . r e d u c e ( ( s ,   m )   = >   s   +   m . r e v e n u e ,   0 ) )   /   p r e v 1 2 . r e d u c e ( ( s ,   m )   = >   s   +   m . r e v e n u e ,   0 ) )   *   1 0 0   :   0 ;  
                              
                             i f   ( r e v e n u e G r o w t h 1 2 m o   <   - 5 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' R e v e n u e   T r e n d s ' ,  
                                     s e v e r i t y :   ' h i g h ' ,  
                                     t i t l e :   ' D e c l i n i n g   R e v e n u e ' ,  
                                     d e s c r i p t i o n :   ` R e v e n u e   h a s   d e c l i n e d   b y   $ { M a t h . a b s ( r e v e n u e G r o w t h 1 2 m o ) . t o F i x e d ( 1 ) } %   o v e r   t h e   p a s t   1 2   m o n t h s .   T h i s   i n d i c a t e s   p o t e n t i a l   m a r k e t   s h a r e   l o s s ,   p r i c i n g   p r e s s u r e ,   o r   c u s t o m e r   a t t r i t i o n . ` ,  
                                     m e t r i c :   ` $ { r e v e n u e G r o w t h 1 2 m o . t o F i x e d ( 1 ) } % `  
                                 } ) ;  
                             }  
  
                             / /   C h e c k   r e v e n u e   v o l a t i l i t y  
                             c o n s t   r e v e n u e S t d D e v   =   ( ( )   = >   {  
                                 c o n s t   m e a n   =   l a s t 1 2 . r e d u c e ( ( s ,   m )   = >   s   +   m . r e v e n u e ,   0 )   /   l a s t 1 2 . l e n g t h ;  
                                 c o n s t   v a r i a n c e   =   l a s t 1 2 . r e d u c e ( ( s ,   m )   = >   s   +   M a t h . p o w ( m . r e v e n u e   -   m e a n ,   2 ) ,   0 )   /   l a s t 1 2 . l e n g t h ;  
                                 r e t u r n   M a t h . s q r t ( v a r i a n c e ) ;  
                             } ) ( ) ;  
                             c o n s t   r e v e n u e C V   =   ( r e v e n u e S t d D e v   /   ( l a s t 1 2 . r e d u c e ( ( s ,   m )   = >   s   +   m . r e v e n u e ,   0 )   /   l a s t 1 2 . l e n g t h ) )   *   1 0 0 ;  
                              
                             i f   ( r e v e n u e C V   >   2 5 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' R e v e n u e   T r e n d s ' ,  
                                     s e v e r i t y :   ' m e d i u m ' ,  
                                     t i t l e :   ' H i g h   R e v e n u e   V o l a t i l i t y ' ,  
                                     d e s c r i p t i o n :   ` R e v e n u e   s h o w s   h i g h   v o l a t i l i t y   ( $ { r e v e n u e C V . t o F i x e d ( 1 ) } %   c o e f f i c i e n t   o f   v a r i a t i o n ) .   T h i s   i n d i c a t e s   i n c o n s i s t e n t   s a l e s   p e r f o r m a n c e   a n d   u n p r e d i c t a b l e   c a s h   f l o w . ` ,  
                                     m e t r i c :   ` $ { r e v e n u e C V . t o F i x e d ( 1 ) } %   C V `  
                                 } ) ;  
                             }  
  
                             / /   = = =   E X P E N S E   A N A L Y S I S   = = =  
                             c o n s t   e x p e n s e G r o w t h 1 2 m o   =   p r e v 1 2 . l e n g t h   >   0   ?  
                                 ( ( l a s t 1 2 . r e d u c e ( ( s ,   m )   = >   s   +   m . e x p e n s e ,   0 )   -   p r e v 1 2 . r e d u c e ( ( s ,   m )   = >   s   +   m . e x p e n s e ,   0 ) )   /   p r e v 1 2 . r e d u c e ( ( s ,   m )   = >   s   +   m . e x p e n s e ,   0 ) )   *   1 0 0   :   0 ;  
                              
                             i f   ( e x p e n s e G r o w t h 1 2 m o   >   r e v e n u e G r o w t h 1 2 m o   +   5 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' E x p e n s e   C o n t r o l ' ,  
                                     s e v e r i t y :   ' h i g h ' ,  
                                     t i t l e :   ' E x p e n s e s   G r o w i n g   F a s t e r   T h a n   R e v e n u e ' ,  
                                     d e s c r i p t i o n :   ` E x p e n s e s   h a v e   g r o w n   $ { e x p e n s e G r o w t h 1 2 m o . t o F i x e d ( 1 ) } %   w h i l e   r e v e n u e   g r e w   $ { r e v e n u e G r o w t h 1 2 m o . t o F i x e d ( 1 ) } % .   T h i s   m a r g i n   c o m p r e s s i o n   t h r e a t e n s   p r o f i t a b i l i t y   a n d   r e q u i r e s   i m m e d i a t e   c o s t   c o n t r o l   m e a s u r e s . ` ,  
                                     m e t r i c :   ` $ { ( e x p e n s e G r o w t h 1 2 m o   -   r e v e n u e G r o w t h 1 2 m o ) . t o F i x e d ( 1 ) } %   g a p `  
                                 } ) ;  
                             }  
  
                             / /   E x p e n s e   a s   %   o f   r e v e n u e   t r e n d i n g  
                             c o n s t   e x p e n s e R a t i o   =   ( l a s t . e x p e n s e   /   l a s t . r e v e n u e )   *   1 0 0 ;  
                             c o n s t   p r e v E x p e n s e R a t i o   =   p r e v 1 2 . l e n g t h   >   0   ?   ( p r e v 1 2 . r e d u c e ( ( s ,   m )   = >   s   +   m . e x p e n s e ,   0 )   /   p r e v 1 2 . r e d u c e ( ( s ,   m )   = >   s   +   m . r e v e n u e ,   0 ) )   *   1 0 0   :   e x p e n s e R a t i o ;  
                              
                             i f   ( e x p e n s e R a t i o   >   9 0 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' E x p e n s e   C o n t r o l ' ,  
                                     s e v e r i t y :   ' h i g h ' ,  
                                     t i t l e :   ' E x t r e m e l y   H i g h   E x p e n s e   R a t i o ' ,  
                                     d e s c r i p t i o n :   ` T o t a l   e x p e n s e s   r e p r e s e n t   $ { e x p e n s e R a t i o . t o F i x e d ( 1 ) } %   o f   r e v e n u e ,   l e a v i n g   m i n i m a l   p r o f i t   m a r g i n .   T h e   b u s i n e s s   i s   o p e r a t i n g   n e a r   b r e a k - e v e n   o r   a t   a   l o s s . ` ,  
                                     m e t r i c :   ` $ { e x p e n s e R a t i o . t o F i x e d ( 1 ) } % `  
                                 } ) ;  
                             }   e l s e   i f   ( e x p e n s e R a t i o   -   p r e v E x p e n s e R a t i o   >   5 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' E x p e n s e   C o n t r o l ' ,  
                                     s e v e r i t y :   ' m e d i u m ' ,  
                                     t i t l e :   ' R i s i n g   E x p e n s e   R a t i o ' ,  
                                     d e s c r i p t i o n :   ` E x p e n s e s   a s   a   p e r c e n t a g e   o f   r e v e n u e   h a v e   i n c r e a s e d   f r o m   $ { p r e v E x p e n s e R a t i o . t o F i x e d ( 1 ) } %   t o   $ { e x p e n s e R a t i o . t o F i x e d ( 1 ) } % ,   i n d i c a t i n g   d e t e r i o r a t i n g   o p e r a t i o n a l   e f f i c i e n c y . ` ,  
                                     m e t r i c :   ` + $ { ( e x p e n s e R a t i o   -   p r e v E x p e n s e R a t i o ) . t o F i x e d ( 1 ) } % `  
                                 } ) ;  
                             }  
  
                             / /   = = =   L I Q U I D I T Y   &   R A T I O S   = = =  
                             i f   ( l a s t . c u r r e n t R a t i o   <   1 . 0 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' L i q u i d i t y ' ,  
                                     s e v e r i t y :   ' h i g h ' ,  
                                     t i t l e :   ' C r i t i c a l   L i q u i d i t y   P o s i t i o n ' ,  
                                     d e s c r i p t i o n :   ` C u r r e n t   r a t i o   o f   $ { l a s t . c u r r e n t R a t i o . t o F i x e d ( 2 ) }   i n d i c a t e s   c u r r e n t   l i a b i l i t i e s   e x c e e d   c u r r e n t   a s s e t s .   T h e   c o m p a n y   m a y   s t r u g g l e   t o   m e e t   s h o r t - t e r m   o b l i g a t i o n s . ` ,  
                                     m e t r i c :   ` $ { l a s t . c u r r e n t R a t i o . t o F i x e d ( 2 ) } `  
                                 } ) ;  
                             }   e l s e   i f   ( l a s t . c u r r e n t R a t i o   <   1 . 2 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' L i q u i d i t y ' ,  
                                     s e v e r i t y :   ' m e d i u m ' ,  
                                     t i t l e :   ' W e a k   L i q u i d i t y   P o s i t i o n ' ,  
                                     d e s c r i p t i o n :   ` C u r r e n t   r a t i o   o f   $ { l a s t . c u r r e n t R a t i o . t o F i x e d ( 2 ) }   i s   b e l o w   t h e   h e a l t h y   t h r e s h o l d   o f   1 . 5 ,   i n d i c a t i n g   p o t e n t i a l   d i f f i c u l t y   c o v e r i n g   s h o r t - t e r m   o b l i g a t i o n s . ` ,  
                                     m e t r i c :   ` $ { l a s t . c u r r e n t R a t i o . t o F i x e d ( 2 ) } `  
                                 } ) ;  
                             }  
  
                             / /   Q u i c k   r a t i o  
                             i f   ( l a s t . q u i c k R a t i o   <   0 . 8 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' L i q u i d i t y ' ,  
                                     s e v e r i t y :   l a s t . q u i c k R a t i o   <   0 . 5   ?   ' h i g h '   :   ' m e d i u m ' ,  
                                     t i t l e :   ' P o o r   Q u i c k   R a t i o ' ,  
                                     d e s c r i p t i o n :   ` Q u i c k   r a t i o   o f   $ { l a s t . q u i c k R a t i o . t o F i x e d ( 2 ) }   s h o w s   t h e   c o m p a n y   c a n n o t   c o v e r   c u r r e n t   l i a b i l i t i e s   w i t h   l i q u i d   a s s e t s .   H e a v y   r e l i a n c e   o n   i n v e n t o r y   o r   o t h e r   l e s s   l i q u i d   a s s e t s . ` ,  
                                     m e t r i c :   ` $ { l a s t . q u i c k R a t i o . t o F i x e d ( 2 ) } `  
                                 } ) ;  
                             }  
  
                             / /   D e b t   r a t i o s  
                             c o n s t   d e b t T o E q u i t y   =   l a s t . t o t a l E q u i t y   >   0   ?   l a s t . t o t a l L i a b   /   l a s t . t o t a l E q u i t y   :   9 9 9 ;  
                             i f   ( d e b t T o E q u i t y   >   2 . 0 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' L e v e r a g e ' ,  
                                     s e v e r i t y :   ' h i g h ' ,  
                                     t i t l e :   ' H i g h   D e b t   L e v e r a g e ' ,  
                                     d e s c r i p t i o n :   ` D e b t - t o - e q u i t y   r a t i o   o f   $ { d e b t T o E q u i t y . t o F i x e d ( 2 ) }   i n d i c a t e s   t h e   c o m p a n y   i s   h e a v i l y   l e v e r a g e d .   H i g h   d e b t   l e v e l s   i n c r e a s e   f i n a n c i a l   r i s k   a n d   i n t e r e s t   e x p e n s e s . ` ,  
                                     m e t r i c :   ` $ { d e b t T o E q u i t y . t o F i x e d ( 2 ) } x `  
                                 } ) ;  
                             }  
  
                             c o n s t   d e b t R a t i o   =   l a s t . t o t a l A s s e t s   >   0   ?   ( l a s t . t o t a l L i a b   /   l a s t . t o t a l A s s e t s )   *   1 0 0   :   0 ;  
                             i f   ( d e b t R a t i o   >   7 0 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' L e v e r a g e ' ,  
                                     s e v e r i t y :   ' m e d i u m ' ,  
                                     t i t l e :   ' H i g h   D e b t   R a t i o ' ,  
                                     d e s c r i p t i o n :   ` $ { d e b t R a t i o . t o F i x e d ( 1 ) } %   o f   a s s e t s   a r e   f i n a n c e d   b y   d e b t ,   i n d i c a t i n g   h i g h   f i n a n c i a l   l e v e r a g e   a n d   p o t e n t i a l   v u l n e r a b i l i t y   t o   e c o n o m i c   d o w n t u r n s . ` ,  
                                     m e t r i c :   ` $ { d e b t R a t i o . t o F i x e d ( 1 ) } % `  
                                 } ) ;  
                             }  
  
                             / /   = = =   P R O F I T A B I L I T Y   = = =  
                             c o n s t   n e t M a r g i n   =   l a s t . r e v e n u e   >   0   ?   ( ( l a s t . r e v e n u e   -   l a s t . e x p e n s e )   /   l a s t . r e v e n u e )   *   1 0 0   :   0 ;  
                             i f   ( n e t M a r g i n   <   0 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' P r o f i t a b i l i t y ' ,  
                                     s e v e r i t y :   ' h i g h ' ,  
                                     t i t l e :   ' O p e r a t i n g   a t   a   L o s s ' ,  
                                     d e s c r i p t i o n :   ` N e t   m a r g i n   o f   $ { n e t M a r g i n . t o F i x e d ( 1 ) } %   i n d i c a t e s   t h e   c o m p a n y   i s   l o s i n g   m o n e y   o n   o p e r a t i o n s .   I m m e d i a t e   a c t i o n   r e q u i r e d   t o   r e s t o r e   p r o f i t a b i l i t y . ` ,  
                                     m e t r i c :   ` $ { n e t M a r g i n . t o F i x e d ( 1 ) } % `  
                                 } ) ;  
                             }   e l s e   i f   ( n e t M a r g i n   <   5 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' P r o f i t a b i l i t y ' ,  
                                     s e v e r i t y :   ' m e d i u m ' ,  
                                     t i t l e :   ' T h i n   P r o f i t   M a r g i n s ' ,  
                                     d e s c r i p t i o n :   ` N e t   m a r g i n   o f   $ { n e t M a r g i n . t o F i x e d ( 1 ) } %   p r o v i d e s   l i t t l e   b u f f e r   f o r   u n e x p e c t e d   c o s t s   o r   r e v e n u e   s h o r t f a l l s .   M a r g i n   i m p r o v e m e n t   s t r a t e g i e s   s h o u l d   b e   p r i o r i t i z e d . ` ,  
                                     m e t r i c :   ` $ { n e t M a r g i n . t o F i x e d ( 1 ) } % `  
                                 } ) ;  
                             }  
  
                             / /   R O E  
                             i f   ( l a s t . r o e   <   0 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' P r o f i t a b i l i t y ' ,  
                                     s e v e r i t y :   ' h i g h ' ,  
                                     t i t l e :   ' N e g a t i v e   R e t u r n   o n   E q u i t y ' ,  
                                     d e s c r i p t i o n :   ` R O E   o f   $ { ( l a s t . r o e   *   1 0 0 ) . t o F i x e d ( 1 ) } %   i n d i c a t e s   t h e   c o m p a n y   i s   d e s t r o y i n g   s h a r e h o l d e r   v a l u e .   E q u i t y   h o l d e r s   a r e   r e c e i v i n g   n e g a t i v e   r e t u r n s . ` ,  
                                     m e t r i c :   ` $ { ( l a s t . r o e   *   1 0 0 ) . t o F i x e d ( 1 ) } % `  
                                 } ) ;  
                             }   e l s e   i f   ( l a s t . r o e   <   0 . 0 5 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' P r o f i t a b i l i t y ' ,  
                                     s e v e r i t y :   ' m e d i u m ' ,  
                                     t i t l e :   ' L o w   R e t u r n   o n   E q u i t y ' ,  
                                     d e s c r i p t i o n :   ` R O E   o f   $ { ( l a s t . r o e   *   1 0 0 ) . t o F i x e d ( 1 ) } %   i s   b e l o w   t y p i c a l   m a r k e t   r e t u r n s .   S h a r e h o l d e r s   c o u l d   a c h i e v e   b e t t e r   r e t u r n s   e l s e w h e r e . ` ,  
                                     m e t r i c :   ` $ { ( l a s t . r o e   *   1 0 0 ) . t o F i x e d ( 1 ) } % `  
                                 } ) ;  
                             }  
  
                             / /   = = =   W O R K I N G   C A P I T A L   = = =  
                             c o n s t   w o r k i n g C a p i t a l   =   l a s t . t c a   -   l a s t . t c l ;  
                             c o n s t   w c R a t i o   =   l a s t . r e v e n u e   >   0   ?   ( w o r k i n g C a p i t a l   /   ( l a s t . r e v e n u e   /   1 2 ) )   *   1 0 0   :   0 ;  
                              
                             i f   ( w o r k i n g C a p i t a l   <   0 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' W o r k i n g   C a p i t a l ' ,  
                                     s e v e r i t y :   ' h i g h ' ,  
                                     t i t l e :   ' N e g a t i v e   W o r k i n g   C a p i t a l ' ,  
                                     d e s c r i p t i o n :   ` W o r k i n g   c a p i t a l   o f   $ $ { w o r k i n g C a p i t a l . t o L o c a l e S t r i n g ( ) }   i n d i c a t e s   c u r r e n t   l i a b i l i t i e s   e x c e e d   c u r r e n t   a s s e t s .   T h i s   c r e a t e s   i m m e d i a t e   c a s h   f l o w   p r e s s u r e   a n d   o p e r a t i o n a l   c o n s t r a i n t s . ` ,  
                                     m e t r i c :   ` $ $ { w o r k i n g C a p i t a l . t o L o c a l e S t r i n g ( ) } `  
                                 } ) ;  
                             }  
  
                             / /   D a y s   S a l e s   O u t s t a n d i n g  
                             c o n s t   d s o   =   l a s t . r e v e n u e   >   0   ?   ( l a s t . a r   /   ( l a s t . r e v e n u e   /   3 6 5 ) )   :   0 ;  
                             i f   ( d s o   >   6 0 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' W o r k i n g   C a p i t a l ' ,  
                                     s e v e r i t y :   ' m e d i u m ' ,  
                                     t i t l e :   ' S l o w   A c c o u n t s   R e c e i v a b l e   C o l l e c t i o n ' ,  
                                     d e s c r i p t i o n :   ` D a y s   S a l e s   O u t s t a n d i n g   o f   $ { d s o . t o F i x e d ( 0 ) }   d a y s   i n d i c a t e s   s l o w   c u s t o m e r   p a y m e n t s .   T h i s   t i e s   u p   c a s h   a n d   m a y   s i g n a l   c r e d i t   q u a l i t y   i s s u e s . ` ,  
                                     m e t r i c :   ` $ { d s o . t o F i x e d ( 0 ) }   d a y s `  
                                 } ) ;  
                             }  
  
                             / /   D a y s   P a y a b l e   O u t s t a n d i n g  
                             c o n s t   d p o   =   l a s t . e x p e n s e   >   0   ?   ( l a s t . a p   /   ( l a s t . e x p e n s e   /   3 6 5 ) )   :   0 ;  
                             i f   ( d p o   >   9 0 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' W o r k i n g   C a p i t a l ' ,  
                                     s e v e r i t y :   ' m e d i u m ' ,  
                                     t i t l e :   ' E x t e n d e d   P a y m e n t   T e r m s   t o   S u p p l i e r s ' ,  
                                     d e s c r i p t i o n :   ` D a y s   P a y a b l e   O u t s t a n d i n g   o f   $ { d p o . t o F i x e d ( 0 ) }   d a y s   m a y   i n d i c a t e   c a s h   f l o w   s t r e s s ,   c a u s i n g   t h e   c o m p a n y   t o   d e l a y   s u p p l i e r   p a y m e n t s . ` ,  
                                     m e t r i c :   ` $ { d p o . t o F i x e d ( 0 ) }   d a y s `  
                                 } ) ;  
                             }  
  
                             / /   = = =   C A S H   F L O W   ( i f   w e   h a v e   t h e   d a t a )   = = =  
                             c o n s t   n e t I n c o m e   =   l a s t . r e v e n u e   -   l a s t . e x p e n s e ;  
                             c o n s t   w o r k i n g C a p i t a l C h a n g e   =   m o n t h l y . l e n g t h   > =   2   ?   ( l a s t . t c a   -   l a s t . t c l )   -   ( p r e v . t c a   -   p r e v . t c l )   :   0 ;  
                             c o n s t   e s t i m a t e d O C F   =   n e t I n c o m e   -   w o r k i n g C a p i t a l C h a n g e ;  
                              
                             i f   ( e s t i m a t e d O C F   <   0   & &   n e t I n c o m e   >   0 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' C a s h   F l o w ' ,  
                                     s e v e r i t y :   ' h i g h ' ,  
                                     t i t l e :   ' N e g a t i v e   O p e r a t i n g   C a s h   F l o w   D e s p i t e   P r o f i t s ' ,  
                                     d e s c r i p t i o n :   ` W h i l e   s h o w i n g   a c c o u n t i n g   p r o f i t s ,   t h e   c o m p a n y   i s   c o n s u m i n g   c a s h   i n   o p e r a t i o n s   ( e s t i m a t e d   - $ $ { M a t h . a b s ( e s t i m a t e d O C F ) . t o L o c a l e S t r i n g ( ) } ) .   T h i s   o f t e n   r e s u l t s   f r o m   w o r k i n g   c a p i t a l   b u i l d - u p   o r   n o n - c a s h   r e v e n u e . ` ,  
                                     m e t r i c :   ` - $ $ { M a t h . a b s ( e s t i m a t e d O C F ) . t o L o c a l e S t r i n g ( ) } `  
                                 } ) ;  
                             }  
  
                             / /   C a s h   p o s i t i o n   d e c l i n i n g  
                             i f   ( m o n t h l y . l e n g t h   > =   6 )   {  
                                 c o n s t   c a s h T r e n d   =   l a s t . c a s h   -   m o n t h l y [ m o n t h l y . l e n g t h   -   6 ] . c a s h ;  
                                 c o n s t   c a s h T r e n d P c t   =   m o n t h l y [ m o n t h l y . l e n g t h   -   6 ] . c a s h   >   0   ?   ( c a s h T r e n d   /   m o n t h l y [ m o n t h l y . l e n g t h   -   6 ] . c a s h )   *   1 0 0   :   0 ;  
                                 i f   ( c a s h T r e n d P c t   <   - 2 0 )   {  
                                     i s s u e s . p u s h ( {  
                                         c a t e g o r y :   ' C a s h   F l o w ' ,  
                                         s e v e r i t y :   ' h i g h ' ,  
                                         t i t l e :   ' R a p i d   C a s h   D e p l e t i o n ' ,  
                                         d e s c r i p t i o n :   ` C a s h   h a s   d e c l i n e d   $ { M a t h . a b s ( c a s h T r e n d P c t ) . t o F i x e d ( 1 ) } %   o v e r   t h e   p a s t   6   m o n t h s .   A t   t h i s   b u r n   r a t e ,   c a s h   r e s e r v e s   m a y   b e   e x h a u s t e d   q u i c k l y   w i t h o u t   c o r r e c t i v e   a c t i o n . ` ,  
                                         m e t r i c :   ` $ { c a s h T r e n d P c t . t o F i x e d ( 1 ) } % `  
                                     } ) ;  
                                 }  
                             }  
  
                             / /   = = =   A S S E T   E F F I C I E N C Y   = = =  
                             c o n s t   a s s e t T u r n o v e r   =   l a s t . t o t a l A s s e t s   >   0   ?   ( l a s t . r e v e n u e   *   1 2 )   /   l a s t . t o t a l A s s e t s   :   0 ;  
                             i f   ( a s s e t T u r n o v e r   <   0 . 5 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' A s s e t   E f f i c i e n c y ' ,  
                                     s e v e r i t y :   ' l o w ' ,  
                                     t i t l e :   ' L o w   A s s e t   T u r n o v e r ' ,  
                                     d e s c r i p t i o n :   ` A s s e t   t u r n o v e r   o f   $ { a s s e t T u r n o v e r . t o F i x e d ( 2 ) } x   i n d i c a t e s   a s s e t s   a r e   n o t   b e i n g   u t i l i z e d   e f f i c i e n t l y   t o   g e n e r a t e   r e v e n u e .   C o n s i d e r   a s s e t   o p t i m i z a t i o n   o r   d i v e s t i t u r e . ` ,  
                                     m e t r i c :   ` $ { a s s e t T u r n o v e r . t o F i x e d ( 2 ) } x `  
                                 } ) ;  
                             }  
  
                             / /   = = =   E X P E N S E   C A T E G O R Y   A N A L Y S I S   ( %   o f   R e v e n u e )   = = =  
                             c o n s t   e x p e n s e C a t e g o r i e s   =   [  
                                 {   k e y :   ' c o g s T o t a l ' ,   n a m e :   ' C O G S   T o t a l ' ,   t h r e s h o l d :   7 0   } ,  
                                 {   k e y :   ' c o g s P a y r o l l ' ,   n a m e :   ' C O G S   P a y r o l l ' ,   t h r e s h o l d :   3 5   } ,  
                                 {   k e y :   ' o p e r a t i n g E x p e n s e T o t a l ' ,   n a m e :   ' O p e r a t i n g   E x p e n s e s ' ,   t h r e s h o l d :   4 0   } ,  
                                 {   k e y :   ' o p e x P a y r o l l ' ,   n a m e :   ' O P E X   P a y r o l l ' ,   t h r e s h o l d :   2 5   } ,  
                                 {   k e y :   ' o p e x S a l e s M a r k e t i n g ' ,   n a m e :   ' S a l e s   &   M a r k e t i n g ' ,   t h r e s h o l d :   1 5   } ,  
                                 {   k e y :   ' r e n t L e a s e ' ,   n a m e :   ' R e n t / L e a s e ' ,   t h r e s h o l d :   1 0   } ,  
                                 {   k e y :   ' p r o f e s s i o n a l S e r v i c e s ' ,   n a m e :   ' P r o f e s s i o n a l   S e r v i c e s ' ,   t h r e s h o l d :   8   }  
                             ] ;  
  
                             e x p e n s e C a t e g o r i e s . f o r E a c h ( c a t   = >   {  
                                 i f   ( m a p p i n g [ c a t . k e y   a s   k e y o f   t y p e o f   m a p p i n g ]   & &   l a s t [ c a t . k e y   a s   k e y o f   t y p e o f   l a s t ] )   {  
                                     c o n s t   c u r r e n t P c t   =   l a s t . r e v e n u e   >   0   ?   ( ( l a s t [ c a t . k e y   a s   k e y o f   t y p e o f   l a s t ]   a s   n u m b e r )   /   l a s t . r e v e n u e )   *   1 0 0   :   0 ;  
                                      
                                     / /   C h e c k   i f   e x p e n s e   c a t e g o r y   i s   t o o   h i g h  
                                     i f   ( c u r r e n t P c t   >   c a t . t h r e s h o l d )   {  
                                         i s s u e s . p u s h ( {  
                                             c a t e g o r y :   ' E x p e n s e   C o n t r o l ' ,  
                                             s e v e r i t y :   c u r r e n t P c t   >   c a t . t h r e s h o l d   *   1 . 3   ?   ' h i g h '   :   ' m e d i u m ' ,  
                                             t i t l e :   ` H i g h   $ { c a t . n a m e }   E x p e n s e ` ,  
                                             d e s c r i p t i o n :   ` $ { c a t . n a m e }   r e p r e s e n t s   $ { c u r r e n t P c t . t o F i x e d ( 1 ) } %   o f   r e v e n u e ,   w h i c h   i s   a b o v e   t h e   r e c o m m e n d e d   t h r e s h o l d   o f   $ { c a t . t h r e s h o l d } % .   T h i s   i n d i c a t e s   p o t e n t i a l   i n e f f i c i e n c i e s   o r   c o s t   c o n t r o l   i s s u e s   i n   t h i s   a r e a . ` ,  
                                             m e t r i c :   ` $ { c u r r e n t P c t . t o F i x e d ( 1 ) } % `  
                                         } ) ;  
                                     }  
  
                                     / /   C h e c k   i f   t r e n d i n g   u p w a r d  
                                     i f   ( m o n t h l y . l e n g t h   > =   6 )   {  
                                         c o n s t   s i x M o n t h s A g o   =   m o n t h l y [ m o n t h l y . l e n g t h   -   6 ] ;  
                                         c o n s t   p r e v P c t   =   s i x M o n t h s A g o . r e v e n u e   >   0   ?   ( ( s i x M o n t h s A g o [ c a t . k e y   a s   k e y o f   t y p e o f   s i x M o n t h s A g o ]   a s   n u m b e r   | |   0 )   /   s i x M o n t h s A g o . r e v e n u e )   *   1 0 0   :   0 ;  
                                         c o n s t   p c t C h a n g e   =   c u r r e n t P c t   -   p r e v P c t ;  
                                          
                                         i f   ( p c t C h a n g e   >   3 )   {  
                                             i s s u e s . p u s h ( {  
                                                 c a t e g o r y :   ' E x p e n s e   T r e n d s ' ,  
                                                 s e v e r i t y :   p c t C h a n g e   >   5   ?   ' m e d i u m '   :   ' l o w ' ,  
                                                 t i t l e :   ` R i s i n g   $ { c a t . n a m e }   a s   %   o f   R e v e n u e ` ,  
                                                 d e s c r i p t i o n :   ` $ { c a t . n a m e }   h a s   i n c r e a s e d   f r o m   $ { p r e v P c t . t o F i x e d ( 1 ) } %   t o   $ { c u r r e n t P c t . t o F i x e d ( 1 ) } %   o f   r e v e n u e   o v e r   t h e   p a s t   6   m o n t h s .   T h i s   t r e n d   i n d i c a t e s   d e t e r i o r a t i n g   c o s t   c o n t r o l   o r   o p e r a t i o n a l   i n e f f i c i e n c y . ` ,  
                                                 m e t r i c :   ` + $ { p c t C h a n g e . t o F i x e d ( 1 ) } % `  
                                             } ) ;  
                                         }  
                                     }  
                                 }  
                             } ) ;  
  
                             / /   = = =   B E N C H M A R K   C O M P A R I S O N   = = =  
                             i f   ( b e n c h m a r k s   & &   b e n c h m a r k s . l e n g t h   >   0 )   {  
                                 / /   C u r r e n t   R a t i o   v s   B e n c h m a r k  
                                 c o n s t   c u r r e n t R a t i o B M   =   b e n c h m a r k s . f i n d ( b   = >   b . m e t r i c   = = =   ' C u r r e n t   R a t i o ' ) ;  
                                 i f   ( c u r r e n t R a t i o B M   & &   l a s t . c u r r e n t R a t i o   <   c u r r e n t R a t i o B M . p 2 5 )   {  
                                     i s s u e s . p u s h ( {  
                                         c a t e g o r y :   ' B e n c h m a r k s ' ,  
                                         s e v e r i t y :   ' m e d i u m ' ,  
                                         t i t l e :   ' C u r r e n t   R a t i o   B e l o w   I n d u s t r y   B e n c h m a r k ' ,  
                                         d e s c r i p t i o n :   ` C u r r e n t   r a t i o   o f   $ { l a s t . c u r r e n t R a t i o . t o F i x e d ( 2 ) }   i s   b e l o w   t h e   i n d u s t r y   2 5 t h   p e r c e n t i l e   o f   $ { c u r r e n t R a t i o B M . p 2 5 . t o F i x e d ( 2 ) } .   T h i s   i n d i c a t e s   w e a k e r   l i q u i d i t y   c o m p a r e d   t o   i n d u s t r y   p e e r s . ` ,  
                                         m e t r i c :   ` $ { l a s t . c u r r e n t R a t i o . t o F i x e d ( 2 ) }   v s   $ { c u r r e n t R a t i o B M . p 2 5 . t o F i x e d ( 2 ) } `  
                                     } ) ;  
                                 }  
  
                                 / /   Q u i c k   R a t i o   v s   B e n c h m a r k  
                                 c o n s t   q u i c k R a t i o B M   =   b e n c h m a r k s . f i n d ( b   = >   b . m e t r i c   = = =   ' Q u i c k   R a t i o ' ) ;  
                                 i f   ( q u i c k R a t i o B M   & &   l a s t . q u i c k R a t i o   <   q u i c k R a t i o B M . p 2 5 )   {  
                                     i s s u e s . p u s h ( {  
                                         c a t e g o r y :   ' B e n c h m a r k s ' ,  
                                         s e v e r i t y :   ' m e d i u m ' ,  
                                         t i t l e :   ' Q u i c k   R a t i o   B e l o w   I n d u s t r y   B e n c h m a r k ' ,  
                                         d e s c r i p t i o n :   ` Q u i c k   r a t i o   o f   $ { l a s t . q u i c k R a t i o . t o F i x e d ( 2 ) }   i s   b e l o w   t h e   i n d u s t r y   2 5 t h   p e r c e n t i l e   o f   $ { q u i c k R a t i o B M . p 2 5 . t o F i x e d ( 2 ) } .   T h i s   s u g g e s t s   i n a d e q u a t e   l i q u i d   a s s e t s   c o m p a r e d   t o   p e e r s . ` ,  
                                         m e t r i c :   ` $ { l a s t . q u i c k R a t i o . t o F i x e d ( 2 ) }   v s   $ { q u i c k R a t i o B M . p 2 5 . t o F i x e d ( 2 ) } `  
                                     } ) ;  
                                 }  
  
                                 / /   D e b t   t o   E q u i t y   v s   B e n c h m a r k  
                                 c o n s t   d e b t T o E q u i t y B M   =   b e n c h m a r k s . f i n d ( b   = >   b . m e t r i c   = = =   ' D e b t   t o   E q u i t y ' ) ;  
                                 i f   ( d e b t T o E q u i t y B M   & &   d e b t T o E q u i t y   <   9 0 0   & &   d e b t T o E q u i t y   >   d e b t T o E q u i t y B M . p 7 5 )   {  
                                     i s s u e s . p u s h ( {  
                                         c a t e g o r y :   ' B e n c h m a r k s ' ,  
                                         s e v e r i t y :   ' m e d i u m ' ,  
                                         t i t l e :   ' D e b t - t o - E q u i t y   A b o v e   I n d u s t r y   B e n c h m a r k ' ,  
                                         d e s c r i p t i o n :   ` D e b t - t o - e q u i t y   r a t i o   o f   $ { d e b t T o E q u i t y . t o F i x e d ( 2 ) }   e x c e e d s   t h e   i n d u s t r y   7 5 t h   p e r c e n t i l e   o f   $ { d e b t T o E q u i t y B M . p 7 5 . t o F i x e d ( 2 ) } .   T h e   c o m p a n y   i s   m o r e   l e v e r a g e d   t h a n   m o s t   p e e r s . ` ,  
                                         m e t r i c :   ` $ { d e b t T o E q u i t y . t o F i x e d ( 2 ) }   v s   $ { d e b t T o E q u i t y B M . p 7 5 . t o F i x e d ( 2 ) } `  
                                     } ) ;  
                                 }  
  
                                 / /   R O E   v s   B e n c h m a r k  
                                 c o n s t   r o e B M   =   b e n c h m a r k s . f i n d ( b   = >   b . m e t r i c   = = =   ' R e t u r n   o n   E q u i t y   ( R O E ) ' ) ;  
                                 i f   ( r o e B M   & &   l a s t . r o e   <   r o e B M . p 2 5 )   {  
                                     i s s u e s . p u s h ( {  
                                         c a t e g o r y :   ' B e n c h m a r k s ' ,  
                                         s e v e r i t y :   ' m e d i u m ' ,  
                                         t i t l e :   ' R O E   B e l o w   I n d u s t r y   B e n c h m a r k ' ,  
                                         d e s c r i p t i o n :   ` R e t u r n   o n   E q u i t y   o f   $ { ( l a s t . r o e   *   1 0 0 ) . t o F i x e d ( 1 ) } %   i s   b e l o w   t h e   i n d u s t r y   2 5 t h   p e r c e n t i l e   o f   $ { ( r o e B M . p 2 5   *   1 0 0 ) . t o F i x e d ( 1 ) } % .   T h e   c o m p a n y   i s   g e n e r a t i n g   l o w e r   r e t u r n s   t h a n   m o s t   c o m p e t i t o r s . ` ,  
                                         m e t r i c :   ` $ { ( l a s t . r o e   *   1 0 0 ) . t o F i x e d ( 1 ) } %   v s   $ { ( r o e B M . p 2 5   *   1 0 0 ) . t o F i x e d ( 1 ) } % `  
                                     } ) ;  
                                 }  
  
                                 / /   R O A   v s   B e n c h m a r k  
                                 c o n s t   r o a B M   =   b e n c h m a r k s . f i n d ( b   = >   b . m e t r i c   = = =   ' R e t u r n   o n   A s s e t s   ( R O A ) ' ) ;  
                                 i f   ( r o a B M   & &   l a s t . r o a   <   r o a B M . p 2 5 )   {  
                                     i s s u e s . p u s h ( {  
                                         c a t e g o r y :   ' B e n c h m a r k s ' ,  
                                         s e v e r i t y :   ' l o w ' ,  
                                         t i t l e :   ' R O A   B e l o w   I n d u s t r y   B e n c h m a r k ' ,  
                                         d e s c r i p t i o n :   ` R e t u r n   o n   A s s e t s   o f   $ { ( l a s t . r o a   *   1 0 0 ) . t o F i x e d ( 1 ) } %   i s   b e l o w   t h e   i n d u s t r y   2 5 t h   p e r c e n t i l e   o f   $ { ( r o a B M . p 2 5   *   1 0 0 ) . t o F i x e d ( 1 ) } % .   A s s e t   u t i l i z a t i o n   i s   w e a k e r   t h a n   i n d u s t r y   p e e r s . ` ,  
                                         m e t r i c :   ` $ { ( l a s t . r o a   *   1 0 0 ) . t o F i x e d ( 1 ) } %   v s   $ { ( r o a B M . p 2 5   *   1 0 0 ) . t o F i x e d ( 1 ) } % `  
                                     } ) ;  
                                 }  
  
                                 / /   P r o f i t   M a r g i n   v s   B e n c h m a r k  
                                 c o n s t   p r o f i t M a r g i n B M   =   b e n c h m a r k s . f i n d ( b   = >   b . m e t r i c   = = =   ' P r o f i t   M a r g i n ' ) ;  
                                 i f   ( p r o f i t M a r g i n B M   & &   n e t M a r g i n   <   p r o f i t M a r g i n B M . p 2 5 )   {  
                                     i s s u e s . p u s h ( {  
                                         c a t e g o r y :   ' B e n c h m a r k s ' ,  
                                         s e v e r i t y :   n e t M a r g i n   <   0   ?   ' h i g h '   :   ' m e d i u m ' ,  
                                         t i t l e :   ' P r o f i t   M a r g i n   B e l o w   I n d u s t r y   B e n c h m a r k ' ,  
                                         d e s c r i p t i o n :   ` N e t   p r o f i t   m a r g i n   o f   $ { n e t M a r g i n . t o F i x e d ( 1 ) } %   i s   b e l o w   t h e   i n d u s t r y   2 5 t h   p e r c e n t i l e   o f   $ { p r o f i t M a r g i n B M . p 2 5 . t o F i x e d ( 1 ) } % .   P r o f i t a b i l i t y   i s   w e a k e r   t h a n   m o s t   c o m p e t i t o r s . ` ,  
                                         m e t r i c :   ` $ { n e t M a r g i n . t o F i x e d ( 1 ) } %   v s   $ { p r o f i t M a r g i n B M . p 2 5 . t o F i x e d ( 1 ) } % `  
                                     } ) ;  
                                 }  
  
                                 / /   A s s e t   T u r n o v e r   v s   B e n c h m a r k  
                                 c o n s t   a s s e t T u r n o v e r B M   =   b e n c h m a r k s . f i n d ( b   = >   b . m e t r i c   = = =   ' A s s e t   T u r n o v e r ' ) ;  
                                 i f   ( a s s e t T u r n o v e r B M   & &   a s s e t T u r n o v e r   <   a s s e t T u r n o v e r B M . p 2 5 )   {  
                                     i s s u e s . p u s h ( {  
                                         c a t e g o r y :   ' B e n c h m a r k s ' ,  
                                         s e v e r i t y :   ' l o w ' ,  
                                         t i t l e :   ' A s s e t   T u r n o v e r   B e l o w   I n d u s t r y   B e n c h m a r k ' ,  
                                         d e s c r i p t i o n :   ` A s s e t   t u r n o v e r   o f   $ { a s s e t T u r n o v e r . t o F i x e d ( 2 ) } x   i s   b e l o w   t h e   i n d u s t r y   2 5 t h   p e r c e n t i l e   o f   $ { a s s e t T u r n o v e r B M . p 2 5 . t o F i x e d ( 2 ) } x .   A s s e t s   a r e   b e i n g   u s e d   l e s s   e f f i c i e n t l y   t h a n   p e e r s . ` ,  
                                         m e t r i c :   ` $ { a s s e t T u r n o v e r . t o F i x e d ( 2 ) } x   v s   $ { a s s e t T u r n o v e r B M . p 2 5 . t o F i x e d ( 2 ) } x `  
                                     } ) ;  
                                 }  
  
                                 / /   D S O   v s   B e n c h m a r k      
                                 c o n s t   d s o B M   =   b e n c h m a r k s . f i n d ( b   = >   b . m e t r i c   = = =   ' D a y s   S a l e s   O u t s t a n d i n g   ( D S O ) ' ) ;  
                                 i f   ( d s o B M   & &   d s o   >   d s o B M . p 7 5 )   {  
                                     i s s u e s . p u s h ( {  
                                         c a t e g o r y :   ' B e n c h m a r k s ' ,  
                                         s e v e r i t y :   ' m e d i u m ' ,  
                                         t i t l e :   ' D S O   A b o v e   I n d u s t r y   B e n c h m a r k ' ,  
                                         d e s c r i p t i o n :   ` D a y s   S a l e s   O u t s t a n d i n g   o f   $ { d s o . t o F i x e d ( 0 ) }   d a y s   e x c e e d s   t h e   i n d u s t r y   7 5 t h   p e r c e n t i l e   o f   $ { d s o B M . p 7 5 . t o F i x e d ( 0 ) }   d a y s .   C o l l e c t i o n s   a r e   s l o w e r   t h a n   m o s t   c o m p e t i t o r s . ` ,  
                                         m e t r i c :   ` $ { d s o . t o F i x e d ( 0 ) }   v s   $ { d s o B M . p 7 5 . t o F i x e d ( 0 ) }   d a y s `  
                                     } ) ;  
                                 }  
  
                                 / /   E x p e n s e   R a t i o   v s   B e n c h m a r k  
                                 c o n s t   e x p e n s e R a t i o B M   =   b e n c h m a r k s . f i n d ( b   = >   b . m e t r i c   = = =   ' E x p e n s e   R a t i o ' ) ;  
                                 i f   ( e x p e n s e R a t i o B M   & &   e x p e n s e R a t i o   >   e x p e n s e R a t i o B M . p 7 5 )   {  
                                     i s s u e s . p u s h ( {  
                                         c a t e g o r y :   ' B e n c h m a r k s ' ,  
                                         s e v e r i t y :   ' m e d i u m ' ,  
                                         t i t l e :   ' E x p e n s e   R a t i o   A b o v e   I n d u s t r y   B e n c h m a r k ' ,  
                                         d e s c r i p t i o n :   ` T o t a l   e x p e n s e   r a t i o   o f   $ { e x p e n s e R a t i o . t o F i x e d ( 1 ) } %   e x c e e d s   t h e   i n d u s t r y   7 5 t h   p e r c e n t i l e   o f   $ { e x p e n s e R a t i o B M . p 7 5 . t o F i x e d ( 1 ) } % .   O p e r a t i n g   c o s t s   a r e   h i g h e r   t h a n   m o s t   c o m p e t i t o r s . ` ,  
                                         m e t r i c :   ` $ { e x p e n s e R a t i o . t o F i x e d ( 1 ) } %   v s   $ { e x p e n s e R a t i o B M . p 7 5 . t o F i x e d ( 1 ) } % `  
                                     } ) ;  
                                 }  
                             }  
  
                             / /   = = =   F I N A N C I A L   S C O R E   A N A L Y S I S   = = =  
                             / /   C h e c k   o v e r a l l   F i n a n c i a l   S c o r e  
                             i f   ( f i n a l S c o r e   <   4 0 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' F i n a n c i a l   S c o r e ' ,  
                                     s e v e r i t y :   ' h i g h ' ,  
                                     t i t l e :   ' C r i t i c a l   F i n a n c i a l   S c o r e ' ,  
                                     d e s c r i p t i o n :   ` O v e r a l l   F i n a n c i a l   S c o r e   o f   $ { f i n a l S c o r e . t o F i x e d ( 1 ) }   i s   c r i t i c a l l y   l o w ,   i n d i c a t i n g   s e v e r e   f i n a n c i a l   d i s t r e s s .   B o t h   p r o f i t a b i l i t y   a n d   a s s e t   d e v e l o p m e n t   r e q u i r e   i m m e d i a t e   a t t e n t i o n . ` ,  
                                     m e t r i c :   ` $ { f i n a l S c o r e . t o F i x e d ( 1 ) } / 1 0 0 `  
                                 } ) ;  
                             }   e l s e   i f   ( f i n a l S c o r e   <   6 0 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' F i n a n c i a l   S c o r e ' ,  
                                     s e v e r i t y :   ' m e d i u m ' ,  
                                     t i t l e :   ' B e l o w   A v e r a g e   F i n a n c i a l   S c o r e ' ,  
                                     d e s c r i p t i o n :   ` F i n a n c i a l   S c o r e   o f   $ { f i n a l S c o r e . t o F i x e d ( 1 ) }   i s   b e l o w   i n d u s t r y   s t a n d a r d s .   T h e   c o m p a n y   n e e d s   t o   i m p r o v e   b o t h   r e v e n u e   g r o w t h / p r o f i t a b i l i t y   a n d   a s s e t   m a n a g e m e n t . ` ,  
                                     m e t r i c :   ` $ { f i n a l S c o r e . t o F i x e d ( 1 ) } / 1 0 0 `  
                                 } ) ;  
                             }   e l s e   i f   ( f i n a l S c o r e   <   7 0 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' F i n a n c i a l   S c o r e ' ,  
                                     s e v e r i t y :   ' l o w ' ,  
                                     t i t l e :   ' M o d e r a t e   F i n a n c i a l   S c o r e ' ,  
                                     d e s c r i p t i o n :   ` F i n a n c i a l   S c o r e   o f   $ { f i n a l S c o r e . t o F i x e d ( 1 ) }   s h o w s   r o o m   f o r   i m p r o v e m e n t .   C o n s i d e r   s t r a t e g i e s   t o   e n h a n c e   p r o f i t a b i l i t y   a n d   s t r e n g t h e n   t h e   b a l a n c e   s h e e t . ` ,  
                                     m e t r i c :   ` $ { f i n a l S c o r e . t o F i x e d ( 1 ) } / 1 0 0 `  
                                 } ) ;  
                             }  
  
                             / /   C h e c k   P r o f i t a b i l i t y   S c o r e   c o m p o n e n t  
                             i f   ( p r o f i t a b i l i t y S c o r e   <   4 0 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' F i n a n c i a l   S c o r e ' ,  
                                     s e v e r i t y :   ' h i g h ' ,  
                                     t i t l e :   ' C r i t i c a l   P r o f i t a b i l i t y   S c o r e ' ,  
                                     d e s c r i p t i o n :   ` P r o f i t a b i l i t y   S c o r e   o f   $ { p r o f i t a b i l i t y S c o r e . t o F i x e d ( 1 ) }   i n d i c a t e s   s e v e r e   i s s u e s   w i t h   r e v e n u e   g r o w t h   a n d   e x p e n s e   m a n a g e m e n t .   R e v e n u e   m a y   b e   d e c l i n i n g   o r   e x p e n s e s   g r o w i n g   f a s t e r   t h a n   r e v e n u e . ` ,  
                                     m e t r i c :   ` $ { p r o f i t a b i l i t y S c o r e . t o F i x e d ( 1 ) } / 1 0 0 `  
                                 } ) ;  
                             }   e l s e   i f   ( p r o f i t a b i l i t y S c o r e   <   6 0 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' F i n a n c i a l   S c o r e ' ,  
                                     s e v e r i t y :   ' m e d i u m ' ,  
                                     t i t l e :   ' W e a k   P r o f i t a b i l i t y   S c o r e ' ,  
                                     d e s c r i p t i o n :   ` P r o f i t a b i l i t y   S c o r e   o f   $ { p r o f i t a b i l i t y S c o r e . t o F i x e d ( 1 ) }   s u g g e s t s   u n d e r p e r f o r m a n c e   i n   r e v e n u e   g r o w t h   o r   e x p e n s e   c o n t r o l .   R e v i e w   p r i c i n g   s t r a t e g i e s ,   c o s t   s t r u c t u r e ,   a n d   m a r k e t   p o s i t i o n i n g . ` ,  
                                     m e t r i c :   ` $ { p r o f i t a b i l i t y S c o r e . t o F i x e d ( 1 ) } / 1 0 0 `  
                                 } ) ;  
                             }  
  
                             / /   C h e c k   A s s e t   D e v e l o p m e n t   S c o r e   c o m p o n e n t  
                             i f   ( a s s e t D e v S c o r e   <   4 0 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' F i n a n c i a l   S c o r e ' ,  
                                     s e v e r i t y :   ' h i g h ' ,  
                                     t i t l e :   ' C r i t i c a l   A s s e t   D e v e l o p m e n t   S c o r e ' ,  
                                     d e s c r i p t i o n :   ` A s s e t   D e v e l o p m e n t   S c o r e   o f   $ { a s s e t D e v S c o r e . t o F i x e d ( 1 ) }   i n d i c a t e s   a   w e a k   b a l a n c e   s h e e t   w i t h   a s s e t s   b a r e l y   e x c e e d i n g   l i a b i l i t i e s .   A s s e t - t o - L i a b i l i t y   r a t i o   o f   $ { a l r 1 . t o F i x e d ( 2 ) } : 1   s u g g e s t s   p o t e n t i a l   s o l v e n c y   i s s u e s . ` ,  
                                     m e t r i c :   ` $ { a s s e t D e v S c o r e . t o F i x e d ( 1 ) } / 1 0 0   ( A L R :   $ { a l r 1 . t o F i x e d ( 2 ) } ) `  
                                 } ) ;  
                             }   e l s e   i f   ( a s s e t D e v S c o r e   <   6 0 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' F i n a n c i a l   S c o r e ' ,  
                                     s e v e r i t y :   ' m e d i u m ' ,  
                                     t i t l e :   ' W e a k   A s s e t   D e v e l o p m e n t   S c o r e ' ,  
                                     d e s c r i p t i o n :   ` A s s e t   D e v e l o p m e n t   S c o r e   o f   $ { a s s e t D e v S c o r e . t o F i x e d ( 1 ) }   i n d i c a t e s   l i m i t e d   a s s e t   g r o w t h   r e l a t i v e   t o   l i a b i l i t i e s .   A s s e t - t o - L i a b i l i t y   r a t i o   o f   $ { a l r 1 . t o F i x e d ( 2 ) } : 1   c o u l d   b e   s t r o n g e r   t o   s u p p o r t   f u t u r e   g r o w t h . ` ,  
                                     m e t r i c :   ` $ { a s s e t D e v S c o r e . t o F i x e d ( 1 ) } / 1 0 0   ( A L R :   $ { a l r 1 . t o F i x e d ( 2 ) } ) `  
                                 } ) ;  
                             }  
  
                             / /   C h e c k   A s s e t - t o - L i a b i l i t y   R a t i o   t r e n d  
                             i f   ( a l r 1   <   1 . 0 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' F i n a n c i a l   S c o r e ' ,  
                                     s e v e r i t y :   ' h i g h ' ,  
                                     t i t l e :   ' L i a b i l i t i e s   E x c e e d   A s s e t s ' ,  
                                     d e s c r i p t i o n :   ` A s s e t - t o - L i a b i l i t y   r a t i o   o f   $ { a l r 1 . t o F i x e d ( 2 ) } : 1   m e a n s   l i a b i l i t i e s   e x c e e d   a s s e t s ,   i n d i c a t i n g   t h e   c o m p a n y   i s   t e c h n i c a l l y   i n s o l v e n t   o n   p a p e r .   T h i s   r e q u i r e s   i m m e d i a t e   f i n a n c i a l   r e s t r u c t u r i n g   o r   c a p i t a l   i n j e c t i o n . ` ,  
                                     m e t r i c :   ` $ { a l r 1 . t o F i x e d ( 2 ) } : 1 `  
                                 } ) ;  
                             }   e l s e   i f   ( a l r 1   <   1 . 2   & &   a l r G r o w t h   <   - 1 0 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' F i n a n c i a l   S c o r e ' ,  
                                     s e v e r i t y :   ' h i g h ' ,  
                                     t i t l e :   ' D e t e r i o r a t i n g   A s s e t - t o - L i a b i l i t y   R a t i o ' ,  
                                     d e s c r i p t i o n :   ` A s s e t - t o - L i a b i l i t y   r a t i o   h a s   d e c l i n e d   b y   $ { M a t h . a b s ( a l r G r o w t h ) . t o F i x e d ( 1 ) } %   t o   $ { a l r 1 . t o F i x e d ( 2 ) } : 1 .   T h e   b a l a n c e   s h e e t   i s   w e a k e n i n g ,   w i t h   l i a b i l i t i e s   g r o w i n g   f a s t e r   t h a n   a s s e t s . ` ,  
                                     m e t r i c :   ` $ { a l r 1 . t o F i x e d ( 2 ) } : 1   ( $ { a l r G r o w t h . t o F i x e d ( 1 ) } % ) `  
                                 } ) ;  
                             }   e l s e   i f   ( a l r G r o w t h   <   - 5 )   {  
                                 i s s u e s . p u s h ( {  
                                     c a t e g o r y :   ' F i n a n c i a l   S c o r e ' ,  
                                     s e v e r i t y :   ' m e d i u m ' ,  
                                     t i t l e :   ' D e c l i n i n g   A s s e t   Q u a l i t y ' ,  
                                     d e s c r i p t i o n :   ` A s s e t - t o - L i a b i l i t y   r a t i o   d e c r e a s e d   b y   $ { M a t h . a b s ( a l r G r o w t h ) . t o F i x e d ( 1 ) } % ,   s u g g e s t i n g   a s s e t s   a r e   n o t   g r o w i n g   a s   f a s t   a s   l i a b i l i t i e s .   M o n i t o r   d e b t   l e v e l s   a n d   a s s e t   u t i l i z a t i o n . ` ,  
                                     m e t r i c :   ` $ { a l r G r o w t h . t o F i x e d ( 1 ) } %   d e c l i n e `  
                                 } ) ;  
                             }  
  
                             / /   C h e c k   F i n a n c i a l   S c o r e   t r e n d   i f   w e   h a v e   h i s t o r i c a l   d a t a  
                             i f   ( t r e n d D a t a   & &   t r e n d D a t a . l e n g t h   > =   6 )   {  
                                 c o n s t   c u r r e n t F i n S c o r e   =   t r e n d D a t a [ t r e n d D a t a . l e n g t h   -   1 ] . f i n a n c i a l S c o r e ;  
                                 c o n s t   s i x M o n t h s A g o F i n S c o r e   =   t r e n d D a t a [ t r e n d D a t a . l e n g t h   -   6 ] . f i n a n c i a l S c o r e ;  
                                 c o n s t   f i n S c o r e C h a n g e   =   c u r r e n t F i n S c o r e   -   s i x M o n t h s A g o F i n S c o r e ;  
                                  
                                 i f   ( f i n S c o r e C h a n g e   <   - 1 5 )   {  
                                     i s s u e s . p u s h ( {  
                                         c a t e g o r y :   ' F i n a n c i a l   S c o r e ' ,  
                                         s e v e r i t y :   ' h i g h ' ,  
                                         t i t l e :   ' R a p i d l y   D e c l i n i n g   F i n a n c i a l   S c o r e ' ,  
                                         d e s c r i p t i o n :   ` F i n a n c i a l   S c o r e   h a s   d r o p p e d   $ { M a t h . a b s ( f i n S c o r e C h a n g e ) . t o F i x e d ( 1 ) }   p o i n t s   o v e r   t h e   p a s t   6   m o n t h s ,   f r o m   $ { s i x M o n t h s A g o F i n S c o r e . t o F i x e d ( 1 ) }   t o   $ { c u r r e n t F i n S c o r e . t o F i x e d ( 1 ) } .   T h i s   r a p i d   d e t e r i o r a t i o n   r e q u i r e s   i m m e d i a t e   m a n a g e m e n t   a t t e n t i o n . ` ,  
                                         m e t r i c :   ` $ { f i n S c o r e C h a n g e . t o F i x e d ( 1 ) }   p t s `  
                                     } ) ;  
                                 }   e l s e   i f   ( f i n S c o r e C h a n g e   <   - 1 0 )   {  
                                     i s s u e s . p u s h ( {  
                                         c a t e g o r y :   ' F i n a n c i a l   S c o r e ' ,  
                                         s e v e r i t y :   ' m e d i u m ' ,  
                                         t i t l e :   ' D e c l i n i n g   F i n a n c i a l   S c o r e   T r e n d ' ,  
                                         d e s c r i p t i o n :   ` F i n a n c i a l   S c o r e   h a s   d e c r e a s e d   b y   $ { M a t h . a b s ( f i n S c o r e C h a n g e ) . t o F i x e d ( 1 ) }   p o i n t s   o v e r   t h e   p a s t   6   m o n t h s .   T h e   c o m p a n y ' s   f i n a n c i a l   h e a l t h   i s   t r e n d i n g   i n   t h e   w r o n g   d i r e c t i o n . ` ,  
                                         m e t r i c :   ` $ { f i n S c o r e C h a n g e . t o F i x e d ( 1 ) }   p t s `  
                                     } ) ;  
                                 }  
  
                                 / /   C h e c k   P r o f i t a b i l i t y   S c o r e   t r e n d  
                                 c o n s t   c u r r e n t P r o f S c o r e   =   t r e n d D a t a [ t r e n d D a t a . l e n g t h   -   1 ] . p r o f i t a b i l i t y S c o r e ;  
                                 c o n s t   s i x M o n t h s A g o P r o f S c o r e   =   t r e n d D a t a [ t r e n d D a t a . l e n g t h   -   6 ] . p r o f i t a b i l i t y S c o r e ;  
                                 c o n s t   p r o f S c o r e C h a n g e   =   c u r r e n t P r o f S c o r e   -   s i x M o n t h s A g o P r o f S c o r e ;  
                                  
                                 i f   ( p r o f S c o r e C h a n g e   <   - 1 5 )   {  
                                     i s s u e s . p u s h ( {  
                                         c a t e g o r y :   ' F i n a n c i a l   S c o r e ' ,  
                                         s e v e r i t y :   ' m e d i u m ' ,  
                                         t i t l e :   ' D e t e r i o r a t i n g   P r o f i t a b i l i t y   T r e n d ' ,  
                                         d e s c r i p t i o n :   ` P r o f i t a b i l i t y   S c o r e   h a s   f a l l e n   $ { M a t h . a b s ( p r o f S c o r e C h a n g e ) . t o F i x e d ( 1 ) }   p o i n t s   o v e r   6   m o n t h s ,   i n d i c a t i n g   w o r s e n i n g   r e v e n u e   g r o w t h   a n d / o r   e x p e n s e   c o n t r o l . ` ,  
                                         m e t r i c :   ` $ { p r o f S c o r e C h a n g e . t o F i x e d ( 1 ) }   p t s `  
                                     } ) ;  
                                 }  
  
                                 / /   C h e c k   A s s e t   D e v e l o p m e n t   S c o r e   t r e n d  
                                 c o n s t   c u r r e n t A d s S c o r e   =   t r e n d D a t a [ t r e n d D a t a . l e n g t h   -   1 ] . a d s S c o r e ;  
                                 c o n s t   s i x M o n t h s A g o A d s S c o r e   =   t r e n d D a t a [ t r e n d D a t a . l e n g t h   -   6 ] . a d s S c o r e ;  
                                 c o n s t   a d s S c o r e C h a n g e   =   c u r r e n t A d s S c o r e   -   s i x M o n t h s A g o A d s S c o r e ;  
                                  
                                 i f   ( a d s S c o r e C h a n g e   <   - 1 5 )   {  
                                     i s s u e s . p u s h ( {  
                                         c a t e g o r y :   ' F i n a n c i a l   S c o r e ' ,  
                                         s e v e r i t y :   ' m e d i u m ' ,  
                                         t i t l e :   ' W e a k e n i n g   B a l a n c e   S h e e t   T r e n d ' ,  
                                         d e s c r i p t i o n :   ` A s s e t   D e v e l o p m e n t   S c o r e   h a s   d r o p p e d   $ { M a t h . a b s ( a d s S c o r e C h a n g e ) . t o F i x e d ( 1 ) }   p o i n t s   o v e r   6   m o n t h s ,   i n d i c a t i n g   t h e   b a l a n c e   s h e e t   i s   d e t e r i o r a t i n g   r e l a t i v e   t o   h i s t o r i c a l   l e v e l s . ` ,  
                                         m e t r i c :   ` $ { a d s S c o r e C h a n g e . t o F i x e d ( 1 ) }   p t s `  
                                     } ) ;  
                                 }  
                             }  
  
                             / /   S o r t   b y   s e v e r i t y  
                             c o n s t   s e v e r i t y O r d e r   =   {   h i g h :   0 ,   m e d i u m :   1 ,   l o w :   2   } ;  
                             i s s u e s . s o r t ( ( a ,   b )   = >   s e v e r i t y O r d e r [ a . s e v e r i t y ]   -   s e v e r i t y O r d e r [ b . s e v e r i t y ] ) ;  
  
                             r e t u r n   (  
                                 < d i v >  
                                     { / *   S u m m a r y   S t a t s   * / }  
                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( 3 ,   1 f r ) ' ,   g a p :   ' 2 0 p x ' ,   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f e e 2 e 2 ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b o r d e r :   ' 2 p x   s o l i d   # e f 4 4 4 4 '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 9 9 1 b 1 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                                 { i s s u e s . f i l t e r ( i   = >   i . s e v e r i t y   = = =   ' h i g h ' ) . l e n g t h }  
                                             < / d i v >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 7 f 1 d 1 d '   } } > H i g h   P r i o r i t y   I s s u e s < / d i v >  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f e f 3 c 7 ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b o r d e r :   ' 2 p x   s o l i d   # f 5 9 e 0 b '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 9 2 4 0 0 e ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                                 { i s s u e s . f i l t e r ( i   = >   i . s e v e r i t y   = = =   ' m e d i u m ' ) . l e n g t h }  
                                             < / d i v >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 7 8 3 5 0 f '   } } > M e d i u m   P r i o r i t y   I s s u e s < / d i v >  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' # d b e a f e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b o r d e r :   ' 2 p x   s o l i d   # 3 b 8 2 f 6 '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                                 { i s s u e s . f i l t e r ( i   = >   i . s e v e r i t y   = = =   ' l o w ' ) . l e n g t h }  
                                             < / d i v >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 3 a 8 a '   } } > L o w   P r i o r i t y   I s s u e s < / d i v >  
                                         < / d i v >  
                                     < / d i v >  
  
                                     { / *   I s s u e s   L i s t   * / }  
                                     { i s s u e s . l e n g t h   = = =   0   ?   (  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' # d 1 f a e 5 ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   t e x t A l i g n :   ' c e n t e r ' ,   b o r d e r :   ' 2 p x   s o l i d   # 1 0 b 9 8 1 '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 4 8 p x ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  S& < / d i v >  
                                             < h 3   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 0 6 5 f 4 6 ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > N o   C r i t i c a l   I s s u e s   D e t e c t e d < / h 3 >  
                                             < p   s t y l e = { {   f o n t S i z e :   ' 1 5 p x ' ,   c o l o r :   ' # 0 4 7 8 5 7 ' ,   m a r g i n :   0   } } >  
                                                 A l l   a n a l y z e d   m e t r i c s   a r e   w i t h i n   a c c e p t a b l e   r a n g e s .   C o n t i n u e   m o n i t o r i n g   f o r   a n y   c h a n g e s .  
                                             < / p >  
                                         < / d i v >  
                                     )   :   (  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   f l e x D i r e c t i o n :   ' c o l u m n ' ,   g a p :   ' 1 6 p x '   } } >  
                                             { i s s u e s . m a p ( ( i s s u e ,   i d x )   = >   {  
                                                 c o n s t   b g C o l o r   =   i s s u e . s e v e r i t y   = = =   ' h i g h '   ?   ' # f e e 2 e 2 '   :   i s s u e . s e v e r i t y   = = =   ' m e d i u m '   ?   ' # f e f 3 c 7 '   :   ' # d b e a f e ' ;  
                                                 c o n s t   b o r d e r C o l o r   =   i s s u e . s e v e r i t y   = = =   ' h i g h '   ?   ' # e f 4 4 4 4 '   :   i s s u e . s e v e r i t y   = = =   ' m e d i u m '   ?   ' # f 5 9 e 0 b '   :   ' # 3 b 8 2 f 6 ' ;  
                                                 c o n s t   t e x t C o l o r   =   i s s u e . s e v e r i t y   = = =   ' h i g h '   ?   ' # 9 9 1 b 1 b '   :   i s s u e . s e v e r i t y   = = =   ' m e d i u m '   ?   ' # 9 2 4 0 0 e '   :   ' # 1 e 4 0 a f ' ;  
                                                 c o n s t   i c o n   =   i s s u e . s e v e r i t y   = = =   ' h i g h '   ?   '  x  '   :   i s s u e . s e v e r i t y   = = =   ' m e d i u m '   ?   '  xx '   :   '  x  ' ;  
                                                  
                                                 r e t u r n   (  
                                                     < d i v   k e y = { i d x }   s t y l e = { {   b a c k g r o u n d :   b g C o l o r ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b o r d e r :   ` 2 p x   s o l i d   $ { b o r d e r C o l o r } `   } } >  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' f l e x - s t a r t ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                                             < d i v   s t y l e = { {   f l e x :   1   } } >  
                                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 8 p x ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                                                     < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 8 p x '   } } > { i c o n } < / s p a n >  
                                                                     < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   t e x t C o l o r ,   t e x t T r a n s f o r m :   ' u p p e r c a s e ' ,   l e t t e r S p a c i n g :   ' 0 . 5 p x '   } } >  
                                                                         { i s s u e . c a t e g o r y }  
                                                                     < / s p a n >  
                                                                 < / d i v >  
                                                                 < h 3   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   t e x t C o l o r ,   m a r g i n B o t t o m :   ' 8 p x ' ,   m a r g i n :   0   } } >  
                                                                     { i s s u e . t i t l e }  
                                                                 < / h 3 >  
                                                             < / d i v >  
                                                             { i s s u e . m e t r i c   & &   (  
                                                                 < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 8 p x   1 6 p x ' ,   b o r d e r :   ` 1 p x   s o l i d   $ { b o r d e r C o l o r } `   } } >  
                                                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   t e x t C o l o r   } } > { i s s u e . m e t r i c } < / d i v >  
                                                                 < / d i v >  
                                                             ) }  
                                                         < / d i v >  
                                                         < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   t e x t C o l o r ,   m a r g i n :   0 ,   l i n e H e i g h t :   ' 1 . 6 '   } } >  
                                                             { i s s u e . d e s c r i p t i o n }  
                                                         < / p >  
                                                     < / d i v >  
                                                 ) ;  
                                             } ) }  
                                         < / d i v >  
                                     ) }  
  
                                     { / *   A c t i o n   I t e m s   * / }  
                                     { i s s u e s . f i l t e r ( i   = >   i . s e v e r i t y   = = =   ' h i g h ' ) . l e n g t h   >   0   & &   (  
                                         < d i v   s t y l e = { {   m a r g i n T o p :   ' 3 2 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   b o r d e r :   ' 2 p x   s o l i d   # 6 6 7 e e a '   } } >  
                                             < h 3   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  x 9   R e c o m m e n d e d   A c t i o n s < / h 3 >  
                                             < u l   s t y l e = { {   m a r g i n :   0 ,   p a d d i n g L e f t :   ' 2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   l i n e H e i g h t :   ' 1 . 8 '   } } >  
                                                 { i s s u e s . f i l t e r ( i   = >   i . s e v e r i t y   = = =   ' h i g h ' ) . l e n g t h   >   0   & &   (  
                                                     < l i > < s t r o n g > I m m e d i a t e   a t t e n t i o n   r e q u i r e d : < / s t r o n g >   A d d r e s s   a l l   h i g h - p r i o r i t y   i s s u e s   w i t h i n   t h e   n e x t   3 0   d a y s < / l i >  
                                                 ) }  
                                                 { i s s u e s . s o m e ( i   = >   i . c a t e g o r y   = = =   ' L i q u i d i t y ' )   & &   (  
                                                     < l i > < s t r o n g > I m p r o v e   l i q u i d i t y : < / s t r o n g >   F o c u s   o n   a c c e l e r a t i n g   c o l l e c t i o n s ,   m a n a g i n g   p a y a b l e s ,   a n d   s e c u r i n g   a d d i t i o n a l   w o r k i n g   c a p i t a l   i f   n e e d e d < / l i >  
                                                 ) }  
                                                 { i s s u e s . s o m e ( i   = >   i . c a t e g o r y   = = =   ' E x p e n s e   C o n t r o l ' )   & &   (  
                                                     < l i > < s t r o n g > C o s t   r e d u c t i o n : < / s t r o n g >   C o n d u c t   d e t a i l e d   e x p e n s e   r e v i e w   t o   i d e n t i f y   c o s t - s a v i n g   o p p o r t u n i t i e s   w i t h o u t   i m p a c t i n g   r e v e n u e < / l i >  
                                                 ) }  
                                                 { i s s u e s . s o m e ( i   = >   i . c a t e g o r y   = = =   ' R e v e n u e   T r e n d s ' )   & &   (  
                                                     < l i > < s t r o n g > R e v e n u e   g r o w t h : < / s t r o n g >   D e v e l o p   s t r a t e g i e s   t o   s t a b i l i z e   a n d   g r o w   r e v e n u e   t h r o u g h   n e w   m a r k e t s ,   p r o d u c t s ,   o r   c u s t o m e r   a c q u i s i t i o n < / l i >  
                                                 ) }  
                                                 { i s s u e s . s o m e ( i   = >   i . c a t e g o r y   = = =   ' C a s h   F l o w ' )   & &   (  
                                                     < l i > < s t r o n g > C a s h   m a n a g e m e n t : < / s t r o n g >   I m p l e m e n t   c a s h   f l o w   f o r e c a s t i n g   a n d   m o n i t o r i n g   t o   p r e v e n t   l i q u i d i t y   c r i s e s < / l i >  
                                                 ) }  
                                                 < l i > < s t r o n g > R e g u l a r   m o n i t o r i n g : < / s t r o n g >   R e v i e w   t h e s e   m e t r i c s   w e e k l y   u n t i l   t r e n d s   i m p r o v e < / l i >  
                                             < / u l >  
                                         < / d i v >  
                                     ) }  
                                 < / d i v >  
                             ) ;  
                         } ) ( ) }  
                     < / d i v >  
                     ) }  
                 < / d i v >  
             ) }  
  
             { / *   P r o j e c t i o n s   V i e w   * / }  
             { c u r r e n t V i e w   = = =   ' p r o j e c t i o n s '   & &   s e l e c t e d C o m p a n y I d   & &   p r o j e c t i o n s . m o s t L i k e l y . l e n g t h   >   0   & &   (  
                 < d i v   s t y l e = { {   m a x W i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 3 2 p x   3 2 p x   3 2 p x   1 6 p x '   } } >  
                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                         < h 1   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n :   0   } } > F i n a n c i a l   P r o j e c t i o n s < / h 1 >  
                         { c o m p a n y N a m e   & &   < d i v   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > { c o m p a n y N a m e } < / d i v > }  
                     < / d i v >  
                      
                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                             < h 2   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > S c e n a r i o   A s s u m p t i o n s < / h 2 >  
                             < b u t t o n   o n C l i c k = { ( )   = >   s e t S h o w D e f a u l t S e t t i n g s ( ! s h o w D e f a u l t S e t t i n g s ) }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 6 p x ' ,   b a c k g r o u n d :   ' # 6 6 7 e e a ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } } >  
                                 { s h o w D e f a u l t S e t t i n g s   ?   ' H i d e   S e t t i n g s '   :   ' A d j u s t   S c e n a r i o s ' }  
                             < / b u t t o n >  
                         < / d i v >  
                          
                         { s h o w D e f a u l t S e t t i n g s   & &   (  
                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   m a r g i n T o p :   ' 1 6 p x '   } } >  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( 2 ,   1 f r ) ' ,   g a p :   ' 2 4 p x ' ,   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                                     < d i v >  
                                         < h 3   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 0 b 9 8 1 ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > B e s t   C a s e   S c e n a r i o < / h 3 >  
                                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                             < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 5 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > R e v e n u e   M u l t i p l i e r :   { b e s t C a s e R e v M u l t i p l i e r } x < / l a b e l >  
                                             < i n p u t   t y p e = " r a n g e "   m i n = " 1 "   m a x = " 3 "   s t e p = " 0 . 1 "   v a l u e = { b e s t C a s e R e v M u l t i p l i e r }   o n C h a n g e = { ( e )   = >   s e t B e s t C a s e R e v M u l t i p l i e r ( p a r s e F l o a t ( e . t a r g e t . v a l u e ) ) }   s t y l e = { {   w i d t h :   ' 1 0 0 % '   } }   / >  
                                         < / d i v >  
                                         < d i v >  
                                             < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 5 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > E x p e n s e   M u l t i p l i e r :   { b e s t C a s e E x p M u l t i p l i e r } x < / l a b e l >  
                                             < i n p u t   t y p e = " r a n g e "   m i n = " 0 . 3 "   m a x = " 1 "   s t e p = " 0 . 0 5 "   v a l u e = { b e s t C a s e E x p M u l t i p l i e r }   o n C h a n g e = { ( e )   = >   s e t B e s t C a s e E x p M u l t i p l i e r ( p a r s e F l o a t ( e . t a r g e t . v a l u e ) ) }   s t y l e = { {   w i d t h :   ' 1 0 0 % '   } }   / >  
                                         < / d i v >  
                                     < / d i v >  
                                     < d i v >  
                                         < h 3   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # e f 4 4 4 4 ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > W o r s t   C a s e   S c e n a r i o < / h 3 >  
                                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                             < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 5 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > R e v e n u e   M u l t i p l i e r :   { w o r s t C a s e R e v M u l t i p l i e r } x < / l a b e l >  
                                             < i n p u t   t y p e = " r a n g e "   m i n = " 0 "   m a x = " 1 "   s t e p = " 0 . 0 5 "   v a l u e = { w o r s t C a s e R e v M u l t i p l i e r }   o n C h a n g e = { ( e )   = >   s e t W o r s t C a s e R e v M u l t i p l i e r ( p a r s e F l o a t ( e . t a r g e t . v a l u e ) ) }   s t y l e = { {   w i d t h :   ' 1 0 0 % '   } }   / >  
                                         < / d i v >  
                                         < d i v >  
                                             < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 5 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > E x p e n s e   M u l t i p l i e r :   { w o r s t C a s e E x p M u l t i p l i e r } x < / l a b e l >  
                                             < i n p u t   t y p e = " r a n g e "   m i n = " 1 "   m a x = " 2 "   s t e p = " 0 . 0 5 "   v a l u e = { w o r s t C a s e E x p M u l t i p l i e r }   o n C h a n g e = { ( e )   = >   s e t W o r s t C a s e E x p M u l t i p l i e r ( p a r s e F l o a t ( e . t a r g e t . v a l u e ) ) }   s t y l e = { {   w i d t h :   ' 1 0 0 % '   } }   / >  
                                         < / d i v >  
                                     < / d i v >  
                                 < / d i v >  
                                 < b u t t o n   o n C l i c k = { s a v e P r o j e c t i o n D e f a u l t s }   s t y l e = { {   p a d d i n g :   ' 1 0 p x   2 0 p x ' ,   b a c k g r o u n d :   ' # 1 0 b 9 8 1 ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } } > S a v e   a s   D e f a u l t s < / b u t t o n >  
                             < / d i v >  
                         ) }  
                     < / d i v >  
  
                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g a p :   ' 3 2 p x '   } } >  
                         < P r o j e c t i o n C h a r t   t i t l e = " R e v e n u e   P r o j e c t i o n "   h i s t o r i c a l D a t a = { m o n t h l y }   p r o j e c t e d D a t a = { p r o j e c t i o n s }   v a l u e K e y = " r e v e n u e "   f o r m a t V a l u e = { ( v )   = >   ` $ $ { ( v   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K ` }   / >  
                         < P r o j e c t i o n C h a r t   t i t l e = " E x p e n s e   P r o j e c t i o n "   h i s t o r i c a l D a t a = { m o n t h l y }   p r o j e c t e d D a t a = { p r o j e c t i o n s }   v a l u e K e y = " e x p e n s e "   f o r m a t V a l u e = { ( v )   = >   ` $ $ { ( v   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K ` }   / >  
                         < P r o j e c t i o n C h a r t   t i t l e = " N e t   I n c o m e   P r o j e c t i o n "   h i s t o r i c a l D a t a = { m o n t h l y }   p r o j e c t e d D a t a = { p r o j e c t i o n s }   v a l u e K e y = " n e t I n c o m e "   f o r m a t V a l u e = { ( v )   = >   ` $ $ { ( v   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K ` }   / >  
                         < P r o j e c t i o n C h a r t   t i t l e = " T o t a l   A s s e t s   P r o j e c t i o n "   h i s t o r i c a l D a t a = { m o n t h l y }   p r o j e c t e d D a t a = { p r o j e c t i o n s }   v a l u e K e y = " t o t a l A s s e t s "   f o r m a t V a l u e = { ( v )   = >   ` $ $ { ( v   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K ` }   / >  
                         < P r o j e c t i o n C h a r t   t i t l e = " T o t a l   L i a b i l i t i e s   P r o j e c t i o n "   h i s t o r i c a l D a t a = { m o n t h l y }   p r o j e c t e d D a t a = { p r o j e c t i o n s }   v a l u e K e y = " t o t a l L i a b "   f o r m a t V a l u e = { ( v )   = >   ` $ $ { ( v   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K ` }   / >  
                         < P r o j e c t i o n C h a r t   t i t l e = " E q u i t y   P r o j e c t i o n "   h i s t o r i c a l D a t a = { m o n t h l y }   p r o j e c t e d D a t a = { p r o j e c t i o n s }   v a l u e K e y = " e q u i t y "   f o r m a t V a l u e = { ( v )   = >   ` $ $ { ( v   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K ` }   / >  
                     < / d i v >  
                 < / d i v >  
             ) }  
  
             { / *   W o r k i n g   C a p i t a l   V i e w   * / }  
             { c u r r e n t V i e w   = = =   ' w o r k i n g - c a p i t a l '   & &   s e l e c t e d C o m p a n y I d   & &   m o n t h l y . l e n g t h   >   0   & &   (  
                 < d i v   s t y l e = { {   m a x W i d t h :   ' 1 4 0 0 p x ' ,   m a r g i n :   ' 0   a u t o ' ,   p a d d i n g :   ' 3 2 p x '   } } >  
                     < s t y l e > { `  
                         @ m e d i a   p r i n t   {  
                             @ p a g e   {  
                                 s i z e :   l a n d s c a p e ;  
                                 m a r g i n :   0 . 1 5 i n ;  
                             }  
                              
                             / *   H i d e   n a v i g a t i o n   a n d   U I   e l e m e n t s   * /  
                             . n o - p r i n t ,  
                             h e a d e r ,  
                             n a v ,  
                             a s i d e ,  
                             [ r o l e = " n a v i g a t i o n " ] ,  
                             b u t t o n   {  
                                 d i s p l a y :   n o n e   ! i m p o r t a n t ;  
                             }  
                              
                             / *   R e m o v e   b a c k g r o u n d   c o l o r s   a n d   s h a d o w s   * /  
                             *   {  
                                 b o x - s h a d o w :   n o n e   ! i m p o r t a n t ;  
                             }  
                              
                             / *   P a g e   b r e a k s   * /  
                             . p a g e - b r e a k - a f t e r   {  
                                 p a g e - b r e a k - a f t e r :   a l w a y s ;  
                             }  
                              
                             / *   S h o w   s e c o n d   p a g e   h e a d e r   o n l y   w h e n   p r i n t i n g   * /  
                             . w c - p a g e - 2 - h e a d e r   {  
                                 d i s p l a y :   b l o c k   ! i m p o r t a n t ;  
                                 m a r g i n - t o p :   0   ! i m p o r t a n t ;  
                                 p a d d i n g - t o p :   2 4 p x   ! i m p o r t a n t ;  
                             }  
                              
                             / *   E n s u r e   c o n t e n t   f i t s   o n   l a n d s c a p e   p a g e s   * /  
                             . w c - p r i n t - c o n t e n t   {  
                                 w i d t h :   1 0 0 % ;  
                             }  
                              
                             / *   S c a l e   d o w n   f i r s t   p a g e   c o n t e n t   t o   f i t   * /  
                             . w c - f i r s t - p a g e - c o n t e n t ,  
                             . p a g e - b r e a k - a f t e r   {  
                                 t r a n s f o r m :   s c a l e ( 0 . 8 5 ) ;  
                                 t r a n s f o r m - o r i g i n :   t o p   l e f t ;  
                                 w i d t h :   1 1 7 . 6 5 % ;   / *   C o m p e n s a t e   f o r   s c a l e   * /  
                             }  
                              
                             / *   A d d i t i o n a l l y   s c a l e   t h e   c h a r t   h o r i z o n t a l l y   t o   f i t   w i t h i n   p a g e   * /  
                             . p a g e - b r e a k - a f t e r   s v g   {  
                                 t r a n s f o r m :   s c a l e X ( 0 . 9 5 )   ! i m p o r t a n t ;  
                                 t r a n s f o r m - o r i g i n :   l e f t   c e n t e r   ! i m p o r t a n t ;  
                                 o v e r f l o w :   v i s i b l e   ! i m p o r t a n t ;  
                             }  
                              
                             / *   E n s u r e   c h a r t   c o n t a i n e r   d o e s n ' t   c l i p   o v e r f l o w   l a b e l s   * /  
                             . p a g e - b r e a k - a f t e r   >   d i v   {  
                                 o v e r f l o w :   v i s i b l e   ! i m p o r t a n t ;  
                             }  
                              
                             / *   R e d u c e   s p a c i n g   f o r   p r i n t   * /  
                             @ m e d i a   p r i n t   {  
                                 h 1   {  
                                     f o n t - s i z e :   2 4 p x   ! i m p o r t a n t ;  
                                     m a r g i n - b o t t o m :   1 6 p x   ! i m p o r t a n t ;  
                                 }  
                                  
                                 h 2   {  
                                     f o n t - s i z e :   1 6 p x   ! i m p o r t a n t ;  
                                     m a r g i n - b o t t o m :   1 2 p x   ! i m p o r t a n t ;  
                                 }  
                                  
                                 . w c - f i r s t - p a g e - c o n t e n t   {  
                                     m a r g i n - b o t t o m :   1 6 p x   ! i m p o r t a n t ;  
                                     g a p :   8 p x   ! i m p o r t a n t ;  
                                 }  
                                  
                                 . p a g e - b r e a k - a f t e r   {  
                                     m a r g i n - b o t t o m :   1 6 p x   ! i m p o r t a n t ;  
                                     p a d d i n g :   1 6 p x   ! i m p o r t a n t ;  
                                 }  
                                  
                                 / *   R e d u c e   p a d d i n g   a n d   f o n t   s i z e s   i n   m e t r i c   c a r d s   * /  
                                 . w c - f i r s t - p a g e - c o n t e n t   >   d i v   {  
                                     p a d d i n g :   1 0 p x   ! i m p o r t a n t ;  
                                 }  
                                  
                                 . w c - f i r s t - p a g e - c o n t e n t   >   d i v   h 3   {  
                                     f o n t - s i z e :   1 1 p x   ! i m p o r t a n t ;  
                                     m a r g i n - b o t t o m :   6 p x   ! i m p o r t a n t ;  
                                 }  
                                  
                                 . w c - f i r s t - p a g e - c o n t e n t   >   d i v   >   d i v : f i r s t - o f - t y p e   {  
                                     f o n t - s i z e :   2 2 p x   ! i m p o r t a n t ;  
                                     m a r g i n - b o t t o m :   2 p x   ! i m p o r t a n t ;  
                                 }  
                                  
                                 . w c - f i r s t - p a g e - c o n t e n t   >   d i v   >   d i v : l a s t - o f - t y p e   {  
                                     f o n t - s i z e :   1 0 p x   ! i m p o r t a n t ;  
                                 }  
                                  
                                 / *   C o m p r e s s   s e c o n d   p a g e   -   C o m p o n e n t s   B r e a k d o w n   * /  
                                 . w c - c o m p o n e n t s - b r e a k d o w n   {  
                                     m a r g i n - b o t t o m :   1 2 p x   ! i m p o r t a n t ;  
                                     g a p :   1 6 p x   ! i m p o r t a n t ;  
                                 }  
                                  
                                 . w c - c o m p o n e n t s - b r e a k d o w n   >   d i v   {  
                                     p a d d i n g :   1 6 p x   ! i m p o r t a n t ;  
                                 }  
                                  
                                 . w c - c o m p o n e n t s - b r e a k d o w n   h 2   {  
                                     f o n t - s i z e :   1 6 p x   ! i m p o r t a n t ;  
                                     m a r g i n - b o t t o m :   1 2 p x   ! i m p o r t a n t ;  
                                 }  
                                  
                                 . w c - c o m p o n e n t s - b r e a k d o w n   >   d i v   >   d i v   {  
                                     g a p :   8 p x   ! i m p o r t a n t ;  
                                 }  
                                  
                                 . w c - c o m p o n e n t s - b r e a k d o w n   >   d i v   >   d i v   >   d i v   {  
                                     p a d d i n g :   8 p x   ! i m p o r t a n t ;  
                                     f o n t - s i z e :   1 2 p x   ! i m p o r t a n t ;  
                                 }  
                                  
                                 / *   C o m p r e s s   s e c o n d   p a g e   -   I n s i g h t s   S e c t i o n   * /  
                                 . w c - i n s i g h t s   {  
                                     p a d d i n g :   1 6 p x   ! i m p o r t a n t ;  
                                     m a r g i n - b o t t o m :   0   ! i m p o r t a n t ;  
                                 }  
                                  
                                 . w c - i n s i g h t s   h 2   {  
                                     f o n t - s i z e :   1 6 p x   ! i m p o r t a n t ;  
                                     m a r g i n - b o t t o m :   1 2 p x   ! i m p o r t a n t ;  
                                 }  
                                  
                                 . w c - i n s i g h t s   >   d i v   {  
                                     g a p :   1 0 p x   ! i m p o r t a n t ;  
                                 }  
                                  
                                 . w c - i n s i g h t s   >   d i v   >   d i v   {  
                                     p a d d i n g :   1 0 p x   ! i m p o r t a n t ;  
                                     f o n t - s i z e :   1 1 p x   ! i m p o r t a n t ;  
                                     l i n e - h e i g h t :   1 . 4   ! i m p o r t a n t ;  
                                 }  
                                  
                                 . w c - i n s i g h t s   >   d i v   >   d i v   >   d i v : f i r s t - c h i l d   {  
                                     f o n t - s i z e :   1 2 p x   ! i m p o r t a n t ;  
                                     m a r g i n - b o t t o m :   4 p x   ! i m p o r t a n t ;  
                                 }  
                                  
                                 . w c - i n s i g h t s   >   d i v   >   d i v   >   d i v : l a s t - c h i l d   {  
                                     f o n t - s i z e :   1 1 p x   ! i m p o r t a n t ;  
                                 }  
                             }  
                         }  
                     ` } < / s t y l e >  
                      
                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                         < h 1   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n :   0   } } > W o r k i n g   C a p i t a l   A n a l y s i s < / h 1 >  
                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 1 6 p x '   } } >  
                             { c o m p a n y N a m e   & &   < d i v   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > { c o m p a n y N a m e } < / d i v > }  
                             < b u t t o n    
                                 c l a s s N a m e = " n o - p r i n t "  
                                 o n C l i c k = { ( )   = >   w i n d o w . p r i n t ( ) }    
                                 s t y l e = { {    
                                     p a d d i n g :   ' 1 2 p x   2 4 p x ' ,    
                                     b a c k g r o u n d :   ' # 6 6 7 e e a ' ,    
                                     c o l o r :   ' w h i t e ' ,    
                                     b o r d e r :   ' n o n e ' ,    
                                     b o r d e r R a d i u s :   ' 8 p x ' ,    
                                     f o n t S i z e :   ' 1 4 p x ' ,    
                                     f o n t W e i g h t :   ' 6 0 0 ' ,    
                                     c u r s o r :   ' p o i n t e r ' ,  
                                     b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 1 0 2 ,   1 2 6 ,   2 3 4 ,   0 . 3 ) '  
                                 } } >  
                                  x       P r i n t  
                             < / b u t t o n >  
                         < / d i v >  
                     < / d i v >  
                      
                     { ( ( )   = >   {  
                         / /   C a l c u l a t e   w o r k i n g   c a p i t a l   f o r   e a c h   m o n t h  
                         c o n s t   w c D a t a   =   m o n t h l y . m a p ( m   = >   ( {  
                             m o n t h :   m . m o n t h ,  
                             c u r r e n t A s s e t s :   m . c a s h   +   m . a r   +   m . i n v e n t o r y   +   m . o t h e r C A ,  
                             c u r r e n t L i a b i l i t i e s :   m . a p   +   m . o t h e r C L ,  
                             w o r k i n g C a p i t a l :   ( m . c a s h   +   m . a r   +   m . i n v e n t o r y   +   m . o t h e r C A )   -   ( m . a p   +   m . o t h e r C L ) ,  
                             r e v e n u e :   m . r e v e n u e  
                         } ) ) ;  
                          
                         / /   C u r r e n t   p e r i o d   m e t r i c s  
                         c o n s t   c u r r e n t   =   w c D a t a [ w c D a t a . l e n g t h   -   1 ] ;  
                         c o n s t   p r i o r   =   w c D a t a . l e n g t h   > =   1 3   ?   w c D a t a [ w c D a t a . l e n g t h   -   1 3 ]   :   w c D a t a [ 0 ] ;  
                          
                         c o n s t   c u r r e n t W C   =   c u r r e n t . w o r k i n g C a p i t a l ;  
                         c o n s t   w c R a t i o   =   c u r r e n t . c u r r e n t L i a b i l i t i e s   ! = =   0   ?   c u r r e n t . c u r r e n t A s s e t s   /   c u r r e n t . c u r r e n t L i a b i l i t i e s   :   0 ;  
                         c o n s t   w c C h a n g e   =   c u r r e n t W C   -   p r i o r . w o r k i n g C a p i t a l ;  
                         c o n s t   w c C h a n g e P e r c e n t   =   p r i o r . w o r k i n g C a p i t a l   ! = =   0   ?   ( w c C h a n g e   /   M a t h . a b s ( p r i o r . w o r k i n g C a p i t a l ) )   *   1 0 0   :   0 ;  
                          
                         / /   C a l c u l a t e   d a y s   w o r k i n g   c a p i t a l   ( W C   /   d a i l y   r e v e n u e )  
                         c o n s t   l a s t 1 2 M o n t h s   =   m o n t h l y . s l i c e ( - 1 2 ) ;  
                         c o n s t   a n n u a l R e v e n u e   =   l a s t 1 2 M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   m . r e v e n u e ,   0 ) ;  
                         c o n s t   d a i l y R e v e n u e   =   a n n u a l R e v e n u e   /   3 6 5 ;  
                         c o n s t   d a y s W C   =   d a i l y R e v e n u e   ! = =   0   ?   c u r r e n t W C   /   d a i l y R e v e n u e   :   0 ;  
                          
                         / /   W o r k i n g   C a p i t a l   C y c l e   c o m p o n e n t s  
                         c o n s t   d a y s A R   =   c u r r e n t . r e v e n u e   ! = =   0   ?   ( c u r r e n t . c u r r e n t A s s e t s   *   0 . 4   /   ( c u r r e n t . r e v e n u e   *   1 2 ) )   *   3 6 5   :   0 ;   / /   E s t i m a t e   A R   a s   4 0 %   o f   c u r r e n t   a s s e t s  
                         c o n s t   d a y s A P   =   c u r r e n t . r e v e n u e   ! = =   0   ?   ( c u r r e n t . c u r r e n t L i a b i l i t i e s   *   0 . 6   /   ( c u r r e n t . r e v e n u e   *   1 2   *   0 . 7 ) )   *   3 6 5   :   0 ;   / /   E s t i m a t e   A P  
                         c o n s t   d a y s I n v e n t o r y   =   c u r r e n t . r e v e n u e   ! = =   0   ?   ( c u r r e n t . c u r r e n t A s s e t s   *   0 . 2   /   ( c u r r e n t . r e v e n u e   *   1 2   *   0 . 7 ) )   *   3 6 5   :   0 ;   / /   E s t i m a t e   i n v e n t o r y  
                         c o n s t   c a s h C o n v e r s i o n C y c l e   =   d a y s A R   +   d a y s I n v e n t o r y   -   d a y s A P ;  
                          
                         / /   H i s t o r i c a l   a v e r a g e s  
                         c o n s t   a v g W C   =   w c D a t a . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . w o r k i n g C a p i t a l ,   0 )   /   w c D a t a . l e n g t h ;  
                         c o n s t   m i n W C   =   M a t h . m i n ( . . . w c D a t a . m a p ( d   = >   d . w o r k i n g C a p i t a l ) ) ;  
                         c o n s t   m a x W C   =   M a t h . m a x ( . . . w c D a t a . m a p ( d   = >   d . w o r k i n g C a p i t a l ) ) ;  
                          
                         r e t u r n   (  
                             < >  
                                 { / *   K e y   M e t r i c s   C a r d s   * / }  
                                 < d i v   c l a s s N a m e = " w c - f i r s t - p a g e - c o n t e n t "   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( 4 ,   m i n m a x ( 0 ,   2 0 0 p x ) ) ' ,   g a p :   ' 2 0 p x ' ,   m a r g i n B o t t o m :   ' 3 2 p x ' ,   j u s t i f y C o n t e n t :   ' c e n t e r '   } } >  
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   b o r d e r :   ' 2 p x   s o l i d   # 6 6 7 e e a '   } } >  
                                         < h 3   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > C u r r e n t   W o r k i n g   C a p i t a l < / h 3 >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 2 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 6 6 7 e e a ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                             $ { ( c u r r e n t W C   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   w c C h a n g e   > =   0   ?   ' # 1 0 b 9 8 1 '   :   ' # e f 4 4 4 4 ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                             { w c C h a n g e   > =   0   ?   '     '   :   '     ' }   $ { M a t h . a b s ( w c C h a n g e   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K   ( { w c C h a n g e P e r c e n t   > =   0   ?   ' + '   :   ' ' } { w c C h a n g e P e r c e n t . t o F i x e d ( 1 ) } % )   v s .   1 Y   a g o  
                                         < / d i v >  
                                     < / d i v >  
                                      
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   b o r d e r :   ' 2 p x   s o l i d   # 6 6 7 e e a '   } } >  
                                         < h 3   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > W o r k i n g   C a p i t a l   R a t i o < / h 3 >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 2 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   w c R a t i o   > =   1 . 5   ?   ' # 1 0 b 9 8 1 '   :   w c R a t i o   > =   1 . 0   ?   ' # f 5 9 e 0 b '   :   ' # e f 4 4 4 4 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                             { w c R a t i o . t o F i x e d ( 2 ) }  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } >  
                                             { w c R a t i o   > =   1 . 5   ?   ' S t r o n g '   :   w c R a t i o   > =   1 . 0   ?   ' A d e q u a t e '   :   ' N e e d s   A t t e n t i o n ' }  
                                         < / d i v >  
                                     < / d i v >  
                                      
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   b o r d e r :   ' 2 p x   s o l i d   # 6 6 7 e e a '   } } >  
                                         < h 3   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > D a y s   W o r k i n g   C a p i t a l < / h 3 >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 2 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                             { d a y s W C . t o F i x e d ( 0 ) }  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } >  
                                             D a y s   o f   r e v e n u e   c o v e r e d  
                                         < / d i v >  
                                     < / d i v >  
                                      
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   b o r d e r :   ' 2 p x   s o l i d   # 6 6 7 e e a '   } } >  
                                         < h 3   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > C a s h   C o n v e r s i o n   C y c l e < / h 3 >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 2 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                             { c a s h C o n v e r s i o n C y c l e . t o F i x e d ( 0 ) }  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } >  
                                             D a y s   ( e s t i m a t e d )  
                                         < / d i v >  
                                     < / d i v >  
                                 < / d i v >  
                                  
                                 { / *   W o r k i n g   C a p i t a l   T r e n d   C h a r t   * / }  
                                 < d i v   c l a s s N a m e = " p a g e - b r e a k - a f t e r "   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                     < h 2   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 2 0 p x '   } } > W o r k i n g   C a p i t a l   T r e n d < / h 2 >  
                                     < L i n e C h a r t    
                                         t i t l e = " "    
                                         d a t a = { w c D a t a . m a p ( d   = >   ( {   m o n t h :   d . m o n t h ,   v a l u e :   d . w o r k i n g C a p i t a l   } ) ) }    
                                         c o l o r = " # 6 6 7 e e a "  
                                         s h o w T a b l e = { f a l s e }  
                                         f o r m a t t e r = { ( v a l )   = >   ` $ $ { M a t h . r o u n d ( v a l ) . t o L o c a l e S t r i n g ( ) } ` }  
                                     / >  
                                      
                                     { / *   C u s t o m   Q u a r t e r l y   T a b l e   * / }  
                                     < d i v   s t y l e = { {   m a r g i n T o p :   ' 1 6 p x ' ,   o v e r f l o w X :   ' a u t o '   } } >  
                                         < t a b l e   s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   f o n t S i z e :   ' 1 2 p x ' ,   b o r d e r C o l l a p s e :   ' c o l l a p s e '   } } >  
                                             < t b o d y >  
                                                 < t r   s t y l e = { {   b a c k g r o u n d :   ' # f 1 f 5 f 9 ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # c b d 5 e 1 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m i n W i d t h :   ' 8 0 p x '   } } >  
                                                         Q u a r t e r  
                                                     < / t d >  
                                                     { w c D a t a . f i l t e r ( ( _ ,   i )   = >   i   %   3   = = =   2 ) . m a p ( ( d ,   i )   = >   (  
                                                         < t d   k e y = { ` q u a r t e r - $ { i } ` }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   t e x t A l i g n :   ' c e n t e r ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } >  
                                                             { d . m o n t h }  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } >  
                                                         V a l u e  
                                                     < / t d >  
                                                     { w c D a t a . f i l t e r ( ( _ ,   i )   = >   i   %   3   = = =   2 ) . m a p ( ( d ,   i )   = >   (  
                                                         < t d   k e y = { ` v a l - $ { i } ` }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   t e x t A l i g n :   ' c e n t e r ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 6 6 7 e e a '   } } >  
                                                             $ { M a t h . r o u n d ( d . w o r k i n g C a p i t a l ) . t o L o c a l e S t r i n g ( ) }  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                             < / t b o d y >  
                                         < / t a b l e >  
                                     < / d i v >  
                                 < / d i v >  
                                  
                                 { / *   S e c o n d   P a g e   H e a d e r   * / }  
                                 < d i v   c l a s s N a m e = " w c - p a g e - 2 - h e a d e r "   s t y l e = { {   d i s p l a y :   ' n o n e ' ,   m a r g i n T o p :   ' 3 2 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   t e x t A l i g n :   ' c e n t e r '   } } >  
                                     < h 2   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n :   0   } } >  
                                         W o r k i n g   C a p i t a l   A n a l y s i s   -   { c o m p a n y N a m e }  
                                     < / h 2 >  
                                 < / d i v >  
                                  
                                 { / *   C o m p o n e n t s   B r e a k d o w n   * / }  
                                 < d i v   c l a s s N a m e = " w c - c o m p o n e n t s - b r e a k d o w n "   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( 2 ,   1 f r ) ' ,   g a p :   ' 2 4 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                         < h 2   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 2 0 p x '   } } > C u r r e n t   A s s e t s < / h 2 >  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g a p :   ' 1 2 p x '   } } >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   p a d d i n g :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                                 < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > C a s h < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { ( c u r r e n t . c u r r e n t A s s e t s   *   0 . 3   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K < / s p a n >  
                                             < / d i v >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   p a d d i n g :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                                 < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > A c c o u n t s   R e c e i v a b l e < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { ( c u r r e n t . c u r r e n t A s s e t s   *   0 . 4   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K < / s p a n >  
                                             < / d i v >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   p a d d i n g :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                                 < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > I n v e n t o r y < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { ( c u r r e n t . c u r r e n t A s s e t s   *   0 . 2   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K < / s p a n >  
                                             < / d i v >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   p a d d i n g :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                                 < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > O t h e r   C u r r e n t   A s s e t s < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { ( c u r r e n t . c u r r e n t A s s e t s   *   0 . 1   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K < / s p a n >  
                                             < / d i v >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' # 6 6 7 e e a ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   m a r g i n T o p :   ' 8 p x '   } } >  
                                                 < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' w h i t e '   } } > T o t a l   C u r r e n t   A s s e t s < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' w h i t e '   } } > $ { ( c u r r e n t . c u r r e n t A s s e t s   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K < / s p a n >  
                                             < / d i v >  
                                         < / d i v >  
                                     < / d i v >  
                                      
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                         < h 2   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 2 0 p x '   } } > C u r r e n t   L i a b i l i t i e s < / h 2 >  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g a p :   ' 1 2 p x '   } } >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   p a d d i n g :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                                 < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > A c c o u n t s   P a y a b l e < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { ( c u r r e n t . c u r r e n t L i a b i l i t i e s   *   0 . 6   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K < / s p a n >  
                                             < / d i v >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   p a d d i n g :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                                 < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > A c c r u e d   E x p e n s e s < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { ( c u r r e n t . c u r r e n t L i a b i l i t i e s   *   0 . 2 5   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K < / s p a n >  
                                             < / d i v >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   p a d d i n g :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                                 < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > O t h e r   C u r r e n t   L i a b i l i t i e s < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { ( c u r r e n t . c u r r e n t L i a b i l i t i e s   *   0 . 1 5   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K < / s p a n >  
                                             < / d i v >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' # e f 4 4 4 4 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   m a r g i n T o p :   ' 6 0 p x '   } } >  
                                                 < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' w h i t e '   } } > T o t a l   C u r r e n t   L i a b i l i t i e s < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' w h i t e '   } } > $ { ( c u r r e n t . c u r r e n t L i a b i l i t i e s   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K < / s p a n >  
                                             < / d i v >  
                                         < / d i v >  
                                     < / d i v >  
                                 < / d i v >  
                                  
                                 { / *   W o r k i n g   C a p i t a l   A n a l y s i s   * / }  
                                 < d i v   c l a s s N a m e = " w c - i n s i g h t s "   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                     < h 2   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 2 0 p x '   } } > W o r k i n g   C a p i t a l   I n s i g h t s < / h 2 >  
                                      
                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g a p :   ' 1 6 p x '   } } >  
                                         { c u r r e n t W C   >   0   & &   w c R a t i o   > =   1 . 5   & &   (  
                                             < d i v   s t y l e = { {   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' # f 0 f d f 4 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   b o r d e r L e f t :   ' 4 p x   s o l i d   # 1 0 b 9 8 1 '   } } >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 6 6 5 3 4 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  S   S t r o n g   L i q u i d i t y   P o s i t i o n < / d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 1 6 6 5 3 4 ' ,   l i n e H e i g h t :   ' 1 . 6 '   } } >  
                                                     Y o u r   w o r k i n g   c a p i t a l   r a t i o   o f   { w c R a t i o }   i n d i c a t e s   s t r o n g   s h o r t - t e r m   f i n a n c i a l   h e a l t h   w i t h   $ { ( c u r r e n t W C   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K   i n   w o r k i n g   c a p i t a l   a v a i l a b l e   t o   c o v e r   o p e r a t i o n a l   n e e d s .  
                                                 < / d i v >  
                                             < / d i v >  
                                         ) }  
                                          
                                         { c u r r e n t W C   >   0   & &   w c R a t i o   <   1 . 5   & &   w c R a t i o   > =   1 . 0   & &   (  
                                             < d i v   s t y l e = { {   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' # f f f b e b ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   b o r d e r L e f t :   ' 4 p x   s o l i d   # f 5 9 e 0 b '   } } >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 9 2 4 0 0 e ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  a   A d e q u a t e   b u t   M o n i t o r   C l o s e l y < / d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 9 2 4 0 0 e ' ,   l i n e H e i g h t :   ' 1 . 6 '   } } >  
                                                     Y o u r   w o r k i n g   c a p i t a l   r a t i o   o f   { w c R a t i o }   i s   a d e q u a t e   b u t   b e l o w   i d e a l   l e v e l s .   C o n s i d e r   i m p r o v i n g   c a s h   f l o w   o r   r e d u c i n g   s h o r t - t e r m   l i a b i l i t i e s   t o   s t r e n g t h e n   y o u r   p o s i t i o n .  
                                                 < / d i v >  
                                             < / d i v >  
                                         ) }  
                                          
                                         { w c R a t i o   <   1 . 0   & &   (  
                                             < d i v   s t y l e = { {   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' # f e f 2 f 2 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   b o r d e r L e f t :   ' 4 p x   s o l i d   # e f 4 4 4 4 '   } } >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 9 9 1 b 1 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  a   L i q u i d i t y   C o n c e r n < / d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 9 9 1 b 1 b ' ,   l i n e H e i g h t :   ' 1 . 6 '   } } >  
                                                     Y o u r   w o r k i n g   c a p i t a l   r a t i o   o f   { w c R a t i o }   i n d i c a t e s   c u r r e n t   l i a b i l i t i e s   e x c e e d   c u r r e n t   a s s e t s .   I m m e d i a t e   a t t e n t i o n   t o   c a s h   f l o w   m a n a g e m e n t   a n d   w o r k i n g   c a p i t a l   o p t i m i z a t i o n   i s   r e c o m m e n d e d .  
                                                 < / d i v >  
                                             < / d i v >  
                                         ) }  
                                          
                                         { w c C h a n g e   >   0   & &   (  
                                             < d i v   s t y l e = { {   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' # f 0 f 9 f f ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   b o r d e r L e f t :   ' 4 p x   s o l i d   # 0 2 8 4 c 7 '   } } >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 0 c 4 a 6 e ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >       P o s i t i v e   T r e n d < / d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 0 c 4 a 6 e ' ,   l i n e H e i g h t :   ' 1 . 6 '   } } >  
                                                     W o r k i n g   c a p i t a l   h a s   i n c r e a s e d   b y   $ { ( w c C h a n g e   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K   ( { w c C h a n g e P e r c e n t . t o F i x e d ( 1 ) } % )   o v e r   t h e   p a s t   y e a r ,   i n d i c a t i n g   i m p r o v e d   o p e r a t i o n a l   e f f i c i e n c y   a n d   f i n a n c i a l   s t a b i l i t y .  
                                                 < / d i v >  
                                             < / d i v >  
                                         ) }  
                                     < / d i v >  
                                 < / d i v >  
                             < / >  
                         ) ;  
                     } ) ( ) }  
                 < / d i v >  
             ) }  
  
             { / *   V a l u a t i o n   V i e w   * / }  
             { c u r r e n t V i e w   = = =   ' v a l u a t i o n '   & &   s e l e c t e d C o m p a n y I d   & &   m o n t h l y . l e n g t h   >   0   & &   (  
                 < d i v   s t y l e = { {   m a x W i d t h :   ' 1 4 0 0 p x ' ,   m a r g i n :   ' 0   a u t o ' ,   p a d d i n g :   ' 3 2 p x '   } } >  
                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                         < h 1   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n :   0   } } > B u s i n e s s   V a l u a t i o n < / h 1 >  
                         { c o m p a n y N a m e   & &   < d i v   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > { c o m p a n y N a m e } < / d i v > }  
                     < / d i v >  
                      
                     { ( ( )   = >   {  
                         / /   C a l c u l a t e   t r a i l i n g   1 2   m o n t h s   v a l u e s  
                         c o n s t   l a s t 1 2   =   m o n t h l y . s l i c e ( - 1 2 ) ;  
                         c o n s t   t t m R e v e n u e   =   l a s t 1 2 . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . r e v e n u e   | |   0 ) ,   0 ) ;  
                         c o n s t   t t m C O G S   =   l a s t 1 2 . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s T o t a l   | |   0 ) ,   0 ) ;  
                         c o n s t   t t m E x p e n s e   =   l a s t 1 2 . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . e x p e n s e   | |   0 ) ,   0 ) ;  
                         c o n s t   t t m D e p r e c i a t i o n   =   l a s t 1 2 . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . d e p r e c i a t i o n E x p e n s e   | |   0 ) ,   0 ) ;  
                         c o n s t   t t m I n t e r e s t   =   l a s t 1 2 . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . i n t e r e s t E x p e n s e   | |   0 ) ,   0 ) ;  
                          
                         / /   C a l c u l a t e   N e t   I n c o m e   c o r r e c t l y :   R e v e n u e   -   C O G S   -   O p e r a t i n g   E x p e n s e s  
                         c o n s t   t t m G r o s s P r o f i t   =   t t m R e v e n u e   -   t t m C O G S ;  
                         c o n s t   t t m N e t I n c o m e   =   t t m R e v e n u e   -   t t m C O G S   -   t t m E x p e n s e ;  
                          
                         / /   C a l c u l a t e   E B I T D A :   N e t   I n c o m e   +   I n t e r e s t   +   T a x e s   +   D e p r e c i a t i o n   +   A m o r t i z a t i o n  
                         c o n s t   t t m E B I T D A   =   t t m N e t I n c o m e   +   t t m D e p r e c i a t i o n   +   t t m I n t e r e s t ;  
                         / /   N o t e :   W e   d o n ' t   h a v e   a   s e p a r a t e   t a x   f i e l d ,   s o   t h i s   i s   t e c h n i c a l l y   E B I T   i f   t a x e s   a r e   i n   ' e x p e n s e '  
                          
                         / /   C a l c u l a t e   S D E   u s i n g   A C T U A L   O w n e r   B a s e   P a y   f r o m   i n c o m e   s t a t e m e n t  
                         c o n s t   t t m O w n e r B a s e P a y   =   l a s t 1 2 . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . o w n e r s B a s e P a y   | |   0 ) ,   0 ) ;  
                         c o n s t   t t m S D E   =   t t m E B I T D A   +   t t m O w n e r B a s e P a y ;  
                          
                         / /   C a l c u l a t e   v a l u a t i o n s  
                         c o n s t   s d e V a l u a t i o n   =   t t m S D E   *   s d e M u l t i p l i e r ;  
                         c o n s t   e b i t d a V a l u a t i o n   =   t t m E B I T D A   *   e b i t d a M u l t i p l i e r ;  
                          
                         / /   C a l c u l a t e   F r e e   C a s h   F l o w   ( F C F )   f o r   D C F  
                         / /   F C F   =   N e t   I n c o m e   +   D e p r e c i a t i o n   -   C h a n g e s   i n   W o r k i n g   C a p i t a l   -   C a p E x  
                         c o n s t   c u r r e n t M o n t h   =   m o n t h l y [ m o n t h l y . l e n g t h   -   1 ] ;  
                         c o n s t   m o n t h 1 2 A g o   =   m o n t h l y . l e n g t h   > =   1 3   ?   m o n t h l y [ m o n t h l y . l e n g t h   -   1 3 ]   :   m o n t h l y [ 0 ] ;  
                          
                         / /   W o r k i n g   c a p i t a l   c h a n g e   o v e r   l a s t   1 2   m o n t h s  
                         c o n s t   c u r r e n t W C   =   ( ( c u r r e n t M o n t h . c a s h   | |   0 )   +   ( c u r r e n t M o n t h . a r   | |   0 )   +   ( c u r r e n t M o n t h . i n v e n t o r y   | |   0 ) )   -   ( ( c u r r e n t M o n t h . a p   | |   0 )   +   ( c u r r e n t M o n t h . o t h e r C L   | |   0 ) ) ;  
                         c o n s t   p r i o r W C   =   ( ( m o n t h 1 2 A g o . c a s h   | |   0 )   +   ( m o n t h 1 2 A g o . a r   | |   0 )   +   ( m o n t h 1 2 A g o . i n v e n t o r y   | |   0 ) )   -   ( ( m o n t h 1 2 A g o . a p   | |   0 )   +   ( m o n t h 1 2 A g o . o t h e r C L   | |   0 ) ) ;  
                         c o n s t   c h a n g e I n W C   =   c u r r e n t W C   -   p r i o r W C ;  
                          
                         / /   C a p i t a l   e x p e n d i t u r e s   ( c h a n g e   i n   f i x e d   a s s e t s   +   d e p r e c i a t i o n )  
                         c o n s t   c h a n g e I n F i x e d A s s e t s   =   ( c u r r e n t M o n t h . f i x e d A s s e t s   | |   0 )   -   ( m o n t h 1 2 A g o . f i x e d A s s e t s   | |   0 ) ;  
                         c o n s t   t t m C a p E x   =   M a t h . m a x ( 0 ,   c h a n g e I n F i x e d A s s e t s   +   t t m D e p r e c i a t i o n ) ;  
                          
                         / /   F r e e   C a s h   F l o w   u s i n g   A C T U A L   d e p r e c i a t i o n  
                         c o n s t   t t m F r e e C a s h F l o w   =   t t m N e t I n c o m e   +   t t m D e p r e c i a t i o n   -   c h a n g e I n W C   -   t t m C a p E x ;  
                          
                         / /   D C F   c a l c u l a t i o n   w i t h   a d j u s t a b l e   p a r a m e t e r s   u s i n g   F C F  
                         c o n s t   g r o w t h R a t e   =   g r o w t h _ 2 4 m o   /   1 0 0 ;  
                         c o n s t   d i s c o u n t R a t e   =   d c f D i s c o u n t R a t e   /   1 0 0 ;  
                         c o n s t   t e r m i n a l G r o w t h R a t e   =   d c f T e r m i n a l G r o w t h   /   1 0 0 ;  
                         l e t   d c f V a l u e   =   0 ;  
                         f o r   ( l e t   y e a r   =   1 ;   y e a r   < =   5 ;   y e a r + + )   {  
                             c o n s t   p r o j e c t e d F C F   =   t t m F r e e C a s h F l o w   *   M a t h . p o w ( 1   +   g r o w t h R a t e ,   y e a r ) ;  
                             d c f V a l u e   + =   p r o j e c t e d F C F   /   M a t h . p o w ( 1   +   d i s c o u n t R a t e ,   y e a r ) ;  
                         }  
                         c o n s t   t e r m i n a l V a l u e   =   ( t t m F r e e C a s h F l o w   *   M a t h . p o w ( 1   +   g r o w t h R a t e ,   5 )   *   ( 1   +   t e r m i n a l G r o w t h R a t e ) )   /   ( d i s c o u n t R a t e   -   t e r m i n a l G r o w t h R a t e ) ;  
                         d c f V a l u e   + =   t e r m i n a l V a l u e   /   M a t h . p o w ( 1   +   d i s c o u n t R a t e ,   5 ) ;  
                          
                         r e t u r n   (  
                             < >  
                                 { / *   O v e r v i e w   C a r d s   * / }  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( 3 ,   1 f r ) ' ,   g a p :   ' 2 0 p x ' ,   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   b o r d e r :   ' 2 p x   s o l i d   # 1 0 b 9 8 1 '   } } >  
                                         < h 3   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > S D E   V a l u a t i o n < / h 3 >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 2 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 0 b 9 8 1 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                             $ { M a t h . r o u n d ( s d e V a l u a t i o n ) . t o L o c a l e S t r i n g ( ) }  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } >  
                                             T T M   S D E :   $ { ( t t m S D E   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K       { s d e M u l t i p l i e r } x  
                                         < / d i v >  
                                     < / d i v >  
                                      
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   b o r d e r :   ' 2 p x   s o l i d   # 6 6 7 e e a '   } } >  
                                         < h 3   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > E B I T D A   V a l u a t i o n < / h 3 >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 2 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 6 6 7 e e a ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                             $ { M a t h . r o u n d ( e b i t d a V a l u a t i o n ) . t o L o c a l e S t r i n g ( ) }  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } >  
                                             T T M   E B I T D A :   $ { ( t t m E B I T D A   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K       { e b i t d a M u l t i p l i e r } x  
                                         < / d i v >  
                                     < / d i v >  
                                      
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   b o r d e r :   ' 2 p x   s o l i d   # f 5 9 e 0 b '   } } >  
                                         < h 3   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > D C F   V a l u a t i o n < / h 3 >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 2 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # f 5 9 e 0 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                             $ { M a t h . r o u n d ( d c f V a l u e ) . t o L o c a l e S t r i n g ( ) }  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } >  
                                             5 - y e a r   @   { d c f D i s c o u n t R a t e . t o F i x e d ( 1 ) } %   d i s c o u n t ,   { d c f T e r m i n a l G r o w t h . t o F i x e d ( 1 ) } %   t e r m i n a l  
                                         < / d i v >  
                                     < / d i v >  
                                 < / d i v >  
                                  
                                 { / *   S D E   M e t h o d   * / }  
                                 < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                     < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                                         S e l l e r ' s   D i s c r e t i o n a r y   E a r n i n g s   ( S D E )   M e t h o d  
                                     < / h 2 >  
                                      
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 0 f d f 4 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > T r a i l i n g   1 2   M o n t h s   S D E < / d i v >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 2 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 0 b 9 8 1 '   } } > $ { ( t t m S D E   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K < / d i v >  
                                         < / d i v >  
                                          
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   l i n e H e i g h t :   ' 1 . 6 '   } } >  
                                             < s t r o n g > C a l c u l a t i o n : < / s t r o n g >   E B I T D A   +   O w n e r   B a s e   P a y   +   D i s c r e t i o n a r y   E x p e n s e s  
                                             < b r / >  
                                             =   $ { ( t t m E B I T D A   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K   +   $ { ( t t m O w n e r B a s e P a y   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K  
                                         < / d i v >  
                                     < / d i v >  
                                      
                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                                         < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                             S D E   M u l t i p l e :   { s d e M u l t i p l i e r . t o F i x e d ( 1 ) } x  
                                         < / l a b e l >  
                                         < i n p u t    
                                             t y p e = " r a n g e "    
                                             m i n = " 1 "    
                                             m a x = " 5 "    
                                             s t e p = " 0 . 1 "    
                                             v a l u e = { s d e M u l t i p l i e r }    
                                             o n C h a n g e = { ( e )   = >   s e t S d e M u l t i p l i e r ( p a r s e F l o a t ( e . t a r g e t . v a l u e ) ) }    
                                             s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   m a r g i n B o t t o m :   ' 8 p x '   } }    
                                         / >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n '   } } >  
                                             < s p a n > T y p i c a l   R a n g e :   1 . 5 x   -   4 . 0 x < / s p a n >  
                                             < s p a n > I n d u s t r y   A v e r a g e :   2 . 5 x < / s p a n >  
                                         < / d i v >  
                                     < / d i v >  
                                      
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                             E s t i m a t e d   B u s i n e s s   V a l u e   ( S D E )  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 3 6 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 0 b 9 8 1 '   } } >  
                                             $ { M a t h . r o u n d ( s d e V a l u a t i o n ) . t o L o c a l e S t r i n g ( ) }  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                             R a n g e :   $ { M a t h . r o u n d ( t t m S D E   *   1 . 5 ) . t o L o c a l e S t r i n g ( ) }   -   $ { M a t h . r o u n d ( t t m S D E   *   4 . 0 ) . t o L o c a l e S t r i n g ( ) }  
                                         < / d i v >  
                                     < / d i v >  
                                 < / d i v >  
                                  
                                 { / *   E B I T D A   M e t h o d   * / }  
                                 < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                     < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                                         E B I T D A   M u l t i p l e   M e t h o d  
                                     < / h 2 >  
                                      
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' # e d e 9 f e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > T r a i l i n g   1 2   M o n t h s   E B I T D A < / d i v >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 2 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 6 6 7 e e a '   } } > $ { ( t t m E B I T D A   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K < / d i v >  
                                         < / d i v >  
                                          
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   l i n e H e i g h t :   ' 1 . 6 '   } } >  
                                             < s t r o n g > C a l c u l a t i o n : < / s t r o n g >   N e t   I n c o m e   +   I n t e r e s t   +   D e p r e c i a t i o n   &   A m o r t i z a t i o n  
                                             < b r / >  
                                             =   $ { ( t t m N e t I n c o m e   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K   +   $ { ( t t m I n t e r e s t   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K   +   $ { ( t t m D e p r e c i a t i o n   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K  
                                             < b r / >  
                                             < e m   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > N o t e :   D & A   a n d   I n t e r e s t   a r e   a d d e d   b a c k   t o   N e t   I n c o m e < / e m >  
                                         < / d i v >  
                                     < / d i v >  
                                      
                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                                         < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                             E B I T D A   M u l t i p l e :   { e b i t d a M u l t i p l i e r . t o F i x e d ( 1 ) } x  
                                         < / l a b e l >  
                                         < i n p u t    
                                             t y p e = " r a n g e "    
                                             m i n = " 2 "    
                                             m a x = " 1 0 "    
                                             s t e p = " 0 . 1 "    
                                             v a l u e = { e b i t d a M u l t i p l i e r }    
                                             o n C h a n g e = { ( e )   = >   s e t E b i t d a M u l t i p l i e r ( p a r s e F l o a t ( e . t a r g e t . v a l u e ) ) }    
                                             s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   m a r g i n B o t t o m :   ' 8 p x '   } }    
                                         / >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n '   } } >  
                                             < s p a n > T y p i c a l   R a n g e :   3 . 0 x   -   8 . 0 x < / s p a n >  
                                             < s p a n > I n d u s t r y   A v e r a g e :   5 . 0 x < / s p a n >  
                                         < / d i v >  
                                     < / d i v >  
                                      
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                             E s t i m a t e d   B u s i n e s s   V a l u e   ( E B I T D A )  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 3 6 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 6 6 7 e e a '   } } >  
                                             $ { M a t h . r o u n d ( e b i t d a V a l u a t i o n ) . t o L o c a l e S t r i n g ( ) }  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                             R a n g e :   $ { M a t h . r o u n d ( t t m E B I T D A   *   3 . 0 ) . t o L o c a l e S t r i n g ( ) }   -   $ { M a t h . r o u n d ( t t m E B I T D A   *   8 . 0 ) . t o L o c a l e S t r i n g ( ) }  
                                         < / d i v >  
                                     < / d i v >  
                                 < / d i v >  
                                  
                                 { / *   D C F   M e t h o d   * / }  
                                 < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                     < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                                         D i s c o u n t e d   C a s h   F l o w   ( D C F )   M e t h o d  
                                     < / h 2 >  
                                      
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f e f 3 c 7 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( 3 ,   1 f r ) ' ,   g a p :   ' 2 0 p x ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                             < d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 9 2 4 0 0 e ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > H i s t o r i c a l   G r o w t h   R a t e < / d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # f 5 9 e 0 b '   } } > { g r o w t h _ 2 4 m o . t o F i x e d ( 1 ) } % < / d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   c o l o r :   ' # 9 2 4 0 0 e ' ,   m a r g i n T o p :   ' 2 p x '   } } > U s e d   f o r   5 - y e a r   p r o j e c t i o n < / d i v >  
                                             < / d i v >  
                                             < d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 9 2 4 0 0 e ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > D i s c o u n t   R a t e < / d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # f 5 9 e 0 b '   } } > { d c f D i s c o u n t R a t e . t o F i x e d ( 1 ) } % < / d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   c o l o r :   ' # 9 2 4 0 0 e ' ,   m a r g i n T o p :   ' 2 p x '   } } > R i s k - a d j u s t e d   r a t e < / d i v >  
                                             < / d i v >  
                                             < d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 9 2 4 0 0 e ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > T e r m i n a l   G r o w t h < / d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # f 5 9 e 0 b '   } } > { d c f T e r m i n a l G r o w t h . t o F i x e d ( 1 ) } % < / d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   c o l o r :   ' # 9 2 4 0 0 e ' ,   m a r g i n T o p :   ' 2 p x '   } } > P e r p e t u i t y   g r o w t h < / d i v >  
                                             < / d i v >  
                                         < / d i v >  
                                          
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 7 8 3 5 0 f ' ,   l i n e H e i g h t :   ' 1 . 6 ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                             5 - y e a r   f r e e   c a s h   f l o w   p r o j e c t i o n   b a s e d   o n   h i s t o r i c a l   g r o w t h   r a t e ,   d i s c o u n t e d   t o   p r e s e n t   v a l u e .   I n c l u d e s   t e r m i n a l   v a l u e   c a l c u l a t i o n   f o r   p e r p e t u i t y   b e y o n d   f o r e c a s t   p e r i o d .  
                                         < / d i v >  
                                     < / d i v >  
                                      
                                     { / *   F r e e   C a s h   F l o w   C a l c u l a t i o n   * / }  
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f e f 3 c 7 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   m a r g i n B o t t o m :   ' 2 0 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # f c d 3 4 d '   } } >  
                                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 9 2 4 0 0 e ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } > T r a i l i n g   1 2   M o n t h s   F r e e   C a s h   F l o w < / d i v >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 2 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # f 5 9 e 0 b '   } } > $ { ( t t m F r e e C a s h F l o w   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K < / d i v >  
                                         < / d i v >  
                                          
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 7 8 3 5 0 f ' ,   l i n e H e i g h t :   ' 1 . 8 '   } } >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   m a r g i n B o t t o m :   ' 6 p x '   } } >  
                                                 < s p a n > T T M   R e v e n u e < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 '   } } > $ { ( t t m R e v e n u e   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K < / s p a n >  
                                             < / d i v >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   m a r g i n B o t t o m :   ' 6 p x '   } } >  
                                                 < s p a n > -   C O G S < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 '   } } > $ { ( t t m C O G S   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K < / s p a n >  
                                             < / d i v >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   m a r g i n B o t t o m :   ' 6 p x '   } } >  
                                                 < s p a n > -   O p e r a t i n g   E x p e n s e s < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 '   } } > $ { ( t t m E x p e n s e   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K < / s p a n >  
                                             < / d i v >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   p a d d i n g B o t t o m :   ' 6 p x ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f c d 3 4 d '   } } >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 '   } } > =   N e t   I n c o m e < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 '   } } > $ { ( t t m N e t I n c o m e   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K < / s p a n >  
                                             < / d i v >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   m a r g i n B o t t o m :   ' 6 p x '   } } >  
                                                 < s p a n > +   D e p r e c i a t i o n / A m o r t i z a t i o n < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 '   } } > $ { ( t t m D e p r e c i a t i o n   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K < / s p a n >  
                                             < / d i v >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   m a r g i n B o t t o m :   ' 6 p x '   } } >  
                                                 < s p a n > -   C h a n g e   i n   W o r k i n g   C a p i t a l < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 '   } } > $ { ( c h a n g e I n W C   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K < / s p a n >  
                                             < / d i v >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   m a r g i n B o t t o m :   ' 6 p x ' ,   p a d d i n g B o t t o m :   ' 6 p x ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f c d 3 4 d '   } } >  
                                                 < s p a n > -   C a p i t a l   E x p e n d i t u r e s < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 '   } } > $ { ( t t m C a p E x   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K < / s p a n >  
                                             < / d i v >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   m a r g i n T o p :   ' 8 p x '   } } >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 '   } } > =   F r e e   C a s h   F l o w < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # f 5 9 e 0 b '   } } > $ { ( t t m F r e e C a s h F l o w   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K < / s p a n >  
                                             < / d i v >  
                                         < / d i v >  
                                     < / d i v >  
                                      
                                     { / *   A d j u s t a b l e   P a r a m e t e r s   * / }  
                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                                         < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                             D i s c o u n t   R a t e   ( W A C C ) :   { d c f D i s c o u n t R a t e . t o F i x e d ( 1 ) } %  
                                         < / l a b e l >  
                                         < i n p u t    
                                             t y p e = " r a n g e "    
                                             m i n = " 5 "    
                                             m a x = " 2 0 "    
                                             s t e p = " 0 . 5 "    
                                             v a l u e = { d c f D i s c o u n t R a t e }    
                                             o n C h a n g e = { ( e )   = >   s e t D c f D i s c o u n t R a t e ( p a r s e F l o a t ( e . t a r g e t . v a l u e ) ) }    
                                             s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   m a r g i n B o t t o m :   ' 8 p x '   } }    
                                         / >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n '   } } >  
                                             < s p a n > L o w e r   R i s k :   5 - 8 % < / s p a n >  
                                             < s p a n > T y p i c a l :   1 0 - 1 2 % < / s p a n >  
                                             < s p a n > H i g h e r   R i s k :   1 5 - 2 0 % < / s p a n >  
                                         < / d i v >  
                                     < / d i v >  
                                      
                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                                         < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                             T e r m i n a l   G r o w t h   R a t e :   { d c f T e r m i n a l G r o w t h . t o F i x e d ( 1 ) } %  
                                         < / l a b e l >  
                                         < i n p u t    
                                             t y p e = " r a n g e "    
                                             m i n = " 0 "    
                                             m a x = " 5 "    
                                             s t e p = " 0 . 5 "    
                                             v a l u e = { d c f T e r m i n a l G r o w t h }    
                                             o n C h a n g e = { ( e )   = >   s e t D c f T e r m i n a l G r o w t h ( p a r s e F l o a t ( e . t a r g e t . v a l u e ) ) }    
                                             s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   m a r g i n B o t t o m :   ' 8 p x '   } }    
                                         / >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n '   } } >  
                                             < s p a n > C o n s e r v a t i v e :   0 - 2 % < / s p a n >  
                                             < s p a n > T y p i c a l :   2 - 3 % < / s p a n >  
                                             < s p a n > O p t i m i s t i c :   3 - 5 % < / s p a n >  
                                         < / d i v >  
                                     < / d i v >  
                                      
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                             E s t i m a t e d   B u s i n e s s   V a l u e   ( D C F )  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 3 6 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # f 5 9 e 0 b '   } } >  
                                             $ { M a t h . r o u n d ( d c f V a l u e ) . t o L o c a l e S t r i n g ( ) }  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n T o p :   ' 8 p x '   } } >  
                                             < s t r o n g > N o t e : < / s t r o n g >   D C F   b a s e d   o n   F r e e   C a s h   F l o w   ( F C F )   p r o j e c t i o n s .   V a l u a t i o n s   a r e   h i g h l y   s e n s i t i v e   t o   a s s u m p t i o n s   a b o u t   g r o w t h   r a t e s ,   d i s c o u n t   r a t e s ,   w o r k i n g   c a p i t a l ,   a n d   c a p i t a l   e x p e n d i t u r e s .  
                                         < / d i v >  
                                     < / d i v >  
                                 < / d i v >  
                             < / >  
                         ) ;  
                     } ) ( ) }  
                 < / d i v >  
             ) }  
  
             { / *   C a s h   F l o w   V i e w   * / }  
             { c u r r e n t V i e w   = = =   ' c a s h - f l o w '   & &   s e l e c t e d C o m p a n y I d   & &   m o n t h l y . l e n g t h   >   0   & &   (  
                 < d i v   s t y l e = { {   m a x W i d t h :   ' 1 4 0 0 p x ' ,   m a r g i n :   ' 0   a u t o ' ,   p a d d i n g :   ' 3 2 p x '   } } >  
                     < s t y l e > { `  
                         @ m e d i a   p r i n t   {  
                             @ p a g e   {  
                                 s i z e :   p o r t r a i t ;  
                                 m a r g i n :   0 . 3 i n ;  
                             }  
                              
                             / *   H i d e   n a v i g a t i o n   a n d   U I   e l e m e n t s   * /  
                             . n o - p r i n t ,  
                             h e a d e r ,  
                             n a v ,  
                             a s i d e ,  
                             [ r o l e = " n a v i g a t i o n " ] ,  
                             b u t t o n   {  
                                 d i s p l a y :   n o n e   ! i m p o r t a n t ;  
                             }  
                              
                             / *   R e m o v e   b a c k g r o u n d   c o l o r s   a n d   s h a d o w s   * /  
                             *   {  
                                 b o x - s h a d o w :   n o n e   ! i m p o r t a n t ;  
                             }  
                              
                             / *   F i r s t   p a g e :   S u m m a r y   c a r d s   a n d   s t a r t   o f   t a b l e   * /  
                             . c f - s u m m a r y - c a r d s   {  
                                 p a g e - b r e a k - a f t e r :   a v o i d ;  
                             }  
                              
                             / *   F o r c e   p a g e   b r e a k   b e f o r e   m e t r i c s   s e c t i o n   * /  
                             . c f - m e t r i c s - s e c t i o n   {  
                                 p a g e - b r e a k - b e f o r e :   a l w a y s ;  
                                 m a r g i n - t o p :   0   ! i m p o r t a n t ;  
                             }  
                              
                             / *   S c a l e   d o w n   c o n t e n t   t o   f i t   p o r t r a i t   * /  
                             . c f - t a b l e - c o n t a i n e r   {  
                                 t r a n s f o r m :   s c a l e ( 0 . 7 5 ) ;  
                                 t r a n s f o r m - o r i g i n :   t o p   l e f t ;  
                                 w i d t h :   1 3 3 . 3 3 % ;  
                             }  
                              
                             / *   R e d u c e   f o n t   s i z e s   f o r   c o m p a c t   d i s p l a y   * /  
                             h 1   {  
                                 f o n t - s i z e :   2 0 p x   ! i m p o r t a n t ;  
                                 m a r g i n - b o t t o m :   1 2 p x   ! i m p o r t a n t ;  
                             }  
                              
                             h 2   {  
                                 f o n t - s i z e :   1 6 p x   ! i m p o r t a n t ;  
                                 m a r g i n - b o t t o m :   1 2 p x   ! i m p o r t a n t ;  
                             }  
                              
                             / *   C o m p r e s s   s u m m a r y   c a r d s   * /  
                             . c f - s u m m a r y - c a r d s   >   d i v   {  
                                 p a d d i n g :   1 2 p x   ! i m p o r t a n t ;  
                             }  
                              
                             . c f - s u m m a r y - c a r d s   >   d i v   >   d i v : f i r s t - c h i l d   {  
                                 f o n t - s i z e :   1 0 p x   ! i m p o r t a n t ;  
                             }  
                              
                             . c f - s u m m a r y - c a r d s   >   d i v   >   d i v : n t h - c h i l d ( 2 )   {  
                                 f o n t - s i z e :   2 0 p x   ! i m p o r t a n t ;  
                             }  
                              
                             . c f - s u m m a r y - c a r d s   >   d i v   >   d i v : l a s t - c h i l d   {  
                                 f o n t - s i z e :   9 p x   ! i m p o r t a n t ;  
                             }  
                              
                             / *   T a b l e   s t y l i n g   * /  
                             t a b l e   {  
                                 f o n t - s i z e :   9 p x   ! i m p o r t a n t ;  
                             }  
                              
                             t h ,   t d   {  
                                 p a d d i n g :   4 p x   6 p x   ! i m p o r t a n t ;  
                             }  
                         }  
                     ` } < / s t y l e >  
                      
                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                         < h 1   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n :   0   } } > C a s h   F l o w   A n a l y s i s < / h 1 >  
                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 1 6 p x '   } } >  
                             { c o m p a n y N a m e   & &   < d i v   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > { c o m p a n y N a m e } < / d i v > }  
                             { c a s h F l o w D i s p l a y   ! = =   ' m o n t h l y '   & &   (  
                                 < b u t t o n    
                                     c l a s s N a m e = " n o - p r i n t "  
                                     o n C l i c k = { ( )   = >   w i n d o w . p r i n t ( ) }    
                                     s t y l e = { {    
                                         p a d d i n g :   ' 1 2 p x   2 4 p x ' ,    
                                         b a c k g r o u n d :   ' # 6 6 7 e e a ' ,    
                                         c o l o r :   ' w h i t e ' ,    
                                         b o r d e r :   ' n o n e ' ,    
                                         b o r d e r R a d i u s :   ' 8 p x ' ,    
                                         f o n t S i z e :   ' 1 4 p x ' ,    
                                         f o n t W e i g h t :   ' 6 0 0 ' ,    
                                         c u r s o r :   ' p o i n t e r ' ,  
                                         b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 1 0 2 ,   1 2 6 ,   2 3 4 ,   0 . 3 ) '  
                                     } } >  
                                      x       P r i n t  
                                 < / b u t t o n >  
                             ) }  
                         < / d i v >  
                     < / d i v >  
                      
                     { / *   D i s p l a y   P e r i o d   T a b s   * / }  
                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 8 p x ' ,   m a r g i n B o t t o m :   ' 3 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                         < b u t t o n  
                             o n C l i c k = { ( )   = >   s e t C a s h F l o w D i s p l a y ( ' m o n t h l y ' ) }  
                             s t y l e = { {  
                                 p a d d i n g :   ' 1 2 p x   2 4 p x ' ,  
                                 b a c k g r o u n d :   c a s h F l o w D i s p l a y   = = =   ' m o n t h l y '   ?   ' # 6 6 7 e e a '   :   ' t r a n s p a r e n t ' ,  
                                 c o l o r :   c a s h F l o w D i s p l a y   = = =   ' m o n t h l y '   ?   ' w h i t e '   :   ' # 6 4 7 4 8 b ' ,  
                                 b o r d e r :   ' n o n e ' ,  
                                 b o r d e r B o t t o m :   c a s h F l o w D i s p l a y   = = =   ' m o n t h l y '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t ' ,  
                                 f o n t S i z e :   ' 1 6 p x ' ,  
                                 f o n t W e i g h t :   ' 6 0 0 ' ,  
                                 c u r s o r :   ' p o i n t e r ' ,  
                                 b o r d e r R a d i u s :   ' 8 p x   8 p x   0   0 ' ,  
                                 t r a n s i t i o n :   ' a l l   0 . 2 s '  
                             } }  
                         >  
                             L a s t   3 6   M o n t h s  
                         < / b u t t o n >  
                         < b u t t o n  
                             o n C l i c k = { ( )   = >   s e t C a s h F l o w D i s p l a y ( ' q u a r t e r l y ' ) }  
                             s t y l e = { {  
                                 p a d d i n g :   ' 1 2 p x   2 4 p x ' ,  
                                 b a c k g r o u n d :   c a s h F l o w D i s p l a y   = = =   ' q u a r t e r l y '   ?   ' # 6 6 7 e e a '   :   ' t r a n s p a r e n t ' ,  
                                 c o l o r :   c a s h F l o w D i s p l a y   = = =   ' q u a r t e r l y '   ?   ' w h i t e '   :   ' # 6 4 7 4 8 b ' ,  
                                 b o r d e r :   ' n o n e ' ,  
                                 b o r d e r B o t t o m :   c a s h F l o w D i s p l a y   = = =   ' q u a r t e r l y '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t ' ,  
                                 f o n t S i z e :   ' 1 6 p x ' ,  
                                 f o n t W e i g h t :   ' 6 0 0 ' ,  
                                 c u r s o r :   ' p o i n t e r ' ,  
                                 b o r d e r R a d i u s :   ' 8 p x   8 p x   0   0 ' ,  
                                 t r a n s i t i o n :   ' a l l   0 . 2 s '  
                             } }  
                         >  
                             L a s t   4   Q u a r t e r s  
                         < / b u t t o n >  
                         < b u t t o n  
                             o n C l i c k = { ( )   = >   s e t C a s h F l o w D i s p l a y ( ' a n n u a l ' ) }  
                             s t y l e = { {  
                                 p a d d i n g :   ' 1 2 p x   2 4 p x ' ,  
                                 b a c k g r o u n d :   c a s h F l o w D i s p l a y   = = =   ' a n n u a l '   ?   ' # 6 6 7 e e a '   :   ' t r a n s p a r e n t ' ,  
                                 c o l o r :   c a s h F l o w D i s p l a y   = = =   ' a n n u a l '   ?   ' w h i t e '   :   ' # 6 4 7 4 8 b ' ,  
                                 b o r d e r :   ' n o n e ' ,  
                                 b o r d e r B o t t o m :   c a s h F l o w D i s p l a y   = = =   ' a n n u a l '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t ' ,  
                                 f o n t S i z e :   ' 1 6 p x ' ,  
                                 f o n t W e i g h t :   ' 6 0 0 ' ,  
                                 c u r s o r :   ' p o i n t e r ' ,  
                                 b o r d e r R a d i u s :   ' 8 p x   8 p x   0   0 ' ,  
                                 t r a n s i t i o n :   ' a l l   0 . 2 s '  
                             } }  
                         >  
                             L a s t   3   Y e a r s  
                         < / b u t t o n >  
                     < / d i v >  
  
                     { ( ( )   = >   {  
                         / /   C a l c u l a t e   c a s h   f l o w   d a t a   b a s e d   o n   v i e w  
                         c o n s t   d a t a M o n t h s   =   c a s h F l o w D i s p l a y   = = =   ' q u a r t e r l y '   ?   1 2   :   M a t h . m i n ( 3 6 ,   m o n t h l y . l e n g t h ) ;  
                         c o n s t   d a t a S e t   =   m o n t h l y . s l i c e ( - d a t a M o n t h s ) ;  
                          
                         c o n s t   c a s h F l o w D a t a   =   d a t a S e t . m a p ( ( c u r r ,   i d x )   = >   {  
                             c o n s t   p r e v   =   i d x   = = =   0   & &   m o n t h l y . l e n g t h   >   d a t a M o n t h s   ?   m o n t h l y [ m o n t h l y . l e n g t h   -   d a t a M o n t h s   -   1 ]   :   ( i d x   >   0   ?   d a t a S e t [ i d x   -   1 ]   :   c u r r ) ;  
                              
                             / /   O p e r a t i n g   A c t i v i t i e s  
                             c o n s t   n e t I n c o m e   =   c u r r . r e v e n u e   -   c u r r . e x p e n s e ;  
                             c o n s t   d e p r e c i a t i o n   =   c u r r . d e p r e c i a t i o n E x p e n s e   | |   0 ;   / /   D e p r e c i a t i o n   a n d   a m o r t i z a t i o n   e x p e n s e  
                             c o n s t   c h a n g e I n A R   =   c u r r . a r   -   p r e v . a r ;  
                             c o n s t   c h a n g e I n I n v e n t o r y   =   c u r r . i n v e n t o r y   -   p r e v . i n v e n t o r y ;  
                             c o n s t   c h a n g e I n A P   =   c u r r . a p   -   p r e v . a p ;  
                             c o n s t   c h a n g e I n W o r k i n g C a p i t a l   =   - ( c h a n g e I n A R   +   c h a n g e I n I n v e n t o r y   -   c h a n g e I n A P ) ;  
                             c o n s t   o p e r a t i n g C a s h F l o w   =   n e t I n c o m e   +   d e p r e c i a t i o n   +   c h a n g e I n W o r k i n g C a p i t a l ;  
                              
                             / /   I n v e s t i n g   A c t i v i t i e s  
                             c o n s t   c h a n g e I n F i x e d A s s e t s   =   c u r r . f i x e d A s s e t s   -   p r e v . f i x e d A s s e t s ;  
                             c o n s t   c a p i t a l E x p e n d i t u r e s   =   c h a n g e I n F i x e d A s s e t s   +   d e p r e c i a t i o n ;   / /   A d d   b a c k   d e p r e c i a t i o n   t o   e s t i m a t e   C a p E x  
                             c o n s t   i n v e s t i n g C a s h F l o w   =   - c a p i t a l E x p e n d i t u r e s ;  
                              
                             / /   F i n a n c i n g   A c t i v i t i e s  
                             c o n s t   c h a n g e I n D e b t   =   c u r r . l t d   -   p r e v . l t d ;  
                             c o n s t   c h a n g e I n E q u i t y   =   c u r r . t o t a l E q u i t y   -   p r e v . t o t a l E q u i t y   -   n e t I n c o m e ;   / /   E q u i t y   c h a n g e   e x c l u d i n g   n e t   i n c o m e  
                             c o n s t   f i n a n c i n g C a s h F l o w   =   c h a n g e I n D e b t   +   c h a n g e I n E q u i t y ;  
                              
                             / /   N e t   C h a n g e   a n d   F r e e   C a s h   F l o w  
                             c o n s t   n e t C a s h C h a n g e   =   o p e r a t i n g C a s h F l o w   +   i n v e s t i n g C a s h F l o w   +   f i n a n c i n g C a s h F l o w ;  
                             c o n s t   f r e e C a s h F l o w   =   o p e r a t i n g C a s h F l o w   -   M a t h . m a x ( 0 ,   c a p i t a l E x p e n d i t u r e s ) ;  
                              
                             / /   M e t r i c s  
                             c o n s t   c a s h F l o w M a r g i n   =   c u r r . r e v e n u e   >   0   ?   ( o p e r a t i n g C a s h F l o w   /   c u r r . r e v e n u e )   *   1 0 0   :   0 ;  
                             c o n s t   d a y s C a s h O n H a n d   =   o p e r a t i n g C a s h F l o w   >   0   ?   ( c u r r . c a s h   /   ( o p e r a t i n g C a s h F l o w   /   3 0 ) )   :   0 ;  
                              
                             r e t u r n   {  
                                 m o n t h :   c u r r . m o n t h ,  
                                 n e t I n c o m e ,  
                                 d e p r e c i a t i o n ,  
                                 c h a n g e I n W o r k i n g C a p i t a l ,  
                                 o p e r a t i n g C a s h F l o w ,  
                                 c a p i t a l E x p e n d i t u r e s ,  
                                 i n v e s t i n g C a s h F l o w ,  
                                 c h a n g e I n D e b t ,  
                                 c h a n g e I n E q u i t y ,  
                                 f i n a n c i n g C a s h F l o w ,  
                                 n e t C a s h C h a n g e ,  
                                 f r e e C a s h F l o w ,  
                                 c a s h F l o w M a r g i n ,  
                                 d a y s C a s h O n H a n d ,  
                                 e n d i n g C a s h :   c u r r . c a s h  
                             } ;  
                         } ) ;  
  
                         / /   A g g r e g a t e   d a t a   b a s e d   o n   d i s p l a y   s e l e c t i o n  
                         l e t   d i s p l a y D a t a   =   c a s h F l o w D a t a ;  
                         i f   ( c a s h F l o w D i s p l a y   = = =   ' q u a r t e r l y ' )   {  
                             / /   A g g r e g a t e   i n t o   q u a r t e r s   ( 3   m o n t h s   e a c h )  
                             d i s p l a y D a t a   =   [ ] ;  
                             f o r   ( l e t   i   =   0 ;   i   <   c a s h F l o w D a t a . l e n g t h ;   i   + =   3 )   {  
                                 c o n s t   q u a r t e r   =   c a s h F l o w D a t a . s l i c e ( i ,   i   +   3 ) ;  
                                 c o n s t   q u a r t e r E n d   =   q u a r t e r [ q u a r t e r . l e n g t h   -   1 ] . m o n t h ;  
                                 c o n s t   a g g r e g a t e d   =   {  
                                     m o n t h :   q u a r t e r E n d ,  
                                     n e t I n c o m e :   q u a r t e r . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . n e t I n c o m e ,   0 ) ,  
                                     d e p r e c i a t i o n :   q u a r t e r . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . d e p r e c i a t i o n ,   0 ) ,  
                                     c h a n g e I n W o r k i n g C a p i t a l :   q u a r t e r . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . c h a n g e I n W o r k i n g C a p i t a l ,   0 ) ,  
                                     o p e r a t i n g C a s h F l o w :   q u a r t e r . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . o p e r a t i n g C a s h F l o w ,   0 ) ,  
                                     c a p i t a l E x p e n d i t u r e s :   q u a r t e r . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . c a p i t a l E x p e n d i t u r e s ,   0 ) ,  
                                     i n v e s t i n g C a s h F l o w :   q u a r t e r . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . i n v e s t i n g C a s h F l o w ,   0 ) ,  
                                     c h a n g e I n D e b t :   q u a r t e r . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . c h a n g e I n D e b t ,   0 ) ,  
                                     c h a n g e I n E q u i t y :   q u a r t e r . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . c h a n g e I n E q u i t y ,   0 ) ,  
                                     f i n a n c i n g C a s h F l o w :   q u a r t e r . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . f i n a n c i n g C a s h F l o w ,   0 ) ,  
                                     n e t C a s h C h a n g e :   q u a r t e r . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . n e t C a s h C h a n g e ,   0 ) ,  
                                     f r e e C a s h F l o w :   q u a r t e r . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . f r e e C a s h F l o w ,   0 ) ,  
                                     c a s h F l o w M a r g i n :   q u a r t e r . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . c a s h F l o w M a r g i n ,   0 )   /   q u a r t e r . l e n g t h ,  
                                     d a y s C a s h O n H a n d :   q u a r t e r [ q u a r t e r . l e n g t h   -   1 ] . d a y s C a s h O n H a n d ,  
                                     e n d i n g C a s h :   q u a r t e r [ q u a r t e r . l e n g t h   -   1 ] . e n d i n g C a s h  
                                 } ;  
                                 d i s p l a y D a t a . p u s h ( a g g r e g a t e d ) ;  
                             }  
                         }   e l s e   i f   ( c a s h F l o w D i s p l a y   = = =   ' a n n u a l ' )   {  
                             / /   A g g r e g a t e   i n t o   3   a n n u a l   p e r i o d s   ( 1 2   m o n t h s   e a c h )  
                             d i s p l a y D a t a   =   [ ] ;  
                             c o n s t   t o t a l M o n t h s   =   c a s h F l o w D a t a . l e n g t h ;  
                             c o n s t   y e a r s T o S h o w   =   M a t h . m i n ( 3 ,   M a t h . f l o o r ( t o t a l M o n t h s   /   1 2 ) ) ;  
                              
                             f o r   ( l e t   i   =   0 ;   i   <   y e a r s T o S h o w ;   i + + )   {  
                                 c o n s t   y e a r S t a r t   =   t o t a l M o n t h s   -   ( y e a r s T o S h o w   -   i )   *   1 2 ;  
                                 c o n s t   y e a r E n d   =   y e a r S t a r t   +   1 2 ;  
                                 c o n s t   y e a r D a t a   =   c a s h F l o w D a t a . s l i c e ( y e a r S t a r t ,   y e a r E n d ) ;  
                                  
                                 i f   ( y e a r D a t a . l e n g t h   >   0 )   {  
                                     c o n s t   y e a r E n d D a t e   =   y e a r D a t a [ y e a r D a t a . l e n g t h   -   1 ] . m o n t h ;  
                                     d i s p l a y D a t a . p u s h ( {  
                                         m o n t h :   y e a r E n d D a t e ,  
                                         n e t I n c o m e :   y e a r D a t a . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . n e t I n c o m e ,   0 ) ,  
                                         d e p r e c i a t i o n :   y e a r D a t a . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . d e p r e c i a t i o n ,   0 ) ,  
                                         c h a n g e I n W o r k i n g C a p i t a l :   y e a r D a t a . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . c h a n g e I n W o r k i n g C a p i t a l ,   0 ) ,  
                                         o p e r a t i n g C a s h F l o w :   y e a r D a t a . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . o p e r a t i n g C a s h F l o w ,   0 ) ,  
                                         c a p i t a l E x p e n d i t u r e s :   y e a r D a t a . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . c a p i t a l E x p e n d i t u r e s ,   0 ) ,  
                                         i n v e s t i n g C a s h F l o w :   y e a r D a t a . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . i n v e s t i n g C a s h F l o w ,   0 ) ,  
                                         c h a n g e I n D e b t :   y e a r D a t a . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . c h a n g e I n D e b t ,   0 ) ,  
                                         c h a n g e I n E q u i t y :   y e a r D a t a . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . c h a n g e I n E q u i t y ,   0 ) ,  
                                         f i n a n c i n g C a s h F l o w :   y e a r D a t a . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . f i n a n c i n g C a s h F l o w ,   0 ) ,  
                                         n e t C a s h C h a n g e :   y e a r D a t a . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . n e t C a s h C h a n g e ,   0 ) ,  
                                         f r e e C a s h F l o w :   y e a r D a t a . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . f r e e C a s h F l o w ,   0 ) ,  
                                         c a s h F l o w M a r g i n :   y e a r D a t a . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . c a s h F l o w M a r g i n ,   0 )   /   y e a r D a t a . l e n g t h ,  
                                         d a y s C a s h O n H a n d :   y e a r D a t a [ y e a r D a t a . l e n g t h   -   1 ] . d a y s C a s h O n H a n d ,  
                                         e n d i n g C a s h :   y e a r D a t a [ y e a r D a t a . l e n g t h   -   1 ] . e n d i n g C a s h  
                                     } ) ;  
                                 }  
                             }  
                         }  
  
                         / /   S u m m a r y   m e t r i c s   -   a l w a y s   u s e   l a s t   1 2   m o n t h s   f o r   c o n s i s t e n c y  
                         c o n s t   l a s t 1 2 M o n t h s D a t a   =   m o n t h l y . s l i c e ( - 1 2 ) . m a p ( ( c u r r ,   i d x )   = >   {  
                             c o n s t   p r e v   =   i d x   = = =   0   & &   m o n t h l y . l e n g t h   >   1 2   ?   m o n t h l y [ m o n t h l y . l e n g t h   -   1 3 ]   :   ( i d x   >   0   ?   m o n t h l y . s l i c e ( - 1 2 ) [ i d x   -   1 ]   :   c u r r ) ;  
                             c o n s t   n e t I n c o m e   =   c u r r . r e v e n u e   -   c u r r . e x p e n s e ;  
                             c o n s t   d e p r e c i a t i o n   =   c u r r . d e p r e c i a t i o n E x p e n s e   | |   0 ;  
                             c o n s t   c h a n g e I n A R   =   c u r r . a r   -   p r e v . a r ;  
                             c o n s t   c h a n g e I n I n v e n t o r y   =   c u r r . i n v e n t o r y   -   p r e v . i n v e n t o r y ;  
                             c o n s t   c h a n g e I n A P   =   c u r r . a p   -   p r e v . a p ;  
                             c o n s t   c h a n g e I n W o r k i n g C a p i t a l   =   - ( c h a n g e I n A R   +   c h a n g e I n I n v e n t o r y   -   c h a n g e I n A P ) ;  
                             c o n s t   o p e r a t i n g C a s h F l o w   =   n e t I n c o m e   +   d e p r e c i a t i o n   +   c h a n g e I n W o r k i n g C a p i t a l ;  
                             c o n s t   c h a n g e I n F i x e d A s s e t s   =   c u r r . f i x e d A s s e t s   -   p r e v . f i x e d A s s e t s ;  
                             c o n s t   c a p i t a l E x p e n d i t u r e s   =   c h a n g e I n F i x e d A s s e t s   +   d e p r e c i a t i o n ;  
                             c o n s t   i n v e s t i n g C a s h F l o w   =   - c a p i t a l E x p e n d i t u r e s ;  
                             c o n s t   c h a n g e I n D e b t   =   c u r r . l t d   -   p r e v . l t d ;  
                             c o n s t   c h a n g e I n E q u i t y   =   c u r r . t o t a l E q u i t y   -   p r e v . t o t a l E q u i t y   -   n e t I n c o m e ;  
                             c o n s t   f i n a n c i n g C a s h F l o w   =   c h a n g e I n D e b t   +   c h a n g e I n E q u i t y ;  
                             c o n s t   f r e e C a s h F l o w   =   o p e r a t i n g C a s h F l o w   -   M a t h . m a x ( 0 ,   c a p i t a l E x p e n d i t u r e s ) ;  
                             c o n s t   c a s h F l o w M a r g i n   =   c u r r . r e v e n u e   >   0   ?   ( o p e r a t i n g C a s h F l o w   /   c u r r . r e v e n u e )   *   1 0 0   :   0 ;  
                             r e t u r n   {   o p e r a t i n g C a s h F l o w ,   i n v e s t i n g C a s h F l o w ,   f i n a n c i n g C a s h F l o w ,   f r e e C a s h F l o w ,   c a s h F l o w M a r g i n   } ;  
                         } ) ;  
                         c o n s t   t o t a l O p e r a t i n g C F   =   l a s t 1 2 M o n t h s D a t a . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . o p e r a t i n g C a s h F l o w ,   0 ) ;  
                         c o n s t   t o t a l I n v e s t i n g C F   =   l a s t 1 2 M o n t h s D a t a . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . i n v e s t i n g C a s h F l o w ,   0 ) ;  
                         c o n s t   t o t a l F i n a n c i n g C F   =   l a s t 1 2 M o n t h s D a t a . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . f i n a n c i n g C a s h F l o w ,   0 ) ;  
                         c o n s t   t o t a l F r e e C F   =   l a s t 1 2 M o n t h s D a t a . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . f r e e C a s h F l o w ,   0 ) ;  
                         c o n s t   a v g C a s h F l o w M a r g i n   =   l a s t 1 2 M o n t h s D a t a . r e d u c e ( ( s u m ,   d )   = >   s u m   +   d . c a s h F l o w M a r g i n ,   0 )   /   l a s t 1 2 M o n t h s D a t a . l e n g t h ;  
  
                         r e t u r n   (  
                             < >  
                                 { / *   S u m m a r y   C a r d s   * / }  
                                 < d i v   c l a s s N a m e = " c f - s u m m a r y - c a r d s "   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( 3 ,   1 f r ) ' ,   g a p :   ' 1 6 p x ' ,   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   b o r d e r :   ' 2 p x   s o l i d   # 1 0 b 9 8 1 '   } } >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > O p e r a t i n g   C a s h   F l o w   ( 1 2 m o ) < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 2 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 0 b 9 8 1 '   } } >  
                                             $ { ( t o t a l O p e r a t i n g C F   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n T o p :   ' 4 p x '   } } > C a s h   f r o m   o p e r a t i o n s < / d i v >  
                                     < / d i v >  
                                      
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   b o r d e r :   ' 2 p x   s o l i d   # e f 4 4 4 4 '   } } >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > I n v e s t i n g   C a s h   F l o w   ( 1 2 m o ) < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 2 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # e f 4 4 4 4 '   } } >  
                                             $ { ( t o t a l I n v e s t i n g C F   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n T o p :   ' 4 p x '   } } > C a p E x   &   i n v e s t m e n t s < / d i v >  
                                     < / d i v >  
                                      
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   b o r d e r :   ' 2 p x   s o l i d   # 3 b 8 2 f 6 '   } } >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > F i n a n c i n g   C a s h   F l o w   ( 1 2 m o ) < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 2 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 3 b 8 2 f 6 '   } } >  
                                             $ { ( t o t a l F i n a n c i n g C F   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n T o p :   ' 4 p x '   } } > D e b t   &   e q u i t y   c h a n g e s < / d i v >  
                                     < / d i v >  
                                      
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   b o r d e r :   ' 2 p x   s o l i d   # 6 6 7 e e a '   } } >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > F r e e   C a s h   F l o w   ( 1 2 m o ) < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 2 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   t o t a l F r e e C F   > =   0   ?   ' # 1 0 b 9 8 1 '   :   ' # e f 4 4 4 4 '   } } >  
                                             $ { ( t o t a l F r e e C F   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n T o p :   ' 4 p x '   } } > O C F   -   C a p E x < / d i v >  
                                     < / d i v >  
                                      
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   b o r d e r :   ' 2 p x   s o l i d   # f 5 9 e 0 b '   } } >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > A v g   C a s h   F l o w   M a r g i n < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 2 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # f 5 9 e 0 b '   } } >  
                                             { a v g C a s h F l o w M a r g i n . t o F i x e d ( 1 ) } %  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n T o p :   ' 4 p x '   } } > O C F   /   R e v e n u e < / d i v >  
                                     < / d i v >  
                                 < / d i v >  
  
                                 { / *   C a s h   F l o w   S t a t e m e n t   T a b l e   * / }  
                                 < d i v   c l a s s N a m e = " c f - t a b l e - c o n t a i n e r "   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                     < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > S t a t e m e n t   o f   C a s h   F l o w s < / h 2 >  
                                      
                                     < d i v   s t y l e = { {   o v e r f l o w X :   ' a u t o '   } } >  
                                         < t a b l e   s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   f o n t S i z e :   ' 1 2 p x ' ,   b o r d e r C o l l a p s e :   ' c o l l a p s e '   } } >  
                                             < t h e a d >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                     < t h   s t y l e = { {   t e x t A l i g n :   ' l e f t ' ,   p a d d i n g :   ' 1 0 p x ' ,   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   m i n W i d t h :   ' 2 0 0 p x '   } } > C a s h   F l o w   I t e m < / t h >  
                                                     { d i s p l a y D a t a . m a p ( ( c f ,   i )   = >   (  
                                                         < t h   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   p a d d i n g :   ' 1 0 p x ' ,   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m i n W i d t h :   ' 9 0 p x '   } } >  
                                                             { c f . m o n t h }  
                                                         < / t h >  
                                                     ) ) }  
                                                 < / t r >  
                                             < / t h e a d >  
                                             < t b o d y >  
                                                 { / *   O p e r a t i n g   A c t i v i t i e s   * / }  
                                                 < t r   s t y l e = { {   b a c k g r o u n d :   ' # f 0 f d f 4 '   } } >  
                                                     < t d   c o l S p a n = { 1 3 }   s t y l e = { {   p a d d i n g :   ' 1 2 p x   1 0 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 0 6 5 f 4 6 '   } } >  
                                                         O P E R A T I N G   A C T I V I T I E S  
                                                     < / t d >  
                                                 < / t r >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 4 p x '   } } > N e t   I n c o m e < / t d >  
                                                     { d i s p l a y D a t a . m a p ( ( c f ,   i )   = >   (  
                                                         < t d   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             $ { c f . n e t I n c o m e . t o L o c a l e S t r i n g ( ) }  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 4 p x '   } } > +   D e p r e c i a t i o n < / t d >  
                                                     { d i s p l a y D a t a . m a p ( ( c f ,   i )   = >   (  
                                                         < t d   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             $ { c f . d e p r e c i a t i o n . t o L o c a l e S t r i n g ( ) }  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 4 p x '   } } > +   C h a n g e   i n   W o r k i n g   C a p i t a l < / t d >  
                                                     { d i s p l a y D a t a . m a p ( ( c f ,   i )   = >   (  
                                                         < t d   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   c f . c h a n g e I n W o r k i n g C a p i t a l   > =   0   ?   ' # 1 0 b 9 8 1 '   :   ' # e f 4 4 4 4 ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             $ { c f . c h a n g e I n W o r k i n g C a p i t a l . t o L o c a l e S t r i n g ( ) }  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # 1 0 b 9 8 1 ' ,   b a c k g r o u n d :   ' # f 0 f d f 4 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 0 p x ' ,   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 0 6 5 f 4 6 '   } } > O p e r a t i n g   C a s h   F l o w < / t d >  
                                                     { d i s p l a y D a t a . m a p ( ( c f ,   i )   = >   (  
                                                         < t d   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 1 0 p x ' ,   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 0 6 5 f 4 6 ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             $ { c f . o p e r a t i n g C a s h F l o w . t o L o c a l e S t r i n g ( ) }  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                                  
                                                 { / *   I n v e s t i n g   A c t i v i t i e s   * / }  
                                                 < t r   s t y l e = { {   b a c k g r o u n d :   ' # f e f 2 f 2 '   } } >  
                                                     < t d   c o l S p a n = { 1 3 }   s t y l e = { {   p a d d i n g :   ' 1 2 p x   1 0 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 9 9 1 b 1 b '   } } >  
                                                         I N V E S T I N G   A C T I V I T I E S  
                                                     < / t d >  
                                                 < / t r >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 4 p x '   } } > C a p i t a l   E x p e n d i t u r e s < / t d >  
                                                     { d i s p l a y D a t a . m a p ( ( c f ,   i )   = >   (  
                                                         < t d   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # e f 4 4 4 4 ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             ( $ { c f . c a p i t a l E x p e n d i t u r e s . t o L o c a l e S t r i n g ( ) } )  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e f 4 4 4 4 ' ,   b a c k g r o u n d :   ' # f e f 2 f 2 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 0 p x ' ,   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 9 9 1 b 1 b '   } } > I n v e s t i n g   C a s h   F l o w < / t d >  
                                                     { d i s p l a y D a t a . m a p ( ( c f ,   i )   = >   (  
                                                         < t d   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 1 0 p x ' ,   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 9 9 1 b 1 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             $ { c f . i n v e s t i n g C a s h F l o w . t o L o c a l e S t r i n g ( ) }  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                                  
                                                 { / *   F i n a n c i n g   A c t i v i t i e s   * / }  
                                                 < t r   s t y l e = { {   b a c k g r o u n d :   ' # e f f 6 f f '   } } >  
                                                     < t d   c o l S p a n = { 1 3 }   s t y l e = { {   p a d d i n g :   ' 1 2 p x   1 0 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } >  
                                                         F I N A N C I N G   A C T I V I T I E S  
                                                     < / t d >  
                                                 < / t r >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 4 p x '   } } > C h a n g e   i n   L o n g - T e r m   D e b t < / t d >  
                                                     { d i s p l a y D a t a . m a p ( ( c f ,   i )   = >   (  
                                                         < t d   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   c f . c h a n g e I n D e b t   > =   0   ?   ' # 1 0 b 9 8 1 '   :   ' # e f 4 4 4 4 ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             $ { c f . c h a n g e I n D e b t . t o L o c a l e S t r i n g ( ) }  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 4 p x '   } } > C h a n g e   i n   E q u i t y < / t d >  
                                                     { d i s p l a y D a t a . m a p ( ( c f ,   i )   = >   (  
                                                         < t d   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   c f . c h a n g e I n E q u i t y   > =   0   ?   ' # 1 0 b 9 8 1 '   :   ' # e f 4 4 4 4 ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             $ { c f . c h a n g e I n E q u i t y . t o L o c a l e S t r i n g ( ) }  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # 3 b 8 2 f 6 ' ,   b a c k g r o u n d :   ' # e f f 6 f f '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 0 p x ' ,   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } > F i n a n c i n g   C a s h   F l o w < / t d >  
                                                     { d i s p l a y D a t a . m a p ( ( c f ,   i )   = >   (  
                                                         < t d   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 1 0 p x ' ,   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             $ { c f . f i n a n c i n g C a s h F l o w . t o L o c a l e S t r i n g ( ) }  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                                  
                                                 { / *   N e t   C h a n g e   * / }  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 3 p x   d o u b l e   # 1 e 2 9 3 b ' ,   b a c k g r o u n d :   ' # f 8 f a f c '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x   1 0 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > N e t   C h a n g e   i n   C a s h < / t d >  
                                                     { d i s p l a y D a t a . m a p ( ( c f ,   i )   = >   (  
                                                         < t d   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 1 2 p x   1 0 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   c f . n e t C a s h C h a n g e   > =   0   ?   ' # 1 0 b 9 8 1 '   :   ' # e f 4 4 4 4 ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             $ { c f . n e t C a s h C h a n g e . t o L o c a l e S t r i n g ( ) }  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                                 < t r   s t y l e = { {   b a c k g r o u n d :   ' # f e f 3 c 7 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 0 p x ' ,   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 9 2 4 0 0 e '   } } > F r e e   C a s h   F l o w < / t d >  
                                                     { d i s p l a y D a t a . m a p ( ( c f ,   i )   = >   (  
                                                         < t d   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 1 0 p x ' ,   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   c f . f r e e C a s h F l o w   > =   0   ?   ' # 0 6 5 f 4 6 '   :   ' # 9 9 1 b 1 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             $ { c f . f r e e C a s h F l o w . t o L o c a l e S t r i n g ( ) }  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 0 p x ' ,   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > E n d i n g   C a s h   B a l a n c e < / t d >  
                                                     { d i s p l a y D a t a . m a p ( ( c f ,   i )   = >   (  
                                                         < t d   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 1 0 p x ' ,   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             $ { c f . e n d i n g C a s h . t o L o c a l e S t r i n g ( ) }  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                             < / t b o d y >  
                                         < / t a b l e >  
                                     < / d i v >  
                                 < / d i v >  
  
                                 { / *   C a s h   F l o w   M e t r i c s   * / }  
                                 < d i v   c l a s s N a m e = " c f - m e t r i c s - s e c t i o n "   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                     < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > C a s h   F l o w   M e t r i c s < / h 2 >  
                                      
                                     < d i v   s t y l e = { {   o v e r f l o w X :   ' a u t o '   } } >  
                                         < t a b l e   s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   f o n t S i z e :   ' 1 2 p x ' ,   b o r d e r C o l l a p s e :   ' c o l l a p s e '   } } >  
                                             < t h e a d >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                     < t h   s t y l e = { {   t e x t A l i g n :   ' l e f t ' ,   p a d d i n g :   ' 1 0 p x ' ,   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   p o s i t i o n :   ' s t i c k y ' ,   l e f t :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   m i n W i d t h :   ' 1 8 0 p x '   } } > M e t r i c < / t h >  
                                                     { d i s p l a y D a t a . m a p ( ( c f ,   i )   = >   (  
                                                         < t h   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   p a d d i n g :   ' 1 0 p x ' ,   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m i n W i d t h :   ' 9 0 p x '   } } >  
                                                             { c f . m o n t h }  
                                                         < / t h >  
                                                     ) ) }  
                                                 < / t r >  
                                             < / t h e a d >  
                                             < t b o d y >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C a s h   F l o w   M a r g i n   ( % ) < / t d >  
                                                     { d i s p l a y D a t a . m a p ( ( c f ,   i )   = >   (  
                                                         < t d   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             { c f . c a s h F l o w M a r g i n . t o F i x e d ( 1 ) } %  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > D a y s   C a s h   o n   H a n d < / t d >  
                                                     { d i s p l a y D a t a . m a p ( ( c f ,   i )   = >   (  
                                                         < t d   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             { c f . d a y s C a s h O n H a n d . t o F i x e d ( 0 ) }   d a y s  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C a s h   C o n v e r s i o n   R a t e < / t d >  
                                                     { d i s p l a y D a t a . m a p ( ( c f ,   i )   = >   (  
                                                         < t d   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 8 p x   1 0 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             { c f . n e t I n c o m e   >   0   ?   ( ( c f . o p e r a t i n g C a s h F l o w   /   c f . n e t I n c o m e )   *   1 0 0 ) . t o F i x e d ( 0 )   :   ' N / A ' } %  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                             < / t b o d y >  
                                         < / t a b l e >  
                                     < / d i v >  
                                 < / d i v >  
  
                                 { / *   K e y   I n s i g h t s   * / }  
                                 < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                     < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > C a s h   F l o w   I n s i g h t s < / h 2 >  
                                      
                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g a p :   ' 1 6 p x '   } } >  
                                         { t o t a l O p e r a t i n g C F   >   0   ?   (  
                                             < d i v   s t y l e = { {   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' # f 0 f d f 4 ' ,   b o r d e r :   ' 1 p x   s o l i d   # 8 6 e f a c ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 0 6 5 f 4 6 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  S   P o s i t i v e   O p e r a t i n g   C a s h   F l o w < / d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 0 4 7 8 5 7 '   } } >  
                                                     T h e   c o m p a n y   g e n e r a t e d   $ { ( t o t a l O p e r a t i n g C F   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K   i n   c a s h   f r o m   o p e r a t i o n s   o v e r   t h e   l a s t   1 2   m o n t h s ,   i n d i c a t i n g   h e a l t h y   o p e r a t i o n a l   p e r f o r m a n c e .  
                                                 < / d i v >  
                                             < / d i v >  
                                         )   :   (  
                                             < d i v   s t y l e = { {   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' # f e f 2 f 2 ' ,   b o r d e r :   ' 1 p x   s o l i d   # f c a 5 a 5 ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 9 9 1 b 1 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  a   N e g a t i v e   O p e r a t i n g   C a s h   F l o w < / d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # d c 2 6 2 6 '   } } >  
                                                     T h e   c o m p a n y   c o n s u m e d   $ { M a t h . a b s ( t o t a l O p e r a t i n g C F   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K   i n   c a s h   f r o m   o p e r a t i o n s ,   w h i c h   m a y   i n d i c a t e   o p e r a t i o n a l   c h a l l e n g e s .  
                                                 < / d i v >  
                                             < / d i v >  
                                         ) }  
                                          
                                         { t o t a l F r e e C F   >   0   ?   (  
                                             < d i v   s t y l e = { {   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' # f 0 f d f 4 ' ,   b o r d e r :   ' 1 p x   s o l i d   # 8 6 e f a c ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 0 6 5 f 4 6 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  S   P o s i t i v e   F r e e   C a s h   F l o w < / d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 0 4 7 8 5 7 '   } } >  
                                                     A f t e r   c a p i t a l   e x p e n d i t u r e s ,   t h e   c o m p a n y   h a s   $ { ( t o t a l F r e e C F   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K   i n   f r e e   c a s h   f l o w   a v a i l a b l e   f o r   g r o w t h ,   d e b t   r e d u c t i o n ,   o r   d i s t r i b u t i o n s .  
                                                 < / d i v >  
                                             < / d i v >  
                                         )   :   (  
                                             < d i v   s t y l e = { {   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' # f f f b e b ' ,   b o r d e r :   ' 1 p x   s o l i d   # f c d 3 4 d ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 9 2 4 0 0 e ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  a   N e g a t i v e   F r e e   C a s h   F l o w < / d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # b 4 5 3 0 9 '   } } >  
                                                     C a p i t a l   e x p e n d i t u r e s   e x c e e d   o p e r a t i n g   c a s h   f l o w   b y   $ { M a t h . a b s ( t o t a l F r e e C F   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K ,   r e q u i r i n g   e x t e r n a l   f i n a n c i n g .  
                                                 < / d i v >  
                                             < / d i v >  
                                         ) }  
                                          
                                         { a v g C a s h F l o w M a r g i n   >   1 5   ?   (  
                                             < d i v   s t y l e = { {   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' # f 0 f d f 4 ' ,   b o r d e r :   ' 1 p x   s o l i d   # 8 6 e f a c ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 0 6 5 f 4 6 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  S   S t r o n g   C a s h   F l o w   M a r g i n < / d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 0 4 7 8 5 7 '   } } >  
                                                     A v e r a g e   c a s h   f l o w   m a r g i n   o f   { a v g C a s h F l o w M a r g i n . t o F i x e d ( 1 ) } %   i n d i c a t e s   t h e   c o m p a n y   e f f i c i e n t l y   c o n v e r t s   r e v e n u e   i n t o   c a s h .  
                                                 < / d i v >  
                                             < / d i v >  
                                         )   :   a v g C a s h F l o w M a r g i n   <   5   ?   (  
                                             < d i v   s t y l e = { {   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' # f e f 2 f 2 ' ,   b o r d e r :   ' 1 p x   s o l i d   # f c a 5 a 5 ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 9 9 1 b 1 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  a   L o w   C a s h   F l o w   M a r g i n < / d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # d c 2 6 2 6 '   } } >  
                                                     C a s h   f l o w   m a r g i n   o f   { a v g C a s h F l o w M a r g i n . t o F i x e d ( 1 ) } %   s u g g e s t s   c h a l l e n g e s   i n   c o n v e r t i n g   r e v e n u e   t o   c a s h .   R e v i e w   r e c e i v a b l e s   c o l l e c t i o n   a n d   e x p e n s e   t i m i n g .  
                                                 < / d i v >  
                                             < / d i v >  
                                         )   :   n u l l }  
                                     < / d i v >  
                                 < / d i v >  
                             < / >  
                         ) ;  
                     } ) ( ) }  
                 < / d i v >  
             ) }  
  
             { / *   D a t a   M a p p i n g   V i e w   -   A I - A s s i s t e d   M a p p i n g   I n t e r f a c e   * / }  
             { ( c u r r e n t V i e w   = = =   ' a d m i n '   & &   a d m i n D a s h b o a r d T a b   = = =   ' d a t a - m a p p i n g '   & &   s e l e c t e d C o m p a n y I d   & &   q b R a w D a t a )   & &   ( ( )   = >   {  
                 / /   C R I T I C A L   S E C U R I T Y   C H E C K :   E n s u r e   q b R a w D a t a   m a t c h e s   t h e   s e l e c t e d   c o m p a n y  
                 i f   ( ! q b R a w D a t a . _ c o m p a n y I d   | |   q b R a w D a t a . _ c o m p a n y I d   ! = =   s e l e c t e d C o m p a n y I d )   {  
                     c o n s o l e . e r r o r ( `  xa   S E C U R I T Y   B L O C K :   D a t a   m i s m a t c h !   S e l e c t e d :   $ { s e l e c t e d C o m p a n y I d } ,   D a t a   c o m p a n y I d :   $ { q b R a w D a t a . _ c o m p a n y I d   | |   ' M I S S I N G ' } ` ) ;  
                     r e t u r n   < d i v   s t y l e = { {   p a d d i n g :   ' 4 8 p x ' ,   t e x t A l i g n :   ' c e n t e r '   } } >  
                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   ' # e f 4 4 4 4 ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  a      L o a d i n g   c o m p a n y   d a t a . . . < / d i v >  
                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > P l e a s e   w a i t   w h i l e   w e   f e t c h   t h e   c o r r e c t   f i n a n c i a l   d a t a . < / d i v >  
                     < / d i v > ;  
                 }  
                  
                 c o n s t   c u r r e n t C o m p a n y   =   c o m p a n i e s . f i n d ( c   = >   c . i d   = = =   s e l e c t e d C o m p a n y I d ) ;  
                 c o n s t   c u r r e n t C o m p a n y N a m e   =   c u r r e n t C o m p a n y ? . n a m e   | |   ' U n k n o w n ' ;  
                 c o n s o l e . l o g ( `  x    = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = ` ) ;  
                 c o n s o l e . l o g ( `  x    D A T A   M A P P I N G   R E N D E R I N G   ( R e f r e s h   K e y :   $ { d a t a R e f r e s h K e y } ) ` ) ;  
                 c o n s o l e . l o g ( `  x    S e l e c t e d   C o m p a n y :   " $ { c u r r e n t C o m p a n y N a m e } "   ( I D :   $ { s e l e c t e d C o m p a n y I d } ) ` ) ;  
                 c o n s o l e . l o g ( `  x    Q B   D a t a   s y n c   d a t e : ` ,   q b R a w D a t a . s y n c D a t e ) ;  
                 c o n s o l e . l o g ( `  x    D a t a   b e l o n g s   t o   c o m p a n y : ` ,   q b R a w D a t a . _ c o m p a n y I d ) ;  
                 c o n s o l e . l o g ( `  x    R e c o r d   I D : ` ,   q b R a w D a t a . _ r e c o r d I d ) ;  
                 c o n s o l e . l o g ( `  x    = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = ` ) ;  
                  
                 / /   H e l p e r   f u n c t i o n   t o   r e c u r s i v e l y   e x t r a c t   a l l   r o w s   f r o m   Q B   r e p o r t  
                 / /   E x t r a c t   f r o m   t h e   l a s t   m o n t h   c o l u m n ,   n o t   t h e   t o t a l   c o l u m n  
                 / /   C a l c u l a t e   t o t a l s   b y   s u m m i n g   d e t a i l   r o w s   i n s t e a d   o f   u s i n g   Q B ' s   S u m m a r y   r o w s  
                 c o n s t   e x t r a c t R o w s   =   ( d a t a :   a n y ,   l e v e l :   n u m b e r   =   0 ,   p a r e n t S e c t i o n :   s t r i n g   =   ' ' ) :   a n y [ ]   = >   {  
                     c o n s t   r e s u l t :   a n y [ ]   =   [ ] ;  
                      
                     i f   ( ! d a t a )   r e t u r n   r e s u l t ;  
                      
                     / /   C h e c k   i f   t h i s   i s   a   m u l t i - c o l u m n   r e p o r t   ( m o n t h l y   b r e a k d o w n )  
                     c o n s t   c o l u m n s   =   d a t a . C o l u m n s ? . C o l u m n   | |   [ ] ;  
                     c o n s t   h a s M u l t i p l e M o n t h s   =   c o l u m n s . l e n g t h   >   2 ;   / /   M o r e   t h a n   j u s t   a c c o u n t   n a m e   +   o n e   v a l u e   c o l u m n  
                      
                     c o n s t   r o w s   =   A r r a y . i s A r r a y ( d a t a ? . R o w s )   ?   d a t a . R o w s   :   ( d a t a ? . R o w s ? . R o w   ?   ( A r r a y . i s A r r a y ( d a t a . R o w s . R o w )   ?   d a t a . R o w s . R o w   :   [ d a t a . R o w s . R o w ] )   :   [ ] ) ;  
                      
                     f o r   ( c o n s t   r o w   o f   r o w s )   {  
                         i f   ( r o w . t y p e   = = =   ' S e c t i o n ' )   {  
                             / /   A d d   s e c t i o n   h e a d e r  
                             c o n s t   s e c t i o n N a m e   =   r o w . H e a d e r ? . C o l D a t a ? . [ 0 ] ? . v a l u e   | |   p a r e n t S e c t i o n ;  
                             i f   ( s e c t i o n N a m e )   {  
                                 r e s u l t . p u s h ( {  
                                     t y p e :   ' s e c t i o n ' ,  
                                     n a m e :   s e c t i o n N a m e ,  
                                     l e v e l ,  
                                     i s H e a d e r :   t r u e ,  
                                     s e c t i o n :   s e c t i o n N a m e  
                                 } ) ;  
                             }  
                              
                             / /   T r a c k   i n d e x   b e f o r e   n e s t e d   r o w s   f o r   c a l c u l a t i n g   s e c t i o n   t o t a l  
                             c o n s t   b e f o r e N e s t e d I n d e x   =   r e s u l t . l e n g t h ;  
                              
                             / /   R e c u r s i v e l y   p r o c e s s   n e s t e d   r o w s   W I T H   s e c t i o n   t r a c k i n g  
                             i f   ( r o w . R o w s ? . R o w )   {  
                                 c o n s t   n e s t e d   =   e x t r a c t R o w s ( {   R o w s :   {   R o w :   r o w . R o w s . R o w   }   } ,   l e v e l   +   1 ,   s e c t i o n N a m e ) ;  
                                 r e s u l t . p u s h ( . . . n e s t e d ) ;  
                             }  
                              
                             / /   C a l c u l a t e   s e c t i o n   t o t a l   b y   s u m m i n g   O N L Y   d a t a   r o w s   ( n o t   s u b t o t a l s )   i n   t h i s   s e c t i o n  
                             c o n s t   n e s t e d R o w s   =   r e s u l t . s l i c e ( b e f o r e N e s t e d I n d e x ) ;  
                             l e t   c a l c u l a t e d T o t a l   =   0 ;  
                             n e s t e d R o w s . f o r E a c h ( r   = >   {  
                                 i f   ( r . t y p e   = = =   ' d a t a ' )   {     / /   O n l y   s u m   d e t a i l   r o w s ,   n o t   s u b t o t a l   r o w s  
                                     c o n s t   n u m V a l u e   =   p a r s e F l o a t ( r . v a l u e )   | |   0 ;  
                                     c a l c u l a t e d T o t a l   + =   n u m V a l u e ;  
                                 }  
                             } ) ;  
                              
                             / /   A d d   s e c t i o n   s u m m a r y / t o t a l   w i t h   c a l c u l a t e d   v a l u e  
                             i f   ( r o w . S u m m a r y ? . C o l D a t a )   {  
                                 c o n s t   n a m e   =   r o w . S u m m a r y . C o l D a t a [ 0 ] ? . v a l u e   | |   ' ' ;  
                                 i f   ( n a m e )   {  
                                     r e s u l t . p u s h ( {  
                                         t y p e :   ' t o t a l ' ,  
                                         n a m e ,  
                                         v a l u e :   c a l c u l a t e d T o t a l ,  
                                         l e v e l ,  
                                         i s T o t a l :   t r u e  
                                     } ) ;  
                                 }  
                             }  
                         }   e l s e   i f   ( r o w . t y p e   = = =   ' D a t a '   & &   r o w . C o l D a t a )   {  
                             / /   A d d   d a t a   r o w   ( i n d i v i d u a l   a c c o u n t )  
                             c o n s t   n a m e   =   r o w . C o l D a t a [ 0 ] ? . v a l u e   | |   ' ' ;  
                             / /   E x t r a c t   f r o m   a p p r o p r i a t e   c o l u m n :   l a s t   m o n t h   i f   m u l t i - m o n t h ,   o t h e r w i s e   l a s t   c o l u m n  
                             l e t   v a l u e   =   ' 0 ' ;  
                             f o r   ( l e t   i   =   r o w . C o l D a t a . l e n g t h   -   1 ;   i   > =   1 ;   i - - )   {  
                                 c o n s t   c o l V a l u e   =   r o w . C o l D a t a [ i ] ? . v a l u e ;  
                                 i f   ( c o l V a l u e   ! = =   u n d e f i n e d   & &   c o l V a l u e   ! = =   ' '   & &   ! i s N a N ( p a r s e F l o a t ( c o l V a l u e ) ) )   {  
                                     v a l u e   =   c o l V a l u e ;  
                                     b r e a k ;  
                                 }  
                             }  
                             i f   ( n a m e )   {  
                                 r e s u l t . p u s h ( {  
                                     t y p e :   ' d a t a ' ,  
                                     n a m e ,  
                                     v a l u e ,  
                                     l e v e l ,  
                                     s e c t i o n :   p a r e n t S e c t i o n     / /   T r a c k   w h i c h   s e c t i o n   t h i s   a c c o u n t   b e l o n g s   t o  
                                 } ) ;  
                             }  
                         }  
                     }  
                      
                     r e t u r n   r e s u l t ;  
                 } ;  
                  
                 c o n s t   p l R o w s   =   e x t r a c t R o w s ( q b R a w D a t a . p r o f i t A n d L o s s ) ;  
                 c o n s t   b s R o w s   =   e x t r a c t R o w s ( q b R a w D a t a . b a l a n c e S h e e t ) ;  
                  
                 / /   D e b u g :   L o g   a l l   t o t a l   r o w s   t o   i d e n t i f y   t h e   T o t a l   I n c o m e   d i s c r e p a n c y  
                 c o n s o l e . l o g ( ' = = =   P & L   T o t a l   R o w s   = = = ' ) ;  
                 p l R o w s . f i l t e r ( r   = >   r . i s T o t a l ) . f o r E a c h ( r   = >   {  
                     c o n s o l e . l o g ( ` $ { r . n a m e } :   $ { r . v a l u e } ` ) ;  
                 } ) ;  
                  
                 r e t u r n   (  
                     < d i v   k e y = { ` d a t a - m a p p i n g - $ { s e l e c t e d C o m p a n y I d } - $ { d a t a R e f r e s h K e y } ` }   s t y l e = { {   m a x W i d t h :   ' 1 8 0 0 p x ' ,   m a r g i n :   ' 0   a u t o ' ,   p a d d i n g :   ' 3 2 p x '   } } >  
                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                             < h 1   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n :   0   } } > A c c o u n t   M a p p i n g < / h 1 >  
                             { c o m p a n y N a m e   & &   < d i v   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > { c o m p a n y N a m e } < / d i v > }  
                         < / d i v >  
                         < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                             M a p   Q u i c k B o o k s   a c c o u n t s   t o   y o u r   s t a n d a r d i z e d   f i n a n c i a l   f i e l d s        S y n c e d :   { q b R a w D a t a . s y n c D a t e   ?   n e w   D a t e ( q b R a w D a t a . s y n c D a t e ) . t o L o c a l e S t r i n g ( )   :   ' U n k n o w n ' }  
                         < / p >  
  
                         { / *   L i n e s   o f   B u s i n e s s   S e c t i o n   * / }  
                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                 < h 2   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                     L i n e s   o f   B u s i n e s s  
                                 < / h 2 >  
                                 < p   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                     D e f i n e   u p   t o   5   l i n e s   o f   b u s i n e s s   t o   a l l o c a t e   r e v e n u e   a n d   e x p e n s e s   f o r   d e t a i l e d   r e p o r t i n g  
                                 < / p >  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( a u t o - f i t ,   m i n m a x ( 2 0 0 p x ,   1 f r ) ) ' ,   g a p :   ' 1 2 p x '   } } >  
                                     { l i n e s O f B u s i n e s s . m a p ( ( l o b ,   i n d e x )   = >   (  
                                         < d i v   k e y = { i n d e x } >  
                                             < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                                 L i n e   o f   B u s i n e s s   { i n d e x   +   1 }  
                                             < / l a b e l >  
                                             < i n p u t  
                                                 t y p e = " t e x t "  
                                                 v a l u e = { l o b }  
                                                 o n C h a n g e = { ( e )   = >   {  
                                                     c o n s t   u p d a t e d   =   [ . . . l i n e s O f B u s i n e s s ] ;  
                                                     u p d a t e d [ i n d e x ]   =   e . t a r g e t . v a l u e ;  
                                                     s e t L i n e s O f B u s i n e s s ( u p d a t e d ) ;  
                                                 } }  
                                                 p l a c e h o l d e r = { ` e . g . ,   $ { i n d e x   = = =   0   ?   ' C o n s u l t i n g '   :   i n d e x   = = =   1   ?   ' P r o d u c t s '   :   i n d e x   = = =   2   ?   ' S e r v i c e s '   :   i n d e x   = = =   3   ?   ' T r a i n i n g '   :   ' O t h e r ' } ` }  
                                                 s t y l e = { {  
                                                     w i d t h :   ' 1 0 0 % ' ,  
                                                     p a d d i n g :   ' 8 p x   1 2 p x ' ,  
                                                     b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,  
                                                     b o r d e r R a d i u s :   ' 6 p x ' ,  
                                                     f o n t S i z e :   ' 1 3 p x ' ,  
                                                     c o l o r :   ' # 1 e 2 9 3 b '  
                                                 } }  
                                             / >  
                                         < / d i v >  
                                     ) ) }  
                                 < / d i v >  
                             < / d i v >  
                         < / d i v >  
  
                         { / *   A I - A s s i s t e d   M a p p i n g   S e c t i o n   * / }  
                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                     < d i v >  
                                         < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                             A I - A s s i s t e d   A c c o u n t   M a p p i n g  
                                         < / h 2 >  
                                         < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n :   0   } } >  
                                             U s e   A I   t o   a u t o m a t i c a l l y   s u g g e s t   m a p p i n g s   f r o m   Q u i c k B o o k s   a c c o u n t s   t o   y o u r   s t a n d a r d i z e d   f i n a n c i a l   f i e l d s  
                                         < / p >  
                                     < / d i v >  
                                     < b u t t o n  
                                         o n C l i c k = { a s y n c   ( )   = >   {  
                                             s e t I s G e n e r a t i n g M a p p i n g s ( t r u e ) ;  
                                             t r y   {  
                                                 / /   B u i l d   a c c o u n t   c l a s s i f i c a t i o n   l o o k u p   f r o m   C h a r t   o f   A c c o u n t s  
                                                 c o n s t   a c c o u n t C l a s s i f i c a t i o n s :   R e c o r d < s t r i n g ,   s t r i n g >   =   { } ;  
                                                 c o n s t   c h a r t O f A c c o u n t s   =   q b R a w D a t a ? . c h a r t O f A c c o u n t s ? . Q u e r y R e s p o n s e ? . A c c o u n t   | |   [ ] ;  
                                                  
                                                 c h a r t O f A c c o u n t s . f o r E a c h ( ( a c c o u n t :   a n y )   = >   {  
                                                     c o n s t   a c c o u n t N a m e   =   a c c o u n t . N a m e ;  
                                                     c o n s t   a c c o u n t T y p e   =   a c c o u n t . A c c o u n t T y p e   | |   ' ' ;  
                                                      
                                                     / /   M a p   Q B   A c c o u n t T y p e   t o   o u r   s i m p l i f i e d   c l a s s i f i c a t i o n s  
                                                     l e t   c l a s s i f i c a t i o n   =   ' ' ;  
                                                     i f   ( a c c o u n t T y p e   = = =   ' I n c o m e '   | |   a c c o u n t T y p e   = = =   ' O t h e r   I n c o m e ' )   {  
                                                         c l a s s i f i c a t i o n   =   ' R e v e n u e ' ;  
                                                     }   e l s e   i f   ( a c c o u n t T y p e   = = =   ' C o s t   o f   G o o d s   S o l d ' )   {  
                                                         c l a s s i f i c a t i o n   =   ' C o s t   o f   G o o d s   S o l d ' ;  
                                                     }   e l s e   i f   ( a c c o u n t T y p e   = = =   ' E x p e n s e '   | |   a c c o u n t T y p e   = = =   ' O t h e r   E x p e n s e ' )   {  
                                                         c l a s s i f i c a t i o n   =   ' E x p e n s e ' ;  
                                                     }   e l s e   i f   ( a c c o u n t T y p e . i n c l u d e s ( ' A s s e t ' ) )   {  
                                                         c l a s s i f i c a t i o n   =   ' A s s e t ' ;  
                                                     }   e l s e   i f   ( a c c o u n t T y p e . i n c l u d e s ( ' L i a b i l i t y ' ) )   {  
                                                         c l a s s i f i c a t i o n   =   ' L i a b i l i t y ' ;  
                                                     }   e l s e   i f   ( a c c o u n t T y p e   = = =   ' E q u i t y ' )   {  
                                                         c l a s s i f i c a t i o n   =   ' E q u i t y ' ;  
                                                     }  
                                                      
                                                     i f   ( a c c o u n t N a m e   & &   c l a s s i f i c a t i o n )   {  
                                                         a c c o u n t C l a s s i f i c a t i o n s [ a c c o u n t N a m e ]   =   c l a s s i f i c a t i o n ;  
                                                     }  
                                                 } ) ;  
                                                  
                                                 i f   ( O b j e c t . k e y s ( a c c o u n t C l a s s i f i c a t i o n s ) . l e n g t h   = = =   0 )   {  
                                                     c o n s o l e . e r r o r ( '  a      N o   C h a r t   o f   A c c o u n t s   d a t a   f o u n d !   C l a s s i f i c a t i o n s   w i l l   b e   i n c o r r e c t . ' ) ;  
                                                 }  
                                                  
                                                 / /   E x t r a c t   a l l   a c c o u n t   n a m e s   W I T H   c l a s s i f i c a t i o n s   f r o m   Q B   d a t a  
                                                 c o n s t   q b A c c o u n t s W i t h C l a s s :   A r r a y < { n a m e :   s t r i n g ,   c l a s s i f i c a t i o n :   s t r i n g } >   =   [ ] ;  
                                                  
                                                 / /   U s e   t h e   S A M E   e x t r a c t R o w s   f u n c t i o n   t h a t   w o r k s   f o r   d i s p l a y  
                                                 c o n s t   p l R o w s   =   e x t r a c t R o w s ( q b R a w D a t a . p r o f i t A n d L o s s ) ;  
                                                 c o n s t   b s R o w s   =   e x t r a c t R o w s ( q b R a w D a t a . b a l a n c e S h e e t ) ;  
                                                  
                                                 / /   F o r   P & L :   G e t   i n d i v i d u a l   R E V E N U E   i t e m s   A N D   i n d i v i d u a l   E X P E N S E   i t e m s   ( n o t   t o t a l s )  
                                                 c o n s t   r e v e n u e D a t a R o w s   =   p l R o w s . f i l t e r ( r   = >   {  
                                                     i f   ( r . t y p e   ! = =   ' d a t a '   | |   r . i s H e a d e r   | |   r . i s T o t a l )   r e t u r n   f a l s e ;  
                                                     c o n s t   s e c t i o n   =   ( r . s e c t i o n   | |   ' ' ) . t o L o w e r C a s e ( ) ;  
                                                     r e t u r n   s e c t i o n . i n c l u d e s ( ' i n c o m e ' )   | |   s e c t i o n . i n c l u d e s ( ' r e v e n u e ' ) ;  
                                                 } ) ;  
                                                 c o n s t   e x p e n s e D a t a R o w s   =   p l R o w s . f i l t e r ( r   = >   {  
                                                     i f   ( r . t y p e   ! = =   ' d a t a '   | |   r . i s H e a d e r   | |   r . i s T o t a l )   r e t u r n   f a l s e ;  
                                                     c o n s t   s e c t i o n   =   ( r . s e c t i o n   | |   ' ' ) . t o L o w e r C a s e ( ) ;  
                                                     r e t u r n   s e c t i o n . i n c l u d e s ( ' e x p e n s e ' )   | |   s e c t i o n . i n c l u d e s ( ' c o s t ' ) ;  
                                                 } ) ;  
                                                  
                                                 / /   F o r   B a l a n c e   S h e e t :   G e t   i n d i v i d u a l   i t e m s   ( a l l   d e t a i l   a c c o u n t s )  
                                                 c o n s t   b s D a t a R o w s   =   b s R o w s . f i l t e r ( r   = >   r . t y p e   = = =   ' d a t a '   & &   ! r . i s H e a d e r   & &   ! r . i s T o t a l ) ;  
                                                  
                                                 c o n s o l e . l o g ( '  x    R e v e n u e   i n d i v i d u a l   i t e m s : ' ,   r e v e n u e D a t a R o w s . l e n g t h ) ;  
                                                 c o n s o l e . l o g ( '  x    E x p e n s e   i n d i v i d u a l   i t e m s : ' ,   e x p e n s e D a t a R o w s . l e n g t h ) ;  
                                                 c o n s o l e . l o g ( '  x    B S   i n d i v i d u a l   i t e m s : ' ,   b s D a t a R o w s . l e n g t h ) ;  
                                                  
                                                 / /   D E B U G :   P i c k   f i r s t   r e v e n u e   a c c o u n t   t o   t r a c k   t h r o u g h   e n t i r e   p r o c e s s  
                                                 c o n s t   t e s t A c c o u n t   =   r e v e n u e D a t a R o w s [ 0 ] ? . n a m e   | |   e x p e n s e D a t a R o w s [ 0 ] ? . n a m e   | |   b s D a t a R o w s [ 0 ] ? . n a m e ;  
                                                 c o n s o l e . l o g ( ` \ n  x    T R A C K I N G   T E S T   A C C O U N T :   " $ { t e s t A c c o u n t } " ` ) ;  
                                                 i f   ( t e s t A c c o u n t )   {  
                                                     c o n s t   t e s t R o w   =   p l R o w s . f i n d ( r   = >   r . n a m e   = = =   t e s t A c c o u n t )   | |   b s R o w s . f i n d ( r   = >   r . n a m e   = = =   t e s t A c c o u n t ) ;  
                                                     c o n s o l e . l o g ( ' T e s t   a c c o u n t   r a w   d a t a : ' ,   t e s t R o w ) ;  
                                                 }  
                                                  
                                                 / /   A d d   r e v e n u e   i n d i v i d u a l   i t e m s  
                                                 r e v e n u e D a t a R o w s . f o r E a c h ( r o w   = >   {  
                                                     c o n s t   c l a s s i f i c a t i o n   =   a c c o u n t C l a s s i f i c a t i o n s [ r o w . n a m e ]   | |   ' R e v e n u e ' ;  
                                                     q b A c c o u n t s W i t h C l a s s . p u s h ( {   n a m e :   r o w . n a m e ,   c l a s s i f i c a t i o n   } ) ;  
                                                 } ) ;  
                                                  
                                                 / /   A d d   e x p e n s e   i n d i v i d u a l   i t e m s  
                                                 e x p e n s e D a t a R o w s . f o r E a c h ( r o w   = >   {  
                                                     c o n s t   c l a s s i f i c a t i o n   =   a c c o u n t C l a s s i f i c a t i o n s [ r o w . n a m e ]   | |   ' E x p e n s e ' ;  
                                                     q b A c c o u n t s W i t h C l a s s . p u s h ( {   n a m e :   r o w . n a m e ,   c l a s s i f i c a t i o n   } ) ;  
                                                 } ) ;  
                                                  
                                                 / /   A d d   B S   i n d i v i d u a l   i t e m s  
                                                 b s D a t a R o w s . f o r E a c h ( r o w   = >   {  
                                                     c o n s t   c l a s s i f i c a t i o n   =   a c c o u n t C l a s s i f i c a t i o n s [ r o w . n a m e ]   | |   ' A s s e t ' ;  
                                                     q b A c c o u n t s W i t h C l a s s . p u s h ( {   n a m e :   r o w . n a m e ,   c l a s s i f i c a t i o n   } ) ;  
                                                 } ) ;  
                                                  
                                                 c o n s o l e . l o g ( '  x    T O T A L   a c c o u n t s   t o   m a p : ' ,   q b A c c o u n t s W i t h C l a s s . l e n g t h ) ;  
                                                 c o n s o l e . l o g ( '  x    F i r s t   1 0   a c c o u n t s : ' ,   q b A c c o u n t s W i t h C l a s s . s l i c e ( 0 ,   1 0 ) . m a p ( a   = >   a . n a m e ) ) ;  
  
                                                 c o n s t   r e s p o n s e   =   a w a i t   f e t c h ( ' / a p i / a i - m a p p i n g ' ,   {  
                                                     m e t h o d :   ' P O S T ' ,  
                                                     h e a d e r s :   {   ' C o n t e n t - T y p e ' :   ' a p p l i c a t i o n / j s o n '   } ,  
                                                     b o d y :   J S O N . s t r i n g i f y ( {    
                                                         q b A c c o u n t s W i t h C l a s s ,  
                                                         t a r g e t F i e l d s :   [ ]  
                                                     } )  
                                                 } ) ;  
  
                                                 i f   ( ! r e s p o n s e . o k )   {  
                                                     t h r o w   n e w   E r r o r ( ' F a i l e d   t o   g e n e r a t e   m a p p i n g s ' ) ;  
                                                 }  
  
                                                 c o n s t   d a t a   =   a w a i t   r e s p o n s e . j s o n ( ) ;  
                                                 s e t A i M a p p i n g s ( d a t a . m a p p i n g s   | |   [ ] ) ;  
                                                  
                                                 / /   D E B U G :   T r a c k   t e s t   a c c o u n t   t h r o u g h   m a p p i n g  
                                                 i f   ( t e s t A c c o u n t )   {  
                                                     c o n s t   t e s t M a p p i n g   =   d a t a . m a p p i n g s . f i n d ( ( m :   a n y )   = >   m . q b A c c o u n t   = = =   t e s t A c c o u n t ) ;  
                                                     c o n s o l e . l o g ( ` \ n  x    T E S T   A C C O U N T   M A P P I N G : ` ,   t e s t M a p p i n g ) ;  
                                                 }  
                                                  
                                                 s e t S h o w M a p p i n g S e c t i o n ( t r u e ) ;  
                                             }   c a t c h   ( e r r o r :   a n y )   {  
                                                 c o n s o l e . e r r o r ( ' E r r o r   g e n e r a t i n g   m a p p i n g s : ' ,   e r r o r ) ;  
                                                 a l e r t ( ' F a i l e d   t o   g e n e r a t e   A I   m a p p i n g s :   '   +   e r r o r . m e s s a g e ) ;  
                                             }   f i n a l l y   {  
                                                 s e t I s G e n e r a t i n g M a p p i n g s ( f a l s e ) ;  
                                             }  
                                         } }  
                                         d i s a b l e d = { i s G e n e r a t i n g M a p p i n g s   | |   p l R o w s . l e n g t h   = = =   0 }  
                                         s t y l e = { {  
                                             p a d d i n g :   ' 1 2 p x   2 4 p x ' ,  
                                             b a c k g r o u n d :   i s G e n e r a t i n g M a p p i n g s   ?   ' # 9 4 a 3 b 8 '   :   ' # 6 6 7 e e a ' ,  
                                             c o l o r :   ' w h i t e ' ,  
                                             b o r d e r :   ' n o n e ' ,  
                                             b o r d e r R a d i u s :   ' 8 p x ' ,  
                                             f o n t S i z e :   ' 1 4 p x ' ,  
                                             f o n t W e i g h t :   ' 6 0 0 ' ,  
                                             c u r s o r :   i s G e n e r a t i n g M a p p i n g s   ?   ' n o t - a l l o w e d '   :   ' p o i n t e r ' ,  
                                             b o x S h a d o w :   ' 0   2 p x   6 p x   r g b a ( 1 0 2 ,   1 2 6 ,   2 3 4 ,   0 . 3 ) ' ,  
                                             d i s p l a y :   ' f l e x ' ,  
                                             a l i g n I t e m s :   ' c e n t e r ' ,  
                                             g a p :   ' 8 p x '  
                                         } }  
                                     >  
                                         { i s G e n e r a t i n g M a p p i n g s   ?   (  
                                             < >  
                                                 < s p a n >    < / s p a n >  
                                                 < s p a n > G e n e r a t i n g   M a p p i n g s . . . < / s p a n >  
                                             < / >  
                                         )   :   (  
                                             < >  
                                                 < s p a n >  x  < / s p a n >  
                                                 < s p a n > G e n e r a t e   A I   M a p p i n g s < / s p a n >  
                                             < / >  
                                         ) }  
                                     < / b u t t o n >  
                                 < / d i v >  
  
                                 { s h o w M a p p i n g S e c t i o n   & &   a i M a p p i n g s . l e n g t h   >   0   & &   (  
                                     < d i v >  
                                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 6 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' # f 0 f 9 f f ' ,   b o r d e r :   ' 1 p x   s o l i d   # b a e 6 f d ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 0 3 6 9 a 1 ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                                  S   A I   S u g g e s t i o n s   G e n e r a t e d  
                                             < / d i v >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 0 c 4 a 6 e '   } } >  
                                                 R e v i e w   t h e   s u g g e s t e d   m a p p i n g s   b e l o w .   Y o u   c a n   e d i t   a n y   m a p p i n g   b e f o r e   s a v i n g .   M a p p i n g s   w i l l   b e   u s e d   t o   a u t o m a t i c a l l y   p o p u l a t e   y o u r   s t a n d a r d i z e d   f i n a n c i a l   s t a t e m e n t s   f r o m   Q u i c k B o o k s   d a t a .  
                                             < / d i v >  
                                         < / d i v >  
  
                                         < d i v   s t y l e = { {   m a x H e i g h t :   ' 5 0 0 p x ' ,   o v e r f l o w Y :   ' a u t o ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                             < t a b l e   s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   b o r d e r C o l l a p s e :   ' c o l l a p s e ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                 < t h e a d   s t y l e = { {   p o s i t i o n :   ' s t i c k y ' ,   t o p :   0 ,   b a c k g r o u n d :   ' w h i t e ' ,   z I n d e x :   1   } } >  
                                                     < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                         < t h   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   t e x t A l i g n :   ' l e f t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   w i d t h :   ' 1 0 % '   } } > C l a s s i f i c a t i o n < / t h >  
                                                         < t h   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   t e x t A l i g n :   ' l e f t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   w i d t h :   ' 2 0 % '   } } > Q u i c k B o o k s   A c c o u n t < / t h >  
                                                         < t h   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   w i d t h :   ' 1 0 % '   } } > A m o u n t < / t h >  
                                                         < t h   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   t e x t A l i g n :   ' l e f t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   w i d t h :   ' 1 5 % '   } } > T a r g e t   F i e l d < / t h >  
                                                         < t h   c o l S p a n = { l i n e s O f B u s i n e s s . f i l t e r ( l o b   = >   l o b . t r i m ( )   ! = =   ' ' ) . l e n g t h   | |   1 }   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   t e x t A l i g n :   ' c e n t e r ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   b o r d e r L e f t :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   b o r d e r R i g h t :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                             L i n e   o f   B u s i n e s s   A l l o c a t i o n   ( % )  
                                                         < / t h >  
                                                         < t h   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   t e x t A l i g n :   ' c e n t e r ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   w i d t h :   ' 7 % '   } } > T o t a l   % < / t h >  
                                                         < t h   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   t e x t A l i g n :   ' l e f t ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   w i d t h :   ' 1 0 % '   } } > C o n f i d e n c e < / t h >  
                                                     < / t r >  
                                                     < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                         < t h   c o l S p a n = { 4 } > < / t h >  
                                                         { l i n e s O f B u s i n e s s . f i l t e r ( l o b   = >   l o b . t r i m ( )   ! = =   ' ' ) . l e n g t h   >   0   ?   (  
                                                             l i n e s O f B u s i n e s s . f i l t e r ( l o b   = >   l o b . t r i m ( )   ! = =   ' ' ) . m a p ( ( l o b ,   i d x )   = >   (  
                                                                 < t h   k e y = { i d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   4 p x ' ,   t e x t A l i g n :   ' c e n t e r ' ,   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   b o r d e r L e f t :   i d x   = = =   0   ?   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   :   ' 1 p x   s o l i d   # f 1 f 5 f 9 ' ,   b o r d e r R i g h t :   i d x   = = =   l i n e s O f B u s i n e s s . f i l t e r ( l   = >   l . t r i m ( )   ! = =   ' ' ) . l e n g t h   -   1   ?   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   :   ' n o n e ' ,   b a c k g r o u n d :   ' # f 8 f a f c '   } } >  
                                                                     { l o b }  
                                                                 < / t h >  
                                                             ) )  
                                                         )   :   (  
                                                             < t h   s t y l e = { {   p a d d i n g :   ' 8 p x   4 p x ' ,   t e x t A l i g n :   ' c e n t e r ' ,   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 9 4 a 3 b 8 ' ,   b o r d e r L e f t :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   b o r d e r R i g h t :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   b a c k g r o u n d :   ' # f 8 f a f c '   } } >  
                                                                 D e f i n e   L O B s   a b o v e  
                                                             < / t h >  
                                                         ) }  
                                                         < t h > < / t h >  
                                                         < t h > < / t h >  
                                                     < / t r >  
                                                 < / t h e a d >  
                                                 < t b o d y >  
                                                     { ( ( )   = >   {  
                                                         / /   S o r t   m a p p i n g s   b y   c l a s s i f i c a t i o n  
                                                         c o n s t   c l a s s i f i c a t i o n O r d e r   =   [ ' R e v e n u e ' ,   ' C o s t   o f   G o o d s   S o l d ' ,   ' C O G S ' ,   ' E x p e n s e ' ,   ' A s s e t ' ,   ' C u r r e n t   A s s e t ' ,   ' F i x e d   A s s e t ' ,   ' O t h e r   A s s e t ' ,   ' L i a b i l i t y ' ,   ' C u r r e n t   L i a b i l i t y ' ,   ' L o n g   T e r m   L i a b i l i t y ' ,   ' E q u i t y ' ] ;  
                                                         c o n s t   s o r t e d M a p p i n g s   =   [ . . . a i M a p p i n g s ] . s o r t ( ( a ,   b )   = >   {  
                                                             c o n s t   a C l a s s   =   a . q b A c c o u n t C l a s s i f i c a t i o n   | |   ' ' ;  
                                                             c o n s t   b C l a s s   =   b . q b A c c o u n t C l a s s i f i c a t i o n   | |   ' ' ;  
                                                             c o n s t   a I d x   =   c l a s s i f i c a t i o n O r d e r . f i n d I n d e x ( c   = >   a C l a s s . i n c l u d e s ( c )   | |   c . i n c l u d e s ( a C l a s s ) ) ;  
                                                             c o n s t   b I d x   =   c l a s s i f i c a t i o n O r d e r . f i n d I n d e x ( c   = >   b C l a s s . i n c l u d e s ( c )   | |   c . i n c l u d e s ( b C l a s s ) ) ;  
                                                             i f   ( a I d x   = = =   - 1   & &   b I d x   = = =   - 1 )   r e t u r n   0 ;  
                                                             i f   ( a I d x   = = =   - 1 )   r e t u r n   1 ;  
                                                             i f   ( b I d x   = = =   - 1 )   r e t u r n   - 1 ;  
                                                             r e t u r n   a I d x   -   b I d x ;  
                                                         } ) ;  
                                                          
                                                         r e t u r n   s o r t e d M a p p i n g s . m a p ( ( m a p p i n g ,   i d x )   = >   {  
                                                             / /   G e t   a m o u n t   f r o m   a l r e a d y - e x t r a c t e d   p l R o w s   a n d   b s R o w s  
                                                             l e t   a m o u n t   =   n u l l ;  
                                                             i f   ( p l R o w s   & &   b s R o w s )   {  
                                                                 c o n s t   a l l R o w s   =   [ . . . p l R o w s ,   . . . b s R o w s ] ;  
                                                                 c o n s t   a c c o u n t R o w   =   a l l R o w s . f i n d ( ( r o w :   a n y )   = >   r o w . n a m e   = = =   m a p p i n g . q b A c c o u n t ) ;  
                                                                 i f   ( a c c o u n t R o w )   {  
                                                                     a m o u n t   =   p a r s e F l o a t ( a c c o u n t R o w . v a l u e )   | |   0 ;  
                                                                 }  
                                                             }  
                                                              
                                                             r e t u r n   (  
                                                                 < t r   k e y = { ` $ { m a p p i n g . q b A c c o u n t } - $ { i d x } ` }   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                                         { m a p p i n g . q b A c c o u n t C l a s s i f i c a t i o n   | |   ' - ' }  
                                                                     < / t d >  
                                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > { m a p p i n g . q b A c c o u n t } < / t d >  
                                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                                         { a m o u n t   ! = =   n u l l   & &   a m o u n t   ! = =   u n d e f i n e d   ?   ` $ $ { N u m b e r ( a m o u n t ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } `   :   ' - ' }  
                                                                     < / t d >  
                                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x '   } } >  
                                                                         < s e l e c t  
                                                                             v a l u e = { m a p p i n g . t a r g e t F i e l d   | |   ' ' }  
                                                                             o n C h a n g e = { ( e )   = >   {  
                                                                                 c o n s t   n e w V a l u e   =   e . t a r g e t . v a l u e ;  
                                                                                 c o n s t   u p d a t e d   =   a i M a p p i n g s . m a p ( m   = >    
                                                                                     m . q b A c c o u n t   = = =   m a p p i n g . q b A c c o u n t    
                                                                                         ?   {   . . . m ,   t a r g e t F i e l d :   n e w V a l u e   }  
                                                                                         :   m  
                                                                                 ) ;  
                                                                                 s e t A i M a p p i n g s ( u p d a t e d ) ;  
                                                                             } }  
                                                                             s t y l e = { {  
                                                                                 w i d t h :   ' 1 0 0 % ' ,  
                                                                                 p a d d i n g :   ' 6 p x   1 0 p x ' ,  
                                                                                 b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,  
                                                                                 b o r d e r R a d i u s :   ' 6 p x ' ,  
                                                                                 f o n t S i z e :   ' 1 3 p x ' ,  
                                                                                 c o l o r :   ' # 1 e 2 9 3 b ' ,  
                                                                                 c u r s o r :   ' p o i n t e r '  
                                                                             } }  
                                                                         >  
                                                                             < o p t i o n   v a l u e = " " > - -   S e l e c t   F i e l d   - - < / o p t i o n >  
                                                                             < o p t g r o u p   l a b e l = " I n c o m e   S t a t e m e n t " >  
                                                                                 < o p t i o n   v a l u e = " r e v e n u e " > R e v e n u e < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " e x p e n s e " > T o t a l   E x p e n s e < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " c o g s P a y r o l l " > C O G S   -   P a y r o l l < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " c o g s O w n e r P a y " > C O G S   -   O w n e r   P a y < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " c o g s C o n t r a c t o r s " > C O G S   -   C o n t r a c t o r s < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " c o g s M a t e r i a l s " > C O G S   -   M a t e r i a l s < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " c o g s C o m m i s s i o n s " > C O G S   -   C o m m i s s i o n s < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " c o g s O t h e r " > C O G S   -   O t h e r < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " c o g s T o t a l " > C O G S   -   T o t a l < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " p a y r o l l " > P a y r o l l < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " o w n e r B a s e P a y " > O w n e r   B a s e   P a y < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " b e n e f i t s " > B e n e f i t s < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " i n s u r a n c e " > I n s u r a n c e < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " p r o f e s s i o n a l F e e s " > P r o f e s s i o n a l   F e e s < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " s u b c o n t r a c t o r s " > S u b c o n t r a c t o r s < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " r e n t " > R e n t < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " t a x L i c e n s e " > T a x   &   L i c e n s e < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " p h o n e C o m m " > P h o n e   &   C o m m u n i c a t i o n < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " i n f r a s t r u c t u r e " > I n f r a s t r u c t u r e / U t i l i t i e s < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " a u t o T r a v e l " > A u t o   &   T r a v e l < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " s a l e s E x p e n s e " > S a l e s   &   M a r k e t i n g < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " m a r k e t i n g " > M a r k e t i n g < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " t r a i n i n g C e r t " > T r a i n i n g   &   C e r t i f i c a t i o n < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " m e a l s E n t e r t a i n m e n t " > M e a l s   &   E n t e r t a i n m e n t < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " i n t e r e s t E x p e n s e " > I n t e r e s t   E x p e n s e < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " d e p r e c i a t i o n A m o r t i z a t i o n " > D e p r e c i a t i o n   &   A m o r t i z a t i o n < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " o t h e r E x p e n s e " > O t h e r   E x p e n s e < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " n o n O p e r a t i n g I n c o m e " > N o n - O p e r a t i n g   I n c o m e < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " e x t r a o r d i n a r y I t e m s " > E x t r a o r d i n a r y   I t e m s < / o p t i o n >  
                                                                             < / o p t g r o u p >  
                                                                             < o p t g r o u p   l a b e l = " B a l a n c e   S h e e t   -   A s s e t s " >  
                                                                                 < o p t i o n   v a l u e = " c a s h " > C a s h < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " a r " > A c c o u n t s   R e c e i v a b l e < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " i n v e n t o r y " > I n v e n t o r y < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " o t h e r C A " > O t h e r   C u r r e n t   A s s e t s < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " t c a " > T o t a l   C u r r e n t   A s s e t s < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " f i x e d A s s e t s " > F i x e d   A s s e t s < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " o t h e r A s s e t s " > O t h e r   A s s e t s < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " t o t a l A s s e t s " > T o t a l   A s s e t s < / o p t i o n >  
                                                                             < / o p t g r o u p >  
                                                                             < o p t g r o u p   l a b e l = " B a l a n c e   S h e e t   -   L i a b i l i t i e s " >  
                                                                                 < o p t i o n   v a l u e = " a p " > A c c o u n t s   P a y a b l e < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " o t h e r C L " > O t h e r   C u r r e n t   L i a b i l i t i e s < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " t c l " > T o t a l   C u r r e n t   L i a b i l i t i e s < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " l t d " > L o n g   T e r m   D e b t < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " t o t a l L i a b " > T o t a l   L i a b i l i t i e s < / o p t i o n >  
                                                                             < / o p t g r o u p >  
                                                                             < o p t g r o u p   l a b e l = " B a l a n c e   S h e e t   -   E q u i t y " >  
                                                                                 < o p t i o n   v a l u e = " t o t a l E q u i t y " > T o t a l   E q u i t y < / o p t i o n >  
                                                                                 < o p t i o n   v a l u e = " t o t a l L A n d E " > T o t a l   L i a b i l i t i e s   &   E q u i t y < / o p t i o n >  
                                                                             < / o p t g r o u p >  
                                                                         < / s e l e c t >  
                                                                     < / t d >  
                                                                     { l i n e s O f B u s i n e s s . f i l t e r ( l o b   = >   l o b . t r i m ( )   ! = =   ' ' ) . l e n g t h   >   0   ?   (  
                                                                         l i n e s O f B u s i n e s s . f i l t e r ( l o b   = >   l o b . t r i m ( )   ! = =   ' ' ) . m a p ( ( l o b ,   l o b I d x )   = >   {  
                                                                             c o n s t   l o b A l l o c a t i o n s   =   m a p p i n g . l o b A l l o c a t i o n s   | |   { } ;  
                                                                             c o n s t   c u r r e n t P e r c e n t   =   l o b A l l o c a t i o n s [ l o b ]   ! = =   u n d e f i n e d   ?   l o b A l l o c a t i o n s [ l o b ]   :   0 ;  
                                                                             c o n s t   a l l A l l o c a t i o n s   =   l o b A l l o c a t i o n s ;  
                                                                             c o n s t   t o t a l   =   O b j e c t . v a l u e s ( a l l A l l o c a t i o n s ) . r e d u c e ( ( s u m :   n u m b e r ,   v a l :   a n y )   = >   s u m   +   ( v a l   | |   0 ) ,   0 ) ;  
                                                                             c o n s t   i s O v e r A l l o c a t e d   =   t o t a l   >   1 0 0 ;  
                                                                             c o n s t   i s U n d e r A l l o c a t e d   =   t o t a l   <   1 0 0   & &   t o t a l   >   0 ;  
                                                                              
                                                                             r e t u r n   (  
                                                                                 < t d   k e y = { l o b I d x }   s t y l e = { {   p a d d i n g :   ' 8 p x   4 p x ' ,   b o r d e r L e f t :   l o b I d x   = = =   0   ?   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   :   ' 1 p x   s o l i d   # f 1 f 5 f 9 ' ,   b o r d e r R i g h t :   l o b I d x   = = =   l i n e s O f B u s i n e s s . f i l t e r ( l   = >   l . t r i m ( )   ! = =   ' ' ) . l e n g t h   -   1   ?   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   :   ' n o n e ' ,   b a c k g r o u n d :   ' # f a f a f a '   } } >  
                                                                                     < i n p u t  
                                                                                         t y p e = " n u m b e r "  
                                                                                         m i n = " 0 "  
                                                                                         m a x = " 1 0 0 "  
                                                                                         v a l u e = { c u r r e n t P e r c e n t }  
                                                                                         o n C h a n g e = { ( e )   = >   {  
                                                                                             c o n s t   n e w V a l u e   =   p a r s e I n t ( e . t a r g e t . v a l u e )   | |   0 ;  
                                                                                             c o n s t   c l a m p e d   =   M a t h . m i n ( M a t h . m a x ( n e w V a l u e ,   0 ) ,   1 0 0 ) ;  
                                                                                             c o n s t   u p d a t e d   =   a i M a p p i n g s . m a p ( m   = >    
                                                                                                 m . q b A c c o u n t   = = =   m a p p i n g . q b A c c o u n t    
                                                                                                     ?   {    
                                                                                                             . . . m ,    
                                                                                                             l o b A l l o c a t i o n s :   {  
                                                                                                                 . . . ( m . l o b A l l o c a t i o n s   | |   { } ) ,  
                                                                                                                 [ l o b ] :   c l a m p e d  
                                                                                                             }  
                                                                                                         }  
                                                                                                     :   m  
                                                                                             ) ;  
                                                                                             s e t A i M a p p i n g s ( u p d a t e d ) ;  
                                                                                         } }  
                                                                                         s t y l e = { {  
                                                                                             w i d t h :   ' 5 0 p x ' ,  
                                                                                             p a d d i n g :   ' 4 p x   6 p x ' ,  
                                                                                             b o r d e r :   i s O v e r A l l o c a t e d   ?   ' 2 p x   s o l i d   # e f 4 4 4 4 '   :   i s U n d e r A l l o c a t e d   ?   ' 2 p x   s o l i d   # f 5 9 e 0 b '   :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,  
                                                                                             b o r d e r R a d i u s :   ' 4 p x ' ,  
                                                                                             f o n t S i z e :   ' 1 2 p x ' ,  
                                                                                             c o l o r :   ' # 1 e 2 9 3 b ' ,  
                                                                                             t e x t A l i g n :   ' c e n t e r ' ,  
                                                                                             b a c k g r o u n d :   ' w h i t e '  
                                                                                         } }  
                                                                                         t i t l e = { i s O v e r A l l o c a t e d   ?   ` T o t a l   a l l o c a t i o n   i s   $ { t o t a l } %   ( e x c e e d s   1 0 0 % ) `   :   i s U n d e r A l l o c a t e d   ?   ` T o t a l   a l l o c a t i o n   i s   $ { t o t a l } %   ( l e s s   t h a n   1 0 0 % ) `   :   ` T o t a l   a l l o c a t i o n :   $ { t o t a l } % ` }  
                                                                                     / >  
                                                                                 < / t d >  
                                                                             ) ;  
                                                                         } )  
                                                                     )   :   (  
                                                                         < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   t e x t A l i g n :   ' c e n t e r ' ,   c o l o r :   ' # 9 4 a 3 b 8 ' ,   f o n t S i z e :   ' 1 2 p x ' ,   b o r d e r L e f t :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   b o r d e r R i g h t :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   b a c k g r o u n d :   ' # f a f a f a '   } } >  
                                                                             -  
                                                                         < / t d >  
                                                                     ) }  
                                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   t e x t A l i g n :   ' c e n t e r '   } } >  
                                                                         { ( ( )   = >   {  
                                                                             c o n s t   l o b A l l o c a t i o n s   =   m a p p i n g . l o b A l l o c a t i o n s   | |   { } ;  
                                                                             c o n s t   t o t a l   =   O b j e c t . v a l u e s ( l o b A l l o c a t i o n s ) . r e d u c e ( ( s u m :   n u m b e r ,   v a l :   a n y )   = >   s u m   +   ( v a l   | |   0 ) ,   0 ) ;  
                                                                             c o n s t   i s O v e r A l l o c a t e d   =   t o t a l   >   1 0 0 ;  
                                                                             c o n s t   i s U n d e r A l l o c a t e d   =   t o t a l   <   1 0 0   & &   t o t a l   >   0 ;  
                                                                             c o n s t   i s P e r f e c t   =   t o t a l   = = =   1 0 0 ;  
                                                                              
                                                                             r e t u r n   (  
                                                                                 < s p a n   s t y l e = { {  
                                                                                     p a d d i n g :   ' 4 p x   8 p x ' ,  
                                                                                     b o r d e r R a d i u s :   ' 4 p x ' ,  
                                                                                     f o n t S i z e :   ' 1 2 p x ' ,  
                                                                                     f o n t W e i g h t :   ' 6 0 0 ' ,  
                                                                                     b a c k g r o u n d :   i s O v e r A l l o c a t e d   ?   ' # f e e 2 e 2 '   :   i s U n d e r A l l o c a t e d   ?   ' # f e f 3 c 7 '   :   i s P e r f e c t   ?   ' # d c f c e 7 '   :   ' # f 1 f 5 f 9 ' ,  
                                                                                     c o l o r :   i s O v e r A l l o c a t e d   ?   ' # d c 2 6 2 6 '   :   i s U n d e r A l l o c a t e d   ?   ' # d 9 7 7 0 6 '   :   i s P e r f e c t   ?   ' # 1 6 a 3 4 a '   :   ' # 6 4 7 4 8 b '  
                                                                                 } } >  
                                                                                     { t o t a l } %  
                                                                                 < / s p a n >  
                                                                             ) ;  
                                                                         } ) ( ) }  
                                                                     < / t d >  
                                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x '   } } >  
                                                                         < s e l e c t  
                                                                             v a l u e = { m a p p i n g . c o n f i d e n c e }  
                                                                             o n C h a n g e = { ( e )   = >   {  
                                                                                 c o n s t   n e w V a l u e   =   e . t a r g e t . v a l u e ;  
                                                                                 c o n s t   u p d a t e d   =   a i M a p p i n g s . m a p ( m   = >    
                                                                                     m . q b A c c o u n t   = = =   m a p p i n g . q b A c c o u n t    
                                                                                         ?   {   . . . m ,   c o n f i d e n c e :   n e w V a l u e   }  
                                                                                         :   m  
                                                                                 ) ;  
                                                                                 s e t A i M a p p i n g s ( u p d a t e d ) ;  
                                                                             } }  
                                                                             s t y l e = { {  
                                                                                 p a d d i n g :   ' 6 p x   1 0 p x ' ,  
                                                                                 b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,  
                                                                                 b o r d e r R a d i u s :   ' 6 p x ' ,  
                                                                                 f o n t S i z e :   ' 1 3 p x ' ,  
                                                                                 c o l o r :   ' # 1 e 2 9 3 b ' ,  
                                                                                 b a c k g r o u n d :   m a p p i n g . c o n f i d e n c e   = = =   ' h i g h '   ?   ' # d c f c e 7 '   :   ( m a p p i n g . c o n f i d e n c e   = = =   ' m e d i u m '   ?   ' # f e f 3 c 7 '   :   ' # f e e 2 e 2 ' )  
                                                                             } }  
                                                                         >  
                                                                             < o p t i o n   v a l u e = " h i g h " > H i g h < / o p t i o n >  
                                                                             < o p t i o n   v a l u e = " m e d i u m " > M e d i u m < / o p t i o n >  
                                                                             < o p t i o n   v a l u e = " l o w " > L o w < / o p t i o n >  
                                                                         < / s e l e c t >  
                                                                     < / t d >  
                                                                 < / t r >  
                                                             ) ;  
                                                         } ) ;  
                                                     } ) ( ) }  
                                                 < / t b o d y >  
                                             < / t a b l e >  
                                         < / d i v >  
  
                                         { / *   A c t i o n   B u t t o n s   S e c t i o n   * / }  
                                         < d i v   s t y l e = { {   m a r g i n T o p :   ' 2 4 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                             { / *   R o w   1 :   M a p p i n g   C o n t r o l s   * / }  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 1 2 p x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   m a r g i n B o t t o m :   ' 1 6 p x ' ,   p a d d i n g B o t t o m :   ' 1 6 p x ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                 < d i v >  
                                                     < h 3   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > A c c o u n t   M a p p i n g   C o n t r o l s < / h 3 >  
                                                     < p   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n :   0   } } > S a v e   y o u r   m a p p i n g s   b e f o r e   p r o c e s s i n g   d a t a < / p >  
                                                 < / d i v >  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 1 2 p x ' ,   a l i g n I t e m s :   ' c e n t e r '   } } >  
                                                     < b u t t o n  
                                                         o n C l i c k = { a s y n c   ( )   = >   {  
                                                             i f   ( c o n f i r m ( ' A r e   y o u   s u r e   y o u   w a n t   t o   c l e a r   a l l   m a p p i n g s ?   T h i s   w i l l   d e l e t e   s a v e d   m a p p i n g s   f r o m   t h e   d a t a b a s e . ' ) )   {  
                                                                 t r y   {  
                                                                     / /   D e l e t e   f r o m   d a t a b a s e  
                                                                     c o n s t   r e s p o n s e   =   a w a i t   f e t c h ( ` / a p i / a c c o u n t - m a p p i n g s ? c o m p a n y I d = $ { s e l e c t e d C o m p a n y I d } ` ,   {  
                                                                         m e t h o d :   ' D E L E T E '  
                                                                     } ) ;  
                                                                     i f   ( ! r e s p o n s e . o k )   t h r o w   n e w   E r r o r ( ' F a i l e d   t o   d e l e t e   m a p p i n g s ' ) ;  
                                                                      
                                                                     / /   C l e a r   f r o m   s t a t e  
                                                                     s e t A i M a p p i n g s ( [ ] ) ;  
                                                                     a l e r t ( ' A l l   m a p p i n g s   c l e a r e d !    S& ' ) ;  
                                                                 }   c a t c h   ( e r r o r :   a n y )   {  
                                                                     a l e r t ( ' F a i l e d   t o   c l e a r   m a p p i n g s :   '   +   e r r o r . m e s s a g e ) ;  
                                                                 }  
                                                             }  
                                                         } }  
                                                         d i s a b l e d = { a i M a p p i n g s . l e n g t h   = = =   0 }  
                                                         s t y l e = { {  
                                                             p a d d i n g :   ' 1 0 p x   2 0 p x ' ,  
                                                             b a c k g r o u n d :   a i M a p p i n g s . l e n g t h   = = =   0   ?   ' # f 1 f 5 f 9 '   :   ' # f e e 2 e 2 ' ,  
                                                             c o l o r :   a i M a p p i n g s . l e n g t h   = = =   0   ?   ' # 9 4 a 3 b 8 '   :   ' # d c 2 6 2 6 ' ,  
                                                             b o r d e r :   ' 1 p x   s o l i d   # f e c a c a ' ,  
                                                             b o r d e r R a d i u s :   ' 6 p x ' ,  
                                                             f o n t S i z e :   ' 1 3 p x ' ,  
                                                             f o n t W e i g h t :   ' 6 0 0 ' ,  
                                                             c u r s o r :   a i M a p p i n g s . l e n g t h   = = =   0   ?   ' n o t - a l l o w e d '   :   ' p o i n t e r '  
                                                         } }  
                                                     >  
                                                          x       C l e a r   A l l  
                                                     < / b u t t o n >  
                                                     < b u t t o n  
                                                         o n C l i c k = { ( )   = >   {  
                                                             s e t S h o w M a p p i n g S e c t i o n ( f a l s e ) ;  
                                                             s e t A i M a p p i n g s ( [ ] ) ;  
                                                         } }  
                                                         s t y l e = { {  
                                                             p a d d i n g :   ' 1 0 p x   2 0 p x ' ,  
                                                             b a c k g r o u n d :   ' w h i t e ' ,  
                                                             c o l o r :   ' # 6 4 7 4 8 b ' ,  
                                                             b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,  
                                                             b o r d e r R a d i u s :   ' 6 p x ' ,  
                                                             f o n t S i z e :   ' 1 3 p x ' ,  
                                                             f o n t W e i g h t :   ' 6 0 0 ' ,  
                                                             c u r s o r :   ' p o i n t e r '  
                                                         } }  
                                                     >  
                                                         C a n c e l  
                                                     < / b u t t o n >  
                                                     < b u t t o n  
                                                         o n C l i c k = { a s y n c   ( )   = >   {  
                                                             s e t I s S a v i n g M a p p i n g s ( t r u e ) ;  
                                                             t r y   {  
                                                                 / /   D e d u p l i c a t e   m a p p i n g s   b y   q b A c c o u n t   ( k e e p   f i r s t   o c c u r r e n c e )  
                                                                 c o n s t   u n i q u e M a p p i n g s   =   a i M a p p i n g s . f i l t e r ( ( m ,   i n d e x ,   s e l f )   = >  
                                                                     i n d e x   = = =   s e l f . f i n d I n d e x ( ( t )   = >   t . q b A c c o u n t   = = =   m . q b A c c o u n t )  
                                                                 ) ;  
                                                                  
                                                                 c o n s o l e . l o g ( ` D e d u p l i c a t i n g   m a p p i n g s :   $ { a i M a p p i n g s . l e n g t h }   - >   $ { u n i q u e M a p p i n g s . l e n g t h } ` ) ;  
                                                                  
                                                                 c o n s t   r e s p o n s e   =   a w a i t   f e t c h ( ' / a p i / a c c o u n t - m a p p i n g s ' ,   {  
                                                                     m e t h o d :   ' P O S T ' ,  
                                                                     h e a d e r s :   {   ' C o n t e n t - T y p e ' :   ' a p p l i c a t i o n / j s o n '   } ,  
                                                                     b o d y :   J S O N . s t r i n g i f y ( {  
                                                                         c o m p a n y I d :   s e l e c t e d C o m p a n y I d ,  
                                                                         m a p p i n g s :   u n i q u e M a p p i n g s  
                                                                     } )  
                                                                 } ) ;  
  
                                                                 i f   ( ! r e s p o n s e . o k )   {  
                                                                     c o n s t   e r r o r D a t a   =   a w a i t   r e s p o n s e . j s o n ( ) ;  
                                                                     t h r o w   n e w   E r r o r ( e r r o r D a t a . d e t a i l s   | |   ' F a i l e d   t o   s a v e   m a p p i n g s ' ) ;  
                                                                 }  
  
                                                                 / /   U p d a t e   l o c a l   s t a t e   t o   r e f l e c t   d e d u p l i c a t e d   m a p p i n g s  
                                                                 s e t A i M a p p i n g s ( u n i q u e M a p p i n g s ) ;  
                                                                  
                                                                 a l e r t ( ' M a p p i n g s   s a v e d   s u c c e s s f u l l y !    S& ' ) ;  
                                                                 / /   K e e p   t h e   s e c t i o n   v i s i b l e   a f t e r   s a v i n g   s o   u s e r s   c a n   s e e   t h e i r   s a v e d   m a p p i n g s  
                                                             }   c a t c h   ( e r r o r :   a n y )   {  
                                                                 c o n s o l e . e r r o r ( ' E r r o r   s a v i n g   m a p p i n g s : ' ,   e r r o r ) ;  
                                                                 a l e r t ( ' F a i l e d   t o   s a v e   m a p p i n g s :   '   +   e r r o r . m e s s a g e ) ;  
                                                             }   f i n a l l y   {  
                                                                 s e t I s S a v i n g M a p p i n g s ( f a l s e ) ;  
                                                             }  
                                                         } }  
                                                         d i s a b l e d = { i s S a v i n g M a p p i n g s }  
                                                         s t y l e = { {  
                                                             p a d d i n g :   ' 1 0 p x   2 4 p x ' ,  
                                                             b a c k g r o u n d :   i s S a v i n g M a p p i n g s   ?   ' # 9 4 a 3 b 8 '   :   ' # 1 0 b 9 8 1 ' ,  
                                                             c o l o r :   ' w h i t e ' ,  
                                                             b o r d e r :   ' n o n e ' ,  
                                                             b o r d e r R a d i u s :   ' 6 p x ' ,  
                                                             f o n t S i z e :   ' 1 3 p x ' ,  
                                                             f o n t W e i g h t :   ' 6 0 0 ' ,  
                                                             c u r s o r :   i s S a v i n g M a p p i n g s   ?   ' n o t - a l l o w e d '   :   ' p o i n t e r ' ,  
                                                             b o x S h a d o w :   ' 0   2 p x   6 p x   r g b a ( 1 6 ,   1 8 5 ,   1 2 9 ,   0 . 3 ) '  
                                                         } }  
                                                     >  
                                                         { i s S a v i n g M a p p i n g s   ?   ' S a v i n g . . . '   :   '  x    S a v e   M a p p i n g s ' }  
                                                     < / b u t t o n >  
                                                 < / d i v >  
                                             < / d i v >  
  
                                             { / *   R o w   2 :   D a t a   P r o c e s s i n g   * / }  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 1 2 p x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r '   } } >  
                                                 < d i v >  
                                                     < h 3   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > D a t a   P r o c e s s i n g < / h 3 >  
                                                     < p   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n :   0   } } > P r o c e s s   Q u i c k B o o k s   d a t a   u s i n g   y o u r   s a v e d   m a p p i n g s < / p >  
                                                 < / d i v >  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 1 2 p x ' ,   a l i g n I t e m s :   ' c e n t e r '   } } >  
                                             < b u t t o n  
                                                 o n C l i c k = { a s y n c   ( )   = >   {  
                                                     i f   ( ! a i M a p p i n g s   | |   a i M a p p i n g s . l e n g t h   = = =   0 )   {  
                                                         a l e r t ( ' P l e a s e   s a v e   a c c o u n t   m a p p i n g s   f i r s t ! ' ) ;  
                                                         r e t u r n ;  
                                                     }  
                                                      
                                                     i f   ( ! q b R a w D a t a   | |   ! q b R a w D a t a . p r o f i t A n d L o s s )   {  
                                                         a l e r t ( ' N o   Q u i c k B o o k s   d a t a   a v a i l a b l e ! ' ) ;  
                                                         r e t u r n ;  
                                                     }  
                                                      
                                                     s e t I s P r o c e s s i n g M o n t h l y D a t a ( t r u e ) ;  
                                                     t r y   {  
                                                         c o n s o l e . l o g ( '  x    P r o c e s s i n g   3 6   m o n t h s   o f   d a t a   u s i n g   m a p p i n g s . . . ' ) ;  
                                                         c o n s o l e . l o g ( '  x 9   T o t a l   m a p p i n g s : ' ,   a i M a p p i n g s . l e n g t h ) ;  
                                                          
                                                         / /   D E B U G :   T r a c k   P r o f e s s i o n a l   S e r v i c e s   e x p e n s e   a c c o u n t  
                                                         c o n s t   t e s t M a p p i n g   =   a i M a p p i n g s . f i n d ( m   = >    
                                                             m . q b A c c o u n t ? . t o L o w e r C a s e ( ) . i n c l u d e s ( ' p r o f e s s i o n a l ' )   | |    
                                                             m . q b A c c o u n t ? . t o L o w e r C a s e ( ) . i n c l u d e s ( ' a c c o u n t i n g ' )   | |  
                                                             m . q b A c c o u n t ? . t o L o w e r C a s e ( ) . i n c l u d e s ( ' l e g a l ' )  
                                                         ) ;  
                                                         c o n s t   t e s t A c c o u n t N a m e   =   t e s t M a p p i n g ? . q b A c c o u n t ;  
                                                         c o n s o l e . l o g ( `  x    T R A C K I N G   P R O F E S S I O N A L   S E R V I C E S :   " $ { t e s t A c c o u n t N a m e } " ` ,   t e s t M a p p i n g ) ;  
                                                          
                                                         / /   G e t   c o l u m n   i n f o r m a t i o n   f r o m   Q B   r e p o r t  
                                                         c o n s t   p l C o l u m n s   =   q b R a w D a t a . p r o f i t A n d L o s s . C o l u m n s ? . C o l u m n   | |   [ ] ;  
                                                         c o n s t   b s C o l u m n s   =   q b R a w D a t a . b a l a n c e S h e e t ? . C o l u m n s ? . C o l u m n   | |   [ ] ;  
                                                          
                                                         c o n s o l e . l o g ( ' Q B   P & L   C o l u m n s : ' ,   p l C o l u m n s . m a p ( ( c :   a n y )   = >   c . C o l T i t l e   | |   c . C o l T y p e ) ) ;  
                                                          
                                                         / /   T h e   f i r s t   c o l u m n   i s   a c c o u n t   n a m e s ,   r e s t   a r e   d a t a   c o l u m n s  
                                                         / /   F i l t e r   o u t   " T o t a l "   c o l u m n   i f   p r e s e n t   ( u s u a l l y   t h e   l a s t   o n e )  
                                                         c o n s t   m o n t h C o l u m n s   =   p l C o l u m n s . s l i c e ( 1 ) . f i l t e r ( ( c o l :   a n y )   = >   {  
                                                             c o n s t   t i t l e   =   c o l . C o l T i t l e   | |   ' ' ;  
                                                             r e t u r n   t i t l e   & &   t i t l e . t o L o w e r C a s e ( )   ! = =   ' t o t a l ' ;  
                                                         } ) ;  
                                                         c o n s o l e . l o g ( ` F o u n d   $ { m o n t h C o l u m n s . l e n g t h }   m o n t h   c o l u m n s   i n   P & L ` ) ;  
                                                         c o n s o l e . l o g ( ' M o n t h   c o l u m n   h e a d e r s : ' ,   m o n t h C o l u m n s . m a p ( ( c :   a n y )   = >   c . C o l T i t l e ) ) ;  
                                                          
                                                         / /   H e l p e r   f u n c t i o n   t o   e x t r a c t   a l l   a c c o u n t   v a l u e s   f o r   a   s p e c i f i c   c o l u m n   i n d e x  
                                                         / /   U s e s   t h e   S A M E   r e c u r s i v e   l o g i c   a s   t h e   w o r k i n g   P & L   d i s p l a y   e x t r a c t i o n  
                                                         c o n s t   e x t r a c t C o l u m n D a t a   =   ( r e p o r t D a t a :   a n y ,   c o l u m n I n d e x :   n u m b e r ,   i s F i r s t C a l l   =   f a l s e )   = >   {  
                                                             c o n s t   a c c o u n t V a l u e s :   {   [ a c c o u n t N a m e :   s t r i n g ] :   n u m b e r   }   =   { } ;  
                                                              
                                                             c o n s t   p r o c e s s R o w s   =   ( r o w s :   a n y [ ] ,   d e p t h   =   0 )   = >   {  
                                                                 f o r   ( c o n s t   r o w   o f   r o w s )   {  
                                                                     i f   ( r o w . t y p e   = = =   ' S e c t i o n ' )   {  
                                                                         / /   P r o c e s s   n e s t e d   r o w s   f i r s t  
                                                                         i f   ( r o w . R o w s ? . R o w )   {  
                                                                             c o n s t   s u b R o w s   =   A r r a y . i s A r r a y ( r o w . R o w s . R o w )   ?   r o w . R o w s . R o w   :   [ r o w . R o w s . R o w ] ;  
                                                                             p r o c e s s R o w s ( s u b R o w s ,   d e p t h   +   1 ) ;  
                                                                         }  
                                                                          
                                                                         / /   G e t   s e c t i o n   t o t a l   f r o m   S u m m a r y   r o w  
                                                                         i f   ( r o w . S u m m a r y ? . C o l D a t a )   {  
                                                                             c o n s t   a c c o u n t N a m e   =   r o w . S u m m a r y . C o l D a t a [ 0 ] ? . v a l u e   | |   ' ' ;  
                                                                             c o n s t   v a l u e   =   r o w . S u m m a r y . C o l D a t a [ c o l u m n I n d e x ] ? . v a l u e ;  
                                                                              
                                                                             i f   ( a c c o u n t N a m e )   {  
                                                                                 c o n s t   n u m V a l u e   =   v a l u e   = = =   ' '   | |   v a l u e   = = =   u n d e f i n e d   ?   0   :   p a r s e F l o a t ( v a l u e ) ;  
                                                                                 a c c o u n t V a l u e s [ a c c o u n t N a m e ]   =   i s N a N ( n u m V a l u e )   ?   0   :   n u m V a l u e ;  
                                                                                  
                                                                                 i f   ( i s F i r s t C a l l   & &   a c c o u n t N a m e . t o L o w e r C a s e ( ) . i n c l u d e s ( ' l e g a l ' ) )   {  
                                                                                     c o n s o l e . l o g ( ` \ n  x    F o u n d   S e c t i o n   S u m m a r y   " $ { a c c o u n t N a m e } " : ` ,   {  
                                                                             c o l u m n I n d e x ,  
                                                                             v a l u e ,  
                                                                                         n u m V a l u e  
                                                                                     } ) ;  
                                                                                 }  
                                                                             }  
                                                                         }  
                                                                     }   e l s e   i f   ( r o w . t y p e   = = =   ' D a t a '   & &   r o w . C o l D a t a )   {  
                                                                         / /   G e t   d e t a i l   a c c o u n t   v a l u e  
                                                                         c o n s t   a c c o u n t N a m e   =   r o w . C o l D a t a [ 0 ] ? . v a l u e   | |   ' ' ;  
                                                                         c o n s t   v a l u e   =   r o w . C o l D a t a [ c o l u m n I n d e x ] ? . v a l u e ;  
                                                                          
                                                                     i f   ( a c c o u n t N a m e )   {  
                                                                         c o n s t   n u m V a l u e   =   v a l u e   = = =   ' '   | |   v a l u e   = = =   u n d e f i n e d   ?   0   :   p a r s e F l o a t ( v a l u e ) ;  
                                                                         a c c o u n t V a l u e s [ a c c o u n t N a m e ]   =   i s N a N ( n u m V a l u e )   ?   0   :   n u m V a l u e ;  
                                                                     }  
                                                                 }  
                                                                 }  
                                                             } ;  
                                                              
                                                             c o n s t   r o w s   =   A r r a y . i s A r r a y ( r e p o r t D a t a ? . R o w s )   ?   r e p o r t D a t a . R o w s   :    
                                                                                     ( r e p o r t D a t a ? . R o w s ? . R o w   ?   ( A r r a y . i s A r r a y ( r e p o r t D a t a . R o w s . R o w )   ?   r e p o r t D a t a . R o w s . R o w   :   [ r e p o r t D a t a . R o w s . R o w ] )   :   [ ] ) ;  
                                                              
                                                             p r o c e s s R o w s ( r o w s ,   0 ) ;  
                                                              
                                                             i f   ( i s F i r s t C a l l )   {  
                                                                 c o n s o l e . l o g ( ` \ n  x `  E x t r a c t i o n   r e s u l t s :   F o u n d   $ { O b j e c t . k e y s ( a c c o u n t V a l u e s ) . l e n g t h }   a c c o u n t s ` ) ;  
                                                             }  
                                                              
                                                             r e t u r n   a c c o u n t V a l u e s ;  
                                                         } ;  
                                                          
                                                         / /   P r o c e s s   e a c h   m o n t h ' s   d a t a  
                                                         c o n s t   m o n t h l y D a t a :   a n y [ ]   =   [ ] ;  
                                                          
                                                         f o r   ( l e t   i   =   1 ;   i   < =   m o n t h C o l u m n s . l e n g t h ;   i + + )   {  
                                                             / /   E x t r a c t   d a t a   f o r   t h i s   c o l u m n   ( e n a b l e   d e b u g   l o g g i n g   f o r   f i r s t   m o n t h )  
                                                             c o n s t   p l D a t a   =   e x t r a c t C o l u m n D a t a ( q b R a w D a t a . p r o f i t A n d L o s s ,   i ,   i   = = =   1 ) ;  
                                                             c o n s t   b s D a t a   =   q b R a w D a t a . b a l a n c e S h e e t   ?   e x t r a c t C o l u m n D a t a ( q b R a w D a t a . b a l a n c e S h e e t ,   i ,   f a l s e )   :   { } ;  
                                                              
                                                             / /   D e b u g   l o g g i n g   f o r   f i r s t   f e w   m o n t h s  
                                                             i f   ( i   < =   3 )   {  
                                                                 c o n s o l e . l o g ( ` \ n  x    M o n t h   $ { i }   e x t r a c t i o n   d e b u g : ` ) ;  
                                                                 c o n s o l e . l o g ( ` P & L   d a t a   k e y s : ` ,   O b j e c t . k e y s ( p l D a t a ) . s l i c e ( 0 ,   1 0 ) ) ;  
                                                                 c o n s o l e . l o g ( ` P & L   s a m p l e   v a l u e s : ` ,   O b j e c t . e n t r i e s ( p l D a t a ) . s l i c e ( 0 ,   5 ) ) ;  
                                                                 c o n s o l e . l o g ( ` B S   d a t a   k e y s : ` ,   O b j e c t . k e y s ( b s D a t a ) . s l i c e ( 0 ,   1 0 ) ) ;  
                                                             }  
                                                              
                                                             / /   D e b u g   m a p p i n g s   f o r   f i r s t   m o n t h  
                                                             i f   ( i   = = =   1 )   {  
                                                                 c o n s o l e . l o g ( ` \ n  x       T o t a l   m a p p i n g s :   $ { a i M a p p i n g s . l e n g t h } ` ) ;  
                                                                 c o n s t   t a r g e t F i e l d C o u n t s :   R e c o r d < s t r i n g ,   n u m b e r >   =   { } ;  
                                                                 a i M a p p i n g s . f o r E a c h ( m   = >   {  
                                                                     t a r g e t F i e l d C o u n t s [ m . t a r g e t F i e l d ]   =   ( t a r g e t F i e l d C o u n t s [ m . t a r g e t F i e l d ]   | |   0 )   +   1 ;  
                                                                 } ) ;  
                                                                 c o n s o l e . l o g ( ` T a r g e t   f i e l d   d i s t r i b u t i o n : ` ,   t a r g e t F i e l d C o u n t s ) ;  
                                                                 c o n s t   r e v e n u e M a p p i n g s   =   a i M a p p i n g s . f i l t e r ( m   = >   m . t a r g e t F i e l d   = = =   ' r e v e n u e ' ) ;  
                                                                 c o n s o l e . l o g ( ` R e v e n u e   m a p p i n g s   ( $ { r e v e n u e M a p p i n g s . l e n g t h } ) : ` ,   r e v e n u e M a p p i n g s . m a p ( m   = >   m . q b A c c o u n t ) ) ;  
                                                             }  
                                                              
                                                             / /   I n i t i a l i z e   m o n t h   r e c o r d  
                                                             c o n s t   m o n t h R e c o r d :   a n y   =   {  
                                                                 r e v e n u e :   0 ,  
                                                                 e x p e n s e :   0 ,  
                                                                 c o g s P a y r o l l :   0 ,  
                                                                 c o g s O w n e r P a y :   0 ,  
                                                                 c o g s C o n t r a c t o r s :   0 ,  
                                                                 c o g s M a t e r i a l s :   0 ,  
                                                                 c o g s C o m m i s s i o n s :   0 ,  
                                                                 c o g s O t h e r :   0 ,  
                                                                 c o g s T o t a l :   0 ,  
                                                                 p a y r o l l :   0 ,  
                                                                 o w n e r B a s e P a y :   0 ,  
                                                                 b e n e f i t s :   0 ,  
                                                                 i n s u r a n c e :   0 ,  
                                                                 p r o f e s s i o n a l F e e s :   0 ,  
                                                                 s u b c o n t r a c t o r s :   0 ,  
                                                                 r e n t :   0 ,  
                                                                 t a x L i c e n s e :   0 ,  
                                                                 p h o n e C o m m :   0 ,  
                                                                 i n f r a s t r u c t u r e :   0 ,  
                                                                 a u t o T r a v e l :   0 ,  
                                                                 s a l e s E x p e n s e :   0 ,  
                                                                 m a r k e t i n g :   0 ,  
                                                                 t r a i n i n g C e r t :   0 ,  
                                                                 m e a l s E n t e r t a i n m e n t :   0 ,  
                                                                 i n t e r e s t E x p e n s e :   0 ,  
                                                                 d e p r e c i a t i o n A m o r t i z a t i o n :   0 ,  
                                                                 o t h e r E x p e n s e :   0 ,  
                                                                 n o n O p e r a t i n g I n c o m e :   0 ,  
                                                                 e x t r a o r d i n a r y I t e m s :   0 ,  
                                                                 c a s h :   0 ,  
                                                                 a r :   0 ,  
                                                                 i n v e n t o r y :   0 ,  
                                                                 o t h e r C A :   0 ,  
                                                                 t c a :   0 ,  
                                                                 f i x e d A s s e t s :   0 ,  
                                                                 o t h e r A s s e t s :   0 ,  
                                                                 t o t a l A s s e t s :   0 ,  
                                                                 a p :   0 ,  
                                                                 o t h e r C L :   0 ,  
                                                                 t c l :   0 ,  
                                                                 l t d :   0 ,  
                                                                 t o t a l L i a b :   0 ,  
                                                                 t o t a l E q u i t y :   0 ,  
                                                                 t o t a l L A n d E :   0  
                                                             } ;  
                                                              
                                                             / /   A p p l y   m a p p i n g s   t o   p o p u l a t e   t h e   m o n t h   r e c o r d  
                                                             a i M a p p i n g s . f o r E a c h ( ( m a p p i n g ,   i d x )   = >   {  
                                                                 c o n s t   q b A c c o u n t   =   m a p p i n g . q b A c c o u n t ;  
                                                                 c o n s t   t a r g e t F i e l d   =   m a p p i n g . t a r g e t F i e l d ;  
                                                                 c o n s t   c l a s s i f i c a t i o n   =   m a p p i n g . q b A c c o u n t C l a s s i f i c a t i o n   | |   ' ' ;  
                                                                  
                                                                 / /   G e t   v a l u e   f r o m   a p p r o p r i a t e   d a t a   s o u r c e  
                                                                 c o n s t   i s B a l a n c e S h e e t   =   c l a s s i f i c a t i o n . i n c l u d e s ( ' A s s e t ' )   | |    
                                                                                                             c l a s s i f i c a t i o n . i n c l u d e s ( ' L i a b i l i t y ' )   | |    
                                                                                                             c l a s s i f i c a t i o n . i n c l u d e s ( ' E q u i t y ' ) ;  
                                                                 c o n s t   v a l u e   =   i s B a l a n c e S h e e t   ?   ( b s D a t a [ q b A c c o u n t ]   | |   0 )   :   ( p l D a t a [ q b A c c o u n t ]   | |   0 ) ;  
                                                                  
                                                                 / /   D E B U G :   T r a c k   t e s t   a c c o u n t   t h r o u g h   e v e r y   m o n t h  
                                                                 i f   ( q b A c c o u n t   = = =   t e s t A c c o u n t N a m e )   {  
                                                                     c o n s o l e . l o g ( ` \ n  x    M O N T H   $ { i }   -   T E S T   A C C O U N T   " $ { t e s t A c c o u n t N a m e } " : ` ,   {  
                                                                         t a r g e t F i e l d ,  
                                                                         c l a s s i f i c a t i o n ,  
                                                                         i s B a l a n c e S h e e t ,  
                                                                         f o u n d I n P L D a t a :   q b A c c o u n t   i n   p l D a t a ,  
                                                                         f o u n d I n B S D a t a :   q b A c c o u n t   i n   b s D a t a ,  
                                                                         e x t r a c t e d V a l u e :   v a l u e ,  
                                                                         p l D a t a K e y s :   O b j e c t . k e y s ( p l D a t a ) . s l i c e ( 0 ,   5 ) ,  
                                                                         b s D a t a K e y s :   O b j e c t . k e y s ( b s D a t a ) . s l i c e ( 0 ,   5 )  
                                                                     } ) ;  
                                                                 }  
                                                                  
                                                                 / /   M a p   t o   t a r g e t   f i e l d  
                                                                 i f   ( t a r g e t F i e l d   = = =   ' r e v e n u e ' )   m o n t h R e c o r d . r e v e n u e   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' e x p e n s e ' )   m o n t h R e c o r d . e x p e n s e   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' c o g s P a y r o l l ' )   m o n t h R e c o r d . c o g s P a y r o l l   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' c o g s O w n e r P a y ' )   m o n t h R e c o r d . c o g s O w n e r P a y   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' c o g s C o n t r a c t o r s ' )   m o n t h R e c o r d . c o g s C o n t r a c t o r s   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' c o g s M a t e r i a l s ' )   m o n t h R e c o r d . c o g s M a t e r i a l s   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' c o g s C o m m i s s i o n s ' )   m o n t h R e c o r d . c o g s C o m m i s s i o n s   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' c o g s O t h e r ' )   m o n t h R e c o r d . c o g s O t h e r   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' p a y r o l l ' )   m o n t h R e c o r d . p a y r o l l   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' o w n e r B a s e P a y ' )   m o n t h R e c o r d . o w n e r B a s e P a y   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' b e n e f i t s ' )   m o n t h R e c o r d . b e n e f i t s   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' i n s u r a n c e ' )   m o n t h R e c o r d . i n s u r a n c e   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' p r o f e s s i o n a l F e e s ' )   m o n t h R e c o r d . p r o f e s s i o n a l F e e s   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' s u b c o n t r a c t o r s ' )   m o n t h R e c o r d . s u b c o n t r a c t o r s   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' r e n t ' )   m o n t h R e c o r d . r e n t   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' t a x L i c e n s e ' )   m o n t h R e c o r d . t a x L i c e n s e   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' p h o n e C o m m ' )   m o n t h R e c o r d . p h o n e C o m m   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' i n f r a s t r u c t u r e ' )   m o n t h R e c o r d . i n f r a s t r u c t u r e   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' a u t o T r a v e l ' )   m o n t h R e c o r d . a u t o T r a v e l   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' s a l e s E x p e n s e ' )   m o n t h R e c o r d . s a l e s E x p e n s e   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' m a r k e t i n g ' )   m o n t h R e c o r d . m a r k e t i n g   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' t r a i n i n g C e r t ' )   m o n t h R e c o r d . t r a i n i n g C e r t   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' m e a l s E n t e r t a i n m e n t ' )   m o n t h R e c o r d . m e a l s E n t e r t a i n m e n t   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' i n t e r e s t E x p e n s e ' )   m o n t h R e c o r d . i n t e r e s t E x p e n s e   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' d e p r e c i a t i o n A m o r t i z a t i o n ' )   m o n t h R e c o r d . d e p r e c i a t i o n A m o r t i z a t i o n   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' o t h e r E x p e n s e ' )   m o n t h R e c o r d . o t h e r E x p e n s e   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' n o n O p e r a t i n g I n c o m e ' )   m o n t h R e c o r d . n o n O p e r a t i n g I n c o m e   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' e x t r a o r d i n a r y I t e m s ' )   m o n t h R e c o r d . e x t r a o r d i n a r y I t e m s   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' c a s h ' )   m o n t h R e c o r d . c a s h   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' a r ' )   m o n t h R e c o r d . a r   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' i n v e n t o r y ' )   m o n t h R e c o r d . i n v e n t o r y   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' o t h e r C A ' )   m o n t h R e c o r d . o t h e r C A   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' t c a ' )   m o n t h R e c o r d . t c a   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' f i x e d A s s e t s ' )   m o n t h R e c o r d . f i x e d A s s e t s   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' o t h e r A s s e t s ' )   m o n t h R e c o r d . o t h e r A s s e t s   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' t o t a l A s s e t s ' )   m o n t h R e c o r d . t o t a l A s s e t s   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' a p ' )   m o n t h R e c o r d . a p   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' o t h e r C L ' )   m o n t h R e c o r d . o t h e r C L   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' t c l ' )   m o n t h R e c o r d . t c l   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' l t d ' )   m o n t h R e c o r d . l t d   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' t o t a l L i a b ' )   m o n t h R e c o r d . t o t a l L i a b   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' t o t a l E q u i t y ' )   m o n t h R e c o r d . t o t a l E q u i t y   + =   v a l u e ;  
                                                                 e l s e   i f   ( t a r g e t F i e l d   = = =   ' t o t a l L A n d E ' )   m o n t h R e c o r d . t o t a l L A n d E   + =   v a l u e ;  
                                                             } ) ;  
                                                              
                                                             / /   C a l c u l a t e   t o t a l s  
                                                             m o n t h R e c o r d . c o g s T o t a l   =   m o n t h R e c o r d . c o g s P a y r o l l   +   m o n t h R e c o r d . c o g s O w n e r P a y   +    
                                                                                                           m o n t h R e c o r d . c o g s C o n t r a c t o r s   +   m o n t h R e c o r d . c o g s M a t e r i a l s   +    
                                                                                                           m o n t h R e c o r d . c o g s C o m m i s s i o n s   +   m o n t h R e c o r d . c o g s O t h e r ;  
                                                             m o n t h R e c o r d . t c a   =   m o n t h R e c o r d . c a s h   +   m o n t h R e c o r d . a r   +   m o n t h R e c o r d . i n v e n t o r y   +   m o n t h R e c o r d . o t h e r C A ;  
                                                             m o n t h R e c o r d . t o t a l A s s e t s   =   m o n t h R e c o r d . t c a   +   m o n t h R e c o r d . f i x e d A s s e t s   +   m o n t h R e c o r d . o t h e r A s s e t s ;  
                                                             m o n t h R e c o r d . t c l   =   m o n t h R e c o r d . a p   +   m o n t h R e c o r d . o t h e r C L ;  
                                                             m o n t h R e c o r d . t o t a l L i a b   =   m o n t h R e c o r d . t c l   +   m o n t h R e c o r d . l t d ;  
                                                             m o n t h R e c o r d . t o t a l L A n d E   =   m o n t h R e c o r d . t o t a l L i a b   +   m o n t h R e c o r d . t o t a l E q u i t y ;  
                                                              
                                                             / /   G e t   m o n t h   d a t e   f r o m   c o l u m n   h e a d e r  
                                                             c o n s t   c o l u m n H e a d e r   =   m o n t h C o l u m n s [ i   -   1 ] ? . C o l T i t l e   | |   ' ' ;  
                                                             l e t   m o n t h D a t e   =   n e w   D a t e ( ) ;  
                                                             l e t   p a r s e d S u c c e s s f u l l y   =   f a l s e ;  
                                                              
                                                             / /   T r y   t o   p a r s e   m o n t h   f r o m   c o l u m n   h e a d e r   ( e . g . ,   " S e p   3 0 ,   2 0 2 2 " ,   " O c t   2 0 2 2 " ,   " S e p - 2 0 2 5 " )  
                                                             i f   ( c o l u m n H e a d e r )   {  
                                                                 c o n s t   m o n t h N a m e s   =   [ ' J a n ' ,   ' F e b ' ,   ' M a r ' ,   ' A p r ' ,   ' M a y ' ,   ' J u n ' ,   ' J u l ' ,   ' A u g ' ,   ' S e p ' ,   ' O c t ' ,   ' N o v ' ,   ' D e c ' ] ;  
                                                                 c o n s t   f u l l M o n t h N a m e s   =   [ ' J a n u a r y ' ,   ' F e b r u a r y ' ,   ' M a r c h ' ,   ' A p r i l ' ,   ' M a y ' ,   ' J u n e ' ,   ' J u l y ' ,   ' A u g u s t ' ,   ' S e p t e m b e r ' ,   ' O c t o b e r ' ,   ' N o v e m b e r ' ,   ' D e c e m b e r ' ] ;  
                                                                  
                                                                 / /   R e m o v e   c o m m a s   a n d   s p l i t   o n   s p a c e s / d a s h e s  
                                                                 c o n s t   c l e a n H e a d e r   =   c o l u m n H e a d e r . r e p l a c e ( / , / g ,   ' ' ) ;  
                                                                 c o n s t   p a r t s   =   c l e a n H e a d e r . s p l i t ( / [ - \ s ] + / ) ;  
                                                                  
                                                                 / /   F i n d   m o n t h   n a m e   ( c o u l d   b e   a t   a n y   p o s i t i o n )  
                                                                 l e t   m o n t h I n d e x   =   - 1 ;  
                                                                 l e t   m o n t h P a r t   =   ' ' ;  
                                                                 f o r   ( c o n s t   p a r t   o f   p a r t s )   {  
                                                                     m o n t h I n d e x   =   m o n t h N a m e s . i n d e x O f ( p a r t ) ;  
                                                                     i f   ( m o n t h I n d e x   = = =   - 1 )   {  
                                                                         m o n t h I n d e x   =   f u l l M o n t h N a m e s . i n d e x O f ( p a r t ) ;  
                                                                     }  
                                                                     i f   ( m o n t h I n d e x   > =   0 )   {  
                                                                         m o n t h P a r t   =   p a r t ;  
                                                                         b r e a k ;  
                                                                     }  
                                                                 }  
                                                                  
                                                                 / /   F i n d   y e a r   ( 4 - d i g i t   n u m b e r )  
                                                                 l e t   y e a r   =   0 ;  
                                                                 f o r   ( c o n s t   p a r t   o f   p a r t s )   {  
                                                                     c o n s t   n u m   =   p a r s e I n t ( p a r t ) ;  
                                                                     i f   ( ! i s N a N ( n u m )   & &   n u m   > =   2 0 0 0   & &   n u m   < =   2 1 0 0 )   {  
                                                                         y e a r   =   n u m ;  
                                                                         b r e a k ;  
                                                                     }  
                                                                 }  
                                                                  
                                                                 i f   ( m o n t h I n d e x   > =   0   & &   y e a r   >   0 )   {  
                                                                     m o n t h D a t e   =   n e w   D a t e ( y e a r ,   m o n t h I n d e x ,   1 ) ;  
                                                                     p a r s e d S u c c e s s f u l l y   =   t r u e ;  
                                                                 }  
                                                             }  
                                                              
                                                             i f   ( ! p a r s e d S u c c e s s f u l l y )   {  
                                                                 c o n s o l e . w a r n ( ` F a i l e d   t o   p a r s e   d a t e   f r o m   c o l u m n   h e a d e r :   " $ { c o l u m n H e a d e r } " ` ) ;  
                                                             }  
                                                              
                                                             m o n t h R e c o r d . m o n t h D a t e   =   m o n t h D a t e . t o I S O S t r i n g ( ) ;  
                                                             m o n t h l y D a t a . p u s h ( m o n t h R e c o r d ) ;  
                                                              
                                                             / /   L o g   f i r s t   f e w   m o n t h s   f o r   d e b u g g i n g  
                                                             i f   ( i   < =   3 )   {  
                                                                 c o n s o l e . l o g ( ` M o n t h   $ { i } :   C o l u m n = " $ { c o l u m n H e a d e r } " ,   D a t e = $ { m o n t h D a t e . t o I S O S t r i n g ( ) . s u b s t r i n g ( 0 ,   7 ) } ,   R e v e n u e = $ { m o n t h R e c o r d . r e v e n u e } ` ) ;  
                                                             }  
                                                         }  
                                                          
                                                         c o n s o l e . l o g ( `  S&   P r o c e s s e d   $ { m o n t h l y D a t a . l e n g t h }   m o n t h s   o f   d a t a ` ) ;  
                                                         c o n s o l e . l o g ( ' F i r s t   m o n t h : ' ,   m o n t h l y D a t a [ 0 ] ) ;  
                                                         c o n s o l e . l o g ( ' L a s t   m o n t h : ' ,   m o n t h l y D a t a [ m o n t h l y D a t a . l e n g t h   -   1 ] ) ;  
                                                         c o n s o l e . l o g ( ' D a t e   r a n g e : ' ,   m o n t h l y D a t a [ 0 ] ? . m o n t h D a t e ? . s u b s t r i n g ( 0 ,   7 ) ,   ' t o ' ,   m o n t h l y D a t a [ m o n t h l y D a t a . l e n g t h   -   1 ] ? . m o n t h D a t e ? . s u b s t r i n g ( 0 ,   7 ) ) ;  
                                                          
                                                         / /   D E B U G :   F i n a l   s u m m a r y   o f   t e s t   a c c o u n t  
                                                         i f   ( t e s t A c c o u n t N a m e )   {  
                                                             c o n s t   t e s t M a p p i n g   =   a i M a p p i n g s . f i n d ( m   = >   m . q b A c c o u n t   = = =   t e s t A c c o u n t N a m e ) ;  
                                                             c o n s t   t a r g e t F i e l d   =   t e s t M a p p i n g ? . t a r g e t F i e l d ;  
                                                             c o n s o l e . l o g ( ` \ n  x    F I N A L   S U M M A R Y   -   T E S T   A C C O U N T   " $ { t e s t A c c o u n t N a m e } " : ` ) ;  
                                                             c o n s o l e . l o g ( ` M a p p e d   t o   f i e l d :   $ { t a r g e t F i e l d } ` ) ;  
                                                             c o n s o l e . l o g ( ' V a l u e s   a c r o s s   a l l   m o n t h s : ' ) ;  
                                                             m o n t h l y D a t a . f o r E a c h ( ( m o n t h ,   i d x )   = >   {  
                                                                 i f   ( t a r g e t F i e l d   & &   m o n t h [ t a r g e t F i e l d ] )   {  
                                                                     c o n s o l e . l o g ( `     M o n t h   $ { i d x   +   1 } :   $ { m o n t h [ t a r g e t F i e l d ] } ` ) ;  
                                                                 }  
                                                             } ) ;  
                                                         }  
                                                          
                                                         / /   C h e c k   i f   w e   h a v e   l e s s   t h a n   e x p e c t e d   m o n t h s  
                                                         i f   ( m o n t h l y D a t a . l e n g t h   <   1 2 )   {  
                                                             c o n s o l e . w a r n ( `  a      W A R N I N G :   O n l y   $ { m o n t h l y D a t a . l e n g t h }   m o n t h s   o f   d a t a   f o u n d .   E x p e c t e d   a t   l e a s t   1 2   m o n t h s   f o r   p r o p e r   r e p o r t i n g . ` ) ;  
                                                             i f   ( m o n t h l y D a t a . l e n g t h   = = =   1 )   {  
                                                                 a l e r t ( `  a      O n l y   1   m o n t h   o f   d a t a   w a s   p r o c e s s e d ! \ n \ n Q u i c k B o o k s   m a y   h a v e   r e t u r n e d   a   s i n g l e - c o l u m n   r e p o r t   i n s t e a d   o f   m o n t h l y   b r e a k d o w n . \ n \ n T h e   r e p o r t s   n e e d   a t   l e a s t   1 2   m o n t h s   o f   d a t a   t o   f u n c t i o n   p r o p e r l y . \ n \ n T i p :   C h e c k   t h e   Q u i c k B o o k s   s y n c   s e t t i n g s   o r   t r y   r e - s y n c i n g . ` ) ;  
                                                             }   e l s e   {  
                                                                 a l e r t ( `  a      O n l y   $ { m o n t h l y D a t a . l e n g t h }   m o n t h s   o f   d a t a   p r o c e s s e d . \ n \ n R e p o r t s   w o r k   b e s t   w i t h   a t   l e a s t   1 2   m o n t h s   o f   d a t a . ` ) ;  
                                                             }  
                                                         }  
                                                          
                                                         / /   S a v e   t o   d a t a b a s e  
                                                         i f   ( ! c u r r e n t U s e r )   {  
                                                             t h r o w   n e w   E r r o r ( ' U s e r   n o t   l o g g e d   i n ' ) ;  
                                                         }  
                                                          
                                                         c o n s t   s a v e R e s p o n s e   =   a w a i t   f e t c h ( ' / a p i / f i n a n c i a l s ' ,   {  
                                                             m e t h o d :   ' P O S T ' ,  
                                                             h e a d e r s :   {   ' C o n t e n t - T y p e ' :   ' a p p l i c a t i o n / j s o n '   } ,  
                                                             b o d y :   J S O N . s t r i n g i f y ( {  
                                                                 c o m p a n y I d :   s e l e c t e d C o m p a n y I d ,  
                                                                 u p l o a d e d B y U s e r I d :   c u r r e n t U s e r . i d ,  
                                                                 f i l e N a m e :   ' Q u i c k B o o k s   S y n c   D a t a ' ,  
                                                                 r a w D a t a :   q b R a w D a t a ,  
                                                                 c o l u m n M a p p i n g :   {   s o u r c e :   ' q u i c k b o o k s ' ,   m a p p i n g s :   a i M a p p i n g s   } ,  
                                                                 m o n t h l y D a t a  
                                                             } )  
                                                         } ) ;  
                                                          
                                                         i f   ( ! s a v e R e s p o n s e . o k )   {  
                                                             t h r o w   n e w   E r r o r ( ' F a i l e d   t o   s a v e   m o n t h l y   d a t a ' ) ;  
                                                         }  
                                                          
                                                         a l e r t ( `  S&   S u c c e s s f u l l y   p r o c e s s e d   a n d   s a v e d   $ { m o n t h l y D a t a . l e n g t h }   m o n t h s   o f   f i n a n c i a l   d a t a ! ` ) ;  
                                                     }   c a t c h   ( e r r o r :   a n y )   {  
                                                         c o n s o l e . e r r o r ( ' E r r o r   p r o c e s s i n g   m o n t h l y   d a t a : ' ,   e r r o r ) ;  
                                                         a l e r t ( ' F a i l e d   t o   p r o c e s s   m o n t h l y   d a t a :   '   +   e r r o r . m e s s a g e ) ;  
                                                     }   f i n a l l y   {  
                                                         s e t I s P r o c e s s i n g M o n t h l y D a t a ( f a l s e ) ;  
                                                     }  
                                                 } }  
                                                 d i s a b l e d = { i s P r o c e s s i n g M o n t h l y D a t a   | |   a i M a p p i n g s . l e n g t h   = = =   0 }  
                                                 s t y l e = { {  
                                                     p a d d i n g :   ' 1 0 p x   2 4 p x ' ,  
                                                     b a c k g r o u n d :   i s P r o c e s s i n g M o n t h l y D a t a   | |   a i M a p p i n g s . l e n g t h   = = =   0   ?   ' # 9 4 a 3 b 8 '   :   ' # 3 b 8 2 f 6 ' ,  
                                                     c o l o r :   ' w h i t e ' ,  
                                                     b o r d e r :   ' n o n e ' ,  
                                                     b o r d e r R a d i u s :   ' 6 p x ' ,  
                                                     f o n t S i z e :   ' 1 3 p x ' ,  
                                                     f o n t W e i g h t :   ' 6 0 0 ' ,  
                                                     c u r s o r :   i s P r o c e s s i n g M o n t h l y D a t a   | |   a i M a p p i n g s . l e n g t h   = = =   0   ?   ' n o t - a l l o w e d '   :   ' p o i n t e r ' ,  
                                                     b o x S h a d o w :   ' 0   2 p x   6 p x   r g b a ( 5 9 ,   1 3 0 ,   2 4 6 ,   0 . 3 ) '  
                                                 } }  
                                             >  
                                                 { i s P r o c e s s i n g M o n t h l y D a t a   ?   ' P r o c e s s i n g . . . '   :   '  a"!     P r o c e s s   &   S a v e   M o n t h l y   D a t a ' }  
                                             < / b u t t o n >  
                                                     < b u t t o n  
                                                         o n C l i c k = { a s y n c   ( )   = >   {  
                                                             t r y   {  
                                                                 / /   F e t c h   t h e   s a v e d   m o n t h l y   d a t a   f r o m   t h e   A P I  
                                                                 c o n s t   r e s p o n s e   =   a w a i t   f e t c h ( ` / a p i / f i n a n c i a l s ? c o m p a n y I d = $ { s e l e c t e d C o m p a n y I d } ` ) ;  
                                                                 i f   ( ! r e s p o n s e . o k )   {  
                                                                     t h r o w   n e w   E r r o r ( ' F a i l e d   t o   l o a d   f i n a n c i a l   d a t a ' ) ;  
                                                                 }  
                                                                  
                                                                 c o n s t   d a t a   =   a w a i t   r e s p o n s e . j s o n ( ) ;  
                                                                 c o n s t   m o n t h l y D a t a   =   d a t a . r e c o r d s ? . [ 0 ] ? . m o n t h l y D a t a   | |   [ ] ;  
                                                                  
                                                                 i f   ( ! m o n t h l y D a t a   | |   m o n t h l y D a t a . l e n g t h   = = =   0 )   {  
                                                                     a l e r t ( ' N o   f i n a n c i a l   d a t a   f o u n d .   P l e a s e   p r o c e s s   t h e   m o n t h l y   d a t a   f i r s t . ' ) ;  
                                                                     r e t u r n ;  
                                                                 }  
                                                                  
                                                                 / /   C o n v e r t   t o   C S V  
                                                                 c o n s t   h e a d e r s   =   O b j e c t . k e y s ( m o n t h l y D a t a [ 0 ] ) . f i l t e r ( k e y   = >   k e y   ! = =   ' i d '   & &   k e y   ! = =   ' c o m p a n y I d '   & &   k e y   ! = =   ' c r e a t e d A t '   & &   k e y   ! = =   ' u p d a t e d A t ' ) ;  
                                                                 c o n s t   c s v C o n t e n t   =   [  
                                                                     h e a d e r s . j o i n ( ' , ' ) ,  
                                                                     . . . m o n t h l y D a t a . m a p ( ( r o w :   a n y )   = >    
                                                                         h e a d e r s . m a p ( h e a d e r   = >   {  
                                                                             c o n s t   v a l u e   =   r o w [ h e a d e r ] ;  
                                                                             / /   F o r m a t   d a t e s   n i c e l y  
                                                                             i f   ( h e a d e r   = = =   ' m o n t h D a t e '   & &   v a l u e )   {  
                                                                                 r e t u r n   n e w   D a t e ( v a l u e ) . t o I S O S t r i n g ( ) . s u b s t r i n g ( 0 ,   7 ) ;   / /   Y Y Y Y - M M   f o r m a t  
                                                                             }  
                                                                             / /   H a n d l e   n u m b e r s  
                                                                             i f   ( t y p e o f   v a l u e   = = =   ' n u m b e r ' )   {  
                                                                                 r e t u r n   v a l u e ;  
                                                                             }  
                                                                             / /   E s c a p e   c o m m a s   i n   s t r i n g s  
                                                                             i f   ( t y p e o f   v a l u e   = = =   ' s t r i n g '   & &   v a l u e . i n c l u d e s ( ' , ' ) )   {  
                                                                                 r e t u r n   ` " $ { v a l u e } " ` ;  
                                                                             }  
                                                                             r e t u r n   v a l u e   | |   0 ;  
                                                                         } ) . j o i n ( ' , ' )  
                                                                     )  
                                                                 ] . j o i n ( ' \ n ' ) ;  
                                                                  
                                                                 / /   C r e a t e   d o w n l o a d   l i n k  
                                                                 c o n s t   b l o b   =   n e w   B l o b ( [ c s v C o n t e n t ] ,   {   t y p e :   ' t e x t / c s v ; c h a r s e t = u t f - 8 ; '   } ) ;  
                                                                 c o n s t   l i n k   =   d o c u m e n t . c r e a t e E l e m e n t ( ' a ' ) ;  
                                                                 c o n s t   u r l   =   U R L . c r e a t e O b j e c t U R L ( b l o b ) ;  
                                                                 c o n s t   c o m p a n y N a m e   =   c o m p a n i e s . f i n d ( c   = >   c . i d   = = =   s e l e c t e d C o m p a n y I d ) ? . n a m e   | |   ' C o m p a n y ' ;  
                                                                 c o n s t   f i l e N a m e   =   ` $ { c o m p a n y N a m e . r e p l a c e ( / [ ^ a - z A - Z 0 - 9 ] / g ,   ' _ ' ) } _ F i n a n c i a l _ D a t a _ $ { n e w   D a t e ( ) . t o I S O S t r i n g ( ) . s u b s t r i n g ( 0 ,   1 0 ) } . c s v ` ;  
                                                                  
                                                                 l i n k . s e t A t t r i b u t e ( ' h r e f ' ,   u r l ) ;  
                                                                 l i n k . s e t A t t r i b u t e ( ' d o w n l o a d ' ,   f i l e N a m e ) ;  
                                                                 l i n k . s t y l e . v i s i b i l i t y   =   ' h i d d e n ' ;  
                                                                 d o c u m e n t . b o d y . a p p e n d C h i l d ( l i n k ) ;  
                                                                 l i n k . c l i c k ( ) ;  
                                                                 d o c u m e n t . b o d y . r e m o v e C h i l d ( l i n k ) ;  
                                                                  
                                                             }   c a t c h   ( e r r o r :   a n y )   {  
                                                                 c o n s o l e . e r r o r ( ' E r r o r   d o w n l o a d i n g   d a t a : ' ,   e r r o r ) ;  
                                                                 a l e r t ( ' F a i l e d   t o   d o w n l o a d   d a t a :   '   +   e r r o r . m e s s a g e ) ;  
                                                             }  
                                                         } }  
                                                         s t y l e = { {  
                                                             p a d d i n g :   ' 1 0 p x   2 4 p x ' ,  
                                                             b a c k g r o u n d :   ' # 1 0 b 9 8 1 ' ,  
                                                             c o l o r :   ' w h i t e ' ,  
                                                             b o r d e r :   ' n o n e ' ,  
                                                             b o r d e r R a d i u s :   ' 6 p x ' ,  
                                                             f o n t S i z e :   ' 1 3 p x ' ,  
                                                             f o n t W e i g h t :   ' 6 0 0 ' ,  
                                                             c u r s o r :   ' p o i n t e r ' ,  
                                                             b o x S h a d o w :   ' 0   2 p x   6 p x   r g b a ( 1 6 ,   1 8 5 ,   1 2 9 ,   0 . 3 ) '  
                                                         } }  
                                                     >  
                                                          x    D o w n l o a d   M a p p e d   D a t a   ( C S V )  
                                                     < / b u t t o n >  
                                                 < / d i v >  
                                             < / d i v >  
                                         < / d i v >  
                                     < / d i v >  
                                 ) }  
                             < / d i v >  
                         < / d i v >  
                     < / d i v >  
                 ) ;  
             } ) ( ) }  
  
             { / *   F i n a n c i a l   S t a t e m e n t s   V i e w   -   P & L   a n d   B a l a n c e   S h e e t   O N L Y   * / }  
             { c u r r e n t V i e w   = = =   ' f i n a n c i a l - s t a t e m e n t s '   & &   s e l e c t e d C o m p a n y I d   & &   q b R a w D a t a   & &   ( ( )   = >   {  
                 / /   C R I T I C A L   S E C U R I T Y   C H E C K :   E n s u r e   q b R a w D a t a   m a t c h e s   t h e   s e l e c t e d   c o m p a n y  
                 i f   ( ! q b R a w D a t a . _ c o m p a n y I d   | |   q b R a w D a t a . _ c o m p a n y I d   ! = =   s e l e c t e d C o m p a n y I d )   {  
                     c o n s o l e . e r r o r ( `  xa   S E C U R I T Y   B L O C K :   D a t a   m i s m a t c h !   S e l e c t e d :   $ { s e l e c t e d C o m p a n y I d } ,   D a t a   c o m p a n y I d :   $ { q b R a w D a t a . _ c o m p a n y I d   | |   ' M I S S I N G ' } ` ) ;  
                     r e t u r n   < d i v   s t y l e = { {   p a d d i n g :   ' 4 8 p x ' ,   t e x t A l i g n :   ' c e n t e r '   } } >  
                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   ' # e f 4 4 4 4 ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  a      L o a d i n g   c o m p a n y   d a t a . . . < / d i v >  
                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > P l e a s e   w a i t   w h i l e   w e   f e t c h   t h e   c o r r e c t   f i n a n c i a l   d a t a . < / d i v >  
                     < / d i v > ;  
                 }  
                  
                 c o n s t   c u r r e n t C o m p a n y   =   c o m p a n i e s . f i n d ( c   = >   c . i d   = = =   s e l e c t e d C o m p a n y I d ) ;  
                 c o n s t   c u r r e n t C o m p a n y N a m e   =   c u r r e n t C o m p a n y ? . n a m e   | |   ' U n k n o w n ' ;  
                 c o n s o l e . l o g ( `  x `  = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = ` ) ;  
                 c o n s o l e . l o g ( `  x `  F I N A N C I A L   S T A T E M E N T S   R E N D E R I N G   ( R e f r e s h   K e y :   $ { d a t a R e f r e s h K e y } ) ` ) ;  
                 c o n s o l e . l o g ( `  x `  S e l e c t e d   C o m p a n y :   " $ { c u r r e n t C o m p a n y N a m e } "   ( I D :   $ { s e l e c t e d C o m p a n y I d } ) ` ) ;  
                 c o n s o l e . l o g ( `  x `  Q B   D a t a   s y n c   d a t e : ` ,   q b R a w D a t a . s y n c D a t e ) ;  
                 c o n s o l e . l o g ( `  x `  D a t a   b e l o n g s   t o   c o m p a n y : ` ,   q b R a w D a t a . _ c o m p a n y I d ) ;  
                 c o n s o l e . l o g ( `  x `  R e c o r d   I D : ` ,   q b R a w D a t a . _ r e c o r d I d ) ;  
                 c o n s o l e . l o g ( `  x `  = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = ` ) ;  
  
                 / /   H e l p e r   f u n c t i o n   t o   r e c u r s i v e l y   e x t r a c t   a l l   r o w s   f r o m   Q B   r e p o r t  
                 c o n s t   e x t r a c t R o w s   =   ( d a t a :   a n y ,   l e v e l :   n u m b e r   =   0 ,   p a r e n t S e c t i o n :   s t r i n g   =   ' ' ) :   a n y [ ]   = >   {  
                     c o n s t   r e s u l t :   a n y [ ]   =   [ ] ;  
                     i f   ( ! d a t a ? . R o w s ? . R o w )   r e t u r n   r e s u l t ;  
                     c o n s t   r o w s   =   A r r a y . i s A r r a y ( d a t a . R o w s . R o w )   ?   d a t a . R o w s . R o w   :   [ d a t a . R o w s . R o w ] ;  
                      
                     f o r   ( c o n s t   r o w   o f   r o w s )   {  
                         i f   ( r o w . t y p e   = = =   ' S e c t i o n ' )   {  
                             c o n s t   h e a d e r N a m e   =   r o w . H e a d e r ? . C o l D a t a ? . [ 0 ] ? . v a l u e   | |   ' ' ;  
                             r e s u l t . p u s h ( {  
                                 t y p e :   ' h e a d e r ' ,  
                                 n a m e :   h e a d e r N a m e ,  
                                 l e v e l ,  
                                 i s H e a d e r :   t r u e ,  
                                 s e c t i o n :   h e a d e r N a m e  
                             } ) ;  
                             i f   ( r o w . R o w s ? . R o w )   {  
                                 c o n s t   c h i l d R o w s   =   A r r a y . i s A r r a y ( r o w . R o w s . R o w )   ?   r o w . R o w s . R o w   :   [ r o w . R o w s . R o w ] ;  
                                 r e s u l t . p u s h ( . . . e x t r a c t R o w s ( {   R o w s :   {   R o w :   c h i l d R o w s   }   } ,   l e v e l   +   1 ,   h e a d e r N a m e ) ) ;  
                             }  
                             i f   ( r o w . S u m m a r y ? . C o l D a t a )   {  
                                 c o n s t   s u m m a r y N a m e   =   r o w . S u m m a r y . C o l D a t a [ 0 ] ? . v a l u e   | |   ` T o t a l   $ { h e a d e r N a m e } ` ;  
                                 c o n s t   v a l u e   =   r o w . S u m m a r y . C o l D a t a [ r o w . S u m m a r y . C o l D a t a . l e n g t h   -   1 ] ? . v a l u e ;  
                                 l e t   c a l c u l a t e d T o t a l   =   0 ;  
                                 c o n s t   d a t a R o w s   =   r e s u l t . f i l t e r ( r   = >   r . s e c t i o n   = = =   h e a d e r N a m e   & &   r . t y p e   = = =   ' d a t a ' ) ;  
                                 i f   ( d a t a R o w s . l e n g t h   >   0 )   {  
                                     c a l c u l a t e d T o t a l   =   d a t a R o w s . r e d u c e ( ( s u m ,   r )   = >   s u m   +   ( p a r s e F l o a t ( r . v a l u e )   | |   0 ) ,   0 ) ;  
                                 }   e l s e   {  
                                     c a l c u l a t e d T o t a l   =   p a r s e F l o a t ( v a l u e )   | |   0 ;  
                                 }  
                                 i f   ( s u m m a r y N a m e   & &   ! i s N a N ( c a l c u l a t e d T o t a l ) )   {  
                                     r e s u l t . p u s h ( {  
                                         t y p e :   ' t o t a l ' ,  
                                         n a m e :   s u m m a r y N a m e ,  
                                         v a l u e :   c a l c u l a t e d T o t a l ,  
                                         l e v e l ,  
                                         i s T o t a l :   t r u e  
                                     } ) ;  
                                 }  
                             }  
                         }   e l s e   i f   ( r o w . t y p e   = = =   ' D a t a '   & &   r o w . C o l D a t a )   {  
                             c o n s t   n a m e   =   r o w . C o l D a t a [ 0 ] ? . v a l u e   | |   ' ' ;  
                             l e t   v a l u e   =   ' 0 ' ;  
                             f o r   ( l e t   i   =   r o w . C o l D a t a . l e n g t h   -   1 ;   i   > =   1 ;   i - - )   {  
                                 c o n s t   c o l V a l u e   =   r o w . C o l D a t a [ i ] ? . v a l u e ;  
                                 i f   ( c o l V a l u e   ! = =   u n d e f i n e d   & &   c o l V a l u e   ! = =   ' '   & &   ! i s N a N ( p a r s e F l o a t ( c o l V a l u e ) ) )   {  
                                     v a l u e   =   c o l V a l u e ;  
                                     b r e a k ;  
                                 }  
                             }  
                             r e s u l t . p u s h ( {  
                                 t y p e :   ' d a t a ' ,  
                                 n a m e ,  
                                 v a l u e :   p a r s e F l o a t ( v a l u e )   | |   0 ,  
                                 l e v e l ,  
                                 s e c t i o n :   p a r e n t S e c t i o n ,  
                                 c o l D a t a :   r o w . C o l D a t a  
                             } ) ;  
                         }  
                     }  
                     r e t u r n   r e s u l t ;  
                 } ;  
  
                 c o n s t   p l R o w s   =   q b R a w D a t a . p r o f i t A n d L o s s ? . R o w s ? . R o w   ?   e x t r a c t R o w s ( q b R a w D a t a . p r o f i t A n d L o s s )   :   [ ] ;  
                 c o n s t   b s R o w s   =   q b R a w D a t a . b a l a n c e S h e e t ? . R o w s ? . R o w   ?   e x t r a c t R o w s ( q b R a w D a t a . b a l a n c e S h e e t )   :   [ ] ;  
                  
                 r e t u r n   (  
                     < d i v   k e y = { ` f i n a n c i a l - s t a t e m e n t s - $ { s e l e c t e d C o m p a n y I d } - $ { d a t a R e f r e s h K e y } ` }   s t y l e = { {   m a x W i d t h :   ' 1 8 0 0 p x ' ,   m a r g i n :   ' 0   a u t o ' ,   p a d d i n g :   ' 3 2 p x '   } } >  
                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                             < h 1   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n :   0   } } > F i n a n c i a l   S t a t e m e n t s < / h 1 >  
                             { c o m p a n y N a m e   & &   < d i v   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > { c o m p a n y N a m e } < / d i v > }  
                         < / d i v >  
                         < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                             Q u i c k B o o k s   D a t a        S y n c e d :   { q b R a w D a t a . s y n c D a t e   ?   n e w   D a t e ( q b R a w D a t a . s y n c D a t e ) . t o L o c a l e S t r i n g ( )   :   ' U n k n o w n ' }  
                         < / p >  
  
                         { / *   T a b   N a v i g a t i o n   * / }  
                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 8 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                             < b u t t o n  
                                 o n C l i c k = { ( )   = >   s e t F i n a n c i a l S t a t e m e n t s T a b ( ' a g g r e g a t e d ' ) }  
                                 s t y l e = { {  
                                     p a d d i n g :   ' 1 2 p x   2 4 p x ' ,  
                                     b a c k g r o u n d :   f i n a n c i a l S t a t e m e n t s T a b   = = =   ' a g g r e g a t e d '   ?   ' # 6 6 7 e e a '   :   ' t r a n s p a r e n t ' ,  
                                     c o l o r :   f i n a n c i a l S t a t e m e n t s T a b   = = =   ' a g g r e g a t e d '   ?   ' w h i t e '   :   ' # 6 4 7 4 8 b ' ,  
                                     b o r d e r :   ' n o n e ' ,  
                                     b o r d e r B o t t o m :   f i n a n c i a l S t a t e m e n t s T a b   = = =   ' a g g r e g a t e d '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t ' ,  
                                     f o n t S i z e :   ' 1 6 p x ' ,  
                                     f o n t W e i g h t :   ' 6 0 0 ' ,  
                                     c u r s o r :   ' p o i n t e r ' ,  
                                     b o r d e r R a d i u s :   ' 8 p x   8 p x   0   0 ' ,  
                                     t r a n s i t i o n :   ' a l l   0 . 2 s '  
                                 } }  
                             >  
                                 A g g r e g a t e d   F i n a n c i a l s  
                             < / b u t t o n >  
                             < b u t t o n  
                                 o n C l i c k = { ( )   = >   s e t F i n a n c i a l S t a t e m e n t s T a b ( ' l i n e - o f - b u s i n e s s ' ) }  
                                 s t y l e = { {  
                                     p a d d i n g :   ' 1 2 p x   2 4 p x ' ,  
                                     b a c k g r o u n d :   f i n a n c i a l S t a t e m e n t s T a b   = = =   ' l i n e - o f - b u s i n e s s '   ?   ' # 6 6 7 e e a '   :   ' t r a n s p a r e n t ' ,  
                                     c o l o r :   f i n a n c i a l S t a t e m e n t s T a b   = = =   ' l i n e - o f - b u s i n e s s '   ?   ' w h i t e '   :   ' # 6 4 7 4 8 b ' ,  
                                     b o r d e r :   ' n o n e ' ,  
                                     b o r d e r B o t t o m :   f i n a n c i a l S t a t e m e n t s T a b   = = =   ' l i n e - o f - b u s i n e s s '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t ' ,  
                                     f o n t S i z e :   ' 1 6 p x ' ,  
                                     f o n t W e i g h t :   ' 6 0 0 ' ,  
                                     c u r s o r :   ' p o i n t e r ' ,  
                                     b o r d e r R a d i u s :   ' 8 p x   8 p x   0   0 ' ,  
                                     t r a n s i t i o n :   ' a l l   0 . 2 s '  
                                 } }  
                             >  
                                 L i n e   o f   B u s i n e s s   R e p o r t i n g  
                             < / b u t t o n >  
                         < / d i v >  
  
                         { / *   A g g r e g a t e d   F i n a n c i a l s   T a b   * / }  
                         { f i n a n c i a l S t a t e m e n t s T a b   = = =   ' a g g r e g a t e d '   & &   (  
                         < >  
                         { / *   S t a t e m e n t   C o n t r o l s   * / }  
                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   1 f r   1 f r ' ,   g a p :   ' 1 6 p x '   } } >  
                                 { / *   T y p e   o f   S t a t e m e n t   * / }  
                                 < d i v >  
                                     < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                         T y p e   o f   S t a t e m e n t  
                                     < / l a b e l >  
                                     < s e l e c t    
                                         v a l u e = { s t a t e m e n t T y p e }  
                                         o n C h a n g e = { ( e )   = >   s e t S t a t e m e n t T y p e ( e . t a r g e t . v a l u e   a s   ' i n c o m e - s t a t e m e n t '   |   ' b a l a n c e - s h e e t ' ) }  
                                         s t y l e = { {    
                                             w i d t h :   ' 1 0 0 % ' ,    
                                             p a d d i n g :   ' 1 0 p x   1 2 p x ' ,    
                                             b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,    
                                             b o r d e r R a d i u s :   ' 6 p x ' ,    
                                             f o n t S i z e :   ' 1 4 p x ' ,  
                                             c o l o r :   ' # 1 e 2 9 3 b ' ,  
                                             b a c k g r o u n d :   ' w h i t e ' ,  
                                             c u r s o r :   ' p o i n t e r '  
                                         } }  
                                     >  
                                         < o p t i o n   v a l u e = " i n c o m e - s t a t e m e n t " > I n c o m e   S t a t e m e n t < / o p t i o n >  
                                         < o p t i o n   v a l u e = " b a l a n c e - s h e e t " > B a l a n c e   S h e e t < / o p t i o n >  
                                     < / s e l e c t >  
                                 < / d i v >  
  
                                 { / *   P e r i o d   * / }  
                                 < d i v >  
                                     < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                         P e r i o d  
                                     < / l a b e l >  
                                     < s e l e c t    
                                         v a l u e = { s t a t e m e n t P e r i o d }  
                                         o n C h a n g e = { ( e )   = >   s e t S t a t e m e n t P e r i o d ( e . t a r g e t . v a l u e   a s   a n y ) }  
                                         s t y l e = { {    
                                             w i d t h :   ' 1 0 0 % ' ,    
                                             p a d d i n g :   ' 1 0 p x   1 2 p x ' ,    
                                             b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,    
                                             b o r d e r R a d i u s :   ' 6 p x ' ,    
                                             f o n t S i z e :   ' 1 4 p x ' ,  
                                             c o l o r :   ' # 1 e 2 9 3 b ' ,  
                                             b a c k g r o u n d :   ' w h i t e ' ,  
                                             c u r s o r :   ' p o i n t e r '  
                                         } }  
                                     >  
                                         < o p t i o n   v a l u e = " c u r r e n t - m o n t h " > C u r r e n t   M o n t h < / o p t i o n >  
                                         < o p t i o n   v a l u e = " c u r r e n t - q u a r t e r " > C u r r e n t   Q u a r t e r < / o p t i o n >  
                                         < o p t i o n   v a l u e = " l a s t - 1 2 - m o n t h s " > L a s t   1 2   m o n t h s < / o p t i o n >  
                                         < o p t i o n   v a l u e = " y t d " > Y T D < / o p t i o n >  
                                         < o p t i o n   v a l u e = " l a s t - y e a r " > L a s t   Y e a r < / o p t i o n >  
                                         < o p t i o n   v a l u e = " l a s t - 3 - y e a r s " > L a s t   3   Y e a r s < / o p t i o n >  
                                     < / s e l e c t >  
                                 < / d i v >  
  
                                 { / *   D i s p l a y   A s   * / }  
                                 < d i v >  
                                     < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                         D i s p l a y   A s  
                                     < / l a b e l >  
                                     < s e l e c t    
                                         v a l u e = { s t a t e m e n t D i s p l a y }  
                                         o n C h a n g e = { ( e )   = >   s e t S t a t e m e n t D i s p l a y ( e . t a r g e t . v a l u e   a s   ' m o n t h l y '   |   ' q u a r t e r l y '   |   ' a n n u a l ' ) }  
                                         s t y l e = { {    
                                             w i d t h :   ' 1 0 0 % ' ,    
                                             p a d d i n g :   ' 1 0 p x   1 2 p x ' ,    
                                             b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,    
                                             b o r d e r R a d i u s :   ' 6 p x ' ,    
                                             f o n t S i z e :   ' 1 4 p x ' ,  
                                             c o l o r :   ' # 1 e 2 9 3 b ' ,  
                                             b a c k g r o u n d :   ' w h i t e ' ,  
                                             c u r s o r :   ' p o i n t e r '  
                                         } }  
                                     >  
                                         < o p t i o n   v a l u e = " m o n t h l y " > M o n t h l y < / o p t i o n >  
                                         < o p t i o n   v a l u e = " q u a r t e r l y " > Q u a r t e r l y < / o p t i o n >  
                                         < o p t i o n   v a l u e = " a n n u a l " > A n n u a l < / o p t i o n >  
                                     < / s e l e c t >  
                                 < / d i v >  
                             < / d i v >  
                         < / d i v >  
  
                         { / *   S t a t e m e n t   C o n t e n t   A r e a   * / }  
                         { ( ( )   = >   {  
                             c o n s o l e . l o g ( '  x `  F i n a n c i a l   S t a t e m e n t   R e n d e r   C h e c k : ' ,   {  
                                 s t a t e m e n t T y p e ,  
                                 s t a t e m e n t P e r i o d ,  
                                 m o n t h l y L e n g t h :   m o n t h l y ? . l e n g t h   | |   0 ,  
                                 l o a d e d M o n t h l y D a t a L e n g t h :   l o a d e d M o n t h l y D a t a ? . l e n g t h   | |   0 ,  
                                 h a s M o n t h l y :   ! ! m o n t h l y ,  
                                 m o n t h l y F i r s t :   m o n t h l y ? . [ 0 ] ,  
                                 c o n d i t i o n :   s t a t e m e n t T y p e   = = =   ' i n c o m e - s t a t e m e n t '   & &   s t a t e m e n t P e r i o d   = = =   ' c u r r e n t - m o n t h '   & &   m o n t h l y . l e n g t h   >   0  
                             } ) ;  
                              
                             i f   ( s t a t e m e n t T y p e   = = =   ' i n c o m e - s t a t e m e n t '   & &   s t a t e m e n t P e r i o d   = = =   ' c u r r e n t - m o n t h '   & &   m o n t h l y . l e n g t h   >   0 )   {  
                                 c o n s t   c u r r e n t M o n t h   =   m o n t h l y [ m o n t h l y . l e n g t h   -   1 ] ;  
                                 c o n s t   m o n t h D a t e   =   n e w   D a t e ( c u r r e n t M o n t h . d a t e   | |   c u r r e n t M o n t h . m o n t h ) ;  
                                 c o n s t   m o n t h N a m e   =   m o n t h D a t e . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' l o n g ' ,   y e a r :   ' n u m e r i c '   } ) ;  
                                  
                                 / /   R e v e n u e  
                                 c o n s t   r e v e n u e   =   c u r r e n t M o n t h . r e v e n u e   | |   0 ;  
                                  
                                 / /   C o s t   o f   G o o d s   S o l d  
                                 c o n s t   c o g s P a y r o l l   =   c u r r e n t M o n t h . c o g s P a y r o l l   | |   0 ;  
                                 c o n s t   c o g s O w n e r P a y   =   c u r r e n t M o n t h . c o g s O w n e r P a y   | |   0 ;  
                                 c o n s t   c o g s C o n t r a c t o r s   =   c u r r e n t M o n t h . c o g s C o n t r a c t o r s   | |   0 ;  
                                 c o n s t   c o g s M a t e r i a l s   =   c u r r e n t M o n t h . c o g s M a t e r i a l s   | |   0 ;  
                                 c o n s t   c o g s C o m m i s s i o n s   =   c u r r e n t M o n t h . c o g s C o m m i s s i o n s   | |   0 ;  
                                 c o n s t   c o g s O t h e r   =   c u r r e n t M o n t h . c o g s O t h e r   | |   0 ;  
                                 c o n s t   c o g s   =   c o g s P a y r o l l   +   c o g s O w n e r P a y   +   c o g s C o n t r a c t o r s   +   c o g s M a t e r i a l s   +   c o g s C o m m i s s i o n s   +   c o g s O t h e r ;  
                                  
                                 c o n s t   g r o s s P r o f i t   =   r e v e n u e   -   c o g s ;  
                                 c o n s t   g r o s s M a r g i n   =   r e v e n u e   >   0   ?   ( g r o s s P r o f i t   /   r e v e n u e )   *   1 0 0   :   0 ;  
                                  
                                 / /   O p e r a t i n g   E x p e n s e s  
                                 c o n s t   o p e x P a y r o l l   =   c u r r e n t M o n t h . o p e x P a y r o l l   | |   0 ;  
                                 c o n s t   o w n e r s B a s e P a y   =   c u r r e n t M o n t h . o w n e r s B a s e P a y   | |   0 ;  
                                 c o n s t   o w n e r s R e t i r e m e n t   =   c u r r e n t M o n t h . o w n e r s R e t i r e m e n t   | |   0 ;  
                                 c o n s t   p r o f e s s i o n a l S e r v i c e s   =   c u r r e n t M o n t h . p r o f e s s i o n a l S e r v i c e s   | |   0 ;  
                                 c o n s t   r e n t L e a s e   =   c u r r e n t M o n t h . r e n t L e a s e   | |   0 ;  
                                 c o n s t   u t i l i t i e s   =   c u r r e n t M o n t h . u t i l i t i e s   | |   0 ;  
                                 c o n s t   e q u i p m e n t   =   c u r r e n t M o n t h . e q u i p m e n t   | |   0 ;  
                                 c o n s t   t r a v e l   =   c u r r e n t M o n t h . t r a v e l   | |   0 ;  
                                 c o n s t   i n s u r a n c e   =   c u r r e n t M o n t h . i n s u r a n c e   | |   0 ;  
                                 c o n s t   o p e x S a l e s M a r k e t i n g   =   c u r r e n t M o n t h . o p e x S a l e s M a r k e t i n g   | |   0 ;  
                                 c o n s t   c o n t r a c t o r s D i s t r i b u t i o n   =   c u r r e n t M o n t h . c o n t r a c t o r s D i s t r i b u t i o n   | |   0 ;  
                                 c o n s t   d e p r e c i a t i o n E x p e n s e   =   c u r r e n t M o n t h . d e p r e c i a t i o n E x p e n s e   | |   0 ;  
                                 c o n s t   o p e x O t h e r   =   c u r r e n t M o n t h . o p e x O t h e r   | |   0 ;  
                                  
                                 c o n s t   t o t a l O p e x   =   o p e x P a y r o l l   +   o w n e r s B a s e P a y   +   o w n e r s R e t i r e m e n t   +   p r o f e s s i o n a l S e r v i c e s   +    
                                                                   r e n t L e a s e   +   u t i l i t i e s   +   e q u i p m e n t   +   t r a v e l   +   i n s u r a n c e   +    
                                                                   o p e x S a l e s M a r k e t i n g   +   c o n t r a c t o r s D i s t r i b u t i o n   +   d e p r e c i a t i o n E x p e n s e   +   o p e x O t h e r ;  
                                  
                                 c o n s t   o p e r a t i n g I n c o m e   =   g r o s s P r o f i t   -   t o t a l O p e x ;  
                                 c o n s t   o p e r a t i n g M a r g i n   =   r e v e n u e   >   0   ?   ( o p e r a t i n g I n c o m e   /   r e v e n u e )   *   1 0 0   :   0 ;  
                                  
                                 / /   O t h e r   I n c o m e / E x p e n s e  
                                 c o n s t   i n t e r e s t E x p e n s e   =   c u r r e n t M o n t h . i n t e r e s t E x p e n s e   | |   0 ;  
                                 c o n s t   n o n O p e r a t i n g I n c o m e   =   c u r r e n t M o n t h . n o n O p e r a t i n g I n c o m e   | |   0 ;  
                                 c o n s t   e x t r a o r d i n a r y I t e m s   =   c u r r e n t M o n t h . e x t r a o r d i n a r y I t e m s   | |   0 ;  
                                  
                                 c o n s t   n e t I n c o m e   =   o p e r a t i n g I n c o m e   -   i n t e r e s t E x p e n s e   +   n o n O p e r a t i n g I n c o m e   +   e x t r a o r d i n a r y I t e m s ;  
                                 c o n s t   n e t M a r g i n   =   r e v e n u e   >   0   ?   ( n e t I n c o m e   /   r e v e n u e )   *   1 0 0   :   0 ;  
                                  
                                 r e t u r n   (  
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 1 6 p x '   } } >  
                                                 < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > I n c o m e   S t a t e m e n t < / h 2 >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > F o r   t h e   M o n t h   E n d e d   { m o n t h N a m e } < / d i v >  
                                             < / d i v >  
  
                                             { / *   R e v e n u e   S e c t i o n   * / }  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 8 p x   0 ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > R e v e n u e < / s p a n >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { r e v e n u e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                 < / d i v >  
                                             < / d i v >  
  
                                             { / *   C O G S   S e c t i o n   * / }  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                                 < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > C o s t   o f   G o o d s   S o l d < / d i v >  
                                                 { c o g s P a y r o l l   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C O G S   -   P a y r o l l < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o g s P a y r o l l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { c o g s O w n e r P a y   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C O G S   -   O w n e r   P a y < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o g s O w n e r P a y . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { c o g s C o n t r a c t o r s   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C O G S   -   C o n t r a c t o r s < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o g s C o n t r a c t o r s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { c o g s M a t e r i a l s   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C O G S   -   M a t e r i a l s < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o g s M a t e r i a l s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { c o g s C o m m i s s i o n s   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C O G S   -   C o m m i s s i o n s < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o g s C o m m i s s i o n s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { c o g s O t h e r   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C O G S   -   O t h e r < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o g s O t h e r . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 8 p x   0 ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > T o t a l   C O G S < / s p a n >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { c o g s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                 < / d i v >  
                                             < / d i v >  
  
                                             { / *   G r o s s   P r o f i t   * / }  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # d b e a f e ' ,   p a d d i n g :   ' 1 2 p x ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } > G r o s s   P r o f i t < / s p a n >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } > $ { g r o s s P r o f i t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                 < / d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 1 e 4 0 a f ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                     { g r o s s M a r g i n . t o F i x e d ( 1 ) } %   m a r g i n  
                                                 < / d i v >  
                                             < / d i v >  
  
                                             { / *   O p e r a t i n g   E x p e n s e s   * / }  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                                 < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > O p e r a t i n g   E x p e n s e s < / d i v >  
                                                 { o p e x P a y r o l l   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > P a y r o l l < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { o p e x P a y r o l l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { o w n e r s B a s e P a y   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > O w n e r ' s   B a s e   P a y < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { o w n e r s B a s e P a y . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { o w n e r s R e t i r e m e n t   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > O w n e r ' s   R e t i r e m e n t < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { o w n e r s R e t i r e m e n t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { p r o f e s s i o n a l S e r v i c e s   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > P r o f e s s i o n a l   S e r v i c e s < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { p r o f e s s i o n a l S e r v i c e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { r e n t L e a s e   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > R e n t / L e a s e < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { r e n t L e a s e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { u t i l i t i e s   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > U t i l i t i e s < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { u t i l i t i e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { e q u i p m e n t   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > E q u i p m e n t < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { e q u i p m e n t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { t r a v e l   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T r a v e l < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { t r a v e l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { i n s u r a n c e   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > I n s u r a n c e < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { i n s u r a n c e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { o p e x S a l e s M a r k e t i n g   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > S a l e s   &   M a r k e t i n g < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { o p e x S a l e s M a r k e t i n g . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { c o n t r a c t o r s D i s t r i b u t i o n   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C o n t r a c t o r s   D i s t r i b u t i o n < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o n t r a c t o r s D i s t r i b u t i o n . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { d e p r e c i a t i o n E x p e n s e   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > D e p r e c i a t i o n   &   A m o r t i z a t i o n < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { d e p r e c i a t i o n E x p e n s e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { o p e x O t h e r   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > O t h e r   O p e r a t i n g   E x p e n s e s < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { o p e x O t h e r . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 8 p x   0 ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > T o t a l   O p e r a t i n g   E x p e n s e s < / s p a n >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { t o t a l O p e x . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                 < / d i v >  
                                             < / d i v >  
  
                                             { / *   O p e r a t i n g   I n c o m e   * / }  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # f 0 f d f 4 ' ,   p a d d i n g :   ' 1 2 p x ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 6 6 5 3 4 '   } } > O p e r a t i n g   I n c o m e < / s p a n >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 6 6 5 3 4 '   } } > $ { o p e r a t i n g I n c o m e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                 < / d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 1 6 6 5 3 4 ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                     { o p e r a t i n g M a r g i n . t o F i x e d ( 1 ) } %   m a r g i n  
                                                 < / d i v >  
                                             < / d i v >  
  
                                             { / *   O t h e r   I n c o m e / E x p e n s e   * / }  
                                             { ( i n t e r e s t E x p e n s e   >   0   | |   n o n O p e r a t i n g I n c o m e   >   0   | |   e x t r a o r d i n a r y I t e m s   ! = =   0 )   & &   (  
                                                 < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                                     < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > O t h e r   I n c o m e / ( E x p e n s e ) < / d i v >  
                                                     { n o n O p e r a t i n g I n c o m e   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > N o n - O p e r a t i n g   I n c o m e < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 1 0 b 9 8 1 '   } } > $ { n o n O p e r a t i n g I n c o m e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { i n t e r e s t E x p e n s e   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > I n t e r e s t   E x p e n s e < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # e f 4 4 4 4 '   } } > ( $     { i n t e r e s t E x p e n s e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } ) < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { e x t r a o r d i n a r y I t e m s   ! = =   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > E x t r a o r d i n a r y   I t e m s < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   e x t r a o r d i n a r y I t e m s   > =   0   ?   ' # 1 0 b 9 8 1 '   :   ' # e f 4 4 4 4 '   } } >  
                                                                 { e x t r a o r d i n a r y I t e m s   > =   0   ?   ' $ '   :   ' ( $ ' } { M a t h . a b s ( e x t r a o r d i n a r y I t e m s ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } { e x t r a o r d i n a r y I t e m s   <   0   ?   ' ) '   :   ' ' }  
                                                             < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                 < / d i v >  
                                             ) }  
  
                                             { / *   N e t   I n c o m e   * / }  
                                             < d i v   s t y l e = { {   b a c k g r o u n d :   n e t I n c o m e   > =   0   ?   ' # d c f c e 7 '   :   ' # f e e 2 e 2 ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   m a r g i n T o p :   ' 3 2 p x '   } } >  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   n e t I n c o m e   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b '   } } > N e t   I n c o m e < / s p a n >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   n e t I n c o m e   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b '   } } >  
                                                         $ { n e t I n c o m e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                                     < / s p a n >  
                                                 < / d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   n e t I n c o m e   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                     { n e t M a r g i n . t o F i x e d ( 1 ) } %   n e t   m a r g i n  
                                                 < / d i v >  
                                             < / d i v >  
                                     < / d i v >  
                                 ) ;  
                             }   e l s e   i f   ( s t a t e m e n t T y p e   = = =   ' i n c o m e - s t a t e m e n t - p e r c e n t '   & &   s t a t e m e n t P e r i o d   = = =   ' c u r r e n t - m o n t h ' )   {  
                                 c o n s t   c u r r e n t M o n t h   =   m o n t h l y [ m o n t h l y . l e n g t h   -   1 ] ;  
                                 c o n s t   m o n t h D a t e   =   n e w   D a t e ( c u r r e n t M o n t h . d a t e   | |   c u r r e n t M o n t h . m o n t h ) ;  
                                 c o n s t   m o n t h N a m e   =   m o n t h D a t e . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' l o n g ' ,   y e a r :   ' n u m e r i c '   } ) ;  
                                  
                                 / /   R e v e n u e  
                                 c o n s t   r e v e n u e   =   c u r r e n t M o n t h . r e v e n u e   | |   0 ;  
                                  
                                 / /   C o s t   o f   G o o d s   S o l d  
                                 c o n s t   c o g s P a y r o l l   =   c u r r e n t M o n t h . c o g s P a y r o l l   | |   0 ;  
                                 c o n s t   c o g s O w n e r P a y   =   c u r r e n t M o n t h . c o g s O w n e r P a y   | |   0 ;  
                                 c o n s t   c o g s C o n t r a c t o r s   =   c u r r e n t M o n t h . c o g s C o n t r a c t o r s   | |   0 ;  
                                 c o n s t   c o g s M a t e r i a l s   =   c u r r e n t M o n t h . c o g s M a t e r i a l s   | |   0 ;  
                                 c o n s t   c o g s C o m m i s s i o n s   =   c u r r e n t M o n t h . c o g s C o m m i s s i o n s   | |   0 ;  
                                 c o n s t   c o g s O t h e r   =   c u r r e n t M o n t h . c o g s O t h e r   | |   0 ;  
                                 c o n s t   c o g s   =   c o g s P a y r o l l   +   c o g s O w n e r P a y   +   c o g s C o n t r a c t o r s   +   c o g s M a t e r i a l s   +   c o g s C o m m i s s i o n s   +   c o g s O t h e r ;  
                                  
                                 c o n s t   g r o s s P r o f i t   =   r e v e n u e   -   c o g s ;  
                                 c o n s t   g r o s s M a r g i n   =   r e v e n u e   >   0   ?   ( g r o s s P r o f i t   /   r e v e n u e )   *   1 0 0   :   0 ;  
                                  
                                 / /   O p e r a t i n g   E x p e n s e s  
                                 c o n s t   o p e x P a y r o l l   =   c u r r e n t M o n t h . o p e x P a y r o l l   | |   0 ;  
                                 c o n s t   o w n e r s B a s e P a y   =   c u r r e n t M o n t h . o w n e r s B a s e P a y   | |   0 ;  
                                 c o n s t   o w n e r s R e t i r e m e n t   =   c u r r e n t M o n t h . o w n e r s R e t i r e m e n t   | |   0 ;  
                                 c o n s t   p r o f e s s i o n a l S e r v i c e s   =   c u r r e n t M o n t h . p r o f e s s i o n a l S e r v i c e s   | |   0 ;  
                                 c o n s t   r e n t L e a s e   =   c u r r e n t M o n t h . r e n t L e a s e   | |   0 ;  
                                 c o n s t   u t i l i t i e s   =   c u r r e n t M o n t h . u t i l i t i e s   | |   0 ;  
                                 c o n s t   e q u i p m e n t   =   c u r r e n t M o n t h . e q u i p m e n t   | |   0 ;  
                                 c o n s t   t r a v e l   =   c u r r e n t M o n t h . t r a v e l   | |   0 ;  
                                 c o n s t   i n s u r a n c e   =   c u r r e n t M o n t h . i n s u r a n c e   | |   0 ;  
                                 c o n s t   o p e x S a l e s M a r k e t i n g   =   c u r r e n t M o n t h . o p e x S a l e s M a r k e t i n g   | |   0 ;  
                                 c o n s t   c o n t r a c t o r s D i s t r i b u t i o n   =   c u r r e n t M o n t h . c o n t r a c t o r s D i s t r i b u t i o n   | |   0 ;  
                                 c o n s t   d e p r e c i a t i o n E x p e n s e   =   c u r r e n t M o n t h . d e p r e c i a t i o n E x p e n s e   | |   0 ;  
                                 c o n s t   o p e x O t h e r   =   c u r r e n t M o n t h . o p e x O t h e r   | |   0 ;  
                                  
                                 c o n s t   t o t a l O p e x   =   o p e x P a y r o l l   +   o w n e r s B a s e P a y   +   o w n e r s R e t i r e m e n t   +   p r o f e s s i o n a l S e r v i c e s   +    
                                                                   r e n t L e a s e   +   u t i l i t i e s   +   e q u i p m e n t   +   t r a v e l   +   i n s u r a n c e   +    
                                                                   o p e x S a l e s M a r k e t i n g   +   c o n t r a c t o r s D i s t r i b u t i o n   +   d e p r e c i a t i o n E x p e n s e   +   o p e x O t h e r ;  
                                  
                                 c o n s t   o p e r a t i n g I n c o m e   =   g r o s s P r o f i t   -   t o t a l O p e x ;  
                                 c o n s t   o p e r a t i n g M a r g i n   =   r e v e n u e   >   0   ?   ( o p e r a t i n g I n c o m e   /   r e v e n u e )   *   1 0 0   :   0 ;  
                                  
                                 / /   O t h e r   I n c o m e / E x p e n s e  
                                 c o n s t   i n t e r e s t E x p e n s e   =   c u r r e n t M o n t h . i n t e r e s t E x p e n s e   | |   0 ;  
                                 c o n s t   n o n O p e r a t i n g I n c o m e   =   c u r r e n t M o n t h . n o n O p e r a t i n g I n c o m e   | |   0 ;  
                                 c o n s t   e x t r a o r d i n a r y I t e m s   =   c u r r e n t M o n t h . e x t r a o r d i n a r y I t e m s   | |   0 ;  
                                  
                                 c o n s t   n e t I n c o m e   =   o p e r a t i n g I n c o m e   -   i n t e r e s t E x p e n s e   +   n o n O p e r a t i n g I n c o m e   +   e x t r a o r d i n a r y I t e m s ;  
                                 c o n s t   n e t M a r g i n   =   r e v e n u e   >   0   ?   ( n e t I n c o m e   /   r e v e n u e )   *   1 0 0   :   0 ;  
                                  
                                 / /   H e l p e r   f u n c t i o n   t o   c a l c u l a t e   p e r c e n t a g e  
                                 c o n s t   p c t   =   ( a m o u n t :   n u m b e r )   = >   r e v e n u e   >   0   ?   ( a m o u n t   /   r e v e n u e )   *   1 0 0   :   0 ;  
                                  
                                 r e t u r n   (  
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 1 6 p x '   } } >  
                                             < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > I n c o m e   S t a t e m e n t   -   C o m m o n   S i z e   A n a l y s i s < / h 2 >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > F o r   t h e   M o n t h   E n d e d   { m o n t h N a m e }        A l l   i t e m s   s h o w n   a s   %   o f   R e v e n u e < / d i v >  
                                         < / d i v >  
  
                                         { / *   C o l u m n   H e a d e r s   * / }  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 8 p x   0 ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # c b d 5 e 1 ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } >  
                                             < d i v > L i n e   I t e m < / d i v >  
                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > A m o u n t < / d i v >  
                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > %   o f   R e v e n u e < / d i v >  
                                         < / d i v >  
  
                                         { / *   R e v e n u e   S e c t i o n   * / }  
                                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 8 p x   0 ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   b a c k g r o u n d :   ' # f 8 f a f c '   } } >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > R e v e n u e < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { r e v e n u e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } > 1 0 0 . 0 % < / s p a n >  
                                             < / d i v >  
                                         < / d i v >  
  
                                         { / *   C O G S   S e c t i o n   * / }  
                                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                             < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   f o n t S i z e :   ' 1 5 p x '   } } > C o s t   o f   G o o d s   S o l d < / d i v >  
                                             { c o g s P a y r o l l   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > C O G S   -   P a y r o l l < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { c o g s P a y r o l l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( c o g s P a y r o l l ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             { c o g s O w n e r P a y   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > C O G S   -   O w n e r   P a y < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { c o g s O w n e r P a y . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( c o g s O w n e r P a y ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             { c o g s C o n t r a c t o r s   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > C O G S   -   C o n t r a c t o r s < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { c o g s C o n t r a c t o r s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( c o g s C o n t r a c t o r s ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             { c o g s M a t e r i a l s   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > C O G S   -   M a t e r i a l s < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { c o g s M a t e r i a l s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( c o g s M a t e r i a l s ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             { c o g s C o m m i s s i o n s   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > C O G S   -   C o m m i s s i o n s < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { c o g s C o m m i s s i o n s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( c o g s C o m m i s s i o n s ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             { c o g s O t h e r   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > C O G S   -   O t h e r < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { c o g s O t h e r . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( c o g s O t h e r ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 8 p x   0 ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > T o t a l   C O G S < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { c o g s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( c o g s ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                             < / d i v >  
                                         < / d i v >  
  
                                         { / *   G r o s s   P r o f i t   * / }  
                                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # d b e a f e ' ,   p a d d i n g :   ' 1 2 p x ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r '   } } >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } > G r o s s   P r o f i t < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { g r o s s P r o f i t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f ' ,   t e x t A l i g n :   ' r i g h t '   } } > { g r o s s M a r g i n . t o F i x e d ( 1 ) } % < / s p a n >  
                                             < / d i v >  
                                         < / d i v >  
  
                                         { / *   O p e r a t i n g   E x p e n s e s   * / }  
                                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                             < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   f o n t S i z e :   ' 1 5 p x '   } } > O p e r a t i n g   E x p e n s e s < / d i v >  
                                             { o p e x P a y r o l l   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > P a y r o l l < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { o p e x P a y r o l l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( o p e x P a y r o l l ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             { o w n e r s B a s e P a y   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > O w n e r ' s   B a s e   P a y < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { o w n e r s B a s e P a y . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( o w n e r s B a s e P a y ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             { o w n e r s R e t i r e m e n t   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > O w n e r ' s   R e t i r e m e n t < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { o w n e r s R e t i r e m e n t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( o w n e r s R e t i r e m e n t ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             { p r o f e s s i o n a l S e r v i c e s   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > P r o f e s s i o n a l   S e r v i c e s < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { p r o f e s s i o n a l S e r v i c e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( p r o f e s s i o n a l S e r v i c e s ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             { r e n t L e a s e   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > R e n t / L e a s e < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { r e n t L e a s e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( r e n t L e a s e ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             { u t i l i t i e s   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > U t i l i t i e s < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { u t i l i t i e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( u t i l i t i e s ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             { e q u i p m e n t   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > E q u i p m e n t < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { e q u i p m e n t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( e q u i p m e n t ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             { t r a v e l   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > T r a v e l < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { t r a v e l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( t r a v e l ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             { i n s u r a n c e   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > I n s u r a n c e < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { i n s u r a n c e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( i n s u r a n c e ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             { o p e x S a l e s M a r k e t i n g   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > S a l e s   &   M a r k e t i n g < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { o p e x S a l e s M a r k e t i n g . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( o p e x S a l e s M a r k e t i n g ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             { c o n t r a c t o r s D i s t r i b u t i o n   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > C o n t r a c t o r s   D i s t r i b u t i o n < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { c o n t r a c t o r s D i s t r i b u t i o n . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( c o n t r a c t o r s D i s t r i b u t i o n ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             { d e p r e c i a t i o n E x p e n s e   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > D e p r e c i a t i o n   &   A m o r t i z a t i o n < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { d e p r e c i a t i o n E x p e n s e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( d e p r e c i a t i o n E x p e n s e ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             { o p e x O t h e r   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > O t h e r   O p e r a t i n g   E x p e n s e s < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { o p e x O t h e r . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( o p e x O t h e r ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 8 p x   0 ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > T o t a l   O p e r a t i n g   E x p e n s e s < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { t o t a l O p e x . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( t o t a l O p e x ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                             < / d i v >  
                                         < / d i v >  
  
                                         { / *   O p e r a t i n g   I n c o m e   * / }  
                                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # f 0 f d f 4 ' ,   p a d d i n g :   ' 1 2 p x ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r '   } } >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 6 6 5 3 4 '   } } > O p e r a t i n g   I n c o m e < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 6 6 5 3 4 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { o p e r a t i n g I n c o m e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 6 6 5 3 4 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { o p e r a t i n g M a r g i n . t o F i x e d ( 1 ) } % < / s p a n >  
                                             < / d i v >  
                                         < / d i v >  
  
                                         { / *   O t h e r   I n c o m e / E x p e n s e   * / }  
                                         { ( i n t e r e s t E x p e n s e   >   0   | |   n o n O p e r a t i n g I n c o m e   >   0   | |   e x t r a o r d i n a r y I t e m s   ! = =   0 )   & &   (  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                                 < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   f o n t S i z e :   ' 1 5 p x '   } } > O t h e r   I n c o m e / ( E x p e n s e ) < / d i v >  
                                                 { n o n O p e r a t i n g I n c o m e   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > N o n - O p e r a t i n g   I n c o m e < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 1 0 b 9 8 1 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { n o n O p e r a t i n g I n c o m e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 1 0 b 9 8 1 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( n o n O p e r a t i n g I n c o m e ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { i n t e r e s t E x p e n s e   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > I n t e r e s t   E x p e n s e < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # e f 4 4 4 4 ' ,   t e x t A l i g n :   ' r i g h t '   } } > ( $     { i n t e r e s t E x p e n s e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } ) < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # e f 4 4 4 4 ' ,   t e x t A l i g n :   ' r i g h t '   } } > ( { p c t ( i n t e r e s t E x p e n s e ) . t o F i x e d ( 1 ) } % ) < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { e x t r a o r d i n a r y I t e m s   ! = =   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > E x t r a o r d i n a r y   I t e m s < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   e x t r a o r d i n a r y I t e m s   > =   0   ?   ' # 1 0 b 9 8 1 '   :   ' # e f 4 4 4 4 ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             { e x t r a o r d i n a r y I t e m s   > =   0   ?   ' $ '   :   ' ( $ ' } { M a t h . a b s ( e x t r a o r d i n a r y I t e m s ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } { e x t r a o r d i n a r y I t e m s   <   0   ?   ' ) '   :   ' ' }  
                                                         < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   e x t r a o r d i n a r y I t e m s   > =   0   ?   ' # 1 0 b 9 8 1 '   :   ' # e f 4 4 4 4 ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             { e x t r a o r d i n a r y I t e m s   > =   0   ?   ' '   :   ' ( ' } { p c t ( M a t h . a b s ( e x t r a o r d i n a r y I t e m s ) ) . t o F i x e d ( 1 ) } % { e x t r a o r d i n a r y I t e m s   <   0   ?   ' ) '   :   ' ' }  
                                                         < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                             < / d i v >  
                                         ) }  
  
                                         { / *   N e t   I n c o m e   * / }  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   n e t I n c o m e   > =   0   ?   ' # d c f c e 7 '   :   ' # f e e 2 e 2 ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   m a r g i n T o p :   ' 3 2 p x '   } } >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r '   } } >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   n e t I n c o m e   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b '   } } > N e t   I n c o m e < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   n e t I n c o m e   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                     $ { n e t I n c o m e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                                 < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   n e t I n c o m e   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                     { n e t M a r g i n . t o F i x e d ( 1 ) } %  
                                                 < / s p a n >  
                                             < / d i v >  
                                         < / d i v >  
                                     < / d i v >  
                                 ) ;  
                             }   e l s e   i f   ( s t a t e m e n t T y p e   = = =   ' b a l a n c e - s h e e t '   & &   s t a t e m e n t P e r i o d   = = =   ' c u r r e n t - m o n t h ' )   {  
                                 c o n s t   c u r r e n t M o n t h   =   m o n t h l y [ m o n t h l y . l e n g t h   -   1 ] ;  
                                 c o n s t   m o n t h D a t e   =   n e w   D a t e ( c u r r e n t M o n t h . d a t e   | |   c u r r e n t M o n t h . m o n t h ) ;  
                                 c o n s t   m o n t h N a m e   =   m o n t h D a t e . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' l o n g ' ,   y e a r :   ' n u m e r i c '   } ) ;  
                                  
                                 / /   A s s e t s  
                                 c o n s t   c a s h   =   c u r r e n t M o n t h . c a s h   | |   0 ;  
                                 c o n s t   a r   =   c u r r e n t M o n t h . a r   | |   0 ;  
                                 c o n s t   i n v e n t o r y   =   c u r r e n t M o n t h . i n v e n t o r y   | |   0 ;  
                                 c o n s t   o t h e r C A   =   c u r r e n t M o n t h . o t h e r C A   | |   0 ;  
                                 c o n s t   t c a   =   c a s h   +   a r   +   i n v e n t o r y   +   o t h e r C A ;  
                                  
                                 c o n s t   f i x e d A s s e t s   =   c u r r e n t M o n t h . f i x e d A s s e t s   | |   0 ;  
                                 c o n s t   o t h e r A s s e t s   =   c u r r e n t M o n t h . o t h e r A s s e t s   | |   0 ;  
                                 c o n s t   t o t a l A s s e t s   =   t c a   +   f i x e d A s s e t s   +   o t h e r A s s e t s ;  
                                  
                                 / /   L i a b i l i t i e s  
                                 c o n s t   a p   =   c u r r e n t M o n t h . a p   | |   0 ;  
                                 c o n s t   o t h e r C L   =   c u r r e n t M o n t h . o t h e r C L   | |   0 ;  
                                 c o n s t   t c l   =   a p   +   o t h e r C L ;  
                                  
                                 c o n s t   l t d   =   c u r r e n t M o n t h . l t d   | |   0 ;  
                                 c o n s t   t o t a l L i a b i l i t i e s   =   t c l   +   l t d ;  
                                  
                                 / /   E q u i t y  
                                 c o n s t   t o t a l E q u i t y   =   c u r r e n t M o n t h . t o t a l E q u i t y   | |   0 ;  
                                  
                                 / /   T o t a l   L & E  
                                 c o n s t   t o t a l L A n d E   =   t o t a l L i a b i l i t i e s   +   t o t a l E q u i t y ;  
                                  
                                 r e t u r n   (  
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 1 6 p x '   } } >  
                                             < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > B a l a n c e   S h e e t < / h 2 >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > A s   o f   { m o n t h N a m e } < / d i v >  
                                         < / d i v >  
  
                                         { / *   A S S E T S   * / }  
                                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x ' ,   p a d d i n g B o t t o m :   ' 8 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # 6 6 7 e e a '   } } > A S S E T S < / d i v >  
                                              
                                             { / *   C u r r e n t   A s s e t s   * / }  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                                                 < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   f o n t S i z e :   ' 1 5 p x '   } } > C u r r e n t   A s s e t s < / d i v >  
                                                 { c a s h   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C a s h < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c a s h . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { a r   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > A c c o u n t s   R e c e i v a b l e < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { a r . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { i n v e n t o r y   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > I n v e n t o r y < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { i n v e n t o r y . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { o t h e r C A   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > O t h e r   C u r r e n t   A s s e t s < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { o t h e r C A . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 8 p x   0   8 p x   2 0 p x ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > T o t a l   C u r r e n t   A s s e t s < / s p a n >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { t c a . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                 < / d i v >  
                                             < / d i v >  
  
                                             { / *   N o n - C u r r e n t   A s s e t s   * / }  
                                             { f i x e d A s s e t s   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > F i x e d   A s s e t s < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { f i x e d A s s e t s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             { o t h e r A s s e t s   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > O t h e r   A s s e t s < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { o t h e r A s s e t s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                              
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 1 2 p x   0 ' ,   b o r d e r T o p :   ' 2 p x   s o l i d   # 6 6 7 e e a ' ,   m a r g i n T o p :   ' 8 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c '   } } >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > T O T A L   A S S E T S < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { t o t a l A s s e t s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                             < / d i v >  
                                         < / d i v >  
  
                                         { / *   L I A B I L I T I E S   * / }  
                                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x ' ,   p a d d i n g B o t t o m :   ' 8 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # f 5 9 e 0 b '   } } > L I A B I L I T I E S < / d i v >  
                                              
                                             { / *   C u r r e n t   L i a b i l i t i e s   * / }  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                                                 < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   f o n t S i z e :   ' 1 5 p x '   } } > C u r r e n t   L i a b i l i t i e s < / d i v >  
                                                 { a p   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > A c c o u n t s   P a y a b l e < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { a p . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { o t h e r C L   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > O t h e r   C u r r e n t   L i a b i l i t i e s < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { o t h e r C L . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 8 p x   0   8 p x   2 0 p x ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > T o t a l   C u r r e n t   L i a b i l i t i e s < / s p a n >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { t c l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                 < / d i v >  
                                             < / d i v >  
  
                                             { / *   L o n g - t e r m   D e b t   * / }  
                                             { l t d   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > L o n g - t e r m   D e b t < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { l t d . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                              
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 1 2 p x   0 ' ,   b o r d e r T o p :   ' 2 p x   s o l i d   # f 5 9 e 0 b ' ,   m a r g i n T o p :   ' 8 p x ' ,   b a c k g r o u n d :   ' # f e f 3 c 7 '   } } >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > T O T A L   L I A B I L I T I E S < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { t o t a l L i a b i l i t i e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                             < / d i v >  
                                         < / d i v >  
  
                                         { / *   E Q U I T Y   * / }  
                                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x ' ,   p a d d i n g B o t t o m :   ' 8 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # 1 0 b 9 8 1 '   } } > E Q U I T Y < / d i v >  
                                              
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 1 2 p x   0 ' ,   b o r d e r T o p :   ' 2 p x   s o l i d   # 1 0 b 9 8 1 ' ,   b a c k g r o u n d :   ' # d 1 f a e 5 '   } } >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > T O T A L   E Q U I T Y < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { t o t a l E q u i t y . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                             < / d i v >  
                                         < / d i v >  
  
                                         { / *   T O T A L   L I A B I L I T I E S   &   E Q U I T Y   * / }  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 1 f 5 f 9 ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   m a r g i n T o p :   ' 3 2 p x '   } } >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > T O T A L   L I A B I L I T I E S   &   E Q U I T Y < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } >  
                                                     $ { t o t a l L A n d E . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                                 < / s p a n >  
                                             < / d i v >  
                                             { M a t h . a b s ( t o t a l A s s e t s   -   t o t a l L A n d E )   >   0 . 0 1   & &   (  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # e f 4 4 4 4 ' ,   m a r g i n T o p :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                      a      B a l a n c e   c h e c k :   A s s e t s   -   ( L i a b i l i t i e s   +   E q u i t y )   =   $ { ( t o t a l A s s e t s   -   t o t a l L A n d E ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                                 < / d i v >  
                                             ) }  
                                         < / d i v >  
                                     < / d i v >  
                                 ) ;  
                             }  
                              
                             / /   M u l t i - p e r i o d   l o g i c   ( C u r r e n t   Q u a r t e r ,   L a s t   1 2   M o n t h s ,   Y T D ,   L a s t   Y e a r ,   L a s t   3   Y e a r s )  
                             e l s e   i f   ( m o n t h l y . l e n g t h   >   0   & &   s t a t e m e n t P e r i o d   ! = =   ' c u r r e n t - m o n t h ' )   {  
                                 / /   H e l p e r   f u n c t i o n   t o   g e t   m o n t h s   f o r   t h e   s e l e c t e d   p e r i o d  
                                 c o n s t   g e t M o n t h s F o r P e r i o d   =   ( )   = >   {  
                                     c o n s t   n o w   =   n e w   D a t e ( ) ;  
                                     c o n s t   c u r r e n t Y e a r   =   n o w . g e t F u l l Y e a r ( ) ;  
                                     c o n s t   c u r r e n t M o n t h   =   n o w . g e t M o n t h ( ) ;   / /   0 - 1 1  
                                      
                                     s w i t c h   ( s t a t e m e n t P e r i o d )   {  
                                         c a s e   ' c u r r e n t - q u a r t e r ' :  
                                             / /   L a s t   3   m o n t h s  
                                             r e t u r n   m o n t h l y . s l i c e ( - 3 ) ;  
                                          
                                         c a s e   ' l a s t - 1 2 - m o n t h s ' :  
                                             / /   L a s t   1 2   m o n t h s  
                                             r e t u r n   m o n t h l y . s l i c e ( - 1 2 ) ;  
                                          
                                         c a s e   ' y t d ' :  
                                             / /   Y e a r   t o   d a t e   -   f r o m   J a n u a r y   o f   c u r r e n t   y e a r   t o   n o w  
                                             r e t u r n   m o n t h l y . f i l t e r ( m   = >   {  
                                                 c o n s t   m D a t e   =   n e w   D a t e ( m . d a t e   | |   m . m o n t h ) ;  
                                                 r e t u r n   m D a t e . g e t F u l l Y e a r ( )   = = =   c u r r e n t Y e a r ;  
                                             } ) ;  
                                          
                                         c a s e   ' l a s t - y e a r ' :  
                                             / /   F u l l   p r e v i o u s   y e a r  
                                             r e t u r n   m o n t h l y . f i l t e r ( m   = >   {  
                                                 c o n s t   m D a t e   =   n e w   D a t e ( m . d a t e   | |   m . m o n t h ) ;  
                                                 r e t u r n   m D a t e . g e t F u l l Y e a r ( )   = = =   c u r r e n t Y e a r   -   1 ;  
                                             } ) ;  
                                          
                                         c a s e   ' l a s t - 3 - y e a r s ' :  
                                             / /   L a s t   3 6   m o n t h s  
                                             r e t u r n   m o n t h l y . s l i c e ( - 3 6 ) ;  
                                          
                                         d e f a u l t :  
                                             r e t u r n   [ ] ;  
                                     }  
                                 } ;  
                                  
                                 c o n s t   p e r i o d M o n t h s   =   g e t M o n t h s F o r P e r i o d ( ) ;  
                                  
                                 i f   ( p e r i o d M o n t h s . l e n g t h   = = =   0 )   {  
                                     r e t u r n   (  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 4 8 p x   3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   m i n H e i g h t :   ' 4 0 0 p x ' ,   t e x t A l i g n :   ' c e n t e r '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                                  x `  N o   D a t a   A v a i l a b l e  
                                             < / d i v >  
                                             < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 9 4 a 3 b 8 '   } } >  
                                                 N o   f i n a n c i a l   d a t a   a v a i l a b l e   f o r   t h e   s e l e c t e d   p e r i o d .  
                                             < / p >  
                                         < / d i v >  
                                     ) ;  
                                 }  
                                  
                                 / /   G e t   p e r i o d   l a b e l  
                                 c o n s t   g e t P e r i o d L a b e l   =   ( )   = >   {  
                                     c o n s t   f i r s t M o n t h   =   p e r i o d M o n t h s [ 0 ] ;  
                                     c o n s t   l a s t M o n t h   =   p e r i o d M o n t h s [ p e r i o d M o n t h s . l e n g t h   -   1 ] ;  
                                     c o n s t   f i r s t D a t e   =   n e w   D a t e ( f i r s t M o n t h . d a t e   | |   f i r s t M o n t h . m o n t h ) ;  
                                     c o n s t   l a s t D a t e   =   n e w   D a t e ( l a s t M o n t h . d a t e   | |   l a s t M o n t h . m o n t h ) ;  
                                      
                                     s w i t c h   ( s t a t e m e n t P e r i o d )   {  
                                         c a s e   ' c u r r e n t - q u a r t e r ' :  
                                             r e t u r n   ` C u r r e n t   Q u a r t e r   ( $ { f i r s t D a t e . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' s h o r t ' ,   y e a r :   ' n u m e r i c '   } ) }   -   $ { l a s t D a t e . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' s h o r t ' ,   y e a r :   ' n u m e r i c '   } ) } ) ` ;  
                                         c a s e   ' l a s t - 1 2 - m o n t h s ' :  
                                             r e t u r n   ` L a s t   1 2   M o n t h s   ( $ { f i r s t D a t e . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' s h o r t ' ,   y e a r :   ' n u m e r i c '   } ) }   -   $ { l a s t D a t e . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' s h o r t ' ,   y e a r :   ' n u m e r i c '   } ) } ) ` ;  
                                         c a s e   ' y t d ' :  
                                             r e t u r n   ` Y e a r   t o   D a t e   $ { l a s t D a t e . g e t F u l l Y e a r ( ) }   ( J a n   -   $ { l a s t D a t e . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' s h o r t '   } ) } ) ` ;  
                                         c a s e   ' l a s t - y e a r ' :  
                                             r e t u r n   ` F i s c a l   Y e a r   $ { f i r s t D a t e . g e t F u l l Y e a r ( ) } ` ;  
                                         c a s e   ' l a s t - 3 - y e a r s ' :  
                                             r e t u r n   ` L a s t   3   Y e a r s   ( $ { f i r s t D a t e . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' s h o r t ' ,   y e a r :   ' n u m e r i c '   } ) }   -   $ { l a s t D a t e . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' s h o r t ' ,   y e a r :   ' n u m e r i c '   } ) } ) ` ;  
                                         d e f a u l t :  
                                             r e t u r n   ' ' ;  
                                     }  
                                 } ;  
                                  
                             c o n s t   p e r i o d L a b e l   =   g e t P e r i o d L a b e l ( ) ;  
                             c o n s t   l a t e s t M o n t h   =   p e r i o d M o n t h s [ p e r i o d M o n t h s . l e n g t h   -   1 ] ;  
                              
                             / /   H e l p e r   f u n c t i o n   t o   g r o u p   m o n t h s   b y   d i s p l a y   p e r i o d  
                             c o n s t   g r o u p M o n t h s B y D i s p l a y   =   ( )   = >   {  
                                 i f   ( s t a t e m e n t D i s p l a y   = = =   ' m o n t h l y ' )   {  
                                     r e t u r n   p e r i o d M o n t h s . m a p ( m   = >   ( {  
                                         l a b e l :   n e w   D a t e ( m . d a t e   | |   m . m o n t h ) . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' s h o r t ' ,   y e a r :   ' n u m e r i c '   } ) ,  
                                         m o n t h s :   [ m ]  
                                     } ) ) ;  
                                 }   e l s e   i f   ( s t a t e m e n t D i s p l a y   = = =   ' q u a r t e r l y ' )   {  
                                     c o n s t   q u a r t e r s :   {   [ k e y :   s t r i n g ] :   a n y [ ]   }   =   { } ;  
                                     p e r i o d M o n t h s . f o r E a c h ( m   = >   {  
                                         c o n s t   d a t e   =   n e w   D a t e ( m . d a t e   | |   m . m o n t h ) ;  
                                         c o n s t   y e a r   =   d a t e . g e t F u l l Y e a r ( ) ;  
                                         c o n s t   q u a r t e r   =   M a t h . f l o o r ( d a t e . g e t M o n t h ( )   /   3 )   +   1 ;  
                                         c o n s t   k e y   =   ` $ { y e a r } - Q $ { q u a r t e r } ` ;  
                                         i f   ( ! q u a r t e r s [ k e y ] )   q u a r t e r s [ k e y ]   =   [ ] ;  
                                         q u a r t e r s [ k e y ] . p u s h ( m ) ;  
                                     } ) ;  
                                     r e t u r n   O b j e c t . e n t r i e s ( q u a r t e r s ) . m a p ( ( [ k e y ,   m o n t h s ] )   = >   ( {  
                                         l a b e l :   k e y ,  
                                         m o n t h s  
                                     } ) ) ;  
                                 }   e l s e   {  
                                     c o n s t   y e a r s :   {   [ k e y :   s t r i n g ] :   a n y [ ]   }   =   { } ;  
                                     p e r i o d M o n t h s . f o r E a c h ( m   = >   {  
                                         c o n s t   y e a r   =   n e w   D a t e ( m . d a t e   | |   m . m o n t h ) . g e t F u l l Y e a r ( ) . t o S t r i n g ( ) ;  
                                         i f   ( ! y e a r s [ y e a r ] )   y e a r s [ y e a r ]   =   [ ] ;  
                                         y e a r s [ y e a r ] . p u s h ( m ) ;  
                                     } ) ;  
                                     r e t u r n   O b j e c t . e n t r i e s ( y e a r s ) . m a p ( ( [ y e a r ,   m o n t h s ] )   = >   ( {  
                                         l a b e l :   y e a r ,  
                                         m o n t h s  
                                     } ) ) ;  
                                 }  
                             } ;  
                              
                             c o n s t   d i s p l a y P e r i o d s   =   g r o u p M o n t h s B y D i s p l a y ( ) ;  
                              
                             / /   I N C O M E   S T A T E M E N T   -   A g g r e g a t e   a c r o s s   p e r i o d  
                             i f   ( s t a t e m e n t T y p e   = = =   ' i n c o m e - s t a t e m e n t ' )   {  
                                 / /   C h e c k   i f   s h o w i n g   m u l t i p l e   p e r i o d s   s i d e - b y - s i d e  
                                 i f   ( d i s p l a y P e r i o d s . l e n g t h   >   1 )   {  
                                     c o n s t   c a l c   =   ( m o n t h s :   a n y [ ] ,   f i e l d :   s t r i n g )   = >   m o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m [ f i e l d ]   | |   0 ) ,   0 ) ;  
                                     c o n s t   p e r i o d s D a t a   =   d i s p l a y P e r i o d s . m a p ( p   = >   {  
                                         c o n s t   m   =   p . m o n t h s ;  
                                         c o n s t   c o g s P a y r o l l   =   c a l c ( m ,   ' c o g s P a y r o l l ' ) ;  
                                         c o n s t   c o g s O w n e r P a y   =   c a l c ( m ,   ' c o g s O w n e r P a y ' ) ;  
                                         c o n s t   c o g s C o n t r a c t o r s   =   c a l c ( m ,   ' c o g s C o n t r a c t o r s ' ) ;  
                                         c o n s t   c o g s M a t e r i a l s   =   c a l c ( m ,   ' c o g s M a t e r i a l s ' ) ;  
                                         c o n s t   c o g s C o m m i s s i o n s   =   c a l c ( m ,   ' c o g s C o m m i s s i o n s ' ) ;  
                                         c o n s t   c o g s O t h e r   =   c a l c ( m ,   ' c o g s O t h e r ' ) ;  
                                         c o n s t   o p e x P a y r o l l   =   c a l c ( m ,   ' o p e x P a y r o l l ' ) ;  
                                         c o n s t   o w n e r s B a s e P a y   =   c a l c ( m ,   ' o w n e r s B a s e P a y ' ) ;  
                                         c o n s t   o w n e r s R e t i r e m e n t   =   c a l c ( m ,   ' o w n e r s R e t i r e m e n t ' ) ;  
                                         c o n s t   p r o f e s s i o n a l S e r v i c e s   =   c a l c ( m ,   ' p r o f e s s i o n a l S e r v i c e s ' ) ;  
                                         c o n s t   r e n t L e a s e   =   c a l c ( m ,   ' r e n t L e a s e ' ) ;  
                                         c o n s t   u t i l i t i e s   =   c a l c ( m ,   ' u t i l i t i e s ' ) ;  
                                         c o n s t   e q u i p m e n t   =   c a l c ( m ,   ' e q u i p m e n t ' ) ;  
                                         c o n s t   t r a v e l   =   c a l c ( m ,   ' t r a v e l ' ) ;  
                                         c o n s t   i n s u r a n c e   =   c a l c ( m ,   ' i n s u r a n c e ' ) ;  
                                         c o n s t   o p e x S a l e s M a r k e t i n g   =   c a l c ( m ,   ' o p e x S a l e s M a r k e t i n g ' ) ;  
                                         c o n s t   c o n t r a c t o r s D i s t r i b u t i o n   =   c a l c ( m ,   ' c o n t r a c t o r s D i s t r i b u t i o n ' ) ;  
                                         c o n s t   d e p r e c i a t i o n E x p e n s e   =   c a l c ( m ,   ' d e p r e c i a t i o n E x p e n s e ' ) ;  
                                         c o n s t   o p e x O t h e r   =   c a l c ( m ,   ' o p e x O t h e r ' ) ;  
                                         c o n s t   r e v e n u e   =   c a l c ( m ,   ' r e v e n u e ' ) ;  
                                         c o n s t   c o g s   =   c o g s P a y r o l l   +   c o g s O w n e r P a y   +   c o g s C o n t r a c t o r s   +   c o g s M a t e r i a l s   +   c o g s C o m m i s s i o n s   +   c o g s O t h e r ;  
                                         c o n s t   g r o s s P r o f i t   =   r e v e n u e   -   c o g s ;  
                                         c o n s t   t o t a l O p e x   =   o p e x P a y r o l l   +   o w n e r s B a s e P a y   +   o w n e r s R e t i r e m e n t   +   p r o f e s s i o n a l S e r v i c e s   +   r e n t L e a s e   +   u t i l i t i e s   +   e q u i p m e n t   +   t r a v e l   +   i n s u r a n c e   +   o p e x S a l e s M a r k e t i n g   +   c o n t r a c t o r s D i s t r i b u t i o n   +   d e p r e c i a t i o n E x p e n s e   +   o p e x O t h e r ;  
                                         c o n s t   o p e r a t i n g I n c o m e   =   g r o s s P r o f i t   -   t o t a l O p e x ;  
                                         c o n s t   i n t e r e s t E x p e n s e   =   c a l c ( m ,   ' i n t e r e s t E x p e n s e ' ) ;  
                                         c o n s t   n o n O p e r a t i n g I n c o m e   =   c a l c ( m ,   ' n o n O p e r a t i n g I n c o m e ' ) ;  
                                         c o n s t   e x t r a o r d i n a r y I t e m s   =   c a l c ( m ,   ' e x t r a o r d i n a r y I t e m s ' ) ;  
                                         c o n s t   n e t I n c o m e   =   o p e r a t i n g I n c o m e   -   i n t e r e s t E x p e n s e   +   n o n O p e r a t i n g I n c o m e   +   e x t r a o r d i n a r y I t e m s ;  
                                         r e t u r n   {   l a b e l :   p . l a b e l ,   r e v e n u e ,   c o g s P a y r o l l ,   c o g s O w n e r P a y ,   c o g s C o n t r a c t o r s ,   c o g s M a t e r i a l s ,   c o g s C o m m i s s i o n s ,   c o g s O t h e r ,   c o g s ,   g r o s s P r o f i t ,   o p e x P a y r o l l ,   o w n e r s B a s e P a y ,   o w n e r s R e t i r e m e n t ,   p r o f e s s i o n a l S e r v i c e s ,   r e n t L e a s e ,   u t i l i t i e s ,   e q u i p m e n t ,   t r a v e l ,   i n s u r a n c e ,   o p e x S a l e s M a r k e t i n g ,   c o n t r a c t o r s D i s t r i b u t i o n ,   d e p r e c i a t i o n E x p e n s e ,   o p e x O t h e r ,   t o t a l O p e x ,   o p e r a t i n g I n c o m e ,   i n t e r e s t E x p e n s e ,   n o n O p e r a t i n g I n c o m e ,   e x t r a o r d i n a r y I t e m s ,   n e t I n c o m e   } ;  
                                     } ) ;  
                                     c o n s t   R o w   =   ( {   l a b e l ,   v a l u e s ,   i n d e n t   =   0 ,   b o l d   =   f a l s e   } :   a n y )   = >   (  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   b o l d   ?   ' 1 4 p x '   :   ' 1 3 p x ' ,   f o n t W e i g h t :   b o l d   ?   ' 6 0 0 '   :   ' n o r m a l '   } } >  
                                             < d i v   s t y l e = { {   c o l o r :   b o l d   ?   ' # 4 7 5 5 6 9 '   :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ` $ { i n d e n t } p x `   } } > { l a b e l } < / d i v >  
                                             { v a l u e s . m a p ( ( v :   n u m b e r ,   i :   n u m b e r )   = >   (  
                                                 < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   b o l d   ?   ' # 4 7 5 5 6 9 '   :   ' # 6 4 7 4 8 b '   } } > $ { ( v   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                             ) ) }  
                                         < / d i v >  
                                     ) ;  
                                     r e t u r n   (  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   o v e r f l o w X :   ' a u t o '   } } >  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 1 6 p x '   } } >  
                                                 < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > C o m p a r a t i v e   I n c o m e   S t a t e m e n t < / h 2 >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { p e r i o d L a b e l }   -   { s t a t e m e n t D i s p l a y   = = =   ' m o n t h l y '   ?   ' M o n t h l y '   :   s t a t e m e n t D i s p l a y   = = =   ' q u a r t e r l y '   ?   ' Q u a r t e r l y '   :   ' A n n u a l ' } < / d i v >  
                                             < / d i v >  
                                             < d i v   s t y l e = { {   m i n W i d t h :   ` $ { 2 0 0   +   ( p e r i o d s D a t a . l e n g t h   *   1 1 0 ) } p x `   } } >  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 2 p x   0 ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # 1 e 2 9 3 b ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } >  
                                                     < d i v > L i n e   I t e m < / d i v >  
                                                     { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > { p . l a b e l } < / d i v > ) }  
                                                 < / d i v >  
                                                 < R o w   l a b e l = " R e v e n u e "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . r e v e n u e ) }   b o l d   / >  
                                                 < d i v   s t y l e = { {   m a r g i n :   ' 8 p x   0   4 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C o s t   o f   G o o d s   S o l d < / d i v >  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . c o g s P a y r o l l   >   0 )   & &   < R o w   l a b e l = " C O G S   -   P a y r o l l "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . c o g s P a y r o l l ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . c o g s O w n e r P a y   >   0 )   & &   < R o w   l a b e l = " C O G S   -   O w n e r   P a y "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . c o g s O w n e r P a y ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . c o g s C o n t r a c t o r s   >   0 )   & &   < R o w   l a b e l = " C O G S   -   C o n t r a c t o r s "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . c o g s C o n t r a c t o r s ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . c o g s M a t e r i a l s   >   0 )   & &   < R o w   l a b e l = " C O G S   -   M a t e r i a l s "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . c o g s M a t e r i a l s ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . c o g s C o m m i s s i o n s   >   0 )   & &   < R o w   l a b e l = " C O G S   -   C o m m i s s i o n s "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . c o g s C o m m i s s i o n s ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . c o g s O t h e r   >   0 )   & &   < R o w   l a b e l = " C O G S   -   O t h e r "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . c o g s O t h e r ) }   i n d e n t = { 2 0 }   / > }  
                                                 < R o w   l a b e l = " T o t a l   C O G S "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . c o g s ) }   b o l d   / >  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 0 p x   8 p x ' ,   b a c k g r o u n d :   ' # d b e a f e ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   m a r g i n :   ' 8 p x   0 ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } >  
                                                     < d i v > G r o s s   P r o f i t < / d i v >  
                                                     { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > $ { ( p . g r o s s P r o f i t   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v > ) }  
                                                 < / d i v >  
                                                 < d i v   s t y l e = { {   m a r g i n :   ' 1 2 p x   0   4 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > O p e r a t i n g   E x p e n s e s < / d i v >  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . o p e x P a y r o l l   >   0 )   & &   < R o w   l a b e l = " P a y r o l l "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . o p e x P a y r o l l ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . o w n e r s B a s e P a y   >   0 )   & &   < R o w   l a b e l = " O w n e r ' s   B a s e   P a y "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . o w n e r s B a s e P a y ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . o w n e r s R e t i r e m e n t   >   0 )   & &   < R o w   l a b e l = " O w n e r ' s   R e t i r e m e n t "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . o w n e r s R e t i r e m e n t ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . p r o f e s s i o n a l S e r v i c e s   >   0 )   & &   < R o w   l a b e l = " P r o f e s s i o n a l   S e r v i c e s "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . p r o f e s s i o n a l S e r v i c e s ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . r e n t L e a s e   >   0 )   & &   < R o w   l a b e l = " R e n t / L e a s e "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . r e n t L e a s e ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . u t i l i t i e s   >   0 )   & &   < R o w   l a b e l = " U t i l i t i e s "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . u t i l i t i e s ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . e q u i p m e n t   >   0 )   & &   < R o w   l a b e l = " E q u i p m e n t "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . e q u i p m e n t ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . t r a v e l   >   0 )   & &   < R o w   l a b e l = " T r a v e l "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . t r a v e l ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . i n s u r a n c e   >   0 )   & &   < R o w   l a b e l = " I n s u r a n c e "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . i n s u r a n c e ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . o p e x S a l e s M a r k e t i n g   >   0 )   & &   < R o w   l a b e l = " S a l e s   &   M a r k e t i n g "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . o p e x S a l e s M a r k e t i n g ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . c o n t r a c t o r s D i s t r i b u t i o n   >   0 )   & &   < R o w   l a b e l = " C o n t r a c t o r s   -   D i s t r i b u t i o n "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . c o n t r a c t o r s D i s t r i b u t i o n ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . d e p r e c i a t i o n E x p e n s e   >   0 )   & &   < R o w   l a b e l = " D e p r e c i a t i o n   &   A m o r t i z a t i o n "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . d e p r e c i a t i o n E x p e n s e ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . o p e x O t h e r   >   0 )   & &   < R o w   l a b e l = " O t h e r   O p e r a t i n g   E x p e n s e s "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . o p e x O t h e r ) }   i n d e n t = { 2 0 }   / > }  
                                                 < R o w   l a b e l = " T o t a l   O p e r a t i n g   E x p e n s e s "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . t o t a l O p e x ) }   b o l d   / >  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 0 p x   8 p x ' ,   b a c k g r o u n d :   ' # d b e a f e ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   m a r g i n :   ' 8 p x   0 ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } >  
                                                     < d i v > O p e r a t i n g   I n c o m e < / d i v >  
                                                     { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > $ { ( p . o p e r a t i n g I n c o m e   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v > ) }  
                                                 < / d i v >  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . i n t e r e s t E x p e n s e   >   0   | |   p . n o n O p e r a t i n g I n c o m e   >   0   | |   p . e x t r a o r d i n a r y I t e m s   ! = =   0 )   & &   (  
                                                     < >  
                                                         < d i v   s t y l e = { {   m a r g i n :   ' 1 2 p x   0   4 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > O t h e r   I n c o m e / ( E x p e n s e ) < / d i v >  
                                                         { p e r i o d s D a t a . s o m e ( p   = >   p . i n t e r e s t E x p e n s e   >   0 )   & &   < R o w   l a b e l = " I n t e r e s t   E x p e n s e "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   - p . i n t e r e s t E x p e n s e ) }   i n d e n t = { 2 0 }   / > }  
                                                         { p e r i o d s D a t a . s o m e ( p   = >   p . n o n O p e r a t i n g I n c o m e   >   0 )   & &   < R o w   l a b e l = " N o n - O p e r a t i n g   I n c o m e "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . n o n O p e r a t i n g I n c o m e ) }   i n d e n t = { 2 0 }   / > }  
                                                         { p e r i o d s D a t a . s o m e ( p   = >   p . e x t r a o r d i n a r y I t e m s   ! = =   0 )   & &   < R o w   l a b e l = " E x t r a o r d i n a r y   I t e m s "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . e x t r a o r d i n a r y I t e m s ) }   i n d e n t = { 2 0 }   / > }  
                                                     < / >  
                                                 ) }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 2 p x   8 p x ' ,   b a c k g r o u n d :   ' # d c f c e 7 ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   m a r g i n :   ' 1 2 p x   0   0 ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 5 p x '   } } >  
                                                     < d i v   s t y l e = { {   c o l o r :   ' # 1 6 6 5 3 4 '   } } > N e t   I n c o m e < / d i v >  
                                                     { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                         < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   p . n e t I n c o m e   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b '   } } >  
                                                             { p . n e t I n c o m e   > =   0   ?   ' $ '   :   ' ( $ ' } { ( M a t h . a b s ( p . n e t I n c o m e )   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K { p . n e t I n c o m e   <   0   ?   ' ) '   :   ' ' }  
                                                         < / d i v >  
                                                     ) ) }  
                                                 < / d i v >  
                                             < / d i v >  
                                         < / d i v >  
                                     ) ;  
                                 }  
                                  
                                 / /   S u m   a l l   i n c o m e   s t a t e m e n t   i t e m s  
                                 c o n s t   r e v e n u e   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . r e v e n u e   | |   0 ) ,   0 ) ;  
                                      
                                     c o n s t   c o g s P a y r o l l   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s P a y r o l l   | |   0 ) ,   0 ) ;  
                                     c o n s t   c o g s O w n e r P a y   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s O w n e r P a y   | |   0 ) ,   0 ) ;  
                                     c o n s t   c o g s C o n t r a c t o r s   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s C o n t r a c t o r s   | |   0 ) ,   0 ) ;  
                                     c o n s t   c o g s M a t e r i a l s   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s M a t e r i a l s   | |   0 ) ,   0 ) ;  
                                     c o n s t   c o g s C o m m i s s i o n s   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s C o m m i s s i o n s   | |   0 ) ,   0 ) ;  
                                     c o n s t   c o g s O t h e r   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s O t h e r   | |   0 ) ,   0 ) ;  
                                     c o n s t   c o g s   =   c o g s P a y r o l l   +   c o g s O w n e r P a y   +   c o g s C o n t r a c t o r s   +   c o g s M a t e r i a l s   +   c o g s C o m m i s s i o n s   +   c o g s O t h e r ;  
                                      
                                     c o n s t   g r o s s P r o f i t   =   r e v e n u e   -   c o g s ;  
                                     c o n s t   g r o s s M a r g i n   =   r e v e n u e   >   0   ?   ( g r o s s P r o f i t   /   r e v e n u e )   *   1 0 0   :   0 ;  
                                      
                                     c o n s t   o p e x P a y r o l l   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . o p e x P a y r o l l   | |   0 ) ,   0 ) ;  
                                     c o n s t   o w n e r s B a s e P a y   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . o w n e r s B a s e P a y   | |   0 ) ,   0 ) ;  
                                     c o n s t   o w n e r s R e t i r e m e n t   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . o w n e r s R e t i r e m e n t   | |   0 ) ,   0 ) ;  
                                     c o n s t   p r o f e s s i o n a l S e r v i c e s   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . p r o f e s s i o n a l S e r v i c e s   | |   0 ) ,   0 ) ;  
                                     c o n s t   r e n t L e a s e   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . r e n t L e a s e   | |   0 ) ,   0 ) ;  
                                     c o n s t   u t i l i t i e s   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . u t i l i t i e s   | |   0 ) ,   0 ) ;  
                                     c o n s t   e q u i p m e n t   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . e q u i p m e n t   | |   0 ) ,   0 ) ;  
                                     c o n s t   t r a v e l   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . t r a v e l   | |   0 ) ,   0 ) ;  
                                     c o n s t   i n s u r a n c e   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . i n s u r a n c e   | |   0 ) ,   0 ) ;  
                                     c o n s t   o p e x S a l e s M a r k e t i n g   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . o p e x S a l e s M a r k e t i n g   | |   0 ) ,   0 ) ;  
                                     c o n s t   c o n t r a c t o r s D i s t r i b u t i o n   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o n t r a c t o r s D i s t r i b u t i o n   | |   0 ) ,   0 ) ;  
                                     c o n s t   d e p r e c i a t i o n E x p e n s e   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . d e p r e c i a t i o n E x p e n s e   | |   0 ) ,   0 ) ;  
                                     c o n s t   o p e x O t h e r   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . o p e x O t h e r   | |   0 ) ,   0 ) ;  
                                      
                                     c o n s t   t o t a l O p e x   =   o p e x P a y r o l l   +   o w n e r s B a s e P a y   +   o w n e r s R e t i r e m e n t   +   p r o f e s s i o n a l S e r v i c e s   +    
                                                                       r e n t L e a s e   +   u t i l i t i e s   +   e q u i p m e n t   +   t r a v e l   +   i n s u r a n c e   +    
                                                                       o p e x S a l e s M a r k e t i n g   +   c o n t r a c t o r s D i s t r i b u t i o n   +   d e p r e c i a t i o n E x p e n s e   +   o p e x O t h e r ;  
                                      
                                     c o n s t   o p e r a t i n g I n c o m e   =   g r o s s P r o f i t   -   t o t a l O p e x ;  
                                     c o n s t   o p e r a t i n g M a r g i n   =   r e v e n u e   >   0   ?   ( o p e r a t i n g I n c o m e   /   r e v e n u e )   *   1 0 0   :   0 ;  
                                      
                                     c o n s t   i n t e r e s t E x p e n s e   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . i n t e r e s t E x p e n s e   | |   0 ) ,   0 ) ;  
                                     c o n s t   n o n O p e r a t i n g I n c o m e   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . n o n O p e r a t i n g I n c o m e   | |   0 ) ,   0 ) ;  
                                     c o n s t   e x t r a o r d i n a r y I t e m s   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . e x t r a o r d i n a r y I t e m s   | |   0 ) ,   0 ) ;  
                                      
                                     c o n s t   n e t I n c o m e   =   o p e r a t i n g I n c o m e   -   i n t e r e s t E x p e n s e   +   n o n O p e r a t i n g I n c o m e   +   e x t r a o r d i n a r y I t e m s ;  
                                     c o n s t   n e t M a r g i n   =   r e v e n u e   >   0   ?   ( n e t I n c o m e   /   r e v e n u e )   *   1 0 0   :   0 ;  
                                      
                                     r e t u r n   (  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                                 < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 1 6 p x '   } } >  
                                                     < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > I n c o m e   S t a t e m e n t < / h 2 >  
                                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > F o r   t h e   P e r i o d :   { p e r i o d L a b e l } < / d i v >  
                                                 < / d i v >  
  
                                                 { / *   R e v e n u e   S e c t i o n   * / }  
                                                 < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 8 p x   0 ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                         < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > R e v e n u e < / s p a n >  
                                                         < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { r e v e n u e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 < / d i v >  
  
                                                 { / *   C O G S   S e c t i o n   * / }  
                                                 < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                                     < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > C o s t   o f   G o o d s   S o l d < / d i v >  
                                                     { c o g s P a y r o l l   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C O G S   -   P a y r o l l < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o g s P a y r o l l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { c o g s O w n e r P a y   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C O G S   -   O w n e r   P a y < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o g s O w n e r P a y . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { c o g s C o n t r a c t o r s   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C O G S   -   C o n t r a c t o r s < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o g s C o n t r a c t o r s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { c o g s M a t e r i a l s   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C O G S   -   M a t e r i a l s < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o g s M a t e r i a l s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { c o g s C o m m i s s i o n s   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C O G S   -   C o m m i s s i o n s < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o g s C o m m i s s i o n s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { c o g s O t h e r   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C O G S   -   O t h e r < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o g s O t h e r . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 8 p x   0 ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > T o t a l   C O G S < / s p a n >  
                                                         < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { c o g s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 < / d i v >  
  
                                                 { / *   G r o s s   P r o f i t   * / }  
                                                 < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # d b e a f e ' ,   p a d d i n g :   ' 1 2 p x ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } > G r o s s   P r o f i t < / s p a n >  
                                                         < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } > $ { g r o s s P r o f i t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 1 e 4 0 a f ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                         { g r o s s M a r g i n . t o F i x e d ( 1 ) } %   m a r g i n  
                                                     < / d i v >  
                                                 < / d i v >  
  
                                                 { / *   O p e r a t i n g   E x p e n s e s   * / }  
                                                 < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                                     < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > O p e r a t i n g   E x p e n s e s < / d i v >  
                                                     { o p e x P a y r o l l   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > P a y r o l l < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { o p e x P a y r o l l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { o w n e r s B a s e P a y   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > O w n e r ' s   B a s e   P a y < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { o w n e r s B a s e P a y . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { o w n e r s R e t i r e m e n t   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > O w n e r ' s   R e t i r e m e n t < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { o w n e r s R e t i r e m e n t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { p r o f e s s i o n a l S e r v i c e s   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > P r o f e s s i o n a l   S e r v i c e s < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { p r o f e s s i o n a l S e r v i c e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { r e n t L e a s e   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > R e n t / L e a s e < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { r e n t L e a s e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { u t i l i t i e s   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > U t i l i t i e s < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { u t i l i t i e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { e q u i p m e n t   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > E q u i p m e n t < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { e q u i p m e n t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { t r a v e l   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T r a v e l < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { t r a v e l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { i n s u r a n c e   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > I n s u r a n c e < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { i n s u r a n c e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { o p e x S a l e s M a r k e t i n g   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > S a l e s   &   M a r k e t i n g < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { o p e x S a l e s M a r k e t i n g . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { c o n t r a c t o r s D i s t r i b u t i o n   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C o n t r a c t o r s   -   D i s t r i b u t i o n < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o n t r a c t o r s D i s t r i b u t i o n . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { d e p r e c i a t i o n E x p e n s e   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > D e p r e c i a t i o n   &   A m o r t i z a t i o n < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { d e p r e c i a t i o n E x p e n s e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { o p e x O t h e r   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > O t h e r   O p e r a t i n g   E x p e n s e s < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { o p e x O t h e r . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 8 p x   0 ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > T o t a l   O p e r a t i n g   E x p e n s e s < / s p a n >  
                                                         < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { t o t a l O p e x . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 < / d i v >  
  
                                                 { / *   O p e r a t i n g   I n c o m e   * / }  
                                                 < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # d b e a f e ' ,   p a d d i n g :   ' 1 2 p x ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } > O p e r a t i n g   I n c o m e < / s p a n >  
                                                         < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } > $ { o p e r a t i n g I n c o m e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 1 e 4 0 a f ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                         { o p e r a t i n g M a r g i n . t o F i x e d ( 1 ) } %   o p e r a t i n g   m a r g i n  
                                                     < / d i v >  
                                                 < / d i v >  
  
                                                 { / *   O t h e r   I n c o m e / E x p e n s e   * / }  
                                                 < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                                     < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > O t h e r   I n c o m e / ( E x p e n s e ) < / d i v >  
                                                     { i n t e r e s t E x p e n s e   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > I n t e r e s t   E x p e n s e < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > ( $ {   i n t e r e s t E x p e n s e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } ) < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { n o n O p e r a t i n g I n c o m e   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > N o n - O p e r a t i n g   I n c o m e < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { n o n O p e r a t i n g I n c o m e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { e x t r a o r d i n a r y I t e m s   ! = =   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > E x t r a o r d i n a r y   I t e m s < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > { e x t r a o r d i n a r y I t e m s   > =   0   ?   ' $ '   :   ' ( $ ' } { M a t h . a b s ( e x t r a o r d i n a r y I t e m s ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } { e x t r a o r d i n a r y I t e m s   <   0   ?   ' ) '   :   ' ' } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                 < / d i v >  
  
                                                 { / *   N e t   I n c o m e   * / }  
                                                 < d i v   s t y l e = { {   b a c k g r o u n d :   n e t I n c o m e   > =   0   ?   ' # d c f c e 7 '   :   ' # f e e 2 e 2 ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   m a r g i n T o p :   ' 2 4 p x '   } } >  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   n e t I n c o m e   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b '   } } > N e t   I n c o m e < / s p a n >  
                                                         < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   n e t I n c o m e   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b '   } } >  
                                                             { n e t I n c o m e   > =   0   ?   ' $ '   :   ' ( $ ' } { M a t h . a b s ( n e t I n c o m e ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } { n e t I n c o m e   <   0   ?   ' ) '   :   ' ' }  
                                                         < / s p a n >  
                                                     < / d i v >  
                                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   n e t I n c o m e   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                         { n e t M a r g i n . t o F i x e d ( 1 ) } %   n e t   m a r g i n  
                                                     < / d i v >  
                                                 < / d i v >  
                                         < / d i v >  
                                     ) ;  
                                 }  
                                  
                                 / /   C O M M O N   S I Z E   I N C O M E   S T A T E M E N T   -   A g g r e g a t e   w i t h   p e r c e n t a g e s  
                                 e l s e   i f   ( s t a t e m e n t T y p e   = = =   ' i n c o m e - s t a t e m e n t - p e r c e n t ' )   {  
                                     / /   C h e c k   i f   s h o w i n g   m u l t i p l e   p e r i o d s   s i d e - b y - s i d e  
                                     i f   ( d i s p l a y P e r i o d s . l e n g t h   >   1 )   {  
                                         c o n s t   c a l c   =   ( m o n t h s :   a n y [ ] ,   f i e l d :   s t r i n g )   = >   m o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m [ f i e l d ]   | |   0 ) ,   0 ) ;  
                                         c o n s t   p e r i o d s D a t a   =   d i s p l a y P e r i o d s . m a p ( p   = >   {  
                                             c o n s t   m   =   p . m o n t h s ;  
                                             c o n s t   r e v e n u e   =   c a l c ( m ,   ' r e v e n u e ' ) ;  
                                             c o n s t   c o g s P a y r o l l   =   c a l c ( m ,   ' c o g s P a y r o l l ' ) ;  
                                             c o n s t   c o g s O w n e r P a y   =   c a l c ( m ,   ' c o g s O w n e r P a y ' ) ;  
                                             c o n s t   c o g s C o n t r a c t o r s   =   c a l c ( m ,   ' c o g s C o n t r a c t o r s ' ) ;  
                                             c o n s t   c o g s M a t e r i a l s   =   c a l c ( m ,   ' c o g s M a t e r i a l s ' ) ;  
                                             c o n s t   c o g s C o m m i s s i o n s   =   c a l c ( m ,   ' c o g s C o m m i s s i o n s ' ) ;  
                                             c o n s t   c o g s O t h e r   =   c a l c ( m ,   ' c o g s O t h e r ' ) ;  
                                             c o n s t   o p e x P a y r o l l   =   c a l c ( m ,   ' o p e x P a y r o l l ' ) ;  
                                             c o n s t   o w n e r s B a s e P a y   =   c a l c ( m ,   ' o w n e r s B a s e P a y ' ) ;  
                                             c o n s t   o w n e r s R e t i r e m e n t   =   c a l c ( m ,   ' o w n e r s R e t i r e m e n t ' ) ;  
                                             c o n s t   p r o f e s s i o n a l S e r v i c e s   =   c a l c ( m ,   ' p r o f e s s i o n a l S e r v i c e s ' ) ;  
                                             c o n s t   r e n t L e a s e   =   c a l c ( m ,   ' r e n t L e a s e ' ) ;  
                                             c o n s t   u t i l i t i e s   =   c a l c ( m ,   ' u t i l i t i e s ' ) ;  
                                             c o n s t   e q u i p m e n t   =   c a l c ( m ,   ' e q u i p m e n t ' ) ;  
                                             c o n s t   t r a v e l   =   c a l c ( m ,   ' t r a v e l ' ) ;  
                                             c o n s t   i n s u r a n c e   =   c a l c ( m ,   ' i n s u r a n c e ' ) ;  
                                             c o n s t   o p e x S a l e s M a r k e t i n g   =   c a l c ( m ,   ' o p e x S a l e s M a r k e t i n g ' ) ;  
                                             c o n s t   c o n t r a c t o r s D i s t r i b u t i o n   =   c a l c ( m ,   ' c o n t r a c t o r s D i s t r i b u t i o n ' ) ;  
                                             c o n s t   d e p r e c i a t i o n E x p e n s e   =   c a l c ( m ,   ' d e p r e c i a t i o n E x p e n s e ' ) ;  
                                             c o n s t   o p e x O t h e r   =   c a l c ( m ,   ' o p e x O t h e r ' ) ;  
                                             c o n s t   i n t e r e s t E x p e n s e   =   c a l c ( m ,   ' i n t e r e s t E x p e n s e ' ) ;  
                                             c o n s t   n o n O p e r a t i n g I n c o m e   =   c a l c ( m ,   ' n o n O p e r a t i n g I n c o m e ' ) ;  
                                             c o n s t   e x t r a o r d i n a r y I t e m s   =   c a l c ( m ,   ' e x t r a o r d i n a r y I t e m s ' ) ;  
                                             c o n s t   c o g s   =   c o g s P a y r o l l   +   c o g s O w n e r P a y   +   c o g s C o n t r a c t o r s   +   c o g s M a t e r i a l s   +   c o g s C o m m i s s i o n s   +   c o g s O t h e r ;  
                                             c o n s t   t o t a l O p e x   =   o p e x P a y r o l l   +   o w n e r s B a s e P a y   +   o w n e r s R e t i r e m e n t   +   p r o f e s s i o n a l S e r v i c e s   +   r e n t L e a s e   +   u t i l i t i e s   +   e q u i p m e n t   +   t r a v e l   +   i n s u r a n c e   +   o p e x S a l e s M a r k e t i n g   +   c o n t r a c t o r s D i s t r i b u t i o n   +   d e p r e c i a t i o n E x p e n s e   +   o p e x O t h e r ;  
                                             c o n s t   g r o s s P r o f i t   =   r e v e n u e   -   c o g s ;  
                                             c o n s t   o p e r a t i n g I n c o m e   =   g r o s s P r o f i t   -   t o t a l O p e x ;  
                                             c o n s t   n e t I n c o m e   =   o p e r a t i n g I n c o m e   -   i n t e r e s t E x p e n s e   +   n o n O p e r a t i n g I n c o m e   +   e x t r a o r d i n a r y I t e m s ;  
                                             r e t u r n   {   l a b e l :   p . l a b e l ,   r e v e n u e ,   c o g s P a y r o l l ,   c o g s O w n e r P a y ,   c o g s C o n t r a c t o r s ,   c o g s M a t e r i a l s ,   c o g s C o m m i s s i o n s ,   c o g s O t h e r ,   c o g s ,   g r o s s P r o f i t ,   o p e x P a y r o l l ,   o w n e r s B a s e P a y ,   o w n e r s R e t i r e m e n t ,   p r o f e s s i o n a l S e r v i c e s ,   r e n t L e a s e ,   u t i l i t i e s ,   e q u i p m e n t ,   t r a v e l ,   i n s u r a n c e ,   o p e x S a l e s M a r k e t i n g ,   c o n t r a c t o r s D i s t r i b u t i o n ,   d e p r e c i a t i o n E x p e n s e ,   o p e x O t h e r ,   t o t a l O p e x ,   o p e r a t i n g I n c o m e ,   i n t e r e s t E x p e n s e ,   n o n O p e r a t i n g I n c o m e ,   e x t r a o r d i n a r y I t e m s ,   n e t I n c o m e   } ;  
                                         } ) ;  
                                         c o n s t   R o w W i t h P e r c e n t   =   ( {   l a b e l ,   v a l u e s ,   i n d e n t   =   0 ,   b o l d   =   f a l s e   } :   a n y )   = >   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   9 0 p x   6 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   b o l d   ?   ' 1 4 p x '   :   ' 1 3 p x ' ,   f o n t W e i g h t :   b o l d   ?   ' 6 0 0 '   :   ' n o r m a l '   } } >  
                                                 < d i v   s t y l e = { {   c o l o r :   b o l d   ?   ' # 4 7 5 5 6 9 '   :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ` $ { i n d e n t } p x `   } } > { l a b e l } < / d i v >  
                                                 { v a l u e s . m a p ( ( v :   n u m b e r ,   i :   n u m b e r )   = >   {  
                                                     c o n s t   p c t   =   p e r i o d s D a t a [ i ] . r e v e n u e   >   0   ?   ( v   /   p e r i o d s D a t a [ i ] . r e v e n u e )   *   1 0 0   :   0 ;  
                                                     r e t u r n   (  
                                                         < d i v   k e y = { i }   s t y l e = { {   d i s p l a y :   ' c o n t e n t s '   } } >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   b o l d   ?   ' # 4 7 5 5 6 9 '   :   ' # 6 4 7 4 8 b '   } } > $ { ( v   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   f o n t S i z e :   ' 1 2 p x '   } } > { p c t . t o F i x e d ( 1 ) } % < / d i v >  
                                                         < / d i v >  
                                                     ) ;  
                                                 } ) }  
                                             < / d i v >  
                                         ) ;  
                                         r e t u r n   (  
                                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   o v e r f l o w X :   ' a u t o '   } } >  
                                                 < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 1 6 p x '   } } >  
                                                     < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > C o m p a r a t i v e   C o m m o n   S i z e   I n c o m e   S t a t e m e n t < / h 2 >  
                                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { p e r i o d L a b e l }   -   { s t a t e m e n t D i s p l a y   = = =   ' m o n t h l y '   ?   ' M o n t h l y '   :   s t a t e m e n t D i s p l a y   = = =   ' q u a r t e r l y '   ?   ' Q u a r t e r l y '   :   ' A n n u a l ' } < / d i v >  
                                                 < / d i v >  
                                                 < d i v   s t y l e = { {   m i n W i d t h :   ` $ { 2 0 0   +   ( p e r i o d s D a t a . l e n g t h   *   1 5 0 ) } p x `   } } >  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   9 0 p x   6 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 2 p x   0 ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # 1 e 2 9 3 b ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } >  
                                                     < d i v > L i n e   I t e m < / d i v >  
                                                     { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                         < d i v   k e y = { i }   s t y l e = { {   d i s p l a y :   ' c o n t e n t s '   } } >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > { p . l a b e l } < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   f o n t S i z e :   ' 1 2 p x '   } } > %   o f   R e v < / d i v >  
                                                         < / d i v >  
                                                     ) ) }  
                                                     < / d i v >  
                                                     < R o w W i t h P e r c e n t   l a b e l = " R e v e n u e "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . r e v e n u e ) }   b o l d   / >  
                                                     < d i v   s t y l e = { {   m a r g i n :   ' 8 p x   0   4 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C o s t   o f   G o o d s   S o l d < / d i v >  
                                                     { p e r i o d s D a t a . s o m e ( p   = >   p . c o g s P a y r o l l   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " C O G S   -   P a y r o l l "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . c o g s P a y r o l l ) }   i n d e n t = { 2 0 }   / > }  
                                                     { p e r i o d s D a t a . s o m e ( p   = >   p . c o g s O w n e r P a y   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " C O G S   -   O w n e r   P a y "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . c o g s O w n e r P a y ) }   i n d e n t = { 2 0 }   / > }  
                                                     { p e r i o d s D a t a . s o m e ( p   = >   p . c o g s C o n t r a c t o r s   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " C O G S   -   C o n t r a c t o r s "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . c o g s C o n t r a c t o r s ) }   i n d e n t = { 2 0 }   / > }  
                                                     { p e r i o d s D a t a . s o m e ( p   = >   p . c o g s M a t e r i a l s   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " C O G S   -   M a t e r i a l s "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . c o g s M a t e r i a l s ) }   i n d e n t = { 2 0 }   / > }  
                                                     { p e r i o d s D a t a . s o m e ( p   = >   p . c o g s C o m m i s s i o n s   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " C O G S   -   C o m m i s s i o n s "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . c o g s C o m m i s s i o n s ) }   i n d e n t = { 2 0 }   / > }  
                                                     { p e r i o d s D a t a . s o m e ( p   = >   p . c o g s O t h e r   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " C O G S   -   O t h e r "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . c o g s O t h e r ) }   i n d e n t = { 2 0 }   / > }  
                                                     < R o w W i t h P e r c e n t   l a b e l = " T o t a l   C O G S "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . c o g s ) }   b o l d   / >  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   9 0 p x   6 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 0 p x   8 p x ' ,   b a c k g r o u n d :   ' # d b e a f e ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   m a r g i n :   ' 8 p x   0 ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } >  
                                                         < d i v > G r o s s   P r o f i t < / d i v >  
                                                         { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   {  
                                                             c o n s t   p c t   =   p . r e v e n u e   >   0   ?   ( p . g r o s s P r o f i t   /   p . r e v e n u e )   *   1 0 0   :   0 ;  
                                                             r e t u r n   (  
                                                                 < d i v   k e y = { i }   s t y l e = { {   d i s p l a y :   ' c o n t e n t s '   } } >  
                                                                     < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > $ { ( p . g r o s s P r o f i t   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                                     < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   f o n t S i z e :   ' 1 2 p x '   } } > { p c t . t o F i x e d ( 1 ) } % < / d i v >  
                                                                 < / d i v >  
                                                             ) ;  
                                                         } ) }  
                                                     < / d i v >  
                                                     < d i v   s t y l e = { {   m a r g i n :   ' 1 2 p x   0   4 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > O p e r a t i n g   E x p e n s e s < / d i v >  
                                                     { p e r i o d s D a t a . s o m e ( p   = >   p . o p e x P a y r o l l   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " P a y r o l l "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . o p e x P a y r o l l ) }   i n d e n t = { 2 0 }   / > }  
                                                     { p e r i o d s D a t a . s o m e ( p   = >   p . o w n e r s B a s e P a y   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " O w n e r ' s   B a s e   P a y "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . o w n e r s B a s e P a y ) }   i n d e n t = { 2 0 }   / > }  
                                                     { p e r i o d s D a t a . s o m e ( p   = >   p . o w n e r s R e t i r e m e n t   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " O w n e r ' s   R e t i r e m e n t "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . o w n e r s R e t i r e m e n t ) }   i n d e n t = { 2 0 }   / > }  
                                                     { p e r i o d s D a t a . s o m e ( p   = >   p . p r o f e s s i o n a l S e r v i c e s   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " P r o f e s s i o n a l   S e r v i c e s "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . p r o f e s s i o n a l S e r v i c e s ) }   i n d e n t = { 2 0 }   / > }  
                                                     { p e r i o d s D a t a . s o m e ( p   = >   p . r e n t L e a s e   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " R e n t / L e a s e "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . r e n t L e a s e ) }   i n d e n t = { 2 0 }   / > }  
                                                     { p e r i o d s D a t a . s o m e ( p   = >   p . u t i l i t i e s   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " U t i l i t i e s "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . u t i l i t i e s ) }   i n d e n t = { 2 0 }   / > }  
                                                     { p e r i o d s D a t a . s o m e ( p   = >   p . e q u i p m e n t   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " E q u i p m e n t "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . e q u i p m e n t ) }   i n d e n t = { 2 0 }   / > }  
                                                     { p e r i o d s D a t a . s o m e ( p   = >   p . t r a v e l   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " T r a v e l "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . t r a v e l ) }   i n d e n t = { 2 0 }   / > }  
                                                     { p e r i o d s D a t a . s o m e ( p   = >   p . i n s u r a n c e   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " I n s u r a n c e "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . i n s u r a n c e ) }   i n d e n t = { 2 0 }   / > }  
                                                     { p e r i o d s D a t a . s o m e ( p   = >   p . o p e x S a l e s M a r k e t i n g   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " S a l e s   &   M a r k e t i n g "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . o p e x S a l e s M a r k e t i n g ) }   i n d e n t = { 2 0 }   / > }  
                                                     { p e r i o d s D a t a . s o m e ( p   = >   p . c o n t r a c t o r s D i s t r i b u t i o n   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " C o n t r a c t o r s   -   D i s t r i b u t i o n "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . c o n t r a c t o r s D i s t r i b u t i o n ) }   i n d e n t = { 2 0 }   / > }  
                                                     { p e r i o d s D a t a . s o m e ( p   = >   p . d e p r e c i a t i o n E x p e n s e   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " D e p r e c i a t i o n   &   A m o r t i z a t i o n "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . d e p r e c i a t i o n E x p e n s e ) }   i n d e n t = { 2 0 }   / > }  
                                                     { p e r i o d s D a t a . s o m e ( p   = >   p . o p e x O t h e r   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " O t h e r   O p e r a t i n g   E x p e n s e s "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . o p e x O t h e r ) }   i n d e n t = { 2 0 }   / > }  
                                                     < R o w W i t h P e r c e n t   l a b e l = " T o t a l   O p e r a t i n g   E x p e n s e s "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . t o t a l O p e x ) }   b o l d   / >  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   9 0 p x   6 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 0 p x   8 p x ' ,   b a c k g r o u n d :   ' # d b e a f e ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   m a r g i n :   ' 8 p x   0 ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } >  
                                                         < d i v > O p e r a t i n g   I n c o m e < / d i v >  
                                                         { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   {  
                                                             c o n s t   p c t   =   p . r e v e n u e   >   0   ?   ( p . o p e r a t i n g I n c o m e   /   p . r e v e n u e )   *   1 0 0   :   0 ;  
                                                             r e t u r n   (  
                                                                 < d i v   k e y = { i }   s t y l e = { {   d i s p l a y :   ' c o n t e n t s '   } } >  
                                                                     < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > $ { ( p . o p e r a t i n g I n c o m e   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                                     < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   f o n t S i z e :   ' 1 2 p x '   } } > { p c t . t o F i x e d ( 1 ) } % < / d i v >  
                                                                 < / d i v >  
                                                             ) ;  
                                                         } ) }  
                                                     < / d i v >  
                                                     { p e r i o d s D a t a . s o m e ( p   = >   p . i n t e r e s t E x p e n s e   >   0   | |   p . n o n O p e r a t i n g I n c o m e   >   0   | |   p . e x t r a o r d i n a r y I t e m s   ! = =   0 )   & &   (  
                                                         < >  
                                                             < d i v   s t y l e = { {   m a r g i n :   ' 1 2 p x   0   4 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > O t h e r   I n c o m e / ( E x p e n s e ) < / d i v >  
                                                             { p e r i o d s D a t a . s o m e ( p   = >   p . i n t e r e s t E x p e n s e   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " I n t e r e s t   E x p e n s e "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   - p . i n t e r e s t E x p e n s e ) }   i n d e n t = { 2 0 }   / > }  
                                                             { p e r i o d s D a t a . s o m e ( p   = >   p . n o n O p e r a t i n g I n c o m e   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " N o n - O p e r a t i n g   I n c o m e "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . n o n O p e r a t i n g I n c o m e ) }   i n d e n t = { 2 0 }   / > }  
                                                             { p e r i o d s D a t a . s o m e ( p   = >   p . e x t r a o r d i n a r y I t e m s   ! = =   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " E x t r a o r d i n a r y   I t e m s "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . e x t r a o r d i n a r y I t e m s ) }   i n d e n t = { 2 0 }   / > }  
                                                         < / >  
                                                     ) }  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   9 0 p x   6 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 2 p x   8 p x ' ,   b a c k g r o u n d :   ' # d c f c e 7 ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   m a r g i n :   ' 1 2 p x   0   0 ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 5 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 1 6 6 5 3 4 '   } } > N e t   I n c o m e < / d i v >  
                                                         { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   {  
                                                             c o n s t   p c t   =   p . r e v e n u e   >   0   ?   ( p . n e t I n c o m e   /   p . r e v e n u e )   *   1 0 0   :   0 ;  
                                                             r e t u r n   (  
                                                                 < d i v   k e y = { i }   s t y l e = { {   d i s p l a y :   ' c o n t e n t s '   } } >  
                                                                     < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   p . n e t I n c o m e   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b '   } } >  
                                                                         { p . n e t I n c o m e   > =   0   ?   ' $ '   :   ' ( $ ' } { ( M a t h . a b s ( p . n e t I n c o m e )   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K { p . n e t I n c o m e   <   0   ?   ' ) '   :   ' ' }  
                                                                     < / d i v >  
                                                                     < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   p . n e t I n c o m e   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b '   } } > { p c t . t o F i x e d ( 1 ) } % < / d i v >  
                                                                 < / d i v >  
                                                             ) ;  
                                                         } ) }  
                                                     < / d i v >  
                                                 < / d i v >  
                                             < / d i v >  
                                         ) ;  
                                     }  
                                      
                                     c o n s t   r e v e n u e   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . r e v e n u e   | |   0 ) ,   0 ) ;  
                                      
                                     c o n s t   c o g s P a y r o l l   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s P a y r o l l   | |   0 ) ,   0 ) ;  
                                     c o n s t   c o g s O w n e r P a y   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s O w n e r P a y   | |   0 ) ,   0 ) ;  
                                     c o n s t   c o g s C o n t r a c t o r s   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s C o n t r a c t o r s   | |   0 ) ,   0 ) ;  
                                     c o n s t   c o g s M a t e r i a l s   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s M a t e r i a l s   | |   0 ) ,   0 ) ;  
                                     c o n s t   c o g s C o m m i s s i o n s   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s C o m m i s s i o n s   | |   0 ) ,   0 ) ;  
                                     c o n s t   c o g s O t h e r   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s O t h e r   | |   0 ) ,   0 ) ;  
                                     c o n s t   c o g s   =   c o g s P a y r o l l   +   c o g s O w n e r P a y   +   c o g s C o n t r a c t o r s   +   c o g s M a t e r i a l s   +   c o g s C o m m i s s i o n s   +   c o g s O t h e r ;  
                                      
                                     c o n s t   g r o s s P r o f i t   =   r e v e n u e   -   c o g s ;  
                                      
                                     c o n s t   o p e x P a y r o l l   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . o p e x P a y r o l l   | |   0 ) ,   0 ) ;  
                                     c o n s t   o w n e r s B a s e P a y   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . o w n e r s B a s e P a y   | |   0 ) ,   0 ) ;  
                                     c o n s t   o w n e r s R e t i r e m e n t   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . o w n e r s R e t i r e m e n t   | |   0 ) ,   0 ) ;  
                                     c o n s t   p r o f e s s i o n a l S e r v i c e s   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . p r o f e s s i o n a l S e r v i c e s   | |   0 ) ,   0 ) ;  
                                     c o n s t   r e n t L e a s e   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . r e n t L e a s e   | |   0 ) ,   0 ) ;  
                                     c o n s t   u t i l i t i e s   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . u t i l i t i e s   | |   0 ) ,   0 ) ;  
                                     c o n s t   e q u i p m e n t   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . e q u i p m e n t   | |   0 ) ,   0 ) ;  
                                     c o n s t   t r a v e l   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . t r a v e l   | |   0 ) ,   0 ) ;  
                                     c o n s t   i n s u r a n c e   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . i n s u r a n c e   | |   0 ) ,   0 ) ;  
                                     c o n s t   o p e x S a l e s M a r k e t i n g   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . o p e x S a l e s M a r k e t i n g   | |   0 ) ,   0 ) ;  
                                     c o n s t   c o n t r a c t o r s D i s t r i b u t i o n   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o n t r a c t o r s D i s t r i b u t i o n   | |   0 ) ,   0 ) ;  
                                     c o n s t   d e p r e c i a t i o n E x p e n s e   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . d e p r e c i a t i o n E x p e n s e   | |   0 ) ,   0 ) ;  
                                     c o n s t   o p e x O t h e r   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . o p e x O t h e r   | |   0 ) ,   0 ) ;  
                                      
                                     c o n s t   t o t a l O p e x   =   o p e x P a y r o l l   +   o w n e r s B a s e P a y   +   o w n e r s R e t i r e m e n t   +   p r o f e s s i o n a l S e r v i c e s   +    
                                                                       r e n t L e a s e   +   u t i l i t i e s   +   e q u i p m e n t   +   t r a v e l   +   i n s u r a n c e   +    
                                                                       o p e x S a l e s M a r k e t i n g   +   c o n t r a c t o r s D i s t r i b u t i o n   +   d e p r e c i a t i o n E x p e n s e   +   o p e x O t h e r ;  
                                      
                                     c o n s t   o p e r a t i n g I n c o m e   =   g r o s s P r o f i t   -   t o t a l O p e x ;  
                                      
                                     c o n s t   i n t e r e s t E x p e n s e   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . i n t e r e s t E x p e n s e   | |   0 ) ,   0 ) ;  
                                     c o n s t   n o n O p e r a t i n g I n c o m e   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . n o n O p e r a t i n g I n c o m e   | |   0 ) ,   0 ) ;  
                                     c o n s t   e x t r a o r d i n a r y I t e m s   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . e x t r a o r d i n a r y I t e m s   | |   0 ) ,   0 ) ;  
                                      
                                     c o n s t   n e t I n c o m e   =   o p e r a t i n g I n c o m e   -   i n t e r e s t E x p e n s e   +   n o n O p e r a t i n g I n c o m e   +   e x t r a o r d i n a r y I t e m s ;  
                                      
                                     c o n s t   c a l c P e r c e n t   =   ( v a l u e :   n u m b e r )   = >   r e v e n u e   >   0   ?   ( ( v a l u e   /   r e v e n u e )   *   1 0 0 ) . t o F i x e d ( 1 )   +   ' % '   :   ' 0 . 0 % ' ;  
                                      
                                     r e t u r n   (  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                                 < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 1 6 p x '   } } >  
                                                     < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > C o m m o n   S i z e   I n c o m e   S t a t e m e n t < / h 2 >  
                                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > F o r   t h e   P e r i o d :   { p e r i o d L a b e l } < / d i v >  
                                                 < / d i v >  
  
                                                 { / *   H e a d e r   R o w   * / }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 1 2 p x   0 ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } >  
                                                     < d i v > L i n e   I t e m < / d i v >  
                                                     < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > A m o u n t < / d i v >  
                                                     < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > %   o f   R e v e n u e < / d i v >  
                                                 < / d i v >  
  
                                                 { / *   R e v e n u e   * / }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 8 p x   0 ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                     < d i v   s t y l e = { {   c o l o r :   ' # 1 e 2 9 3 b '   } } > R e v e n u e < / d i v >  
                                                     < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { r e v e n u e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                     < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > 1 0 0 . 0 % < / d i v >  
                                                 < / d i v >  
  
                                                 { / *   C O G S   * / }  
                                                 < d i v   s t y l e = { {   m a r g i n T o p :   ' 1 6 p x '   } } >  
                                                     < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } > C o s t   o f   G o o d s   S o l d < / d i v >  
                                                     { c o g s P a y r o l l   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > C O G S   -   P a y r o l l < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { c o g s P a y r o l l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( c o g s P a y r o l l ) } < / d i v >  
                                                         < / d i v >  
                                                     ) }  
                                                     { c o g s O w n e r P a y   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > C O G S   -   O w n e r   P a y < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { c o g s O w n e r P a y . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( c o g s O w n e r P a y ) } < / d i v >  
                                                         < / d i v >  
                                                     ) }  
                                                     { c o g s C o n t r a c t o r s   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > C O G S   -   C o n t r a c t o r s < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { c o g s C o n t r a c t o r s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( c o g s C o n t r a c t o r s ) } < / d i v >  
                                                         < / d i v >  
                                                     ) }  
                                                     { c o g s M a t e r i a l s   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > C O G S   -   M a t e r i a l s < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { c o g s M a t e r i a l s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( c o g s M a t e r i a l s ) } < / d i v >  
                                                         < / d i v >  
                                                     ) }  
                                                     { c o g s C o m m i s s i o n s   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > C O G S   -   C o m m i s s i o n s < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { c o g s C o m m i s s i o n s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( c o g s C o m m i s s i o n s ) } < / d i v >  
                                                         < / d i v >  
                                                     ) }  
                                                     { c o g s O t h e r   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > C O G S   -   O t h e r < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { c o g s O t h e r . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( c o g s O t h e r ) } < / d i v >  
                                                         < / d i v >  
                                                     ) }  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 8 p x   0 ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   m a r g i n T o p :   ' 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T o t a l   C O G S < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o g s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > { c a l c P e r c e n t ( c o g s ) } < / d i v >  
                                                     < / d i v >  
                                                 < / d i v >  
  
                                                 { / *   G r o s s   P r o f i t   * / }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 1 2 p x   8 p x ' ,   b a c k g r o u n d :   ' # d b e a f e ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   m a r g i n :   ' 1 6 p x   0 ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } >  
                                                     < d i v > G r o s s   P r o f i t < / d i v >  
                                                     < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > $ { g r o s s P r o f i t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                     < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > { c a l c P e r c e n t ( g r o s s P r o f i t ) } < / d i v >  
                                                 < / d i v >  
  
                                                 { / *   O p e r a t i n g   E x p e n s e s   * / }  
                                                 < d i v   s t y l e = { {   m a r g i n T o p :   ' 1 6 p x '   } } >  
                                                     < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } > O p e r a t i n g   E x p e n s e s < / d i v >  
                                                     { o p e x P a y r o l l   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > P a y r o l l < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { o p e x P a y r o l l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( o p e x P a y r o l l ) } < / d i v >  
                                                         < / d i v >  
                                                     ) }  
                                                     { o w n e r s B a s e P a y   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > O w n e r ' s   B a s e   P a y < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { o w n e r s B a s e P a y . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( o w n e r s B a s e P a y ) } < / d i v >  
                                                         < / d i v >  
                                                     ) }  
                                                     { o w n e r s R e t i r e m e n t   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > O w n e r ' s   R e t i r e m e n t < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { o w n e r s R e t i r e m e n t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( o w n e r s R e t i r e m e n t ) } < / d i v >  
                                                         < / d i v >  
                                                     ) }  
                                                     { p r o f e s s i o n a l S e r v i c e s   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > P r o f e s s i o n a l   S e r v i c e s < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { p r o f e s s i o n a l S e r v i c e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( p r o f e s s i o n a l S e r v i c e s ) } < / d i v >  
                                                         < / d i v >  
                                                     ) }  
                                                     { r e n t L e a s e   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > R e n t / L e a s e < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { r e n t L e a s e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( r e n t L e a s e ) } < / d i v >  
                                                         < / d i v >  
                                                     ) }  
                                                     { u t i l i t i e s   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > U t i l i t i e s < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { u t i l i t i e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( u t i l i t i e s ) } < / d i v >  
                                                         < / d i v >  
                                                     ) }  
                                                     { e q u i p m e n t   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > E q u i p m e n t < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { e q u i p m e n t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( e q u i p m e n t ) } < / d i v >  
                                                         < / d i v >  
                                                     ) }  
                                                     { t r a v e l   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > T r a v e l < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { t r a v e l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( t r a v e l ) } < / d i v >  
                                                         < / d i v >  
                                                     ) }  
                                                     { i n s u r a n c e   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > I n s u r a n c e < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { i n s u r a n c e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( i n s u r a n c e ) } < / d i v >  
                                                         < / d i v >  
                                                     ) }  
                                                     { o p e x S a l e s M a r k e t i n g   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > S a l e s   &   M a r k e t i n g < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { o p e x S a l e s M a r k e t i n g . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( o p e x S a l e s M a r k e t i n g ) } < / d i v >  
                                                         < / d i v >  
                                                     ) }  
                                                     { c o n t r a c t o r s D i s t r i b u t i o n   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > C o n t r a c t o r s   -   D i s t r i b u t i o n < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { c o n t r a c t o r s D i s t r i b u t i o n . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( c o n t r a c t o r s D i s t r i b u t i o n ) } < / d i v >  
                                                         < / d i v >  
                                                     ) }  
                                                     { d e p r e c i a t i o n E x p e n s e   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > D e p r e c i a t i o n   &   A m o r t i z a t i o n < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { d e p r e c i a t i o n E x p e n s e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( d e p r e c i a t i o n E x p e n s e ) } < / d i v >  
                                                         < / d i v >  
                                                     ) }  
                                                     { o p e x O t h e r   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > O t h e r   O p e r a t i n g   E x p e n s e s < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { o p e x O t h e r . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( o p e x O t h e r ) } < / d i v >  
                                                         < / d i v >  
                                                     ) }  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 8 p x   0 ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   m a r g i n T o p :   ' 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T o t a l   O p e r a t i n g   E x p e n s e s < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { t o t a l O p e x . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > { c a l c P e r c e n t ( t o t a l O p e x ) } < / d i v >  
                                                     < / d i v >  
                                                 < / d i v >  
  
                                                 { / *   O p e r a t i n g   I n c o m e   * / }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 1 2 p x   8 p x ' ,   b a c k g r o u n d :   ' # d b e a f e ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   m a r g i n :   ' 1 6 p x   0 ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } >  
                                                     < d i v > O p e r a t i n g   I n c o m e < / d i v >  
                                                     < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > $ { o p e r a t i n g I n c o m e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                     < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > { c a l c P e r c e n t ( o p e r a t i n g I n c o m e ) } < / d i v >  
                                                 < / d i v >  
  
                                                 { / *   O t h e r   I n c o m e / E x p e n s e   * / }  
                                                 { ( i n t e r e s t E x p e n s e   >   0   | |   n o n O p e r a t i n g I n c o m e   >   0   | |   e x t r a o r d i n a r y I t e m s   ! = =   0 )   & &   (  
                                                     < d i v   s t y l e = { {   m a r g i n T o p :   ' 1 6 p x '   } } >  
                                                         < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } > O t h e r   I n c o m e / ( E x p e n s e ) < / d i v >  
                                                         { i n t e r e s t E x p e n s e   >   0   & &   (  
                                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                                 < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > I n t e r e s t   E x p e n s e < / d i v >  
                                                                 < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > ( $ {   i n t e r e s t E x p e n s e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } ) < / d i v >  
                                                                 < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > ( { c a l c P e r c e n t ( i n t e r e s t E x p e n s e ) } ) < / d i v >  
                                                             < / d i v >  
                                                         ) }  
                                                         { n o n O p e r a t i n g I n c o m e   >   0   & &   (  
                                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                                 < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > N o n - O p e r a t i n g   I n c o m e < / d i v >  
                                                                 < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { n o n O p e r a t i n g I n c o m e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                                 < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( n o n O p e r a t i n g I n c o m e ) } < / d i v >  
                                                             < / d i v >  
                                                         ) }  
                                                         { e x t r a o r d i n a r y I t e m s   ! = =   0   & &   (  
                                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                                 < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > E x t r a o r d i n a r y   I t e m s < / d i v >  
                                                                 < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } >  
                                                                     { e x t r a o r d i n a r y I t e m s   > =   0   ?   ' $ '   :   ' ( $ ' } { M a t h . a b s ( e x t r a o r d i n a r y I t e m s ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } { e x t r a o r d i n a r y I t e m s   <   0   ?   ' ) '   :   ' ' }  
                                                                 < / d i v >  
                                                                 < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } >  
                                                                     { e x t r a o r d i n a r y I t e m s   > =   0   ?   c a l c P e r c e n t ( e x t r a o r d i n a r y I t e m s )   :   ` ( $ { c a l c P e r c e n t ( M a t h . a b s ( e x t r a o r d i n a r y I t e m s ) ) } ) ` }  
                                                                 < / d i v >  
                                                             < / d i v >  
                                                         ) }  
                                                     < / d i v >  
                                                 ) }  
  
                                                 { / *   N e t   I n c o m e   * / }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 1 6 p x   8 p x ' ,   b a c k g r o u n d :   n e t I n c o m e   > =   0   ?   ' # d c f c e 7 '   :   ' # f e e 2 e 2 ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   m a r g i n T o p :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   n e t I n c o m e   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b '   } } >  
                                                     < d i v > N e t   I n c o m e < / d i v >  
                                                     < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } >  
                                                         { n e t I n c o m e   > =   0   ?   ' $ '   :   ' ( $ ' } { M a t h . a b s ( n e t I n c o m e ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } { n e t I n c o m e   <   0   ?   ' ) '   :   ' ' }  
                                                     < / d i v >  
                                                     < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > { c a l c P e r c e n t ( n e t I n c o m e ) } < / d i v >  
                                                 < / d i v >  
                                         < / d i v >  
                                     ) ;  
                                 }  
                                  
                                 / /   B A L A N C E   S H E E T   -   L a t e s t   p o i n t   i n   t i m e  
                                 e l s e   i f   ( s t a t e m e n t T y p e   = = =   ' b a l a n c e - s h e e t ' )   {  
                                     / /   C h e c k   i f   w e ' r e   s h o w i n g   m u l t i p l e   p e r i o d s   s i d e - b y - s i d e  
                                     i f   ( d i s p l a y P e r i o d s . l e n g t h   >   1 )   {  
                                         / /   M u l t i - c o l u m n   c o m p a r a t i v e   b a l a n c e   s h e e t  
                                         c o n s t   c a l c u l a t e B a l a n c e D a t a   =   ( m o n t h s :   a n y [ ] )   = >   {  
                                             / /   F o r   b a l a n c e   s h e e t ,   u s e   t h e   l a t e s t   m o n t h ' s   v a l u e s   ( p o i n t - i n - t i m e )  
                                             c o n s t   l a t e s t   =   m o n t h s [ m o n t h s . l e n g t h   -   1 ] ;  
                                             c o n s t   c a s h   =   l a t e s t . c a s h   | |   0 ;  
                                             c o n s t   a r   =   l a t e s t . a r   | |   0 ;  
                                             c o n s t   i n v e n t o r y   =   l a t e s t . i n v e n t o r y   | |   0 ;  
                                             c o n s t   o t h e r C A   =   l a t e s t . o t h e r C A   | |   0 ;  
                                             c o n s t   t c a   =   c a s h   +   a r   +   i n v e n t o r y   +   o t h e r C A ;  
                                              
                                             c o n s t   f i x e d A s s e t s   =   l a t e s t . f i x e d A s s e t s   | |   0 ;  
                                             c o n s t   i n t a n g i b l e A s s e t s   =   l a t e s t . i n t a n g i b l e A s s e t s   | |   0 ;  
                                             c o n s t   o t h e r N o n C u r r e n t A s s e t s   =   l a t e s t . o t h e r N o n C u r r e n t A s s e t s   | |   0 ;  
                                             c o n s t   n o n C u r r e n t A s s e t s   =   f i x e d A s s e t s   +   i n t a n g i b l e A s s e t s   +   o t h e r N o n C u r r e n t A s s e t s ;  
                                             c o n s t   t o t a l A s s e t s   =   t c a   +   n o n C u r r e n t A s s e t s ;  
                                              
                                             c o n s t   a p   =   l a t e s t . a p   | |   0 ;  
                                             c o n s t   s h o r t T e r m D e b t   =   l a t e s t . s h o r t T e r m D e b t   | |   0 ;  
                                             c o n s t   c u r r e n t P o r t i o n L T D   =   l a t e s t . c u r r e n t P o r t i o n L T D   | |   0 ;  
                                             c o n s t   o t h e r C u r r e n t L i a b i l i t i e s   =   l a t e s t . o t h e r C u r r e n t L i a b i l i t i e s   | |   0 ;  
                                             c o n s t   t o t a l C u r r e n t L i a b i l i t i e s   =   a p   +   s h o r t T e r m D e b t   +   c u r r e n t P o r t i o n L T D   +   o t h e r C u r r e n t L i a b i l i t i e s ;  
                                              
                                             c o n s t   l t d   =   l a t e s t . l t d   | |   0 ;  
                                             c o n s t   o t h e r L o n g T e r m L i a b i l i t i e s   =   l a t e s t . o t h e r L o n g T e r m L i a b i l i t i e s   | |   0 ;  
                                             c o n s t   t o t a l L o n g T e r m L i a b i l i t i e s   =   l t d   +   o t h e r L o n g T e r m L i a b i l i t i e s ;  
                                             c o n s t   t o t a l L i a b i l i t i e s   =   t o t a l C u r r e n t L i a b i l i t i e s   +   t o t a l L o n g T e r m L i a b i l i t i e s ;  
                                              
                                             c o n s t   p a i d I n C a p i t a l   =   l a t e s t . p a i d I n C a p i t a l   | |   0 ;  
                                             c o n s t   r e t a i n e d E a r n i n g s   =   l a t e s t . r e t a i n e d E a r n i n g s   | |   0 ;  
                                             c o n s t   t o t a l E q u i t y   =   p a i d I n C a p i t a l   +   r e t a i n e d E a r n i n g s ;  
                                              
                                             r e t u r n   {  
                                                 c a s h ,   a r ,   i n v e n t o r y ,   o t h e r C A ,   t c a ,  
                                                 f i x e d A s s e t s ,   i n t a n g i b l e A s s e t s ,   o t h e r N o n C u r r e n t A s s e t s ,   n o n C u r r e n t A s s e t s ,   t o t a l A s s e t s ,  
                                                 a p ,   s h o r t T e r m D e b t ,   c u r r e n t P o r t i o n L T D ,   o t h e r C u r r e n t L i a b i l i t i e s ,   t o t a l C u r r e n t L i a b i l i t i e s ,  
                                                 l t d ,   o t h e r L o n g T e r m L i a b i l i t i e s ,   t o t a l L o n g T e r m L i a b i l i t i e s ,   t o t a l L i a b i l i t i e s ,  
                                                 p a i d I n C a p i t a l ,   r e t a i n e d E a r n i n g s ,   t o t a l E q u i t y  
                                             } ;  
                                         } ;  
                                          
                                         c o n s t   b a l a n c e D a t a   =   d i s p l a y P e r i o d s . m a p ( p   = >   ( {  
                                             l a b e l :   p . l a b e l ,  
                                             . . . c a l c u l a t e B a l a n c e D a t a ( p . m o n t h s )  
                                         } ) ) ;  
                                          
                                         r e t u r n   (  
                                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   o v e r f l o w X :   ' a u t o '   } } >  
                                                 < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 1 6 p x '   } } >  
                                                     < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > C o m p a r a t i v e   B a l a n c e   S h e e t < / h 2 >  
                                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { p e r i o d L a b e l }   -   { s t a t e m e n t D i s p l a y   = = =   ' m o n t h l y '   ?   ' M o n t h l y '   :   s t a t e m e n t D i s p l a y   = = =   ' q u a r t e r l y '   ?   ' Q u a r t e r l y '   :   ' A n n u a l ' } < / d i v >  
                                                 < / d i v >  
                                                  
                                                 { / *   T a b l e   w i t h   m u l t i p l e   c o l u m n s   * / }  
                                                 < d i v   s t y l e = { {   m i n W i d t h :   ` $ { 2 0 0   +   ( b a l a n c e D a t a . l e n g t h   *   1 1 0 ) } p x `   } } >  
                                                     { / *   H e a d e r   R o w   * / }  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 2 p x   0 ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # 1 e 2 9 3 b ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   p o s i t i o n :   ' s t i c k y ' ,   t o p :   0 ,   b a c k g r o u n d :   ' w h i t e '   } } >  
                                                         < d i v > L i n e   I t e m < / d i v >  
                                                         { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > { p . l a b e l } < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                      
                                                     { / *   A S S E T S   S e c t i o n   H e a d e r   * / }  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 2 p x   0   4 p x   0 ' ,   f o n t S i z e :   ' 1 5 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   m a r g i n T o p :   ' 8 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 1 e 2 9 3 b '   } } > A S S E T S < / d i v >  
                                                         { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   < d i v   k e y = { i } > < / d i v > ) }  
                                                     < / d i v >  
                                                      
                                                     { / *   C u r r e n t   A s s e t s   H e a d e r   * / }  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 8 p x   0   4 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C u r r e n t   A s s e t s < / d i v >  
                                                         { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   < d i v   k e y = { i } > < / d i v > ) }  
                                                     < / d i v >  
                                                      
                                                     { / *   C u r r e n t   A s s e t s   D e t a i l s   * / }  
                                                     { b a l a n c e D a t a . s o m e ( p   = >   p . c a s h   >   0 )   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > C a s h   &   C a s h   E q u i v a l e n t s < / d i v >  
                                                             { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   (  
                                                                 < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . c a s h   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                             ) ) }  
                                                         < / d i v >  
                                                     ) }  
                                                     { b a l a n c e D a t a . s o m e ( p   = >   p . a r   >   0 )   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > A c c o u n t s   R e c e i v a b l e < / d i v >  
                                                             { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   (  
                                                                 < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . a r   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                             ) ) }  
                                                         < / d i v >  
                                                     ) }  
                                                     { b a l a n c e D a t a . s o m e ( p   = >   p . i n v e n t o r y   >   0 )   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > I n v e n t o r y < / d i v >  
                                                             { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   (  
                                                                 < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . i n v e n t o r y   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                             ) ) }  
                                                         < / d i v >  
                                                     ) }  
                                                     { b a l a n c e D a t a . s o m e ( p   = >   p . o t h e r C A   >   0 )   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > O t h e r   C u r r e n t   A s s e t s < / d i v >  
                                                             { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   (  
                                                                 < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . o t h e r C A   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                             ) ) }  
                                                         < / d i v >  
                                                     ) }  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T o t a l   C u r r e n t   A s s e t s < / d i v >  
                                                         { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { ( p . t c a   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                      
                                                     { / *   N o n - C u r r e n t   A s s e t s   H e a d e r   * / }  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 8 p x   0   4 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   m a r g i n T o p :   ' 8 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > N o n - C u r r e n t   A s s e t s < / d i v >  
                                                         { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   < d i v   k e y = { i } > < / d i v > ) }  
                                                     < / d i v >  
                                                      
                                                     { b a l a n c e D a t a . s o m e ( p   = >   p . f i x e d A s s e t s   >   0 )   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > P r o p e r t y ,   P l a n t   &   E q u i p m e n t < / d i v >  
                                                             { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   (  
                                                                 < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . f i x e d A s s e t s   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                             ) ) }  
                                                         < / d i v >  
                                                     ) }  
                                                     { b a l a n c e D a t a . s o m e ( p   = >   p . i n t a n g i b l e A s s e t s   >   0 )   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > I n t a n g i b l e   A s s e t s < / d i v >  
                                                             { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   (  
                                                                 < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . i n t a n g i b l e A s s e t s   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                             ) ) }  
                                                         < / d i v >  
                                                     ) }  
                                                     { b a l a n c e D a t a . s o m e ( p   = >   p . o t h e r N o n C u r r e n t A s s e t s   >   0 )   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > O t h e r   N o n - C u r r e n t   A s s e t s < / d i v >  
                                                             { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   (  
                                                                 < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . o t h e r N o n C u r r e n t A s s e t s   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                             ) ) }  
                                                         < / d i v >  
                                                     ) }  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T o t a l   N o n - C u r r e n t   A s s e t s < / d i v >  
                                                         { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { ( p . n o n C u r r e n t A s s e t s   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                      
                                                     { / *   T O T A L   A S S E T S   * / }  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 0 p x   8 p x ' ,   b a c k g r o u n d :   ' # d b e a f e ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   m a r g i n T o p :   ' 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 1 e 4 0 a f '   } } > T O T A L   A S S E T S < / d i v >  
                                                         { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } > $ { ( p . t o t a l A s s e t s   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                      
                                                     { / *   L I A B I L I T I E S   S e c t i o n   H e a d e r   * / }  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 2 p x   0   4 p x   0 ' ,   f o n t S i z e :   ' 1 5 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   m a r g i n T o p :   ' 1 6 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 1 e 2 9 3 b '   } } > L I A B I L I T I E S < / d i v >  
                                                         { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   < d i v   k e y = { i } > < / d i v > ) }  
                                                     < / d i v >  
                                                      
                                                     { / *   C u r r e n t   L i a b i l i t i e s   H e a d e r   * / }  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 8 p x   0   4 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C u r r e n t   L i a b i l i t i e s < / d i v >  
                                                         { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   < d i v   k e y = { i } > < / d i v > ) }  
                                                     < / d i v >  
                                                      
                                                     { b a l a n c e D a t a . s o m e ( p   = >   p . a p   >   0 )   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > A c c o u n t s   P a y a b l e < / d i v >  
                                                             { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   (  
                                                                 < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . a p   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                             ) ) }  
                                                         < / d i v >  
                                                     ) }  
                                                     { b a l a n c e D a t a . s o m e ( p   = >   p . s h o r t T e r m D e b t   >   0 )   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > S h o r t - T e r m   D e b t < / d i v >  
                                                             { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   (  
                                                                 < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . s h o r t T e r m D e b t   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                             ) ) }  
                                                         < / d i v >  
                                                     ) }  
                                                     { b a l a n c e D a t a . s o m e ( p   = >   p . c u r r e n t P o r t i o n L T D   >   0 )   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > C u r r e n t   P o r t i o n   o f   L T   D e b t < / d i v >  
                                                             { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   (  
                                                                 < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . c u r r e n t P o r t i o n L T D   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                             ) ) }  
                                                         < / d i v >  
                                                     ) }  
                                                     { b a l a n c e D a t a . s o m e ( p   = >   p . o t h e r C u r r e n t L i a b i l i t i e s   >   0 )   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > O t h e r   C u r r e n t   L i a b i l i t i e s < / d i v >  
                                                             { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   (  
                                                                 < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . o t h e r C u r r e n t L i a b i l i t i e s   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                             ) ) }  
                                                         < / d i v >  
                                                     ) }  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T o t a l   C u r r e n t   L i a b i l i t i e s < / d i v >  
                                                         { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { ( p . t o t a l C u r r e n t L i a b i l i t i e s   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                      
                                                     { / *   L o n g - T e r m   L i a b i l i t i e s   H e a d e r   * / }  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 8 p x   0   4 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   m a r g i n T o p :   ' 8 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > L o n g - T e r m   L i a b i l i t i e s < / d i v >  
                                                         { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   < d i v   k e y = { i } > < / d i v > ) }  
                                                     < / d i v >  
                                                      
                                                     { b a l a n c e D a t a . s o m e ( p   = >   p . l t d   >   0 )   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > L o n g - T e r m   D e b t < / d i v >  
                                                             { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   (  
                                                                 < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . l t d   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                             ) ) }  
                                                         < / d i v >  
                                                     ) }  
                                                     { b a l a n c e D a t a . s o m e ( p   = >   p . o t h e r L o n g T e r m L i a b i l i t i e s   >   0 )   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > O t h e r   L o n g - T e r m   L i a b i l i t i e s < / d i v >  
                                                             { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   (  
                                                                 < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . o t h e r L o n g T e r m L i a b i l i t i e s   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                             ) ) }  
                                                         < / d i v >  
                                                     ) }  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T o t a l   L o n g - T e r m   L i a b i l i t i e s < / d i v >  
                                                         { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { ( p . t o t a l L o n g T e r m L i a b i l i t i e s   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                      
                                                     { / *   T O T A L   L I A B I L I T I E S   * / }  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 0 p x   8 p x ' ,   b a c k g r o u n d :   ' # f e f 3 c 7 ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   m a r g i n T o p :   ' 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 9 2 4 0 0 e '   } } > T O T A L   L I A B I L I T I E S < / d i v >  
                                                         { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 9 2 4 0 0 e '   } } > $ { ( p . t o t a l L i a b i l i t i e s   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                      
                                                     { / *   E Q U I T Y   S e c t i o n   H e a d e r   * / }  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 2 p x   0   4 p x   0 ' ,   f o n t S i z e :   ' 1 5 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   m a r g i n T o p :   ' 1 6 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 1 e 2 9 3 b '   } } > E Q U I T Y < / d i v >  
                                                         { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   < d i v   k e y = { i } > < / d i v > ) }  
                                                     < / d i v >  
                                                      
                                                     { b a l a n c e D a t a . s o m e ( p   = >   p . p a i d I n C a p i t a l   >   0 )   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > P a i d - i n   C a p i t a l < / d i v >  
                                                             { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   (  
                                                                 < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . p a i d I n C a p i t a l   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                             ) ) }  
                                                         < / d i v >  
                                                     ) }  
                                                     { b a l a n c e D a t a . s o m e ( p   = >   p . r e t a i n e d E a r n i n g s   ! = =   0 )   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > R e t a i n e d   E a r n i n g s < / d i v >  
                                                             { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   (  
                                                                 < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } >  
                                                                     { p . r e t a i n e d E a r n i n g s   > =   0   ?   ' $ '   :   ' ( $ ' } { ( M a t h . a b s ( p . r e t a i n e d E a r n i n g s )   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K { p . r e t a i n e d E a r n i n g s   <   0   ?   ' ) '   :   ' ' }  
                                                                 < / d i v >  
                                                             ) ) }  
                                                         < / d i v >  
                                                     ) }  
                                                      
                                                     { / *   T O T A L   E Q U I T Y   * / }  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 0 p x   8 p x ' ,   b a c k g r o u n d :   ' # d c f c e 7 ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   m a r g i n T o p :   ' 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 1 6 6 5 3 4 '   } } > T O T A L   E Q U I T Y < / d i v >  
                                                         { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   p . t o t a l E q u i t y   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b '   } } >  
                                                                 { p . t o t a l E q u i t y   > =   0   ?   ' $ '   :   ' ( $ ' } { ( M a t h . a b s ( p . t o t a l E q u i t y )   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K { p . t o t a l E q u i t y   <   0   ?   ' ) '   :   ' ' }  
                                                             < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                 < / d i v >  
                                             < / d i v >  
                                         ) ;  
                                     }  
                                      
                                     / /   S i n g l e   p e r i o d   b a l a n c e   s h e e t   ( o r i g i n a l   l o g i c )  
                                     c o n s t   c a s h   =   l a t e s t M o n t h . c a s h   | |   0 ;  
                                     c o n s t   a r   =   l a t e s t M o n t h . a r   | |   0 ;  
                                     c o n s t   i n v e n t o r y   =   l a t e s t M o n t h . i n v e n t o r y   | |   0 ;  
                                     c o n s t   o t h e r C A   =   l a t e s t M o n t h . o t h e r C A   | |   0 ;  
                                     c o n s t   t c a   =   c a s h   +   a r   +   i n v e n t o r y   +   o t h e r C A ;  
                                      
                                     c o n s t   f i x e d A s s e t s   =   l a t e s t M o n t h . f i x e d A s s e t s   | |   0 ;  
                                     c o n s t   i n t a n g i b l e A s s e t s   =   l a t e s t M o n t h . i n t a n g i b l e A s s e t s   | |   0 ;  
                                     c o n s t   o t h e r N o n C u r r e n t A s s e t s   =   l a t e s t M o n t h . o t h e r N o n C u r r e n t A s s e t s   | |   0 ;  
                                     c o n s t   n o n C u r r e n t A s s e t s   =   f i x e d A s s e t s   +   i n t a n g i b l e A s s e t s   +   o t h e r N o n C u r r e n t A s s e t s ;  
                                      
                                     c o n s t   t o t a l A s s e t s   =   t c a   +   n o n C u r r e n t A s s e t s ;  
                                      
                                     c o n s t   a p   =   l a t e s t M o n t h . a p   | |   0 ;  
                                     c o n s t   s h o r t T e r m D e b t   =   l a t e s t M o n t h . s h o r t T e r m D e b t   | |   0 ;  
                                     c o n s t   c u r r e n t P o r t i o n L T D   =   l a t e s t M o n t h . c u r r e n t P o r t i o n L T D   | |   0 ;  
                                     c o n s t   o t h e r C u r r e n t L i a b i l i t i e s   =   l a t e s t M o n t h . o t h e r C u r r e n t L i a b i l i t i e s   | |   0 ;  
                                     c o n s t   t o t a l C u r r e n t L i a b i l i t i e s   =   a p   +   s h o r t T e r m D e b t   +   c u r r e n t P o r t i o n L T D   +   o t h e r C u r r e n t L i a b i l i t i e s ;  
                                      
                                     c o n s t   l t d   =   l a t e s t M o n t h . l t d   | |   0 ;  
                                     c o n s t   o t h e r L o n g T e r m L i a b i l i t i e s   =   l a t e s t M o n t h . o t h e r L o n g T e r m L i a b i l i t i e s   | |   0 ;  
                                     c o n s t   t o t a l L o n g T e r m L i a b i l i t i e s   =   l t d   +   o t h e r L o n g T e r m L i a b i l i t i e s ;  
                                      
                                     c o n s t   t o t a l L i a b i l i t i e s   =   t o t a l C u r r e n t L i a b i l i t i e s   +   t o t a l L o n g T e r m L i a b i l i t i e s ;  
                                      
                                     c o n s t   p a i d I n C a p i t a l   =   l a t e s t M o n t h . p a i d I n C a p i t a l   | |   0 ;  
                                     c o n s t   r e t a i n e d E a r n i n g s   =   l a t e s t M o n t h . r e t a i n e d E a r n i n g s   | |   0 ;  
                                     c o n s t   t o t a l E q u i t y   =   p a i d I n C a p i t a l   +   r e t a i n e d E a r n i n g s ;  
                                      
                                     c o n s t   t o t a l L A n d E   =   t o t a l L i a b i l i t i e s   +   t o t a l E q u i t y ;  
                                      
                                     c o n s t   l a t e s t D a t e   =   n e w   D a t e ( l a t e s t M o n t h . d a t e   | |   l a t e s t M o n t h . m o n t h ) ;  
                                     c o n s t   a s O f D a t e   =   l a t e s t D a t e . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' l o n g ' ,   d a y :   ' n u m e r i c ' ,   y e a r :   ' n u m e r i c '   } ) ;  
                                      
                                     r e t u r n   (  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 1 6 p x '   } } >  
                                                 < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > B a l a n c e   S h e e t < / h 2 >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > A s   o f   { a s O f D a t e }   ( P e r i o d :   { p e r i o d L a b e l } ) < / d i v >  
                                             < / d i v >  
  
                                             { / *   A S S E T S   * / }  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                                                 < d i v   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > A S S E T S < / d i v >  
                                                  
                                                 { / *   C u r r e n t   A s s e t s   * / }  
                                                 < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                                     < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > C u r r e n t   A s s e t s < / d i v >  
                                                     { c a s h   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > C a s h   &   C a s h   E q u i v a l e n t s < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { c a s h . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { a r   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > A c c o u n t s   R e c e i v a b l e < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { a r . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { i n v e n t o r y   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > I n v e n t o r y < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { i n v e n t o r y . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { o t h e r C A   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > O t h e r   C u r r e n t   A s s e t s < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { o t h e r C A . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 8 p x   0   8 p x   1 0 p x ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   m a r g i n T o p :   ' 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T o t a l   C u r r e n t   A s s e t s < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { t c a . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 < / d i v >  
  
                                                 { / *   N o n - C u r r e n t   A s s e t s   * / }  
                                                 < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                                     < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > N o n - C u r r e n t   A s s e t s < / d i v >  
                                                     { f i x e d A s s e t s   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > P r o p e r t y ,   P l a n t   &   E q u i p m e n t < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { f i x e d A s s e t s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { i n t a n g i b l e A s s e t s   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > I n t a n g i b l e   A s s e t s < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { i n t a n g i b l e A s s e t s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { o t h e r N o n C u r r e n t A s s e t s   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > O t h e r   N o n - C u r r e n t   A s s e t s < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { o t h e r N o n C u r r e n t A s s e t s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 8 p x   0   8 p x   1 0 p x ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   m a r g i n T o p :   ' 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T o t a l   N o n - C u r r e n t   A s s e t s < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { n o n C u r r e n t A s s e t s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 < / d i v >  
  
                                                 { / *   T O T A L   A S S E T S   * / }  
                                                 < d i v   s t y l e = { {   b a c k g r o u n d :   ' # d b e a f e ' ,   p a d d i n g :   ' 1 2 p x ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n '   } } >  
                                                         < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } > T O T A L   A S S E T S < / s p a n >  
                                                         < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } >  
                                                             $ { t o t a l A s s e t s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                                         < / s p a n >  
                                                     < / d i v >  
                                                 < / d i v >  
                                             < / d i v >  
  
                                             { / *   L I A B I L I T I E S   * / }  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                                                 < d i v   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > L I A B I L I T I E S < / d i v >  
                                                  
                                                 { / *   C u r r e n t   L i a b i l i t i e s   * / }  
                                                 < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                                     < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > C u r r e n t   L i a b i l i t i e s < / d i v >  
                                                     { a p   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > A c c o u n t s   P a y a b l e < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { a p . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { s h o r t T e r m D e b t   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > S h o r t - T e r m   D e b t < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { s h o r t T e r m D e b t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { c u r r e n t P o r t i o n L T D   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > C u r r e n t   P o r t i o n   o f   L T   D e b t < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { c u r r e n t P o r t i o n L T D . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { o t h e r C u r r e n t L i a b i l i t i e s   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > O t h e r   C u r r e n t   L i a b i l i t i e s < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { o t h e r C u r r e n t L i a b i l i t i e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 8 p x   0   8 p x   1 0 p x ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   m a r g i n T o p :   ' 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T o t a l   C u r r e n t   L i a b i l i t i e s < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { t o t a l C u r r e n t L i a b i l i t i e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 < / d i v >  
  
                                                 { / *   L o n g - T e r m   L i a b i l i t i e s   * / }  
                                                 < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                                     < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > L o n g - T e r m   L i a b i l i t i e s < / d i v >  
                                                     { l t d   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > L o n g - T e r m   D e b t < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { l t d . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     { o t h e r L o n g T e r m L i a b i l i t i e s   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > O t h e r   L o n g - T e r m   L i a b i l i t i e s < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { o t h e r L o n g T e r m L i a b i l i t i e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                         < / d i v >  
                                                     ) }  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 8 p x   0   8 p x   1 0 p x ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   m a r g i n T o p :   ' 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T o t a l   L o n g - T e r m   L i a b i l i t i e s < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { t o t a l L o n g T e r m L i a b i l i t i e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 < / d i v >  
  
                                                 { / *   T O T A L   L I A B I L I T I E S   * / }  
                                                 < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f e f 3 c 7 ' ,   p a d d i n g :   ' 1 2 p x ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n '   } } >  
                                                         < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 9 2 4 0 0 e '   } } > T O T A L   L I A B I L I T I E S < / s p a n >  
                                                         < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 9 2 4 0 0 e '   } } >  
                                                             $ { t o t a l L i a b i l i t i e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                                         < / s p a n >  
                                                     < / d i v >  
                                                 < / d i v >  
                                             < / d i v >  
  
                                             { / *   E Q U I T Y   * / }  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                                                 < d i v   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > E Q U I T Y < / d i v >  
                                                 { p a i d I n C a p i t a l   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > P a i d - i n   C a p i t a l < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { p a i d I n C a p i t a l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { r e t a i n e d E a r n i n g s   ! = =   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > R e t a i n e d   E a r n i n g s < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } >  
                                                             { r e t a i n e d E a r n i n g s   > =   0   ?   ' $ '   :   ' ( $ ' } { M a t h . a b s ( r e t a i n e d E a r n i n g s ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } { r e t a i n e d E a r n i n g s   <   0   ?   ' ) '   :   ' ' }  
                                                         < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
  
                                                 { / *   T O T A L   E Q U I T Y   * / }  
                                                 < d i v   s t y l e = { {   b a c k g r o u n d :   ' # d c f c e 7 ' ,   p a d d i n g :   ' 1 2 p x ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   m a r g i n T o p :   ' 8 p x '   } } >  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n '   } } >  
                                                         < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 1 6 6 5 3 4 '   } } > T O T A L   E Q U I T Y < / s p a n >  
                                                         < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 1 6 6 5 3 4 '   } } >  
                                                             { t o t a l E q u i t y   > =   0   ?   ' $ '   :   ' ( $ ' } { M a t h . a b s ( t o t a l E q u i t y ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } { t o t a l E q u i t y   <   0   ?   ' ) '   :   ' ' }  
                                                         < / s p a n >  
                                                     < / d i v >  
                                                 < / d i v >  
                                             < / d i v >  
  
                                             { / *   T O T A L   L I A B I L I T I E S   &   E Q U I T Y   * / }  
                                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 1 f 5 f 9 ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   m a r g i n T o p :   ' 3 2 p x '   } } >  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > T O T A L   L I A B I L I T I E S   &   E Q U I T Y < / s p a n >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } >  
                                                         $ { t o t a l L A n d E . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                                     < / s p a n >  
                                                 < / d i v >  
                                                 { M a t h . a b s ( t o t a l A s s e t s   -   t o t a l L A n d E )   >   0 . 0 1   & &   (  
                                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # e f 4 4 4 4 ' ,   m a r g i n T o p :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                          a      B a l a n c e   c h e c k :   A s s e t s   -   ( L i a b i l i t i e s   +   E q u i t y )   =   $ { ( t o t a l A s s e t s   -   t o t a l L A n d E ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                                     < / d i v >  
                                                 ) }  
                                             < / d i v >  
                                         < / d i v >  
                                     ) ;  
                                 }  
                             }  
                              
                             e l s e   {  
                                 r e t u r n   (  
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 4 8 p x   3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   m i n H e i g h t :   ' 4 0 0 p x ' ,   t e x t A l i g n :   ' c e n t e r '   } } >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                              x `  F i n a n c i a l   S t a t e m e n t   V i e w e r  
                                         < / d i v >  
                                         < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 9 4 a 3 b 8 ' ,   m a x W i d t h :   ' 6 0 0 p x ' ,   m a r g i n :   ' 0   a u t o '   } } >  
                                             { m o n t h l y . l e n g t h   = = =   0    
                                                 ?   ' N o   f i n a n c i a l   d a t a   a v a i l a b l e .   P l e a s e   i m p o r t   f i n a n c i a l   d a t a   o r   s y n c   f r o m   Q u i c k B o o k s . '  
                                                 :   ' S e l e c t   o p t i o n s   a b o v e   t o   v i e w   f i n a n c i a l   s t a t e m e n t s . ' }  
                                         < / p >  
                                     < / d i v >  
                                 ) ;  
                             }  
                         } ) ( ) }  
  
                         { / *   H i d d e n :   O l d   P & L   a n d   B a l a n c e   S h e e t   c o n t a i n e r s   -   w i l l   b e   r e m o v e d   i n   f u t u r e   u p d a t e   * / }  
                         < d i v   s t y l e = { {   d i s p l a y :   ' n o n e '   } } >  
                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   1 f r ' ,   g a p :   ' 2 4 p x '   } } >  
                             { / *   L e f t :   Q u i c k B o o k s   R a w   D a t a   * / }  
                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                             { / *   P r o f i t   &   L o s s   R e p o r t   * / }  
                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 4 8 p x '   } } >  
                                 < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 2 0 p x ' ,   p a d d i n g B o t t o m :   ' 1 2 p x ' ,   b o r d e r B o t t o m :   ' 3 p x   s o l i d   # 6 6 7 e e a '   } } > P r o f i t   &   L o s s < / h 2 >  
                                 { p l R o w s . l e n g t h   >   0   ?   (  
                                     < d i v >  
                                         { p l R o w s . m a p ( ( r o w ,   i d x )   = >   (  
                                             < d i v    
                                                 k e y = { i d x }    
                                                 s t y l e = { {    
                                                     d i s p l a y :   ' f l e x ' ,    
                                                     j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,    
                                                     p a d d i n g :   r o w . i s H e a d e r   ?   ' 1 2 p x   8 p x   8 p x '   :   ( r o w . i s T o t a l   ?   ' 1 0 p x   8 p x '   :   ' 6 p x   8 p x ' ) ,  
                                                     p a d d i n g L e f t :   ` $ { 8   +   ( r o w . l e v e l   *   2 0 ) } p x ` ,  
                                                     b o r d e r B o t t o m :   r o w . i s T o t a l   ?   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   :   ( r o w . i s H e a d e r   ?   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   :   ' n o n e ' ) ,  
                                                     b a c k g r o u n d :   r o w . i s H e a d e r   ?   ' # f 8 f a f c '   :   ( r o w . i s T o t a l   ?   ' # f 1 f 5 f 9 '   :   ' t r a n s p a r e n t ' ) ,  
                                                     f o n t W e i g h t :   r o w . i s H e a d e r   | |   r o w . i s T o t a l   ?   ' 6 0 0 '   :   ' 4 0 0 ' ,  
                                                     f o n t S i z e :   r o w . i s H e a d e r   ?   ' 1 5 p x '   :   ( r o w . i s T o t a l   ?   ' 1 4 p x '   :   ' 1 3 p x ' ) ,  
                                                     c o l o r :   r o w . i s H e a d e r   ?   ' # 1 e 2 9 3 b '   :   ( r o w . i s T o t a l   ?   ' # 0 f 1 7 2 a '   :   ' # 4 7 5 5 6 9 ' )  
                                                 } }  
                                             >  
                                                 < s p a n > { r o w . n a m e } < / s p a n >  
                                                 { ! r o w . i s H e a d e r   & &   < s p a n   s t y l e = { {   f o n t F a m i l y :   ' m o n o s p a c e ' ,   w h i t e S p a c e :   ' n o w r a p '   } } > { r o w . v a l u e } < / s p a n > }  
                                             < / d i v >  
                                         ) ) }  
                                     < / d i v >  
                                 )   :   (  
                                     < d i v   s t y l e = { {   p a d d i n g :   ' 3 2 p x ' ,   t e x t A l i g n :   ' c e n t e r ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > N o   P r o f i t   &   L o s s   d a t a   a v a i l a b l e < / d i v >  
                                 ) }  
                             < / d i v >  
  
                             { / *   B a l a n c e   S h e e t   R e p o r t   * / }  
                             < d i v >  
                                 < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 2 0 p x ' ,   p a d d i n g B o t t o m :   ' 1 2 p x ' ,   b o r d e r B o t t o m :   ' 3 p x   s o l i d   # 6 6 7 e e a '   } } > B a l a n c e   S h e e t < / h 2 >  
                                 { b s R o w s . l e n g t h   >   0   ?   (  
                                     < d i v >  
                                         { b s R o w s . m a p ( ( r o w ,   i d x )   = >   (  
                                             < d i v    
                                                 k e y = { i d x }    
                                                 s t y l e = { {    
                                                     d i s p l a y :   ' f l e x ' ,    
                                                     j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,    
                                                     p a d d i n g :   r o w . i s H e a d e r   ?   ' 1 2 p x   8 p x   8 p x '   :   ( r o w . i s T o t a l   ?   ' 1 0 p x   8 p x '   :   ' 6 p x   8 p x ' ) ,  
                                                     p a d d i n g L e f t :   ` $ { 8   +   ( r o w . l e v e l   *   2 0 ) } p x ` ,  
                                                     b o r d e r B o t t o m :   r o w . i s T o t a l   ?   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   :   ( r o w . i s H e a d e r   ?   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   :   ' n o n e ' ) ,  
                                                     b a c k g r o u n d :   r o w . i s H e a d e r   ?   ' # f 8 f a f c '   :   ( r o w . i s T o t a l   ?   ' # f 1 f 5 f 9 '   :   ' t r a n s p a r e n t ' ) ,  
                                                     f o n t W e i g h t :   r o w . i s H e a d e r   | |   r o w . i s T o t a l   ?   ' 6 0 0 '   :   ' 4 0 0 ' ,  
                                                     f o n t S i z e :   r o w . i s H e a d e r   ?   ' 1 5 p x '   :   ( r o w . i s T o t a l   ?   ' 1 4 p x '   :   ' 1 3 p x ' ) ,  
                                                     c o l o r :   r o w . i s H e a d e r   ?   ' # 1 e 2 9 3 b '   :   ( r o w . i s T o t a l   ?   ' # 0 f 1 7 2 a '   :   ' # 4 7 5 5 6 9 ' )  
                                                 } }  
                                             >  
                                                 < s p a n > { r o w . n a m e } < / s p a n >  
                                                 { ! r o w . i s H e a d e r   & &   < s p a n   s t y l e = { {   f o n t F a m i l y :   ' m o n o s p a c e ' ,   w h i t e S p a c e :   ' n o w r a p '   } } > { r o w . v a l u e } < / s p a n > }  
                                             < / d i v >  
                                         ) ) }  
                                     < / d i v >  
                                 )   :   (  
                                     < d i v   s t y l e = { {   p a d d i n g :   ' 3 2 p x ' ,   t e x t A l i g n :   ' c e n t e r ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > N o   B a l a n c e   S h e e t   d a t a   a v a i l a b l e < / d i v >  
                                 ) }  
                             < / d i v >  
                             < / d i v >  
  
                             { / *   R i g h t :   Y o u r   M i n i m a l   V i a b l e   F i n a n c i a l   S t a t e m e n t   S t r u c t u r e   * / }  
                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                 { / *   I n c o m e   S t a t e m e n t   S t r u c t u r e   * / }  
                                 < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 4 8 p x '   } } >  
                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                                         < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   p a d d i n g B o t t o m :   ' 1 2 p x ' ,   b o r d e r B o t t o m :   ' 3 p x   s o l i d   # 1 0 b 9 8 1 '   } } > I n c o m e   S t a t e m e n t   F i e l d s < / h 2 >  
                                         { q b R a w D a t a ? . p r o f i t A n d L o s s ? . H e a d e r   & &   ( ( )   = >   {  
                                             c o n s t   c o l u m n s   =   q b R a w D a t a . p r o f i t A n d L o s s . C o l u m n s ? . C o l u m n   | |   [ ] ;  
                                             c o n s t   h a s M u l t i p l e M o n t h s   =   c o l u m n s . l e n g t h   >   2 ;  
                                             c o n s t   l a s t M o n t h C o l u m n   =   h a s M u l t i p l e M o n t h s   & &   c o l u m n s . l e n g t h   > =   2   ?   c o l u m n s [ c o l u m n s . l e n g t h   -   2 ]   :   n u l l ;  
                                             c o n s t   m o n t h L a b e l   =   l a s t M o n t h C o l u m n ? . C o l T i t l e   | |   q b R a w D a t a . p r o f i t A n d L o s s . H e a d e r . E n d P e r i o d ;  
                                              
                                             r e t u r n   (  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   m a r g i n T o p :   ' 8 p x '   } } >  
                                                     < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } >  
                                                         < s t r o n g > R e p o r t   P e r i o d : < / s t r o n g >   { q b R a w D a t a . p r o f i t A n d L o s s . H e a d e r . S t a r t P e r i o d   | |   ' N / A ' }   t o   { q b R a w D a t a . p r o f i t A n d L o s s . H e a d e r . E n d P e r i o d   | |   ' N / A ' }  
                                                     < / d i v >  
                                                     < d i v   s t y l e = { {   c o l o r :   ' # 1 0 b 9 8 1 ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   m a r g i n T o p :   ' 4 p x ' ,   p a d d i n g :   ' 8 p x ' ,   b a c k g r o u n d :   ' # f 0 f d f 4 ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # 8 6 e f a c '   } } >  
                                                          x &   D i s p l a y i n g :   { h a s M u l t i p l e M o n t h s   ?   ` M o n t h l y   d a t a   f o r   $ { m o n t h L a b e l } `   :   ` P e r i o d   t o t a l   f o r   $ { m o n t h L a b e l } ` }  
                                                     < / d i v >  
                                                     { ! h a s M u l t i p l e M o n t h s   & &   (  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # f 5 9 e 0 b ' ,   f o n t W e i g h t :   ' 5 0 0 ' ,   f o n t S i z e :   ' 1 2 p x ' ,   m a r g i n T o p :   ' 4 p x ' ,   p a d d i n g :   ' 6 p x ' ,   b a c k g r o u n d :   ' # f f f b e b ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # f c d 3 4 d '   } } >  
                                                              a      N o t e :   T h i s   a p p e a r s   t o   b e   c u m u l a t i v e   f o r   t h e   e n t i r e   p e r i o d ,   n o t   m o n t h l y   b r e a k d o w n s  
                                                         < / d i v >  
                                                     ) }  
                                                 < / d i v >  
                                             ) ;  
                                         } ) ( ) }  
                                     < / d i v >  
                                      
                                     { a i M a p p i n g s . l e n g t h   >   0   ?   (  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x '   } } >  
                                             { / *   G r o u p   m a p p i n g s   b y   c a t e g o r y   * / }  
                                             { ( ( )   = >   {  
                                                 / /   D e d u p l i c a t e   m a p p i n g s   b y   Q B   a c c o u n t   n a m e   ( k e e p   f i r s t   o c c u r r e n c e )  
                                                 c o n s t   u n i q u e M a p p i n g s   =   a i M a p p i n g s . f i l t e r ( ( m ,   i n d e x ,   s e l f )   = >  
                                                     i n d e x   = = =   s e l f . f i n d I n d e x ( ( t )   = >   t . q b A c c o u n t   = = =   m . q b A c c o u n t )  
                                                 ) ;  
                                                  
                                                 c o n s t   r e v e n u e M a p p i n g s   =   u n i q u e M a p p i n g s . f i l t e r ( m   = >   [ ' R e v e n u e ' ,   ' I n c o m e ' ] . s o m e ( c   = >   m . q b A c c o u n t C l a s s i f i c a t i o n ? . i n c l u d e s ( c ) ) ) ;  
                                                 c o n s t   c o g s M a p p i n g s   =   u n i q u e M a p p i n g s . f i l t e r ( m   = >   [ ' C o s t   o f   G o o d s   S o l d ' ,   ' C O G S ' ] . s o m e ( c   = >   m . q b A c c o u n t C l a s s i f i c a t i o n ? . i n c l u d e s ( c ) ) ) ;  
                                                 c o n s t   e x p e n s e M a p p i n g s   =   u n i q u e M a p p i n g s . f i l t e r ( m   = >   m . q b A c c o u n t C l a s s i f i c a t i o n ? . i n c l u d e s ( ' E x p e n s e ' ) ) ;  
                                                  
                                                 / /   H e l p e r   t o   g e t   a m o u n t   -   e x t r a c t   f r o m   t h e   a p p r o p r i a t e   c o l u m n  
                                                 c o n s t   g e t A m o u n t   =   ( q b A c c o u n t N a m e :   s t r i n g )   = >   {  
                                                     i f   ( ! q b R a w D a t a )   r e t u r n   0 ;  
                                                     c o n s t   e x t r a c t R o w s   =   ( r e p o r t D a t a :   a n y )   = >   {  
                                                         c o n s t   r e s u l t :   a n y [ ]   =   [ ] ;  
                                                         i f   ( ! r e p o r t D a t a   | |   ! r e p o r t D a t a . R o w s   | |   ! r e p o r t D a t a . R o w s . R o w )   r e t u r n   r e s u l t ;  
                                                          
                                                         c o n s t   p r o c e s s R o w   =   ( r o w :   a n y )   = >   {  
                                                             i f   ( r o w . t y p e   = = =   ' D a t a '   & &   r o w . C o l D a t a )   {  
                                                                 c o n s t   n a m e   =   r o w . C o l D a t a [ 0 ] ? . v a l u e   | |   ' ' ;  
                                                                 i f   ( n a m e )   {  
                                                                     / /   T r y   t o   f i n d   a   n u m e r i c   v a l u e   f r o m   t h e   c o l u m n s  
                                                                     / /   S t a r t   f r o m   t h e   e n d   a n d   w o r k   b a c k w a r d s   t o   f i n d   t h e   f i r s t   v a l i d   n u m b e r  
                                                                     l e t   v a l u e   =   0 ;  
                                                                     f o r   ( l e t   i   =   r o w . C o l D a t a . l e n g t h   -   1 ;   i   > =   1 ;   i - - )   {  
                                                                         c o n s t   c o l V a l u e   =   r o w . C o l D a t a [ i ] ? . v a l u e ;  
                                                                         i f   ( c o l V a l u e   ! = =   u n d e f i n e d   & &   c o l V a l u e   ! = =   ' '   & &   ! i s N a N ( p a r s e F l o a t ( c o l V a l u e ) ) )   {  
                                                                             v a l u e   =   p a r s e F l o a t ( c o l V a l u e ) ;  
                                                                             b r e a k ;  
                                                                         }  
                                                                     }  
                                                                     r e s u l t . p u s h ( {   n a m e ,   v a l u e   } ) ;  
                                                                 }  
                                                             }  
                                                             i f   ( r o w . R o w s   & &   r o w . R o w s . R o w )   {  
                                                                 c o n s t   s u b R o w s   =   A r r a y . i s A r r a y ( r o w . R o w s . R o w )   ?   r o w . R o w s . R o w   :   [ r o w . R o w s . R o w ] ;  
                                                                 s u b R o w s . f o r E a c h ( ( r :   a n y )   = >   p r o c e s s R o w ( r ) ) ;  
                                                             }  
                                                         } ;  
                                                         c o n s t   r o w s   =   A r r a y . i s A r r a y ( r e p o r t D a t a . R o w s . R o w )   ?   r e p o r t D a t a . R o w s . R o w   :   [ r e p o r t D a t a . R o w s . R o w ] ;  
                                                         r o w s . f o r E a c h ( ( r :   a n y )   = >   p r o c e s s R o w ( r ) ) ;  
                                                         r e t u r n   r e s u l t ;  
                                                     } ;  
                                                     c o n s t   p l R o w s   =   e x t r a c t R o w s ( q b R a w D a t a . p r o f i t A n d L o s s ) ;  
                                                     c o n s t   a c c o u n t R o w   =   p l R o w s . f i n d ( ( r o w :   a n y )   = >   r o w . n a m e   = = =   q b A c c o u n t N a m e ) ;  
                                                     r e t u r n   a c c o u n t R o w   ?   a c c o u n t R o w . v a l u e   :   0 ;  
                                                 } ;  
                                                  
                                                 / /   C a l c u l a t e   t o t a l s  
                                                 c o n s t   t o t a l R e v e n u e   =   r e v e n u e M a p p i n g s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   g e t A m o u n t ( m . q b A c c o u n t ) ,   0 ) ;  
                                                 c o n s t   t o t a l C O G S   =   c o g s M a p p i n g s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   g e t A m o u n t ( m . q b A c c o u n t ) ,   0 ) ;  
                                                 c o n s t   t o t a l E x p e n s e s   =   e x p e n s e M a p p i n g s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   g e t A m o u n t ( m . q b A c c o u n t ) ,   0 ) ;  
                                                 c o n s t   g r o s s P r o f i t   =   t o t a l R e v e n u e   -   t o t a l C O G S ;  
                                                 c o n s t   n e t I n c o m e   =   g r o s s P r o f i t   -   t o t a l E x p e n s e s ;  
                                                  
                                                 r e t u r n   (  
                                                     < >  
                                                         { / *   R E V E N U E   S E C T I O N   * / }  
                                                         { r e v e n u e M a p p i n g s . l e n g t h   >   0   & &   (  
                                                             < >  
                                                                 < d i v   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } > R E V E N U E < / d i v >  
                                                                 { r e v e n u e M a p p i n g s . m a p ( ( m ,   i )   = >   {  
                                                                     c o n s t   a m o u n t   =   g e t A m o u n t ( m . q b A c c o u n t ) ;  
                                                                     r e t u r n   (  
                                                                         < d i v   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 6 p x   1 6 p x   6 p x   3 2 p x ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 ' ,   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r '   } } >  
                                                                             < d i v >  
                                                                                 < d i v   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   f o n t S i z e :   ' 1 3 p x '   } } > { m . q b A c c o u n t } < / d i v >  
                                                                                 < d i v   s t y l e = { {   c o l o r :   ' # 9 4 a 3 b 8 ' ,   f o n t S i z e :   ' 1 1 p x '   } } >       { m . t a r g e t F i e l d } < / d i v >  
                                                                             < / d i v >  
                                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 0 f 1 7 2 a ' ,   f o n t F a m i l y :   ' m o n o s p a c e ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                                                 $ { a m o u n t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                                                             < / s p a n >  
                                                                         < / d i v >  
                                                                     ) ;  
                                                                 } ) }  
                                                             < / >  
                                                         ) }  
                                                          
                                                         { / *   C O G S   S E C T I O N   * / }  
                                                         { c o g s M a p p i n g s . l e n g t h   >   0   & &   (  
                                                             < >  
                                                                 < d i v   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   m a r g i n T o p :   ' 1 2 p x '   } } > C O S T   O F   G O O D S   S O L D < / d i v >  
                                                                 { c o g s M a p p i n g s . m a p ( ( m ,   i )   = >   {  
                                                                     c o n s t   a m o u n t   =   g e t A m o u n t ( m . q b A c c o u n t ) ;  
                                                                     r e t u r n   (  
                                                                         < d i v   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 6 p x   1 6 p x   6 p x   3 2 p x ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 ' ,   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r '   } } >  
                                                                             < d i v >  
                                                                                 < d i v   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   f o n t S i z e :   ' 1 3 p x '   } } > { m . q b A c c o u n t } < / d i v >  
                                                                                 < d i v   s t y l e = { {   c o l o r :   ' # 9 4 a 3 b 8 ' ,   f o n t S i z e :   ' 1 1 p x '   } } >       { m . t a r g e t F i e l d } < / d i v >  
                                                                             < / d i v >  
                                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 0 f 1 7 2 a ' ,   f o n t F a m i l y :   ' m o n o s p a c e ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                                                 $ { a m o u n t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                                                             < / s p a n >  
                                                                         < / d i v >  
                                                                     ) ;  
                                                                 } ) }  
                                                                 < d i v   s t y l e = { {   p a d d i n g :   ' 1 0 p x   1 6 p x ' ,   b a c k g r o u n d :   ' # f e e 2 e 2 ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e f 4 4 4 4 ' ,   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   f o n t W e i g h t :   ' 7 0 0 '   } } >  
                                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 9 9 1 b 1 b '   } } > T o t a l   C O G S < / s p a n >  
                                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 9 9 1 b 1 b ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                                         $ { t o t a l C O G S . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                                                     < / s p a n >  
                                                                 < / d i v >  
                                                                 < d i v   s t y l e = { {   p a d d i n g :   ' 1 0 p x   1 6 p x ' ,   b a c k g r o u n d :   ' # d b e a f e ' ,   b o r d e r B o t t o m :   ' 3 p x   s o l i d   # 3 b 8 2 f 6 ' ,   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 1 e 4 0 a f '   } } > G R O S S   P R O F I T < / s p a n >  
                                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 1 e 4 0 a f ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                                         $ { g r o s s P r o f i t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                                                     < / s p a n >  
                                                                 < / d i v >  
                                                             < / >  
                                                         ) }  
                                                          
                                                         { / *   E X P E N S E S   S E C T I O N   * / }  
                                                         { e x p e n s e M a p p i n g s . l e n g t h   >   0   & &   (  
                                                             < >  
                                                                 < d i v   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   m a r g i n T o p :   ' 1 2 p x '   } } > O P E R A T I N G   E X P E N S E S < / d i v >  
                                                                 { e x p e n s e M a p p i n g s . m a p ( ( m ,   i )   = >   {  
                                                                     c o n s t   a m o u n t   =   g e t A m o u n t ( m . q b A c c o u n t ) ;  
                                                                     r e t u r n   (  
                                                                         < d i v   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 6 p x   1 6 p x   6 p x   3 2 p x ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 ' ,   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r '   } } >  
                                                                             < d i v >  
                                                                                 < d i v   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   f o n t S i z e :   ' 1 3 p x '   } } > { m . q b A c c o u n t } < / d i v >  
                                                                                 < d i v   s t y l e = { {   c o l o r :   ' # 9 4 a 3 b 8 ' ,   f o n t S i z e :   ' 1 1 p x '   } } >       { m . t a r g e t F i e l d } < / d i v >  
                                                                             < / d i v >  
                                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 0 f 1 7 2 a ' ,   f o n t F a m i l y :   ' m o n o s p a c e ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                                                 $ { a m o u n t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                                                             < / s p a n >  
                                                                         < / d i v >  
                                                                     ) ;  
                                                                 } ) }  
                                                                 < d i v   s t y l e = { {   p a d d i n g :   ' 1 0 p x   1 6 p x ' ,   b a c k g r o u n d :   ' # f e f 3 c 7 ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # f 5 9 e 0 b ' ,   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   f o n t W e i g h t :   ' 7 0 0 '   } } >  
                                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 9 2 4 0 0 e '   } } > T o t a l   O p e r a t i n g   E x p e n s e s < / s p a n >  
                                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 9 2 4 0 0 e ' ,   f o n t F a m i l y :   ' m o n o s p a c e '   } } >  
                                                                         $ { t o t a l E x p e n s e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                                                     < / s p a n >  
                                                                 < / d i v >  
                                                                 < d i v   s t y l e = { {   p a d d i n g :   ' 1 2 p x   1 6 p x ' ,   b a c k g r o u n d :   ' # d c f c e 7 ' ,   b o r d e r B o t t o m :   ' 4 p x   s o l i d   # 1 0 b 9 8 1 ' ,   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 1 6 6 5 3 4 ' ,   f o n t S i z e :   ' 1 6 p x '   } } > N E T   I N C O M E < / s p a n >  
                                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 1 6 6 5 3 4 ' ,   f o n t F a m i l y :   ' m o n o s p a c e ' ,   f o n t S i z e :   ' 1 6 p x '   } } >  
                                                                         $ { n e t I n c o m e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                                                     < / s p a n >  
                                                                 < / d i v >  
                                                             < / >  
                                                         ) }  
                                                     < / >  
                                                 ) ;  
                                             } ) ( ) }  
                                         < / d i v >  
                                     )   :   (  
                                         < d i v   s t y l e = { {   p a d d i n g :   ' 2 0 p x ' ,   t e x t A l i g n :   ' c e n t e r ' ,   c o l o r :   ' # 9 4 a 3 b 8 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                             N o   m a p p i n g s   s a v e d   y e t .   G e n e r a t e   a n d   s a v e   m a p p i n g s   a b o v e   t o   s e e   t h e m   h e r e .  
                                         < / d i v >  
                                     ) }  
                                 < / d i v >  
  
                                 { / *   B a l a n c e   S h e e t   S t r u c t u r e   * / }  
                                 < d i v >  
                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                                         < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   p a d d i n g B o t t o m :   ' 1 2 p x ' ,   b o r d e r B o t t o m :   ' 3 p x   s o l i d   # 1 0 b 9 8 1 '   } } > B a l a n c e   S h e e t   F i e l d s < / h 2 >  
                                         { q b R a w D a t a ? . b a l a n c e S h e e t ? . H e a d e r   & &   (  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   m a r g i n T o p :   ' 8 p x '   } } >  
                                                 < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } >  
                                                     A s   o f :   { q b R a w D a t a . b a l a n c e S h e e t . H e a d e r . T i m e   | |   q b R a w D a t a . b a l a n c e S h e e t . H e a d e r . E n d P e r i o d   | |   ' N / A ' }  
                                                 < / d i v >  
                                                 < d i v   s t y l e = { {   c o l o r :   ' # 3 b 8 2 f 6 ' ,   f o n t W e i g h t :   ' 5 0 0 ' ,   f o n t S i z e :   ' 1 2 p x ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                                      x `  B a l a n c e   S h e e t   s h o w s   p o i n t - i n - t i m e   s n a p s h o t   a s   o f   t h e   d a t e   a b o v e  
                                                 < / d i v >  
                                             < / d i v >  
                                         ) }  
                                     < / d i v >  
                                      
                                     { a i M a p p i n g s . l e n g t h   >   0   ?   (  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x '   } } >  
                                             { / *   G r o u p   m a p p i n g s   b y   c a t e g o r y   * / }  
                                             { ( ( )   = >   {  
                                                 / /   D e d u p l i c a t e   m a p p i n g s   b y   Q B   a c c o u n t   n a m e   ( k e e p   f i r s t   o c c u r r e n c e )  
                                                 c o n s t   u n i q u e M a p p i n g s   =   a i M a p p i n g s . f i l t e r ( ( m ,   i n d e x ,   s e l f )   = >  
                                                     i n d e x   = = =   s e l f . f i n d I n d e x ( ( t )   = >   t . q b A c c o u n t   = = =   m . q b A c c o u n t )  
                                                 ) ;  
                                                  
                                                 c o n s t   a s s e t M a p p i n g s   =   u n i q u e M a p p i n g s . f i l t e r ( m   = >   m . q b A c c o u n t C l a s s i f i c a t i o n ? . i n c l u d e s ( ' A s s e t ' ) ) ;  
                                                 c o n s t   c u r r e n t A s s e t M a p p i n g s   =   a s s e t M a p p i n g s . f i l t e r ( m   = >   m . q b A c c o u n t C l a s s i f i c a t i o n ? . i n c l u d e s ( ' C u r r e n t ' ) ) ;  
                                                 c o n s t   f i x e d A s s e t M a p p i n g s   =   a s s e t M a p p i n g s . f i l t e r ( m   = >   m . q b A c c o u n t C l a s s i f i c a t i o n ? . i n c l u d e s ( ' F i x e d ' )   | |   m . q b A c c o u n t C l a s s i f i c a t i o n ? . i n c l u d e s ( ' P r o p e r t y ' ) ) ;  
                                                 c o n s t   o t h e r A s s e t M a p p i n g s   =   a s s e t M a p p i n g s . f i l t e r ( m   = >   ! m . q b A c c o u n t C l a s s i f i c a t i o n ? . i n c l u d e s ( ' C u r r e n t ' )   & &   ! m . q b A c c o u n t C l a s s i f i c a t i o n ? . i n c l u d e s ( ' F i x e d ' )   & &   ! m . q b A c c o u n t C l a s s i f i c a t i o n ? . i n c l u d e s ( ' P r o p e r t y ' ) ) ;  
                                                  
                                                 c o n s t   l i a b i l i t y M a p p i n g s   =   u n i q u e M a p p i n g s . f i l t e r ( m   = >   m . q b A c c o u n t C l a s s i f i c a t i o n ? . i n c l u d e s ( ' L i a b i l i t y ' ) ) ;  
                                                 c o n s t   c u r r e n t L i a b M a p p i n g s   =   l i a b i l i t y M a p p i n g s . f i l t e r ( m   = >   m . q b A c c o u n t C l a s s i f i c a t i o n ? . i n c l u d e s ( ' C u r r e n t ' ) ) ;  
                                                 c o n s t   l o n g T e r m L i a b M a p p i n g s   =   l i a b i l i t y M a p p i n g s . f i l t e r ( m   = >   m . q b A c c o u n t C l a s s i f i c a t i o n ? . i n c l u d e s ( ' L o n g ' )   | |   ! m . q b A c c o u n t C l a s s i f i c a t i o n ? . i n c l u d e s ( ' C u r r e n t ' ) ) ;  
                                                  
                                                 c o n s t   e q u i t y M a p p i n g s   =   u n i q u e M a p p i n g s . f i l t e r ( m   = >   m . q b A c c o u n t C l a s s i f i c a t i o n ? . i n c l u d e s ( ' E q u i t y ' ) ) ;  
                                                  
                                                 / /   H e l p e r   t o   g e t   a m o u n t   f r o m   b a l a n c e   s h e e t   -   e x t r a c t   f r o m   t h e   a p p r o p r i a t e   c o l u m n  
                                                 c o n s t   g e t B S A m o u n t   =   ( q b A c c o u n t N a m e :   s t r i n g )   = >   {  
                                                     i f   ( ! q b R a w D a t a )   r e t u r n   0 ;  
                                                     c o n s t   e x t r a c t R o w s   =   ( r e p o r t D a t a :   a n y )   = >   {  
                                                         c o n s t   r e s u l t :   a n y [ ]   =   [ ] ;  
                                                         i f   ( ! r e p o r t D a t a   | |   ! r e p o r t D a t a . R o w s   | |   ! r e p o r t D a t a . R o w s . R o w )   r e t u r n   r e s u l t ;  
                                                          
                                                         c o n s t   p r o c e s s R o w   =   ( r o w :   a n y )   = >   {  
                                                             i f   ( r o w . t y p e   = = =   ' D a t a '   & &   r o w . C o l D a t a )   {  
                                                                 c o n s t   n a m e   =   r o w . C o l D a t a [ 0 ] ? . v a l u e   | |   ' ' ;  
                                                                 i f   ( n a m e )   {  
                                                                     / /   T r y   t o   f i n d   a   n u m e r i c   v a l u e   f r o m   t h e   c o l u m n s  
                                                                     / /   S t a r t   f r o m   t h e   e n d   a n d   w o r k   b a c k w a r d s   t o   f i n d   t h e   f i r s t   v a l i d   n u m b e r  
                                                                     l e t   v a l u e   =   0 ;  
                                                                     f o r   ( l e t   i   =   r o w . C o l D a t a . l e n g t h   -   1 ;   i   > =   1 ;   i - - )   {  
                                                                         c o n s t   c o l V a l u e   =   r o w . C o l D a t a [ i ] ? . v a l u e ;  
                                                                         i f   ( c o l V a l u e   ! = =   u n d e f i n e d   & &   c o l V a l u e   ! = =   ' '   & &   ! i s N a N ( p a r s e F l o a t ( c o l V a l u e ) ) )   {  
                                                                             v a l u e   =   p a r s e F l o a t ( c o l V a l u e ) ;  
                                                                             b r e a k ;  
                                                                         }  
                                                                     }  
                                                                     r e s u l t . p u s h ( {   n a m e ,   v a l u e   } ) ;  
                                                                 }  
                                                             }  
                                                             i f   ( r o w . R o w s   & &   r o w . R o w s . R o w )   {  
                                                                 c o n s t   s u b R o w s   =   A r r a y . i s A r r a y ( r o w . R o w s . R o w )   ?   r o w . R o w s . R o w   :   [ r o w . R o w s . R o w ] ;  
                                                                 s u b R o w s . f o r E a c h ( ( r :   a n y )   = >   p r o c e s s R o w ( r ) ) ;  
                                                             }  
                                                         } ;  
                                                         c o n s t   r o w s   =   A r r a y . i s A r r a y ( r e p o r t D a t a . R o w s . R o w )   ?   r e p o r t D a t a . R o w s . R o w   :   [ r e p o r t D a t a . R o w s . R o w ] ;  
                                                         r o w s . f o r E a c h ( ( r :   a n y )   = >   p r o c e s s R o w ( r ) ) ;  
                                                         r e t u r n   r e s u l t ;  
                                                     } ;  
                                                     c o n s t   b s R o w s   =   e x t r a c t R o w s ( q b R a w D a t a . b a l a n c e S h e e t ) ;  
                                                     c o n s t   a c c o u n t R o w   =   b s R o w s . f i n d ( ( r o w :   a n y )   = >   r o w . n a m e   = = =   q b A c c o u n t N a m e ) ;  
                                                     r e t u r n   a c c o u n t R o w   ?   a c c o u n t R o w . v a l u e   :   0 ;  
                                                 } ;  
                                                  
                                                 / /   C a l c u l a t e   t o t a l s  
                                                 c o n s t   t o t a l C u r r e n t A s s e t s   =   c u r r e n t A s s e t M a p p i n g s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   g e t B S A m o u n t ( m . q b A c c o u n t ) ,   0 ) ;  
                                                 c o n s t   t o t a l F i x e d A s s e t s   =   f i x e d A s s e t M a p p i n g s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   g e t B S A m o u n t ( m . q b A c c o u n t ) ,   0 ) ;  
                                                 c o n s t   t o t a l O t h e r A s s e t s   =   o t h e r A s s e t M a p p i n g s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   g e t B S A m o u n t ( m . q b A c c o u n t ) ,   0 ) ;  
                                                 c o n s t   t o t a l A s s e t s   =   t o t a l C u r r e n t A s s e t s   +   t o t a l F i x e d A s s e t s   +   t o t a l O t h e r A s s e t s ;  
                                                  
                                                 c o n s t   t o t a l C u r r e n t L i a b   =   c u r r e n t L i a b M a p p i n g s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   g e t B S A m o u n t ( m . q b A c c o u n t ) ,   0 ) ;  
                                                 c o n s t   t o t a l L o n g T e r m L i a b   =   l o n g T e r m L i a b M a p p i n g s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   g e t B S A m o u n t ( m . q b A c c o u n t ) ,   0 ) ;  
                                                 c o n s t   t o t a l L i a b i l i t i e s   =   t o t a l C u r r e n t L i a b   +   t o t a l L o n g T e r m L i a b ;  
                                                  
                                                 c o n s t   t o t a l E q u i t y   =   e q u i t y M a p p i n g s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   g e t B S A m o u n t ( m . q b A c c o u n t ) ,   0 ) ;  
                                                 c o n s t   t o t a l L i a b A n d E q u i t y   =   t o t a l L i a b i l i t i e s   +   t o t a l E q u i t y ;  
                                                  
                                                 r e t u r n   (  
                                                     < >  
                                                         { / *   A S S E T S   S E C T I O N   * / }  
                                                         < d i v   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   b a c k g r o u n d :   ' # 1 e 4 0 a f ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # 1 e 3 a 8 a ' ,   c o l o r :   ' w h i t e '   } } > A S S E T S < / d i v >  
                                                          
                                                         { c u r r e n t A s s e t M a p p i n g s . l e n g t h   >   0   & &   (  
                                                             < >  
                                                                 < d i v   s t y l e = { {   p a d d i n g :   ' 6 p x   1 6 p x ' ,   b a c k g r o u n d :   ' # e f f 6 f f ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # d b e a f e ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } > C u r r e n t   A s s e t s < / d i v >  
                                                                 { c u r r e n t A s s e t M a p p i n g s . m a p ( ( m ,   i )   = >   {  
                                                                     c o n s t   a m o u n t   =   g e t B S A m o u n t ( m . q b A c c o u n t ) ;  
                                                                     r e t u r n   (  
                                                                         < d i v   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 6 p x   1 6 p x   6 p x   3 2 p x ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 ' ,   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r '   } } >  
                                                                             < d i v >  
                                                                                 < d i v   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   f o n t S i z e :   ' 1 3 p x '   } } > { m . q b A c c o u n t } < / d i v >  
                                                                                 < d i v   s t y l e = { {   c o l o r :   ' # 9 4 a 3 b 8 ' ,   f o n t S i z e :   ' 1 1 p x '   } } >       { m . t a r g e t F i e l d } < / d i v >  
                                                                             < / d i v >  
                                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 0 f 1 7 2 a ' ,   f o n t F a m i l y :   ' m o n o s p a c e ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                                                 $ { a m o u n t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                                                             < / s p a n >  
                                                                         < / d i v >  
                                                                     ) ;  
                                                                 } ) }  
                                                             < / >  
                                                         ) }  
                                                          
                                                         { f i x e d A s s e t M a p p i n g s . l e n g t h   >   0   & &   (  
                                                             < >  
                                                                 < d i v   s t y l e = { {   p a d d i n g :   ' 6 p x   1 6 p x ' ,   b a c k g r o u n d :   ' # e f f 6 f f ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # d b e a f e ' ,   c o l o r :   ' # 1 e 4 0 a f ' ,   m a r g i n T o p :   ' 8 p x '   } } > F i x e d   A s s e t s < / d i v >  
                                                                 { f i x e d A s s e t M a p p i n g s . m a p ( ( m ,   i )   = >   {  
                                                                     c o n s t   a m o u n t   =   g e t B S A m o u n t ( m . q b A c c o u n t ) ;  
                                                                     r e t u r n   (  
                                                                         < d i v   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 6 p x   1 6 p x   6 p x   3 2 p x ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 ' ,   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r '   } } >  
                                                                             < d i v >  
                                                                                 < d i v   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   f o n t S i z e :   ' 1 3 p x '   } } > { m . q b A c c o u n t } < / d i v >  
                                                                                 < d i v   s t y l e = { {   c o l o r :   ' # 9 4 a 3 b 8 ' ,   f o n t S i z e :   ' 1 1 p x '   } } >       { m . t a r g e t F i e l d } < / d i v >  
                                                                             < / d i v >  
                                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 0 f 1 7 2 a ' ,   f o n t F a m i l y :   ' m o n o s p a c e ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                                                 $ { a m o u n t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                                                             < / s p a n >  
                                                                         < / d i v >  
                                                                     ) ;  
                                                                 } ) }  
                                                             < / >  
                                                         ) }  
                                                          
                                                         { o t h e r A s s e t M a p p i n g s . l e n g t h   >   0   & &   (  
                                                             < >  
                                                                 < d i v   s t y l e = { {   p a d d i n g :   ' 6 p x   1 6 p x ' ,   b a c k g r o u n d :   ' # e f f 6 f f ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # d b e a f e ' ,   c o l o r :   ' # 1 e 4 0 a f ' ,   m a r g i n T o p :   ' 8 p x '   } } > O t h e r   A s s e t s < / d i v >  
                                                                 { o t h e r A s s e t M a p p i n g s . m a p ( ( m ,   i )   = >   {  
                                                                     c o n s t   a m o u n t   =   g e t B S A m o u n t ( m . q b A c c o u n t ) ;  
                                                                     r e t u r n   (  
                                                                         < d i v   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 6 p x   1 6 p x   6 p x   3 2 p x ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 ' ,   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r '   } } >  
                                                                             < d i v >  
                                                                                 < d i v   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   f o n t S i z e :   ' 1 3 p x '   } } > { m . q b A c c o u n t } < / d i v >  
                                                                                 < d i v   s t y l e = { {   c o l o r :   ' # 9 4 a 3 b 8 ' ,   f o n t S i z e :   ' 1 1 p x '   } } >       { m . t a r g e t F i e l d } < / d i v >  
                                                                             < / d i v >  
                                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 0 f 1 7 2 a ' ,   f o n t F a m i l y :   ' m o n o s p a c e ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                                                 $ { a m o u n t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                                                             < / s p a n >  
                                                                         < / d i v >  
                                                                     ) ;  
                                                                 } ) }  
                                                             < / >  
                                                         ) }  
                                                          
                                                         { / *   L I A B I L I T I E S   S E C T I O N   * / }  
                                                         < d i v   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   b a c k g r o u n d :   ' # 9 9 1 b 1 b ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # 7 f 1 d 1 d ' ,   c o l o r :   ' w h i t e ' ,   m a r g i n T o p :   ' 1 6 p x '   } } > L I A B I L I T I E S < / d i v >  
                                                          
                                                         { c u r r e n t L i a b M a p p i n g s . l e n g t h   >   0   & &   (  
                                                             < >  
                                                                 < d i v   s t y l e = { {   p a d d i n g :   ' 6 p x   1 6 p x ' ,   b a c k g r o u n d :   ' # f e f 2 f 2 ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f e e 2 e 2 ' ,   c o l o r :   ' # 9 9 1 b 1 b '   } } > C u r r e n t   L i a b i l i t i e s < / d i v >  
                                                                 { c u r r e n t L i a b M a p p i n g s . m a p ( ( m ,   i )   = >   {  
                                                                     c o n s t   a m o u n t   =   g e t B S A m o u n t ( m . q b A c c o u n t ) ;  
                                                                     r e t u r n   (  
                                                                         < d i v   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 6 p x   1 6 p x   6 p x   3 2 p x ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 ' ,   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r '   } } >  
                                                                             < d i v >  
                                                                                 < d i v   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   f o n t S i z e :   ' 1 3 p x '   } } > { m . q b A c c o u n t } < / d i v >  
                                                                                 < d i v   s t y l e = { {   c o l o r :   ' # 9 4 a 3 b 8 ' ,   f o n t S i z e :   ' 1 1 p x '   } } >       { m . t a r g e t F i e l d } < / d i v >  
                                                                             < / d i v >  
                                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 0 f 1 7 2 a ' ,   f o n t F a m i l y :   ' m o n o s p a c e ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                                                 $ { a m o u n t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                                                             < / s p a n >  
                                                                         < / d i v >  
                                                                     ) ;  
                                                                 } ) }  
                                                             < / >  
                                                         ) }  
                                                          
                                                         { l o n g T e r m L i a b M a p p i n g s . l e n g t h   >   0   & &   (  
                                                             < >  
                                                                 < d i v   s t y l e = { {   p a d d i n g :   ' 6 p x   1 6 p x ' ,   b a c k g r o u n d :   ' # f e f 2 f 2 ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f e e 2 e 2 ' ,   c o l o r :   ' # 9 9 1 b 1 b ' ,   m a r g i n T o p :   ' 8 p x '   } } > L o n g - T e r m   L i a b i l i t i e s < / d i v >  
                                                                 { l o n g T e r m L i a b M a p p i n g s . m a p ( ( m ,   i )   = >   {  
                                                                     c o n s t   a m o u n t   =   g e t B S A m o u n t ( m . q b A c c o u n t ) ;  
                                                                     r e t u r n   (  
                                                                         < d i v   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 6 p x   1 6 p x   6 p x   3 2 p x ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 ' ,   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r '   } } >  
                                                                             < d i v >  
                                                                                 < d i v   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   f o n t S i z e :   ' 1 3 p x '   } } > { m . q b A c c o u n t } < / d i v >  
                                                                                 < d i v   s t y l e = { {   c o l o r :   ' # 9 4 a 3 b 8 ' ,   f o n t S i z e :   ' 1 1 p x '   } } >       { m . t a r g e t F i e l d } < / d i v >  
                                                                             < / d i v >  
                                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 0 f 1 7 2 a ' ,   f o n t F a m i l y :   ' m o n o s p a c e ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                                                 $ { a m o u n t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                                                             < / s p a n >  
                                                                         < / d i v >  
                                                                     ) ;  
                                                                 } ) }  
                                                             < / >  
                                                         ) }  
                                                          
                                                         { / *   E Q U I T Y   S E C T I O N   * / }  
                                                         { e q u i t y M a p p i n g s . l e n g t h   >   0   & &   (  
                                                             < >  
                                                                 < d i v   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   b a c k g r o u n d :   ' # 1 6 6 5 3 4 ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # 1 4 5 3 2 d ' ,   c o l o r :   ' w h i t e ' ,   m a r g i n T o p :   ' 1 6 p x '   } } > E Q U I T Y < / d i v >  
                                                                 { e q u i t y M a p p i n g s . m a p ( ( m ,   i )   = >   {  
                                                                     c o n s t   a m o u n t   =   g e t B S A m o u n t ( m . q b A c c o u n t ) ;  
                                                                     r e t u r n   (  
                                                                         < d i v   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 6 p x   1 6 p x   6 p x   3 2 p x ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 ' ,   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r '   } } >  
                                                                             < d i v >  
                                                                                 < d i v   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   f o n t S i z e :   ' 1 3 p x '   } } > { m . q b A c c o u n t } < / d i v >  
                                                                                 < d i v   s t y l e = { {   c o l o r :   ' # 9 4 a 3 b 8 ' ,   f o n t S i z e :   ' 1 1 p x '   } } >       { m . t a r g e t F i e l d } < / d i v >  
                                                                             < / d i v >  
                                                                             < s p a n   s t y l e = { {   c o l o r :   ' # 0 f 1 7 2 a ' ,   f o n t F a m i l y :   ' m o n o s p a c e ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                                                 $ { a m o u n t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                                                             < / s p a n >  
                                                                         < / d i v >  
                                                                     ) ;  
                                                                 } ) }  
                                                             < / >  
                                                         ) }  
                                                          
                                                         { / *   T O T A L   L I A B I L I T I E S   &   E Q U I T Y   * / }  
                                                         < d i v   s t y l e = { {   p a d d i n g :   ' 1 2 p x   1 6 p x ' ,   b a c k g r o u n d :   ' # 8 b 5 c f 6 ' ,   b o r d e r B o t t o m :   ' 4 p x   s o l i d   # 6 b 2 1 a 8 ' ,   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   m a r g i n T o p :   ' 8 p x '   } } >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' w h i t e ' ,   f o n t S i z e :   ' 1 6 p x '   } } > T O T A L   L I A B I L I T I E S   &   E Q U I T Y < / s p a n >  
                                                             < s p a n   s t y l e = { {   c o l o r :   ' w h i t e ' ,   f o n t F a m i l y :   ' m o n o s p a c e ' ,   f o n t S i z e :   ' 1 6 p x '   } } >  
                                                                 $ { t o t a l L i a b A n d E q u i t y . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                                             < / s p a n >  
                                                         < / d i v >  
                                                          
                                                         { / *   B a l a n c e   C h e c k   * / }  
                                                         { M a t h . a b s ( t o t a l A s s e t s   -   t o t a l L i a b A n d E q u i t y )   >   0 . 0 1   & &   (  
                                                             < d i v   s t y l e = { {   p a d d i n g :   ' 1 0 p x   1 6 p x ' ,   b a c k g r o u n d :   ' # f e f 2 f 2 ' ,   b o r d e r :   ' 2 p x   s o l i d   # e f 4 4 4 4 ' ,   m a r g i n T o p :   ' 8 p x ' ,   b o r d e r R a d i u s :   ' 6 p x '   } } >  
                                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 9 9 1 b 1 b ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  a      B a l a n c e   C h e c k :   A s s e t s   a n d   L i a b i l i t i e s + E q u i t y   d o   n o t   m a t c h ! < / s p a n >  
                                                             < / d i v >  
                                                         ) }  
                                                     < / >  
                                                 ) ;  
                                             } ) ( ) }  
                                         < / d i v >  
                                     )   :   (  
                                         < d i v   s t y l e = { {   p a d d i n g :   ' 2 0 p x ' ,   t e x t A l i g n :   ' c e n t e r ' ,   c o l o r :   ' # 9 4 a 3 b 8 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                             N o   m a p p i n g s   s a v e d   y e t .   G e n e r a t e   a n d   s a v e   m a p p i n g s   a b o v e   t o   s e e   t h e m   h e r e .  
                                         < / d i v >  
                                     ) }  
                                 < / d i v >  
                             < / d i v >  
                         < / d i v >  
                         < / d i v >  
                         { / *   E n d   h i d d e n   s e c t i o n   * / }  
                         < / >  
                         ) }  
  
                         { / *   L i n e   o f   B u s i n e s s   R e p o r t i n g   T a b   * / }  
                         { f i n a n c i a l S t a t e m e n t s T a b   = = =   ' l i n e - o f - b u s i n e s s '   & &   (  
                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                 < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                     < h 2   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } > L i n e   o f   B u s i n e s s   R e p o r t i n g < / h 2 >  
                                     < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                         V i e w   f i n a n c i a l   p e r f o r m a n c e   b y   l i n e   o f   b u s i n e s s .   S e l e c t   a   s p e c i f i c   b u s i n e s s   l i n e   o r   v i e w   a l l   l i n e s   s i d e   b y   s i d e .  
                                     < / p >  
                                      
                                     { / *   L i n e   o f   B u s i n e s s   S e l e c t o r   * / }  
                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   1 f r   1 f r ' ,   g a p :   ' 1 6 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                         < d i v >  
                                             < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                                 L i n e   o f   B u s i n e s s  
                                             < / l a b e l >  
                                             < s e l e c t    
                                                 v a l u e = { s e l e c t e d L i n e O f B u s i n e s s }  
                                                 o n C h a n g e = { ( e )   = >   s e t S e l e c t e d L i n e O f B u s i n e s s ( e . t a r g e t . v a l u e ) }  
                                                 s t y l e = { {    
                                                     w i d t h :   ' 1 0 0 % ' ,    
                                                     p a d d i n g :   ' 1 0 p x   1 2 p x ' ,    
                                                     b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,    
                                                     b o r d e r R a d i u s :   ' 6 p x ' ,    
                                                     f o n t S i z e :   ' 1 4 p x ' ,  
                                                     c o l o r :   ' # 1 e 2 9 3 b ' ,  
                                                     b a c k g r o u n d :   ' w h i t e ' ,  
                                                     c u r s o r :   ' p o i n t e r '  
                                                 } }  
                                             >  
                                                 < o p t i o n   v a l u e = " a l l " > A l l   L i n e s   o f   B u s i n e s s   ( S i d e   b y   S i d e ) < / o p t i o n >  
                                                 { q b R a w D a t a ? . p r o f i t A n d L o s s ? . C o l u m n s ? . C o l u m n   & &   A r r a y . i s A r r a y ( q b R a w D a t a . p r o f i t A n d L o s s . C o l u m n s . C o l u m n )    
                                                     ?   q b R a w D a t a . p r o f i t A n d L o s s . C o l u m n s . C o l u m n  
                                                             . f i l t e r ( ( c o l :   a n y )   = >   c o l . C o l T y p e   ! = =   ' T o t a l ' )  
                                                             . m a p ( ( c o l :   a n y ,   i d x :   n u m b e r )   = >   (  
                                                                 < o p t i o n   k e y = { i d x }   v a l u e = { c o l . C o l T i t l e   | |   ` C o l u m n   $ { i d x   +   1 } ` } >  
                                                                     { c o l . C o l T i t l e   | |   ` C o l u m n   $ { i d x   +   1 } ` }  
                                                                 < / o p t i o n >  
                                                             ) )  
                                                     :   n u l l  
                                                 }  
                                             < / s e l e c t >  
                                         < / d i v >  
  
                                         < d i v >  
                                             < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                                 P e r i o d  
                                             < / l a b e l >  
                                             < s e l e c t    
                                                 v a l u e = { s t a t e m e n t P e r i o d }  
                                                 o n C h a n g e = { ( e )   = >   s e t S t a t e m e n t P e r i o d ( e . t a r g e t . v a l u e   a s   a n y ) }  
                                                 s t y l e = { {    
                                                     w i d t h :   ' 1 0 0 % ' ,    
                                                     p a d d i n g :   ' 1 0 p x   1 2 p x ' ,    
                                                     b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,    
                                                     b o r d e r R a d i u s :   ' 6 p x ' ,    
                                                     f o n t S i z e :   ' 1 4 p x ' ,  
                                                     c o l o r :   ' # 1 e 2 9 3 b ' ,  
                                                     b a c k g r o u n d :   ' w h i t e ' ,  
                                                     c u r s o r :   ' p o i n t e r '  
                                                 } }  
                                             >  
                                                 < o p t i o n   v a l u e = " c u r r e n t - m o n t h " > C u r r e n t   M o n t h < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " c u r r e n t - q u a r t e r " > C u r r e n t   Q u a r t e r < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " l a s t - 1 2 - m o n t h s " > L a s t   1 2   m o n t h s < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " y t d " > Y T D < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " l a s t - y e a r " > L a s t   Y e a r < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " l a s t - 3 - y e a r s " > L a s t   3   Y e a r s < / o p t i o n >  
                                             < / s e l e c t >  
                                         < / d i v >  
  
                                         < d i v >  
                                             < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                                 D i s p l a y   A s  
                                             < / l a b e l >  
                                             < s e l e c t    
                                                 v a l u e = { s t a t e m e n t D i s p l a y }  
                                                 o n C h a n g e = { ( e )   = >   s e t S t a t e m e n t D i s p l a y ( e . t a r g e t . v a l u e   a s   ' m o n t h l y '   |   ' q u a r t e r l y '   |   ' a n n u a l ' ) }  
                                                 s t y l e = { {    
                                                     w i d t h :   ' 1 0 0 % ' ,    
                                                     p a d d i n g :   ' 1 0 p x   1 2 p x ' ,    
                                                     b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,    
                                                     b o r d e r R a d i u s :   ' 6 p x ' ,    
                                                     f o n t S i z e :   ' 1 4 p x ' ,  
                                                     c o l o r :   ' # 1 e 2 9 3 b ' ,  
                                                     b a c k g r o u n d :   ' w h i t e ' ,  
                                                     c u r s o r :   ' p o i n t e r '  
                                                 } }  
                                             >  
                                                 < o p t i o n   v a l u e = " m o n t h l y " > M o n t h l y < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " q u a r t e r l y " > Q u a r t e r l y < / o p t i o n >  
                                                 < o p t i o n   v a l u e = " a n n u a l " > A n n u a l < / o p t i o n >  
                                             < / s e l e c t >  
                                         < / d i v >  
                                     < / d i v >  
                                 < / d i v >  
  
                                 { / *   C o m i n g   S o o n   M e s s a g e   * / }  
                                 < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r :   ' 2 p x   d a s h e d   # c b d 5 e 1 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 4 8 p x   2 4 p x ' ,   t e x t A l i g n :   ' c e n t e r '   } } >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 4 8 p x ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  x `< / d i v >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                         L i n e   o f   B u s i n e s s   R e p o r t i n g  
                                     < / d i v >  
                                     < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a x W i d t h :   ' 5 0 0 p x ' ,   m a r g i n :   ' 0   a u t o '   } } >  
                                         T h i s   f e a t u r e   w i l l   d i s p l a y   I n c o m e   S t a t e m e n t   d a t a   b r o k e n   d o w n   b y   l i n e   o f   b u s i n e s s   f r o m   y o u r   Q u i c k B o o k s   c l a s s   t r a c k i n g .    
                                         Y o u ' l l   b e   a b l e   t o   c o m p a r e   p e r f o r m a n c e   a c r o s s   d i f f e r e n t   b u s i n e s s   l i n e s   s i d e   b y   s i d e   f o r   t h e   s e l e c t e d   p e r i o d .  
                                     < / p >  
                                 < / d i v >  
                             < / d i v >  
                         ) }  
                     < / d i v >  
                 ) ;  
             } ) ( ) }  
  
             { / *   F i n a n c i a l   S t a t e m e n t s   V i e w   -   W o r k s   w i t h   C S V   o r   Q B   d a t a   v i a   m o n t h l y   a r r a y   * / }  
             { c u r r e n t V i e w   = = =   ' f i n a n c i a l - s t a t e m e n t s '   & &   s e l e c t e d C o m p a n y I d   & &   ! q b R a w D a t a   & &   m o n t h l y . l e n g t h   >   0   & &   (  
                 < d i v   s t y l e = { {   m a x W i d t h :   ' 1 8 0 0 p x ' ,   m a r g i n :   ' 0   a u t o ' ,   p a d d i n g :   ' 3 2 p x '   } } >  
                     < s t y l e > { `  
                         @ m e d i a   p r i n t   {  
                             @ p a g e   {  
                                 s i z e :   l e t t e r ;  
                                 m a r g i n :   0 . 1 i n   0 . 1 5 i n   0 . 1 i n   0 . 1 5 i n ;  
                             }  
                              
                             / *   H i d e   n a v i g a t i o n   a n d   U I   e l e m e n t s   * /  
                             . n o - p r i n t ,  
                             h e a d e r ,  
                             n a v ,  
                             a s i d e ,  
                             [ r o l e = " n a v i g a t i o n " ] ,  
                             b u t t o n   {  
                                 d i s p l a y :   n o n e   ! i m p o r t a n t ;  
                             }  
                              
                             / *   R e m o v e   b a c k g r o u n d   c o l o r s   a n d   s h a d o w s   * /  
                             *   {  
                                 b o x - s h a d o w :   n o n e   ! i m p o r t a n t ;  
                             }  
                              
                             / *   F o r c e   v e r y   t i g h t   c o l u m n   s p a c i n g   * /  
                             [ s t y l e * = " d i s p l a y :   g r i d " ]   {  
                                 g a p :   2 p x   ! i m p o r t a n t ;  
                                 c o l u m n - g a p :   2 p x   ! i m p o r t a n t ;  
                             }  
                              
                             / *   R e d u c e   p a d d i n g   t o   b r i n g   c o n t e n t   c l o s e r   * /  
                             [ s t y l e * = " d i s p l a y :   g r i d " ]   >   *   {  
                                 p a d d i n g - l e f t :   2 p x   ! i m p o r t a n t ;  
                                 p a d d i n g - r i g h t :   2 p x   ! i m p o r t a n t ;  
                             }  
                              
                             / *   R e d u c e   f o n t   s i z e s   s l i g h t l y   f o r   b e t t e r   f i t   * /  
                             d i v [ s t y l e * = " f o n t S i z e :   ' 1 4 p x ' " ] ,  
                             d i v [ s t y l e * = " f o n t S i z e :   ' 1 3 p x ' " ]   {  
                                 f o n t - s i z e :   1 1 p x   ! i m p o r t a n t ;  
                             }  
                         }  
                     ` } < / s t y l e >  
                      
                     < d i v   c l a s s N a m e = " n o - p r i n t "   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                         < h 1   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n :   0   } } > F i n a n c i a l   S t a t e m e n t s < / h 1 >  
                         { c o m p a n y N a m e   & &   < d i v   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > { c o m p a n y N a m e } < / d i v > }  
                     < / d i v >  
                     < p   c l a s s N a m e = " n o - p r i n t "   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                         B a s e d   o n   i m p o r t e d   f i n a n c i a l   d a t a  
                     < / p >  
  
                     { / *   T a b   N a v i g a t i o n   * / }  
                     < d i v   c l a s s N a m e = " n o - p r i n t "   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 8 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                         < b u t t o n  
                             o n C l i c k = { ( )   = >   s e t F i n a n c i a l S t a t e m e n t s T a b ( ' a g g r e g a t e d ' ) }  
                             s t y l e = { {  
                                 p a d d i n g :   ' 1 2 p x   2 4 p x ' ,  
                                 b a c k g r o u n d :   f i n a n c i a l S t a t e m e n t s T a b   = = =   ' a g g r e g a t e d '   ?   ' # 6 6 7 e e a '   :   ' t r a n s p a r e n t ' ,  
                                 c o l o r :   f i n a n c i a l S t a t e m e n t s T a b   = = =   ' a g g r e g a t e d '   ?   ' w h i t e '   :   ' # 6 4 7 4 8 b ' ,  
                                 b o r d e r :   ' n o n e ' ,  
                                 b o r d e r B o t t o m :   f i n a n c i a l S t a t e m e n t s T a b   = = =   ' a g g r e g a t e d '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t ' ,  
                                 f o n t S i z e :   ' 1 6 p x ' ,  
                                 f o n t W e i g h t :   ' 6 0 0 ' ,  
                                 c u r s o r :   ' p o i n t e r ' ,  
                                 b o r d e r R a d i u s :   ' 8 p x   8 p x   0   0 ' ,  
                                 t r a n s i t i o n :   ' a l l   0 . 2 s '  
                             } }  
                         >  
                             A g g r e g a t e d   F i n a n c i a l s  
                         < / b u t t o n >  
                         < b u t t o n  
                             o n C l i c k = { ( )   = >   s e t F i n a n c i a l S t a t e m e n t s T a b ( ' l i n e - o f - b u s i n e s s ' ) }  
                             s t y l e = { {  
                                 p a d d i n g :   ' 1 2 p x   2 4 p x ' ,  
                                 b a c k g r o u n d :   f i n a n c i a l S t a t e m e n t s T a b   = = =   ' l i n e - o f - b u s i n e s s '   ?   ' # 6 6 7 e e a '   :   ' t r a n s p a r e n t ' ,  
                                 c o l o r :   f i n a n c i a l S t a t e m e n t s T a b   = = =   ' l i n e - o f - b u s i n e s s '   ?   ' w h i t e '   :   ' # 6 4 7 4 8 b ' ,  
                                 b o r d e r :   ' n o n e ' ,  
                                 b o r d e r B o t t o m :   f i n a n c i a l S t a t e m e n t s T a b   = = =   ' l i n e - o f - b u s i n e s s '   ?   ' 3 p x   s o l i d   # 6 6 7 e e a '   :   ' 3 p x   s o l i d   t r a n s p a r e n t ' ,  
                                 f o n t S i z e :   ' 1 6 p x ' ,  
                                 f o n t W e i g h t :   ' 6 0 0 ' ,  
                                 c u r s o r :   ' p o i n t e r ' ,  
                                 b o r d e r R a d i u s :   ' 8 p x   8 p x   0   0 ' ,  
                                 t r a n s i t i o n :   ' a l l   0 . 2 s '  
                             } }  
                         >  
                             L i n e   o f   B u s i n e s s   R e p o r t i n g  
                         < / b u t t o n >  
                     < / d i v >  
  
                     { / *   A g g r e g a t e d   F i n a n c i a l s   T a b   * / }  
                     { f i n a n c i a l S t a t e m e n t s T a b   = = =   ' a g g r e g a t e d '   & &   (  
                     < >  
                     { / *   S t a t e m e n t   C o n t r o l s   * / }  
                     < d i v   c l a s s N a m e = " n o - p r i n t "   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   1 f r   1 f r   1 f r ' ,   g a p :   ' 1 6 p x '   } } >  
                             { / *   T y p e   o f   S t a t e m e n t   * / }  
                             < d i v >  
                                 < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                     T y p e   o f   S t a t e m e n t  
                                 < / l a b e l >  
                                 < s e l e c t    
                                     v a l u e = { s t a t e m e n t T y p e }  
                                     o n C h a n g e = { ( e )   = >   s e t S t a t e m e n t T y p e ( e . t a r g e t . v a l u e   a s   a n y ) }  
                                     s t y l e = { {    
                                         w i d t h :   ' 1 0 0 % ' ,    
                                         p a d d i n g :   ' 1 0 p x   1 2 p x ' ,    
                                         b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,    
                                         b o r d e r R a d i u s :   ' 6 p x ' ,    
                                         f o n t S i z e :   ' 1 4 p x ' ,  
                                         c o l o r :   ' # 1 e 2 9 3 b ' ,  
                                         b a c k g r o u n d :   ' w h i t e ' ,  
                                         c u r s o r :   ' p o i n t e r '  
                                     } }  
                                 >  
                                     < o p t i o n   v a l u e = " i n c o m e - s t a t e m e n t " > I n c o m e   S t a t e m e n t < / o p t i o n >  
                                     < o p t i o n   v a l u e = " i n c o m e - s t a t e m e n t - p e r c e n t " > I n c o m e   S t m t   a s   %   o f   R e v e n u e < / o p t i o n >  
                                     < o p t i o n   v a l u e = " b a l a n c e - s h e e t " > B a l a n c e   S h e e t < / o p t i o n >  
                                 < / s e l e c t >  
                             < / d i v >  
  
                             { / *   P e r i o d   * / }  
                             < d i v >  
                                 < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                     P e r i o d  
                                 < / l a b e l >  
                                 < s e l e c t    
                                     v a l u e = { s t a t e m e n t P e r i o d }  
                                     o n C h a n g e = { ( e )   = >   s e t S t a t e m e n t P e r i o d ( e . t a r g e t . v a l u e   a s   a n y ) }  
                                     s t y l e = { {    
                                         w i d t h :   ' 1 0 0 % ' ,    
                                         p a d d i n g :   ' 1 0 p x   1 2 p x ' ,    
                                         b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,    
                                         b o r d e r R a d i u s :   ' 6 p x ' ,    
                                         f o n t S i z e :   ' 1 4 p x ' ,  
                                         c o l o r :   ' # 1 e 2 9 3 b ' ,  
                                         b a c k g r o u n d :   ' w h i t e ' ,  
                                         c u r s o r :   ' p o i n t e r '  
                                     } }  
                                 >  
                                     < o p t i o n   v a l u e = " c u r r e n t - m o n t h " > C u r r e n t   M o n t h < / o p t i o n >  
                                     < o p t i o n   v a l u e = " c u r r e n t - q u a r t e r " > C u r r e n t   Q u a r t e r < / o p t i o n >  
                                     < o p t i o n   v a l u e = " l a s t - 1 2 - m o n t h s " > L a s t   1 2   m o n t h s < / o p t i o n >  
                                     < o p t i o n   v a l u e = " y t d " > Y T D < / o p t i o n >  
                                     < o p t i o n   v a l u e = " l a s t - y e a r " > L a s t   Y e a r < / o p t i o n >  
                                     < o p t i o n   v a l u e = " l a s t - 3 - y e a r s " > L a s t   3   Y e a r s < / o p t i o n >  
                                 < / s e l e c t >  
                             < / d i v >  
  
                             { / *   D i s p l a y   A s   * / }  
                             < d i v >  
                                 < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 3 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                     D i s p l a y   A s  
                                 < / l a b e l >  
                                 < s e l e c t    
                                     v a l u e = { s t a t e m e n t D i s p l a y }  
                                     o n C h a n g e = { ( e )   = >   s e t S t a t e m e n t D i s p l a y ( e . t a r g e t . v a l u e   a s   ' m o n t h l y '   |   ' q u a r t e r l y '   |   ' a n n u a l ' ) }  
                                     s t y l e = { {    
                                         w i d t h :   ' 1 0 0 % ' ,    
                                         p a d d i n g :   ' 1 0 p x   1 2 p x ' ,    
                                         b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,    
                                         b o r d e r R a d i u s :   ' 6 p x ' ,    
                                         f o n t S i z e :   ' 1 4 p x ' ,  
                                         c o l o r :   ' # 1 e 2 9 3 b ' ,  
                                         b a c k g r o u n d :   ' w h i t e ' ,  
                                         c u r s o r :   ' p o i n t e r '  
                                     } }  
                                 >  
                                     < o p t i o n   v a l u e = " m o n t h l y " > M o n t h l y < / o p t i o n >  
                                     < o p t i o n   v a l u e = " q u a r t e r l y " > Q u a r t e r l y < / o p t i o n >  
                                     < o p t i o n   v a l u e = " a n n u a l " > A n n u a l < / o p t i o n >  
                                 < / s e l e c t >  
                             < / d i v >  
                              
                             { / *   P r i n t   B u t t o n   * / }  
                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' f l e x - e n d '   } } >  
                                 < b u t t o n  
                                     o n C l i c k = { ( )   = >   w i n d o w . p r i n t ( ) }  
                                     s t y l e = { {  
                                         w i d t h :   ' 1 0 0 % ' ,  
                                         p a d d i n g :   ' 1 0 p x   1 2 p x ' ,  
                                         b a c k g r o u n d :   ' # 1 0 b 9 8 1 ' ,  
                                         c o l o r :   ' w h i t e ' ,  
                                         b o r d e r :   ' n o n e ' ,  
                                         b o r d e r R a d i u s :   ' 6 p x ' ,  
                                         f o n t S i z e :   ' 1 4 p x ' ,  
                                         f o n t W e i g h t :   ' 6 0 0 ' ,  
                                         c u r s o r :   ' p o i n t e r ' ,  
                                         d i s p l a y :   ' f l e x ' ,  
                                         a l i g n I t e m s :   ' c e n t e r ' ,  
                                         j u s t i f y C o n t e n t :   ' c e n t e r ' ,  
                                         g a p :   ' 8 p x '  
                                     } }  
                                 >  
                                      x       P r i n t  
                                 < / b u t t o n >  
                             < / d i v >  
                         < / d i v >  
                     < / d i v >  
  
                     { / *   S t a t e m e n t   C o n t e n t   A r e a   * / }  
                     { ( ( )   = >   {  
                         c o n s o l e . l o g ( '  x `  F i n a n c i a l   S t a t e m e n t   R e n d e r   C h e c k   ( C S V / M o n t h l y   D a t a ) : ' ,   {  
                             s t a t e m e n t T y p e ,  
                             s t a t e m e n t P e r i o d ,  
                             m o n t h l y L e n g t h :   m o n t h l y ? . l e n g t h   | |   0 ,  
                             m o n t h l y F i r s t :   m o n t h l y ? . [ 0 ] ,  
                             c o n d i t i o n :   s t a t e m e n t T y p e   = = =   ' i n c o m e - s t a t e m e n t '   & &   s t a t e m e n t P e r i o d   = = =   ' c u r r e n t - m o n t h '  
                         } ) ;  
                          
                         i f   ( s t a t e m e n t T y p e   = = =   ' i n c o m e - s t a t e m e n t '   & &   s t a t e m e n t P e r i o d   = = =   ' c u r r e n t - m o n t h ' )   {  
                             c o n s t   c u r r e n t M o n t h   =   m o n t h l y [ m o n t h l y . l e n g t h   -   1 ] ;  
                             c o n s t   m o n t h D a t e   =   n e w   D a t e ( c u r r e n t M o n t h . d a t e   | |   c u r r e n t M o n t h . m o n t h ) ;  
                             c o n s t   m o n t h N a m e   =   m o n t h D a t e . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' l o n g ' ,   y e a r :   ' n u m e r i c '   } ) ;  
                              
                             / /   R e v e n u e  
                             c o n s t   r e v e n u e   =   c u r r e n t M o n t h . r e v e n u e   | |   0 ;  
                              
                             / /   C o s t   o f   G o o d s   S o l d  
                             c o n s t   c o g s P a y r o l l   =   c u r r e n t M o n t h . c o g s P a y r o l l   | |   0 ;  
                             c o n s t   c o g s O w n e r P a y   =   c u r r e n t M o n t h . c o g s O w n e r P a y   | |   0 ;  
                             c o n s t   c o g s C o n t r a c t o r s   =   c u r r e n t M o n t h . c o g s C o n t r a c t o r s   | |   0 ;  
                             c o n s t   c o g s M a t e r i a l s   =   c u r r e n t M o n t h . c o g s M a t e r i a l s   | |   0 ;  
                             c o n s t   c o g s C o m m i s s i o n s   =   c u r r e n t M o n t h . c o g s C o m m i s s i o n s   | |   0 ;  
                             c o n s t   c o g s O t h e r   =   c u r r e n t M o n t h . c o g s O t h e r   | |   0 ;  
                             c o n s t   c o g s   =   c o g s P a y r o l l   +   c o g s O w n e r P a y   +   c o g s C o n t r a c t o r s   +   c o g s M a t e r i a l s   +   c o g s C o m m i s s i o n s   +   c o g s O t h e r ;  
                              
                             c o n s t   g r o s s P r o f i t   =   r e v e n u e   -   c o g s ;  
                             c o n s t   g r o s s M a r g i n   =   r e v e n u e   >   0   ?   ( g r o s s P r o f i t   /   r e v e n u e )   *   1 0 0   :   0 ;  
                              
                             / /   O p e r a t i n g   E x p e n s e s  
                             c o n s t   o p e x P a y r o l l   =   c u r r e n t M o n t h . o p e x P a y r o l l   | |   0 ;  
                             c o n s t   o w n e r s B a s e P a y   =   c u r r e n t M o n t h . o w n e r s B a s e P a y   | |   0 ;  
                             c o n s t   o w n e r s R e t i r e m e n t   =   c u r r e n t M o n t h . o w n e r s R e t i r e m e n t   | |   0 ;  
                             c o n s t   p r o f e s s i o n a l S e r v i c e s   =   c u r r e n t M o n t h . p r o f e s s i o n a l S e r v i c e s   | |   0 ;  
                             c o n s t   r e n t L e a s e   =   c u r r e n t M o n t h . r e n t L e a s e   | |   0 ;  
                             c o n s t   u t i l i t i e s   =   c u r r e n t M o n t h . u t i l i t i e s   | |   0 ;  
                             c o n s t   e q u i p m e n t   =   c u r r e n t M o n t h . e q u i p m e n t   | |   0 ;  
                             c o n s t   t r a v e l   =   c u r r e n t M o n t h . t r a v e l   | |   0 ;  
                             c o n s t   i n s u r a n c e   =   c u r r e n t M o n t h . i n s u r a n c e   | |   0 ;  
                             c o n s t   o p e x S a l e s M a r k e t i n g   =   c u r r e n t M o n t h . o p e x S a l e s M a r k e t i n g   | |   0 ;  
                             c o n s t   c o n t r a c t o r s D i s t r i b u t i o n   =   c u r r e n t M o n t h . c o n t r a c t o r s D i s t r i b u t i o n   | |   0 ;  
                             c o n s t   d e p r e c i a t i o n E x p e n s e   =   c u r r e n t M o n t h . d e p r e c i a t i o n E x p e n s e   | |   0 ;  
                             c o n s t   o p e x O t h e r   =   c u r r e n t M o n t h . o p e x O t h e r   | |   0 ;  
                              
                             c o n s t   t o t a l O p e x   =   o p e x P a y r o l l   +   o w n e r s B a s e P a y   +   o w n e r s R e t i r e m e n t   +   p r o f e s s i o n a l S e r v i c e s   +    
                                                               r e n t L e a s e   +   u t i l i t i e s   +   e q u i p m e n t   +   t r a v e l   +   i n s u r a n c e   +    
                                                               o p e x S a l e s M a r k e t i n g   +   c o n t r a c t o r s D i s t r i b u t i o n   +   d e p r e c i a t i o n E x p e n s e   +   o p e x O t h e r ;  
                              
                             c o n s t   o p e r a t i n g I n c o m e   =   g r o s s P r o f i t   -   t o t a l O p e x ;  
                             c o n s t   o p e r a t i n g M a r g i n   =   r e v e n u e   >   0   ?   ( o p e r a t i n g I n c o m e   /   r e v e n u e )   *   1 0 0   :   0 ;  
                              
                             / /   O t h e r   I n c o m e / E x p e n s e  
                             c o n s t   i n t e r e s t E x p e n s e   =   c u r r e n t M o n t h . i n t e r e s t E x p e n s e   | |   0 ;  
                             c o n s t   n o n O p e r a t i n g I n c o m e   =   c u r r e n t M o n t h . n o n O p e r a t i n g I n c o m e   | |   0 ;  
                             c o n s t   e x t r a o r d i n a r y I t e m s   =   c u r r e n t M o n t h . e x t r a o r d i n a r y I t e m s   | |   0 ;  
                              
                             c o n s t   n e t I n c o m e   =   o p e r a t i n g I n c o m e   -   i n t e r e s t E x p e n s e   +   n o n O p e r a t i n g I n c o m e   +   e x t r a o r d i n a r y I t e m s ;  
                             c o n s t   n e t M a r g i n   =   r e v e n u e   >   0   ?   ( n e t I n c o m e   /   r e v e n u e )   *   1 0 0   :   0 ;  
                              
                             r e t u r n   (  
                                 < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 1 6 p x '   } } >  
                                         < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > I n c o m e   S t a t e m e n t < / h 2 >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > F o r   t h e   M o n t h   E n d e d   { m o n t h N a m e } < / d i v >  
                                     < / d i v >  
  
                                     { / *   R e v e n u e   S e c t i o n   * / }  
                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 8 p x   0 ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > R e v e n u e < / s p a n >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { r e v e n u e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                         < / d i v >  
                                     < / d i v >  
  
                                     { / *   C O G S   S e c t i o n   * / }  
                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                         < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > C o s t   o f   G o o d s   S o l d < / d i v >  
                                         { c o g s P a y r o l l   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C O G S   -   P a y r o l l < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o g s P a y r o l l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { c o g s O w n e r P a y   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C O G S   -   O w n e r   P a y < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o g s O w n e r P a y . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { c o g s C o n t r a c t o r s   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C O G S   -   C o n t r a c t o r s < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o g s C o n t r a c t o r s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { c o g s M a t e r i a l s   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C O G S   -   M a t e r i a l s < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o g s M a t e r i a l s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { c o g s C o m m i s s i o n s   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C O G S   -   C o m m i s s i o n s < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o g s C o m m i s s i o n s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { c o g s O t h e r   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C O G S   -   O t h e r < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o g s O t h e r . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 8 p x   0 ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > T o t a l   C O G S < / s p a n >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { c o g s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                         < / d i v >  
                                     < / d i v >  
  
                                     { / *   G r o s s   P r o f i t   * / }  
                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # d b e a f e ' ,   p a d d i n g :   ' 1 2 p x ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } > G r o s s   P r o f i t < / s p a n >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } > $ { g r o s s P r o f i t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 1 e 4 0 a f ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                             { g r o s s M a r g i n . t o F i x e d ( 1 ) } %   m a r g i n  
                                         < / d i v >  
                                     < / d i v >  
  
                                     { / *   O p e r a t i n g   E x p e n s e s   * / }  
                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                         < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > O p e r a t i n g   E x p e n s e s < / d i v >  
                                         { o p e x P a y r o l l   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > P a y r o l l < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { o p e x P a y r o l l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { o w n e r s B a s e P a y   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > O w n e r ' s   B a s e   P a y < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { o w n e r s B a s e P a y . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { o w n e r s R e t i r e m e n t   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > O w n e r ' s   R e t i r e m e n t < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { o w n e r s R e t i r e m e n t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { p r o f e s s i o n a l S e r v i c e s   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > P r o f e s s i o n a l   S e r v i c e s < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { p r o f e s s i o n a l S e r v i c e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { r e n t L e a s e   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > R e n t / L e a s e < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { r e n t L e a s e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { u t i l i t i e s   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > U t i l i t i e s < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { u t i l i t i e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { e q u i p m e n t   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > E q u i p m e n t < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { e q u i p m e n t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { t r a v e l   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T r a v e l < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { t r a v e l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { i n s u r a n c e   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > I n s u r a n c e < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { i n s u r a n c e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { o p e x S a l e s M a r k e t i n g   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > S a l e s   &   M a r k e t i n g < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { o p e x S a l e s M a r k e t i n g . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { c o n t r a c t o r s D i s t r i b u t i o n   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C o n t r a c t o r s   D i s t r i b u t i o n < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o n t r a c t o r s D i s t r i b u t i o n . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { d e p r e c i a t i o n E x p e n s e   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > D e p r e c i a t i o n   &   A m o r t i z a t i o n < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { d e p r e c i a t i o n E x p e n s e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { o p e x O t h e r   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > O t h e r   O p e r a t i n g   E x p e n s e s < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { o p e x O t h e r . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 8 p x   0 ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > T o t a l   O p e r a t i n g   E x p e n s e s < / s p a n >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { t o t a l O p e x . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                         < / d i v >  
                                     < / d i v >  
  
                                     { / *   O p e r a t i n g   I n c o m e   * / }  
                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # f 0 f d f 4 ' ,   p a d d i n g :   ' 1 2 p x ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 6 6 5 3 4 '   } } > O p e r a t i n g   I n c o m e < / s p a n >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 6 6 5 3 4 '   } } > $ { o p e r a t i n g I n c o m e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 1 6 6 5 3 4 ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                             { o p e r a t i n g M a r g i n . t o F i x e d ( 1 ) } %   m a r g i n  
                                         < / d i v >  
                                     < / d i v >  
  
                                     { / *   O t h e r   I n c o m e / E x p e n s e   * / }  
                                     { ( i n t e r e s t E x p e n s e   >   0   | |   n o n O p e r a t i n g I n c o m e   >   0   | |   e x t r a o r d i n a r y I t e m s   ! = =   0 )   & &   (  
                                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                             < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > O t h e r   I n c o m e / ( E x p e n s e ) < / d i v >  
                                             { n o n O p e r a t i n g I n c o m e   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > N o n - O p e r a t i n g   I n c o m e < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 1 0 b 9 8 1 '   } } > $ { n o n O p e r a t i n g I n c o m e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             { i n t e r e s t E x p e n s e   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > I n t e r e s t   E x p e n s e < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # e f 4 4 4 4 '   } } > ( $     { i n t e r e s t E x p e n s e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } ) < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             { e x t r a o r d i n a r y I t e m s   ! = =   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > E x t r a o r d i n a r y   I t e m s < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   e x t r a o r d i n a r y I t e m s   > =   0   ?   ' # 1 0 b 9 8 1 '   :   ' # e f 4 4 4 4 '   } } >  
                                                         { e x t r a o r d i n a r y I t e m s   > =   0   ?   ' $ '   :   ' ( $ ' } { M a t h . a b s ( e x t r a o r d i n a r y I t e m s ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } { e x t r a o r d i n a r y I t e m s   <   0   ?   ' ) '   :   ' ' }  
                                                     < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                         < / d i v >  
                                     ) }  
  
                                     { / *   N e t   I n c o m e   * / }  
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   n e t I n c o m e   > =   0   ?   ' # d c f c e 7 '   :   ' # f e e 2 e 2 ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   m a r g i n T o p :   ' 3 2 p x '   } } >  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   n e t I n c o m e   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b '   } } > N e t   I n c o m e < / s p a n >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   n e t I n c o m e   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b '   } } >  
                                                 $ { n e t I n c o m e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                             < / s p a n >  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   n e t I n c o m e   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                             { n e t M a r g i n . t o F i x e d ( 1 ) } %   n e t   m a r g i n  
                                         < / d i v >  
                                     < / d i v >  
                                 < / d i v >  
                             ) ;  
                         }   e l s e   i f   ( s t a t e m e n t T y p e   = = =   ' i n c o m e - s t a t e m e n t - p e r c e n t '   & &   s t a t e m e n t P e r i o d   = = =   ' c u r r e n t - m o n t h ' )   {  
                             / /   C o p y   t h e   e n t i r e   c o m m o n   s i z e   l o g i c   f r o m   Q B   v e r s i o n  
                             c o n s t   c u r r e n t M o n t h   =   m o n t h l y [ m o n t h l y . l e n g t h   -   1 ] ;  
                             c o n s t   m o n t h D a t e   =   n e w   D a t e ( c u r r e n t M o n t h . d a t e   | |   c u r r e n t M o n t h . m o n t h ) ;  
                             c o n s t   m o n t h N a m e   =   m o n t h D a t e . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' l o n g ' ,   y e a r :   ' n u m e r i c '   } ) ;  
                              
                             / /   R e v e n u e  
                             c o n s t   r e v e n u e   =   c u r r e n t M o n t h . r e v e n u e   | |   0 ;  
                              
                             / /   C o s t   o f   G o o d s   S o l d  
                             c o n s t   c o g s P a y r o l l   =   c u r r e n t M o n t h . c o g s P a y r o l l   | |   0 ;  
                             c o n s t   c o g s O w n e r P a y   =   c u r r e n t M o n t h . c o g s O w n e r P a y   | |   0 ;  
                             c o n s t   c o g s C o n t r a c t o r s   =   c u r r e n t M o n t h . c o g s C o n t r a c t o r s   | |   0 ;  
                             c o n s t   c o g s M a t e r i a l s   =   c u r r e n t M o n t h . c o g s M a t e r i a l s   | |   0 ;  
                             c o n s t   c o g s C o m m i s s i o n s   =   c u r r e n t M o n t h . c o g s C o m m i s s i o n s   | |   0 ;  
                             c o n s t   c o g s O t h e r   =   c u r r e n t M o n t h . c o g s O t h e r   | |   0 ;  
                             c o n s t   c o g s   =   c o g s P a y r o l l   +   c o g s O w n e r P a y   +   c o g s C o n t r a c t o r s   +   c o g s M a t e r i a l s   +   c o g s C o m m i s s i o n s   +   c o g s O t h e r ;  
                              
                             c o n s t   g r o s s P r o f i t   =   r e v e n u e   -   c o g s ;  
                             c o n s t   g r o s s M a r g i n   =   r e v e n u e   >   0   ?   ( g r o s s P r o f i t   /   r e v e n u e )   *   1 0 0   :   0 ;  
                              
                             / /   O p e r a t i n g   E x p e n s e s  
                             c o n s t   o p e x P a y r o l l   =   c u r r e n t M o n t h . o p e x P a y r o l l   | |   0 ;  
                             c o n s t   o w n e r s B a s e P a y   =   c u r r e n t M o n t h . o w n e r s B a s e P a y   | |   0 ;  
                             c o n s t   o w n e r s R e t i r e m e n t   =   c u r r e n t M o n t h . o w n e r s R e t i r e m e n t   | |   0 ;  
                             c o n s t   p r o f e s s i o n a l S e r v i c e s   =   c u r r e n t M o n t h . p r o f e s s i o n a l S e r v i c e s   | |   0 ;  
                             c o n s t   r e n t L e a s e   =   c u r r e n t M o n t h . r e n t L e a s e   | |   0 ;  
                             c o n s t   u t i l i t i e s   =   c u r r e n t M o n t h . u t i l i t i e s   | |   0 ;  
                             c o n s t   e q u i p m e n t   =   c u r r e n t M o n t h . e q u i p m e n t   | |   0 ;  
                             c o n s t   t r a v e l   =   c u r r e n t M o n t h . t r a v e l   | |   0 ;  
                             c o n s t   i n s u r a n c e   =   c u r r e n t M o n t h . i n s u r a n c e   | |   0 ;  
                             c o n s t   o p e x S a l e s M a r k e t i n g   =   c u r r e n t M o n t h . o p e x S a l e s M a r k e t i n g   | |   0 ;  
                             c o n s t   c o n t r a c t o r s D i s t r i b u t i o n   =   c u r r e n t M o n t h . c o n t r a c t o r s D i s t r i b u t i o n   | |   0 ;  
                             c o n s t   d e p r e c i a t i o n E x p e n s e   =   c u r r e n t M o n t h . d e p r e c i a t i o n E x p e n s e   | |   0 ;  
                             c o n s t   o p e x O t h e r   =   c u r r e n t M o n t h . o p e x O t h e r   | |   0 ;  
                              
                             c o n s t   t o t a l O p e x   =   o p e x P a y r o l l   +   o w n e r s B a s e P a y   +   o w n e r s R e t i r e m e n t   +   p r o f e s s i o n a l S e r v i c e s   +    
                                                               r e n t L e a s e   +   u t i l i t i e s   +   e q u i p m e n t   +   t r a v e l   +   i n s u r a n c e   +    
                                                               o p e x S a l e s M a r k e t i n g   +   c o n t r a c t o r s D i s t r i b u t i o n   +   d e p r e c i a t i o n E x p e n s e   +   o p e x O t h e r ;  
                              
                             c o n s t   o p e r a t i n g I n c o m e   =   g r o s s P r o f i t   -   t o t a l O p e x ;  
                             c o n s t   o p e r a t i n g M a r g i n   =   r e v e n u e   >   0   ?   ( o p e r a t i n g I n c o m e   /   r e v e n u e )   *   1 0 0   :   0 ;  
                              
                             / /   O t h e r   I n c o m e / E x p e n s e  
                             c o n s t   i n t e r e s t E x p e n s e   =   c u r r e n t M o n t h . i n t e r e s t E x p e n s e   | |   0 ;  
                             c o n s t   n o n O p e r a t i n g I n c o m e   =   c u r r e n t M o n t h . n o n O p e r a t i n g I n c o m e   | |   0 ;  
                             c o n s t   e x t r a o r d i n a r y I t e m s   =   c u r r e n t M o n t h . e x t r a o r d i n a r y I t e m s   | |   0 ;  
                              
                             c o n s t   n e t I n c o m e   =   o p e r a t i n g I n c o m e   -   i n t e r e s t E x p e n s e   +   n o n O p e r a t i n g I n c o m e   +   e x t r a o r d i n a r y I t e m s ;  
                             c o n s t   n e t M a r g i n   =   r e v e n u e   >   0   ?   ( n e t I n c o m e   /   r e v e n u e )   *   1 0 0   :   0 ;  
                              
                             / /   H e l p e r   f u n c t i o n   t o   c a l c u l a t e   p e r c e n t a g e  
                             c o n s t   p c t   =   ( a m o u n t :   n u m b e r )   = >   r e v e n u e   >   0   ?   ( a m o u n t   /   r e v e n u e )   *   1 0 0   :   0 ;  
                              
                             r e t u r n   (  
                                 < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 1 6 p x '   } } >  
                                         < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > I n c o m e   S t a t e m e n t   -   C o m m o n   S i z e   A n a l y s i s < / h 2 >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > F o r   t h e   M o n t h   E n d e d   { m o n t h N a m e }        A l l   i t e m s   s h o w n   a s   %   o f   R e v e n u e < / d i v >  
                                     < / d i v >  
  
                                     { / *   C o l u m n   H e a d e r s   * / }  
                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 8 p x   0 ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # c b d 5 e 1 ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } >  
                                         < d i v > L i n e   I t e m < / d i v >  
                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > A m o u n t < / d i v >  
                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > %   o f   R e v e n u e < / d i v >  
                                     < / d i v >  
  
                                     { / *   R e v e n u e   S e c t i o n   * / }  
                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 8 p x   0 ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   b a c k g r o u n d :   ' # f 8 f a f c '   } } >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > R e v e n u e < / s p a n >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { r e v e n u e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } > 1 0 0 . 0 % < / s p a n >  
                                         < / d i v >  
                                     < / d i v >  
  
                                     { / *   C O G S   S e c t i o n   * / }  
                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                         < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   f o n t S i z e :   ' 1 5 p x '   } } > C o s t   o f   G o o d s   S o l d < / d i v >  
                                         { c o g s P a y r o l l   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > C O G S   -   P a y r o l l < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { c o g s P a y r o l l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( c o g s P a y r o l l ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { c o g s O w n e r P a y   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > C O G S   -   O w n e r   P a y < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { c o g s O w n e r P a y . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( c o g s O w n e r P a y ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { c o g s C o n t r a c t o r s   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > C O G S   -   C o n t r a c t o r s < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { c o g s C o n t r a c t o r s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( c o g s C o n t r a c t o r s ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { c o g s M a t e r i a l s   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > C O G S   -   M a t e r i a l s < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { c o g s M a t e r i a l s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( c o g s M a t e r i a l s ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { c o g s C o m m i s s i o n s   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > C O G S   -   C o m m i s s i o n s < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { c o g s C o m m i s s i o n s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( c o g s C o m m i s s i o n s ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { c o g s O t h e r   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > C O G S   -   O t h e r < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { c o g s O t h e r . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( c o g s O t h e r ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 8 p x   0 ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > T o t a l   C O G S < / s p a n >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { c o g s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( c o g s ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                         < / d i v >  
                                     < / d i v >  
  
                                     { / *   G r o s s   P r o f i t   * / }  
                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # d b e a f e ' ,   p a d d i n g :   ' 1 2 p x ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r '   } } >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } > G r o s s   P r o f i t < / s p a n >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { g r o s s P r o f i t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f ' ,   t e x t A l i g n :   ' r i g h t '   } } > { g r o s s M a r g i n . t o F i x e d ( 1 ) } % < / s p a n >  
                                         < / d i v >  
                                     < / d i v >  
  
                                     { / *   O p e r a t i n g   E x p e n s e s   * / }  
                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                         < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   f o n t S i z e :   ' 1 5 p x '   } } > O p e r a t i n g   E x p e n s e s < / d i v >  
                                         { o p e x P a y r o l l   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > P a y r o l l < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { o p e x P a y r o l l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( o p e x P a y r o l l ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { o w n e r s B a s e P a y   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > O w n e r ' s   B a s e   P a y < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { o w n e r s B a s e P a y . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( o w n e r s B a s e P a y ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { o w n e r s R e t i r e m e n t   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > O w n e r ' s   R e t i r e m e n t < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { o w n e r s R e t i r e m e n t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( o w n e r s R e t i r e m e n t ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { p r o f e s s i o n a l S e r v i c e s   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > P r o f e s s i o n a l   S e r v i c e s < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { p r o f e s s i o n a l S e r v i c e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( p r o f e s s i o n a l S e r v i c e s ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { r e n t L e a s e   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > R e n t / L e a s e < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { r e n t L e a s e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( r e n t L e a s e ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { u t i l i t i e s   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > U t i l i t i e s < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { u t i l i t i e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( u t i l i t i e s ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { e q u i p m e n t   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > E q u i p m e n t < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { e q u i p m e n t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( e q u i p m e n t ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { t r a v e l   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > T r a v e l < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { t r a v e l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( t r a v e l ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { i n s u r a n c e   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > I n s u r a n c e < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { i n s u r a n c e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( i n s u r a n c e ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { o p e x S a l e s M a r k e t i n g   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > S a l e s   &   M a r k e t i n g < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { o p e x S a l e s M a r k e t i n g . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( o p e x S a l e s M a r k e t i n g ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { c o n t r a c t o r s D i s t r i b u t i o n   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > C o n t r a c t o r s   D i s t r i b u t i o n < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { c o n t r a c t o r s D i s t r i b u t i o n . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( c o n t r a c t o r s D i s t r i b u t i o n ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { d e p r e c i a t i o n E x p e n s e   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > D e p r e c i a t i o n   &   A m o r t i z a t i o n < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { d e p r e c i a t i o n E x p e n s e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( d e p r e c i a t i o n E x p e n s e ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { o p e x O t h e r   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > O t h e r   O p e r a t i n g   E x p e n s e s < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { o p e x O t h e r . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( o p e x O t h e r ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 8 p x   0 ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > T o t a l   O p e r a t i n g   E x p e n s e s < / s p a n >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { t o t a l O p e x . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( t o t a l O p e x ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                         < / d i v >  
                                     < / d i v >  
  
                                     { / *   O p e r a t i n g   I n c o m e   * / }  
                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # f 0 f d f 4 ' ,   p a d d i n g :   ' 1 2 p x ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r '   } } >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 6 6 5 3 4 '   } } > O p e r a t i n g   I n c o m e < / s p a n >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 6 6 5 3 4 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { o p e r a t i n g I n c o m e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 6 6 5 3 4 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { o p e r a t i n g M a r g i n . t o F i x e d ( 1 ) } % < / s p a n >  
                                         < / d i v >  
                                     < / d i v >  
  
                                     { / *   O t h e r   I n c o m e / E x p e n s e   * / }  
                                     { ( i n t e r e s t E x p e n s e   >   0   | |   n o n O p e r a t i n g I n c o m e   >   0   | |   e x t r a o r d i n a r y I t e m s   ! = =   0 )   & &   (  
                                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                             < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   f o n t S i z e :   ' 1 5 p x '   } } > O t h e r   I n c o m e / ( E x p e n s e ) < / d i v >  
                                             { n o n O p e r a t i n g I n c o m e   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > N o n - O p e r a t i n g   I n c o m e < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 1 0 b 9 8 1 ' ,   t e x t A l i g n :   ' r i g h t '   } } > $ { n o n O p e r a t i n g I n c o m e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 1 0 b 9 8 1 ' ,   t e x t A l i g n :   ' r i g h t '   } } > { p c t ( n o n O p e r a t i n g I n c o m e ) . t o F i x e d ( 1 ) } % < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             { i n t e r e s t E x p e n s e   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > I n t e r e s t   E x p e n s e < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # e f 4 4 4 4 ' ,   t e x t A l i g n :   ' r i g h t '   } } > ( $     { i n t e r e s t E x p e n s e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } ) < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # e f 4 4 4 4 ' ,   t e x t A l i g n :   ' r i g h t '   } } > ( { p c t ( i n t e r e s t E x p e n s e ) . t o F i x e d ( 1 ) } % ) < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             { e x t r a o r d i n a r y I t e m s   ! = =   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > E x t r a o r d i n a r y   I t e m s < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   e x t r a o r d i n a r y I t e m s   > =   0   ?   ' # 1 0 b 9 8 1 '   :   ' # e f 4 4 4 4 ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                         { e x t r a o r d i n a r y I t e m s   > =   0   ?   ' $ '   :   ' ( $ ' } { M a t h . a b s ( e x t r a o r d i n a r y I t e m s ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } { e x t r a o r d i n a r y I t e m s   <   0   ?   ' ) '   :   ' ' }  
                                                     < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   e x t r a o r d i n a r y I t e m s   > =   0   ?   ' # 1 0 b 9 8 1 '   :   ' # e f 4 4 4 4 ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                         { e x t r a o r d i n a r y I t e m s   > =   0   ?   ' '   :   ' ( ' } { p c t ( M a t h . a b s ( e x t r a o r d i n a r y I t e m s ) ) . t o F i x e d ( 1 ) } % { e x t r a o r d i n a r y I t e m s   <   0   ?   ' ) '   :   ' ' }  
                                                     < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                         < / d i v >  
                                     ) }  
  
                                     { / *   N e t   I n c o m e   * / }  
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   n e t I n c o m e   > =   0   ?   ' # d c f c e 7 '   :   ' # f e e 2 e 2 ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   m a r g i n T o p :   ' 3 2 p x '   } } >  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 f r   1 f r   1 f r '   } } >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   n e t I n c o m e   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b '   } } > N e t   I n c o m e < / s p a n >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   n e t I n c o m e   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                 $ { n e t I n c o m e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) }  
                                             < / s p a n >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   n e t I n c o m e   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                 { n e t M a r g i n . t o F i x e d ( 1 ) } %  
                                             < / s p a n >  
                                         < / d i v >  
                                     < / d i v >  
                                 < / d i v >  
                             ) ;  
                         }   e l s e   i f   ( s t a t e m e n t T y p e   = = =   ' b a l a n c e - s h e e t '   & &   s t a t e m e n t P e r i o d   = = =   ' c u r r e n t - m o n t h ' )   {  
                             c o n s t   c u r r e n t M o n t h   =   m o n t h l y [ m o n t h l y . l e n g t h   -   1 ] ;  
                             c o n s t   m o n t h D a t e   =   n e w   D a t e ( c u r r e n t M o n t h . d a t e   | |   c u r r e n t M o n t h . m o n t h ) ;  
                             c o n s t   m o n t h N a m e   =   m o n t h D a t e . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' l o n g ' ,   y e a r :   ' n u m e r i c '   } ) ;  
                              
                             / /   A s s e t s  
                             c o n s t   c a s h   =   c u r r e n t M o n t h . c a s h   | |   0 ;  
                             c o n s t   a r   =   c u r r e n t M o n t h . a r   | |   0 ;  
                             c o n s t   i n v e n t o r y   =   c u r r e n t M o n t h . i n v e n t o r y   | |   0 ;  
                             c o n s t   o t h e r C A   =   c u r r e n t M o n t h . o t h e r C A   | |   0 ;  
                             c o n s t   t c a   =   c a s h   +   a r   +   i n v e n t o r y   +   o t h e r C A ;  
                              
                             c o n s t   f i x e d A s s e t s   =   c u r r e n t M o n t h . f i x e d A s s e t s   | |   0 ;  
                             c o n s t   o t h e r A s s e t s   =   c u r r e n t M o n t h . o t h e r A s s e t s   | |   0 ;  
                             c o n s t   t o t a l A s s e t s   =   t c a   +   f i x e d A s s e t s   +   o t h e r A s s e t s ;  
                              
                             / /   L i a b i l i t i e s  
                             c o n s t   a p   =   c u r r e n t M o n t h . a p   | |   0 ;  
                             c o n s t   o t h e r C L   =   c u r r e n t M o n t h . o t h e r C L   | |   0 ;  
                             c o n s t   t c l   =   a p   +   o t h e r C L ;  
                              
                             c o n s t   l t d   =   c u r r e n t M o n t h . l t d   | |   0 ;  
                             c o n s t   t o t a l L i a b i l i t i e s   =   t c l   +   l t d ;  
                              
                             / /   E q u i t y  
                             c o n s t   t o t a l E q u i t y   =   c u r r e n t M o n t h . t o t a l E q u i t y   | |   0 ;  
                              
                             / /   T o t a l   L & E  
                             c o n s t   t o t a l L A n d E   =   t o t a l L i a b i l i t i e s   +   t o t a l E q u i t y ;  
                              
                             r e t u r n   (  
                                 < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 1 6 p x '   } } >  
                                         < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > B a l a n c e   S h e e t < / h 2 >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > A s   o f   { m o n t h N a m e } < / d i v >  
                                     < / d i v >  
  
                                     { / *   A S S E T S   * / }  
                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x ' ,   p a d d i n g B o t t o m :   ' 8 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # 6 6 7 e e a '   } } > A S S E T S < / d i v >  
                                          
                                         { / *   C u r r e n t   A s s e t s   * / }  
                                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                                             < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   f o n t S i z e :   ' 1 5 p x '   } } > C u r r e n t   A s s e t s < / d i v >  
                                             { c a s h   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C a s h < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c a s h . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             { a r   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > A c c o u n t s   R e c e i v a b l e < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { a r . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             { i n v e n t o r y   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > I n v e n t o r y < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { i n v e n t o r y . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             { o t h e r C A   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > O t h e r   C u r r e n t   A s s e t s < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { o t h e r C A . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 8 p x   0   8 p x   2 0 p x ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > T o t a l   C u r r e n t   A s s e t s < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { t c a . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                             < / d i v >  
                                         < / d i v >  
  
                                         { / *   N o n - C u r r e n t   A s s e t s   * / }  
                                         { f i x e d A s s e t s   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > F i x e d   A s s e t s < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { f i x e d A s s e t s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                         { o t h e r A s s e t s   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > O t h e r   A s s e t s < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { o t h e r A s s e t s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                          
                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 1 2 p x   0 ' ,   b o r d e r T o p :   ' 2 p x   s o l i d   # 6 6 7 e e a ' ,   m a r g i n T o p :   ' 8 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c '   } } >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > T O T A L   A S S E T S < / s p a n >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { t o t a l A s s e t s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                         < / d i v >  
                                     < / d i v >  
  
                                     { / *   L I A B I L I T I E S   * / }  
                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x ' ,   p a d d i n g B o t t o m :   ' 8 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # f 5 9 e 0 b '   } } > L I A B I L I T I E S < / d i v >  
                                          
                                         { / *   C u r r e n t   L i a b i l i t i e s   * / }  
                                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x '   } } >  
                                             < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   f o n t S i z e :   ' 1 5 p x '   } } > C u r r e n t   L i a b i l i t i e s < / d i v >  
                                             { a p   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > A c c o u n t s   P a y a b l e < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { a p . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             { o t h e r C L   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > O t h e r   C u r r e n t   L i a b i l i t i e s < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { o t h e r C L . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 8 p x   0   8 p x   2 0 p x ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > T o t a l   C u r r e n t   L i a b i l i t i e s < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { t c l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                             < / d i v >  
                                         < / d i v >  
  
                                         { / *   L o n g - t e r m   D e b t   * / }  
                                         { l t d   >   0   & &   (  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > L o n g - t e r m   D e b t < / s p a n >  
                                                 < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { l t d . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                             < / d i v >  
                                         ) }  
                                          
                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 1 2 p x   0 ' ,   b o r d e r T o p :   ' 2 p x   s o l i d   # f 5 9 e 0 b ' ,   m a r g i n T o p :   ' 8 p x ' ,   b a c k g r o u n d :   ' # f e f 3 c 7 '   } } >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > T O T A L   L I A B I L I T I E S < / s p a n >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { t o t a l L i a b i l i t i e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                         < / d i v >  
                                     < / d i v >  
  
                                     { / *   E Q U I T Y   * / }  
                                     < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x ' ,   p a d d i n g B o t t o m :   ' 8 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # 1 0 b 9 8 1 '   } } > E Q U I T Y < / d i v >  
                                          
                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 1 2 p x   0 ' ,   b o r d e r T o p :   ' 2 p x   s o l i d   # 1 0 b 9 8 1 ' ,   b a c k g r o u n d :   ' # d 1 f a e 5 '   } } >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > T O T A L   E Q U I T Y < / s p a n >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { t o t a l E q u i t y . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                         < / d i v >  
                                     < / d i v >  
  
                                     { / *   T O T A L   L I A B I L I T I E S   &   E Q U I T Y   * / }  
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 1 f 5 f 9 ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   m a r g i n T o p :   ' 3 2 p x '   } } >  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > T O T A L   L I A B I L I T I E S   &   E Q U I T Y < / s p a n >  
                                             < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } >  
                                                 $ { t o t a l L A n d E . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                             < / s p a n >  
                                         < / d i v >  
                                         { M a t h . a b s ( t o t a l A s s e t s   -   t o t a l L A n d E )   >   0 . 0 1   & &   (  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # e f 4 4 4 4 ' ,   m a r g i n T o p :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                  a      B a l a n c e   c h e c k :   A s s e t s   -   ( L i a b i l i t i e s   +   E q u i t y )   =   $ { ( t o t a l A s s e t s   -   t o t a l L A n d E ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                             < / d i v >  
                                         ) }  
                                     < / d i v >  
                                 < / d i v >  
                             ) ;  
                         }  
                          
                         / /   M u l t i - p e r i o d   l o g i c   ( C u r r e n t   Q u a r t e r ,   L a s t   1 2   M o n t h s ,   Y T D ,   L a s t   Y e a r ,   L a s t   3   Y e a r s )  
                         e l s e   i f   ( m o n t h l y . l e n g t h   >   0   & &   s t a t e m e n t P e r i o d   ! = =   ' c u r r e n t - m o n t h ' )   {  
                             / /   H e l p e r   f u n c t i o n   t o   g e t   m o n t h s   f o r   t h e   s e l e c t e d   p e r i o d  
                             c o n s t   g e t M o n t h s F o r P e r i o d   =   ( )   = >   {  
                                 c o n s t   n o w   =   n e w   D a t e ( ) ;  
                                 c o n s t   c u r r e n t Y e a r   =   n o w . g e t F u l l Y e a r ( ) ;  
                                 c o n s t   c u r r e n t M o n t h   =   n o w . g e t M o n t h ( ) ;   / /   0 - 1 1  
                                  
                                 s w i t c h   ( s t a t e m e n t P e r i o d )   {  
                                     c a s e   ' c u r r e n t - q u a r t e r ' :  
                                         / /   L a s t   3   m o n t h s  
                                         r e t u r n   m o n t h l y . s l i c e ( - 3 ) ;  
                                      
                                     c a s e   ' l a s t - 1 2 - m o n t h s ' :  
                                         / /   L a s t   1 2   m o n t h s  
                                         r e t u r n   m o n t h l y . s l i c e ( - 1 2 ) ;  
                                      
                                     c a s e   ' y t d ' :  
                                         / /   Y e a r   t o   d a t e   -   f r o m   J a n u a r y   o f   c u r r e n t   y e a r   t o   n o w  
                                         r e t u r n   m o n t h l y . f i l t e r ( m   = >   {  
                                             c o n s t   m D a t e   =   n e w   D a t e ( m . d a t e   | |   m . m o n t h ) ;  
                                             r e t u r n   m D a t e . g e t F u l l Y e a r ( )   = = =   c u r r e n t Y e a r ;  
                                         } ) ;  
                                      
                                     c a s e   ' l a s t - y e a r ' :  
                                         / /   F u l l   p r e v i o u s   y e a r  
                                         r e t u r n   m o n t h l y . f i l t e r ( m   = >   {  
                                             c o n s t   m D a t e   =   n e w   D a t e ( m . d a t e   | |   m . m o n t h ) ;  
                                             r e t u r n   m D a t e . g e t F u l l Y e a r ( )   = = =   c u r r e n t Y e a r   -   1 ;  
                                         } ) ;  
                                      
                                     c a s e   ' l a s t - 3 - y e a r s ' :  
                                         / /   L a s t   3 6   m o n t h s  
                                         r e t u r n   m o n t h l y . s l i c e ( - 3 6 ) ;  
                                      
                                     d e f a u l t :  
                                         r e t u r n   [ ] ;  
                                 }  
                             } ;  
                              
                             c o n s t   p e r i o d M o n t h s   =   g e t M o n t h s F o r P e r i o d ( ) ;  
                              
                             i f   ( p e r i o d M o n t h s . l e n g t h   = = =   0 )   {  
                                 r e t u r n   (  
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 4 8 p x   3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   m i n H e i g h t :   ' 4 0 0 p x ' ,   t e x t A l i g n :   ' c e n t e r '   } } >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                              x `  N o   D a t a   A v a i l a b l e  
                                         < / d i v >  
                                         < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 9 4 a 3 b 8 '   } } >  
                                             N o   f i n a n c i a l   d a t a   a v a i l a b l e   f o r   t h e   s e l e c t e d   p e r i o d .  
                                         < / p >  
                                     < / d i v >  
                                 ) ;  
                             }  
                              
                             / /   G e t   p e r i o d   l a b e l  
                             c o n s t   g e t P e r i o d L a b e l   =   ( )   = >   {  
                                 c o n s t   f i r s t M o n t h   =   p e r i o d M o n t h s [ 0 ] ;  
                                 c o n s t   l a s t M o n t h   =   p e r i o d M o n t h s [ p e r i o d M o n t h s . l e n g t h   -   1 ] ;  
                                 c o n s t   f i r s t D a t e   =   n e w   D a t e ( f i r s t M o n t h . d a t e   | |   f i r s t M o n t h . m o n t h ) ;  
                                 c o n s t   l a s t D a t e   =   n e w   D a t e ( l a s t M o n t h . d a t e   | |   l a s t M o n t h . m o n t h ) ;  
                                  
                                 s w i t c h   ( s t a t e m e n t P e r i o d )   {  
                                     c a s e   ' c u r r e n t - q u a r t e r ' :  
                                         r e t u r n   ` C u r r e n t   Q u a r t e r   ( $ { f i r s t D a t e . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' s h o r t ' ,   y e a r :   ' n u m e r i c '   } ) }   -   $ { l a s t D a t e . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' s h o r t ' ,   y e a r :   ' n u m e r i c '   } ) } ) ` ;  
                                     c a s e   ' l a s t - 1 2 - m o n t h s ' :  
                                         r e t u r n   ` L a s t   1 2   M o n t h s   ( $ { f i r s t D a t e . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' s h o r t ' ,   y e a r :   ' n u m e r i c '   } ) }   -   $ { l a s t D a t e . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' s h o r t ' ,   y e a r :   ' n u m e r i c '   } ) } ) ` ;  
                                     c a s e   ' y t d ' :  
                                         r e t u r n   ` Y e a r   t o   D a t e   $ { l a s t D a t e . g e t F u l l Y e a r ( ) }   ( J a n   -   $ { l a s t D a t e . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' s h o r t '   } ) } ) ` ;  
                                     c a s e   ' l a s t - y e a r ' :  
                                         r e t u r n   ` F i s c a l   Y e a r   $ { f i r s t D a t e . g e t F u l l Y e a r ( ) } ` ;  
                                     c a s e   ' l a s t - 3 - y e a r s ' :  
                                         r e t u r n   ` L a s t   3   Y e a r s   ( $ { f i r s t D a t e . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' s h o r t ' ,   y e a r :   ' n u m e r i c '   } ) }   -   $ { l a s t D a t e . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' s h o r t ' ,   y e a r :   ' n u m e r i c '   } ) } ) ` ;  
                                     d e f a u l t :  
                                         r e t u r n   ' ' ;  
                                 }  
                             } ;  
                              
                             c o n s t   p e r i o d L a b e l   =   g e t P e r i o d L a b e l ( ) ;  
                             c o n s t   l a t e s t M o n t h   =   p e r i o d M o n t h s [ p e r i o d M o n t h s . l e n g t h   -   1 ] ;  
                              
                             / /   H e l p e r   f u n c t i o n   t o   g r o u p   m o n t h s   b y   d i s p l a y   p e r i o d  
                             c o n s t   g r o u p M o n t h s B y D i s p l a y   =   ( )   = >   {  
                                 i f   ( s t a t e m e n t D i s p l a y   = = =   ' m o n t h l y ' )   {  
                                     / /   E a c h   m o n t h   i s   i t s   o w n   p e r i o d  
                                     r e t u r n   p e r i o d M o n t h s . m a p ( m   = >   ( {  
                                         l a b e l :   n e w   D a t e ( m . d a t e   | |   m . m o n t h ) . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' s h o r t ' ,   y e a r :   ' n u m e r i c '   } ) ,  
                                         m o n t h s :   [ m ]  
                                     } ) ) ;  
                                 }   e l s e   i f   ( s t a t e m e n t D i s p l a y   = = =   ' q u a r t e r l y ' )   {  
                                     / /   G r o u p   b y   q u a r t e r  
                                     c o n s t   q u a r t e r s :   {   [ k e y :   s t r i n g ] :   a n y [ ]   }   =   { } ;  
                                     p e r i o d M o n t h s . f o r E a c h ( m   = >   {  
                                         c o n s t   d a t e   =   n e w   D a t e ( m . d a t e   | |   m . m o n t h ) ;  
                                         c o n s t   y e a r   =   d a t e . g e t F u l l Y e a r ( ) ;  
                                         c o n s t   q u a r t e r   =   M a t h . f l o o r ( d a t e . g e t M o n t h ( )   /   3 )   +   1 ;  
                                         c o n s t   k e y   =   ` $ { y e a r } - Q $ { q u a r t e r } ` ;  
                                         i f   ( ! q u a r t e r s [ k e y ] )   q u a r t e r s [ k e y ]   =   [ ] ;  
                                         q u a r t e r s [ k e y ] . p u s h ( m ) ;  
                                     } ) ;  
                                     r e t u r n   O b j e c t . e n t r i e s ( q u a r t e r s ) . m a p ( ( [ k e y ,   m o n t h s ] )   = >   ( {  
                                         l a b e l :   k e y ,  
                                         m o n t h s  
                                     } ) ) ;  
                                 }   e l s e   {  
                                     / /   A n n u a l   -   g r o u p   b y   y e a r  
                                     c o n s t   y e a r s :   {   [ k e y :   s t r i n g ] :   a n y [ ]   }   =   { } ;  
                                     p e r i o d M o n t h s . f o r E a c h ( m   = >   {  
                                         c o n s t   y e a r   =   n e w   D a t e ( m . d a t e   | |   m . m o n t h ) . g e t F u l l Y e a r ( ) . t o S t r i n g ( ) ;  
                                         i f   ( ! y e a r s [ y e a r ] )   y e a r s [ y e a r ]   =   [ ] ;  
                                         y e a r s [ y e a r ] . p u s h ( m ) ;  
                                     } ) ;  
                                     r e t u r n   O b j e c t . e n t r i e s ( y e a r s ) . m a p ( ( [ y e a r ,   m o n t h s ] )   = >   ( {  
                                         l a b e l :   y e a r ,  
                                         m o n t h s  
                                     } ) ) ;  
                                 }  
                             } ;  
                              
                             c o n s t   d i s p l a y P e r i o d s   =   g r o u p M o n t h s B y D i s p l a y ( ) ;  
                              
                             / /   I N C O M E   S T A T E M E N T   -   A g g r e g a t e   a c r o s s   p e r i o d  
                             i f   ( s t a t e m e n t T y p e   = = =   ' i n c o m e - s t a t e m e n t ' )   {  
                                 / /   C h e c k   i f   w e ' r e   s h o w i n g   m u l t i p l e   p e r i o d s   s i d e - b y - s i d e  
                                 i f   ( d i s p l a y P e r i o d s . l e n g t h   >   1 )   {  
                                 / /   M u l t i - c o l u m n   c o m p a r a t i v e   i n c o m e   s t a t e m e n t  
                                 c o n s t   c a l c u l a t e P e r i o d D a t a   =   ( m o n t h s :   a n y [ ] )   = >   {  
                                     c o n s t   r e v e n u e   =   m o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . r e v e n u e   | |   0 ) ,   0 ) ;  
                                      
                                     / /   C O G S   d e t a i l e d  
                                     c o n s t   c o g s P a y r o l l   =   m o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s P a y r o l l   | |   0 ) ,   0 ) ;  
                                     c o n s t   c o g s O w n e r P a y   =   m o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s O w n e r P a y   | |   0 ) ,   0 ) ;  
                                     c o n s t   c o g s C o n t r a c t o r s   =   m o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s C o n t r a c t o r s   | |   0 ) ,   0 ) ;  
                                     c o n s t   c o g s M a t e r i a l s   =   m o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s M a t e r i a l s   | |   0 ) ,   0 ) ;  
                                     c o n s t   c o g s C o m m i s s i o n s   =   m o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s C o m m i s s i o n s   | |   0 ) ,   0 ) ;  
                                     c o n s t   c o g s O t h e r   =   m o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s O t h e r   | |   0 ) ,   0 ) ;  
                                     c o n s t   c o g s   =   c o g s P a y r o l l   +   c o g s O w n e r P a y   +   c o g s C o n t r a c t o r s   +   c o g s M a t e r i a l s   +   c o g s C o m m i s s i o n s   +   c o g s O t h e r ;  
                                     c o n s t   g r o s s P r o f i t   =   r e v e n u e   -   c o g s ;  
                                      
                                     / /   O p e r a t i n g   E x p e n s e s   d e t a i l e d  
                                     c o n s t   o p e x P a y r o l l   =   m o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . o p e x P a y r o l l   | |   0 ) ,   0 ) ;  
                                     c o n s t   o w n e r s B a s e P a y   =   m o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . o w n e r s B a s e P a y   | |   0 ) ,   0 ) ;  
                                     c o n s t   o w n e r s R e t i r e m e n t   =   m o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . o w n e r s R e t i r e m e n t   | |   0 ) ,   0 ) ;  
                                     c o n s t   p r o f e s s i o n a l S e r v i c e s   =   m o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . p r o f e s s i o n a l S e r v i c e s   | |   0 ) ,   0 ) ;  
                                     c o n s t   r e n t L e a s e   =   m o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . r e n t L e a s e   | |   0 ) ,   0 ) ;  
                                     c o n s t   u t i l i t i e s   =   m o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . u t i l i t i e s   | |   0 ) ,   0 ) ;  
                                     c o n s t   e q u i p m e n t   =   m o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . e q u i p m e n t   | |   0 ) ,   0 ) ;  
                                     c o n s t   t r a v e l   =   m o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . t r a v e l   | |   0 ) ,   0 ) ;  
                                     c o n s t   i n s u r a n c e   =   m o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . i n s u r a n c e   | |   0 ) ,   0 ) ;  
                                     c o n s t   o p e x S a l e s M a r k e t i n g   =   m o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . o p e x S a l e s M a r k e t i n g   | |   0 ) ,   0 ) ;  
                                     c o n s t   c o n t r a c t o r s D i s t r i b u t i o n   =   m o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o n t r a c t o r s D i s t r i b u t i o n   | |   0 ) ,   0 ) ;  
                                     c o n s t   d e p r e c i a t i o n E x p e n s e   =   m o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . d e p r e c i a t i o n E x p e n s e   | |   0 ) ,   0 ) ;  
                                     c o n s t   o p e x O t h e r   =   m o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . o p e x O t h e r   | |   0 ) ,   0 ) ;  
                                     c o n s t   t o t a l O p e x   =   o p e x P a y r o l l   +   o w n e r s B a s e P a y   +   o w n e r s R e t i r e m e n t   +   p r o f e s s i o n a l S e r v i c e s   +    
                                                                       r e n t L e a s e   +   u t i l i t i e s   +   e q u i p m e n t   +   t r a v e l   +   i n s u r a n c e   +    
                                                                       o p e x S a l e s M a r k e t i n g   +   c o n t r a c t o r s D i s t r i b u t i o n   +   d e p r e c i a t i o n E x p e n s e   +   o p e x O t h e r ;  
                                     c o n s t   o p e r a t i n g I n c o m e   =   g r o s s P r o f i t   -   t o t a l O p e x ;  
                                      
                                     / /   O t h e r   I n c o m e / E x p e n s e  
                                     c o n s t   i n t e r e s t E x p e n s e   =   m o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . i n t e r e s t E x p e n s e   | |   0 ) ,   0 ) ;  
                                     c o n s t   n o n O p e r a t i n g I n c o m e   =   m o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . n o n O p e r a t i n g I n c o m e   | |   0 ) ,   0 ) ;  
                                     c o n s t   e x t r a o r d i n a r y I t e m s   =   m o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . e x t r a o r d i n a r y I t e m s   | |   0 ) ,   0 ) ;  
                                     c o n s t   n e t I n c o m e   =   o p e r a t i n g I n c o m e   -   i n t e r e s t E x p e n s e   +   n o n O p e r a t i n g I n c o m e   +   e x t r a o r d i n a r y I t e m s ;  
                                      
                                     r e t u r n   {    
                                         r e v e n u e ,    
                                         c o g s P a y r o l l ,   c o g s O w n e r P a y ,   c o g s C o n t r a c t o r s ,   c o g s M a t e r i a l s ,   c o g s C o m m i s s i o n s ,   c o g s O t h e r ,   c o g s ,    
                                         g r o s s P r o f i t ,    
                                         o p e x P a y r o l l ,   o w n e r s B a s e P a y ,   o w n e r s R e t i r e m e n t ,   p r o f e s s i o n a l S e r v i c e s ,   r e n t L e a s e ,   u t i l i t i e s ,    
                                         e q u i p m e n t ,   t r a v e l ,   i n s u r a n c e ,   o p e x S a l e s M a r k e t i n g ,   c o n t r a c t o r s D i s t r i b u t i o n ,   d e p r e c i a t i o n E x p e n s e ,   o p e x O t h e r ,   t o t a l O p e x ,  
                                         o p e r a t i n g I n c o m e ,    
                                         i n t e r e s t E x p e n s e ,   n o n O p e r a t i n g I n c o m e ,   e x t r a o r d i n a r y I t e m s ,    
                                         n e t I n c o m e    
                                     } ;  
                                 } ;  
                                      
                                     c o n s t   p e r i o d s D a t a   =   d i s p l a y P e r i o d s . m a p ( p   = >   ( {  
                                         l a b e l :   p . l a b e l ,  
                                         . . . c a l c u l a t e P e r i o d D a t a ( p . m o n t h s )  
                                     } ) ) ;  
                                      
                                     r e t u r n   (  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   o v e r f l o w X :   ' a u t o '   } } >  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 1 6 p x '   } } >  
                                                 < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > C o m p a r a t i v e   I n c o m e   S t a t e m e n t < / h 2 >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { p e r i o d L a b e l }   -   { s t a t e m e n t D i s p l a y   = = =   ' m o n t h l y '   ?   ' M o n t h l y '   :   s t a t e m e n t D i s p l a y   = = =   ' q u a r t e r l y '   ?   ' Q u a r t e r l y '   :   ' A n n u a l ' } < / d i v >  
                                             < / d i v >  
                                              
                                             { / *   T a b l e   w i t h   m u l t i p l e   c o l u m n s   * / }  
                                             < d i v   s t y l e = { {   m i n W i d t h :   ` $ { 2 0 0   +   ( p e r i o d s D a t a . l e n g t h   *   1 1 0 ) } p x `   } } >  
                                                 { / *   H e a d e r   R o w   * / }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 2 p x   0 ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # 1 e 2 9 3 b ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   p o s i t i o n :   ' s t i c k y ' ,   t o p :   0 ,   b a c k g r o u n d :   ' w h i t e '   } } >  
                                                     < d i v > L i n e   I t e m < / d i v >  
                                                     { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                         < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > { p . l a b e l } < / d i v >  
                                                     ) ) }  
                                                 < / d i v >  
                                                  
                                                 { / *   R e v e n u e   * / }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 8 p x   0 ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                     < d i v   s t y l e = { {   c o l o r :   ' # 1 e 2 9 3 b '   } } > R e v e n u e < / d i v >  
                                                     { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                         < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { ( p . r e v e n u e   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                     ) ) }  
                                                 < / d i v >  
                                                  
                                                 { / *   C O G S   S e c t i o n   H e a d e r   * / }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 2 p x   0   4 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   m a r g i n T o p :   ' 8 p x '   } } >  
                                                     < d i v   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C o s t   o f   G o o d s   S o l d < / d i v >  
                                                     { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   < d i v   k e y = { i } > < / d i v > ) }  
                                                 < / d i v >  
                                                  
                                                 { / *   C O G S   D e t a i l s   * / }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . c o g s P a y r o l l   >   0 )   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > C O G S   -   P a y r o l l < / d i v >  
                                                         { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . c o g s P a y r o l l   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                 ) }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . c o g s O w n e r P a y   >   0 )   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > C O G S   -   O w n e r   P a y < / d i v >  
                                                         { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . c o g s O w n e r P a y   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                 ) }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . c o g s C o n t r a c t o r s   >   0 )   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > C O G S   -   C o n t r a c t o r s < / d i v >  
                                                         { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . c o g s C o n t r a c t o r s   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                 ) }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . c o g s M a t e r i a l s   >   0 )   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > C O G S   -   M a t e r i a l s < / d i v >  
                                                         { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . c o g s M a t e r i a l s   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                 ) }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . c o g s C o m m i s s i o n s   >   0 )   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > C O G S   -   C o m m i s s i o n s < / d i v >  
                                                         { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . c o g s C o m m i s s i o n s   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                 ) }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . c o g s O t h e r   >   0 )   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > C O G S   -   O t h e r < / d i v >  
                                                         { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . c o g s O t h e r   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                 ) }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                                     < d i v   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T o t a l   C O G S < / d i v >  
                                                     { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                         < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { ( p . c o g s   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                     ) ) }  
                                                 < / d i v >  
                                                  
                                                 { / *   G r o s s   P r o f i t   * / }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 0 p x   8 p x ' ,   b a c k g r o u n d :   ' # d b e a f e ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   m a r g i n T o p :   ' 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 '   } } >  
                                                     < d i v   s t y l e = { {   c o l o r :   ' # 1 e 4 0 a f '   } } > G r o s s   P r o f i t < / d i v >  
                                                     { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                         < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } > $ { ( p . g r o s s P r o f i t   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                     ) ) }  
                                                 < / d i v >  
                                                  
                                                 { / *   O p e r a t i n g   E x p e n s e s   S e c t i o n   H e a d e r   * / }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 2 p x   0   4 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   m a r g i n T o p :   ' 1 2 p x '   } } >  
                                                     < d i v   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > O p e r a t i n g   E x p e n s e s < / d i v >  
                                                     { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   < d i v   k e y = { i } > < / d i v > ) }  
                                                 < / d i v >  
                                                  
                                                 { / *   O p e r a t i n g   E x p e n s e s   D e t a i l s   * / }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . o p e x P a y r o l l   >   0 )   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > P a y r o l l < / d i v >  
                                                         { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . o p e x P a y r o l l   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                 ) }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . o w n e r s B a s e P a y   >   0 )   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > O w n e r ' s   B a s e   P a y < / d i v >  
                                                         { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . o w n e r s B a s e P a y   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                 ) }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . o w n e r s R e t i r e m e n t   >   0 )   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > O w n e r ' s   R e t i r e m e n t < / d i v >  
                                                         { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . o w n e r s R e t i r e m e n t   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                 ) }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . p r o f e s s i o n a l S e r v i c e s   >   0 )   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > P r o f e s s i o n a l   S e r v i c e s < / d i v >  
                                                         { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . p r o f e s s i o n a l S e r v i c e s   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                 ) }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . r e n t L e a s e   >   0 )   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > R e n t / L e a s e < / d i v >  
                                                         { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . r e n t L e a s e   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                 ) }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . u t i l i t i e s   >   0 )   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > U t i l i t i e s < / d i v >  
                                                         { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . u t i l i t i e s   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                 ) }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . e q u i p m e n t   >   0 )   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > E q u i p m e n t < / d i v >  
                                                         { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . e q u i p m e n t   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                 ) }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . t r a v e l   >   0 )   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > T r a v e l < / d i v >  
                                                         { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . t r a v e l   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                 ) }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . i n s u r a n c e   >   0 )   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > I n s u r a n c e < / d i v >  
                                                         { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . i n s u r a n c e   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                 ) }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . o p e x S a l e s M a r k e t i n g   >   0 )   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > S a l e s   &   M a r k e t i n g < / d i v >  
                                                         { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . o p e x S a l e s M a r k e t i n g   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                 ) }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . c o n t r a c t o r s D i s t r i b u t i o n   >   0 )   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > C o n t r a c t o r s   -   D i s t r i b u t i o n < / d i v >  
                                                         { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . c o n t r a c t o r s D i s t r i b u t i o n   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                 ) }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . d e p r e c i a t i o n E x p e n s e   >   0 )   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > D e p r e c i a t i o n   &   A m o r t i z a t i o n < / d i v >  
                                                         { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . d e p r e c i a t i o n E x p e n s e   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                 ) }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . o p e x O t h e r   >   0 )   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > O t h e r   O p e r a t i n g   E x p e n s e s < / d i v >  
                                                         { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . o p e x O t h e r   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                 ) }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 6 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                                     < d i v   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T o t a l   O p e r a t i n g   E x p e n s e s < / d i v >  
                                                     { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                         < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { ( p . t o t a l O p e x   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                     ) ) }  
                                                 < / d i v >  
                                                  
                                                 { / *   O p e r a t i n g   I n c o m e   * / }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 0 p x   8 p x ' ,   b a c k g r o u n d :   ' # d b e a f e ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   m a r g i n T o p :   ' 8 p x ' ,   f o n t W e i g h t :   ' 7 0 0 '   } } >  
                                                     < d i v   s t y l e = { {   c o l o r :   ' # 1 e 4 0 a f '   } } > O p e r a t i n g   I n c o m e < / d i v >  
                                                     { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                         < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } > $ { ( p . o p e r a t i n g I n c o m e   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                     ) ) }  
                                                 < / d i v >  
                                                  
                                                 { / *   O t h e r   I n c o m e / E x p e n s e   S e c t i o n   * / }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . i n t e r e s t E x p e n s e   >   0   | |   p . n o n O p e r a t i n g I n c o m e   >   0   | |   p . e x t r a o r d i n a r y I t e m s   ! = =   0 )   & &   (  
                                                     < >  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 2 p x   0   4 p x   0 ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   m a r g i n T o p :   ' 1 2 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > O t h e r   I n c o m e / ( E x p e n s e ) < / d i v >  
                                                             { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   < d i v   k e y = { i } > < / d i v > ) }  
                                                         < / d i v >  
                                                         { p e r i o d s D a t a . s o m e ( p   = >   p . i n t e r e s t E x p e n s e   >   0 )   & &   (  
                                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                                 < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > I n t e r e s t   E x p e n s e < / d i v >  
                                                                 { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                                     < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > ( $ {   ( p . i n t e r e s t E x p e n s e   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K ) < / d i v >  
                                                                 ) ) }  
                                                             < / d i v >  
                                                         ) }  
                                                         { p e r i o d s D a t a . s o m e ( p   = >   p . n o n O p e r a t i n g I n c o m e   >   0 )   & &   (  
                                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                                 < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > N o n - O p e r a t i n g   I n c o m e < / d i v >  
                                                                 { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                                     < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { ( p . n o n O p e r a t i n g I n c o m e   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                                 ) ) }  
                                                             < / d i v >  
                                                         ) }  
                                                         { p e r i o d s D a t a . s o m e ( p   = >   p . e x t r a o r d i n a r y I t e m s   ! = =   0 )   & &   (  
                                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                                 < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > E x t r a o r d i n a r y   I t e m s < / d i v >  
                                                                 { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                                     < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } >  
                                                                         { p . e x t r a o r d i n a r y I t e m s   > =   0   ?   ' $ '   :   ' ( $ ' } { ( M a t h . a b s ( p . e x t r a o r d i n a r y I t e m s )   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K { p . e x t r a o r d i n a r y I t e m s   <   0   ?   ' ) '   :   ' ' }  
                                                                     < / d i v >  
                                                                 ) ) }  
                                                             < / d i v >  
                                                         ) }  
                                                     < / >  
                                                 ) }  
                                                  
                                                 { / *   N e t   I n c o m e   * / }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 2 p x   8 p x ' ,   b a c k g r o u n d :   ' # d c f c e 7 ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   m a r g i n T o p :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 5 p x '   } } >  
                                                     < d i v   s t y l e = { {   c o l o r :   ' # 1 6 6 5 3 4 '   } } > N e t   I n c o m e < / d i v >  
                                                     { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                         < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   p . n e t I n c o m e   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b '   } } >  
                                                             { p . n e t I n c o m e   > =   0   ?   ' $ '   :   ' ( $ ' } { ( M a t h . a b s ( p . n e t I n c o m e )   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K { p . n e t I n c o m e   <   0   ?   ' ) '   :   ' ' }  
                                                         < / d i v >  
                                                     ) ) }  
                                                 < / d i v >  
                                             < / d i v >  
                                         < / d i v >  
                                     ) ;  
                                 }  
                                  
                                 / /   S i n g l e   p e r i o d   a g g r e g a t i o n   ( o r i g i n a l   l o g i c )  
                                 c o n s t   r e v e n u e   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . r e v e n u e   | |   0 ) ,   0 ) ;  
                                  
                                 c o n s t   c o g s P a y r o l l   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s P a y r o l l   | |   0 ) ,   0 ) ;  
                                 c o n s t   c o g s O w n e r P a y   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s O w n e r P a y   | |   0 ) ,   0 ) ;  
                                 c o n s t   c o g s C o n t r a c t o r s   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s C o n t r a c t o r s   | |   0 ) ,   0 ) ;  
                                 c o n s t   c o g s M a t e r i a l s   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s M a t e r i a l s   | |   0 ) ,   0 ) ;  
                                 c o n s t   c o g s C o m m i s s i o n s   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s C o m m i s s i o n s   | |   0 ) ,   0 ) ;  
                                 c o n s t   c o g s O t h e r   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s O t h e r   | |   0 ) ,   0 ) ;  
                                 c o n s t   c o g s   =   c o g s P a y r o l l   +   c o g s O w n e r P a y   +   c o g s C o n t r a c t o r s   +   c o g s M a t e r i a l s   +   c o g s C o m m i s s i o n s   +   c o g s O t h e r ;  
                                  
                                 c o n s t   g r o s s P r o f i t   =   r e v e n u e   -   c o g s ;  
                                 c o n s t   g r o s s M a r g i n   =   r e v e n u e   >   0   ?   ( g r o s s P r o f i t   /   r e v e n u e )   *   1 0 0   :   0 ;  
                                  
                                 c o n s t   o p e x P a y r o l l   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . o p e x P a y r o l l   | |   0 ) ,   0 ) ;  
                                 c o n s t   o w n e r s B a s e P a y   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . o w n e r s B a s e P a y   | |   0 ) ,   0 ) ;  
                                 c o n s t   o w n e r s R e t i r e m e n t   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . o w n e r s R e t i r e m e n t   | |   0 ) ,   0 ) ;  
                                 c o n s t   p r o f e s s i o n a l S e r v i c e s   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . p r o f e s s i o n a l S e r v i c e s   | |   0 ) ,   0 ) ;  
                                 c o n s t   r e n t L e a s e   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . r e n t L e a s e   | |   0 ) ,   0 ) ;  
                                 c o n s t   u t i l i t i e s   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . u t i l i t i e s   | |   0 ) ,   0 ) ;  
                                 c o n s t   e q u i p m e n t   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . e q u i p m e n t   | |   0 ) ,   0 ) ;  
                                 c o n s t   t r a v e l   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . t r a v e l   | |   0 ) ,   0 ) ;  
                                 c o n s t   i n s u r a n c e   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . i n s u r a n c e   | |   0 ) ,   0 ) ;  
                                 c o n s t   o p e x S a l e s M a r k e t i n g   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . o p e x S a l e s M a r k e t i n g   | |   0 ) ,   0 ) ;  
                                 c o n s t   c o n t r a c t o r s D i s t r i b u t i o n   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o n t r a c t o r s D i s t r i b u t i o n   | |   0 ) ,   0 ) ;  
                                 c o n s t   d e p r e c i a t i o n E x p e n s e   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . d e p r e c i a t i o n E x p e n s e   | |   0 ) ,   0 ) ;  
                                 c o n s t   o p e x O t h e r   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . o p e x O t h e r   | |   0 ) ,   0 ) ;  
                                  
                                 c o n s t   t o t a l O p e x   =   o p e x P a y r o l l   +   o w n e r s B a s e P a y   +   o w n e r s R e t i r e m e n t   +   p r o f e s s i o n a l S e r v i c e s   +    
                                                                   r e n t L e a s e   +   u t i l i t i e s   +   e q u i p m e n t   +   t r a v e l   +   i n s u r a n c e   +    
                                                                   o p e x S a l e s M a r k e t i n g   +   c o n t r a c t o r s D i s t r i b u t i o n   +   d e p r e c i a t i o n E x p e n s e   +   o p e x O t h e r ;  
                                  
                                 c o n s t   o p e r a t i n g I n c o m e   =   g r o s s P r o f i t   -   t o t a l O p e x ;  
                                 c o n s t   o p e r a t i n g M a r g i n   =   r e v e n u e   >   0   ?   ( o p e r a t i n g I n c o m e   /   r e v e n u e )   *   1 0 0   :   0 ;  
                                  
                                 c o n s t   i n t e r e s t E x p e n s e   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . i n t e r e s t E x p e n s e   | |   0 ) ,   0 ) ;  
                                 c o n s t   n o n O p e r a t i n g I n c o m e   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . n o n O p e r a t i n g I n c o m e   | |   0 ) ,   0 ) ;  
                                 c o n s t   e x t r a o r d i n a r y I t e m s   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . e x t r a o r d i n a r y I t e m s   | |   0 ) ,   0 ) ;  
                                  
                                 c o n s t   n e t I n c o m e   =   o p e r a t i n g I n c o m e   -   i n t e r e s t E x p e n s e   +   n o n O p e r a t i n g I n c o m e   +   e x t r a o r d i n a r y I t e m s ;  
                                 c o n s t   n e t M a r g i n   =   r e v e n u e   >   0   ?   ( n e t I n c o m e   /   r e v e n u e )   *   1 0 0   :   0 ;  
                                  
                                 r e t u r n   (  
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 1 6 p x '   } } >  
                                                 < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > I n c o m e   S t a t e m e n t < / h 2 >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > F o r   t h e   P e r i o d :   { p e r i o d L a b e l } < / d i v >  
                                             < / d i v >  
  
                                             { / *   R e v e n u e   S e c t i o n   * / }  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 8 p x   0 ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > R e v e n u e < / s p a n >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { r e v e n u e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                 < / d i v >  
                                             < / d i v >  
  
                                             { / *   C O G S   S e c t i o n   * / }  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                                 < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > C o s t   o f   G o o d s   S o l d < / d i v >  
                                                 { c o g s P a y r o l l   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C O G S   -   P a y r o l l < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o g s P a y r o l l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { c o g s O w n e r P a y   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C O G S   -   O w n e r   P a y < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o g s O w n e r P a y . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { c o g s C o n t r a c t o r s   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C O G S   -   C o n t r a c t o r s < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o g s C o n t r a c t o r s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { c o g s M a t e r i a l s   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C O G S   -   M a t e r i a l s < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o g s M a t e r i a l s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { c o g s C o m m i s s i o n s   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C O G S   -   C o m m i s s i o n s < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o g s C o m m i s s i o n s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { c o g s O t h e r   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C O G S   -   O t h e r < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o g s O t h e r . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 8 p x   0 ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > T o t a l   C O G S < / s p a n >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { c o g s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                 < / d i v >  
                                             < / d i v >  
  
                                             { / *   G r o s s   P r o f i t   * / }  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # d b e a f e ' ,   p a d d i n g :   ' 1 2 p x ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } > G r o s s   P r o f i t < / s p a n >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } > $ { g r o s s P r o f i t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                 < / d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 1 e 4 0 a f ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                     { g r o s s M a r g i n . t o F i x e d ( 1 ) } %   m a r g i n  
                                                 < / d i v >  
                                             < / d i v >  
  
                                             { / *   O p e r a t i n g   E x p e n s e s   * / }  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                                 < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > O p e r a t i n g   E x p e n s e s < / d i v >  
                                                 { o p e x P a y r o l l   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > P a y r o l l < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { o p e x P a y r o l l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { o w n e r s B a s e P a y   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > O w n e r ' s   B a s e   P a y < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { o w n e r s B a s e P a y . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { o w n e r s R e t i r e m e n t   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > O w n e r ' s   R e t i r e m e n t < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { o w n e r s R e t i r e m e n t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { p r o f e s s i o n a l S e r v i c e s   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > P r o f e s s i o n a l   S e r v i c e s < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { p r o f e s s i o n a l S e r v i c e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { r e n t L e a s e   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > R e n t / L e a s e < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { r e n t L e a s e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { u t i l i t i e s   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > U t i l i t i e s < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { u t i l i t i e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { e q u i p m e n t   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > E q u i p m e n t < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { e q u i p m e n t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { t r a v e l   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T r a v e l < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { t r a v e l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { i n s u r a n c e   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > I n s u r a n c e < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { i n s u r a n c e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { o p e x S a l e s M a r k e t i n g   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > S a l e s   &   M a r k e t i n g < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { o p e x S a l e s M a r k e t i n g . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { c o n t r a c t o r s D i s t r i b u t i o n   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C o n t r a c t o r s   -   D i s t r i b u t i o n < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o n t r a c t o r s D i s t r i b u t i o n . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { d e p r e c i a t i o n E x p e n s e   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > D e p r e c i a t i o n   &   A m o r t i z a t i o n < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { d e p r e c i a t i o n E x p e n s e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { o p e x O t h e r   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > O t h e r   O p e r a t i n g   E x p e n s e s < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { o p e x O t h e r . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 8 p x   0 ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   m a r g i n T o p :   ' 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > T o t a l   O p e r a t i n g   E x p e n s e s < / s p a n >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { t o t a l O p e x . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                 < / d i v >  
                                             < / d i v >  
  
                                             { / *   O p e r a t i n g   I n c o m e   * / }  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b a c k g r o u n d :   ' # d b e a f e ' ,   p a d d i n g :   ' 1 2 p x ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } > O p e r a t i n g   I n c o m e < / s p a n >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } > $ { o p e r a t i n g I n c o m e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                 < / d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 1 e 4 0 a f ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                     { o p e r a t i n g M a r g i n . t o F i x e d ( 1 ) } %   o p e r a t i n g   m a r g i n  
                                                 < / d i v >  
                                             < / d i v >  
  
                                             { / *   O t h e r   I n c o m e / E x p e n s e   * / }  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                                 < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > O t h e r   I n c o m e / ( E x p e n s e ) < / d i v >  
                                                 { i n t e r e s t E x p e n s e   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > I n t e r e s t   E x p e n s e < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > ( $ {   i n t e r e s t E x p e n s e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } ) < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { n o n O p e r a t i n g I n c o m e   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > N o n - O p e r a t i n g   I n c o m e < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { n o n O p e r a t i n g I n c o m e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { e x t r a o r d i n a r y I t e m s   ! = =   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 6 p x   0   6 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > E x t r a o r d i n a r y   I t e m s < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > { e x t r a o r d i n a r y I t e m s   > =   0   ?   ' $ '   :   ' ( $ ' } { M a t h . a b s ( e x t r a o r d i n a r y I t e m s ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } { e x t r a o r d i n a r y I t e m s   <   0   ?   ' ) '   :   ' ' } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                             < / d i v >  
  
                                             { / *   N e t   I n c o m e   * / }  
                                             < d i v   s t y l e = { {   b a c k g r o u n d :   n e t I n c o m e   > =   0   ?   ' # d c f c e 7 '   :   ' # f e e 2 e 2 ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   m a r g i n T o p :   ' 2 4 p x '   } } >  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   n e t I n c o m e   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b '   } } > N e t   I n c o m e < / s p a n >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   n e t I n c o m e   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b '   } } >  
                                                         { n e t I n c o m e   > =   0   ?   ' $ '   :   ' ( $ ' } { M a t h . a b s ( n e t I n c o m e ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } { n e t I n c o m e   <   0   ?   ' ) '   :   ' ' }  
                                                     < / s p a n >  
                                                 < / d i v >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   n e t I n c o m e   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                     { n e t M a r g i n . t o F i x e d ( 1 ) } %   n e t   m a r g i n  
                                                 < / d i v >  
                                             < / d i v >  
                                     < / d i v >  
                                 ) ;  
                             }  
                              
                             / /   C O M M O N   S I Z E   I N C O M E   S T A T E M E N T   -   A g g r e g a t e   w i t h   p e r c e n t a g e s  
                             e l s e   i f   ( s t a t e m e n t T y p e   = = =   ' i n c o m e - s t a t e m e n t - p e r c e n t ' )   {  
                                 / /   C h e c k   i f   s h o w i n g   m u l t i p l e   p e r i o d s   s i d e - b y - s i d e  
                                 i f   ( d i s p l a y P e r i o d s . l e n g t h   >   1 )   {  
                                     c o n s t   c a l c   =   ( m o n t h s :   a n y [ ] ,   f i e l d :   s t r i n g )   = >   m o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m [ f i e l d ]   | |   0 ) ,   0 ) ;  
                                     c o n s t   p e r i o d s D a t a   =   d i s p l a y P e r i o d s . m a p ( p   = >   {  
                                         c o n s t   m   =   p . m o n t h s ;  
                                         c o n s t   r e v e n u e   =   c a l c ( m ,   ' r e v e n u e ' ) ;  
                                         c o n s t   c o g s P a y r o l l   =   c a l c ( m ,   ' c o g s P a y r o l l ' ) ;  
                                         c o n s t   c o g s O w n e r P a y   =   c a l c ( m ,   ' c o g s O w n e r P a y ' ) ;  
                                         c o n s t   c o g s C o n t r a c t o r s   =   c a l c ( m ,   ' c o g s C o n t r a c t o r s ' ) ;  
                                         c o n s t   c o g s M a t e r i a l s   =   c a l c ( m ,   ' c o g s M a t e r i a l s ' ) ;  
                                         c o n s t   c o g s C o m m i s s i o n s   =   c a l c ( m ,   ' c o g s C o m m i s s i o n s ' ) ;  
                                         c o n s t   c o g s O t h e r   =   c a l c ( m ,   ' c o g s O t h e r ' ) ;  
                                         c o n s t   o p e x P a y r o l l   =   c a l c ( m ,   ' o p e x P a y r o l l ' ) ;  
                                         c o n s t   o w n e r s B a s e P a y   =   c a l c ( m ,   ' o w n e r s B a s e P a y ' ) ;  
                                         c o n s t   o w n e r s R e t i r e m e n t   =   c a l c ( m ,   ' o w n e r s R e t i r e m e n t ' ) ;  
                                         c o n s t   p r o f e s s i o n a l S e r v i c e s   =   c a l c ( m ,   ' p r o f e s s i o n a l S e r v i c e s ' ) ;  
                                         c o n s t   r e n t L e a s e   =   c a l c ( m ,   ' r e n t L e a s e ' ) ;  
                                         c o n s t   u t i l i t i e s   =   c a l c ( m ,   ' u t i l i t i e s ' ) ;  
                                         c o n s t   e q u i p m e n t   =   c a l c ( m ,   ' e q u i p m e n t ' ) ;  
                                         c o n s t   t r a v e l   =   c a l c ( m ,   ' t r a v e l ' ) ;  
                                         c o n s t   i n s u r a n c e   =   c a l c ( m ,   ' i n s u r a n c e ' ) ;  
                                         c o n s t   o p e x S a l e s M a r k e t i n g   =   c a l c ( m ,   ' o p e x S a l e s M a r k e t i n g ' ) ;  
                                         c o n s t   c o n t r a c t o r s D i s t r i b u t i o n   =   c a l c ( m ,   ' c o n t r a c t o r s D i s t r i b u t i o n ' ) ;  
                                         c o n s t   d e p r e c i a t i o n E x p e n s e   =   c a l c ( m ,   ' d e p r e c i a t i o n E x p e n s e ' ) ;  
                                         c o n s t   o p e x O t h e r   =   c a l c ( m ,   ' o p e x O t h e r ' ) ;  
                                         c o n s t   i n t e r e s t E x p e n s e   =   c a l c ( m ,   ' i n t e r e s t E x p e n s e ' ) ;  
                                         c o n s t   n o n O p e r a t i n g I n c o m e   =   c a l c ( m ,   ' n o n O p e r a t i n g I n c o m e ' ) ;  
                                         c o n s t   e x t r a o r d i n a r y I t e m s   =   c a l c ( m ,   ' e x t r a o r d i n a r y I t e m s ' ) ;  
                                         c o n s t   c o g s   =   c o g s P a y r o l l   +   c o g s O w n e r P a y   +   c o g s C o n t r a c t o r s   +   c o g s M a t e r i a l s   +   c o g s C o m m i s s i o n s   +   c o g s O t h e r ;  
                                         c o n s t   t o t a l O p e x   =   o p e x P a y r o l l   +   o w n e r s B a s e P a y   +   o w n e r s R e t i r e m e n t   +   p r o f e s s i o n a l S e r v i c e s   +   r e n t L e a s e   +   u t i l i t i e s   +   e q u i p m e n t   +   t r a v e l   +   i n s u r a n c e   +   o p e x S a l e s M a r k e t i n g   +   c o n t r a c t o r s D i s t r i b u t i o n   +   d e p r e c i a t i o n E x p e n s e   +   o p e x O t h e r ;  
                                         c o n s t   g r o s s P r o f i t   =   r e v e n u e   -   c o g s ;  
                                         c o n s t   o p e r a t i n g I n c o m e   =   g r o s s P r o f i t   -   t o t a l O p e x ;  
                                         c o n s t   n e t I n c o m e   =   o p e r a t i n g I n c o m e   -   i n t e r e s t E x p e n s e   +   n o n O p e r a t i n g I n c o m e   +   e x t r a o r d i n a r y I t e m s ;  
                                         r e t u r n   {   l a b e l :   p . l a b e l ,   r e v e n u e ,   c o g s P a y r o l l ,   c o g s O w n e r P a y ,   c o g s C o n t r a c t o r s ,   c o g s M a t e r i a l s ,   c o g s C o m m i s s i o n s ,   c o g s O t h e r ,   c o g s ,   g r o s s P r o f i t ,   o p e x P a y r o l l ,   o w n e r s B a s e P a y ,   o w n e r s R e t i r e m e n t ,   p r o f e s s i o n a l S e r v i c e s ,   r e n t L e a s e ,   u t i l i t i e s ,   e q u i p m e n t ,   t r a v e l ,   i n s u r a n c e ,   o p e x S a l e s M a r k e t i n g ,   c o n t r a c t o r s D i s t r i b u t i o n ,   d e p r e c i a t i o n E x p e n s e ,   o p e x O t h e r ,   t o t a l O p e x ,   o p e r a t i n g I n c o m e ,   i n t e r e s t E x p e n s e ,   n o n O p e r a t i n g I n c o m e ,   e x t r a o r d i n a r y I t e m s ,   n e t I n c o m e   } ;  
                                     } ) ;  
                                     c o n s t   R o w W i t h P e r c e n t   =   ( {   l a b e l ,   v a l u e s ,   i n d e n t   =   0 ,   b o l d   =   f a l s e   } :   a n y )   = >   (  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   9 0 p x   6 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   b o l d   ?   ' 1 4 p x '   :   ' 1 3 p x ' ,   f o n t W e i g h t :   b o l d   ?   ' 6 0 0 '   :   ' n o r m a l '   } } >  
                                             < d i v   s t y l e = { {   c o l o r :   b o l d   ?   ' # 4 7 5 5 6 9 '   :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ` $ { i n d e n t } p x `   } } > { l a b e l } < / d i v >  
                                             { v a l u e s . m a p ( ( v :   n u m b e r ,   i :   n u m b e r )   = >   {  
                                                 c o n s t   p c t   =   p e r i o d s D a t a [ i ] . r e v e n u e   >   0   ?   ( v   /   p e r i o d s D a t a [ i ] . r e v e n u e )   *   1 0 0   :   0 ;  
                                                 r e t u r n   (  
                                                     < d i v   k e y = { i }   s t y l e = { {   d i s p l a y :   ' c o n t e n t s '   } } >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   b o l d   ?   ' # 4 7 5 5 6 9 '   :   ' # 6 4 7 4 8 b '   } } > $ { ( v   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   f o n t S i z e :   ' 1 2 p x '   } } > { p c t . t o F i x e d ( 1 ) } % < / d i v >  
                                                     < / d i v >  
                                                 ) ;  
                                             } ) }  
                                         < / d i v >  
                                     ) ;  
                                     r e t u r n   (  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   o v e r f l o w X :   ' a u t o '   } } >  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 1 6 p x '   } } >  
                                                 < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > C o m p a r a t i v e   C o m m o n   S i z e   I n c o m e   S t a t e m e n t < / h 2 >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { p e r i o d L a b e l }   -   { s t a t e m e n t D i s p l a y   = = =   ' m o n t h l y '   ?   ' M o n t h l y '   :   s t a t e m e n t D i s p l a y   = = =   ' q u a r t e r l y '   ?   ' Q u a r t e r l y '   :   ' A n n u a l ' } < / d i v >  
                                             < / d i v >  
                                             < d i v   s t y l e = { {   m i n W i d t h :   ` $ { 2 0 0   +   ( p e r i o d s D a t a . l e n g t h   *   1 5 0 ) } p x `   } } >  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   9 0 p x   6 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 2 p x   0 ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # 1 e 2 9 3 b ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } >  
                                                     < d i v > L i n e   I t e m < / d i v >  
                                                     { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   (  
                                                         < d i v   k e y = { i }   s t y l e = { {   d i s p l a y :   ' c o n t e n t s '   } } >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > { p . l a b e l } < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   f o n t S i z e :   ' 1 2 p x '   } } > %   o f   R e v < / d i v >  
                                                         < / d i v >  
                                                     ) ) }  
                                                 < / d i v >  
                                                 < R o w W i t h P e r c e n t   l a b e l = " R e v e n u e "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . r e v e n u e ) }   b o l d   / >  
                                                 < d i v   s t y l e = { {   m a r g i n :   ' 8 p x   0   4 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C o s t   o f   G o o d s   S o l d < / d i v >  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . c o g s P a y r o l l   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " C O G S   -   P a y r o l l "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . c o g s P a y r o l l ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . c o g s O w n e r P a y   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " C O G S   -   O w n e r   P a y "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . c o g s O w n e r P a y ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . c o g s C o n t r a c t o r s   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " C O G S   -   C o n t r a c t o r s "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . c o g s C o n t r a c t o r s ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . c o g s M a t e r i a l s   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " C O G S   -   M a t e r i a l s "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . c o g s M a t e r i a l s ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . c o g s C o m m i s s i o n s   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " C O G S   -   C o m m i s s i o n s "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . c o g s C o m m i s s i o n s ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . c o g s O t h e r   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " C O G S   -   O t h e r "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . c o g s O t h e r ) }   i n d e n t = { 2 0 }   / > }  
                                                 < R o w W i t h P e r c e n t   l a b e l = " T o t a l   C O G S "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . c o g s ) }   b o l d   / >  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   9 0 p x   6 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 0 p x   8 p x ' ,   b a c k g r o u n d :   ' # d b e a f e ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   m a r g i n :   ' 8 p x   0 ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } >  
                                                     < d i v > G r o s s   P r o f i t < / d i v >  
                                                     { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   {  
                                                         c o n s t   p c t   =   p . r e v e n u e   >   0   ?   ( p . g r o s s P r o f i t   /   p . r e v e n u e )   *   1 0 0   :   0 ;  
                                                         r e t u r n   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   d i s p l a y :   ' c o n t e n t s '   } } >  
                                                                 < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > $ { ( p . g r o s s P r o f i t   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                                 < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   f o n t S i z e :   ' 1 2 p x '   } } > { p c t . t o F i x e d ( 1 ) } % < / d i v >  
                                                             < / d i v >  
                                                         ) ;  
                                                     } ) }  
                                                 < / d i v >  
                                                 < d i v   s t y l e = { {   m a r g i n :   ' 1 2 p x   0   4 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > O p e r a t i n g   E x p e n s e s < / d i v >  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . o p e x P a y r o l l   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " P a y r o l l "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . o p e x P a y r o l l ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . o w n e r s B a s e P a y   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " O w n e r ' s   B a s e   P a y "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . o w n e r s B a s e P a y ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . o w n e r s R e t i r e m e n t   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " O w n e r ' s   R e t i r e m e n t "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . o w n e r s R e t i r e m e n t ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . p r o f e s s i o n a l S e r v i c e s   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " P r o f e s s i o n a l   S e r v i c e s "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . p r o f e s s i o n a l S e r v i c e s ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . r e n t L e a s e   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " R e n t / L e a s e "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . r e n t L e a s e ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . u t i l i t i e s   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " U t i l i t i e s "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . u t i l i t i e s ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . e q u i p m e n t   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " E q u i p m e n t "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . e q u i p m e n t ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . t r a v e l   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " T r a v e l "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . t r a v e l ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . i n s u r a n c e   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " I n s u r a n c e "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . i n s u r a n c e ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . o p e x S a l e s M a r k e t i n g   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " S a l e s   &   M a r k e t i n g "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . o p e x S a l e s M a r k e t i n g ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . c o n t r a c t o r s D i s t r i b u t i o n   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " C o n t r a c t o r s   -   D i s t r i b u t i o n "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . c o n t r a c t o r s D i s t r i b u t i o n ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . d e p r e c i a t i o n E x p e n s e   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " D e p r e c i a t i o n   &   A m o r t i z a t i o n "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . d e p r e c i a t i o n E x p e n s e ) }   i n d e n t = { 2 0 }   / > }  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . o p e x O t h e r   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " O t h e r   O p e r a t i n g   E x p e n s e s "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . o p e x O t h e r ) }   i n d e n t = { 2 0 }   / > }  
                                                 < R o w W i t h P e r c e n t   l a b e l = " T o t a l   O p e r a t i n g   E x p e n s e s "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . t o t a l O p e x ) }   b o l d   / >  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   9 0 p x   6 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 0 p x   8 p x ' ,   b a c k g r o u n d :   ' # d b e a f e ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   m a r g i n :   ' 8 p x   0 ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } >  
                                                     < d i v > O p e r a t i n g   I n c o m e < / d i v >  
                                                     { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   {  
                                                         c o n s t   p c t   =   p . r e v e n u e   >   0   ?   ( p . o p e r a t i n g I n c o m e   /   p . r e v e n u e )   *   1 0 0   :   0 ;  
                                                         r e t u r n   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   d i s p l a y :   ' c o n t e n t s '   } } >  
                                                                 < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > $ { ( p . o p e r a t i n g I n c o m e   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                                                 < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   f o n t S i z e :   ' 1 2 p x '   } } > { p c t . t o F i x e d ( 1 ) } % < / d i v >  
                                                             < / d i v >  
                                                         ) ;  
                                                     } ) }  
                                                 < / d i v >  
                                                 { p e r i o d s D a t a . s o m e ( p   = >   p . i n t e r e s t E x p e n s e   >   0   | |   p . n o n O p e r a t i n g I n c o m e   >   0   | |   p . e x t r a o r d i n a r y I t e m s   ! = =   0 )   & &   (  
                                                     < >  
                                                         < d i v   s t y l e = { {   m a r g i n :   ' 1 2 p x   0   4 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > O t h e r   I n c o m e / ( E x p e n s e ) < / d i v >  
                                                         { p e r i o d s D a t a . s o m e ( p   = >   p . i n t e r e s t E x p e n s e   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " I n t e r e s t   E x p e n s e "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   - p . i n t e r e s t E x p e n s e ) }   i n d e n t = { 2 0 }   / > }  
                                                         { p e r i o d s D a t a . s o m e ( p   = >   p . n o n O p e r a t i n g I n c o m e   >   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " N o n - O p e r a t i n g   I n c o m e "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . n o n O p e r a t i n g I n c o m e ) }   i n d e n t = { 2 0 }   / > }  
                                                         { p e r i o d s D a t a . s o m e ( p   = >   p . e x t r a o r d i n a r y I t e m s   ! = =   0 )   & &   < R o w W i t h P e r c e n t   l a b e l = " E x t r a o r d i n a r y   I t e m s "   v a l u e s = { p e r i o d s D a t a . m a p ( p   = >   p . e x t r a o r d i n a r y I t e m s ) }   i n d e n t = { 2 0 }   / > }  
                                                     < / >  
                                                 ) }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { p e r i o d s D a t a . l e n g t h } ,   9 0 p x   6 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 2 p x   8 p x ' ,   b a c k g r o u n d :   ' # d c f c e 7 ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   m a r g i n :   ' 1 2 p x   0   0 ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 5 p x '   } } >  
                                                     < d i v   s t y l e = { {   c o l o r :   ' # 1 6 6 5 3 4 '   } } > N e t   I n c o m e < / d i v >  
                                                     { p e r i o d s D a t a . m a p ( ( p ,   i )   = >   {  
                                                         c o n s t   p c t   =   p . r e v e n u e   >   0   ?   ( p . n e t I n c o m e   /   p . r e v e n u e )   *   1 0 0   :   0 ;  
                                                         r e t u r n   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   d i s p l a y :   ' c o n t e n t s '   } } >  
                                                                 < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   p . n e t I n c o m e   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b '   } } >  
                                                                     { p . n e t I n c o m e   > =   0   ?   ' $ '   :   ' ( $ ' } { ( M a t h . a b s ( p . n e t I n c o m e )   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K { p . n e t I n c o m e   <   0   ?   ' ) '   :   ' ' }  
                                                                 < / d i v >  
                                                                 < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   p . n e t I n c o m e   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b '   } } > { p c t . t o F i x e d ( 1 ) } % < / d i v >  
                                                             < / d i v >  
                                                         ) ;  
                                                     } ) }  
                                                 < / d i v >  
                                             < / d i v >  
                                         < / d i v >  
                                     ) ;  
                                 }  
                                  
                                 c o n s t   r e v e n u e   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . r e v e n u e   | |   0 ) ,   0 ) ;  
                                  
                                 c o n s t   c o g s P a y r o l l   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s P a y r o l l   | |   0 ) ,   0 ) ;  
                                 c o n s t   c o g s O w n e r P a y   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s O w n e r P a y   | |   0 ) ,   0 ) ;  
                                 c o n s t   c o g s C o n t r a c t o r s   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s C o n t r a c t o r s   | |   0 ) ,   0 ) ;  
                                 c o n s t   c o g s M a t e r i a l s   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s M a t e r i a l s   | |   0 ) ,   0 ) ;  
                                 c o n s t   c o g s C o m m i s s i o n s   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s C o m m i s s i o n s   | |   0 ) ,   0 ) ;  
                                 c o n s t   c o g s O t h e r   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o g s O t h e r   | |   0 ) ,   0 ) ;  
                                 c o n s t   c o g s   =   c o g s P a y r o l l   +   c o g s O w n e r P a y   +   c o g s C o n t r a c t o r s   +   c o g s M a t e r i a l s   +   c o g s C o m m i s s i o n s   +   c o g s O t h e r ;  
                                  
                                 c o n s t   g r o s s P r o f i t   =   r e v e n u e   -   c o g s ;  
                                  
                                 c o n s t   o p e x P a y r o l l   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . o p e x P a y r o l l   | |   0 ) ,   0 ) ;  
                                 c o n s t   o w n e r s B a s e P a y   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . o w n e r s B a s e P a y   | |   0 ) ,   0 ) ;  
                                 c o n s t   o w n e r s R e t i r e m e n t   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . o w n e r s R e t i r e m e n t   | |   0 ) ,   0 ) ;  
                                 c o n s t   p r o f e s s i o n a l S e r v i c e s   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . p r o f e s s i o n a l S e r v i c e s   | |   0 ) ,   0 ) ;  
                                 c o n s t   r e n t L e a s e   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . r e n t L e a s e   | |   0 ) ,   0 ) ;  
                                 c o n s t   u t i l i t i e s   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . u t i l i t i e s   | |   0 ) ,   0 ) ;  
                                 c o n s t   e q u i p m e n t   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . e q u i p m e n t   | |   0 ) ,   0 ) ;  
                                 c o n s t   t r a v e l   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . t r a v e l   | |   0 ) ,   0 ) ;  
                                 c o n s t   i n s u r a n c e   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . i n s u r a n c e   | |   0 ) ,   0 ) ;  
                                 c o n s t   o p e x S a l e s M a r k e t i n g   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . o p e x S a l e s M a r k e t i n g   | |   0 ) ,   0 ) ;  
                                 c o n s t   c o n t r a c t o r s D i s t r i b u t i o n   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . c o n t r a c t o r s D i s t r i b u t i o n   | |   0 ) ,   0 ) ;  
                                 c o n s t   d e p r e c i a t i o n E x p e n s e   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . d e p r e c i a t i o n E x p e n s e   | |   0 ) ,   0 ) ;  
                                 c o n s t   o p e x O t h e r   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . o p e x O t h e r   | |   0 ) ,   0 ) ;  
                                  
                                 c o n s t   t o t a l O p e x   =   o p e x P a y r o l l   +   o w n e r s B a s e P a y   +   o w n e r s R e t i r e m e n t   +   p r o f e s s i o n a l S e r v i c e s   +    
                                                                   r e n t L e a s e   +   u t i l i t i e s   +   e q u i p m e n t   +   t r a v e l   +   i n s u r a n c e   +    
                                                                   o p e x S a l e s M a r k e t i n g   +   c o n t r a c t o r s D i s t r i b u t i o n   +   d e p r e c i a t i o n E x p e n s e   +   o p e x O t h e r ;  
                                  
                                 c o n s t   o p e r a t i n g I n c o m e   =   g r o s s P r o f i t   -   t o t a l O p e x ;  
                                  
                                 c o n s t   i n t e r e s t E x p e n s e   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . i n t e r e s t E x p e n s e   | |   0 ) ,   0 ) ;  
                                 c o n s t   n o n O p e r a t i n g I n c o m e   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . n o n O p e r a t i n g I n c o m e   | |   0 ) ,   0 ) ;  
                                 c o n s t   e x t r a o r d i n a r y I t e m s   =   p e r i o d M o n t h s . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . e x t r a o r d i n a r y I t e m s   | |   0 ) ,   0 ) ;  
                                  
                                 c o n s t   n e t I n c o m e   =   o p e r a t i n g I n c o m e   -   i n t e r e s t E x p e n s e   +   n o n O p e r a t i n g I n c o m e   +   e x t r a o r d i n a r y I t e m s ;  
                                  
                                 c o n s t   c a l c P e r c e n t   =   ( v a l u e :   n u m b e r )   = >   r e v e n u e   >   0   ?   ( ( v a l u e   /   r e v e n u e )   *   1 0 0 ) . t o F i x e d ( 1 )   +   ' % '   :   ' 0 . 0 % ' ;  
                                  
                                 r e t u r n   (  
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 1 6 p x '   } } >  
                                                 < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > C o m m o n   S i z e   I n c o m e   S t a t e m e n t < / h 2 >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > F o r   t h e   P e r i o d :   { p e r i o d L a b e l } < / d i v >  
                                             < / d i v >  
  
                                             { / *   H e a d e r   R o w   * / }  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 1 2 p x   0 ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } >  
                                                 < d i v > L i n e   I t e m < / d i v >  
                                                 < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > A m o u n t < / d i v >  
                                                 < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > %   o f   R e v e n u e < / d i v >  
                                             < / d i v >  
  
                                             { / *   R e v e n u e   * / }  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 8 p x   0 ' ,   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # e 2 e 8 f 0 ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                 < d i v   s t y l e = { {   c o l o r :   ' # 1 e 2 9 3 b '   } } > R e v e n u e < / d i v >  
                                                 < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > $ { r e v e n u e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                 < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > 1 0 0 . 0 % < / d i v >  
                                             < / d i v >  
  
                                             { / *   C O G S   * / }  
                                             < d i v   s t y l e = { {   m a r g i n T o p :   ' 1 6 p x '   } } >  
                                                 < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } > C o s t   o f   G o o d s   S o l d < / d i v >  
                                                 { c o g s P a y r o l l   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > C O G S   -   P a y r o l l < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { c o g s P a y r o l l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( c o g s P a y r o l l ) } < / d i v >  
                                                     < / d i v >  
                                                 ) }  
                                                 { c o g s O w n e r P a y   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > C O G S   -   O w n e r   P a y < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { c o g s O w n e r P a y . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( c o g s O w n e r P a y ) } < / d i v >  
                                                     < / d i v >  
                                                 ) }  
                                                 { c o g s C o n t r a c t o r s   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > C O G S   -   C o n t r a c t o r s < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { c o g s C o n t r a c t o r s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( c o g s C o n t r a c t o r s ) } < / d i v >  
                                                     < / d i v >  
                                                 ) }  
                                                 { c o g s M a t e r i a l s   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > C O G S   -   M a t e r i a l s < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { c o g s M a t e r i a l s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( c o g s M a t e r i a l s ) } < / d i v >  
                                                     < / d i v >  
                                                 ) }  
                                                 { c o g s C o m m i s s i o n s   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > C O G S   -   C o m m i s s i o n s < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { c o g s C o m m i s s i o n s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( c o g s C o m m i s s i o n s ) } < / d i v >  
                                                     < / d i v >  
                                                 ) }  
                                                 { c o g s O t h e r   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > C O G S   -   O t h e r < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { c o g s O t h e r . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( c o g s O t h e r ) } < / d i v >  
                                                     < / d i v >  
                                                 ) }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 8 p x   0 ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   m a r g i n T o p :   ' 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                     < d i v   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T o t a l   C O G S < / d i v >  
                                                     < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { c o g s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                     < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > { c a l c P e r c e n t ( c o g s ) } < / d i v >  
                                                 < / d i v >  
                                             < / d i v >  
  
                                             { / *   G r o s s   P r o f i t   * / }  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 1 2 p x   8 p x ' ,   b a c k g r o u n d :   ' # d b e a f e ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   m a r g i n :   ' 1 6 p x   0 ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } >  
                                                 < d i v > G r o s s   P r o f i t < / d i v >  
                                                 < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > $ { g r o s s P r o f i t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                 < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > { c a l c P e r c e n t ( g r o s s P r o f i t ) } < / d i v >  
                                             < / d i v >  
  
                                             { / *   O p e r a t i n g   E x p e n s e s   * / }  
                                             < d i v   s t y l e = { {   m a r g i n T o p :   ' 1 6 p x '   } } >  
                                                 < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } > O p e r a t i n g   E x p e n s e s < / d i v >  
                                                 { o p e x P a y r o l l   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > P a y r o l l < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { o p e x P a y r o l l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( o p e x P a y r o l l ) } < / d i v >  
                                                     < / d i v >  
                                                 ) }  
                                                 { o w n e r s B a s e P a y   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > O w n e r ' s   B a s e   P a y < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { o w n e r s B a s e P a y . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( o w n e r s B a s e P a y ) } < / d i v >  
                                                     < / d i v >  
                                                 ) }  
                                                 { o w n e r s R e t i r e m e n t   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > O w n e r ' s   R e t i r e m e n t < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { o w n e r s R e t i r e m e n t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( o w n e r s R e t i r e m e n t ) } < / d i v >  
                                                     < / d i v >  
                                                 ) }  
                                                 { p r o f e s s i o n a l S e r v i c e s   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > P r o f e s s i o n a l   S e r v i c e s < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { p r o f e s s i o n a l S e r v i c e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( p r o f e s s i o n a l S e r v i c e s ) } < / d i v >  
                                                     < / d i v >  
                                                 ) }  
                                                 { r e n t L e a s e   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > R e n t / L e a s e < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { r e n t L e a s e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( r e n t L e a s e ) } < / d i v >  
                                                     < / d i v >  
                                                 ) }  
                                                 { u t i l i t i e s   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > U t i l i t i e s < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { u t i l i t i e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( u t i l i t i e s ) } < / d i v >  
                                                     < / d i v >  
                                                 ) }  
                                                 { e q u i p m e n t   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > E q u i p m e n t < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { e q u i p m e n t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( e q u i p m e n t ) } < / d i v >  
                                                     < / d i v >  
                                                 ) }  
                                                 { t r a v e l   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > T r a v e l < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { t r a v e l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( t r a v e l ) } < / d i v >  
                                                     < / d i v >  
                                                 ) }  
                                                 { i n s u r a n c e   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > I n s u r a n c e < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { i n s u r a n c e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( i n s u r a n c e ) } < / d i v >  
                                                     < / d i v >  
                                                 ) }  
                                                 { o p e x S a l e s M a r k e t i n g   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > S a l e s   &   M a r k e t i n g < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { o p e x S a l e s M a r k e t i n g . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( o p e x S a l e s M a r k e t i n g ) } < / d i v >  
                                                     < / d i v >  
                                                 ) }  
                                                 { c o n t r a c t o r s D i s t r i b u t i o n   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > C o n t r a c t o r s   -   D i s t r i b u t i o n < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { c o n t r a c t o r s D i s t r i b u t i o n . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( c o n t r a c t o r s D i s t r i b u t i o n ) } < / d i v >  
                                                     < / d i v >  
                                                 ) }  
                                                 { d e p r e c i a t i o n E x p e n s e   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > D e p r e c i a t i o n   &   A m o r t i z a t i o n < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { d e p r e c i a t i o n E x p e n s e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( d e p r e c i a t i o n E x p e n s e ) } < / d i v >  
                                                     < / d i v >  
                                                 ) }  
                                                 { o p e x O t h e r   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > O t h e r   O p e r a t i n g   E x p e n s e s < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { o p e x O t h e r . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                         < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( o p e x O t h e r ) } < / d i v >  
                                                     < / d i v >  
                                                 ) }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 8 p x   0 ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   m a r g i n T o p :   ' 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                     < d i v   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T o t a l   O p e r a t i n g   E x p e n s e s < / d i v >  
                                                     < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { t o t a l O p e x . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                     < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > { c a l c P e r c e n t ( t o t a l O p e x ) } < / d i v >  
                                                 < / d i v >  
                                             < / d i v >  
  
                                             { / *   O p e r a t i n g   I n c o m e   * / }  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 1 2 p x   8 p x ' ,   b a c k g r o u n d :   ' # d b e a f e ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   m a r g i n :   ' 1 6 p x   0 ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } >  
                                                 < d i v > O p e r a t i n g   I n c o m e < / d i v >  
                                                 < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > $ { o p e r a t i n g I n c o m e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                 < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > { c a l c P e r c e n t ( o p e r a t i n g I n c o m e ) } < / d i v >  
                                             < / d i v >  
  
                                             { / *   O t h e r   I n c o m e / E x p e n s e   * / }  
                                             { ( i n t e r e s t E x p e n s e   >   0   | |   n o n O p e r a t i n g I n c o m e   >   0   | |   e x t r a o r d i n a r y I t e m s   ! = =   0 )   & &   (  
                                                 < d i v   s t y l e = { {   m a r g i n T o p :   ' 1 6 p x '   } } >  
                                                     < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } > O t h e r   I n c o m e / ( E x p e n s e ) < / d i v >  
                                                     { i n t e r e s t E x p e n s e   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > I n t e r e s t   E x p e n s e < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > ( $ {   i n t e r e s t E x p e n s e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } ) < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > ( { c a l c P e r c e n t ( i n t e r e s t E x p e n s e ) } ) < / d i v >  
                                                         < / d i v >  
                                                     ) }  
                                                     { n o n O p e r a t i n g I n c o m e   >   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > N o n - O p e r a t i n g   I n c o m e < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { n o n O p e r a t i n g I n c o m e . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { c a l c P e r c e n t ( n o n O p e r a t i n g I n c o m e ) } < / d i v >  
                                                         < / d i v >  
                                                     ) }  
                                                     { e x t r a o r d i n a r y I t e m s   ! = =   0   & &   (  
                                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                             < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > E x t r a o r d i n a r y   I t e m s < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } >  
                                                                 { e x t r a o r d i n a r y I t e m s   > =   0   ?   ' $ '   :   ' ( $ ' } { M a t h . a b s ( e x t r a o r d i n a r y I t e m s ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } { e x t r a o r d i n a r y I t e m s   <   0   ?   ' ) '   :   ' ' }  
                                                             < / d i v >  
                                                             < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } >  
                                                                 { e x t r a o r d i n a r y I t e m s   > =   0   ?   c a l c P e r c e n t ( e x t r a o r d i n a r y I t e m s )   :   ` ( $ { c a l c P e r c e n t ( M a t h . a b s ( e x t r a o r d i n a r y I t e m s ) ) } ) ` }  
                                                             < / d i v >  
                                                         < / d i v >  
                                                     ) }  
                                                 < / d i v >  
                                             ) }  
  
                                             { / *   N e t   I n c o m e   * / }  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   0 . 7 f r   0 . 7 f r ' ,   g a p :   ' 1 6 p x ' ,   p a d d i n g :   ' 1 6 p x   8 p x ' ,   b a c k g r o u n d :   n e t I n c o m e   > =   0   ?   ' # d c f c e 7 '   :   ' # f e e 2 e 2 ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   m a r g i n T o p :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   n e t I n c o m e   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b '   } } >  
                                                 < d i v > N e t   I n c o m e < / d i v >  
                                                 < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } >  
                                                     { n e t I n c o m e   > =   0   ?   ' $ '   :   ' ( $ ' } { M a t h . a b s ( n e t I n c o m e ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } { n e t I n c o m e   <   0   ?   ' ) '   :   ' ' }  
                                                 < / d i v >  
                                                 < d i v   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > { c a l c P e r c e n t ( n e t I n c o m e ) } < / d i v >  
                                             < / d i v >  
                                     < / d i v >  
                                 ) ;  
                             }  
                              
                             / /   B A L A N C E   S H E E T   -   L a t e s t   p o i n t   i n   t i m e  
                             e l s e   i f   ( s t a t e m e n t T y p e   = = =   ' b a l a n c e - s h e e t ' )   {  
                                 / /   C h e c k   i f   s h o w i n g   m u l t i p l e   p e r i o d s   s i d e - b y - s i d e  
                                 i f   ( d i s p l a y P e r i o d s . l e n g t h   >   1 )   {  
                                     c o n s t   b a l a n c e D a t a   =   d i s p l a y P e r i o d s . m a p ( p   = >   {  
                                         c o n s t   l a t e s t   =   p . m o n t h s [ p . m o n t h s . l e n g t h   -   1 ] ;  
                                         c o n s t   c a s h   =   l a t e s t . c a s h   | |   0 ;  
                                         c o n s t   a r   =   l a t e s t . a r   | |   0 ;  
                                         c o n s t   i n v e n t o r y   =   l a t e s t . i n v e n t o r y   | |   0 ;  
                                         c o n s t   o t h e r C A   =   l a t e s t . o t h e r C A   | |   0 ;  
                                         c o n s t   t c a   =   c a s h   +   a r   +   i n v e n t o r y   +   o t h e r C A ;  
                                         c o n s t   f i x e d A s s e t s   =   l a t e s t . f i x e d A s s e t s   | |   0 ;  
                                         c o n s t   i n t a n g i b l e A s s e t s   =   l a t e s t . i n t a n g i b l e A s s e t s   | |   0 ;  
                                         c o n s t   o t h e r N o n C u r r e n t A s s e t s   =   l a t e s t . o t h e r N o n C u r r e n t A s s e t s   | |   0 ;  
                                         c o n s t   n o n C u r r e n t A s s e t s   =   f i x e d A s s e t s   +   i n t a n g i b l e A s s e t s   +   o t h e r N o n C u r r e n t A s s e t s ;  
                                         c o n s t   t o t a l A s s e t s   =   t c a   +   n o n C u r r e n t A s s e t s ;  
                                         c o n s t   a p   =   l a t e s t . a p   | |   0 ;  
                                         c o n s t   s h o r t T e r m D e b t   =   l a t e s t . s h o r t T e r m D e b t   | |   0 ;  
                                         c o n s t   c u r r e n t P o r t i o n L T D   =   l a t e s t . c u r r e n t P o r t i o n L T D   | |   0 ;  
                                         c o n s t   o t h e r C u r r e n t L i a b i l i t i e s   =   l a t e s t . o t h e r C u r r e n t L i a b i l i t i e s   | |   0 ;  
                                         c o n s t   t o t a l C u r r e n t L i a b i l i t i e s   =   a p   +   s h o r t T e r m D e b t   +   c u r r e n t P o r t i o n L T D   +   o t h e r C u r r e n t L i a b i l i t i e s ;  
                                         c o n s t   l t d   =   l a t e s t . l t d   | |   0 ;  
                                         c o n s t   o t h e r L o n g T e r m L i a b i l i t i e s   =   l a t e s t . o t h e r L o n g T e r m L i a b i l i t i e s   | |   0 ;  
                                         c o n s t   t o t a l L o n g T e r m L i a b i l i t i e s   =   l t d   +   o t h e r L o n g T e r m L i a b i l i t i e s ;  
                                         c o n s t   t o t a l L i a b i l i t i e s   =   t o t a l C u r r e n t L i a b i l i t i e s   +   t o t a l L o n g T e r m L i a b i l i t i e s ;  
                                         c o n s t   p a i d I n C a p i t a l   =   l a t e s t . p a i d I n C a p i t a l   | |   0 ;  
                                         c o n s t   r e t a i n e d E a r n i n g s   =   l a t e s t . r e t a i n e d E a r n i n g s   | |   0 ;  
                                         c o n s t   t o t a l E q u i t y   =   p a i d I n C a p i t a l   +   r e t a i n e d E a r n i n g s ;  
                                         r e t u r n   {   l a b e l :   p . l a b e l ,   c a s h ,   a r ,   i n v e n t o r y ,   o t h e r C A ,   t c a ,   f i x e d A s s e t s ,   i n t a n g i b l e A s s e t s ,   o t h e r N o n C u r r e n t A s s e t s ,   n o n C u r r e n t A s s e t s ,   t o t a l A s s e t s ,   a p ,   s h o r t T e r m D e b t ,   c u r r e n t P o r t i o n L T D ,   o t h e r C u r r e n t L i a b i l i t i e s ,   t o t a l C u r r e n t L i a b i l i t i e s ,   l t d ,   o t h e r L o n g T e r m L i a b i l i t i e s ,   t o t a l L o n g T e r m L i a b i l i t i e s ,   t o t a l L i a b i l i t i e s ,   p a i d I n C a p i t a l ,   r e t a i n e d E a r n i n g s ,   t o t a l E q u i t y   } ;  
                                     } ) ;  
                                     c o n s t   R o w   =   ( {   l a b e l ,   v a l u e s ,   i n d e n t   =   0 ,   b o l d   =   f a l s e   } :   a n y )   = >   (  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   b o l d   ?   ' 1 4 p x '   :   ' 1 3 p x ' ,   f o n t W e i g h t :   b o l d   ?   ' 6 0 0 '   :   ' n o r m a l '   } } >  
                                             < d i v   s t y l e = { {   c o l o r :   b o l d   ?   ' # 4 7 5 5 6 9 '   :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ` $ { i n d e n t } p x `   } } > { l a b e l } < / d i v >  
                                             { v a l u e s . m a p ( ( v :   n u m b e r ,   i :   n u m b e r )   = >   (  
                                                 < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   b o l d   ?   ' # 4 7 5 5 6 9 '   :   ' # 6 4 7 4 8 b '   } } > $ { ( v   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v >  
                                             ) ) }  
                                         < / d i v >  
                                     ) ;  
                                     r e t u r n   (  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   o v e r f l o w X :   ' a u t o '   } } >  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 1 6 p x '   } } >  
                                                 < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > C o m p a r a t i v e   B a l a n c e   S h e e t < / h 2 >  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { p e r i o d L a b e l }   -   { s t a t e m e n t D i s p l a y   = = =   ' m o n t h l y '   ?   ' M o n t h l y '   :   s t a t e m e n t D i s p l a y   = = =   ' q u a r t e r l y '   ?   ' Q u a r t e r l y '   :   ' A n n u a l ' } < / d i v >  
                                             < / d i v >  
                                             < d i v   s t y l e = { {   m i n W i d t h :   ` $ { 2 0 0   +   ( b a l a n c e D a t a . l e n g t h   *   1 1 0 ) } p x `   } } >  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 2 p x   0 ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # 1 e 2 9 3 b ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } >  
                                                     < d i v > L i n e   I t e m < / d i v >  
                                                     { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > { p . l a b e l } < / d i v > ) }  
                                                 < / d i v >  
                                                 < d i v   s t y l e = { {   m a r g i n :   ' 8 p x   0   4 p x ' ,   f o n t S i z e :   ' 1 5 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > A S S E T S < / d i v >  
                                                 < d i v   s t y l e = { {   m a r g i n :   ' 8 p x   0   4 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C u r r e n t   A s s e t s < / d i v >  
                                                 { b a l a n c e D a t a . s o m e ( p   = >   p . c a s h   >   0 )   & &   < R o w   l a b e l = " C a s h   &   C a s h   E q u i v a l e n t s "   v a l u e s = { b a l a n c e D a t a . m a p ( p   = >   p . c a s h ) }   i n d e n t = { 2 0 }   / > }  
                                                 { b a l a n c e D a t a . s o m e ( p   = >   p . a r   >   0 )   & &   < R o w   l a b e l = " A c c o u n t s   R e c e i v a b l e "   v a l u e s = { b a l a n c e D a t a . m a p ( p   = >   p . a r ) }   i n d e n t = { 2 0 }   / > }  
                                                 { b a l a n c e D a t a . s o m e ( p   = >   p . i n v e n t o r y   >   0 )   & &   < R o w   l a b e l = " I n v e n t o r y "   v a l u e s = { b a l a n c e D a t a . m a p ( p   = >   p . i n v e n t o r y ) }   i n d e n t = { 2 0 }   / > }  
                                                 { b a l a n c e D a t a . s o m e ( p   = >   p . o t h e r C A   >   0 )   & &   < R o w   l a b e l = " O t h e r   C u r r e n t   A s s e t s "   v a l u e s = { b a l a n c e D a t a . m a p ( p   = >   p . o t h e r C A ) }   i n d e n t = { 2 0 }   / > }  
                                                 < R o w   l a b e l = " T o t a l   C u r r e n t   A s s e t s "   v a l u e s = { b a l a n c e D a t a . m a p ( p   = >   p . t c a ) }   b o l d   / >  
                                                 < d i v   s t y l e = { {   m a r g i n :   ' 8 p x   0   4 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > N o n - C u r r e n t   A s s e t s < / d i v >  
                                                 { b a l a n c e D a t a . s o m e ( p   = >   p . f i x e d A s s e t s   >   0 )   & &   < R o w   l a b e l = " P r o p e r t y ,   P l a n t   &   E q u i p m e n t "   v a l u e s = { b a l a n c e D a t a . m a p ( p   = >   p . f i x e d A s s e t s ) }   i n d e n t = { 2 0 }   / > }  
                                                 { b a l a n c e D a t a . s o m e ( p   = >   p . i n t a n g i b l e A s s e t s   >   0 )   & &   < R o w   l a b e l = " I n t a n g i b l e   A s s e t s "   v a l u e s = { b a l a n c e D a t a . m a p ( p   = >   p . i n t a n g i b l e A s s e t s ) }   i n d e n t = { 2 0 }   / > }  
                                                 { b a l a n c e D a t a . s o m e ( p   = >   p . o t h e r N o n C u r r e n t A s s e t s   >   0 )   & &   < R o w   l a b e l = " O t h e r   N o n - C u r r e n t   A s s e t s "   v a l u e s = { b a l a n c e D a t a . m a p ( p   = >   p . o t h e r N o n C u r r e n t A s s e t s ) }   i n d e n t = { 2 0 }   / > }  
                                                 < R o w   l a b e l = " T o t a l   N o n - C u r r e n t   A s s e t s "   v a l u e s = { b a l a n c e D a t a . m a p ( p   = >   p . n o n C u r r e n t A s s e t s ) }   b o l d   / >  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 0 p x   8 p x ' ,   b a c k g r o u n d :   ' # d b e a f e ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   m a r g i n :   ' 8 p x   0 ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } >  
                                                     < d i v > T O T A L   A S S E T S < / d i v >  
                                                     { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > $ { ( p . t o t a l A s s e t s   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v > ) }  
                                                 < / d i v >  
                                                 < d i v   s t y l e = { {   m a r g i n :   ' 1 2 p x   0   4 p x ' ,   f o n t S i z e :   ' 1 5 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > L I A B I L I T I E S < / d i v >  
                                                 < d i v   s t y l e = { {   m a r g i n :   ' 8 p x   0   4 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C u r r e n t   L i a b i l i t i e s < / d i v >  
                                                 { b a l a n c e D a t a . s o m e ( p   = >   p . a p   >   0 )   & &   < R o w   l a b e l = " A c c o u n t s   P a y a b l e "   v a l u e s = { b a l a n c e D a t a . m a p ( p   = >   p . a p ) }   i n d e n t = { 2 0 }   / > }  
                                                 { b a l a n c e D a t a . s o m e ( p   = >   p . s h o r t T e r m D e b t   >   0 )   & &   < R o w   l a b e l = " S h o r t - T e r m   D e b t "   v a l u e s = { b a l a n c e D a t a . m a p ( p   = >   p . s h o r t T e r m D e b t ) }   i n d e n t = { 2 0 }   / > }  
                                                 { b a l a n c e D a t a . s o m e ( p   = >   p . c u r r e n t P o r t i o n L T D   >   0 )   & &   < R o w   l a b e l = " C u r r e n t   P o r t i o n   o f   L T   D e b t "   v a l u e s = { b a l a n c e D a t a . m a p ( p   = >   p . c u r r e n t P o r t i o n L T D ) }   i n d e n t = { 2 0 }   / > }  
                                                 { b a l a n c e D a t a . s o m e ( p   = >   p . o t h e r C u r r e n t L i a b i l i t i e s   >   0 )   & &   < R o w   l a b e l = " O t h e r   C u r r e n t   L i a b i l i t i e s "   v a l u e s = { b a l a n c e D a t a . m a p ( p   = >   p . o t h e r C u r r e n t L i a b i l i t i e s ) }   i n d e n t = { 2 0 }   / > }  
                                                 < R o w   l a b e l = " T o t a l   C u r r e n t   L i a b i l i t i e s "   v a l u e s = { b a l a n c e D a t a . m a p ( p   = >   p . t o t a l C u r r e n t L i a b i l i t i e s ) }   b o l d   / >  
                                                 < d i v   s t y l e = { {   m a r g i n :   ' 8 p x   0   4 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > L o n g - T e r m   L i a b i l i t i e s < / d i v >  
                                                 { b a l a n c e D a t a . s o m e ( p   = >   p . l t d   >   0 )   & &   < R o w   l a b e l = " L o n g - T e r m   D e b t "   v a l u e s = { b a l a n c e D a t a . m a p ( p   = >   p . l t d ) }   i n d e n t = { 2 0 }   / > }  
                                                 { b a l a n c e D a t a . s o m e ( p   = >   p . o t h e r L o n g T e r m L i a b i l i t i e s   >   0 )   & &   < R o w   l a b e l = " O t h e r   L o n g - T e r m   L i a b i l i t i e s "   v a l u e s = { b a l a n c e D a t a . m a p ( p   = >   p . o t h e r L o n g T e r m L i a b i l i t i e s ) }   i n d e n t = { 2 0 }   / > }  
                                                 < R o w   l a b e l = " T o t a l   L o n g - T e r m   L i a b i l i t i e s "   v a l u e s = { b a l a n c e D a t a . m a p ( p   = >   p . t o t a l L o n g T e r m L i a b i l i t i e s ) }   b o l d   / >  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 0 p x   8 p x ' ,   b a c k g r o u n d :   ' # f e f 3 c 7 ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   m a r g i n :   ' 8 p x   0 ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 9 2 4 0 0 e '   } } >  
                                                     < d i v > T O T A L   L I A B I L I T I E S < / d i v >  
                                                     { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t '   } } > $ { ( p . t o t a l L i a b i l i t i e s   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K < / d i v > ) }  
                                                 < / d i v >  
                                                 < d i v   s t y l e = { {   m a r g i n :   ' 1 2 p x   0   4 p x ' ,   f o n t S i z e :   ' 1 5 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > E Q U I T Y < / d i v >  
                                                 { b a l a n c e D a t a . s o m e ( p   = >   p . p a i d I n C a p i t a l   >   0 )   & &   < R o w   l a b e l = " P a i d - i n   C a p i t a l "   v a l u e s = { b a l a n c e D a t a . m a p ( p   = >   p . p a i d I n C a p i t a l ) }   i n d e n t = { 2 0 }   / > }  
                                                 { b a l a n c e D a t a . s o m e ( p   = >   p . r e t a i n e d E a r n i n g s   ! = =   0 )   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 4 p x   0 ' ,   f o n t S i z e :   ' 1 3 p x '   } } >  
                                                         < d i v   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b ' ,   p a d d i n g L e f t :   ' 2 0 p x '   } } > R e t a i n e d   E a r n i n g s < / d i v >  
                                                         { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   (  
                                                             < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } >  
                                                                 { p . r e t a i n e d E a r n i n g s   > =   0   ?   ' $ '   :   ' ( $ ' } { ( M a t h . a b s ( p . r e t a i n e d E a r n i n g s )   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K { p . r e t a i n e d E a r n i n g s   <   0   ?   ' ) '   :   ' ' }  
                                                             < / d i v >  
                                                         ) ) }  
                                                     < / d i v >  
                                                 ) }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ` 1 8 0 p x   r e p e a t ( $ { b a l a n c e D a t a . l e n g t h } ,   1 1 0 p x ) ` ,   g a p :   ' 4 p x ' ,   p a d d i n g :   ' 1 2 p x   8 p x ' ,   b a c k g r o u n d :   ' # d c f c e 7 ' ,   b o r d e r R a d i u s :   ' 4 p x ' ,   m a r g i n :   ' 1 2 p x   0   0 ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 5 p x '   } } >  
                                                     < d i v   s t y l e = { {   c o l o r :   ' # 1 6 6 5 3 4 '   } } > T O T A L   E Q U I T Y < / d i v >  
                                                     { b a l a n c e D a t a . m a p ( ( p ,   i )   = >   (  
                                                         < d i v   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   c o l o r :   p . t o t a l E q u i t y   > =   0   ?   ' # 1 6 6 5 3 4 '   :   ' # 9 9 1 b 1 b '   } } >  
                                                             { p . t o t a l E q u i t y   > =   0   ?   ' $ '   :   ' ( $ ' } { ( M a t h . a b s ( p . t o t a l E q u i t y )   /   1 0 0 0 ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   0 ,   m a x i m u m F r a c t i o n D i g i t s :   0   } ) } K { p . t o t a l E q u i t y   <   0   ?   ' ) '   :   ' ' }  
                                                         < / d i v >  
                                                     ) ) }  
                                                 < / d i v >  
                                             < / d i v >  
                                         < / d i v >  
                                     ) ;  
                                 }  
                                  
                                 / /   F o r   b a l a n c e   s h e e t ,   u s e   t h e   l a t e s t   m o n t h ' s   v a l u e s  
                                 c o n s t   c a s h   =   l a t e s t M o n t h . c a s h   | |   0 ;  
                                 c o n s t   a r   =   l a t e s t M o n t h . a r   | |   0 ;  
                                 c o n s t   i n v e n t o r y   =   l a t e s t M o n t h . i n v e n t o r y   | |   0 ;  
                                 c o n s t   o t h e r C A   =   l a t e s t M o n t h . o t h e r C A   | |   0 ;  
                                 c o n s t   t c a   =   c a s h   +   a r   +   i n v e n t o r y   +   o t h e r C A ;  
                                  
                                 c o n s t   f i x e d A s s e t s   =   l a t e s t M o n t h . f i x e d A s s e t s   | |   0 ;  
                                 c o n s t   i n t a n g i b l e A s s e t s   =   l a t e s t M o n t h . i n t a n g i b l e A s s e t s   | |   0 ;  
                                 c o n s t   o t h e r N o n C u r r e n t A s s e t s   =   l a t e s t M o n t h . o t h e r N o n C u r r e n t A s s e t s   | |   0 ;  
                                 c o n s t   n o n C u r r e n t A s s e t s   =   f i x e d A s s e t s   +   i n t a n g i b l e A s s e t s   +   o t h e r N o n C u r r e n t A s s e t s ;  
                                  
                                 c o n s t   t o t a l A s s e t s   =   t c a   +   n o n C u r r e n t A s s e t s ;  
                                  
                                 c o n s t   a p   =   l a t e s t M o n t h . a p   | |   0 ;  
                                 c o n s t   s h o r t T e r m D e b t   =   l a t e s t M o n t h . s h o r t T e r m D e b t   | |   0 ;  
                                 c o n s t   c u r r e n t P o r t i o n L T D   =   l a t e s t M o n t h . c u r r e n t P o r t i o n L T D   | |   0 ;  
                                 c o n s t   o t h e r C u r r e n t L i a b i l i t i e s   =   l a t e s t M o n t h . o t h e r C u r r e n t L i a b i l i t i e s   | |   0 ;  
                                 c o n s t   t o t a l C u r r e n t L i a b i l i t i e s   =   a p   +   s h o r t T e r m D e b t   +   c u r r e n t P o r t i o n L T D   +   o t h e r C u r r e n t L i a b i l i t i e s ;  
                                  
                                 c o n s t   l t d   =   l a t e s t M o n t h . l t d   | |   0 ;  
                                 c o n s t   o t h e r L o n g T e r m L i a b i l i t i e s   =   l a t e s t M o n t h . o t h e r L o n g T e r m L i a b i l i t i e s   | |   0 ;  
                                 c o n s t   t o t a l L o n g T e r m L i a b i l i t i e s   =   l t d   +   o t h e r L o n g T e r m L i a b i l i t i e s ;  
                                  
                                 c o n s t   t o t a l L i a b i l i t i e s   =   t o t a l C u r r e n t L i a b i l i t i e s   +   t o t a l L o n g T e r m L i a b i l i t i e s ;  
                                  
                                 c o n s t   p a i d I n C a p i t a l   =   l a t e s t M o n t h . p a i d I n C a p i t a l   | |   0 ;  
                                 c o n s t   r e t a i n e d E a r n i n g s   =   l a t e s t M o n t h . r e t a i n e d E a r n i n g s   | |   0 ;  
                                 c o n s t   t o t a l E q u i t y   =   p a i d I n C a p i t a l   +   r e t a i n e d E a r n i n g s ;  
                                  
                                 c o n s t   t o t a l L A n d E   =   t o t a l L i a b i l i t i e s   +   t o t a l E q u i t y ;  
                                  
                                 c o n s t   l a t e s t D a t e   =   n e w   D a t e ( l a t e s t M o n t h . d a t e   | |   l a t e s t M o n t h . m o n t h ) ;  
                                 c o n s t   a s O f D a t e   =   l a t e s t D a t e . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   m o n t h :   ' l o n g ' ,   d a y :   ' n u m e r i c ' ,   y e a r :   ' n u m e r i c '   } ) ;  
                                  
                                 r e t u r n   (  
                                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 1 6 p x '   } } >  
                                             < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > B a l a n c e   S h e e t < / h 2 >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > A s   o f   { a s O f D a t e }   ( P e r i o d :   { p e r i o d L a b e l } ) < / d i v >  
                                         < / d i v >  
  
                                         { / *   A S S E T S   * / }  
                                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                                             < d i v   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > A S S E T S < / d i v >  
                                              
                                             { / *   C u r r e n t   A s s e t s   * / }  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                                 < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > C u r r e n t   A s s e t s < / d i v >  
                                                 { c a s h   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > C a s h   &   C a s h   E q u i v a l e n t s < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { c a s h . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { a r   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > A c c o u n t s   R e c e i v a b l e < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { a r . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { i n v e n t o r y   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > I n v e n t o r y < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { i n v e n t o r y . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { o t h e r C A   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > O t h e r   C u r r e n t   A s s e t s < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { o t h e r C A . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 8 p x   0   8 p x   1 0 p x ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   m a r g i n T o p :   ' 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T o t a l   C u r r e n t   A s s e t s < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { t c a . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                 < / d i v >  
                                             < / d i v >  
  
                                             { / *   N o n - C u r r e n t   A s s e t s   * / }  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                                 < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > N o n - C u r r e n t   A s s e t s < / d i v >  
                                                 { f i x e d A s s e t s   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > P r o p e r t y ,   P l a n t   &   E q u i p m e n t < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { f i x e d A s s e t s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { i n t a n g i b l e A s s e t s   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > I n t a n g i b l e   A s s e t s < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { i n t a n g i b l e A s s e t s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { o t h e r N o n C u r r e n t A s s e t s   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > O t h e r   N o n - C u r r e n t   A s s e t s < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { o t h e r N o n C u r r e n t A s s e t s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 8 p x   0   8 p x   1 0 p x ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   m a r g i n T o p :   ' 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T o t a l   N o n - C u r r e n t   A s s e t s < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { n o n C u r r e n t A s s e t s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                 < / d i v >  
                                             < / d i v >  
  
                                             { / *   T O T A L   A S S E T S   * / }  
                                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' # d b e a f e ' ,   p a d d i n g :   ' 1 2 p x ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n '   } } >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } > T O T A L   A S S E T S < / s p a n >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 1 e 4 0 a f '   } } >  
                                                         $ { t o t a l A s s e t s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                                     < / s p a n >  
                                                 < / d i v >  
                                             < / d i v >  
                                         < / d i v >  
  
                                         { / *   L I A B I L I T I E S   * / }  
                                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                                             < d i v   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > L I A B I L I T I E S < / d i v >  
                                              
                                             { / *   C u r r e n t   L i a b i l i t i e s   * / }  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                                 < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > C u r r e n t   L i a b i l i t i e s < / d i v >  
                                                 { a p   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > A c c o u n t s   P a y a b l e < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { a p . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { s h o r t T e r m D e b t   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > S h o r t - T e r m   D e b t < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { s h o r t T e r m D e b t . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { c u r r e n t P o r t i o n L T D   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > C u r r e n t   P o r t i o n   o f   L T   D e b t < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { c u r r e n t P o r t i o n L T D . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { o t h e r C u r r e n t L i a b i l i t i e s   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > O t h e r   C u r r e n t   L i a b i l i t i e s < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { o t h e r C u r r e n t L i a b i l i t i e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 8 p x   0   8 p x   1 0 p x ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   m a r g i n T o p :   ' 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T o t a l   C u r r e n t   L i a b i l i t i e s < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { t o t a l C u r r e n t L i a b i l i t i e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                 < / d i v >  
                                             < / d i v >  
  
                                             { / *   L o n g - T e r m   L i a b i l i t i e s   * / }  
                                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                                 < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > L o n g - T e r m   L i a b i l i t i e s < / d i v >  
                                                 { l t d   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > L o n g - T e r m   D e b t < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { l t d . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 { o t h e r L o n g T e r m L i a b i l i t i e s   >   0   & &   (  
                                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > O t h e r   L o n g - T e r m   L i a b i l i t i e s < / s p a n >  
                                                         < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { o t h e r L o n g T e r m L i a b i l i t i e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                     < / d i v >  
                                                 ) }  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 8 p x   0   8 p x   1 0 p x ' ,   b o r d e r T o p :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   m a r g i n T o p :   ' 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T o t a l   L o n g - T e r m   L i a b i l i t i e s < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 4 7 5 5 6 9 '   } } > $ { t o t a l L o n g T e r m L i a b i l i t i e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                 < / d i v >  
                                             < / d i v >  
  
                                             { / *   T O T A L   L I A B I L I T I E S   * / }  
                                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f e f 3 c 7 ' ,   p a d d i n g :   ' 1 2 p x ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n '   } } >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 9 2 4 0 0 e '   } } > T O T A L   L I A B I L I T I E S < / s p a n >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 9 2 4 0 0 e '   } } >  
                                                         $ { t o t a l L i a b i l i t i e s . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                                     < / s p a n >  
                                                 < / d i v >  
                                             < / d i v >  
                                         < / d i v >  
  
                                         { / *   E Q U I T Y   * / }  
                                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                                             < d i v   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > E Q U I T Y < / d i v >  
                                             { p a i d I n C a p i t a l   >   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > P a i d - i n   C a p i t a l < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > $ { p a i d I n C a p i t a l . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } < / s p a n >  
                                                 < / d i v >  
                                             ) }  
                                             { r e t a i n e d E a r n i n g s   ! = =   0   & &   (  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   p a d d i n g :   ' 4 p x   0   4 p x   2 0 p x ' ,   f o n t S i z e :   ' 1 4 p x '   } } >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } > R e t a i n e d   E a r n i n g s < / s p a n >  
                                                     < s p a n   s t y l e = { {   c o l o r :   ' # 6 4 7 4 8 b '   } } >  
                                                         { r e t a i n e d E a r n i n g s   > =   0   ?   ' $ '   :   ' ( $ ' } { M a t h . a b s ( r e t a i n e d E a r n i n g s ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } { r e t a i n e d E a r n i n g s   <   0   ?   ' ) '   :   ' ' }  
                                                     < / s p a n >  
                                                 < / d i v >  
                                             ) }  
  
                                             { / *   T O T A L   E Q U I T Y   * / }  
                                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' # d c f c e 7 ' ,   p a d d i n g :   ' 1 2 p x ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   m a r g i n T o p :   ' 8 p x '   } } >  
                                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n '   } } >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 1 6 6 5 3 4 '   } } > T O T A L   E Q U I T Y < / s p a n >  
                                                     < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 1 6 6 5 3 4 '   } } >  
                                                         { t o t a l E q u i t y   > =   0   ?   ' $ '   :   ' ( $ ' } { M a t h . a b s ( t o t a l E q u i t y ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) } { t o t a l E q u i t y   <   0   ?   ' ) '   :   ' ' }  
                                                     < / s p a n >  
                                                 < / d i v >  
                                             < / d i v >  
                                         < / d i v >  
  
                                         { / *   T O T A L   L I A B I L I T I E S   &   E Q U I T Y   * / }  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 1 f 5 f 9 ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   m a r g i n T o p :   ' 3 2 p x '   } } >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > T O T A L   L I A B I L I T I E S   &   E Q U I T Y < / s p a n >  
                                                 < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 7 0 0 ' ,   f o n t S i z e :   ' 1 8 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } >  
                                                     $ { t o t a l L A n d E . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                                 < / s p a n >  
                                             < / d i v >  
                                             { M a t h . a b s ( t o t a l A s s e t s   -   t o t a l L A n d E )   >   0 . 0 1   & &   (  
                                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # e f 4 4 4 4 ' ,   m a r g i n T o p :   ' 8 p x ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                      a      B a l a n c e   c h e c k :   A s s e t s   -   ( L i a b i l i t i e s   +   E q u i t y )   =   $ { ( t o t a l A s s e t s   -   t o t a l L A n d E ) . t o L o c a l e S t r i n g ( u n d e f i n e d ,   {   m i n i m u m F r a c t i o n D i g i t s :   2 ,   m a x i m u m F r a c t i o n D i g i t s :   2   } ) }  
                                                 < / d i v >  
                                             ) }  
                                         < / d i v >  
                                     < / d i v >  
                                 ) ;  
                             }  
                         }  
                          
                         e l s e   {  
                             r e t u r n   (  
                                 < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 4 8 p x   3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   m i n H e i g h t :   ' 4 0 0 p x ' ,   t e x t A l i g n :   ' c e n t e r '   } } >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                          x `  F i n a n c i a l   S t a t e m e n t   V i e w e r  
                                     < / d i v >  
                                     < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 9 4 a 3 b 8 ' ,   m a x W i d t h :   ' 6 0 0 p x ' ,   m a r g i n :   ' 0   a u t o '   } } >  
                                         S e l e c t   o p t i o n s   a b o v e   t o   v i e w   f i n a n c i a l   s t a t e m e n t s .  
                                     < / p >  
                                 < / d i v >  
                             ) ;  
                         }  
                     } ) ( ) }  
                     < / >  
                     ) }  
  
                     { / *   L i n e   o f   B u s i n e s s   R e p o r t i n g   T a b   * / }  
                     { f i n a n c i a l S t a t e m e n t s T a b   = = =   ' l i n e - o f - b u s i n e s s '   & &   (  
                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                 < h 2   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } > L i n e   o f   B u s i n e s s   R e p o r t i n g < / h 2 >  
                                 < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                     L i n e   o f   B u s i n e s s   r e p o r t i n g   i s   c u r r e n t l y   o n l y   a v a i l a b l e   f o r   Q u i c k B o o k s   d a t a   w i t h   c l a s s   t r a c k i n g   e n a b l e d .  
                                 < / p >  
                             < / d i v >  
  
                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r :   ' 2 p x   d a s h e d   # c b d 5 e 1 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 4 8 p x   2 4 p x ' ,   t e x t A l i g n :   ' c e n t e r '   } } >  
                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 4 8 p x ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  x `< / d i v >  
                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                     Q u i c k B o o k s   D a t a   R e q u i r e d  
                                 < / d i v >  
                                 < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a x W i d t h :   ' 5 0 0 p x ' ,   m a r g i n :   ' 0   a u t o '   } } >  
                                     T o   u s e   L i n e   o f   B u s i n e s s   r e p o r t i n g ,   p l e a s e   c o n n e c t   y o u r   Q u i c k B o o k s   a c c o u n t   a n d   e n s u r e   c l a s s   t r a c k i n g   i s   e n a b l e d   f o r   y o u r   c o m p a n y .  
                                 < / p >  
                             < / d i v >  
                         < / d i v >  
                     ) }  
                 < / d i v >  
             ) }  
  
             { / *   F i n a n c i a l   S t a t e m e n t s   V i e w   -   N o   D a t a   A v a i l a b l e   * / }  
             { c u r r e n t V i e w   = = =   ' f i n a n c i a l - s t a t e m e n t s '   & &   s e l e c t e d C o m p a n y I d   & &   ! q b R a w D a t a   & &   m o n t h l y . l e n g t h   = = =   0   & &   (  
                 < d i v   s t y l e = { {   m a x W i d t h :   ' 1 8 0 0 p x ' ,   m a r g i n :   ' 0   a u t o ' ,   p a d d i n g :   ' 3 2 p x '   } } >  
                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                         < h 1   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n :   0   } } > F i n a n c i a l   S t a t e m e n t s < / h 1 >  
                         { c o m p a n y N a m e   & &   < d i v   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > { c o m p a n y N a m e } < / d i v > }  
                     < / d i v >  
                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 4 8 p x   3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   m i n H e i g h t :   ' 4 0 0 p x ' ,   t e x t A l i g n :   ' c e n t e r ' ,   m a r g i n T o p :   ' 3 2 p x '   } } >  
                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                              x `  N o   F i n a n c i a l   D a t a   A v a i l a b l e  
                         < / d i v >  
                         < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 9 4 a 3 b 8 ' ,   m a x W i d t h :   ' 6 0 0 p x ' ,   m a r g i n :   ' 0   a u t o '   } } >  
                             P l e a s e   i m p o r t   f i n a n c i a l   d a t a   v i a   C S V   o r   s y n c   f r o m   Q u i c k B o o k s   t o   v i e w   f i n a n c i a l   s t a t e m e n t s .  
                         < / p >  
                     < / d i v >  
                 < / d i v >  
             ) }  
  
             { / *   P r o f i l e   V i e w   * / }  
             { c u r r e n t V i e w   = = =   ' a d m i n '   & &   a d m i n D a s h b o a r d T a b   = = =   ' p r o f i l e '   & &   s e l e c t e d C o m p a n y I d   & &   c u r r e n t U s e r ? . r o l e   = = =   ' c o n s u l t a n t '   & &   (  
                 < d i v   s t y l e = { {   m a x W i d t h :   ' 1 4 0 0 p x ' ,   m a r g i n :   ' 0   a u t o ' ,   p a d d i n g :   ' 8 p x   3 2 p x   3 2 p x   3 2 p x '   } } >  
                     < s t y l e > { `  
                         @ m e d i a   p r i n t   {  
                             @ p a g e   {  
                                 m a r g i n :   0 . 7 5 i n   0 . 7 5 i n   0 . 7 5 i n   0 . 7 5 i n ;  
                             }  
                              
                             b o d y ,   m a i n ,   m a i n   *   {  
                                 m a r g i n - t o p :   0   ! i m p o r t a n t ;  
                             }  
                              
                             # f i r s t - p r o f i l e - s e c t i o n   {  
                                 p a d d i n g :   0   3 2 p x   3 2 p x   3 2 p x   ! i m p o r t a n t ;  
                                 m a r g i n - t o p :   0   ! i m p o r t a n t ;  
                                 m a r g i n - b o t t o m :   0   ! i m p o r t a n t ;  
                             }  
                              
                             . p a g e - b r e a k   {  
                                 p a g e - b r e a k - a f t e r :   a l w a y s ;  
                                 b r e a k - a f t e r :   p a g e ;  
                                 p a d d i n g :   3 2 p x   ! i m p o r t a n t ;  
                                 m a r g i n :   0   ! i m p o r t a n t ;  
                             }  
                              
                             . p r i n t - p a g e - h e a d e r   {  
                                 d i s p l a y :   n o n e   ! i m p o r t a n t ;  
                             }  
                              
                             a s i d e ,   h e a d e r ,   . n o - p r i n t ,   . d a s h b o a r d - h e a d e r - p r i n t - h i d e ,   . d a s h b o a r d - t a b s - p r i n t - h i d e   {  
                                 d i s p l a y :   n o n e   ! i m p o r t a n t ;  
                             }  
                              
                             b o d y   {  
                                 b a c k g r o u n d :   w h i t e   ! i m p o r t a n t ;  
                                 p a d d i n g :   0   ! i m p o r t a n t ;  
                                 m a r g i n :   0   ! i m p o r t a n t ;  
                             }  
                              
                             m a i n   {  
                                 p a d d i n g :   0   ! i m p o r t a n t ;  
                                 m a r g i n :   0   ! i m p o r t a n t ;  
                             }  
                              
                             m a i n   >   d i v   {  
                                 p a d d i n g :   0   ! i m p o r t a n t ;  
                                 m a r g i n :   0   ! i m p o r t a n t ;  
                                 m a x - w i d t h :   n o n e   ! i m p o r t a n t ;  
                             }  
                              
                             *   {  
                                 b o x - s h a d o w :   n o n e   ! i m p o r t a n t ;  
                                 b o r d e r - r a d i u s :   0   ! i m p o r t a n t ;  
                             }  
                         }  
                          
                         . p r i n t - p a g e - h e a d e r   {  
                             d i s p l a y :   n o n e ;  
                         }  
                     ` } < / s t y l e >  
                      
                     < d i v   c l a s s N a m e = " n o - p r i n t "   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                         < d i v   s t y l e = { {   f l e x :   1   } } >  
                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                 < h 1   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n :   0   } } > C o m p a n y   P r o f i l e < / h 1 >  
                             < / d i v >  
                             < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n :   0   } } >  
                                 T h i s   s u m m a r y   w a s   c o n s t r u c t e d   f r o m   t h e   c o m p a n y ' s   p a s t   t h r e e   y e a r s   o f   f i n a n c i a l   s t a t e m e n t s .  
                             < / p >  
                         < / d i v >  
                         < b u t t o n  
                             o n C l i c k = { ( )   = >   w i n d o w . p r i n t ( ) }  
                             s t y l e = { {    
                                 p a d d i n g :   ' 1 2 p x   2 4 p x ' ,    
                                 b a c k g r o u n d :   ' # 6 6 7 e e a ' ,    
                                 c o l o r :   ' w h i t e ' ,    
                                 b o r d e r :   ' n o n e ' ,    
                                 b o r d e r R a d i u s :   ' 8 p x ' ,    
                                 f o n t S i z e :   ' 1 4 p x ' ,    
                                 f o n t W e i g h t :   ' 6 0 0 ' ,    
                                 c u r s o r :   ' p o i n t e r ' ,  
                                 b o x S h a d o w :   ' 0   2 p x   6 p x   r g b a ( 1 0 2 ,   1 2 6 ,   2 3 4 ,   0 . 3 ) '  
                             } }  
                         >  
                              x       P r i n t   P r o f i l e  
                         < / b u t t o n >  
                     < / d i v >  
  
                     { ( ( )   = >   {  
                         / /   G e t   o r   c r e a t e   p r o f i l e   f o r   t h i s   c o m p a n y  
                         l e t   p r o f i l e   =   c o m p a n y P r o f i l e s . f i n d ( p   = >   p . c o m p a n y I d   = = =   s e l e c t e d C o m p a n y I d ) ;  
                          
                         i f   ( ! p r o f i l e )   {  
                             p r o f i l e   =   {  
                                 c o m p a n y I d :   s e l e c t e d C o m p a n y I d ,  
                                 l e g a l S t r u c t u r e :   ' ' ,  
                                 b u s i n e s s S t a t u s :   ' ' ,  
                                 o w n e r s h i p :   ' ' ,  
                                 w o r k f o r c e :   ' ' ,  
                                 k e y A d v i s o r s :   ' ' ,  
                                 s p e c i a l N o t e s :   ' ' ,  
                                 q o e N o t e s :   ' ' ,  
                                 d i s c l o s u r e s :   {  
                                     b a n k r u p t c i e s :   ' N o n e ' ,  
                                     l i e n s :   ' N o n e ' ,  
                                     c o n t r a c t s :   ' N o n e ' ,  
                                     l a w s u i t s :   ' N o n e ' ,  
                                     m o s t F a v o r e d N a t i o n :   ' N o n e ' ,  
                                     e q u i t y C o n t r o l :   ' N o n e ' ,  
                                     r i g h t O f F i r s t R e f u s a l :   ' N o n e ' ,  
                                     s h a r e h o l d e r P r o t e c t i o n s :   ' N o n e ' ,  
                                     c h a n g e I n C o n t r o l :   ' N o n e ' ,  
                                     r e g u l a t o r y A p p r o v a l s :   ' N o n e ' ,  
                                     a u d i t e d F i n a n c i a l s :   ' N o '  
                                 }  
                             } ;  
                         }  
  
                         c o n s t   u p d a t e P r o f i l e   =   ( u p d a t e s :   P a r t i a l < C o m p a n y P r o f i l e > )   = >   {  
                             c o n s t   u p d a t e d P r o f i l e s   =   c o m p a n y P r o f i l e s . f i l t e r ( p   = >   p . c o m p a n y I d   ! = =   s e l e c t e d C o m p a n y I d ) ;  
                             u p d a t e d P r o f i l e s . p u s h ( {   . . . p r o f i l e ! ,   . . . u p d a t e s   } ) ;  
                             s e t C o m p a n y P r o f i l e s ( u p d a t e d P r o f i l e s ) ;  
                         } ;  
  
                         / /   G e t   c o m p a n y   d a t a  
                         c o n s t   l t m D a t a   =   m o n t h l y . l e n g t h   > =   1 2   ?   m o n t h l y . s l i c e ( - 1 2 )   :   m o n t h l y ;  
                         c o n s t   l t m R e v   =   l t m D a t a . r e d u c e ( ( s u m ,   m )   = >   s u m   +   m . r e v e n u e ,   0 ) ;  
                         c o n s t   l t m A s s e t s   =   l t m D a t a . l e n g t h   >   0   ?   l t m D a t a [ l t m D a t a . l e n g t h   -   1 ] . t o t a l A s s e t s   :   0 ;  
                          
                         / /   G e t   l a t e s t   3   y e a r s   o f   d a t a   f o r   f i n a n c i a l   s t a t e m e n t   o v e r v i e w  
                         c o n s t   l a t e s t   =   m o n t h l y [ m o n t h l y . l e n g t h   -   1 ] ;  
                         c o n s t   o n e Y e a r A g o   =   m o n t h l y . l e n g t h   > =   1 3   ?   m o n t h l y [ m o n t h l y . l e n g t h   -   1 3 ]   :   n u l l ;  
                         c o n s t   t w o Y e a r s A g o   =   m o n t h l y . l e n g t h   > =   2 5   ?   m o n t h l y [ m o n t h l y . l e n g t h   -   2 5 ]   :   n u l l ;  
  
                         / /   G e t   i n d u s t r y   i n f o  
                         c o n s t   i n d u s t r y   =   I N D U S T R Y _ S E C T O R S . f i n d ( i   = >   i . i d   = = =   c o m p a n y ? . i n d u s t r y S e c t o r ) ;  
                          
                         / /   C a l c u l a t e   L a s t   1 2   m o n t h s   f o r   r a t i o   t a b l e  
                         / /   G e t   u p   t o   l a s t   1 2   t r e n d   d a t a   p o i n t s   ( o r   f e w e r   i f   l e s s   d a t a   a v a i l a b l e )  
                         c o n s t   l a s t 1 2 T r e n d s   =   t r e n d D a t a . s l i c e ( - 1 2 ) ;  
                         / /   G e t   t h e   c o r r e s p o n d i n g   m o n t h s   f o r   t h e s e   t r e n d   p o i n t s  
                         / /   t r e n d D a t a   s t a r t s   a t   m o n t h   i n d e x   1 2 ,   s o   w e   n e e d   t o   m a t c h   u p   t h e   m o n t h s  
                         c o n s t   t r e n d S t a r t I n d e x   =   M a t h . m a x ( 0 ,   m o n t h l y . l e n g t h   -   t r e n d D a t a . l e n g t h ) ;  
                         c o n s t   l a s t 1 2 M o n t h s   =   m o n t h l y . s l i c e ( t r e n d S t a r t I n d e x   +   M a t h . m a x ( 0 ,   t r e n d D a t a . l e n g t h   -   1 2 ) ) ;  
  
                         r e t u r n   (  
                             < >  
                                 { / *   S e c t i o n   1 :   B u s i n e s s   P r o f i l e   * / }  
                                 < d i v   i d = " f i r s t - p r o f i l e - s e c t i o n "   c l a s s N a m e = " p a g e - b r e a k "   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                     < d i v   c l a s s N a m e = " p r i n t - p a g e - h e a d e r " >  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > { c o m p a n y ? . n a m e } < / d i v >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { n e w   D a t e ( ) . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   y e a r :   ' n u m e r i c ' ,   m o n t h :   ' l o n g ' ,   d a y :   ' n u m e r i c '   } ) } < / d i v >  
                                         < / d i v >  
                                     < / d i v >  
                                     < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 1 2 p x '   } } >  
                                         B u s i n e s s   P r o f i l e  
                                     < / h 2 >  
                                      
                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 2 0 0 p x   1 f r ' ,   g a p :   ' 1 6 p x ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                         < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C O M P A N Y   N A M E < / d i v >  
                                         < d i v   s t y l e = { {   c o l o r :   ' # 1 e 2 9 3 b '   } } > { c o m p a n y ? . n a m e   | |   ' N / A ' } < / d i v >  
                                          
                                         < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > L E G A L   S T R U C T U R E < / d i v >  
                                         < i n p u t    
                                             t y p e = " t e x t "    
                                             v a l u e = { p r o f i l e . l e g a l S t r u c t u r e }    
                                             o n C h a n g e = { ( e )   = >   u p d a t e P r o f i l e ( {   l e g a l S t r u c t u r e :   e . t a r g e t . v a l u e   } ) }  
                                             p l a c e h o l d e r = " e . g . ,   C   C o r p ,   S   C o r p ,   L L C "  
                                             s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 4 p x '   } }  
                                         / >  
                                          
                                         < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > B U S I N E S S   S T A T U S < / d i v >  
                                         < s e l e c t  
                                             v a l u e = { p r o f i l e . b u s i n e s s S t a t u s }  
                                             o n C h a n g e = { ( e )   = >   u p d a t e P r o f i l e ( {   b u s i n e s s S t a t u s :   e . t a r g e t . v a l u e   } ) }  
                                             s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 4 p x '   } }  
                                         >  
                                             < o p t i o n   v a l u e = " " > S e l e c t   s t a t u s < / o p t i o n >  
                                             < o p t i o n   v a l u e = " A C T I V E " > A C T I V E < / o p t i o n >  
                                             < o p t i o n   v a l u e = " I N A C T I V E " > I N A C T I V E < / o p t i o n >  
                                             < o p t i o n   v a l u e = " P E N D I N G " > P E N D I N G < / o p t i o n >  
                                         < / s e l e c t >  
                                          
                                         < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > O W N E R S H I P < / d i v >  
                                         < i n p u t    
                                             t y p e = " t e x t "    
                                             v a l u e = { p r o f i l e . o w n e r s h i p }    
                                             o n C h a n g e = { ( e )   = >   u p d a t e P r o f i l e ( {   o w n e r s h i p :   e . t a r g e t . v a l u e   } ) }  
                                             p l a c e h o l d e r = " O w n e r   n a m e ( s ) "  
                                             s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 4 p x '   } }  
                                         / >  
                                          
                                         < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > A D D R E S S < / d i v >  
                                         < d i v   s t y l e = { {   c o l o r :   ' # 1 e 2 9 3 b '   } } >  
                                             { c o m p a n y ? . a d d r e s s S t r e e t   | |   c o m p a n y ? . a d d r e s s C i t y   ?   (  
                                                 < >  
                                                     { c o m p a n y ? . a d d r e s s S t r e e t   & &   < d i v > { c o m p a n y . a d d r e s s S t r e e t } < / d i v > }  
                                                     < d i v >  
                                                         { c o m p a n y ? . a d d r e s s C i t y   & &   c o m p a n y . a d d r e s s C i t y }  
                                                         { c o m p a n y ? . a d d r e s s S t a t e   & &   ` ,   $ { c o m p a n y . a d d r e s s S t a t e } ` }  
                                                         { c o m p a n y ? . a d d r e s s Z i p   & &   `   $ { c o m p a n y . a d d r e s s Z i p } ` }  
                                                     < / d i v >  
                                                     { c o m p a n y ? . a d d r e s s C o u n t r y   & &   < d i v > { c o m p a n y . a d d r e s s C o u n t r y } < / d i v > }  
                                                 < / >  
                                             )   :   (  
                                                 ' N o t   s e t '  
                                             ) }  
                                         < / d i v >  
                                          
                                         < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > I N D U S T R Y < / d i v >  
                                         < d i v   s t y l e = { {   c o l o r :   ' # 1 e 2 9 3 b '   } } >  
                                             { i n d u s t r y   ?   ` $ { i n d u s t r y . i d }   -   $ { i n d u s t r y . n a m e } `   :   ' N o t   s e t ' }  
                                         < / d i v >  
                                          
                                         < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > W O R K F O R C E < / d i v >  
                                         < i n p u t    
                                             t y p e = " t e x t "    
                                             v a l u e = { p r o f i l e . w o r k f o r c e }    
                                             o n C h a n g e = { ( e )   = >   u p d a t e P r o f i l e ( {   w o r k f o r c e :   e . t a r g e t . v a l u e   } ) }  
                                             p l a c e h o l d e r = " e . g . ,   3   F T ,   1   o w n e r "  
                                             s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 4 p x '   } }  
                                         / >  
                                          
                                         < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > L T M   R E V E N U E < / d i v >  
                                         < d i v   s t y l e = { {   c o l o r :   ' # 1 e 2 9 3 b '   } } >  
                                             { l t m R e v   <   5 0 0 0 0 0   ?   ' U n d e r   $ 5 0 0 K '   :   ` $ $ { ( l t m R e v   /   1 0 0 0 ) . t o F i x e d ( 0 ) } K ` }  
                                         < / d i v >  
                                          
                                         < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T O T A L   A S S E T S < / d i v >  
                                         < d i v   s t y l e = { {   c o l o r :   ' # 1 e 2 9 3 b '   } } >  
                                             $ { l t m A s s e t s . t o L o c a l e S t r i n g ( ) }  
                                         < / d i v >  
                                          
                                         < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > K E Y   A D V I S O R S < / d i v >  
                                         < i n p u t    
                                             t y p e = " t e x t "    
                                             v a l u e = { p r o f i l e . k e y A d v i s o r s }    
                                             o n C h a n g e = { ( e )   = >   u p d a t e P r o f i l e ( {   k e y A d v i s o r s :   e . t a r g e t . v a l u e   } ) }  
                                             p l a c e h o l d e r = " A d v i s o r   n a m e s "  
                                             s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 4 p x '   } }  
                                         / >  
                                     < / d i v >  
                                      
                                     < d i v   s t y l e = { {   m a r g i n T o p :   ' 2 4 p x '   } } >  
                                         < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > S P E C I A L   N O T E S < / d i v >  
                                         < t e x t a r e a  
                                             v a l u e = { p r o f i l e . s p e c i a l N o t e s }  
                                             o n C h a n g e = { ( e )   = >   u p d a t e P r o f i l e ( {   s p e c i a l N o t e s :   e . t a r g e t . v a l u e   } ) }  
                                             p l a c e h o l d e r = " A n y   s p e c i a l   n o t e s   a b o u t   s a l e ,   b u y e r   r e q u i r e m e n t s ,   f i n a n c i n g ,   e t c . "  
                                             r o w s = { 4 }  
                                             s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 1 2 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t F a m i l y :   ' i n h e r i t ' ,   r e s i z e :   ' v e r t i c a l '   } }  
                                         / >  
                                     < / d i v >  
                                      
                                     < d i v   s t y l e = { {   m a r g i n T o p :   ' 1 6 p x '   } } >  
                                         < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > Q u a l i t y   o f   E a r n i n g s   ( Q o E ) < / d i v >  
                                         < t e x t a r e a  
                                             v a l u e = { p r o f i l e . q o e N o t e s }  
                                             o n C h a n g e = { ( e )   = >   u p d a t e P r o f i l e ( {   q o e N o t e s :   e . t a r g e t . v a l u e   } ) }  
                                             p l a c e h o l d e r = " N o t e s   o n   r e v e n u e   q u a l i t y ,   r e c u r r i n g   v s .   n o n - r e c u r r i n g ,   c a s h   v s .   c r e d i t ,   e t c . "  
                                             r o w s = { 3 }  
                                             s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   p a d d i n g :   ' 1 2 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t F a m i l y :   ' i n h e r i t ' ,   r e s i z e :   ' v e r t i c a l '   } }  
                                         / >  
                                     < / d i v >  
                                 < / d i v >  
  
                                 { / *   S e c t i o n   2 :   F i n a n c i a l   S t a t e m e n t   O v e r v i e w   * / }  
                                 < d i v   c l a s s N a m e = " p a g e - b r e a k "   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                     < d i v   c l a s s N a m e = " p r i n t - p a g e - h e a d e r " >  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > { c o m p a n y ? . n a m e } < / d i v >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { n e w   D a t e ( ) . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   y e a r :   ' n u m e r i c ' ,   m o n t h :   ' l o n g ' ,   d a y :   ' n u m e r i c '   } ) } < / d i v >  
                                         < / d i v >  
                                     < / d i v >  
                                     < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 1 2 p x '   } } >  
                                         F i n a n c i a l   S t a t e m e n t   O v e r v i e w  
                                     < / h 2 >  
                                      
                                     < h 3   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } > B A L A N C E   S H E E T < / h 3 >  
                                     < d i v   s t y l e = { {   o v e r f l o w X :   ' a u t o '   } } >  
                                         < t a b l e   s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   b o r d e r C o l l a p s e :   ' c o l l a p s e '   } } >  
                                             < t h e a d >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                     < t h   s t y l e = { {   t e x t A l i g n :   ' l e f t ' ,   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > < / t h >  
                                                     < t h   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > C u r r e n t < / t h >  
                                                     < t h   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > Y r   E n d   2 0 2 4 < / t h >  
                                                     < t h   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > Y r   E n d   2 0 2 3 < / t h >  
                                                 < / t r >  
                                             < / t h e a d >  
                                             < t b o d y >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T o t a l   A s s e t s < / t d >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                         $ { l a t e s t   ?   l a t e s t . t o t a l A s s e t s . t o L o c a l e S t r i n g ( )   :   ' N / A ' }  
                                                     < / t d >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                         $ { o n e Y e a r A g o   ?   o n e Y e a r A g o . t o t a l A s s e t s . t o L o c a l e S t r i n g ( )   :   ' N / A ' }  
                                                     < / t d >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                         $ { t w o Y e a r s A g o   ?   t w o Y e a r s A g o . t o t a l A s s e t s . t o L o c a l e S t r i n g ( )   :   ' N / A ' }  
                                                     < / t d >  
                                                 < / t r >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T o t a l   L i a b i l i t i e s < / t d >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                         $ { l a t e s t   ?   l a t e s t . t o t a l L i a b . t o L o c a l e S t r i n g ( )   :   ' N / A ' }  
                                                     < / t d >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                         $ { o n e Y e a r A g o   ?   o n e Y e a r A g o . t o t a l L i a b . t o L o c a l e S t r i n g ( )   :   ' N / A ' }  
                                                     < / t d >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                         $ { t w o Y e a r s A g o   ?   t w o Y e a r s A g o . t o t a l L i a b . t o L o c a l e S t r i n g ( )   :   ' N / A ' }  
                                                     < / t d >  
                                                 < / t r >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T o t a l   E q u i t y < / t d >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                         $ { l a t e s t   ?   l a t e s t . t o t a l E q u i t y . t o L o c a l e S t r i n g ( )   :   ' N / A ' }  
                                                     < / t d >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                         $ { o n e Y e a r A g o   ?   o n e Y e a r A g o . t o t a l E q u i t y . t o L o c a l e S t r i n g ( )   :   ' N / A ' }  
                                                     < / t d >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                         $ { t w o Y e a r s A g o   ?   t w o Y e a r s A g o . t o t a l E q u i t y . t o L o c a l e S t r i n g ( )   :   ' N / A ' }  
                                                     < / t d >  
                                                 < / t r >  
                                             < / t b o d y >  
                                         < / t a b l e >  
                                     < / d i v >  
                                      
                                     < h 3   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n T o p :   ' 3 2 p x ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } > I N C O M E   S T A T E M E N T < / h 3 >  
                                     < d i v   s t y l e = { {   o v e r f l o w X :   ' a u t o '   } } >  
                                         < t a b l e   s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   b o r d e r C o l l a p s e :   ' c o l l a p s e '   } } >  
                                             < t h e a d >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                     < t h   s t y l e = { {   t e x t A l i g n :   ' l e f t ' ,   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > < / t h >  
                                                     < t h   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > L T M < / t h >  
                                                     < t h   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > 2 0 2 4 < / t h >  
                                                     < t h   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > 2 0 2 3 < / t h >  
                                                 < / t r >  
                                             < / t h e a d >  
                                             < t b o d y >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > R e v e n u e < / t d >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                         $ { l t m R e v . t o L o c a l e S t r i n g ( ) }  
                                                     < / t d >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                         $ { o n e Y e a r A g o   ?   m o n t h l y . s l i c e ( - 2 4 ,   - 1 2 ) . r e d u c e ( ( s u m ,   m )   = >   s u m   +   m . r e v e n u e ,   0 ) . t o L o c a l e S t r i n g ( )   :   ' N / A ' }  
                                                     < / t d >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                         $ { t w o Y e a r s A g o   ?   m o n t h l y . s l i c e ( - 3 6 ,   - 2 4 ) . r e d u c e ( ( s u m ,   m )   = >   s u m   +   m . r e v e n u e ,   0 ) . t o L o c a l e S t r i n g ( )   :   ' N / A ' }  
                                                     < / t d >  
                                                 < / t r >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > M a r g i n   % < / t d >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                         { ( ( l t m D a t a . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . r e v e n u e   -   m . c o g s T o t a l ) ,   0 )   /   l t m R e v )   *   1 0 0 ) . t o F i x e d ( 2 ) } %  
                                                     < / t d >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                         { o n e Y e a r A g o   ?   ( ( m o n t h l y . s l i c e ( - 2 4 ,   - 1 2 ) . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . r e v e n u e   -   m . c o g s T o t a l ) ,   0 )   /   m o n t h l y . s l i c e ( - 2 4 ,   - 1 2 ) . r e d u c e ( ( s u m ,   m )   = >   s u m   +   m . r e v e n u e ,   0 ) )   *   1 0 0 ) . t o F i x e d ( 1 )   +   ' % '   :   ' N / A ' }  
                                                     < / t d >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                         { t w o Y e a r s A g o   ?   ( ( m o n t h l y . s l i c e ( - 3 6 ,   - 2 4 ) . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . r e v e n u e   -   m . c o g s T o t a l ) ,   0 )   /   m o n t h l y . s l i c e ( - 3 6 ,   - 2 4 ) . r e d u c e ( ( s u m ,   m )   = >   s u m   +   m . r e v e n u e ,   0 ) )   *   1 0 0 ) . t o F i x e d ( 1 )   +   ' % '   :   ' N / A ' }  
                                                     < / t d >  
                                                 < / t r >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > T o t a l   E x p e n s e s < / t d >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                         $ { l t m D a t a . r e d u c e ( ( s u m ,   m )   = >   s u m   +   m . e x p e n s e ,   0 ) . t o L o c a l e S t r i n g ( ) }  
                                                     < / t d >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                         $ { o n e Y e a r A g o   ?   m o n t h l y . s l i c e ( - 2 4 ,   - 1 2 ) . r e d u c e ( ( s u m ,   m )   = >   s u m   +   m . e x p e n s e ,   0 ) . t o L o c a l e S t r i n g ( )   :   ' N / A ' }  
                                                     < / t d >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                         $ { t w o Y e a r s A g o   ?   m o n t h l y . s l i c e ( - 3 6 ,   - 2 4 ) . r e d u c e ( ( s u m ,   m )   = >   s u m   +   m . e x p e n s e ,   0 ) . t o L o c a l e S t r i n g ( )   :   ' N / A ' }  
                                                     < / t d >  
                                                 < / t r >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > N e t   I n c o m e < / t d >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                         $ { l t m D a t a . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . r e v e n u e   -   m . e x p e n s e ) ,   0 ) . t o L o c a l e S t r i n g ( ) }  
                                                     < / t d >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                         $ { o n e Y e a r A g o   ?   m o n t h l y . s l i c e ( - 2 4 ,   - 1 2 ) . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . r e v e n u e   -   m . e x p e n s e ) ,   0 ) . t o L o c a l e S t r i n g ( )   :   ' N / A ' }  
                                                     < / t d >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                         $ { t w o Y e a r s A g o   ?   m o n t h l y . s l i c e ( - 3 6 ,   - 2 4 ) . r e d u c e ( ( s u m ,   m )   = >   s u m   +   ( m . r e v e n u e   -   m . e x p e n s e ) ,   0 ) . t o L o c a l e S t r i n g ( )   :   ' N / A ' }  
                                                     < / t d >  
                                                 < / t r >  
                                             < / t b o d y >  
                                         < / t a b l e >  
                                     < / d i v >  
                                 < / d i v >  
  
                                 { / *   S e c t i o n   3 :   F i n a n c i a l   R a t i o s   O v e r v i e w   * / }  
                                 < d i v   c l a s s N a m e = " p a g e - b r e a k "   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                     < d i v   c l a s s N a m e = " p r i n t - p a g e - h e a d e r " >  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > { c o m p a n y ? . n a m e } < / d i v >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { n e w   D a t e ( ) . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   y e a r :   ' n u m e r i c ' ,   m o n t h :   ' l o n g ' ,   d a y :   ' n u m e r i c '   } ) } < / d i v >  
                                         < / d i v >  
                                     < / d i v >  
                                     < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 1 2 p x '   } } >  
                                         F i n a n c i a l   R a t i o s   O v e r v i e w  
                                     < / h 2 >  
                                      
                                     { / *   L i q u i d i t y   R a t i o s   * / }  
                                     < h 3   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > L i q u i d i t y   R a t i o s < / h 3 >  
                                     < d i v   s t y l e = { {   o v e r f l o w X :   ' a u t o ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                         < t a b l e   s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   f o n t S i z e :   ' 1 2 p x ' ,   b o r d e r C o l l a p s e :   ' c o l l a p s e '   } } >  
                                             < t h e a d >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                     < t h   s t y l e = { {   t e x t A l i g n :   ' l e f t ' ,   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m i n W i d t h :   ' 1 2 0 p x '   } } > R a t i o < / t h >  
                                                     { l a s t 1 2 M o n t h s . m a p ( ( m ,   i )   = >   (  
                                                         < t h   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m i n W i d t h :   ' 6 0 p x '   } } >  
                                                             { m . m o n t h . s u b s t r i n g ( 0 ,   m . m o n t h . l a s t I n d e x O f ( ' / ' ) ) }  
                                                         < / t h >  
                                                     ) ) }  
                                                 < / t r >  
                                             < / t h e a d >  
                                             < t b o d y >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > C u r r e n t   R a t i o < / t d >  
                                                     { l a s t 1 2 T r e n d s . m a p ( ( d a t a ,   i )   = >   (  
                                                         < t d   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             { d a t a ? . c u r r e n t R a t i o   ! = =   u n d e f i n e d   ?   d a t a . c u r r e n t R a t i o . t o F i x e d ( 1 )   :   ' N / A ' }  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > Q u i c k   R a t i o < / t d >  
                                                     { l a s t 1 2 T r e n d s . m a p ( ( d a t a ,   i )   = >   (  
                                                         < t d   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             { d a t a ? . q u i c k R a t i o   ! = =   u n d e f i n e d   ?   d a t a . q u i c k R a t i o . t o F i x e d ( 1 )   :   ' N / A ' }  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                             < / t b o d y >  
                                         < / t a b l e >  
                                     < / d i v >  
                                      
                                     { / *   A c t i v i t y   R a t i o s   * / }  
                                     < h 3   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > A c t i v i t y   R a t i o s < / h 3 >  
                                     < d i v   s t y l e = { {   o v e r f l o w X :   ' a u t o ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                         < t a b l e   s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   f o n t S i z e :   ' 1 2 p x ' ,   b o r d e r C o l l a p s e :   ' c o l l a p s e '   } } >  
                                             < t h e a d >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                     < t h   s t y l e = { {   t e x t A l i g n :   ' l e f t ' ,   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m i n W i d t h :   ' 1 2 0 p x '   } } > R a t i o < / t h >  
                                                     { l a s t 1 2 M o n t h s . m a p ( ( m ,   i )   = >   (  
                                                         < t h   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m i n W i d t h :   ' 6 0 p x '   } } >  
                                                             { m . m o n t h . s u b s t r i n g ( 0 ,   m . m o n t h . l a s t I n d e x O f ( ' / ' ) ) }  
                                                         < / t h >  
                                                     ) ) }  
                                                 < / t r >  
                                             < / t h e a d >  
                                             < t b o d y >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > I n v e n t o r y   T u r n o v e r < / t d >  
                                                     { l a s t 1 2 T r e n d s . m a p ( ( d a t a ,   i )   = >   (  
                                                         < t d   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             { d a t a ? . i n v T u r n o v e r   ! = =   u n d e f i n e d   ?   d a t a . i n v T u r n o v e r . t o F i x e d ( 1 )   :   ' N / A ' }  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > R e c e i v a b l e s   T u r n o v e r < / t d >  
                                                     { l a s t 1 2 T r e n d s . m a p ( ( d a t a ,   i )   = >   (  
                                                         < t d   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             { d a t a ? . a r T u r n o v e r   ! = =   u n d e f i n e d   ?   d a t a . a r T u r n o v e r . t o F i x e d ( 1 )   :   ' N / A ' }  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > S a l e s / W o r k i n g   C a p i t a l < / t d >  
                                                     { l a s t 1 2 T r e n d s . m a p ( ( d a t a ,   i )   = >   (  
                                                         < t d   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             { d a t a ? . s a l e s W C   ! = =   u n d e f i n e d   ?   d a t a . s a l e s W C . t o F i x e d ( 1 )   :   ' N / A ' }  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                             < / t b o d y >  
                                         < / t a b l e >  
                                     < / d i v >  
                                      
                                     { / *   C o v e r a g e   R a t i o s   * / }  
                                     < h 3   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > C o v e r a g e   R a t i o s < / h 3 >  
                                     < d i v   s t y l e = { {   o v e r f l o w X :   ' a u t o ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                         < t a b l e   s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   f o n t S i z e :   ' 1 2 p x ' ,   b o r d e r C o l l a p s e :   ' c o l l a p s e '   } } >  
                                             < t h e a d >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                     < t h   s t y l e = { {   t e x t A l i g n :   ' l e f t ' ,   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m i n W i d t h :   ' 1 2 0 p x '   } } > R a t i o < / t h >  
                                                     { l a s t 1 2 M o n t h s . m a p ( ( m ,   i )   = >   (  
                                                         < t h   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m i n W i d t h :   ' 6 0 p x '   } } >  
                                                             { m . m o n t h . s u b s t r i n g ( 0 ,   m . m o n t h . l a s t I n d e x O f ( ' / ' ) ) }  
                                                         < / t h >  
                                                     ) ) }  
                                                 < / t r >  
                                             < / t h e a d >  
                                             < t b o d y >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > I n t e r e s t   C o v e r a g e < / t d >  
                                                     { l a s t 1 2 T r e n d s . m a p ( ( d a t a ,   i )   = >   (  
                                                         < t d   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             { d a t a ? . i n t e r e s t C o v   ! = =   u n d e f i n e d   ?   d a t a . i n t e r e s t C o v . t o F i x e d ( 1 )   :   ' N / A ' }  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > D e b t   S e r v i c e   C o v e r a g e < / t d >  
                                                     { l a s t 1 2 T r e n d s . m a p ( ( d a t a ,   i )   = >   (  
                                                         < t d   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             { d a t a ? . d e b t S v c C o v   ! = =   u n d e f i n e d   ?   d a t a . d e b t S v c C o v . t o F i x e d ( 1 )   :   ' N / A ' }  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                             < / t b o d y >  
                                         < / t a b l e >  
                                     < / d i v >  
                                      
                                     { / *   L e v e r a g e   R a t i o s   * / }  
                                     < h 3   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > L e v e r a g e   R a t i o s < / h 3 >  
                                     < d i v   s t y l e = { {   o v e r f l o w X :   ' a u t o ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                         < t a b l e   s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   f o n t S i z e :   ' 1 2 p x ' ,   b o r d e r C o l l a p s e :   ' c o l l a p s e '   } } >  
                                             < t h e a d >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                     < t h   s t y l e = { {   t e x t A l i g n :   ' l e f t ' ,   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m i n W i d t h :   ' 1 2 0 p x '   } } > R a t i o < / t h >  
                                                     { l a s t 1 2 M o n t h s . m a p ( ( m ,   i )   = >   (  
                                                         < t h   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m i n W i d t h :   ' 6 0 p x '   } } >  
                                                             { m . m o n t h . s u b s t r i n g ( 0 ,   m . m o n t h . l a s t I n d e x O f ( ' / ' ) ) }  
                                                         < / t h >  
                                                     ) ) }  
                                                 < / t r >  
                                             < / t h e a d >  
                                             < t b o d y >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > D e b t / N e t   W o r t h < / t d >  
                                                     { l a s t 1 2 T r e n d s . m a p ( ( d a t a ,   i )   = >   (  
                                                         < t d   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             { d a t a ? . d e b t T o N W   ! = =   u n d e f i n e d   ?   d a t a . d e b t T o N W . t o F i x e d ( 1 )   :   ' N / A ' }  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > L e v e r a g e   R a t i o < / t d >  
                                                     { l a s t 1 2 T r e n d s . m a p ( ( d a t a ,   i )   = >   (  
                                                         < t d   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             { d a t a ? . l e v e r a g e   ! = =   u n d e f i n e d   ?   d a t a . l e v e r a g e . t o F i x e d ( 1 )   :   ' N / A ' }  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                             < / t b o d y >  
                                         < / t a b l e >  
                                     < / d i v >  
                                      
                                     { / *   O p e r a t i n g   R a t i o s   * / }  
                                     < h 3   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > O p e r a t i n g   R a t i o s < / h 3 >  
                                     < d i v   s t y l e = { {   o v e r f l o w X :   ' a u t o '   } } >  
                                         < t a b l e   s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   f o n t S i z e :   ' 1 2 p x ' ,   b o r d e r C o l l a p s e :   ' c o l l a p s e '   } } >  
                                             < t h e a d >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                     < t h   s t y l e = { {   t e x t A l i g n :   ' l e f t ' ,   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m i n W i d t h :   ' 1 2 0 p x '   } } > R a t i o < / t h >  
                                                     { l a s t 1 2 M o n t h s . m a p ( ( m ,   i )   = >   (  
                                                         < t h   k e y = { i }   s t y l e = { {   t e x t A l i g n :   ' r i g h t ' ,   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m i n W i d t h :   ' 6 0 p x '   } } >  
                                                             { m . m o n t h . s u b s t r i n g ( 0 ,   m . m o n t h . l a s t I n d e x O f ( ' / ' ) ) }  
                                                         < / t h >  
                                                     ) ) }  
                                                 < / t r >  
                                             < / t h e a d >  
                                             < t b o d y >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > R O E < / t d >  
                                                     { l a s t 1 2 T r e n d s . m a p ( ( d a t a ,   i )   = >   (  
                                                         < t d   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             { d a t a ? . r o e   ! = =   u n d e f i n e d   ?   ` $ { ( d a t a . r o e   *   1 0 0 ) . t o F i x e d ( 1 ) } % `   :   ' N / A ' }  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > R O A < / t d >  
                                                     { l a s t 1 2 T r e n d s . m a p ( ( d a t a ,   i )   = >   (  
                                                         < t d   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             { d a t a ? . r o a   ! = =   u n d e f i n e d   ?   ` $ { ( d a t a . r o a   *   1 0 0 ) . t o F i x e d ( 1 ) } % `   :   ' N / A ' }  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                                 < t r   s t y l e = { {   b o r d e r B o t t o m :   ' 1 p x   s o l i d   # f 1 f 5 f 9 '   } } >  
                                                     < t d   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > E B I T D A / R e v e n u e < / t d >  
                                                     { l a s t 1 2 T r e n d s . m a p ( ( d a t a ,   i )   = >   (  
                                                         < t d   k e y = { i }   s t y l e = { {   p a d d i n g :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' r i g h t '   } } >  
                                                             { d a t a ? . e b i t d a M a r g i n   ! = =   u n d e f i n e d   ?   ` $ { ( d a t a . e b i t d a M a r g i n   *   1 0 0 ) . t o F i x e d ( 1 ) } % `   :   ' N / A ' }  
                                                         < / t d >  
                                                     ) ) }  
                                                 < / t r >  
                                             < / t b o d y >  
                                         < / t a b l e >  
                                     < / d i v >  
                                 < / d i v >  
  
                                 { / *   S e c t i o n   4 :   C o m p a n y   D i s c l o s u r e s   * / }  
                                 < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                     < d i v   c l a s s N a m e = " p r i n t - p a g e - h e a d e r " >  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > { c o m p a n y ? . n a m e } < / d i v >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } > { n e w   D a t e ( ) . t o L o c a l e D a t e S t r i n g ( ' e n - U S ' ,   {   y e a r :   ' n u m e r i c ' ,   m o n t h :   ' l o n g ' ,   d a y :   ' n u m e r i c '   } ) } < / d i v >  
                                         < / d i v >  
                                     < / d i v >  
                                     < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 1 2 p x '   } } >  
                                         C o m p a n y   D i s c l o s u r e s  
                                     < / h 2 >  
                                      
                                     < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' 1 f r   2 0 0 p x ' ,   g a p :   ' 1 2 p x '   } } >  
                                         < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > D I S C L O S U R E < / d i v >  
                                         < d i v   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > S T A T U S < / d i v >  
                                          
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > B a n k r u p t c i e s < / d i v >  
                                         < i n p u t    
                                             t y p e = " t e x t "    
                                             v a l u e = { p r o f i l e . d i s c l o s u r e s . b a n k r u p t c i e s }    
                                             o n C h a n g e = { ( e )   = >   u p d a t e P r o f i l e ( {   d i s c l o s u r e s :   {   . . . p r o f i l e . d i s c l o s u r e s ,   b a n k r u p t c i e s :   e . t a r g e t . v a l u e   }   } ) }  
                                             s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 4 p x '   } }  
                                         / >  
                                          
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > L i e n s   o r   J u d g e m e n t s   ( b u s i n e s s ,   e q u i p m e n t ) < / d i v >  
                                         < i n p u t    
                                             t y p e = " t e x t "    
                                             v a l u e = { p r o f i l e . d i s c l o s u r e s . l i e n s }    
                                             o n C h a n g e = { ( e )   = >   u p d a t e P r o f i l e ( {   d i s c l o s u r e s :   {   . . . p r o f i l e . d i s c l o s u r e s ,   l i e n s :   e . t a r g e t . v a l u e   }   } ) }  
                                             s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 4 p x '   } }  
                                         / >  
                                          
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > M a t e r i a l   C o n t r a c t   C o v e n a n t s   ( e . g .   o n   l o a n s ) < / d i v >  
                                         < i n p u t    
                                             t y p e = " t e x t "    
                                             v a l u e = { p r o f i l e . d i s c l o s u r e s . c o n t r a c t s }    
                                             o n C h a n g e = { ( e )   = >   u p d a t e P r o f i l e ( {   d i s c l o s u r e s :   {   . . . p r o f i l e . d i s c l o s u r e s ,   c o n t r a c t s :   e . t a r g e t . v a l u e   }   } ) }  
                                             s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 4 p x '   } }  
                                         / >  
                                          
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > L a w s u i t s   ( a s   p l a i n t i f f   a / o   d e f e n d a n t ) < / d i v >  
                                         < i n p u t    
                                             t y p e = " t e x t "    
                                             v a l u e = { p r o f i l e . d i s c l o s u r e s . l a w s u i t s }    
                                             o n C h a n g e = { ( e )   = >   u p d a t e P r o f i l e ( {   d i s c l o s u r e s :   {   . . . p r o f i l e . d i s c l o s u r e s ,   l a w s u i t s :   e . t a r g e t . v a l u e   }   } ) }  
                                             s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 4 p x '   } }  
                                         / >  
                                          
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > M o s t   F a v o r e d   N a t i o n   o n   c o n t r a c t s < / d i v >  
                                         < i n p u t    
                                             t y p e = " t e x t "    
                                             v a l u e = { p r o f i l e . d i s c l o s u r e s . m o s t F a v o r e d N a t i o n }    
                                             o n C h a n g e = { ( e )   = >   u p d a t e P r o f i l e ( {   d i s c l o s u r e s :   {   . . . p r o f i l e . d i s c l o s u r e s ,   m o s t F a v o r e d N a t i o n :   e . t a r g e t . v a l u e   }   } ) }  
                                             s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 4 p x '   } }  
                                         / >  
                                          
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > E q u i t y   C o n t r o l   ( w h o / h o w   m a n y   n e e d e d ) < / d i v >  
                                         < i n p u t    
                                             t y p e = " t e x t "    
                                             v a l u e = { p r o f i l e . d i s c l o s u r e s . e q u i t y C o n t r o l }    
                                             o n C h a n g e = { ( e )   = >   u p d a t e P r o f i l e ( {   d i s c l o s u r e s :   {   . . . p r o f i l e . d i s c l o s u r e s ,   e q u i t y C o n t r o l :   e . t a r g e t . v a l u e   }   } ) }  
                                             s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 4 p x '   } }  
                                         / >  
                                          
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > R i g h t   o f   F i r s t   R e f u s a l   o n   s a l e < / d i v >  
                                         < i n p u t    
                                             t y p e = " t e x t "    
                                             v a l u e = { p r o f i l e . d i s c l o s u r e s . r i g h t O f F i r s t R e f u s a l }    
                                             o n C h a n g e = { ( e )   = >   u p d a t e P r o f i l e ( {   d i s c l o s u r e s :   {   . . . p r o f i l e . d i s c l o s u r e s ,   r i g h t O f F i r s t R e f u s a l :   e . t a r g e t . v a l u e   }   } ) }  
                                             s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 4 p x '   } }  
                                         / >  
                                          
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > S h a r e h o l d e r   P r o t e c t i o n s   ( i . e .   b l o c k i n g / a p p r o v a l s ) < / d i v >  
                                         < i n p u t    
                                             t y p e = " t e x t "    
                                             v a l u e = { p r o f i l e . d i s c l o s u r e s . s h a r e h o l d e r P r o t e c t i o n s }    
                                             o n C h a n g e = { ( e )   = >   u p d a t e P r o f i l e ( {   d i s c l o s u r e s :   {   . . . p r o f i l e . d i s c l o s u r e s ,   s h a r e h o l d e r P r o t e c t i o n s :   e . t a r g e t . v a l u e   }   } ) }  
                                             s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 4 p x '   } }  
                                         / >  
                                          
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > C h a n g e - i n - C o n t r o l   t r i g g e r s   ( i . e .   w i t h   c u s t o m e r s   a n d / o r   s u p p l i e r s ) < / d i v >  
                                         < i n p u t    
                                             t y p e = " t e x t "    
                                             v a l u e = { p r o f i l e . d i s c l o s u r e s . c h a n g e I n C o n t r o l }    
                                             o n C h a n g e = { ( e )   = >   u p d a t e P r o f i l e ( {   d i s c l o s u r e s :   {   . . . p r o f i l e . d i s c l o s u r e s ,   c h a n g e I n C o n t r o l :   e . t a r g e t . v a l u e   }   } ) }  
                                             s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 4 p x '   } }  
                                         / >  
                                          
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > R e g u l a t o r y   A p p r o v a l s   ( l o c a l / S t a t e / F e d e r a l ) < / d i v >  
                                         < i n p u t    
                                             t y p e = " t e x t "    
                                             v a l u e = { p r o f i l e . d i s c l o s u r e s . r e g u l a t o r y A p p r o v a l s }    
                                             o n C h a n g e = { ( e )   = >   u p d a t e P r o f i l e ( {   d i s c l o s u r e s :   {   . . . p r o f i l e . d i s c l o s u r e s ,   r e g u l a t o r y A p p r o v a l s :   e . t a r g e t . v a l u e   }   } ) }  
                                             s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 4 p x '   } }  
                                         / >  
                                          
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > A u d i t e d   F i n a n c i a l   S t a t e m e n t s < / d i v >  
                                         < s e l e c t  
                                             v a l u e = { p r o f i l e . d i s c l o s u r e s . a u d i t e d F i n a n c i a l s }  
                                             o n C h a n g e = { ( e )   = >   u p d a t e P r o f i l e ( {   d i s c l o s u r e s :   {   . . . p r o f i l e . d i s c l o s u r e s ,   a u d i t e d F i n a n c i a l s :   e . t a r g e t . v a l u e   }   } ) }  
                                             s t y l e = { {   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 4 p x '   } }  
                                         >  
                                             < o p t i o n   v a l u e = " Y e s " > Y e s < / o p t i o n >  
                                             < o p t i o n   v a l u e = " N o " > N o < / o p t i o n >  
                                             < o p t i o n   v a l u e = " P a r t i a l " > P a r t i a l < / o p t i o n >  
                                         < / s e l e c t >  
                                     < / d i v >  
                                 < / d i v >  
  
                                 < d i v   c l a s s N a m e = " n o - p r i n t "   s t y l e = { {   t e x t A l i g n :   ' c e n t e r ' ,   p a d d i n g :   ' 2 4 p x '   } } >  
                                     < b u t t o n  
                                         o n C l i c k = { a s y n c   ( )   = >   {  
                                             s e t I s L o a d i n g ( t r u e ) ;  
                                             t r y   {  
                                                 a w a i t   p r o f i l e s A p i . s a v e ( s e l e c t e d C o m p a n y I d ,   p r o f i l e ) ;  
                                                 a l e r t ( ' P r o f i l e   s a v e d   s u c c e s s f u l l y ! ' ) ;  
                                             }   c a t c h   ( e r r o r )   {  
                                                 a l e r t ( e r r o r   i n s t a n c e o f   A p i E r r o r   ?   e r r o r . m e s s a g e   :   ' F a i l e d   t o   s a v e   p r o f i l e ' ) ;  
                                             }   f i n a l l y   {  
                                                 s e t I s L o a d i n g ( f a l s e ) ;  
                                             }  
                                         } }  
                                         d i s a b l e d = { i s L o a d i n g }  
                                         s t y l e = { {    
                                             p a d d i n g :   ' 1 2 p x   3 2 p x ' ,    
                                             b a c k g r o u n d :   i s L o a d i n g   ?   ' # 9 4 a 3 b 8 '   :   ' # 6 6 7 e e a ' ,    
                                             c o l o r :   ' w h i t e ' ,    
                                             b o r d e r :   ' n o n e ' ,    
                                             b o r d e r R a d i u s :   ' 8 p x ' ,    
                                             f o n t S i z e :   ' 1 6 p x ' ,    
                                             f o n t W e i g h t :   ' 6 0 0 ' ,    
                                             c u r s o r :   i s L o a d i n g   ?   ' n o t - a l l o w e d '   :   ' p o i n t e r ' ,  
                                             b o x S h a d o w :   ' 0   4 p x   6 p x   r g b a ( 1 0 2 ,   1 2 6 ,   2 3 4 ,   0 . 3 ) ' ,  
                                             o p a c i t y :   i s L o a d i n g   ?   0 . 7   :   1  
                                         } }  
                                     >  
                                         { i s L o a d i n g   ?   ' S a v i n g . . . '   :   ' S a v e   P r o f i l e ' }  
                                     < / b u t t o n >  
                                 < / d i v >  
                             < / >  
                         ) ;  
                     } ) ( ) }  
                 < / d i v >  
             ) }  
  
             { / *   M a n a g e m e n t   A s s e s s m e n t   -   Q u e s t i o n n a i r e   V i e w   * / }  
             { ( ( )   = >   {  
                 c o n s t   h a s C o m p a n y I d   =   s e l e c t e d C o m p a n y I d   | |   c u r r e n t U s e r ? . c o m p a n y I d ;  
                 c o n s t   h a s C o r r e c t R o l e   =   ( c u r r e n t U s e r ? . r o l e   = = =   ' u s e r '   & &   c u r r e n t U s e r ? . u s e r T y p e   = = =   ' a s s e s s m e n t ' )   | |   c u r r e n t U s e r ? . r o l e   = = =   ' c o n s u l t a n t ' ;  
                 c o n s t   c a n V i e w   =   c u r r e n t V i e w   = = =   ' m a - q u e s t i o n n a i r e '   & &   h a s C o m p a n y I d   & &   h a s C o r r e c t R o l e ;  
                  
                 c o n s o l e . l o g ( '  x 9   Q u e s t i o n n a i r e   r e n d e r   c h e c k : ' ,   {  
                     c u r r e n t V i e w ,  
                     i s Q u e s t i o n n a i r e V i e w :   c u r r e n t V i e w   = = =   ' m a - q u e s t i o n n a i r e ' ,  
                     s e l e c t e d C o m p a n y I d ,  
                     u s e r C o m p a n y I d :   c u r r e n t U s e r ? . c o m p a n y I d ,  
                     h a s C o m p a n y I d ,  
                     r o l e :   c u r r e n t U s e r ? . r o l e ,  
                     u s e r T y p e :   c u r r e n t U s e r ? . u s e r T y p e ,  
                     h a s C o r r e c t R o l e ,  
                     c a n V i e w  
                 } ) ;  
                  
                 r e t u r n   c a n V i e w ;  
             } ) ( )   & &   (  
                 < d i v   s t y l e = { {   m a x W i d t h :   ' 1 2 0 0 p x ' ,   m a r g i n :   ' 0   a u t o ' ,   p a d d i n g :   ' 3 2 p x '   } } >  
                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                         < h 1   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n :   0   } } > M a n a g e m e n t   A s s e s s m e n t   Q u e s t i o n n a i r e < / h 1 >  
                         { c o m p a n y N a m e   & &   < d i v   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > { c o m p a n y N a m e } < / d i v > }  
                     < / d i v >  
                      
                     { c u r r e n t U s e r ? . r o l e   = = =   ' c o n s u l t a n t '   & &   (  
                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f f f b e b ' ,   b o r d e r :   ' 2 p x   s o l i d   # f b b f 2 4 ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                             < h 3   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 9 2 4 0 0 e ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  a   C o n s u l t a n t   V i e w   O n l y < / h 3 >  
                             < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 7 8 3 5 0 f ' ,   m a r g i n :   0   } } >  
                                 A s   a   c o n s u l t a n t ,   y o u   c a n   v i e w   t h i s   q u e s t i o n n a i r e   b u t   c a n n o t   f i l l   i t   o u t .   O n l y   c o m p a n y   u s e r s   c a n   c o m p l e t e   a s s e s s m e n t s .    
                                 N a v i g a t e   t o   " V i e w   A s s e s s m e n t s "   i n   t h e   A d m i n i s t r a t o r   D a s h b o a r d   t o   s e e   u s e r   r e s p o n s e s .  
                             < / p >  
                         < / d i v >  
                     ) }  
                      
                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) ' ,   o p a c i t y :   c u r r e n t U s e r ? . r o l e   = = =   ' c o n s u l t a n t '   ?   0 . 6   :   1 ,   p o i n t e r E v e n t s :   c u r r e n t U s e r ? . r o l e   = = =   ' c o n s u l t a n t '   ?   ' n o n e '   :   ' a u t o '   } } >  
                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 0 f 9 f f ' ,   b o r d e r :   ' 1 p x   s o l i d   # b a e 6 f d ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                             < h 3   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 0 c 4 a 6 e ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > R a t i n g   S c a l e < / h 3 >  
                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 0 c 4 a 6 e ' ,   l i n e H e i g h t :   ' 1 . 6 '   } } >  
                                 < s t r o n g > 1 : < / s t r o n g >   N o   e v i d e n c e   t o   s u p p o r t   p r a c t i c e s   o r   a n y   k n o w l e d g e   o f   s u b j e c t < b r   / >  
                                 < s t r o n g > 2 : < / s t r o n g >   L i m i t e d   p r a c t i c e s   i n   p l a c e ,   l i m i t e d   k n o w l e d g e   o f   s u b j e c t < b r   / >  
                                 < s t r o n g > 3 : < / s t r o n g >   B a s i c   p r a c t i c e s   i n   p l a c e ,   b a s i c   a w a r e n e s s   o f   s u b j e c t < b r   / >  
                                 < s t r o n g > 4 : < / s t r o n g >   C l e a r   p r a c t i c e s   i n   p l a c e ,   a b o v e   a v e r a g e   k n o w l e d g e   o f   s u b j e c t < b r   / >  
                                 < s t r o n g > 5 : < / s t r o n g >   E x t e n s i v e   p r a c t i c e s   i n   p l a c e ,   e x t e n s i v e   k n o w l e d g e   o f   s u b j e c t  
                             < / d i v >  
                         < / d i v >  
  
                         { a s s e s s m e n t D a t a . m a p ( ( c a t e g o r y )   = >   (  
                             < d i v   k e y = { c a t e g o r y . i d }   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                 < h 2   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # c b d 5 e 1 ' ,   p a d d i n g B o t t o m :   ' 8 p x '   } } >  
                                     { c a t e g o r y . i d } .   { c a t e g o r y . n a m e }  
                                 < / h 2 >  
                                  
                                 { c a t e g o r y . q u e s t i o n s . m a p ( ( q u e s t i o n )   = >   (  
                                     < d i v   k e y = { q u e s t i o n . i d }   s t y l e = { {   m a r g i n B o t t o m :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r :   u n a n s w e r e d Q u e s t i o n s . i n c l u d e s ( q u e s t i o n . i d )   ?   ' 2 p x   s o l i d   # e f 4 4 4 4 '   :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                         < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 5 0 0 '   } } >  
                                             { q u e s t i o n . t e x t }  
                                         < / l a b e l >  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 1 2 p x ' ,   f l e x W r a p :   ' w r a p '   } } >  
                                             { [ 1 ,   2 ,   3 ,   4 ,   5 ] . m a p ( ( r a t i n g )   = >   (  
                                                 < l a b e l   k e y = { r a t i n g }   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 6 p x ' ,   c u r s o r :   ' p o i n t e r ' ,   p a d d i n g :   ' 8 p x   1 2 p x ' ,   b a c k g r o u n d :   a s s e s s m e n t R e s p o n s e s [ q u e s t i o n . i d ]   = = =   r a t i n g   ?   ' # 6 6 7 e e a '   :   ' # f 1 f 5 f 9 ' ,   c o l o r :   a s s e s s m e n t R e s p o n s e s [ q u e s t i o n . i d ]   = = =   r a t i n g   ?   ' w h i t e '   :   ' # 4 7 5 5 6 9 ' ,   b o r d e r R a d i u s :   ' 6 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   b o r d e r :   a s s e s s m e n t R e s p o n s e s [ q u e s t i o n . i d ]   = = =   r a t i n g   ?   ' 2 p x   s o l i d   # 6 6 7 e e a '   :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   t r a n s i t i o n :   ' a l l   0 . 2 s '   } } >  
                                                     < i n p u t    
                                                         t y p e = " r a d i o "    
                                                         n a m e = { q u e s t i o n . i d }    
                                                         v a l u e = { r a t i n g }    
                                                         c h e c k e d = { a s s e s s m e n t R e s p o n s e s [ q u e s t i o n . i d ]   = = =   r a t i n g }  
                                                         o n C h a n g e = { ( )   = >   s e t A s s e s s m e n t R e s p o n s e s ( p r e v   = >   ( {   . . . p r e v ,   [ q u e s t i o n . i d ] :   r a t i n g   } ) ) }  
                                                         s t y l e = { {   d i s p l a y :   ' n o n e '   } }  
                                                     / >  
                                                     { r a t i n g }  
                                                 < / l a b e l >  
                                             ) ) }  
                                         < / d i v >  
                                         { u n a n s w e r e d Q u e s t i o n s . i n c l u d e s ( q u e s t i o n . i d )   & &   (  
                                             < d i v   s t y l e = { {   m a r g i n T o p :   ' 8 p x ' ,   f o n t S i z e :   ' 1 2 p x ' ,   c o l o r :   ' # e f 4 4 4 4 ' ,   f o n t W e i g h t :   ' 6 0 0 '   } } >  
                                                  a   P l e a s e   s e l e c t   a   r a t i n g  
                                             < / d i v >  
                                         ) }  
                                     < / d i v >  
                                 ) ) }  
                                  
                                 < d i v   s t y l e = { {   m a r g i n T o p :   ' 1 6 p x '   } } >  
                                     < l a b e l   s t y l e = { {   d i s p l a y :   ' b l o c k ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } >  
                                         N o t e s   f o r   { c a t e g o r y . n a m e } :  
                                     < / l a b e l >  
                                     < t e x t a r e a  
                                         v a l u e = { a s s e s s m e n t N o t e s [ c a t e g o r y . i d ]   | |   ' ' }  
                                         o n C h a n g e = { ( e )   = >   s e t A s s e s s m e n t N o t e s ( p r e v   = >   ( {   . . . p r e v ,   [ c a t e g o r y . i d ] :   e . t a r g e t . v a l u e   } ) ) }  
                                         s t y l e = { {   w i d t h :   ' 1 0 0 % ' ,   m i n H e i g h t :   ' 8 0 p x ' ,   p a d d i n g :   ' 1 2 p x ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t F a m i l y :   ' i n h e r i t ' ,   r e s i z e :   ' v e r t i c a l '   } }  
                                         p l a c e h o l d e r = " A d d   n o t e s   o r   a c t i o n   i t e m s . . . "  
                                     / >  
                                 < / d i v >  
                             < / d i v >  
                         ) ) }  
  
                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 1 2 p x ' ,   j u s t i f y C o n t e n t :   ' c e n t e r ' ,   m a r g i n T o p :   ' 3 2 p x '   } } >  
                             < b u t t o n    
                                 o n C l i c k = { a s y n c   ( )   = >   {  
                                     c o n s t   a l l Q u e s t i o n s   =   a s s e s s m e n t D a t a . f l a t M a p ( c a t   = >   c a t . q u e s t i o n s . m a p ( q   = >   q . i d ) ) ;  
                                     c o n s t   u n a n s w e r e d   =   a l l Q u e s t i o n s . f i l t e r ( q I d   = >   ! a s s e s s m e n t R e s p o n s e s [ q I d ] ) ;  
                                     s e t U n a n s w e r e d Q u e s t i o n s ( u n a n s w e r e d ) ;  
                                      
                                     i f   ( u n a n s w e r e d . l e n g t h   = = =   0 )   {  
                                         s e t I s L o a d i n g ( t r u e ) ;  
                                         t r y   {  
                                             c o n s t   t o t a l S c o r e   =   O b j e c t . v a l u e s ( a s s e s s m e n t R e s p o n s e s ) . r e d u c e ( ( s u m ,   v a l )   = >   s u m   +   v a l ,   0 )   /   O b j e c t . k e y s ( a s s e s s m e n t R e s p o n s e s ) . l e n g t h ;  
                                              
                                             c o n s t   {   r e c o r d   }   =   a w a i t   a s s e s s m e n t s A p i . c r e a t e ( {  
                                                 u s e r I d :   c u r r e n t U s e r ! . i d ,  
                                                 c o m p a n y I d :   s e l e c t e d C o m p a n y I d ,  
                                                 r e s p o n s e s :   a s s e s s m e n t R e s p o n s e s ,  
                                                 n o t e s :   a s s e s s m e n t N o t e s ,  
                                                 o v e r a l l S c o r e :   t o t a l S c o r e ,  
                                                 i s C o m p l e t e d :   t r u e  
                                             } ) ;  
                                              
                                             / /   A d d   t o   l o c a l   s t a t e   w i t h   p r o p e r   s t r u c t u r e  
                                             c o n s t   a s s e s s m e n t R e c o r d :   A s s e s s m e n t R e c o r d   =   {  
                                                 i d :   r e c o r d . i d ,  
                                                 u s e r E m a i l :   c u r r e n t U s e r ? . e m a i l   | |   ' ' ,  
                                                 u s e r N a m e :   c u r r e n t U s e r ? . n a m e   | |   ' ' ,  
                                                 c o m p a n y I d :   s e l e c t e d C o m p a n y I d ,  
                                                 c o m p a n y N a m e :   c o m p a n y ? . n a m e   | |   ' ' ,  
                                                 r e s p o n s e s :   a s s e s s m e n t R e s p o n s e s ,  
                                                 n o t e s :   a s s e s s m e n t N o t e s ,  
                                                 c o m p l e t e d D a t e :   r e c o r d . c o m p l e t e d A t ,  
                                                 o v e r a l l S c o r e :   t o t a l S c o r e  
                                             } ;  
                                              
                                             s e t A s s e s s m e n t R e c o r d s ( p r e v   = >   [ . . . p r e v ,   a s s e s s m e n t R e c o r d ] ) ;  
                                             a l e r t ( ' A s s e s s m e n t   s a v e d   s u c c e s s f u l l y ! ' ) ;  
                                             s e t C u r r e n t V i e w ( ' m a - y o u r - r e s u l t s ' ) ;  
                                         }   c a t c h   ( e r r o r )   {  
                                             a l e r t ( e r r o r   i n s t a n c e o f   A p i E r r o r   ?   e r r o r . m e s s a g e   :   ' F a i l e d   t o   s a v e   a s s e s s m e n t ' ) ;  
                                         }   f i n a l l y   {  
                                             s e t I s L o a d i n g ( f a l s e ) ;  
                                         }  
                                     }   e l s e   {  
                                         a l e r t ( ` P l e a s e   a n s w e r   a l l   $ { u n a n s w e r e d . l e n g t h }   u n a n s w e r e d   q u e s t i o n ( s )   b e f o r e   s a v i n g . ` ) ;  
                                     }  
                                 } }  
                                 d i s a b l e d = { i s L o a d i n g }  
                                 s t y l e = { {   p a d d i n g :   ' 1 4 p x   3 2 p x ' ,   b a c k g r o u n d :   i s L o a d i n g   ?   ' # 9 4 a 3 b 8 '   :   ' # 6 6 7 e e a ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   i s L o a d i n g   ?   ' n o t - a l l o w e d '   :   ' p o i n t e r ' ,   b o x S h a d o w :   ' 0   4 p x   1 2 p x   r g b a ( 1 0 2 , 1 2 6 , 2 3 4 , 0 . 3 ) ' ,   o p a c i t y :   i s L o a d i n g   ?   0 . 7   :   1   } }  
                             >  
                                 { i s L o a d i n g   ?   ' S a v i n g . . . '   :   ' S a v e   A s s e s s m e n t ' }  
                             < / b u t t o n >  
                             < b u t t o n    
                                 o n C l i c k = { ( )   = >   {  
                                     i f   ( c o n f i r m ( ' A r e   y o u   s u r e   y o u   w a n t   t o   r e s e t   a l l   r e s p o n s e s ? ' ) )   {  
                                         s e t A s s e s s m e n t R e s p o n s e s ( { } ) ;  
                                         s e t A s s e s s m e n t N o t e s ( { } ) ;  
                                         s e t U n a n s w e r e d Q u e s t i o n s ( [ ] ) ;  
                                     }  
                                 } }  
                                 s t y l e = { {   p a d d i n g :   ' 1 4 p x   3 2 p x ' ,   b a c k g r o u n d :   ' # f 1 f 5 f 9 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } }  
                             >  
                                 R e s e t  
                             < / b u t t o n >  
                         < / d i v >  
                     < / d i v >  
                 < / d i v >  
             ) }  
  
             { / *   M a n a g e m e n t   A s s e s s m e n t   -   Y o u r   R e s u l t s   V i e w   * / }  
             { c u r r e n t V i e w   = = =   ' m a - y o u r - r e s u l t s '   & &   s e l e c t e d C o m p a n y I d   & &   ( ( c u r r e n t U s e r ? . r o l e   = = =   ' u s e r '   & &   c u r r e n t U s e r ? . u s e r T y p e   = = =   ' a s s e s s m e n t ' )   | |   c u r r e n t U s e r ? . r o l e   = = =   ' c o n s u l t a n t ' )   & &   (  
                 < d i v   s t y l e = { {   m a x W i d t h :   ' 1 4 0 0 p x ' ,   m a r g i n :   ' 0   a u t o ' ,   p a d d i n g :   ' 3 2 p x '   } } >  
                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                         < h 1   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n :   0   } } >  
                             { c u r r e n t U s e r ? . r o l e   = = =   ' c o n s u l t a n t '   ?   ' A s s e s s m e n t   R e s u l t s   -   A l l   P a r t i c i p a n t s '   :   ' Y o u r   A s s e s s m e n t   R e s u l t s ' }  
                         < / h 1 >  
                         { c o m p a n y N a m e   & &   < d i v   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > { c o m p a n y N a m e } < / d i v > }  
                     < / d i v >  
                      
                     { c u r r e n t U s e r ? . r o l e   = = =   ' c o n s u l t a n t '   ?   (  
                         / /   S h o w   a l l   p a r t i c i p a n t s '   r e s u l t s   f o r   c o n s u l t a n t s  
                         < >  
                             { a s s e s s m e n t R e c o r d s . f i l t e r ( r   = >   r . c o m p a n y I d   = = =   s e l e c t e d C o m p a n y I d ) . l e n g t h   = = =   0   ?   (  
                                 < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 6 0 p x ' ,   t e x t A l i g n :   ' c e n t e r ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 4 8 p x ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  x 9 < / d i v >  
                                     < h 3   s t y l e = { {   f o n t S i z e :   ' 2 0 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > N o   A s s e s s m e n t s   Y e t < / h 3 >  
                                     < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 9 4 a 3 b 8 '   } } > N o   u s e r s   h a v e   c o m p l e t e d   a s s e s s m e n t s   f o r   t h i s   c o m p a n y < / p >  
                                 < / d i v >  
                             )   :   (  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g a p :   ' 2 4 p x '   } } >  
                                     { a s s e s s m e n t R e c o r d s . f i l t e r ( r   = >   r . c o m p a n y I d   = = =   s e l e c t e d C o m p a n y I d ) . m a p ( ( r e c o r d )   = >   (  
                                         < d i v   k e y = { r e c o r d . i d }   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   m a r g i n B o t t o m :   ' 2 0 p x ' ,   b o r d e r B o t t o m :   ' 2 p x   s o l i d   # e 2 e 8 f 0 ' ,   p a d d i n g B o t t o m :   ' 1 6 p x '   } } >  
                                                 < d i v >  
                                                     < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 4 p x '   } } > { r e c o r d . u s e r ? . n a m e   | |   r e c o r d . u s e r N a m e   | |   ' U n k n o w n   U s e r ' } < / h 2 >  
                                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b '   } } >  
                                                         C o m p l e t e d :   { n e w   D a t e ( r e c o r d . c o m p l e t e d A t   | |   r e c o r d . c o m p l e t e d D a t e   | |   ' ' ) . t o L o c a l e D a t e S t r i n g ( ) }   |    
                                                         < s p a n   s t y l e = { {   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 6 7 e e a ' ,   m a r g i n L e f t :   ' 8 p x '   } } > O v e r a l l   S c o r e :   { r e c o r d . o v e r a l l S c o r e . t o F i x e d ( 2 ) } / 5 . 0 < / s p a n >  
                                                     < / d i v >  
                                                 < / d i v >  
                                             < / d i v >  
                                              
                                             < h 3   s t y l e = { {   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } > S c o r e s   b y   C a t e g o r y < / h 3 >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( a u t o - f i t ,   m i n m a x ( 1 8 0 p x ,   1 f r ) ) ' ,   g a p :   ' 1 2 p x '   } } >  
                                                 { a s s e s s m e n t D a t a . m a p ( ( c a t e g o r y )   = >   {  
                                                     c o n s t   c a t e g o r y Q u e s t i o n s   =   c a t e g o r y . q u e s t i o n s . m a p ( q   = >   q . i d ) ;  
                                                     c o n s t   c a t e g o r y R e s p o n s e s   =   c a t e g o r y Q u e s t i o n s . m a p ( q I d   = >   r e c o r d . r e s p o n s e s [ q I d ] ) . f i l t e r ( r   = >   r   ! = =   u n d e f i n e d ) ;  
                                                     c o n s t   a v g S c o r e   =   c a t e g o r y R e s p o n s e s . l e n g t h   >   0   ?   c a t e g o r y R e s p o n s e s . r e d u c e ( ( s u m ,   v a l )   = >   s u m   +   v a l ,   0 )   /   c a t e g o r y R e s p o n s e s . l e n g t h   :   0 ;  
                                                      
                                                     r e t u r n   (  
                                                         < d i v   k e y = { c a t e g o r y . i d }   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 2 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 6 p x '   } } > { c a t e g o r y . n a m e } < / d i v >  
                                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 6 6 7 e e a '   } } > { a v g S c o r e . t o F i x e d ( 2 ) } < / d i v >  
                                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 0 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n T o p :   ' 2 p x '   } } > o u t   o f   5 . 0 < / d i v >  
                                                         < / d i v >  
                                                     ) ;  
                                                 } ) }  
                                             < / d i v >  
                                         < / d i v >  
                                     ) ) }  
                                 < / d i v >  
                             ) }  
                         < / >  
                     )   :   (  
                         / /   S h o w   i n d i v i d u a l   r e s u l t s   f o r   u s e r s  
                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                             < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > S c o r e   b y   C a t e g o r y < / h 2 >  
                              
                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( a u t o - f i t ,   m i n m a x ( 2 0 0 p x ,   1 f r ) ) ' ,   g a p :   ' 1 6 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                 { a s s e s s m e n t D a t a . m a p ( ( c a t e g o r y )   = >   {  
                                     c o n s t   c a t e g o r y Q u e s t i o n s   =   c a t e g o r y . q u e s t i o n s . m a p ( q   = >   q . i d ) ;  
                                     c o n s t   c a t e g o r y R e s p o n s e s   =   c a t e g o r y Q u e s t i o n s . m a p ( q I d   = >   a s s e s s m e n t R e s p o n s e s [ q I d ] ) . f i l t e r ( r   = >   r   ! = =   u n d e f i n e d ) ;  
                                     c o n s t   a v g S c o r e   =   c a t e g o r y R e s p o n s e s . l e n g t h   >   0   ?   c a t e g o r y R e s p o n s e s . r e d u c e ( ( s u m ,   v a l )   = >   s u m   +   v a l ,   0 )   /   c a t e g o r y R e s p o n s e s . l e n g t h   :   0 ;  
                                      
                                     r e t u r n   (  
                                         < d i v   k e y = { c a t e g o r y . i d }   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > { c a t e g o r y . n a m e } < / d i v >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 6 6 7 e e a '   } } > { a v g S c o r e . t o F i x e d ( 2 ) } < / d i v >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n T o p :   ' 4 p x '   } } > o u t   o f   5 . 0 < / d i v >  
                                         < / d i v >  
                                     ) ;  
                                 } ) }  
                             < / d i v >  
  
                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 1 2 p x ' ,   j u s t i f y C o n t e n t :   ' c e n t e r '   } } >  
                                 < b u t t o n    
                                     o n C l i c k = { ( )   = >   s e t C u r r e n t V i e w ( ' m a - q u e s t i o n n a i r e ' ) }  
                                     s t y l e = { {   p a d d i n g :   ' 1 2 p x   2 4 p x ' ,   b a c k g r o u n d :   ' # 6 6 7 e e a ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } }  
                                 >  
                                     E d i t   A s s e s s m e n t  
                                 < / b u t t o n >  
                             < / d i v >  
                         < / d i v >  
                     ) }  
                 < / d i v >  
             ) }  
                     < / >  
                     ) }  
  
                     { / *   M a n a g e m e n t   A s s e s s m e n t   V i e w s   -   A v a i l a b l e   t o   a l l   u s e r s   i n c l u d i n g   a s s e s s m e n t   u s e r s   * / }  
                     { / *   M a n a g e m e n t   A s s e s s m e n t   -   W e l c o m e   V i e w   * / }  
             { c u r r e n t V i e w   = = =   ' m a - w e l c o m e '   & &   ( ( c u r r e n t U s e r ? . r o l e   = = =   ' u s e r '   & &   c u r r e n t U s e r ? . u s e r T y p e   = = =   ' a s s e s s m e n t ' )   | |   c u r r e n t U s e r ? . r o l e   = = =   ' c o n s u l t a n t ' )   & &   (  
                 < d i v   s t y l e = { {   m a x W i d t h :   ' 1 2 0 0 p x ' ,   m a r g i n :   ' 0   a u t o ' ,   p a d d i n g :   ' 3 2 p x '   } } >  
                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 4 0 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                         { c o m p a n y N a m e   & &   < d i v   s t y l e = { {   f o n t S i z e :   ' 3 6 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   t e x t A l i g n :   ' c e n t e r ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > { c o m p a n y N a m e } < / d i v > }  
                         < h 1   s t y l e = { {   f o n t S i z e :   ' 3 6 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   t e x t A l i g n :   ' c e n t e r '   } } > M a n a g e m e n t   A s s e s s m e n t   Q u e s t i o n n a i r e < / h 1 >  
                          
                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 ' ,   l i n e H e i g h t :   ' 1 . 8 ' ,   m a x W i d t h :   ' 9 0 0 p x ' ,   m a r g i n :   ' 0   a u t o   3 2 p x ' ,   t e x t A l i g n :   ' l e f t '   } } >  
                             < p   s t y l e = { {   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                 O u r   T r a d e m a r k e d   a s s e s s m e n t   t o o l   i s   d e s i g n e d   t o   f a c i l i t a t e   t h e   d i s c o v e r y   o f   M a n a g e m e n t   M a t u r i t y   L e v e l   i n   s m a l l   b u s i n e s s e s .   I t   h a s   b e e n   d e v e l o p e d   t o   h i g h l i g h t   a r e a s   u n d e r   f i n a n c i a l   m a n a g e m e n t   t h a t   c a n   b e   t a r g e t e d   f o r   i m p r o v e m e n t .  
                             < / p >  
                              
                             < p   s t y l e = { {   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                 T h e   t o o l   i s   a   q u e s t i o n n a i r e   t o   b e   c o m p l e t e d   b y   t h e   k e y   e m p l o y e e s   i n   y o u r   c o m p a n y .   I t   i s   d e s i g n e d   a s   a   t o o l   f o r   m a n a g e m e n t   t o   h e l p   y o u   b e t t e r   u n d e r s t a n d   t h e   s t r e n g t h s   a n d   w e a k n e s s e s   o f   y o u r   p r o c e s s e s   a n d   c o m m u n i c a t i o n s   a c r o s s   t e a m s   i n   y o u r   c o m p a n y .  
                             < / p >  
                              
                             < p   s t y l e = { {   m a r g i n B o t t o m :   ' 0 '   } } >  
                                 T h e   M a n a g e m e n t   A s s e s s m e n t   s e r v i c e   p r o v i d e s   d e t a i l e d   e v a l u a t i o n   o f   y o u r   c o m p a n y ' s   m a n a g e m e n t   p r a c t i c e s ,   l e a d e r s h i p   e f f e c t i v e n e s s ,   a n d   o r g a n i z a t i o n a l   s t r u c t u r e   t o   h e l p   y o u   o p t i m i z e   p e r f o r m a n c e   a n d   d r i v e   g r o w t h .  
                             < / p >  
                         < / d i v >  
                          
                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   m a r g i n T o p :   ' 3 2 p x ' ,   t e x t A l i g n :   ' l e f t '   } } >  
                             < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 2 0 p x '   } } > T o p i c s   C o v e r e d < / h 2 >  
                             < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( 2 ,   1 f r ) ' ,   g a p :   ' 1 2 p x ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } >  
                                 { a s s e s s m e n t D a t a . m a p ( ( c a t )   = >   (  
                                     < d i v   k e y = { c a t . i d }   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   g a p :   ' 8 p x '   } } >  
                                         < s p a n   s t y l e = { {   c o l o r :   ' # 1 0 b 9 8 1 ' ,   f o n t S i z e :   ' 1 8 p x '   } } >  S < / s p a n >  
                                         < s p a n > { c a t . n a m e } < / s p a n >  
                                     < / d i v >  
                                 ) ) }  
                             < / d i v >  
                         < / d i v >  
  
                         < b u t t o n    
                             o n C l i c k = { ( )   = >   s e t C u r r e n t V i e w ( ' m a - q u e s t i o n n a i r e ' ) }  
                             s t y l e = { {   m a r g i n T o p :   ' 3 2 p x ' ,   p a d d i n g :   ' 1 6 p x   4 8 p x ' ,   b a c k g r o u n d :   ' # 6 6 7 e e a ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   f o n t S i z e :   ' 1 8 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r ' ,   b o x S h a d o w :   ' 0   4 p x   1 2 p x   r g b a ( 1 0 2 , 1 2 6 , 2 3 4 , 0 . 3 ) '   } }  
                         >  
                             S t a r t   A s s e s s m e n t  
                         < / b u t t o n >  
                     < / d i v >  
                 < / d i v >  
             ) }  
  
             { / *   M a n a g e m e n t   A s s e s s m e n t   -   S c o r e s   S u m m a r y   V i e w   * / }  
             { c u r r e n t V i e w   = = =   ' m a - s c o r e s - s u m m a r y '   & &   s e l e c t e d C o m p a n y I d   & &   ( ( c u r r e n t U s e r ? . r o l e   = = =   ' u s e r '   & &   c u r r e n t U s e r ? . u s e r T y p e   = = =   ' a s s e s s m e n t ' )   | |   c u r r e n t U s e r ? . r o l e   = = =   ' c o n s u l t a n t ' )   & &   (  
                 < d i v   s t y l e = { {   m a x W i d t h :   ' 1 2 0 0 p x ' ,   m a r g i n :   ' 0   a u t o ' ,   p a d d i n g :   ' 3 2 p x '   } } >  
                     < h 1   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 3 2 p x '   } } > S c o r e s   S u m m a r y   -   A l l   P a r t i c i p a n t s < / h 1 >  
                      
                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                         < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > A v e r a g e   S c o r e s   A c r o s s   A l l   P a r t i c i p a n t s < / h 2 >  
                          
                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g r i d T e m p l a t e C o l u m n s :   ' r e p e a t ( a u t o - f i t ,   m i n m a x ( 2 0 0 p x ,   1 f r ) ) ' ,   g a p :   ' 1 6 p x '   } } >  
                             { a s s e s s m e n t D a t a . m a p ( ( c a t e g o r y )   = >   {  
                                 c o n s t   c o m p a n y R e c o r d s   =   a s s e s s m e n t R e c o r d s . f i l t e r ( r   = >   r . c o m p a n y I d   = = =   s e l e c t e d C o m p a n y I d ) ;  
                                 c o n s t   a l l C a t e g o r y S c o r e s   =   c o m p a n y R e c o r d s . m a p ( r e c o r d   = >   {  
                                     c o n s t   c a t e g o r y Q u e s t i o n s   =   c a t e g o r y . q u e s t i o n s . m a p ( q   = >   q . i d ) ;  
                                     c o n s t   c a t e g o r y R e s p o n s e s   =   c a t e g o r y Q u e s t i o n s . m a p ( q I d   = >   r e c o r d . r e s p o n s e s [ q I d ] ) . f i l t e r ( r   = >   r   ! = =   u n d e f i n e d ) ;  
                                     r e t u r n   c a t e g o r y R e s p o n s e s . l e n g t h   >   0   ?   c a t e g o r y R e s p o n s e s . r e d u c e ( ( s u m ,   v a l )   = >   s u m   +   v a l ,   0 )   /   c a t e g o r y R e s p o n s e s . l e n g t h   :   0 ;  
                                 } ) . f i l t e r ( s   = >   s   >   0 ) ;  
                                  
                                 c o n s t   a v g S c o r e   =   a l l C a t e g o r y S c o r e s . l e n g t h   >   0   ?   a l l C a t e g o r y S c o r e s . r e d u c e ( ( s u m ,   v a l )   = >   s u m   +   v a l ,   0 )   /   a l l C a t e g o r y S c o r e s . l e n g t h   :   0 ;  
                                  
                                 r e t u r n   (  
                                     < d i v   k e y = { c a t e g o r y . i d }   s t y l e = { {   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > { c a t e g o r y . n a m e } < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 6 6 7 e e a '   } } > { a v g S c o r e . t o F i x e d ( 2 ) } < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 1 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n T o p :   ' 4 p x '   } } > a v g   a c r o s s   { a l l C a t e g o r y S c o r e s . l e n g t h }   p a r t i c i p a n t ( s ) < / d i v >  
                                     < / d i v >  
                                 ) ;  
                             } ) }  
                         < / d i v >  
                     < / d i v >  
                 < / d i v >  
             ) }  
  
             { / *   M a n a g e m e n t   A s s e s s m e n t   -   S c o r i n g   G u i d e   V i e w   * / }  
             { c u r r e n t V i e w   = = =   ' m a - s c o r i n g - g u i d e '   & &   ( ( c u r r e n t U s e r ? . r o l e   = = =   ' u s e r '   & &   c u r r e n t U s e r ? . u s e r T y p e   = = =   ' a s s e s s m e n t ' )   | |   c u r r e n t U s e r ? . r o l e   = = =   ' c o n s u l t a n t ' )   & &   (  
                 < d i v   s t y l e = { {   m a x W i d t h :   ' 1 2 0 0 p x ' ,   m a r g i n :   ' 0   a u t o ' ,   p a d d i n g :   ' 3 2 p x '   } } >  
                     < h 1   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 3 2 p x '   } } > S c o r i n g   G u i d e < / h 1 >  
                      
                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 3 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                         < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > R a t i n g   S c a l e   D e s c r i p t i o n s < / h 2 >  
                          
                         < d i v   s t y l e = { {   d i s p l a y :   ' g r i d ' ,   g a p :   ' 1 6 p x '   } } >  
                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f e e 2 e 2 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b o r d e r :   ' 2 p x   s o l i d   # e f 4 4 4 4 '   } } >  
                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 9 9 1 b 1 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > 1   -   N o   E v i d e n c e < / d i v >  
                                 < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 7 f 1 d 1 d ' ,   m a r g i n :   0   } } > N o   e v i d e n c e   t o   s u p p o r t   p r a c t i c e s   o r   a n y   k n o w l e d g e   o f   s u b j e c t < / p >  
                             < / d i v >  
                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f e d 7 a a ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b o r d e r :   ' 2 p x   s o l i d   # f 9 7 3 1 6 '   } } >  
                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 9 a 3 4 1 2 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > 2   -   L i m i t e d < / d i v >  
                                 < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 7 c 2 d 1 2 ' ,   m a r g i n :   0   } } > L i m i t e d   p r a c t i c e s   i n   p l a c e ,   l i m i t e d   k n o w l e d g e   o f   s u b j e c t < / p >  
                             < / d i v >  
                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' # f e f 3 c 7 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b o r d e r :   ' 2 p x   s o l i d   # f 5 9 e 0 b '   } } >  
                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 9 2 4 0 0 e ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > 3   -   B a s i c < / d i v >  
                                 < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 7 8 3 5 0 f ' ,   m a r g i n :   0   } } > B a s i c   p r a c t i c e s   i n   p l a c e ,   b a s i c   a w a r e n e s s   o f   s u b j e c t < / p >  
                             < / d i v >  
                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' # d b e a f e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b o r d e r :   ' 2 p x   s o l i d   # 3 b 8 2 f 6 '   } } >  
                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 4 0 a f ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > 4   -   C l e a r   P r a c t i c e s < / d i v >  
                                 < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 3 a 8 a ' ,   m a r g i n :   0   } } > C l e a r   p r a c t i c e s   i n   p l a c e ,   a b o v e   a v e r a g e   k n o w l e d g e   o f   s u b j e c t < / p >  
                             < / d i v >  
                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' # d 1 f a e 5 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   p a d d i n g :   ' 2 0 p x ' ,   b o r d e r :   ' 2 p x   s o l i d   # 1 0 b 9 8 1 '   } } >  
                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 0 6 5 f 4 6 ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > 5   -   E x t e n s i v e < / d i v >  
                                 < p   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 0 6 4 e 3 b ' ,   m a r g i n :   0   } } > E x t e n s i v e   p r a c t i c e s   i n   p l a c e ,   e x t e n s i v e   k n o w l e d g e   o f   s u b j e c t < / p >  
                             < / d i v >  
                         < / d i v >  
                     < / d i v >  
                 < / d i v >  
             ) }  
  
             { / *   M a n a g e m e n t   A s s e s s m e n t   -   C h a r t s   V i e w   * / }  
             { c u r r e n t V i e w   = = =   ' m a - c h a r t s '   & &   s e l e c t e d C o m p a n y I d   & &   ( ( c u r r e n t U s e r ? . r o l e   = = =   ' u s e r '   & &   c u r r e n t U s e r ? . u s e r T y p e   = = =   ' a s s e s s m e n t ' )   | |   c u r r e n t U s e r ? . r o l e   = = =   ' c o n s u l t a n t ' )   & &   (  
                 < d i v   s t y l e = { {   m a x W i d t h :   ' 1 2 0 0 p x ' ,   m a r g i n :   ' 0   a u t o ' ,   p a d d i n g :   ' 3 2 p x '   } } >  
                     < h 1   s t y l e = { {   f o n t S i z e :   ' 3 2 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 3 2 p x '   } } > A s s e s s m e n t   C h a r t s < / h 1 >  
                      
                     { ( c u r r e n t U s e r ? . r o l e   = = =   ' c o n s u l t a n t '   ?   a s s e s s m e n t R e c o r d s . f i l t e r ( r   = >   r . c o m p a n y I d   = = =   s e l e c t e d C o m p a n y I d ) . l e n g t h   = = =   0   :   O b j e c t . k e y s ( a s s e s s m e n t R e s p o n s e s ) . l e n g t h   = = =   0 )   ?   (  
                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 4 0 p x ' ,   t e x t A l i g n :   ' c e n t e r ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                             < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } > N o   A s s e s s m e n t   D a t a < / h 2 >  
                             < p   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 9 4 a 3 b 8 ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                 { c u r r e n t U s e r ? . r o l e   = = =   ' c o n s u l t a n t '   ?   ' N o   u s e r s   h a v e   c o m p l e t e d   a s s e s s m e n t s   f o r   t h i s   c o m p a n y   y e t . '   :   ' P l e a s e   c o m p l e t e   t h e   q u e s t i o n n a i r e   f i r s t   t o   v i e w   c h a r t s . ' }  
                             < / p >  
                             { c u r r e n t U s e r ? . r o l e   ! = =   ' c o n s u l t a n t '   & &   (  
                                 < b u t t o n    
                                     o n C l i c k = { ( )   = >   s e t C u r r e n t V i e w ( ' m a - q u e s t i o n n a i r e ' ) }  
                                     s t y l e = { {   p a d d i n g :   ' 1 2 p x   3 2 p x ' ,   b a c k g r o u n d :   ' # 6 6 7 e e a ' ,   c o l o r :   ' w h i t e ' ,   b o r d e r :   ' n o n e ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c u r s o r :   ' p o i n t e r '   } }  
                                 >  
                                     G o   t o   Q u e s t i o n n a i r e  
                                 < / b u t t o n >  
                             ) }  
                         < / d i v >  
                     )   :   (  
                         < >  
                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   m a r g i n B o t t o m :   ' 1 2 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                                 < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                     { c u r r e n t U s e r ? . r o l e   = = =   ' c o n s u l t a n t '   ?   ' A v e r a g e   C a t e g o r y   S c o r e s   -   A l l   P a r t i c i p a n t s '   :   ' C a t e g o r y   S c o r e s   -   B a r   C h a r t ' }  
                                 < / h 2 >  
                                  
                                 < d i v   s t y l e = { {   p a d d i n g :   ' 2 0 p x '   } } >  
                             { a s s e s s m e n t D a t a . m a p ( ( c a t e g o r y )   = >   {  
                                 c o n s t   c a t e g o r y Q u e s t i o n s   =   c a t e g o r y . q u e s t i o n s . m a p ( q   = >   q . i d ) ;  
                                  
                                 l e t   a v g S c o r e   =   0 ;  
                                 i f   ( c u r r e n t U s e r ? . r o l e   = = =   ' c o n s u l t a n t ' )   {  
                                     / /   C a l c u l a t e   a v e r a g e   a c r o s s   a l l   a s s e s s m e n t   r e c o r d s   f o r   t h i s   c o m p a n y  
                                     c o n s t   c o m p a n y R e c o r d s   =   a s s e s s m e n t R e c o r d s . f i l t e r ( r   = >   r . c o m p a n y I d   = = =   s e l e c t e d C o m p a n y I d ) ;  
                                     c o n s t   a l l C a t e g o r y S c o r e s   =   c o m p a n y R e c o r d s . m a p ( r e c o r d   = >   {  
                                         c o n s t   c a t e g o r y R e s p o n s e s   =   c a t e g o r y Q u e s t i o n s . m a p ( q I d   = >   r e c o r d . r e s p o n s e s [ q I d ] ) . f i l t e r ( r   = >   r   ! = =   u n d e f i n e d ) ;  
                                         r e t u r n   c a t e g o r y R e s p o n s e s . l e n g t h   >   0   ?   c a t e g o r y R e s p o n s e s . r e d u c e ( ( s u m ,   v a l )   = >   s u m   +   v a l ,   0 )   /   c a t e g o r y R e s p o n s e s . l e n g t h   :   0 ;  
                                     } ) . f i l t e r ( s   = >   s   >   0 ) ;  
                                     a v g S c o r e   =   a l l C a t e g o r y S c o r e s . l e n g t h   >   0   ?   a l l C a t e g o r y S c o r e s . r e d u c e ( ( s u m ,   v a l )   = >   s u m   +   v a l ,   0 )   /   a l l C a t e g o r y S c o r e s . l e n g t h   :   0 ;  
                                 }   e l s e   {  
                                     / /   U s e   c u r r e n t   u s e r ' s   r e s p o n s e s  
                                     c o n s t   c a t e g o r y R e s p o n s e s   =   c a t e g o r y Q u e s t i o n s . m a p ( q I d   = >   a s s e s s m e n t R e s p o n s e s [ q I d ] ) . f i l t e r ( r   = >   r   ! = =   u n d e f i n e d ) ;  
                                     a v g S c o r e   =   c a t e g o r y R e s p o n s e s . l e n g t h   >   0   ?   c a t e g o r y R e s p o n s e s . r e d u c e ( ( s u m ,   v a l )   = >   s u m   +   v a l ,   0 )   /   c a t e g o r y R e s p o n s e s . l e n g t h   :   0 ;  
                                 }  
                                  
                                 c o n s t   p e r c e n t a g e   =   ( a v g S c o r e   /   5 )   *   1 0 0 ;  
                                  
                                 r e t u r n   (  
                                     < d i v   k e y = { c a t e g o r y . i d }   s t y l e = { {   m a r g i n B o t t o m :   ' 1 6 p x '   } } >  
                                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' s p a c e - b e t w e e n ' ,   m a r g i n B o t t o m :   ' 6 p x '   } } >  
                                             < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } > { c a t e g o r y . n a m e } < / s p a n >  
                                             < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 6 6 7 e e a '   } } > { a v g S c o r e . t o F i x e d ( 2 ) }   /   5 . 0 < / s p a n >  
                                         < / d i v >  
                                         < d i v   s t y l e = { {   b a c k g r o u n d :   ' # e 2 e 8 f 0 ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   h e i g h t :   ' 2 4 p x ' ,   o v e r f l o w :   ' h i d d e n '   } } >  
                                             < d i v   s t y l e = { {   b a c k g r o u n d :   ' l i n e a r - g r a d i e n t ( 9 0 d e g ,   # 6 6 7 e e a   0 % ,   # 7 6 4 b a 2   1 0 0 % ) ' ,   h e i g h t :   ' 1 0 0 % ' ,   w i d t h :   ` $ { p e r c e n t a g e } % ` ,   t r a n s i t i o n :   ' w i d t h   0 . 5 s ' ,   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   j u s t i f y C o n t e n t :   ' f l e x - e n d ' ,   p a d d i n g R i g h t :   ' 8 p x '   } } >  
                                                 { p e r c e n t a g e   >   1 5   & &   < s p a n   s t y l e = { {   f o n t S i z e :   ' 1 2 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' w h i t e '   } } > { p e r c e n t a g e . t o F i x e d ( 0 ) } % < / s p a n > }  
                                             < / d i v >  
                                         < / d i v >  
                                     < / d i v >  
                                 ) ;  
                             } ) }  
                         < / d i v >  
                     < / d i v >  
  
                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 2 4 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                         < h 2   s t y l e = { {   f o n t S i z e :   ' 2 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > C a t e g o r y   S c o r e s   -   R a d a r   C h a r t < / h 2 >  
                          
                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   j u s t i f y C o n t e n t :   ' c e n t e r ' ,   p a d d i n g :   ' 2 0 p x '   } } >  
                             < s v g   w i d t h = " 5 0 0 "   h e i g h t = " 5 0 0 "   v i e w B o x = " 0   0   5 0 0   5 0 0 " >  
                                 < g   t r a n s f o r m = " t r a n s l a t e ( 2 5 0 ,   2 5 0 ) " >  
                                     { / *   D r a w   c o n c e n t r i c   c i r c l e s   * / }  
                                     { [ 1 ,   2 ,   3 ,   4 ,   5 ] . m a p ( ( l e v e l )   = >   (  
                                         < c i r c l e  
                                             k e y = { l e v e l }  
                                             c x = " 0 "  
                                             c y = " 0 "  
                                             r = { l e v e l   *   4 0 }  
                                             f i l l = " n o n e "  
                                             s t r o k e = " # e 2 e 8 f 0 "  
                                             s t r o k e W i d t h = " 1 "  
                                         / >  
                                     ) ) }  
                                      
                                     { / *   D r a w   a x i s   l i n e s   a n d   l a b e l s   * / }  
                                     { a s s e s s m e n t D a t a . m a p ( ( c a t e g o r y ,   i d x )   = >   {  
                                         c o n s t   a n g l e   =   ( i d x   *   2   *   M a t h . P I )   /   a s s e s s m e n t D a t a . l e n g t h   -   M a t h . P I   /   2 ;  
                                         c o n s t   x 2   =   M a t h . c o s ( a n g l e )   *   2 0 0 ;  
                                         c o n s t   y 2   =   M a t h . s i n ( a n g l e )   *   2 0 0 ;  
                                         c o n s t   l a b e l X   =   M a t h . c o s ( a n g l e )   *   2 2 0 ;  
                                         c o n s t   l a b e l Y   =   M a t h . s i n ( a n g l e )   *   2 2 0 ;  
                                          
                                         r e t u r n   (  
                                             < g   k e y = { c a t e g o r y . i d } >  
                                                 < l i n e   x 1 = " 0 "   y 1 = " 0 "   x 2 = { x 2 }   y 2 = { y 2 }   s t r o k e = " # c b d 5 e 1 "   s t r o k e W i d t h = " 1 "   / >  
                                                 < t e x t  
                                                     x = { l a b e l X }  
                                                     y = { l a b e l Y }  
                                                     t e x t A n c h o r = " m i d d l e "  
                                                     f o n t S i z e = " 1 1 "  
                                                     f o n t W e i g h t = " 6 0 0 "  
                                                     f i l l = " # 4 7 5 5 6 9 "  
                                                     d o m i n a n t B a s e l i n e = " m i d d l e "  
                                                 >  
                                                     { c a t e g o r y . n a m e . l e n g t h   >   2 0   ?   c a t e g o r y . n a m e . s u b s t r i n g ( 0 ,   1 8 )   +   ' . . . '   :   c a t e g o r y . n a m e }  
                                                 < / t e x t >  
                                             < / g >  
                                         ) ;  
                                     } ) }  
                                      
                                     { / *   D r a w   d a t a   p o l y g o n   * / }  
                                     < p o l y g o n  
                                         p o i n t s = { a s s e s s m e n t D a t a . m a p ( ( c a t e g o r y ,   i d x )   = >   {  
                                             c o n s t   c a t e g o r y Q u e s t i o n s   =   c a t e g o r y . q u e s t i o n s . m a p ( q   = >   q . i d ) ;  
                                              
                                             l e t   a v g S c o r e   =   0 ;  
                                             i f   ( c u r r e n t U s e r ? . r o l e   = = =   ' c o n s u l t a n t ' )   {  
                                                 / /   C a l c u l a t e   a v e r a g e   a c r o s s   a l l   a s s e s s m e n t   r e c o r d s   f o r   t h i s   c o m p a n y  
                                                 c o n s t   c o m p a n y R e c o r d s   =   a s s e s s m e n t R e c o r d s . f i l t e r ( r   = >   r . c o m p a n y I d   = = =   s e l e c t e d C o m p a n y I d ) ;  
                                                 c o n s t   a l l C a t e g o r y S c o r e s   =   c o m p a n y R e c o r d s . m a p ( r e c o r d   = >   {  
                                                     c o n s t   c a t e g o r y R e s p o n s e s   =   c a t e g o r y Q u e s t i o n s . m a p ( q I d   = >   r e c o r d . r e s p o n s e s [ q I d ] ) . f i l t e r ( r   = >   r   ! = =   u n d e f i n e d ) ;  
                                                     r e t u r n   c a t e g o r y R e s p o n s e s . l e n g t h   >   0   ?   c a t e g o r y R e s p o n s e s . r e d u c e ( ( s u m ,   v a l )   = >   s u m   +   v a l ,   0 )   /   c a t e g o r y R e s p o n s e s . l e n g t h   :   0 ;  
                                                 } ) . f i l t e r ( s   = >   s   >   0 ) ;  
                                                 a v g S c o r e   =   a l l C a t e g o r y S c o r e s . l e n g t h   >   0   ?   a l l C a t e g o r y S c o r e s . r e d u c e ( ( s u m ,   v a l )   = >   s u m   +   v a l ,   0 )   /   a l l C a t e g o r y S c o r e s . l e n g t h   :   0 ;  
                                             }   e l s e   {  
                                                 / /   U s e   c u r r e n t   u s e r ' s   r e s p o n s e s  
                                                 c o n s t   c a t e g o r y R e s p o n s e s   =   c a t e g o r y Q u e s t i o n s . m a p ( q I d   = >   a s s e s s m e n t R e s p o n s e s [ q I d ] ) . f i l t e r ( r   = >   r   ! = =   u n d e f i n e d ) ;  
                                                 a v g S c o r e   =   c a t e g o r y R e s p o n s e s . l e n g t h   >   0   ?   c a t e g o r y R e s p o n s e s . r e d u c e ( ( s u m ,   v a l )   = >   s u m   +   v a l ,   0 )   /   c a t e g o r y R e s p o n s e s . l e n g t h   :   0 ;  
                                             }  
                                              
                                             c o n s t   a n g l e   =   ( i d x   *   2   *   M a t h . P I )   /   a s s e s s m e n t D a t a . l e n g t h   -   M a t h . P I   /   2 ;  
                                             c o n s t   r a d i u s   =   ( a v g S c o r e   /   5 )   *   2 0 0 ;  
                                             c o n s t   x   =   M a t h . c o s ( a n g l e )   *   r a d i u s ;  
                                             c o n s t   y   =   M a t h . s i n ( a n g l e )   *   r a d i u s ;  
                                             r e t u r n   ` $ { x } , $ { y } ` ;  
                                         } ) . j o i n ( '   ' ) }  
                                         f i l l = " r g b a ( 1 0 2 ,   1 2 6 ,   2 3 4 ,   0 . 2 ) "  
                                         s t r o k e = " # 6 6 7 e e a "  
                                         s t r o k e W i d t h = " 3 "  
                                     / >  
                                      
                                     { / *   D r a w   d a t a   p o i n t s   * / }  
                                     { a s s e s s m e n t D a t a . m a p ( ( c a t e g o r y ,   i d x )   = >   {  
                                         c o n s t   c a t e g o r y Q u e s t i o n s   =   c a t e g o r y . q u e s t i o n s . m a p ( q   = >   q . i d ) ;  
                                          
                                         l e t   a v g S c o r e   =   0 ;  
                                         i f   ( c u r r e n t U s e r ? . r o l e   = = =   ' c o n s u l t a n t ' )   {  
                                             / /   C a l c u l a t e   a v e r a g e   a c r o s s   a l l   a s s e s s m e n t   r e c o r d s   f o r   t h i s   c o m p a n y  
                                             c o n s t   c o m p a n y R e c o r d s   =   a s s e s s m e n t R e c o r d s . f i l t e r ( r   = >   r . c o m p a n y I d   = = =   s e l e c t e d C o m p a n y I d ) ;  
                                             c o n s t   a l l C a t e g o r y S c o r e s   =   c o m p a n y R e c o r d s . m a p ( r e c o r d   = >   {  
                                                 c o n s t   c a t e g o r y R e s p o n s e s   =   c a t e g o r y Q u e s t i o n s . m a p ( q I d   = >   r e c o r d . r e s p o n s e s [ q I d ] ) . f i l t e r ( r   = >   r   ! = =   u n d e f i n e d ) ;  
                                                 r e t u r n   c a t e g o r y R e s p o n s e s . l e n g t h   >   0   ?   c a t e g o r y R e s p o n s e s . r e d u c e ( ( s u m ,   v a l )   = >   s u m   +   v a l ,   0 )   /   c a t e g o r y R e s p o n s e s . l e n g t h   :   0 ;  
                                             } ) . f i l t e r ( s   = >   s   >   0 ) ;  
                                             a v g S c o r e   =   a l l C a t e g o r y S c o r e s . l e n g t h   >   0   ?   a l l C a t e g o r y S c o r e s . r e d u c e ( ( s u m ,   v a l )   = >   s u m   +   v a l ,   0 )   /   a l l C a t e g o r y S c o r e s . l e n g t h   :   0 ;  
                                         }   e l s e   {  
                                             / /   U s e   c u r r e n t   u s e r ' s   r e s p o n s e s  
                                             c o n s t   c a t e g o r y R e s p o n s e s   =   c a t e g o r y Q u e s t i o n s . m a p ( q I d   = >   a s s e s s m e n t R e s p o n s e s [ q I d ] ) . f i l t e r ( r   = >   r   ! = =   u n d e f i n e d ) ;  
                                             a v g S c o r e   =   c a t e g o r y R e s p o n s e s . l e n g t h   >   0   ?   c a t e g o r y R e s p o n s e s . r e d u c e ( ( s u m ,   v a l )   = >   s u m   +   v a l ,   0 )   /   c a t e g o r y R e s p o n s e s . l e n g t h   :   0 ;  
                                         }  
                                          
                                         c o n s t   a n g l e   =   ( i d x   *   2   *   M a t h . P I )   /   a s s e s s m e n t D a t a . l e n g t h   -   M a t h . P I   /   2 ;  
                                         c o n s t   r a d i u s   =   ( a v g S c o r e   /   5 )   *   2 0 0 ;  
                                         c o n s t   x   =   M a t h . c o s ( a n g l e )   *   r a d i u s ;  
                                         c o n s t   y   =   M a t h . s i n ( a n g l e )   *   r a d i u s ;  
                                          
                                         r e t u r n   (  
                                             < c i r c l e   k e y = { c a t e g o r y . i d }   c x = { x }   c y = { y }   r = " 6 "   f i l l = " # 6 6 7 e e a "   s t r o k e = " w h i t e "   s t r o k e W i d t h = " 2 " >  
                                                 < t i t l e > { c a t e g o r y . n a m e } :   { a v g S c o r e . t o F i x e d ( 2 ) } < / t i t l e >  
                                             < / c i r c l e >  
                                         ) ;  
                                     } ) }  
                                      
                                     { / *   C e n t e r   c i r c l e   w i t h   l e g e n d   * / }  
                                     < c i r c l e   c x = " 0 "   c y = " 0 "   r = " 3 0 "   f i l l = " w h i t e "   s t r o k e = " # c b d 5 e 1 "   s t r o k e W i d t h = " 1 "   / >  
                                     < t e x t   x = " 0 "   y = " - 5 "   t e x t A n c h o r = " m i d d l e "   f o n t S i z e = " 1 0 "   f o n t W e i g h t = " 6 0 0 "   f i l l = " # 6 4 7 4 8 b " > S c a l e < / t e x t >  
                                     < t e x t   x = " 0 "   y = " 8 "   t e x t A n c h o r = " m i d d l e "   f o n t S i z e = " 1 0 "   f i l l = " # 6 4 7 4 8 b " > 1   t o   5 < / t e x t >  
                                 < / g >  
                             < / s v g >  
                         < / d i v >  
                     < / d i v >  
                         < / >  
                     ) }  
                 < / d i v >  
             ) }  
  
             { / *   C u s t o m   P r i n t   V i e w   -   F o r   C o n s u l t a n t s   a n d   C o m p a n y   U s e r s   * / }  
             { c u r r e n t V i e w   = = =   ' c u s t o m - p r i n t '   & &   ( c u r r e n t U s e r ? . r o l e   = = =   ' c o n s u l t a n t '   | |   ( c u r r e n t U s e r ? . r o l e   = = =   ' u s e r '   & &   c u r r e n t U s e r ? . u s e r T y p e   = = =   ' c o m p a n y ' ) )   & &   (  
                 < d i v   s t y l e = { {   m a x W i d t h :   ' 1 0 0 0 p x ' ,   m a r g i n :   ' 0   a u t o ' ,   p a d d i n g :   ' 3 2 p x '   } } >  
                     < d i v   s t y l e = { {   b a c k g r o u n d :   ' w h i t e ' ,   b o r d e r R a d i u s :   ' 1 2 p x ' ,   p a d d i n g :   ' 4 0 p x ' ,   b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 0 , 0 , 0 , 0 . 0 6 ) '   } } >  
                         < h 1   s t y l e = { {   f o n t S i z e :   ' 3 6 p x ' ,   f o n t W e i g h t :   ' 7 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 1 6 p x '   } } > C u s t o m   P r i n t   P a c k a g e < / h 1 >  
                         < p   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                             S e l e c t   t h e   r e p o r t s   y o u   w a n t   t o   i n c l u d e   i n   y o u r   c u s t o m   p r i n t   p a c k a g e  
                         < / p >  
                          
                         < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 3 2 p x '   } } >  
                             { / *   M D & A   R e p o r t   * / }  
                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                 < l a b e l   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   c u r s o r :   ' p o i n t e r '   } } >  
                                     < i n p u t    
                                         t y p e = " c h e c k b o x "    
                                         c h e c k e d = { p r i n t P a c k a g e S e l e c t i o n s . m d a }  
                                         o n C h a n g e = { ( e )   = >   s e t P r i n t P a c k a g e S e l e c t i o n s ( { . . . p r i n t P a c k a g e S e l e c t i o n s ,   m d a :   e . t a r g e t . c h e c k e d } ) }  
                                         s t y l e = { {   w i d t h :   ' 1 8 p x ' ,   h e i g h t :   ' 1 8 p x ' ,   m a r g i n R i g h t :   ' 1 2 p x ' ,   c u r s o r :   ' p o i n t e r '   } }  
                                     / >  
                                     < d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > M D & A   ( M a n a g e m e n t   D i s c u s s i o n   &   A n a l y s i s ) < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n T o p :   ' 4 p x '   } } > I n c l u d e s   a l l   3   t a b s :   K e y   M e t r i c s ,   A n a l y s i s ,   a n d   R e c o m m e n d a t i o n s < / d i v >  
                                     < / d i v >  
                                 < / l a b e l >  
                             < / d i v >  
  
                             { / *   F i n a n c i a l   S c o r e   * / }  
                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                 < l a b e l   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   c u r s o r :   ' p o i n t e r '   } } >  
                                     < i n p u t    
                                         t y p e = " c h e c k b o x "    
                                         c h e c k e d = { p r i n t P a c k a g e S e l e c t i o n s . f i n a n c i a l S c o r e }  
                                         o n C h a n g e = { ( e )   = >   s e t P r i n t P a c k a g e S e l e c t i o n s ( { . . . p r i n t P a c k a g e S e l e c t i o n s ,   f i n a n c i a l S c o r e :   e . t a r g e t . c h e c k e d } ) }  
                                         s t y l e = { {   w i d t h :   ' 1 8 p x ' ,   h e i g h t :   ' 1 8 p x ' ,   m a r g i n R i g h t :   ' 1 2 p x ' ,   c u r s o r :   ' p o i n t e r '   } }  
                                     / >  
                                     < d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > F i n a n c i a l   S c o r e < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n T o p :   ' 4 p x '   } } > S c o r e   s u m m a r y   a n d   t r e n d s < / d i v >  
                                     < / d i v >  
                                 < / l a b e l >  
                             < / d i v >  
  
                             { / *   P r i o r i t y   R a t i o s   * / }  
                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                 < l a b e l   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   c u r s o r :   ' p o i n t e r '   } } >  
                                     < i n p u t    
                                         t y p e = " c h e c k b o x "    
                                         c h e c k e d = { p r i n t P a c k a g e S e l e c t i o n s . p r i o r i t y R a t i o s }  
                                         o n C h a n g e = { ( e )   = >   s e t P r i n t P a c k a g e S e l e c t i o n s ( { . . . p r i n t P a c k a g e S e l e c t i o n s ,   p r i o r i t y R a t i o s :   e . t a r g e t . c h e c k e d } ) }  
                                         s t y l e = { {   w i d t h :   ' 1 8 p x ' ,   h e i g h t :   ' 1 8 p x ' ,   m a r g i n R i g h t :   ' 1 2 p x ' ,   c u r s o r :   ' p o i n t e r '   } }  
                                     / >  
                                     < d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > P r i o r i t y   R a t i o s < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n T o p :   ' 4 p x '   } } > K e y   f i n a n c i a l   r a t i o s   a n d   m e t r i c s < / d i v >  
                                     < / d i v >  
                                 < / l a b e l >  
                             < / d i v >  
  
                             { / *   W o r k i n g   C a p i t a l   * / }  
                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                 < l a b e l   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   c u r s o r :   ' p o i n t e r '   } } >  
                                     < i n p u t    
                                         t y p e = " c h e c k b o x "    
                                         c h e c k e d = { p r i n t P a c k a g e S e l e c t i o n s . w o r k i n g C a p i t a l }  
                                         o n C h a n g e = { ( e )   = >   s e t P r i n t P a c k a g e S e l e c t i o n s ( { . . . p r i n t P a c k a g e S e l e c t i o n s ,   w o r k i n g C a p i t a l :   e . t a r g e t . c h e c k e d } ) }  
                                         s t y l e = { {   w i d t h :   ' 1 8 p x ' ,   h e i g h t :   ' 1 8 p x ' ,   m a r g i n R i g h t :   ' 1 2 p x ' ,   c u r s o r :   ' p o i n t e r '   } }  
                                     / >  
                                     < d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > W o r k i n g   C a p i t a l < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n T o p :   ' 4 p x '   } } > W o r k i n g   c a p i t a l   a n a l y s i s < / d i v >  
                                     < / d i v >  
                                 < / l a b e l >  
                             < / d i v >  
  
                             { / *   C a s h   F l o w   T a b s   * / }  
                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                 < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 1 2 p x '   } } >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > C a s h   F l o w   A n a l y s i s < / d i v >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n T o p :   ' 4 p x '   } } > C a s h   f l o w   r e p o r t s < / d i v >  
                                 < / d i v >  
                                 < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   f l e x D i r e c t i o n :   ' c o l u m n ' ,   g a p :   ' 1 2 p x ' ,   m a r g i n L e f t :   ' 0 p x '   } } >  
                                     < l a b e l   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   c u r s o r :   ' p o i n t e r ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } >  
                                         < i n p u t    
                                             t y p e = " c h e c k b o x "    
                                             c h e c k e d = { p r i n t P a c k a g e S e l e c t i o n s . c a s h F l o w 4 Q u a r t e r s }  
                                             o n C h a n g e = { ( e )   = >   s e t P r i n t P a c k a g e S e l e c t i o n s ( { . . . p r i n t P a c k a g e S e l e c t i o n s ,   c a s h F l o w 4 Q u a r t e r s :   e . t a r g e t . c h e c k e d } ) }  
                                             s t y l e = { {   w i d t h :   ' 1 6 p x ' ,   h e i g h t :   ' 1 6 p x ' ,   m a r g i n R i g h t :   ' 8 p x ' ,   c u r s o r :   ' p o i n t e r '   } }    
                                         / >  
                                         L a s t   4   Q u a r t e r s  
                                     < / l a b e l >  
                                     < l a b e l   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   c u r s o r :   ' p o i n t e r ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } >  
                                         < i n p u t    
                                             t y p e = " c h e c k b o x "    
                                             c h e c k e d = { p r i n t P a c k a g e S e l e c t i o n s . c a s h F l o w 3 Y e a r s }  
                                             o n C h a n g e = { ( e )   = >   s e t P r i n t P a c k a g e S e l e c t i o n s ( { . . . p r i n t P a c k a g e S e l e c t i o n s ,   c a s h F l o w 3 Y e a r s :   e . t a r g e t . c h e c k e d } ) }  
                                             s t y l e = { {   w i d t h :   ' 1 6 p x ' ,   h e i g h t :   ' 1 6 p x ' ,   m a r g i n R i g h t :   ' 8 p x ' ,   c u r s o r :   ' p o i n t e r '   } }    
                                         / >  
                                         L a s t   3   Y e a r s  
                                     < / l a b e l >  
                                 < / d i v >  
                             < / d i v >  
  
                             { / *   F i n a n c i a l   S t a t e m e n t s   * / }  
                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                 < d i v >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > F i n a n c i a l   S t a t e m e n t s < / d i v >  
                                     < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n B o t t o m :   ' 1 2 p x '   } } > S e l e c t   s p e c i f i c   f i n a n c i a l   s t a t e m e n t s < / d i v >  
                                     < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   f l e x D i r e c t i o n :   ' c o l u m n ' ,   g a p :   ' 8 p x ' ,   m a r g i n L e f t :   ' 0 p x '   } } >  
                                         { / *   I n c o m e   S t a t e m e n t   w i t h   s u b - o p t i o n s   * / }  
                                         < d i v >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > I n c o m e   S t a t e m e n t < / d i v >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   f l e x D i r e c t i o n :   ' c o l u m n ' ,   g a p :   ' 6 p x ' ,   m a r g i n L e f t :   ' 1 6 p x '   } } >  
                                                 < l a b e l   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   c u r s o r :   ' p o i n t e r ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } >  
                                                     < i n p u t    
                                                         t y p e = " c h e c k b o x "    
                                                         c h e c k e d = { p r i n t P a c k a g e S e l e c t i o n s . i n c o m e S t a t e m e n t 1 2 M o n t h s Q u a r t e r l y }  
                                                         o n C h a n g e = { ( e )   = >   s e t P r i n t P a c k a g e S e l e c t i o n s ( { . . . p r i n t P a c k a g e S e l e c t i o n s ,   i n c o m e S t a t e m e n t 1 2 M o n t h s Q u a r t e r l y :   e . t a r g e t . c h e c k e d } ) }  
                                                         s t y l e = { {   w i d t h :   ' 1 6 p x ' ,   h e i g h t :   ' 1 6 p x ' ,   m a r g i n R i g h t :   ' 8 p x ' ,   c u r s o r :   ' p o i n t e r '   } }    
                                                     / >  
                                                     I n c o m e   S t a t e m e n t ,   L a s t   1 2   m o n t h s ,   Q u a r t e r l y  
                                                 < / l a b e l >  
                                                 < l a b e l   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   c u r s o r :   ' p o i n t e r ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } >  
                                                     < i n p u t    
                                                         t y p e = " c h e c k b o x "    
                                                         c h e c k e d = { p r i n t P a c k a g e S e l e c t i o n s . i n c o m e S t a t e m e n t 3 Y e a r s A n n u a l }  
                                                         o n C h a n g e = { ( e )   = >   s e t P r i n t P a c k a g e S e l e c t i o n s ( { . . . p r i n t P a c k a g e S e l e c t i o n s ,   i n c o m e S t a t e m e n t 3 Y e a r s A n n u a l :   e . t a r g e t . c h e c k e d } ) }  
                                                         s t y l e = { {   w i d t h :   ' 1 6 p x ' ,   h e i g h t :   ' 1 6 p x ' ,   m a r g i n R i g h t :   ' 8 p x ' ,   c u r s o r :   ' p o i n t e r '   } }    
                                                     / >  
                                                     I n c o m e   S t a t e m e n t ,   L a s t   3   Y e a r s ,   A n n u a l  
                                                 < / l a b e l >  
                                             < / d i v >  
                                         < / d i v >  
                                         { / *   B a l a n c e   S h e e t   w i t h   s u b - o p t i o n s   * / }  
                                         < d i v   s t y l e = { {   m a r g i n T o p :   ' 1 2 p x '   } } >  
                                             < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b ' ,   m a r g i n B o t t o m :   ' 8 p x '   } } > B a l a n c e   S h e e t < / d i v >  
                                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   f l e x D i r e c t i o n :   ' c o l u m n ' ,   g a p :   ' 6 p x ' ,   m a r g i n L e f t :   ' 1 6 p x '   } } >  
                                                 < l a b e l   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   c u r s o r :   ' p o i n t e r ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } >  
                                                     < i n p u t    
                                                         t y p e = " c h e c k b o x "    
                                                         c h e c k e d = { p r i n t P a c k a g e S e l e c t i o n s . b a l a n c e S h e e t 1 2 M o n t h s Q u a r t e r l y }  
                                                         o n C h a n g e = { ( e )   = >   s e t P r i n t P a c k a g e S e l e c t i o n s ( { . . . p r i n t P a c k a g e S e l e c t i o n s ,   b a l a n c e S h e e t 1 2 M o n t h s Q u a r t e r l y :   e . t a r g e t . c h e c k e d } ) }  
                                                         s t y l e = { {   w i d t h :   ' 1 6 p x ' ,   h e i g h t :   ' 1 6 p x ' ,   m a r g i n R i g h t :   ' 8 p x ' ,   c u r s o r :   ' p o i n t e r '   } }    
                                                     / >  
                                                     B a l a n c e   S h e e t ,   L a s t   1 2   m o n t h s ,   Q u a r t e r l y  
                                                 < / l a b e l >  
                                                 < l a b e l   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   c u r s o r :   ' p o i n t e r ' ,   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 4 7 5 5 6 9 '   } } >  
                                                     < i n p u t    
                                                         t y p e = " c h e c k b o x "    
                                                         c h e c k e d = { p r i n t P a c k a g e S e l e c t i o n s . b a l a n c e S h e e t 3 Y e a r s A n n u a l }  
                                                         o n C h a n g e = { ( e )   = >   s e t P r i n t P a c k a g e S e l e c t i o n s ( { . . . p r i n t P a c k a g e S e l e c t i o n s ,   b a l a n c e S h e e t 3 Y e a r s A n n u a l :   e . t a r g e t . c h e c k e d } ) }  
                                                         s t y l e = { {   w i d t h :   ' 1 6 p x ' ,   h e i g h t :   ' 1 6 p x ' ,   m a r g i n R i g h t :   ' 8 p x ' ,   c u r s o r :   ' p o i n t e r '   } }    
                                                     / >  
                                                     B a l a n c e   S h e e t ,   L a s t   3   Y e a r s ,   A n n u a l  
                                                 < / l a b e l >  
                                             < / d i v >  
                                         < / d i v >  
                                     < / d i v >  
                                 < / d i v >  
                             < / d i v >  
  
                             { / *   C o m p a n y   P r o f i l e   * / }  
                             < d i v   s t y l e = { {   m a r g i n B o t t o m :   ' 2 0 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' # f 8 f a f c ' ,   b o r d e r R a d i u s :   ' 8 p x ' ,   b o r d e r :   ' 1 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                                 < l a b e l   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   a l i g n I t e m s :   ' c e n t e r ' ,   c u r s o r :   ' p o i n t e r '   } } >  
                                     < i n p u t    
                                         t y p e = " c h e c k b o x "    
                                         c h e c k e d = { p r i n t P a c k a g e S e l e c t i o n s . p r o f i l e }  
                                         o n C h a n g e = { ( e )   = >   s e t P r i n t P a c k a g e S e l e c t i o n s ( { . . . p r i n t P a c k a g e S e l e c t i o n s ,   p r o f i l e :   e . t a r g e t . c h e c k e d } ) }  
                                         s t y l e = { {   w i d t h :   ' 1 8 p x ' ,   h e i g h t :   ' 1 8 p x ' ,   m a r g i n R i g h t :   ' 1 2 p x ' ,   c u r s o r :   ' p o i n t e r '   } }  
                                     / >  
                                     < d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 6 p x ' ,   f o n t W e i g h t :   ' 6 0 0 ' ,   c o l o r :   ' # 1 e 2 9 3 b '   } } > C o m p a n y   P r o f i l e < / d i v >  
                                         < d i v   s t y l e = { {   f o n t S i z e :   ' 1 3 p x ' ,   c o l o r :   ' # 6 4 7 4 8 b ' ,   m a r g i n T o p :   ' 4 p x '   } } > B u s i n e s s   p r o f i l e ,   f i n a n c i a l   o v e r v i e w ,   r a t i o s ,   a n d   d i s c l o s u r e s < / d i v >  
                                     < / d i v >  
                                 < / l a b e l >  
                             < / d i v >  
                         < / d i v >  
  
                         { / *   A c t i o n   B u t t o n s   * / }  
                         < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 1 6 p x ' ,   j u s t i f y C o n t e n t :   ' c e n t e r ' ,   p a d d i n g T o p :   ' 2 4 p x ' ,   b o r d e r T o p :   ' 2 p x   s o l i d   # e 2 e 8 f 0 '   } } >  
                             < b u t t o n  
                                 o n C l i c k = { h a n d l e G e n e r a t e P r i n t P a c k a g e }  
                                 s t y l e = { {  
                                     p a d d i n g :   ' 1 4 p x   3 2 p x ' ,  
                                     b a c k g r o u n d :   ' # 6 6 7 e e a ' ,  
                                     c o l o r :   ' w h i t e ' ,  
                                     b o r d e r :   ' n o n e ' ,  
                                     b o r d e r R a d i u s :   ' 8 p x ' ,  
                                     f o n t S i z e :   ' 1 6 p x ' ,  
                                     f o n t W e i g h t :   ' 6 0 0 ' ,  
                                     c u r s o r :   ' p o i n t e r ' ,  
                                     b o x S h a d o w :   ' 0   2 p x   8 p x   r g b a ( 1 0 2 ,   1 2 6 ,   2 3 4 ,   0 . 3 ) ' ,  
                                     t r a n s i t i o n :   ' a l l   0 . 2 s '  
                                 } }  
                                 o n M o u s e E n t e r = { ( e )   = >   e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # 5 5 6 8 d 3 ' }  
                                 o n M o u s e L e a v e = { ( e )   = >   e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # 6 6 7 e e a ' }  
                             >  
                                  x       G e n e r a t e   P r i n t   P a c k a g e  
                             < / b u t t o n >  
                             < b u t t o n  
                                 o n C l i c k = { ( )   = >   {  
                                     s e t P r i n t P a c k a g e S e l e c t i o n s ( {  
                                         m d a :   f a l s e ,  
                                         f i n a n c i a l S c o r e :   f a l s e ,  
                                         p r i o r i t y R a t i o s :   f a l s e ,  
                                         w o r k i n g C a p i t a l :   f a l s e ,  
                                         c a s h F l o w 4 Q u a r t e r s :   f a l s e ,  
                                         c a s h F l o w 3 Y e a r s :   f a l s e ,  
                                         i n c o m e S t a t e m e n t 1 2 M o n t h s Q u a r t e r l y :   f a l s e ,  
                                         i n c o m e S t a t e m e n t 3 Y e a r s A n n u a l :   f a l s e ,  
                                         b a l a n c e S h e e t 1 2 M o n t h s Q u a r t e r l y :   f a l s e ,  
                                         b a l a n c e S h e e t 3 Y e a r s A n n u a l :   f a l s e ,  
                                         p r o f i l e :   f a l s e  
                                     } ) ;  
                                 } }  
                                 s t y l e = { {  
                                     p a d d i n g :   ' 1 4 p x   3 2 p x ' ,  
                                     b a c k g r o u n d :   ' # f 1 f 5 f 9 ' ,  
                                     c o l o r :   ' # 4 7 5 5 6 9 ' ,  
                                     b o r d e r :   ' 1 p x   s o l i d   # c b d 5 e 1 ' ,  
                                     b o r d e r R a d i u s :   ' 8 p x ' ,  
                                     f o n t S i z e :   ' 1 6 p x ' ,  
                                     f o n t W e i g h t :   ' 6 0 0 ' ,  
                                     c u r s o r :   ' p o i n t e r ' ,  
                                     t r a n s i t i o n :   ' a l l   0 . 2 s '  
                                 } }  
                                 o n M o u s e E n t e r = { ( e )   = >   {  
                                     e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # e 2 e 8 f 0 ' ;  
                                     e . c u r r e n t T a r g e t . s t y l e . b o r d e r C o l o r   =   ' # 9 4 a 3 b 8 ' ;  
                                 } }  
                                 o n M o u s e L e a v e = { ( e )   = >   {  
                                     e . c u r r e n t T a r g e t . s t y l e . b a c k g r o u n d   =   ' # f 1 f 5 f 9 ' ;  
                                     e . c u r r e n t T a r g e t . s t y l e . b o r d e r C o l o r   =   ' # c b d 5 e 1 ' ;  
                                 } }  
                             >  
                                 C l e a r   A l l  
                             < / b u t t o n >  
                         < / d i v >  
  
                         { / *   I n f o   B o x   * / }  
                         < d i v   s t y l e = { {   m a r g i n T o p :   ' 3 2 p x ' ,   p a d d i n g :   ' 1 6 p x ' ,   b a c k g r o u n d :   ' # e f f 6 f f ' ,   b o r d e r :   ' 1 p x   s o l i d   # b f d b f e ' ,   b o r d e r R a d i u s :   ' 8 p x '   } } >  
                             < d i v   s t y l e = { {   d i s p l a y :   ' f l e x ' ,   g a p :   ' 1 2 p x ' ,   a l i g n I t e m s :   ' f l e x - s t a r t '   } } >  
                                 < s p a n   s t y l e = { {   f o n t S i z e :   ' 2 0 p x '   } } >       < / s p a n >  
                                 < d i v   s t y l e = { {   f o n t S i z e :   ' 1 4 p x ' ,   c o l o r :   ' # 1 e 4 0 a f ' ,   l i n e H e i g h t :   ' 1 . 6 '   } } >  
                                     < s t r o n g > H o w   i t   w o r k s : < / s t r o n g >   S e l e c t   t h e   r e p o r t s   y o u   w a n t   t o   i n c l u d e ,   t h e n   c l i c k   " G e n e r a t e   P r i n t   P a c k a g e "   t o   c r e a t e   a   c o m b i n e d   P D F   w i t h   a l l   s e l e c t e d   r e p o r t s   i n   a   s i n g l e   d o c u m e n t   r e a d y   f o r   p r i n t i n g .  
                                 < / d i v >  
                             < / d i v >  
                         < / d i v >  
                     < / d i v >  
                 < / d i v >  
             ) }  
                 < / m a i n >  
             < / d i v >  
         < / d i v >  
     ) ;  
 }  
  
 ) ;  
 }  
   );
}
